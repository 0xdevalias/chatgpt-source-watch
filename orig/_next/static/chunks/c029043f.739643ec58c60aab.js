(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3796],{9628:function(r,n,i){r.exports=(function r(n,i,a){function o(l,c){if(!i[l]){if(!n[l]){if(s)return s(l,!0);var u=Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var f=i[l]={exports:{}};n[l][0].call(f.exports,function(r){return o(n[l][1][r]||r)},f,f.exports,r,n,i,a)}return i[l].exports}for(var s=void 0,l=0;l<a.length;l++)o(a[l]);return o})({1:[function(r,n,i){"use strict";var a=r("../src/lib"),o={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:#fff;","X .select-outline-2":"stroke:#000;stroke-dasharray:2px 2px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var s in o){var l=s.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");a.addStyleRule(l,o[s])}},{"../src/lib":503}],2:[function(r,n,i){"use strict";n.exports=r("../src/transforms/aggregate")},{"../src/transforms/aggregate":1114}],3:[function(r,n,i){"use strict";n.exports=r("../src/traces/bar")},{"../src/traces/bar":656}],4:[function(r,n,i){"use strict";n.exports=r("../src/traces/barpolar")},{"../src/traces/barpolar":669}],5:[function(r,n,i){"use strict";n.exports=r("../src/traces/box")},{"../src/traces/box":679}],6:[function(r,n,i){"use strict";n.exports=r("../src/components/calendars")},{"../src/components/calendars":364}],7:[function(r,n,i){"use strict";n.exports=r("../src/traces/candlestick")},{"../src/traces/candlestick":688}],8:[function(r,n,i){"use strict";n.exports=r("../src/traces/carpet")},{"../src/traces/carpet":707}],9:[function(r,n,i){"use strict";n.exports=r("../src/traces/choropleth")},{"../src/traces/choropleth":721}],10:[function(r,n,i){"use strict";n.exports=r("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":728}],11:[function(r,n,i){"use strict";n.exports=r("../src/traces/cone")},{"../src/traces/cone":734}],12:[function(r,n,i){"use strict";n.exports=r("../src/traces/contour")},{"../src/traces/contour":749}],13:[function(r,n,i){"use strict";n.exports=r("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":760}],14:[function(r,n,i){"use strict";n.exports=r("../src/core")},{"../src/core":481}],15:[function(r,n,i){"use strict";n.exports=r("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":768}],16:[function(r,n,i){"use strict";n.exports=r("../src/transforms/filter")},{"../src/transforms/filter":1115}],17:[function(r,n,i){"use strict";n.exports=r("../src/traces/funnel")},{"../src/traces/funnel":778}],18:[function(r,n,i){"use strict";n.exports=r("../src/traces/funnelarea")},{"../src/traces/funnelarea":787}],19:[function(r,n,i){"use strict";n.exports=r("../src/transforms/groupby")},{"../src/transforms/groupby":1116}],20:[function(r,n,i){"use strict";n.exports=r("../src/traces/heatmap")},{"../src/traces/heatmap":800}],21:[function(r,n,i){"use strict";n.exports=r("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":811}],22:[function(r,n,i){"use strict";n.exports=r("../src/traces/histogram")},{"../src/traces/histogram":823}],23:[function(r,n,i){"use strict";n.exports=r("../src/traces/histogram2d")},{"../src/traces/histogram2d":829}],24:[function(r,n,i){"use strict";n.exports=r("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":833}],25:[function(r,n,i){"use strict";n.exports=r("../src/traces/icicle")},{"../src/traces/icicle":839}],26:[function(r,n,i){"use strict";n.exports=r("../src/traces/image")},{"../src/traces/image":852}],27:[function(r,n,i){"use strict";var a=r("./core");a.register([r("./bar"),r("./box"),r("./heatmap"),r("./histogram"),r("./histogram2d"),r("./histogram2dcontour"),r("./contour"),r("./scatterternary"),r("./violin"),r("./funnel"),r("./waterfall"),r("./image"),r("./pie"),r("./sunburst"),r("./treemap"),r("./icicle"),r("./funnelarea"),r("./scatter3d"),r("./surface"),r("./isosurface"),r("./volume"),r("./mesh3d"),r("./cone"),r("./streamtube"),r("./scattergeo"),r("./choropleth"),r("./scattergl"),r("./splom"),r("./pointcloud"),r("./heatmapgl"),r("./parcoords"),r("./parcats"),r("./scattermapbox"),r("./choroplethmapbox"),r("./densitymapbox"),r("./sankey"),r("./indicator"),r("./table"),r("./carpet"),r("./scattercarpet"),r("./contourcarpet"),r("./ohlc"),r("./candlestick"),r("./scatterpolar"),r("./scatterpolargl"),r("./barpolar"),r("./scattersmith"),r("./aggregate"),r("./filter"),r("./groupby"),r("./sort"),r("./calendars")]),n.exports=a},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(r,n,i){"use strict";n.exports=r("../src/traces/indicator")},{"../src/traces/indicator":860}],29:[function(r,n,i){"use strict";n.exports=r("../src/traces/isosurface")},{"../src/traces/isosurface":866}],30:[function(r,n,i){"use strict";n.exports=r("../src/traces/mesh3d")},{"../src/traces/mesh3d":871}],31:[function(r,n,i){"use strict";n.exports=r("../src/traces/ohlc")},{"../src/traces/ohlc":876}],32:[function(r,n,i){"use strict";n.exports=r("../src/traces/parcats")},{"../src/traces/parcats":885}],33:[function(r,n,i){"use strict";n.exports=r("../src/traces/parcoords")},{"../src/traces/parcoords":895}],34:[function(r,n,i){"use strict";n.exports=r("../src/traces/pie")},{"../src/traces/pie":906}],35:[function(r,n,i){"use strict";n.exports=r("../src/traces/pointcloud")},{"../src/traces/pointcloud":915}],36:[function(r,n,i){"use strict";n.exports=r("../src/traces/sankey")},{"../src/traces/sankey":921}],37:[function(r,n,i){"use strict";n.exports=r("../src/traces/scatter3d")},{"../src/traces/scatter3d":959}],38:[function(r,n,i){"use strict";n.exports=r("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":966}],39:[function(r,n,i){"use strict";n.exports=r("../src/traces/scattergeo")},{"../src/traces/scattergeo":974}],40:[function(r,n,i){"use strict";n.exports=r("../src/traces/scattergl")},{"../src/traces/scattergl":987}],41:[function(r,n,i){"use strict";n.exports=r("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":997}],42:[function(r,n,i){"use strict";n.exports=r("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1005}],43:[function(r,n,i){"use strict";n.exports=r("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1012}],44:[function(r,n,i){"use strict";n.exports=r("../src/traces/scattersmith")},{"../src/traces/scattersmith":1019}],45:[function(r,n,i){"use strict";n.exports=r("../src/traces/scatterternary")},{"../src/traces/scatterternary":1027}],46:[function(r,n,i){"use strict";n.exports=r("../src/transforms/sort")},{"../src/transforms/sort":1118}],47:[function(r,n,i){"use strict";n.exports=r("../src/traces/splom")},{"../src/traces/splom":1036}],48:[function(r,n,i){"use strict";n.exports=r("../src/traces/streamtube")},{"../src/traces/streamtube":1044}],49:[function(r,n,i){"use strict";n.exports=r("../src/traces/sunburst")},{"../src/traces/sunburst":1052}],50:[function(r,n,i){"use strict";n.exports=r("../src/traces/surface")},{"../src/traces/surface":1061}],51:[function(r,n,i){"use strict";n.exports=r("../src/traces/table")},{"../src/traces/table":1069}],52:[function(r,n,i){"use strict";n.exports=r("../src/traces/treemap")},{"../src/traces/treemap":1080}],53:[function(r,n,i){"use strict";n.exports=r("../src/traces/violin")},{"../src/traces/violin":1093}],54:[function(r,n,i){"use strict";n.exports=r("../src/traces/volume")},{"../src/traces/volume":1101}],55:[function(r,n,i){"use strict";n.exports=r("../src/traces/waterfall")},{"../src/traces/waterfall":1109}],56:[function(r,n,i){var a;a=function(r,n,i,a,o){"use strict";function s(r){return r.target.depth}function l(r,n){return r.sourceLinks.length?r.depth:n-1}function c(r){return function(){return r}}o=o&&o.hasOwnProperty("default")?o.default:o;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r};function f(r,n){return p(r.source,n.source)||r.index-n.index}function h(r,n){return p(r.target,n.target)||r.index-n.index}function p(r,n){return r.partOfCycle===n.partOfCycle?r.y0-n.y0:"top"===r.circularLinkType||"bottom"===n.circularLinkType?-1:1}function d(r){return r.value}function m(r){return(r.y0+r.y1)/2}function g(r){return m(r.source)}function v(r){return m(r.target)}function y(r){return r.index}function x(r){return r.nodes}function b(r){return r.links}function _(r,n){var i=r.get(n);if(!i)throw Error("missing: "+n);return i}function w(r,n){var i=0,a=0;r.links.forEach(function(o){o.circular&&(o.source.circularLinkType||o.target.circularLinkType?o.circularLinkType=o.source.circularLinkType?o.source.circularLinkType:o.target.circularLinkType:o.circularLinkType=i<a?"top":"bottom","top"==o.circularLinkType?i+=1:a+=1,r.nodes.forEach(function(r){n(r)!=n(o.source)&&n(r)!=n(o.target)||(r.circularLinkType=o.circularLinkType)}))}),r.links.forEach(function(r){r.circular&&(r.source.circularLinkType==r.target.circularLinkType&&(r.circularLinkType=r.source.circularLinkType),U(r,n)&&(r.circularLinkType=r.source.circularLinkType))})}function T(r){var n=Math.abs(r.y1-r.y0);return Math.atan(Math.abs(r.target.x0-r.source.x1)/n)}function k(r,n){var i=0;r.sourceLinks.forEach(function(r){i=r.circular&&!U(r,n)?i+1:i});var a=0;return r.targetLinks.forEach(function(r){a=r.circular&&!U(r,n)?a+1:a}),i+a}function A(r){var n=r.source.sourceLinks,i=0;n.forEach(function(r){i=r.circular?i+1:i});var a=r.target.targetLinks,o=0;return a.forEach(function(r){o=r.circular?o+1:o}),!(i>1||o>1)}function M(r,n,i){return r.sort(E),r.forEach(function(a,o){var s,l,c=0;if(U(a,i)&&A(a))a.circularPathData.verticalBuffer=c+a.width/2;else{for(var u=0;u<o;u++)if(s=r[o],l=r[u],!(s.source.column<l.target.column||s.target.column>l.source.column)){var f=r[u].circularPathData.verticalBuffer+r[u].width/2+n;c=f>c?f:c}a.circularPathData.verticalBuffer=c+a.width/2}}),r}function S(r,i,o,s){var l=n.min(r.links,function(r){return r.source.y0});r.links.forEach(function(r){r.circular&&(r.circularPathData={})}),M(r.links.filter(function(r){return"top"==r.circularLinkType}),i,s),M(r.links.filter(function(r){return"bottom"==r.circularLinkType}),i,s),r.links.forEach(function(n){if(n.circular){if(n.circularPathData.arcRadius=n.width+10,n.circularPathData.leftNodeBuffer=5,n.circularPathData.rightNodeBuffer=5,n.circularPathData.sourceWidth=n.source.x1-n.source.x0,n.circularPathData.sourceX=n.source.x0+n.circularPathData.sourceWidth,n.circularPathData.targetX=n.target.x0,n.circularPathData.sourceY=n.y0,n.circularPathData.targetY=n.y1,U(n,s)&&A(n))n.circularPathData.leftSmallArcRadius=10+n.width/2,n.circularPathData.leftLargeArcRadius=10+n.width/2,n.circularPathData.rightSmallArcRadius=10+n.width/2,n.circularPathData.rightLargeArcRadius=10+n.width/2,"bottom"==n.circularLinkType?(n.circularPathData.verticalFullExtent=n.source.y1+25+n.circularPathData.verticalBuffer,n.circularPathData.verticalLeftInnerExtent=n.circularPathData.verticalFullExtent-n.circularPathData.leftLargeArcRadius,n.circularPathData.verticalRightInnerExtent=n.circularPathData.verticalFullExtent-n.circularPathData.rightLargeArcRadius):(n.circularPathData.verticalFullExtent=n.source.y0-25-n.circularPathData.verticalBuffer,n.circularPathData.verticalLeftInnerExtent=n.circularPathData.verticalFullExtent+n.circularPathData.leftLargeArcRadius,n.circularPathData.verticalRightInnerExtent=n.circularPathData.verticalFullExtent+n.circularPathData.rightLargeArcRadius);else{var c=n.source.column,u=n.circularLinkType,f=r.links.filter(function(r){return r.source.column==c&&r.circularLinkType==u});"bottom"==n.circularLinkType?f.sort(C):f.sort(L);var h=0;f.forEach(function(r,a){r.circularLinkID==n.circularLinkID&&(n.circularPathData.leftSmallArcRadius=10+n.width/2+h,n.circularPathData.leftLargeArcRadius=10+n.width/2+a*i+h),h+=r.width}),c=n.target.column,f=r.links.filter(function(r){return r.target.column==c&&r.circularLinkType==u}),"bottom"==n.circularLinkType?f.sort(I):f.sort(P),h=0,f.forEach(function(r,a){r.circularLinkID==n.circularLinkID&&(n.circularPathData.rightSmallArcRadius=10+n.width/2+h,n.circularPathData.rightLargeArcRadius=10+n.width/2+a*i+h),h+=r.width}),"bottom"==n.circularLinkType?(n.circularPathData.verticalFullExtent=Math.max(o,n.source.y1,n.target.y1)+25+n.circularPathData.verticalBuffer,n.circularPathData.verticalLeftInnerExtent=n.circularPathData.verticalFullExtent-n.circularPathData.leftLargeArcRadius,n.circularPathData.verticalRightInnerExtent=n.circularPathData.verticalFullExtent-n.circularPathData.rightLargeArcRadius):(n.circularPathData.verticalFullExtent=l-25-n.circularPathData.verticalBuffer,n.circularPathData.verticalLeftInnerExtent=n.circularPathData.verticalFullExtent+n.circularPathData.leftLargeArcRadius,n.circularPathData.verticalRightInnerExtent=n.circularPathData.verticalFullExtent+n.circularPathData.rightLargeArcRadius)}n.circularPathData.leftInnerExtent=n.circularPathData.sourceX+n.circularPathData.leftNodeBuffer,n.circularPathData.rightInnerExtent=n.circularPathData.targetX-n.circularPathData.rightNodeBuffer,n.circularPathData.leftFullExtent=n.circularPathData.sourceX+n.circularPathData.leftLargeArcRadius+n.circularPathData.leftNodeBuffer,n.circularPathData.rightFullExtent=n.circularPathData.targetX-n.circularPathData.rightLargeArcRadius-n.circularPathData.rightNodeBuffer}if(n.circular)n.path="top"==n.circularLinkType?"M"+n.circularPathData.sourceX+" "+n.circularPathData.sourceY+" L"+n.circularPathData.leftInnerExtent+" "+n.circularPathData.sourceY+" A"+n.circularPathData.leftLargeArcRadius+" "+n.circularPathData.leftSmallArcRadius+" 0 0 0 "+n.circularPathData.leftFullExtent+" "+(n.circularPathData.sourceY-n.circularPathData.leftSmallArcRadius)+" L"+n.circularPathData.leftFullExtent+" "+n.circularPathData.verticalLeftInnerExtent+" A"+n.circularPathData.leftLargeArcRadius+" "+n.circularPathData.leftLargeArcRadius+" 0 0 0 "+n.circularPathData.leftInnerExtent+" "+n.circularPathData.verticalFullExtent+" L"+n.circularPathData.rightInnerExtent+" "+n.circularPathData.verticalFullExtent+" A"+n.circularPathData.rightLargeArcRadius+" "+n.circularPathData.rightLargeArcRadius+" 0 0 0 "+n.circularPathData.rightFullExtent+" "+n.circularPathData.verticalRightInnerExtent+" L"+n.circularPathData.rightFullExtent+" "+(n.circularPathData.targetY-n.circularPathData.rightSmallArcRadius)+" A"+n.circularPathData.rightLargeArcRadius+" "+n.circularPathData.rightSmallArcRadius+" 0 0 0 "+n.circularPathData.rightInnerExtent+" "+n.circularPathData.targetY+" L"+n.circularPathData.targetX+" "+n.circularPathData.targetY:"M"+n.circularPathData.sourceX+" "+n.circularPathData.sourceY+" L"+n.circularPathData.leftInnerExtent+" "+n.circularPathData.sourceY+" A"+n.circularPathData.leftLargeArcRadius+" "+n.circularPathData.leftSmallArcRadius+" 0 0 1 "+n.circularPathData.leftFullExtent+" "+(n.circularPathData.sourceY+n.circularPathData.leftSmallArcRadius)+" L"+n.circularPathData.leftFullExtent+" "+n.circularPathData.verticalLeftInnerExtent+" A"+n.circularPathData.leftLargeArcRadius+" "+n.circularPathData.leftLargeArcRadius+" 0 0 1 "+n.circularPathData.leftInnerExtent+" "+n.circularPathData.verticalFullExtent+" L"+n.circularPathData.rightInnerExtent+" "+n.circularPathData.verticalFullExtent+" A"+n.circularPathData.rightLargeArcRadius+" "+n.circularPathData.rightLargeArcRadius+" 0 0 1 "+n.circularPathData.rightFullExtent+" "+n.circularPathData.verticalRightInnerExtent+" L"+n.circularPathData.rightFullExtent+" "+(n.circularPathData.targetY+n.circularPathData.rightSmallArcRadius)+" A"+n.circularPathData.rightLargeArcRadius+" "+n.circularPathData.rightSmallArcRadius+" 0 0 1 "+n.circularPathData.rightInnerExtent+" "+n.circularPathData.targetY+" L"+n.circularPathData.targetX+" "+n.circularPathData.targetY;else{var p=a.linkHorizontal().source(function(r){return[r.source.x0+(r.source.x1-r.source.x0),r.y0]}).target(function(r){return[r.target.x0,r.y1]});n.path=p(n)}})}function E(r,n){return O(r)==O(n)?"bottom"==r.circularLinkType?C(r,n):L(r,n):O(n)-O(r)}function L(r,n){return r.y0-n.y0}function C(r,n){return n.y0-r.y0}function P(r,n){return r.y1-n.y1}function I(r,n){return n.y1-r.y1}function O(r){return r.target.column-r.source.column}function z(r){return r.target.x0-r.source.x1}function D(r,n){var i=T(r),a=z(n)/Math.tan(i);return"up"==j(r)?r.y1+a:r.y1-a}function R(r,n){var i=T(r),a=z(n)/Math.tan(i);return"up"==j(r)?r.y1-a:r.y1+a}function F(r,n,i,a){return r.y0+n>=i&&r.y1+n<=a&&(r.y0=r.y0+n,r.y1=r.y1+n,r.targetLinks.forEach(function(r){r.y1=r.y1+n}),r.sourceLinks.forEach(function(r){r.y0=r.y0+n})),r}function B(r,n,i,a){r.nodes.forEach(function(o){a&&o.y+(o.y1-o.y0)>n&&(o.y=o.y-(o.y+(o.y1-o.y0)-n));var s=r.links.filter(function(r){return i(r.source)==i(o)}),l=s.length;l>1&&s.sort(function(r,n){if(!r.circular&&!n.circular){if(r.target.column==n.target.column||j(r)!=j(n))return r.y1-n.y1;if(r.target.column>n.target.column){var i=R(n,r);return r.y1-i}if(n.target.column>r.target.column)return R(r,n)-n.y1}return r.circular&&!n.circular?"top"==r.circularLinkType?-1:1:n.circular&&!r.circular?"top"==n.circularLinkType?1:-1:r.circular&&n.circular?r.circularLinkType===n.circularLinkType&&"top"==r.circularLinkType?r.target.column===n.target.column?r.target.y1-n.target.y1:n.target.column-r.target.column:r.circularLinkType===n.circularLinkType&&"bottom"==r.circularLinkType?r.target.column===n.target.column?n.target.y1-r.target.y1:r.target.column-n.target.column:"top"==r.circularLinkType?-1:1:void 0});var c=o.y0;s.forEach(function(r){r.y0=c+r.width/2,c+=r.width}),s.forEach(function(r,n){if("bottom"==r.circularLinkType){for(var i=n+1,a=0;i<l;i++)a+=s[i].width;r.y0=o.y1-a-r.width/2}})})}function N(r,n,i){r.nodes.forEach(function(n){var a=r.links.filter(function(r){return i(r.target)==i(n)}),o=a.length;o>1&&a.sort(function(r,n){if(!r.circular&&!n.circular){if(r.source.column==n.source.column||j(r)!=j(n))return r.y0-n.y0;if(n.source.column<r.source.column){var i=D(n,r);return r.y0-i}if(r.source.column<n.source.column)return D(r,n)-n.y0}return r.circular&&!n.circular?"top"==r.circularLinkType?-1:1:n.circular&&!r.circular?"top"==n.circularLinkType?1:-1:r.circular&&n.circular?r.circularLinkType===n.circularLinkType&&"top"==r.circularLinkType?r.source.column===n.source.column?r.source.y1-n.source.y1:r.source.column-n.source.column:r.circularLinkType===n.circularLinkType&&"bottom"==r.circularLinkType?r.source.column===n.source.column?r.source.y1-n.source.y1:n.source.column-r.source.column:"top"==r.circularLinkType?-1:1:void 0});var s=n.y0;a.forEach(function(r){r.y1=s+r.width/2,s+=r.width}),a.forEach(function(r,i){if("bottom"==r.circularLinkType){for(var s=i+1,l=0;s<o;s++)l+=a[s].width;r.y1=n.y1-l-r.width/2}})})}function j(r){return r.y0-r.y1>0?"up":"down"}function U(r,n){return n(r.source)==n(r.target)}r.sankeyCircular=function(){var r,a,s=0,T=0,A=1,M=1,E=24,L=y,C=l,P=x,I=b,O=32,z=2,D=null;function R(){var l={nodes:P.apply(null,arguments),links:I.apply(null,arguments)};(function(r){r.nodes.forEach(function(r,n){r.index=n,r.sourceLinks=[],r.targetLinks=[]});var n=i.map(r.nodes,L);r.links.forEach(function(r,i){r.index=i;var a=r.source,o=r.target;"object"!==(void 0===a?"undefined":u(a))&&(a=r.source=_(n,a)),"object"!==(void 0===o?"undefined":u(o))&&(o=r.target=_(n,o)),a.sourceLinks.push(r),o.targetLinks.push(r)})})(l),function(r,n,i){var a=0;if(null===i){for(var s=[],l=0;l<r.links.length;l++){var c=r.links[l],u=c.source.index,f=c.target.index;s[u]||(s[u]=[]),s[f]||(s[f]=[]),-1===s[u].indexOf(f)&&s[u].push(f)}var h=o(s);h.sort(function(r,n){return r.length-n.length});var p={};for(l=0;l<h.length;l++){var d=h[l].slice(-2);p[d[0]]||(p[d[0]]={}),p[d[0]][d[1]]=!0}r.links.forEach(function(r){var n=r.target.index,i=r.source.index;n===i||p[i]&&p[i][n]?(r.circular=!0,r.circularLinkID=a,a+=1):r.circular=!1})}else r.links.forEach(function(r){r.source[i]<r.target[i]?r.circular=!1:(r.circular=!0,r.circularLinkID=a,a+=1)})}(l,0,D),function(r){r.nodes.forEach(function(r){r.partOfCycle=!1,r.value=Math.max(n.sum(r.sourceLinks,d),n.sum(r.targetLinks,d)),r.sourceLinks.forEach(function(n){n.circular&&(r.partOfCycle=!0,r.circularLinkType=n.circularLinkType)}),r.targetLinks.forEach(function(n){n.circular&&(r.partOfCycle=!0,r.circularLinkType=n.circularLinkType)})})}(l),function(r){var n,i,a;for(n=r.nodes,i=[],a=0;n.length;++a,n=i,i=[])n.forEach(function(r){r.depth=a,r.sourceLinks.forEach(function(r){0>i.indexOf(r.target)&&!r.circular&&i.push(r.target)})});for(n=r.nodes,i=[],a=0;n.length;++a,n=i,i=[])n.forEach(function(r){r.height=a,r.targetLinks.forEach(function(r){0>i.indexOf(r.source)&&!r.circular&&i.push(r.source)})});r.nodes.forEach(function(r){r.column=Math.floor(C.call(null,r,a))})}(l),w(l,L),function(o,l,c){var u=i.nest().key(function(r){return r.column}).sortKeys(n.ascending).entries(o.nodes).map(function(r){return r.values});(function(i){if(a){var l,c,f,h,p,m,g,v,y,x,b=1/0;u.forEach(function(r){var n=M*a/(r.length+1);b=n<b?n:b}),r=b}var _=n.min(u,function(i){return(M-T-(i.length-1)*r)/n.sum(i,d)});_*=.3,o.links.forEach(function(r){r.width=r.value*_});var w=(l=0,c=0,f=0,h=0,p=n.max(o.nodes,function(r){return r.column}),o.links.forEach(function(r){r.circular&&("top"==r.circularLinkType?l+=r.width:c+=r.width,0==r.target.column&&(h+=r.width),r.source.column==p&&(f+=r.width))}),{top:l=l>0?l+25+10:l,bottom:c=c>0?c+25+10:c,left:h=h>0?h+25+10:h,right:f=f>0?f+25+10:f}),S=(m=n.max(o.nodes,function(r){return r.column}),g=A-s,v=M-T,y=g/(g+w.right+w.left),x=v/(v+w.top+w.bottom),s=s*y+w.left,A=0==w.right?A:A*y,T=T*x+w.top,M*=x,o.nodes.forEach(function(r){r.x0=s+r.column*((A-s-E)/m),r.x1=r.x0+E}),x);_*=S,o.links.forEach(function(r){r.width=r.value*_}),u.forEach(function(r){var n=r.length;r.forEach(function(r,a){r.depth==u.length-1&&1==n||0==r.depth&&1==n?r.y0=M/2-r.value*_:r.partOfCycle?0==k(r,i)?r.y0=M/2+a:"top"==r.circularLinkType?r.y0=T+a:r.y0=M-r.value*_-a:0==w.top||0==w.bottom?r.y0=(M-T)/n*a:r.y0=(M-T)/2-n/2+a,r.y1=r.y0+r.value*_})})})(c),y();for(var f=1,h=l;h>0;--h)(function(r,i){var a=u.length;u.forEach(function(o){var s=o.length,l=o[0].depth;o.forEach(function(o){var c;if(o.sourceLinks.length||o.targetLinks.length){if(o.partOfCycle&&k(o,i)>0);else if(0==l&&1==s)c=o.y1-o.y0,o.y0=M/2-c/2,o.y1=M/2+c/2;else if(l==a-1&&1==s)c=o.y1-o.y0,o.y0=M/2-c/2,o.y1=M/2+c/2;else{var u=n.mean(o.sourceLinks,v),f=n.mean(o.targetLinks,g),h=((u&&f?(u+f)/2:u||f)-m(o))*r;o.y0+=h,o.y1+=h}}})})})(f*=.99,c),y();function y(){u.forEach(function(n){var i,a,o,s=T,l=n.length;for(n.sort(p),o=0;o<l;++o)(a=s-(i=n[o]).y0)>0&&(i.y0+=a,i.y1+=a),s=i.y1+r;if((a=s-r-M)>0)for(s=i.y0-=a,i.y1-=a,o=l-2;o>=0;--o)(a=(i=n[o]).y1+r-s)>0&&(i.y0-=a,i.y1-=a),s=i.y0})}}(l,O,L),j(l);for(var c=0;c<4;c++)B(l,M,L),N(l,M,L),function(r,n,i,a){r.links.forEach(function(o){if(!o.circular&&o.target.column-o.source.column>1){var s=o.source.column+1,l=o.target.column-1,c=1,u=l-s+1;for(c=1;s<=l;s++,c++)r.nodes.forEach(function(l){if(l.column==s){var f,h=c/(u+1),p=Math.pow(1-h,3),d=3*h*Math.pow(1-h,2),m=3*Math.pow(h,2)*(1-h),g=Math.pow(h,3),v=p*o.y0+d*o.y0+m*o.y1+g*o.y1,y=v-o.width/2,x=v+o.width/2;y>l.y0&&y<l.y1?(f=l.y1-y+10,f="bottom"==l.circularLinkType?f:-f,l=F(l,f,n,i),r.nodes.forEach(function(r){var o;a(r)!=a(l)&&r.column==l.column&&((o=l).y0>r.y0&&o.y0<r.y1||o.y1>r.y0&&o.y1<r.y1||o.y0<r.y0&&o.y1>r.y1)&&F(r,f,n,i)})):(x>l.y0&&x<l.y1||y<l.y0&&x>l.y1)&&(f=x-l.y0+10,l=F(l,f,n,i),r.nodes.forEach(function(r){a(r)!=a(l)&&r.column==l.column&&r.y0<l.y1&&r.y1>l.y1&&F(r,f,n,i)}))}})}})}(l,T,M,L),B(l,M,L),N(l,M,L);return function(r,i,a){var o=r.nodes,s=r.links,l=!1,c=!1;if(s.forEach(function(r){"top"==r.circularLinkType?l=!0:"bottom"==r.circularLinkType&&(c=!0)}),0==l||0==c){var u=n.min(o,function(r){return r.y0}),f=(a-i)/(n.max(o,function(r){return r.y1})-u);o.forEach(function(r){var n=(r.y1-r.y0)*f;r.y0=(r.y0-u)*f,r.y1=r.y0+n}),s.forEach(function(r){r.y0=(r.y0-u)*f,r.y1=(r.y1-u)*f,r.width=r.width*f})}}(l,T,M),S(l,z,M,L),l}function j(r){r.nodes.forEach(function(r){r.sourceLinks.sort(h),r.targetLinks.sort(f)}),r.nodes.forEach(function(r){var n=r.y0,i=n,a=r.y1,o=a;r.sourceLinks.forEach(function(r){r.circular?(r.y0=a-r.width/2,a-=r.width):(r.y0=n+r.width/2,n+=r.width)}),r.targetLinks.forEach(function(r){r.circular?(r.y1=o-r.width/2,o-=r.width):(r.y1=i+r.width/2,i+=r.width)})})}return R.nodeId=function(r){return arguments.length?(L="function"==typeof r?r:c(r),R):L},R.nodeAlign=function(r){return arguments.length?(C="function"==typeof r?r:c(r),R):C},R.nodeWidth=function(r){return arguments.length?(E=+r,R):E},R.nodePadding=function(n){return arguments.length?(r=+n,R):r},R.nodes=function(r){return arguments.length?(P="function"==typeof r?r:c(r),R):P},R.links=function(r){return arguments.length?(I="function"==typeof r?r:c(r),R):I},R.size=function(r){return arguments.length?(s=T=0,A=+r[0],M=+r[1],R):[A-s,M-T]},R.extent=function(r){return arguments.length?(s=+r[0][0],A=+r[1][0],T=+r[0][1],M=+r[1][1],R):[[s,T],[A,M]]},R.iterations=function(r){return arguments.length?(O=+r,R):O},R.circularLinkGap=function(r){return arguments.length?(z=+r,R):z},R.nodePaddingRatio=function(r){return arguments.length?(a=+r,R):a},R.sortNodes=function(r){return arguments.length?(D=r,R):D},R.update=function(r){return w(r,L),j(r),r.links.forEach(function(r){r.circular&&(r.circularLinkType=r.y0+r.y1<M?"top":"bottom",r.source.circularLinkType=r.circularLinkType,r.target.circularLinkType=r.circularLinkType)}),B(r,M,L,!1),N(r,M,L),S(r,z,M,L),r},R},r.sankeyCenter=function(r){return r.targetLinks.length?r.depth:r.sourceLinks.length?n.min(r.sourceLinks,s)-1:0},r.sankeyLeft=function(r){return r.depth},r.sankeyRight=function(r,n){return n-1-r.height},r.sankeyJustify=l,Object.defineProperty(r,"__esModule",{value:!0})},"object"==typeof i&&void 0!==n?a(i,r("d3-array"),r("d3-collection"),r("d3-shape"),r("elementary-circuits-directed-graph")):a(this.d3=this.d3||{},this.d3,this.d3,this.d3,null)},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(r,n,i){var a;a=function(r,n,i,a){"use strict";function o(r){return r.target.depth}function s(r,n){return r.sourceLinks.length?r.depth:n-1}function l(r){return function(){return r}}function c(r,n){return f(r.source,n.source)||r.index-n.index}function u(r,n){return f(r.target,n.target)||r.index-n.index}function f(r,n){return r.y0-n.y0}function h(r){return r.value}function p(r){return(r.y0+r.y1)/2}function d(r){return p(r.source)*r.value}function m(r){return p(r.target)*r.value}function g(r){return r.index}function v(r){return r.nodes}function y(r){return r.links}function x(r,n){var i=r.get(n);if(!i)throw Error("missing: "+n);return i}function b(r){return[r.source.x1,r.y0]}function _(r){return[r.target.x0,r.y1]}r.sankey=function(){var r=0,a=0,o=1,b=1,_=24,w=8,T=g,k=s,A=v,M=y,S=32;function E(){var s={nodes:A.apply(null,arguments),links:M.apply(null,arguments)};return function(r){r.nodes.forEach(function(r,n){r.index=n,r.sourceLinks=[],r.targetLinks=[]});var n=i.map(r.nodes,T);r.links.forEach(function(r,i){r.index=i;var a=r.source,o=r.target;"object"!=typeof a&&(a=r.source=x(n,a)),"object"!=typeof o&&(o=r.target=x(n,o)),a.sourceLinks.push(r),o.targetLinks.push(r)})}(s),function(r){r.nodes.forEach(function(r){r.value=Math.max(n.sum(r.sourceLinks,h),n.sum(r.targetLinks,h))})}(s),function(n){for(i=n.nodes,a=[],s=0;i.length;++s,i=a,a=[])i.forEach(function(r){r.depth=s,r.sourceLinks.forEach(function(r){0>a.indexOf(r.target)&&a.push(r.target)})});for(i=n.nodes,a=[],s=0;i.length;++s,i=a,a=[])i.forEach(function(r){r.height=s,r.targetLinks.forEach(function(r){0>a.indexOf(r.source)&&a.push(r.source)})});var i,a,s,l=(o-r-_)/(s-1);n.nodes.forEach(function(n){n.x1=(n.x0=r+Math.max(0,Math.min(s-1,Math.floor(k.call(null,n,s))))*l)+_})}(s),function(r){var o,s,l,c=i.nest().key(function(r){return r.x0}).sortKeys(n.ascending).entries(r.nodes).map(function(r){return r.values});o=n.max(c,function(r){return r.length}),w>(s=2/3*(b-a)/(o-1))&&(w=s),l=n.min(c,function(r){return(b-a-(r.length-1)*w)/n.sum(r,h)}),c.forEach(function(r){r.forEach(function(r,n){r.y1=(r.y0=n)+r.value*l})}),r.links.forEach(function(r){r.width=r.value*l}),v();for(var u=1,g=S;g>0;--g)(function(r){c.slice().reverse().forEach(function(i){i.forEach(function(i){if(i.sourceLinks.length){var a=(n.sum(i.sourceLinks,m)/n.sum(i.sourceLinks,h)-p(i))*r;i.y0+=a,i.y1+=a}})})})(u*=.99),v(),function(r){c.forEach(function(i){i.forEach(function(i){if(i.targetLinks.length){var a=(n.sum(i.targetLinks,d)/n.sum(i.targetLinks,h)-p(i))*r;i.y0+=a,i.y1+=a}})})}(u),v();function v(){c.forEach(function(r){var n,i,o,s=a,l=r.length;for(r.sort(f),o=0;o<l;++o)(i=s-(n=r[o]).y0)>0&&(n.y0+=i,n.y1+=i),s=n.y1+w;if((i=s-w-b)>0)for(s=n.y0-=i,n.y1-=i,o=l-2;o>=0;--o)(i=(n=r[o]).y1+w-s)>0&&(n.y0-=i,n.y1-=i),s=n.y0})}}(s),L(s),s}function L(r){r.nodes.forEach(function(r){r.sourceLinks.sort(u),r.targetLinks.sort(c)}),r.nodes.forEach(function(r){var n=r.y0,i=n;r.sourceLinks.forEach(function(r){r.y0=n+r.width/2,n+=r.width}),r.targetLinks.forEach(function(r){r.y1=i+r.width/2,i+=r.width})})}return E.update=function(r){return L(r),r},E.nodeId=function(r){return arguments.length?(T="function"==typeof r?r:l(r),E):T},E.nodeAlign=function(r){return arguments.length?(k="function"==typeof r?r:l(r),E):k},E.nodeWidth=function(r){return arguments.length?(_=+r,E):_},E.nodePadding=function(r){return arguments.length?(w=+r,E):w},E.nodes=function(r){return arguments.length?(A="function"==typeof r?r:l(r),E):A},E.links=function(r){return arguments.length?(M="function"==typeof r?r:l(r),E):M},E.size=function(n){return arguments.length?(r=a=0,o=+n[0],b=+n[1],E):[o-r,b-a]},E.extent=function(n){return arguments.length?(r=+n[0][0],o=+n[1][0],a=+n[0][1],b=+n[1][1],E):[[r,a],[o,b]]},E.iterations=function(r){return arguments.length?(S=+r,E):S},E},r.sankeyCenter=function(r){return r.targetLinks.length?r.depth:r.sourceLinks.length?n.min(r.sourceLinks,o)-1:0},r.sankeyLeft=function(r){return r.depth},r.sankeyRight=function(r,n){return n-1-r.height},r.sankeyJustify=s,r.sankeyLinkHorizontal=function(){return a.linkHorizontal().source(b).target(_)},Object.defineProperty(r,"__esModule",{value:!0})},"object"==typeof i&&void 0!==n?a(i,r("d3-array"),r("d3-collection"),r("d3-shape")):a(this.d3=this.d3||{},this.d3,this.d3,this.d3)},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(r,n,i){(function(){var r={version:"3.8.0"},i=[].slice,a=function(r){return i.call(r)},o=self.document;function s(r){return r&&(r.ownerDocument||r.document||r).documentElement}function l(r){return r&&(r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView)}if(o)try{a(o.documentElement.childNodes)[0].nodeType}catch(r){a=function(r){for(var n=r.length,i=Array(n);n--;)i[n]=r[n];return i}}if(Date.now||(Date.now=function(){return+new Date}),o)try{o.createElement("DIV").style.setProperty("opacity",0,"")}catch(r){var c=this.Element.prototype,u=c.setAttribute,f=c.setAttributeNS,h=this.CSSStyleDeclaration.prototype,p=h.setProperty;c.setAttribute=function(r,n){u.call(this,r,n+"")},c.setAttributeNS=function(r,n,i){f.call(this,r,n,i+"")},h.setProperty=function(r,n,i){p.call(this,r,n+"",i)}}function d(r,n){return r<n?-1:r>n?1:r>=n?0:NaN}function m(r){return null===r?NaN:+r}function g(r){return!isNaN(r)}function v(r){return{left:function(n,i,a,o){for(arguments.length<3&&(a=0),arguments.length<4&&(o=n.length);a<o;){var s=a+o>>>1;0>r(n[s],i)?a=s+1:o=s}return a},right:function(n,i,a,o){for(arguments.length<3&&(a=0),arguments.length<4&&(o=n.length);a<o;){var s=a+o>>>1;r(n[s],i)>0?o=s:a=s+1}return a}}}r.ascending=d,r.descending=function(r,n){return n<r?-1:n>r?1:n>=r?0:NaN},r.min=function(r,n){var i,a,o=-1,s=r.length;if(1==arguments.length){for(;++o<s;)if(null!=(a=r[o])&&a>=a){i=a;break}for(;++o<s;)null!=(a=r[o])&&i>a&&(i=a)}else{for(;++o<s;)if(null!=(a=n.call(r,r[o],o))&&a>=a){i=a;break}for(;++o<s;)null!=(a=n.call(r,r[o],o))&&i>a&&(i=a)}return i},r.max=function(r,n){var i,a,o=-1,s=r.length;if(1==arguments.length){for(;++o<s;)if(null!=(a=r[o])&&a>=a){i=a;break}for(;++o<s;)null!=(a=r[o])&&a>i&&(i=a)}else{for(;++o<s;)if(null!=(a=n.call(r,r[o],o))&&a>=a){i=a;break}for(;++o<s;)null!=(a=n.call(r,r[o],o))&&a>i&&(i=a)}return i},r.extent=function(r,n){var i,a,o,s=-1,l=r.length;if(1==arguments.length){for(;++s<l;)if(null!=(a=r[s])&&a>=a){i=o=a;break}for(;++s<l;)null!=(a=r[s])&&(i>a&&(i=a),o<a&&(o=a))}else{for(;++s<l;)if(null!=(a=n.call(r,r[s],s))&&a>=a){i=o=a;break}for(;++s<l;)null!=(a=n.call(r,r[s],s))&&(i>a&&(i=a),o<a&&(o=a))}return[i,o]},r.sum=function(r,n){var i,a=0,o=r.length,s=-1;if(1==arguments.length)for(;++s<o;)g(i=+r[s])&&(a+=i);else for(;++s<o;)g(i=+n.call(r,r[s],s))&&(a+=i);return a},r.mean=function(r,n){var i,a=0,o=r.length,s=-1,l=o;if(1==arguments.length)for(;++s<o;)g(i=m(r[s]))?a+=i:--l;else for(;++s<o;)g(i=m(n.call(r,r[s],s)))?a+=i:--l;if(l)return a/l},r.quantile=function(r,n){var i=(r.length-1)*n+1,a=Math.floor(i),o=+r[a-1],s=i-a;return s?o+s*(r[a]-o):o},r.median=function(n,i){var a,o=[],s=n.length,l=-1;if(1==arguments.length)for(;++l<s;)g(a=m(n[l]))&&o.push(a);else for(;++l<s;)g(a=m(i.call(n,n[l],l)))&&o.push(a);if(o.length)return r.quantile(o.sort(d),.5)},r.variance=function(r,n){var i,a,o=r.length,s=0,l=0,c=-1,u=0;if(1==arguments.length)for(;++c<o;)g(i=m(r[c]))&&(l+=(a=i-s)*(i-(s+=a/++u)));else for(;++c<o;)g(i=m(n.call(r,r[c],c)))&&(l+=(a=i-s)*(i-(s+=a/++u)));if(u>1)return l/(u-1)},r.deviation=function(){var n=r.variance.apply(this,arguments);return n?Math.sqrt(n):n};var y=v(d);function x(r){return r.length}r.bisectLeft=y.left,r.bisect=r.bisectRight=y.right,r.bisector=function(r){return v(1===r.length?function(n,i){return d(r(n),i)}:r)},r.shuffle=function(r,n,i){(s=arguments.length)<3&&(i=r.length,s<2&&(n=0));for(var a,o,s=i-n;s;)o=Math.random()*s--|0,a=r[s+n],r[s+n]=r[o+n],r[o+n]=a;return r},r.permute=function(r,n){for(var i=n.length,a=Array(i);i--;)a[i]=r[n[i]];return a},r.pairs=function(r){for(var n=0,i=r.length-1,a=r[0],o=Array(i<0?0:i);n<i;)o[n]=[a,a=r[++n]];return o},r.transpose=function(n){if(!(s=n.length))return[];for(var i=-1,a=r.min(n,x),o=Array(a);++i<a;)for(var s,l=-1,c=o[i]=Array(s);++l<s;)c[l]=n[l][i];return o},r.zip=function(){return r.transpose(arguments)},r.keys=function(r){var n=[];for(var i in r)n.push(i);return n},r.values=function(r){var n=[];for(var i in r)n.push(r[i]);return n},r.entries=function(r){var n=[];for(var i in r)n.push({key:i,value:r[i]});return n},r.merge=function(r){for(var n,i,a,o=r.length,s=-1,l=0;++s<o;)l+=r[s].length;for(i=Array(l);--o>=0;)for(n=(a=r[o]).length;--n>=0;)i[--l]=a[n];return i};var b=Math.abs;function _(r,n){for(var i in n)Object.defineProperty(r.prototype,i,{value:n[i],enumerable:!1})}function w(){this._=Object.create(null)}function T(r){return"__proto__"==(r+="")||"\x00"===r[0]?"\x00"+r:r}function k(r){return"\x00"===(r+="")[0]?r.slice(1):r}function A(r){return T(r) in this._}function M(r){return(r=T(r))in this._&&delete this._[r]}function S(){var r=[];for(var n in this._)r.push(k(n));return r}function E(){var r=0;for(var n in this._)++r;return r}function L(){for(var r in this._)return!1;return!0}function C(){this._=Object.create(null)}function P(r){return r}function I(r,n){if(n in r)return n;n=n.charAt(0).toUpperCase()+n.slice(1);for(var i=0,a=O.length;i<a;++i){var o=O[i]+n;if(o in r)return o}}r.range=function(r,n,i){if(arguments.length<3&&(i=1,arguments.length<2&&(n=r,r=0)),(n-r)/i==1/0)throw Error("infinite range");var a,o=[],s=function(r){for(var n=1;r*n%1;)n*=10;return n}(b(i)),l=-1;if(r*=s,n*=s,(i*=s)<0)for(;(a=r+i*++l)>n;)o.push(a/s);else for(;(a=r+i*++l)<n;)o.push(a/s);return o},r.map=function(r,n){var i=new w;if(r instanceof w)r.forEach(function(r,n){i.set(r,n)});else if(Array.isArray(r)){var a,o=-1,s=r.length;if(1==arguments.length)for(;++o<s;)i.set(o,r[o]);else for(;++o<s;)i.set(n.call(r,a=r[o],o),a)}else for(var l in r)i.set(l,r[l]);return i},_(w,{has:A,get:function(r){return this._[T(r)]},set:function(r,n){return this._[T(r)]=n},remove:M,keys:S,values:function(){var r=[];for(var n in this._)r.push(this._[n]);return r},entries:function(){var r=[];for(var n in this._)r.push({key:k(n),value:this._[n]});return r},size:E,empty:L,forEach:function(r){for(var n in this._)r.call(this,k(n),this._[n])}}),r.nest=function(){var n,i,a={},o=[],s=[];function l(r,s,c){if(c>=o.length)return i?i.call(a,s):n?s.sort(n):s;for(var u,f,h,p,d=-1,m=s.length,g=o[c++],v=new w;++d<m;)(p=v.get(u=g(f=s[d])))?p.push(f):v.set(u,[f]);return r?(f=r(),h=function(n,i){f.set(n,l(r,i,c))}):(f={},h=function(n,i){f[n]=l(r,i,c)}),v.forEach(h),f}return a.map=function(r,n){return l(n,r,0)},a.entries=function(n){return function r(n,i){if(i>=o.length)return n;var a=[],l=s[i++];return n.forEach(function(n,o){a.push({key:n,values:r(o,i)})}),l?a.sort(function(r,n){return l(r.key,n.key)}):a}(l(r.map,n,0),0)},a.key=function(r){return o.push(r),a},a.sortKeys=function(r){return s[o.length-1]=r,a},a.sortValues=function(r){return n=r,a},a.rollup=function(r){return i=r,a},a},r.set=function(r){var n=new C;if(r)for(var i=0,a=r.length;i<a;++i)n.add(r[i]);return n},_(C,{has:A,add:function(r){return this._[T(r+="")]=!0,r},remove:M,values:S,size:E,empty:L,forEach:function(r){for(var n in this._)r.call(this,k(n))}}),r.behavior={},r.rebind=function(r,n){for(var i,a=1,o=arguments.length;++a<o;)r[i=arguments[a]]=function(r,n,i){return function(){var a=i.apply(n,arguments);return a===n?r:a}}(r,n,n[i]);return r};var O=["webkit","ms","moz","Moz","o","O"];function z(){}function D(){}function R(r){var n=[],i=new w;function a(){for(var i,a=n,o=-1,s=a.length;++o<s;)(i=a[o].on)&&i.apply(this,arguments);return r}return a.on=function(a,o){var s,l=i.get(a);return arguments.length<2?l&&l.on:(l&&(l.on=null,n=n.slice(0,s=n.indexOf(l)).concat(n.slice(s+1)),i.remove(a)),o&&n.push(i.set(a,{on:o})),r)},a}function F(){r.event.preventDefault()}function B(){for(var n,i=r.event;n=i.sourceEvent;)i=n;return i}function N(n){for(var i=new D,a=0,o=arguments.length;++a<o;)i[arguments[a]]=R(i);return i.of=function(a,o){return function(s){try{var l=s.sourceEvent=r.event;s.target=n,r.event=s,i[s.type].apply(a,o)}finally{r.event=l}}},i}r.dispatch=function(){for(var r=new D,n=-1,i=arguments.length;++n<i;)r[arguments[n]]=R(r);return r},D.prototype.on=function(r,n){var i=r.indexOf("."),a="";if(i>=0&&(a=r.slice(i+1),r=r.slice(0,i)),r)return arguments.length<2?this[r].on(a):this[r].on(a,n);if(2==arguments.length){if(null==n)for(r in this)this.hasOwnProperty(r)&&this[r].on(a,null);return this}},r.event=null,r.requote=function(r){return r.replace(j,"\\$&")};var j=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,U={}.__proto__?function(r,n){r.__proto__=n}:function(r,n){for(var i in n)r[i]=n[i]};function V(r){return U(r,Y),r}var H=function(r,n){return n.querySelector(r)},q=function(r,n){return n.querySelectorAll(r)},G=function(r,n){var i=r.matches||r[I(r,"matchesSelector")];return(G=function(r,n){return i.call(r,n)})(r,n)};"function"==typeof Sizzle&&(H=function(r,n){return Sizzle(r,n)[0]||null},q=Sizzle,G=Sizzle.matchesSelector),r.selection=function(){return r.select(o.documentElement)};var Y=r.selection.prototype=[];function W(r){return"function"==typeof r?r:function(){return H(r,this)}}function X(r){return"function"==typeof r?r:function(){return q(r,this)}}Y.select=function(r){var n,i,a,o,s=[];r=W(r);for(var l=-1,c=this.length;++l<c;){s.push(n=[]),n.parentNode=(a=this[l]).parentNode;for(var u=-1,f=a.length;++u<f;)(o=a[u])?(n.push(i=r.call(o,o.__data__,u,l)),i&&"__data__"in o&&(i.__data__=o.__data__)):n.push(null)}return V(s)},Y.selectAll=function(r){var n,i,o=[];r=X(r);for(var s=-1,l=this.length;++s<l;)for(var c=this[s],u=-1,f=c.length;++u<f;)(i=c[u])&&(o.push(n=a(r.call(i,i.__data__,u,s))),n.parentNode=i);return V(o)};var Z="http://www.w3.org/1999/xhtml",J={svg:"http://www.w3.org/2000/svg",xhtml:Z,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function K(n,i){return n=r.ns.qualify(n),null==i?n.local?function(){this.removeAttributeNS(n.space,n.local)}:function(){this.removeAttribute(n)}:"function"==typeof i?n.local?function(){var r=i.apply(this,arguments);null==r?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,r)}:function(){var r=i.apply(this,arguments);null==r?this.removeAttribute(n):this.setAttribute(n,r)}:n.local?function(){this.setAttributeNS(n.space,n.local,i)}:function(){this.setAttribute(n,i)}}function Q(r){return r.trim().replace(/\s+/g," ")}function $(n){return RegExp("(?:^|\\s+)"+r.requote(n)+"(?:\\s+|$)","g")}function tt(r){return(r+"").trim().split(/^|\s+/)}function te(r,n){var i=(r=tt(r).map(tr)).length;return"function"==typeof n?function(){for(var a=-1,o=n.apply(this,arguments);++a<i;)r[a](this,o)}:function(){for(var a=-1;++a<i;)r[a](this,n)}}function tr(r){var n=$(r);return function(i,a){if(o=i.classList)return a?o.add(r):o.remove(r);var o=i.getAttribute("class")||"";a?(n.lastIndex=0,n.test(o)||i.setAttribute("class",Q(o+" "+r))):i.setAttribute("class",Q(o.replace(n," ")))}}function tn(r,n,i){return null==n?function(){this.style.removeProperty(r)}:"function"==typeof n?function(){var a=n.apply(this,arguments);null==a?this.style.removeProperty(r):this.style.setProperty(r,a,i)}:function(){this.style.setProperty(r,n,i)}}function ti(r,n){return null==n?function(){delete this[r]}:"function"==typeof n?function(){var i=n.apply(this,arguments);null==i?delete this[r]:this[r]=i}:function(){this[r]=n}}function ta(n){return"function"==typeof n?n:(n=r.ns.qualify(n)).local?function(){return this.ownerDocument.createElementNS(n.space,n.local)}:function(){var r=this.ownerDocument,i=this.namespaceURI;return i===Z&&r.documentElement.namespaceURI===Z?r.createElement(n):r.createElementNS(i,n)}}function to(){var r=this.parentNode;r&&r.removeChild(this)}function ts(r){return{__data__:r}}function tl(r){return function(){return G(this,r)}}function tc(r){return arguments.length||(r=d),function(n,i){return n&&i?r(n.__data__,i.__data__):!n-!i}}function tu(r,n){for(var i=0,a=r.length;i<a;i++)for(var o,s=r[i],l=0,c=s.length;l<c;l++)(o=s[l])&&n(o,l,i);return r}function tf(r){return U(r,th),r}r.ns={prefix:J,qualify:function(r){var n=r.indexOf(":"),i=r;return n>=0&&"xmlns"!==(i=r.slice(0,n))&&(r=r.slice(n+1)),J.hasOwnProperty(i)?{space:J[i],local:r}:r}},Y.attr=function(n,i){if(arguments.length<2){if("string"==typeof n){var a=this.node();return(n=r.ns.qualify(n)).local?a.getAttributeNS(n.space,n.local):a.getAttribute(n)}for(i in n)this.each(K(i,n[i]));return this}return this.each(K(n,i))},Y.classed=function(r,n){if(arguments.length<2){if("string"==typeof r){var i=this.node(),a=(r=tt(r)).length,o=-1;if(n=i.classList){for(;++o<a;)if(!n.contains(r[o]))return!1}else for(n=i.getAttribute("class");++o<a;)if(!$(r[o]).test(n))return!1;return!0}for(n in r)this.each(te(n,r[n]));return this}return this.each(te(r,n))},Y.style=function(r,n,i){var a=arguments.length;if(a<3){if("string"!=typeof r){for(i in a<2&&(n=""),r)this.each(tn(i,r[i],n));return this}if(a<2){var o=this.node();return l(o).getComputedStyle(o,null).getPropertyValue(r)}i=""}return this.each(tn(r,n,i))},Y.property=function(r,n){if(arguments.length<2){if("string"==typeof r)return this.node()[r];for(n in r)this.each(ti(n,r[n]));return this}return this.each(ti(r,n))},Y.text=function(r){return arguments.length?this.each("function"==typeof r?function(){var n=r.apply(this,arguments);this.textContent=null==n?"":n}:null==r?function(){this.textContent=""}:function(){this.textContent=r}):this.node().textContent},Y.html=function(r){return arguments.length?this.each("function"==typeof r?function(){var n=r.apply(this,arguments);this.innerHTML=null==n?"":n}:null==r?function(){this.innerHTML=""}:function(){this.innerHTML=r}):this.node().innerHTML},Y.append=function(r){return r=ta(r),this.select(function(){return this.appendChild(r.apply(this,arguments))})},Y.insert=function(r,n){return r=ta(r),n=W(n),this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})},Y.remove=function(){return this.each(to)},Y.data=function(r,n){var i,a,o=-1,s=this.length;if(!arguments.length){for(r=Array(s=(i=this[0]).length);++o<s;)(a=i[o])&&(r[o]=a.__data__);return r}function l(r,i){var a,o,s,l=r.length,h=i.length,p=Math.min(l,h),d=Array(h),m=Array(h),g=Array(l);if(n){var v,y=new w,x=Array(l);for(a=-1;++a<l;)(o=r[a])&&(y.has(v=n.call(o,o.__data__,a))?g[a]=o:y.set(v,o),x[a]=v);for(a=-1;++a<h;)(o=y.get(v=n.call(i,s=i[a],a)))?!0!==o&&(d[a]=o,o.__data__=s):m[a]=ts(s),y.set(v,!0);for(a=-1;++a<l;)a in x&&!0!==y.get(x[a])&&(g[a]=r[a])}else{for(a=-1;++a<p;)o=r[a],s=i[a],o?(o.__data__=s,d[a]=o):m[a]=ts(s);for(;a<h;++a)m[a]=ts(i[a]);for(;a<l;++a)g[a]=r[a]}m.update=d,m.parentNode=d.parentNode=g.parentNode=r.parentNode,c.push(m),u.push(d),f.push(g)}var c=tf([]),u=V([]),f=V([]);if("function"==typeof r)for(;++o<s;)l(i=this[o],r.call(i,i.parentNode.__data__,o));else for(;++o<s;)l(i=this[o],r);return u.enter=function(){return c},u.exit=function(){return f},u},Y.datum=function(r){return arguments.length?this.property("__data__",r):this.property("__data__")},Y.filter=function(r){var n,i,a,o=[];"function"!=typeof r&&(r=tl(r));for(var s=0,l=this.length;s<l;s++){o.push(n=[]),n.parentNode=(i=this[s]).parentNode;for(var c=0,u=i.length;c<u;c++)(a=i[c])&&r.call(a,a.__data__,c,s)&&n.push(a)}return V(o)},Y.order=function(){for(var r=-1,n=this.length;++r<n;)for(var i,a=this[r],o=a.length-1,s=a[o];--o>=0;)(i=a[o])&&(s&&s!==i.nextSibling&&s.parentNode.insertBefore(i,s),s=i);return this},Y.sort=function(r){r=tc.apply(this,arguments);for(var n=-1,i=this.length;++n<i;)this[n].sort(r);return this.order()},Y.each=function(r){return tu(this,function(n,i,a){r.call(n,n.__data__,i,a)})},Y.call=function(r){var n=a(arguments);return r.apply(n[0]=this,n),this},Y.empty=function(){return!this.node()},Y.node=function(){for(var r=0,n=this.length;r<n;r++)for(var i=this[r],a=0,o=i.length;a<o;a++){var s=i[a];if(s)return s}return null},Y.size=function(){var r=0;return tu(this,function(){++r}),r};var th=[];function tp(n,i,o){var s="__on"+n,l=n.indexOf("."),c=tm;l>0&&(n=n.slice(0,l));var u=td.get(n);function f(){var r=this[s];r&&(this.removeEventListener(n,r,r.$),delete this[s])}return u&&(n=u,c=tg),l?i?function(){var r=c(i,a(arguments));f.call(this),this.addEventListener(n,this[s]=r,r.$=o),r._=i}:f:i?z:function(){var i,a=RegExp("^__on([^.]+)"+r.requote(n)+"$");for(var o in this)if(i=o.match(a)){var s=this[o];this.removeEventListener(i[1],s,s.$),delete this[o]}}}r.selection.enter=tf,r.selection.enter.prototype=th,th.append=Y.append,th.empty=Y.empty,th.node=Y.node,th.call=Y.call,th.size=Y.size,th.select=function(r){for(var n,i,a,o,s,l=[],c=-1,u=this.length;++c<u;){a=(o=this[c]).update,l.push(n=[]),n.parentNode=o.parentNode;for(var f=-1,h=o.length;++f<h;)(s=o[f])?(n.push(a[f]=i=r.call(o.parentNode,s.__data__,f,c)),i.__data__=s.__data__):n.push(null)}return V(l)},th.insert=function(r,n){var i,a,o;return arguments.length<2&&(i=this,n=function(r,n,s){var l,c=i[s].update,u=c.length;for(s!=o&&(o=s,a=0),n>=a&&(a=n+1);!(l=c[a])&&++a<u;);return l}),Y.insert.call(this,r,n)},r.select=function(r){var n;return"string"==typeof r?(n=[H(r,o)]).parentNode=o.documentElement:(n=[r]).parentNode=s(r),V([n])},r.selectAll=function(r){var n;return"string"==typeof r?(n=a(q(r,o))).parentNode=o.documentElement:(n=a(r)).parentNode=null,V([n])},Y.on=function(r,n,i){var a=arguments.length;if(a<3){if("string"!=typeof r){for(i in a<2&&(n=!1),r)this.each(tp(i,r[i],n));return this}if(a<2)return(a=this.node()["__on"+r])&&a._;i=!1}return this.each(tp(r,n,i))};var td=r.map({mouseenter:"mouseover",mouseleave:"mouseout"});function tm(n,i){return function(a){var o=r.event;r.event=a,i[0]=this.__data__;try{n.apply(this,i)}finally{r.event=o}}}function tg(r,n){var i=tm(r,n);return function(r){var n=r.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||i.call(this,r)}}o&&td.forEach(function(r){"on"+r in o&&td.remove(r)});var tv,ty=0;function tx(n){var i=".dragsuppress-"+ ++ty,a="click"+i,o=r.select(l(n)).on("touchmove"+i,F).on("dragstart"+i,F).on("selectstart"+i,F);if(null==tv&&(tv=!("onselectstart"in n)&&I(n.style,"userSelect")),tv){var c=s(n).style,u=c[tv];c[tv]="none"}return function(r){if(o.on(i,null),tv&&(c[tv]=u),r){var n=function(){o.on(a,null)};o.on(a,function(){F(),n()},!0),setTimeout(n,0)}}}r.mouse=function(r){return t_(r,B())};var tb=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function t_(n,i){i.changedTouches&&(i=i.changedTouches[0]);var a=n.ownerSVGElement||n;if(a.createSVGPoint){var o=a.createSVGPoint();if(tb<0){var s=l(n);if(s.scrollX||s.scrollY){var c=(a=r.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();tb=!(c.f||c.e),a.remove()}}return tb?(o.x=i.pageX,o.y=i.pageY):(o.x=i.clientX,o.y=i.clientY),[(o=o.matrixTransform(n.getScreenCTM().inverse())).x,o.y]}var u=n.getBoundingClientRect();return[i.clientX-u.left-n.clientLeft,i.clientY-u.top-n.clientTop]}function tw(){return r.event.changedTouches[0].identifier}r.touch=function(r,n,i){if(arguments.length<3&&(i=n,n=B().changedTouches),n){for(var a,o=0,s=n.length;o<s;++o)if((a=n[o]).identifier===i)return t_(r,a)}},r.behavior.drag=function(){var n=N(s,"drag","dragstart","dragend"),i=null,a=c(z,r.mouse,l,"mousemove","mouseup"),o=c(tw,r.touch,P,"touchmove","touchend");function s(){this.on("mousedown.drag",a).on("touchstart.drag",o)}function c(a,o,s,l,c){return function(){var u,f=r.event.target.correspondingElement||r.event.target,h=this.parentNode,p=n.of(this,arguments),d=0,m=a(),g=".drag"+(null==m?"":"-"+m),v=r.select(s(f)).on(l+g,function(){var r,n,i=o(h,m);i&&(r=i[0]-x[0],n=i[1]-x[1],d|=r|n,x=i,p({type:"drag",x:i[0]+u[0],y:i[1]+u[1],dx:r,dy:n}))}).on(c+g,function(){o(h,m)&&(v.on(l+g,null).on(c+g,null),y(d),p({type:"dragend"}))}),y=tx(f),x=o(h,m);u=i?[(u=i.apply(this,arguments)).x-x[0],u.y-x[1]]:[0,0],p({type:"dragstart"})}}return s.origin=function(r){return arguments.length?(i=r,s):i},r.rebind(s,n,"on")},r.touches=function(r,n){return arguments.length<2&&(n=B().touches),n?a(n).map(function(n){var i=t_(r,n);return i.identifier=n.identifier,i}):[]};var tT=Math.PI,tk=2*tT,tA=tk-1e-6,tM=tT/2,tS=tT/180,tE=180/tT;function tL(r){return r>1?tM:r<-1?-tM:Math.asin(r)}function tC(r){return((r=Math.exp(r))+1/r)/2}var tP=Math.SQRT2;r.interpolateZoom=function(r,n){var i,a,o=r[0],s=r[1],l=r[2],c=n[0],u=n[1],f=n[2],h=c-o,p=u-s,d=h*h+p*p;if(d<1e-12)a=Math.log(f/l)/tP,i=function(r){return[o+r*h,s+r*p,l*Math.exp(tP*r*a)]};else{var m=Math.sqrt(d),g=(f*f-l*l+4*d)/(2*l*2*m),v=(f*f-l*l-4*d)/(2*f*2*m),y=Math.log(Math.sqrt(g*g+1)-g);a=(Math.log(Math.sqrt(v*v+1)-v)-y)/tP,i=function(r){var n,i,c=r*a,u=tC(y),f=l/(2*m)*(((i=Math.exp(2*(i=tP*c+y)))-1)/(i+1)*u-((n=Math.exp(n=y))-1/n)/2);return[o+f*h,s+f*p,l*u/tC(tP*c+y)]}}return i.duration=1e3*a,i},r.behavior.zoom=function(){var n,i,a,s,c,u,f,h,p,d={x:0,y:0,k:1},m=[960,500],g=tz,v=250,y=0,x="mousedown.zoom",b="mousemove.zoom",_="mouseup.zoom",w="touchstart.zoom",T=N(k,"zoomstart","zoom","zoomend");function k(r){r.on(x,O).on(tO+".zoom",D).on("dblclick.zoom",R).on(w,z)}function A(r){return[(r[0]-d.x)/d.k,(r[1]-d.y)/d.k]}function M(r){d.k=Math.max(g[0],Math.min(g[1],r))}function S(r,n){var i;n=[(i=n)[0]*d.k+d.x,i[1]*d.k+d.y],d.x+=r[0]-n[0],d.y+=r[1]-n[1]}function E(n,a,o,s){n.__chart__={x:d.x,y:d.y,k:d.k},M(Math.pow(2,s)),S(i=a,o),n=r.select(n),v>0&&(n=n.transition().duration(v)),n.call(k.event)}function L(){f&&f.domain(u.range().map(function(r){return(r-d.x)/d.k}).map(u.invert)),p&&p.domain(h.range().map(function(r){return(r-d.y)/d.k}).map(h.invert))}function C(r){y++||r({type:"zoomstart"})}function P(r){L(),r({type:"zoom",scale:d.k,translate:[d.x,d.y]})}function I(r){--y||(r({type:"zoomend"}),i=null)}function O(){var n=this,i=T.of(n,arguments),a=0,o=r.select(l(n)).on(b,function(){a=1,S(r.mouse(n),s),P(i)}).on(_,function(){o.on(b,null).on(_,null),c(a),I(i)}),s=A(r.mouse(n)),c=tx(n);nH.call(n),C(i)}function z(){var n,i=this,a=T.of(i,arguments),o={},s=0,l=".zoom-"+r.event.changedTouches[0].identifier,u="touchmove"+l,f="touchend"+l,h=[],p=r.select(i),m=tx(i);function g(){var a=r.touches(i);return n=d.k,a.forEach(function(r){r.identifier in o&&(o[r.identifier]=A(r))}),a}function v(){var n=r.event.target;r.select(n).on(u,y).on(f,b),h.push(n);for(var a=r.event.changedTouches,l=0,p=a.length;l<p;++l)o[a[l].identifier]=null;var m=g(),v=Date.now();if(1===m.length){if(v-c<500){var x=m[0];E(i,x,o[x.identifier],Math.floor(Math.log(d.k)/Math.LN2)+1),F()}c=v}else if(m.length>1){x=m[0];var _=m[1],w=x[0]-_[0],T=x[1]-_[1];s=w*w+T*T}}function y(){var l,u,f,h,p=r.touches(i);nH.call(i);for(var d=0,m=p.length;d<m;++d,h=null)if(h=o[(f=p[d]).identifier]){if(u)break;l=f,u=h}if(h){var g=(g=f[0]-l[0])*g+(g=f[1]-l[1])*g,v=s&&Math.sqrt(g/s);l=[(l[0]+f[0])/2,(l[1]+f[1])/2],u=[(u[0]+h[0])/2,(u[1]+h[1])/2],M(v*n)}c=null,S(l,u),P(a)}function b(){if(r.event.touches.length){for(var n=r.event.changedTouches,i=0,s=n.length;i<s;++i)delete o[n[i].identifier];for(var c in o)return void g()}r.selectAll(h).on(l,null),p.on(x,O).on(w,z),m(),I(a)}v(),C(a),p.on(x,null).on(w,v)}function D(){var o=T.of(this,arguments);s?clearTimeout(s):(nH.call(this),n=A(i=a||r.mouse(this)),C(o)),s=setTimeout(function(){s=null,I(o)},50),F(),M(Math.pow(2,.002*tI())*d.k),S(i,n),P(o)}function R(){var n=r.mouse(this),i=Math.log(d.k)/Math.LN2;E(this,n,A(n),r.event.shiftKey?Math.ceil(i)-1:Math.floor(i)+1)}return tO||(tO="onwheel"in o?(tI=function(){return-r.event.deltaY*(r.event.deltaMode?120:1)},"wheel"):"onmousewheel"in o?(tI=function(){return r.event.wheelDelta},"mousewheel"):(tI=function(){return-r.event.detail},"MozMousePixelScroll")),k.event=function(n){n.each(function(){var n=T.of(this,arguments),a=d;nY?r.select(this).transition().each("start.zoom",function(){d=this.__chart__||{x:0,y:0,k:1},C(n)}).tween("zoom:zoom",function(){var o=m[0],s=m[1],l=i?i[0]:o/2,c=i?i[1]:s/2,u=r.interpolateZoom([(l-d.x)/d.k,(c-d.y)/d.k,o/d.k],[(l-a.x)/a.k,(c-a.y)/a.k,o/a.k]);return function(r){var i=u(r),a=o/i[2];this.__chart__=d={x:l-i[0]*a,y:c-i[1]*a,k:a},P(n)}}).each("interrupt.zoom",function(){I(n)}).each("end.zoom",function(){I(n)}):(this.__chart__=d,C(n),P(n),I(n))})},k.translate=function(r){return arguments.length?(d={x:+r[0],y:+r[1],k:d.k},L(),k):[d.x,d.y]},k.scale=function(r){return arguments.length?(d={x:d.x,y:d.y,k:null},M(+r),L(),k):d.k},k.scaleExtent=function(r){return arguments.length?(g=null==r?tz:[+r[0],+r[1]],k):g},k.center=function(r){return arguments.length?(a=r&&[+r[0],+r[1]],k):a},k.size=function(r){return arguments.length?(m=r&&[+r[0],+r[1]],k):m},k.duration=function(r){return arguments.length?(v=+r,k):v},k.x=function(r){return arguments.length?(f=r,u=r.copy(),d={x:0,y:0,k:1},k):f},k.y=function(r){return arguments.length?(p=r,h=r.copy(),d={x:0,y:0,k:1},k):p},r.rebind(k,T,"on")};var tI,tO,tz=[0,1/0];function tD(){}function tR(r,n,i){return this instanceof tR?(this.h=+r,this.s=+n,void(this.l=+i)):arguments.length<2?r instanceof tR?new tR(r.h,r.s,r.l):t0(""+r,t1,tR):new tR(r,n,i)}r.color=tD,tD.prototype.toString=function(){return this.rgb()+""},r.hsl=tR;var tF=tR.prototype=new tD;function tB(r,n,i){var a,o;function s(r){var n;return Math.round(255*((n=r)>360?n-=360:n<0&&(n+=360),n<60?a+(o-a)*n/60:n<180?o:n<240?a+(o-a)*(240-n)/60:a))}return r=isNaN(r)?0:(r%=360)<0?r+360:r,n=isNaN(n)||n<0?0:n>1?1:n,a=2*(i=i<0?0:i>1?1:i)-(o=i<=.5?i*(1+n):i+n-i*n),new tZ(s(r+120),s(r),s(r-120))}function tN(n,i,a){var o,s,l;return this instanceof tN?(this.h=+n,this.c=+i,void(this.l=+a)):arguments.length<2?n instanceof tN?new tN(n.h,n.c,n.l):(o=n instanceof tV?n.l:(n=t2((n=r.rgb(n)).r,n.g,n.b)).l,s=n.a,l=n.b,o>0?new tN(Math.atan2(l,s)*tE,Math.sqrt(s*s+l*l),o):new tN(NaN,NaN,o)):new tN(n,i,a)}tF.brighter=function(r){return r=Math.pow(.7,arguments.length?r:1),new tR(this.h,this.s,this.l/r)},tF.darker=function(r){return r=Math.pow(.7,arguments.length?r:1),new tR(this.h,this.s,r*this.l)},tF.rgb=function(){return tB(this.h,this.s,this.l)},r.hcl=tN;var tj=tN.prototype=new tD;function tU(r,n,i){return isNaN(r)&&(r=0),isNaN(n)&&(n=0),new tV(i,Math.cos(r*=tS)*n,Math.sin(r)*n)}function tV(r,n,i){return this instanceof tV?(this.l=+r,this.a=+n,void(this.b=+i)):arguments.length<2?r instanceof tV?new tV(r.l,r.a,r.b):r instanceof tN?tU(r.h,r.c,r.l):t2((r=tZ(r)).r,r.g,r.b):new tV(r,n,i)}tj.brighter=function(r){return new tN(this.h,this.c,Math.min(100,this.l+tH*(arguments.length?r:1)))},tj.darker=function(r){return new tN(this.h,this.c,Math.max(0,this.l-tH*(arguments.length?r:1)))},tj.rgb=function(){return tU(this.h,this.c,this.l).rgb()},r.lab=tV;var tH=18,tq=tV.prototype=new tD;function tG(r,n,i){var a=(r+16)/116,o=a+n/500,s=a-i/200;return new tZ(tX(3.2404542*(o=.95047*tY(o))-1.5371385*(a=1*tY(a))-.4985314*(s=1.08883*tY(s))),tX(-.969266*o+1.8760108*a+.041556*s),tX(.0556434*o-.2040259*a+1.0572252*s))}function tY(r){return r>.206893034?r*r*r:(r-4/29)/7.787037}function tW(r){return r>.008856?Math.pow(r,1/3):7.787037*r+4/29}function tX(r){return Math.round(255*(r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055))}function tZ(r,n,i){return this instanceof tZ?(this.r=~~r,this.g=~~n,void(this.b=~~i)):arguments.length<2?r instanceof tZ?new tZ(r.r,r.g,r.b):t0(""+r,tZ,tB):new tZ(r,n,i)}function tJ(r){return new tZ(r>>16,r>>8&255,255&r)}function tK(r){return tJ(r)+""}tq.brighter=function(r){return new tV(Math.min(100,this.l+tH*(arguments.length?r:1)),this.a,this.b)},tq.darker=function(r){return new tV(Math.max(0,this.l-tH*(arguments.length?r:1)),this.a,this.b)},tq.rgb=function(){return tG(this.l,this.a,this.b)},r.rgb=tZ;var tQ=tZ.prototype=new tD;function t$(r){return r<16?"0"+Math.max(0,r).toString(16):Math.min(255,r).toString(16)}function t0(r,n,i){var a,o,s,l=0,c=0,u=0;if(a=/([a-z]+)\((.*)\)/.exec(r=r.toLowerCase()))switch(o=a[2].split(","),a[1]){case"hsl":return i(parseFloat(o[0]),parseFloat(o[1])/100,parseFloat(o[2])/100);case"rgb":return n(t5(o[0]),t5(o[1]),t5(o[2]))}return(s=t4.get(r))?n(s.r,s.g,s.b):(null==r||"#"!==r.charAt(0)||isNaN(s=parseInt(r.slice(1),16))||(4===r.length?(l=(3840&s)>>4,l|=l>>4,c=240&s,c|=c>>4,u=15&s,u|=u<<4):7===r.length&&(l=(16711680&s)>>16,c=(65280&s)>>8,u=255&s)),n(l,c,u))}function t1(r,n,i){var a,o,s=Math.min(r/=255,n/=255,i/=255),l=Math.max(r,n,i),c=l-s,u=(l+s)/2;return c?(o=u<.5?c/(l+s):c/(2-l-s),a=(r==l?(n-i)/c+(n<i?6:0):n==l?(i-r)/c+2:(r-n)/c+4)*60):(a=NaN,o=u>0&&u<1?0:a),new tR(a,o,u)}function t2(r,n,i){var a=tW((.4124564*(r=t3(r))+.3575761*(n=t3(n))+.1804375*(i=t3(i)))/.95047),o=tW((.2126729*r+.7151522*n+.072175*i)/1);return tV(116*o-16,500*(a-o),200*(o-tW((.0193339*r+.119192*n+.9503041*i)/1.08883)))}function t3(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function t5(r){var n=parseFloat(r);return"%"===r.charAt(r.length-1)?Math.round(2.55*n):n}tQ.brighter=function(r){r=Math.pow(.7,arguments.length?r:1);var n=this.r,i=this.g,a=this.b;return n||i||a?(n&&n<30&&(n=30),i&&i<30&&(i=30),a&&a<30&&(a=30),new tZ(Math.min(255,n/r),Math.min(255,i/r),Math.min(255,a/r))):new tZ(30,30,30)},tQ.darker=function(r){return new tZ((r=Math.pow(.7,arguments.length?r:1))*this.r,r*this.g,r*this.b)},tQ.hsl=function(){return t1(this.r,this.g,this.b)},tQ.toString=function(){return"#"+t$(this.r)+t$(this.g)+t$(this.b)};var t4=r.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function t6(r){return"function"==typeof r?r:function(){return r}}function t8(r){return function(n,i,a){return 2==arguments.length&&"function"==typeof i&&(a=i,i=null),t9(n,i,r,a)}}function t9(n,i,o,s){var l={},c=r.dispatch("beforesend","progress","load","error"),u={},f=new XMLHttpRequest,h=null;function p(){var r,n,i,a=f.status;if(!a&&((n=(r=f).responseType)&&"text"!==n?r.response:r.responseText)||a>=200&&a<300||304===a){try{i=o.call(l,f)}catch(r){return void c.error.call(l,r)}c.load.call(l,i)}else c.error.call(l,f)}return self.XDomainRequest&&!("withCredentials"in f)&&/^(http(s)?:)?\/\//.test(n)&&(f=new XDomainRequest),"onload"in f?f.onload=f.onerror=p:f.onreadystatechange=function(){f.readyState>3&&p()},f.onprogress=function(n){var i=r.event;r.event=n;try{c.progress.call(l,f)}finally{r.event=i}},l.header=function(r,n){return r=(r+"").toLowerCase(),arguments.length<2?u[r]:(null==n?delete u[r]:u[r]=n+"",l)},l.mimeType=function(r){return arguments.length?(i=null==r?null:r+"",l):i},l.responseType=function(r){return arguments.length?(h=r,l):h},l.response=function(r){return o=r,l},["get","post"].forEach(function(r){l[r]=function(){return l.send.apply(l,[r].concat(a(arguments)))}}),l.send=function(r,a,o){if(2==arguments.length&&"function"==typeof a&&(o=a,a=null),f.open(r,n,!0),null==i||"accept"in u||(u.accept=i+",*/*"),f.setRequestHeader)for(var s in u)f.setRequestHeader(s,u[s]);return null!=i&&f.overrideMimeType&&f.overrideMimeType(i),null!=h&&(f.responseType=h),null!=o&&l.on("error",o).on("load",function(r){o(null,r)}),c.beforesend.call(l,f),f.send(null==a?null:a),l},l.abort=function(){return f.abort(),l},r.rebind(l,c,"on"),null==s?l:l.get(1===s.length?function(r,n){s(null==r?n:null)}:s)}t4.forEach(function(r,n){t4.set(r,tJ(n))}),r.functor=t6,r.xhr=t8(P),r.dsv=function(r,n){var i=RegExp('["'+r+"\n]"),a=r.charCodeAt(0);function o(r,i,a){arguments.length<3&&(a=i,i=null);var o=t9(r,n,null==i?s:l(i),a);return o.row=function(r){return arguments.length?o.response(null==(i=r)?s:l(r)):i},o}function s(r){return o.parse(r.responseText)}function l(r){return function(n){return o.parse(n.responseText,r)}}function c(n){return n.map(u).join(r)}function u(r){return i.test(r)?'"'+r.replace(/\"/g,'""')+'"':r}return o.parse=function(r,n){var i;return o.parseRows(r,function(r,a){if(i)return i(r,a-1);var o=function(n){for(var i={},a=r.length,o=0;o<a;++o)i[r[o]]=n[o];return i};i=n?function(r,i){return n(o(r),i)}:o})},o.parseRows=function(r,n){var i,o,s={},l={},c=[],u=r.length,f=0,h=0;function p(){if(f>=u)return l;if(o)return o=!1,s;var n=f;if(34===r.charCodeAt(n)){for(var i=n;i++<u;)if(34===r.charCodeAt(i)){if(34!==r.charCodeAt(i+1))break;++i}return f=i+2,13===(c=r.charCodeAt(i+1))?(o=!0,10===r.charCodeAt(i+2)&&++f):10===c&&(o=!0),r.slice(n+1,i).replace(/""/g,'"')}for(;f<u;){var c,h=1;if(10===(c=r.charCodeAt(f++)))o=!0;else if(13===c)o=!0,10===r.charCodeAt(f)&&(++f,++h);else if(c!==a)continue;return r.slice(n,f-h)}return r.slice(n)}for(;(i=p())!==l;){for(var d=[];i!==s&&i!==l;)d.push(i),i=p();n&&null==(d=n(d,h++))||c.push(d)}return c},o.format=function(n){if(Array.isArray(n[0]))return o.formatRows(n);var i=new C,a=[];return n.forEach(function(r){for(var n in r)i.has(n)||a.push(i.add(n))}),[a.map(u).join(r)].concat(n.map(function(n){return a.map(function(r){return u(n[r])}).join(r)})).join("\n")},o.formatRows=function(r){return r.map(c).join("\n")},o},r.csv=r.dsv(",","text/csv"),r.tsv=r.dsv("	","text/tab-separated-values");var t7,et,ee,er,en=this[I(this,"requestAnimationFrame")]||function(r){setTimeout(r,17)};function ei(r,n,i){var a=arguments.length;a<2&&(n=0),a<3&&(i=Date.now());var o={c:r,t:i+n,n:null};return et?et.n=o:t7=o,et=o,ee||(er=clearTimeout(er),ee=1,en(ea)),o}function ea(){var r=eo(),n=es()-r;n>24?(isFinite(n)&&(clearTimeout(er),er=setTimeout(ea,n)),ee=0):(ee=1,en(ea))}function eo(){for(var r=Date.now(),n=t7;n;)r>=n.t&&n.c(r-n.t)&&(n.c=null),n=n.n;return r}function es(){for(var r,n=t7,i=1/0;n;)n.c?(n.t<i&&(i=n.t),n=(r=n).n):n=r?r.n=n.n:t7=n.n;return et=r,i}function el(r){return r[0]}function ec(r){return r[1]}function eu(r){for(var n,i,a,o=r.length,s=[0,1],l=2,c=2;c<o;c++){for(;l>1&&(n=r[s[l-2]],i=r[s[l-1]],a=r[c],(i[0]-n[0])*(a[1]-n[1])-(i[1]-n[1])*(a[0]-n[0])<=0);)--l;s[l++]=c}return s.slice(0,l)}function ef(r,n){return r[0]-n[0]||r[1]-n[1]}r.timer=function(){ei.apply(this,arguments)},r.timer.flush=function(){eo(),es()},r.round=function(r,n){return n?Math.round(r*(n=Math.pow(10,n)))/n:Math.round(r)},r.geom={},r.geom.hull=function(r){var n=el,i=ec;if(arguments.length)return a(r);function a(r){if(r.length<3)return[];var a,o=t6(n),s=t6(i),l=r.length,c=[],u=[];for(a=0;a<l;a++)c.push([+o.call(this,r[a],a),+s.call(this,r[a],a),a]);for(c.sort(ef),a=0;a<l;a++)u.push([c[a][0],-c[a][1]]);var f=eu(c),h=eu(u),p=h[0]===f[0],d=h[h.length-1]===f[f.length-1],m=[];for(a=f.length-1;a>=0;--a)m.push(r[c[f[a]][2]]);for(a=+p;a<h.length-d;++a)m.push(r[c[h[a]][2]]);return m}return a.x=function(r){return arguments.length?(n=r,a):n},a.y=function(r){return arguments.length?(i=r,a):i},a},r.geom.polygon=function(r){return U(r,eh),r};var eh=r.geom.polygon.prototype=[];function ep(r,n,i){return(i[0]-n[0])*(r[1]-n[1])<(i[1]-n[1])*(r[0]-n[0])}function ed(r,n,i,a){var o=r[0],s=i[0],l=n[0]-o,c=a[0]-s,u=r[1],f=i[1],h=n[1]-u,p=a[1]-f,d=(c*(u-f)-p*(o-s))/(p*l-c*h);return[o+d*l,u+d*h]}function em(r){var n=r[0],i=r[r.length-1];return!(n[0]-i[0]||n[1]-i[1])}eh.area=function(){for(var r,n=-1,i=this.length,a=this[i-1],o=0;++n<i;)r=a,a=this[n],o+=r[1]*a[0]-r[0]*a[1];return .5*o},eh.centroid=function(r){var n,i,a=-1,o=this.length,s=0,l=0,c=this[o-1];for(arguments.length||(r=-1/(6*this.area()));++a<o;)n=c,c=this[a],i=n[0]*c[1]-c[0]*n[1],s+=(n[0]+c[0])*i,l+=(n[1]+c[1])*i;return[s*r,l*r]},eh.clip=function(r){for(var n,i,a,o,s,l,c=em(r),u=-1,f=this.length-em(this),h=this[f-1];++u<f;){for(n=r.slice(),r.length=0,o=this[u],s=n[(a=n.length-c)-1],i=-1;++i<a;)ep(l=n[i],h,o)?(ep(s,h,o)||r.push(ed(s,l,h,o)),r.push(l)):ep(s,h,o)&&r.push(ed(s,l,h,o)),s=l;c&&r.push(r[0]),h=o}return r};var eg,ev,ey,ex,eb,e_=[],ew=[];function eT(){eF(this),this.edge=this.site=this.circle=null}function ek(r){var n=e_.pop()||new eT;return n.site=r,n}function eA(r){eP(r),ey.remove(r),e_.push(r),eF(r)}function eM(r,n){var i=r.site,a=i.x,o=i.y,s=o-n;if(!s)return a;var l=r.P;if(!l)return-1/0;var c=(i=l.site).x,u=i.y,f=u-n;if(!f)return c;var h=c-a,p=1/s-1/f,d=h/f;return p?(-d+Math.sqrt(d*d-2*p*(h*h/(-2*f)-u+f/2+o-s/2)))/p+a:(a+c)/2}function eS(r){this.site=r,this.edges=[]}function eE(r,n){return n.angle-r.angle}function eL(){eF(this),this.x=this.y=this.arc=this.site=this.cy=null}function eC(r){var n=r.P,i=r.N;if(n&&i){var a=n.site,o=r.site,s=i.site;if(a!==s){var l=o.x,c=o.y,u=a.x-l,f=a.y-c,h=s.x-l,p=2*(u*(y=s.y-c)-f*h);if(!(p>=-.000000000001)){var d=u*u+f*f,m=h*h+y*y,g=(y*d-f*m)/p,v=(u*m-h*d)/p,y=v+c,x=ew.pop()||new eL;x.arc=r,x.site=o,x.x=g+l,x.y=y+Math.sqrt(g*g+v*v),x.cy=y,r.circle=x;for(var b=null,_=eb._;_;)if(x.y<_.y||x.y===_.y&&x.x<=_.x){if(!_.L){b=_.P;break}_=_.L}else{if(!_.R){b=_;break}_=_.R}eb.insert(b,x),b||(ex=x)}}}}function eP(r){var n=r.circle;n&&(n.P||(ex=n.N),eb.remove(n),ew.push(n),eF(n),r.circle=null)}function eI(r,n){this.l=r,this.r=n,this.a=this.b=null}function eO(r,n,i,a){var o=new eI(r,n);return eg.push(o),i&&ez(o,r,n,i),a&&ez(o,n,r,a),ev[r.i].edges.push(new eD(o,r,n)),ev[n.i].edges.push(new eD(o,n,r)),o}function ez(r,n,i,a){r.a||r.b?r.l===i?r.b=a:r.a=a:(r.a=a,r.l=n,r.r=i)}function eD(r,n,i){var a=r.a,o=r.b;this.edge=r,this.site=n,this.angle=i?Math.atan2(i.y-n.y,i.x-n.x):r.l===n?Math.atan2(o.x-a.x,a.y-o.y):Math.atan2(a.x-o.x,o.y-a.y)}function eR(){this._=null}function eF(r){r.U=r.C=r.L=r.R=r.P=r.N=null}function eB(r,n){var i=n.R,a=n.U;a?a.L===n?a.L=i:a.R=i:r._=i,i.U=a,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function eN(r,n){var i=n.L,a=n.U;a?a.L===n?a.L=i:a.R=i:r._=i,i.U=a,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function ej(r){for(;r.L;)r=r.L;return r}function eU(r,n){var i,a,o,s=r.sort(eV).pop();for(eg=[],ev=Array(r.length),ey=new eR,eb=new eR;;)if(o=ex,s&&(!o||s.y<o.y||s.y===o.y&&s.x<o.x))s.x===i&&s.y===a||(ev[s.i]=new eS(s),function(r){for(var n,i,a,o,s=r.x,l=r.y,c=ey._;c;)if((a=eM(c,l)-s)>1e-6)c=c.L;else{if(!((o=s-function(r,n){var i=r.N;if(i)return eM(i,n);var a=r.site;return a.y===n?a.x:1/0}(c,l))>1e-6)){a>-.000001?(n=c.P,i=c):o>-.000001?(n=c,i=c.N):n=i=c;break}if(!c.R){n=c;break}c=c.R}var u=ek(r);if(ey.insert(n,u),n||i){if(n===i)return eP(n),i=ek(n.site),ey.insert(u,i),u.edge=i.edge=eO(n.site,u.site),eC(n),void eC(i);if(i){eP(n),eP(i);var f=n.site,h=f.x,p=f.y,d=r.x-h,m=r.y-p,g=i.site,v=g.x-h,y=g.y-p,x=2*(d*y-m*v),b=d*d+m*m,_=v*v+y*y,w={x:(y*b-m*_)/x+h,y:(d*_-v*b)/x+p};ez(i.edge,f,g,w),u.edge=eO(f,r,null,w),i.edge=eO(r,g,null,w),eC(n),eC(i)}else u.edge=eO(n.site,u.site)}}(s),i=s.x,a=s.y),s=r.pop();else{if(!o)break;!function(r){var n=r.circle,i=n.x,a=n.cy,o={x:i,y:a},s=r.P,l=r.N,c=[r];eA(r);for(var u=s;u.circle&&1e-6>b(i-u.circle.x)&&1e-6>b(a-u.circle.cy);)s=u.P,c.unshift(u),eA(u),u=s;c.unshift(u),eP(u);for(var f=l;f.circle&&1e-6>b(i-f.circle.x)&&1e-6>b(a-f.circle.cy);)l=f.N,c.push(f),eA(f),f=l;c.push(f),eP(f);var h,p=c.length;for(h=1;h<p;++h)f=c[h],u=c[h-1],ez(f.edge,u.site,f.site,o);u=c[0],(f=c[p-1]).edge=eO(u.site,f.site,null,o),eC(u),eC(f)}(o.arc)}n&&(function(r){for(var n,i,a,o,s,l=eg,c=(i=r[0][0],a=r[0][1],o=r[1][0],s=r[1][1],function(r){var n,l=r.a,c=r.b,u=l.x,f=l.y,h=0,p=1,d=c.x-u,m=c.y-f;if(n=i-u,d||!(n>0)){if(n/=d,d<0){if(n<h)return;n<p&&(p=n)}else if(d>0){if(n>p)return;n>h&&(h=n)}if(n=o-u,d||!(n<0)){if(n/=d,d<0){if(n>p)return;n>h&&(h=n)}else if(d>0){if(n<h)return;n<p&&(p=n)}if(n=a-f,m||!(n>0)){if(n/=m,m<0){if(n<h)return;n<p&&(p=n)}else if(m>0){if(n>p)return;n>h&&(h=n)}if(n=s-f,m||!(n<0)){if(n/=m,m<0){if(n>p)return;n>h&&(h=n)}else if(m>0){if(n<h)return;n<p&&(p=n)}return h>0&&(r.a={x:u+h*d,y:f+h*m}),p<1&&(r.b={x:u+p*d,y:f+p*m}),r}}}}}),u=l.length;u--;)(!function(r,n){var i=r.b;if(i)return!0;var a,o,s=r.a,l=n[0][0],c=n[1][0],u=n[0][1],f=n[1][1],h=r.l,p=r.r,d=h.x,m=h.y,g=p.x,v=p.y,y=(d+g)/2;if(v===m){if(y<l||y>=c)return;if(d>g){if(s){if(s.y>=f)return}else s={x:y,y:u};i={x:y,y:f}}else{if(s){if(s.y<u)return}else s={x:y,y:f};i={x:y,y:u}}}else if(o=(m+v)/2-(a=(d-g)/(v-m))*y,a<-1||a>1){if(d>g){if(s){if(s.y>=f)return}else s={x:(u-o)/a,y:u};i={x:(f-o)/a,y:f}}else{if(s){if(s.y<u)return}else s={x:(f-o)/a,y:f};i={x:(u-o)/a,y:u}}}else if(m<v){if(s){if(s.x>=c)return}else s={x:l,y:a*l+o};i={x:c,y:a*c+o}}else{if(s){if(s.x<l)return}else s={x:c,y:a*c+o};i={x:l,y:a*l+o}}return r.a=s,r.b=i,!0}(n=l[u],r)||!c(n)||1e-6>b(n.a.x-n.b.x)&&1e-6>b(n.a.y-n.b.y))&&(n.a=n.b=null,l.splice(u,1))}(n),function(r){for(var n,i,a,o,s,l,c,u,f,h,p=r[0][0],d=r[1][0],m=r[0][1],g=r[1][1],v=ev,y=v.length;y--;)if((s=v[y])&&s.prepare())for(u=(c=s.edges).length,l=0;l<u;)a=(h=c[l].end()).x,o=h.y,n=(f=c[++l%u].start()).x,i=f.y,(b(a-n)>1e-6||b(o-i)>1e-6)&&(c.splice(l,0,new eD(function(r,n,i){var a=new eI(r,null);return a.a=n,a.b=i,eg.push(a),a}(s.site,h,1e-6>b(a-p)&&g-o>1e-6?{x:p,y:1e-6>b(n-p)?i:g}:1e-6>b(o-g)&&d-a>1e-6?{x:1e-6>b(i-g)?n:d,y:g}:1e-6>b(a-d)&&o-m>1e-6?{x:d,y:1e-6>b(n-d)?i:m}:1e-6>b(o-m)&&a-p>1e-6?{x:1e-6>b(i-m)?n:p,y:m}:null),s.site,null)),++u)}(n));var l={cells:ev,edges:eg};return ey=eb=eg=ev=null,l}function eV(r,n){return n.y-r.y||n.x-r.x}eS.prototype.prepare=function(){for(var r,n=this.edges,i=n.length;i--;)(r=n[i].edge).b&&r.a||n.splice(i,1);return n.sort(eE),n.length},eD.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},eR.prototype={insert:function(r,n){var i,a,o;if(r){if(n.P=r,n.N=r.N,r.N&&(r.N.P=n),r.N=n,r.R){for(r=r.R;r.L;)r=r.L;r.L=n}else r.R=n;i=r}else this._?(r=ej(this._),n.P=null,n.N=r,r.P=r.L=n,i=r):(n.P=n.N=null,this._=n,i=null);for(n.L=n.R=null,n.U=i,n.C=!0,r=n;i&&i.C;)i===(a=i.U).L?(o=a.R)&&o.C?(i.C=o.C=!1,a.C=!0,r=a):(r===i.R&&(eB(this,i),i=(r=i).U),i.C=!1,a.C=!0,eN(this,a)):(o=a.L)&&o.C?(i.C=o.C=!1,a.C=!0,r=a):(r===i.L&&(eN(this,i),i=(r=i).U),i.C=!1,a.C=!0,eB(this,a)),i=r.U;this._.C=!1},remove:function(r){r.N&&(r.N.P=r.P),r.P&&(r.P.N=r.N),r.N=r.P=null;var n,i,a,o=r.U,s=r.L,l=r.R;if(i=s?l?ej(l):s:l,o?o.L===r?o.L=i:o.R=i:this._=i,s&&l?(a=i.C,i.C=r.C,i.L=s,s.U=i,i!==l?(o=i.U,i.U=r.U,r=i.R,o.L=r,i.R=l,l.U=i):(i.U=o,o=i,r=i.R)):(a=r.C,r=i),r&&(r.U=o),!a){if(r&&r.C)r.C=!1;else{do{if(r===this._)break;if(r===o.L){if((n=o.R).C&&(n.C=!1,o.C=!0,eB(this,o),n=o.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,eN(this,n),n=o.R),n.C=o.C,o.C=n.R.C=!1,eB(this,o),r=this._;break}}else if((n=o.L).C&&(n.C=!1,o.C=!0,eN(this,o),n=o.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,eB(this,n),n=o.L),n.C=o.C,o.C=n.L.C=!1,eN(this,o),r=this._;break}n.C=!0,r=o,o=o.U}while(!r.C);r&&(r.C=!1)}}}},r.geom.voronoi=function(r){var n=el,i=ec,a=n,o=i,s=eH;if(r)return l(r);function l(r){var n=Array(r.length),i=s[0][0],a=s[0][1],o=s[1][0],l=s[1][1];return eU(c(r),s).cells.forEach(function(s,c){var u=s.edges,f=s.site;(n[c]=u.length?u.map(function(r){var n=r.start();return[n.x,n.y]}):f.x>=i&&f.x<=o&&f.y>=a&&f.y<=l?[[i,l],[o,l],[o,a],[i,a]]:[]).point=r[c]}),n}function c(r){return r.map(function(r,n){return{x:1e-6*Math.round(a(r,n)/1e-6),y:1e-6*Math.round(o(r,n)/1e-6),i:n}})}return l.links=function(r){return eU(c(r)).edges.filter(function(r){return r.l&&r.r}).map(function(n){return{source:r[n.l.i],target:r[n.r.i]}})},l.triangles=function(r){var n=[];return eU(c(r)).cells.forEach(function(i,a){for(var o,s,l=i.site,c=i.edges.sort(eE),u=-1,f=c.length,h=c[f-1].edge,p=h.l===l?h.r:h.l;++u<f;)o=p,p=(h=c[u].edge).l===l?h.r:h.l,a<o.i&&a<p.i&&(s=p,(l.x-s.x)*(o.y-l.y)-(l.x-o.x)*(s.y-l.y)<0)&&n.push([r[a],r[o.i],r[p.i]])}),n},l.x=function(r){return arguments.length?(a=t6(n=r),l):n},l.y=function(r){return arguments.length?(o=t6(i=r),l):i},l.clipExtent=function(r){return arguments.length?(s=null==r?eH:r,l):s===eH?null:s},l.size=function(r){return arguments.length?l.clipExtent(r&&[[0,0],r]):s===eH?null:s&&s[1]},l};var eH=[[-1e6,-1e6],[1e6,1e6]];function eq(r){return r.x}function eG(r){return r.y}function eY(n,i){n=r.rgb(n),i=r.rgb(i);var a=n.r,o=n.g,s=n.b,l=i.r-a,c=i.g-o,u=i.b-s;return function(r){return"#"+t$(Math.round(a+l*r))+t$(Math.round(o+c*r))+t$(Math.round(s+u*r))}}function eW(r,n){var i,a={},o={};for(i in r)i in n?a[i]=eQ(r[i],n[i]):o[i]=r[i];for(i in n)i in r||(o[i]=n[i]);return function(r){for(i in a)o[i]=a[i](r);return o}}function eX(r,n){return r=+r,n=+n,function(i){return r*(1-i)+n*i}}function eZ(r,n){var i,a,o,s=eJ.lastIndex=eK.lastIndex=0,l=-1,c=[],u=[];for(r+="",n+="";(i=eJ.exec(r))&&(a=eK.exec(n));)(o=a.index)>s&&(o=n.slice(s,o),c[l]?c[l]+=o:c[++l]=o),(i=i[0])===(a=a[0])?c[l]?c[l]+=a:c[++l]=a:(c[++l]=null,u.push({i:l,x:eX(i,a)})),s=eK.lastIndex;return s<n.length&&(o=n.slice(s),c[l]?c[l]+=o:c[++l]=o),c.length<2?u[0]?(n=u[0].x,function(r){return n(r)+""}):function(){return n}:(n=u.length,function(r){for(var i,a=0;a<n;++a)c[(i=u[a]).i]=i.x(r);return c.join("")})}r.geom.delaunay=function(n){return r.geom.voronoi().triangles(n)},r.geom.quadtree=function(r,n,i,a,o){var s,l=el,c=ec;if(s=arguments.length)return l=eq,c=eG,3===s&&(o=i,a=n,i=n=0),u(r);function u(r){var u,f,h,p,d,m,g,v,y,x=t6(l),_=t6(c);if(null!=n)m=n,g=i,v=a,y=o;else if(v=y=-(m=g=1/0),f=[],h=[],d=r.length,s)for(p=0;p<d;++p)(u=r[p]).x<m&&(m=u.x),u.y<g&&(g=u.y),u.x>v&&(v=u.x),u.y>y&&(y=u.y),f.push(u.x),h.push(u.y);else for(p=0;p<d;++p){var w=+x(u=r[p],p),T=+_(u,p);w<m&&(m=w),T<g&&(g=T),w>v&&(v=w),T>y&&(y=T),f.push(w),h.push(T)}var k=v-m,A=y-g;function M(r,n,i,a,o,s,l,c){if(!isNaN(i)&&!isNaN(a)){if(r.leaf){var u=r.x,f=r.y;if(null!=u){if(b(u-i)+b(f-a)<.01)S(r,n,i,a,o,s,l,c);else{var h=r.point;r.x=r.y=r.point=null,S(r,h,u,f,o,s,l,c),S(r,n,i,a,o,s,l,c)}}else r.x=i,r.y=a,r.point=n}else S(r,n,i,a,o,s,l,c)}}function S(r,n,i,a,o,s,l,c){var u=.5*(o+l),f=.5*(s+c),h=i>=u,p=a>=f,d=p<<1|h;r.leaf=!1,h?o=u:l=u,p?s=f:c=f,M(r=r.nodes[d]||(r.nodes[d]={leaf:!0,nodes:[],point:null,x:null,y:null}),n,i,a,o,s,l,c)}k>A?y=g+k:v=m+A;var E={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(r){M(E,r,+x(r,++p),+_(r,p),m,g,v,y)},visit:function(r){(function r(n,i,a,o,s,l){if(!n(i,a,o,s,l)){var c=.5*(a+s),u=.5*(o+l),f=i.nodes;f[0]&&r(n,f[0],a,o,c,u),f[1]&&r(n,f[1],c,o,s,u),f[2]&&r(n,f[2],a,u,c,l),f[3]&&r(n,f[3],c,u,s,l)}})(r,E,m,g,v,y)},find:function(r){var n,i,a,o,s,l,c,u;return n=r[0],i=r[1],u=1/0,function r(f,h,p,d,m){if(!(h>s||p>l||d<a||m<o)){if(g=f.point){var g,v=n-f.x,y=i-f.y,x=v*v+y*y;if(x<u){var b=Math.sqrt(u=x);a=n-b,o=i-b,s=n+b,l=i+b,c=g}}for(var _=f.nodes,w=.5*(h+d),T=.5*(p+m),k=(i>=T)<<1|n>=w,A=k+4;k<A;++k)if(f=_[3&k])switch(3&k){case 0:r(f,h,p,w,T);break;case 1:r(f,w,p,d,T);break;case 2:r(f,h,T,w,m);break;case 3:r(f,w,T,d,m)}}}(E,a=m,o=g,s=v,l=y),c}};if(p=-1,null==n){for(;++p<d;)M(E,r[p],f[p],h[p],m,g,v,y);--p}else r.forEach(E.add);return f=h=r=u=null,E}return u.x=function(r){return arguments.length?(l=r,u):l},u.y=function(r){return arguments.length?(c=r,u):c},u.extent=function(r){return arguments.length?(null==r?n=i=a=o=null:(n=+r[0][0],i=+r[0][1],a=+r[1][0],o=+r[1][1]),u):null==n?null:[[n,i],[a,o]]},u.size=function(r){return arguments.length?(null==r?n=i=a=o=null:(n=i=0,a=+r[0],o=+r[1]),u):null==n?null:[a-n,o-i]},u},r.interpolateRgb=eY,r.interpolateObject=eW,r.interpolateNumber=eX,r.interpolateString=eZ;var eJ=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eK=RegExp(eJ.source,"g");function eQ(n,i){for(var a,o=r.interpolators.length;--o>=0&&!(a=r.interpolators[o](n,i)););return a}function e$(r,n){var i,a=[],o=[],s=r.length,l=n.length,c=Math.min(r.length,n.length);for(i=0;i<c;++i)a.push(eQ(r[i],n[i]));for(;i<s;++i)o[i]=r[i];for(;i<l;++i)o[i]=n[i];return function(r){for(i=0;i<c;++i)o[i]=a[i](r);return o}}r.interpolate=eQ,r.interpolators=[function(r,n){var i=typeof n;return("string"===i?t4.has(n.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(n)?eY:eZ:n instanceof tD?eY:Array.isArray(n)?e$:"object"===i&&isNaN(n)?eW:eX)(r,n)}],r.interpolateArray=e$;var e0=function(){return P},e1=r.map({linear:e0,poly:function(r){return function(n){return Math.pow(n,r)}},quad:function(){return e4},cubic:function(){return e6},sin:function(){return e9},exp:function(){return e7},circle:function(){return rt},elastic:function(r,n){var i;return arguments.length<2&&(n=.45),arguments.length?i=n/tk*Math.asin(1/r):(r=1,i=n/4),function(a){return 1+r*Math.pow(2,-10*a)*Math.sin((a-i)*tk/n)}},back:function(r){return r||(r=1.70158),function(n){return n*n*((r+1)*n-r)}},bounce:function(){return re}}),e2=r.map({in:P,out:e3,"in-out":e5,"out-in":function(r){return e5(e3(r))}});function e3(r){return function(n){return 1-r(1-n)}}function e5(r){return function(n){return .5*(n<.5?r(2*n):2-r(2-2*n))}}function e4(r){return r*r}function e6(r){return r*r*r}function e8(r){if(r<=0)return 0;if(r>=1)return 1;var n=r*r,i=n*r;return 4*(r<.5?i:3*(r-n)+i-.75)}function e9(r){return 1-Math.cos(r*tM)}function e7(r){return Math.pow(2,10*(r-1))}function rt(r){return 1-Math.sqrt(1-r*r)}function re(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375}function rr(r,n){return n-=r,function(i){return Math.round(r+n*i)}}function rn(r){var n,i=[r.a,r.b],a=[r.c,r.d],o=ra(i),s=ri(i,a),l=ra((a[0]+=(n=-s)*i[0],a[1]+=n*i[1],a))||0;i[0]*a[1]<a[0]*i[1]&&(i[0]*=-1,i[1]*=-1,o*=-1,s*=-1),this.rotate=(o?Math.atan2(i[1],i[0]):Math.atan2(-a[0],a[1]))*tE,this.translate=[r.e,r.f],this.scale=[o,l],this.skew=l?Math.atan2(s,l)*tE:0}function ri(r,n){return r[0]*n[0]+r[1]*n[1]}function ra(r){var n=Math.sqrt(ri(r,r));return n&&(r[0]/=n,r[1]/=n),n}r.ease=function(r){var n,a=r.indexOf("-"),o=a>=0?r.slice(0,a):r,s=a>=0?r.slice(a+1):"in";return o=e1.get(o)||e0,n=(s=e2.get(s)||P)(o.apply(null,i.call(arguments,1))),function(r){return r<=0?0:r>=1?1:n(r)}},r.interpolateHcl=function(n,i){n=r.hcl(n),i=r.hcl(i);var a=n.h,o=n.c,s=n.l,l=i.h-a,c=i.c-o,u=i.l-s;return isNaN(c)&&(c=0,o=isNaN(o)?i.c:o),isNaN(l)?(l=0,a=isNaN(a)?i.h:a):l>180?l-=360:l<-180&&(l+=360),function(r){return tU(a+l*r,o+c*r,s+u*r)+""}},r.interpolateHsl=function(n,i){n=r.hsl(n),i=r.hsl(i);var a=n.h,o=n.s,s=n.l,l=i.h-a,c=i.s-o,u=i.l-s;return isNaN(c)&&(c=0,o=isNaN(o)?i.s:o),isNaN(l)?(l=0,a=isNaN(a)?i.h:a):l>180?l-=360:l<-180&&(l+=360),function(r){return tB(a+l*r,o+c*r,s+u*r)+""}},r.interpolateLab=function(n,i){n=r.lab(n),i=r.lab(i);var a=n.l,o=n.a,s=n.b,l=i.l-a,c=i.a-o,u=i.b-s;return function(r){return tG(a+l*r,o+c*r,s+u*r)+""}},r.interpolateRound=rr,r.transform=function(n){var i=o.createElementNS(r.ns.prefix.svg,"g");return(r.transform=function(r){if(null!=r){i.setAttribute("transform",r);var n=i.transform.baseVal.consolidate()}return new rn(n?n.matrix:ro)})(n)},rn.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ro={a:1,b:0,c:0,d:1,e:0,f:0};function rs(r){return r.length?r.pop()+",":""}function rl(n,i){var a,o,s,l,c=[],u=[];return n=r.transform(n),i=r.transform(i),function(r,n,i,a){if(r[0]!==n[0]||r[1]!==n[1]){var o=i.push("translate(",null,",",null,")");a.push({i:o-4,x:eX(r[0],n[0])},{i:o-2,x:eX(r[1],n[1])})}else(n[0]||n[1])&&i.push("translate("+n+")")}(n.translate,i.translate,c,u),(a=n.rotate)!==(o=i.rotate)?(a-o>180?o+=360:o-a>180&&(a+=360),u.push({i:c.push(rs(c)+"rotate(",null,")")-2,x:eX(a,o)})):o&&c.push(rs(c)+"rotate("+o+")"),(s=n.skew)!==(l=i.skew)?u.push({i:c.push(rs(c)+"skewX(",null,")")-2,x:eX(s,l)}):l&&c.push(rs(c)+"skewX("+l+")"),function(r,n,i,a){if(r[0]!==n[0]||r[1]!==n[1]){var o=i.push(rs(i)+"scale(",null,",",null,")");a.push({i:o-4,x:eX(r[0],n[0])},{i:o-2,x:eX(r[1],n[1])})}else 1===n[0]&&1===n[1]||i.push(rs(i)+"scale("+n+")")}(n.scale,i.scale,c,u),n=i=null,function(r){for(var n,i=-1,a=u.length;++i<a;)c[(n=u[i]).i]=n.x(r);return c.join("")}}function rc(r,n){return n=(n-=r=+r)||1/n,function(i){return(i-r)/n}}function ru(r,n){return n=(n-=r=+r)||1/n,function(i){return Math.max(0,Math.min(1,(i-r)/n))}}function rf(r){for(var n=[],i=r.parent;null!=i;)n.push(r),r=i,i=i.parent;return n.push(r),n}function rh(r){r.fixed|=2}function rp(r){r.fixed&=-7}function rd(r){r.fixed|=4,r.px=r.x,r.py=r.y}function rm(r){r.fixed&=-5}r.interpolateTransform=rl,r.layout={},r.layout.bundle=function(){return function(r){for(var n=[],i=-1,a=r.length;++i<a;)n.push(function(r){for(var n=r.source,i=r.target,a=function(r,n){if(r===n)return r;for(var i=rf(r),a=rf(n),o=i.pop(),s=a.pop(),l=null;o===s;)l=o,o=i.pop(),s=a.pop();return l}(n,i),o=[n];n!==a;)o.push(n=n.parent);for(var s=o.length;i!==a;)o.splice(s,0,i),i=i.parent;return o}(r[i]));return n}},r.layout.chord=function(){var n,i,a,o,s,l,c,u={},f=0;function h(){var u,h,d,m,g,v={},y=[],x=r.range(o),b=[];for(n=[],i=[],u=0,m=-1;++m<o;){for(h=0,g=-1;++g<o;)h+=a[m][g];y.push(h),b.push(r.range(o)),u+=h}for(s&&x.sort(function(r,n){return s(y[r],y[n])}),l&&b.forEach(function(r,n){r.sort(function(r,i){return l(a[n][r],a[n][i])})}),u=(tk-f*o)/u,h=0,m=-1;++m<o;){for(d=h,g=-1;++g<o;){var _=x[m],w=b[_][g],T=a[_][w],k=h,A=h+=T*u;v[_+"-"+w]={index:_,subindex:w,startAngle:k,endAngle:A,value:T}}i[_]={index:_,startAngle:d,endAngle:h,value:y[_]},h+=f}for(m=-1;++m<o;)for(g=m-1;++g<o;){var M=v[m+"-"+g],S=v[g+"-"+m];(M.value||S.value)&&n.push(M.value<S.value?{source:S,target:M}:{source:M,target:S})}c&&p()}function p(){n.sort(function(r,n){return c((r.source.value+r.target.value)/2,(n.source.value+n.target.value)/2)})}return u.matrix=function(r){return arguments.length?(o=(a=r)&&a.length,n=i=null,u):a},u.padding=function(r){return arguments.length?(f=r,n=i=null,u):f},u.sortGroups=function(r){return arguments.length?(s=r,n=i=null,u):s},u.sortSubgroups=function(r){return arguments.length?(l=r,n=null,u):l},u.sortChords=function(r){return arguments.length?(c=r,n&&p(),u):c},u.chords=function(){return n||h(),n},u.groups=function(){return i||h(),i},u},r.layout.force=function(){var n,i,a,o,s,l,c={},u=r.dispatch("start","tick","end"),f=[1,1],h=.9,p=rg,d=rv,m=-30,g=ry,v=.1,y=.64,x=[],b=[];function _(n){n.px=r.event.x,n.py=r.event.y,c.resume()}return c.tick=function(){if((a*=.99)<.005)return n=null,u.end({type:"end",alpha:a=0}),!0;var i,c,p,d,_,w,T,k,A,M=x.length,S=b.length;for(c=0;c<S;++c)d=(p=b[c]).source,(w=(k=(_=p.target).x-d.x)*k+(A=_.y-d.y)*A)&&(k*=w=a*s[c]*((w=Math.sqrt(w))-o[c])/w,A*=w,_.x-=k*(T=d.weight+_.weight?d.weight/(d.weight+_.weight):.5),_.y-=A*T,d.x+=k*(T=1-T),d.y+=A*T);if((T=a*v)&&(k=f[0]/2,A=f[1]/2,c=-1,T))for(;++c<M;)(p=x[c]).x+=(k-p.x)*T,p.y+=(A-p.y)*T;if(m)for(function r(n,i,a){var o=0,s=0;if(n.charge=0,!n.leaf)for(var l,c=n.nodes,u=c.length,f=-1;++f<u;)null!=(l=c[f])&&(r(l,i,a),n.charge+=l.charge,o+=l.charge*l.cx,s+=l.charge*l.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var h=i*a[n.point.index];n.charge+=n.pointCharge=h,o+=h*n.point.x,s+=h*n.point.y}n.cx=o/n.charge,n.cy=s/n.charge}(i=r.geom.quadtree(x),a,l),c=-1;++c<M;)(p=x[c]).fixed||i.visit(function(r){return function(n,i,a,o){if(n.point!==r){var s=n.cx-r.x,l=n.cy-r.y,c=o-i,u=s*s+l*l;if(c*c/y<u){if(u<g){var f=n.charge/u;r.px-=s*f,r.py-=l*f}return!0}n.point&&u&&u<g&&(f=n.pointCharge/u,r.px-=s*f,r.py-=l*f)}return!n.charge}}(p));for(c=-1;++c<M;)(p=x[c]).fixed?(p.x=p.px,p.y=p.py):(p.x-=(p.px-(p.px=p.x))*h,p.y-=(p.py-(p.py=p.y))*h);u.tick({type:"tick",alpha:a})},c.nodes=function(r){return arguments.length?(x=r,c):x},c.links=function(r){return arguments.length?(b=r,c):b},c.size=function(r){return arguments.length?(f=r,c):f},c.linkDistance=function(r){return arguments.length?(p="function"==typeof r?r:+r,c):p},c.distance=c.linkDistance,c.linkStrength=function(r){return arguments.length?(d="function"==typeof r?r:+r,c):d},c.friction=function(r){return arguments.length?(h=+r,c):h},c.charge=function(r){return arguments.length?(m="function"==typeof r?r:+r,c):m},c.chargeDistance=function(r){return arguments.length?(g=r*r,c):Math.sqrt(g)},c.gravity=function(r){return arguments.length?(v=+r,c):v},c.theta=function(r){return arguments.length?(y=r*r,c):Math.sqrt(y)},c.alpha=function(r){return arguments.length?(r=+r,a?r>0?a=r:(n.c=null,n.t=NaN,n=null,u.end({type:"end",alpha:a=0})):r>0&&(u.start({type:"start",alpha:a=r}),n=ei(c.tick)),c):a},c.start=function(){var r,n,i,a=x.length,u=b.length,h=f[0],g=f[1];for(r=0;r<a;++r)(i=x[r]).index=r,i.weight=0;for(r=0;r<u;++r)"number"==typeof(i=b[r]).source&&(i.source=x[i.source]),"number"==typeof i.target&&(i.target=x[i.target]),++i.source.weight,++i.target.weight;for(r=0;r<a;++r)isNaN((i=x[r]).x)&&(i.x=v("x",h)),isNaN(i.y)&&(i.y=v("y",g)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(o=[],"function"==typeof p)for(r=0;r<u;++r)o[r]=+p.call(this,b[r],r);else for(r=0;r<u;++r)o[r]=p;if(s=[],"function"==typeof d)for(r=0;r<u;++r)s[r]=+d.call(this,b[r],r);else for(r=0;r<u;++r)s[r]=d;if(l=[],"function"==typeof m)for(r=0;r<a;++r)l[r]=+m.call(this,x[r],r);else for(r=0;r<a;++r)l[r]=m;function v(i,o){if(!n){for(n=Array(a),f=0;f<a;++f)n[f]=[];for(f=0;f<u;++f){var s=b[f];n[s.source.index].push(s.target),n[s.target.index].push(s.source)}}for(var l,c=n[r],f=-1,h=c.length;++f<h;)if(!isNaN(l=c[f][i]))return l;return Math.random()*o}return c.resume()},c.resume=function(){return c.alpha(.1)},c.stop=function(){return c.alpha(0)},c.drag=function(){if(i||(i=r.behavior.drag().origin(P).on("dragstart.force",rh).on("drag.force",_).on("dragend.force",rp)),!arguments.length)return i;this.on("mouseover.force",rd).on("mouseout.force",rm).call(i)},r.rebind(c,u,"on")};var rg=20,rv=1,ry=1/0;function rx(n,i){return r.rebind(n,i,"sort","children","value"),n.nodes=n,n.links=rA,n}function rb(r,n){for(var i,a,o=[r];null!=(r=o.pop());)if(n(r),(a=r.children)&&(i=a.length))for(;--i>=0;)o.push(a[i])}function r_(r,n){for(var i=[r],a=[];null!=(r=i.pop());)if(a.push(r),(s=r.children)&&(o=s.length))for(var o,s,l=-1;++l<o;)i.push(s[l]);for(;null!=(r=a.pop());)n(r)}function rw(r){return r.children}function rT(r){return r.value}function rk(r,n){return n.value-r.value}function rA(n){return r.merge(n.map(function(r){return(r.children||[]).map(function(n){return{source:r,target:n}})}))}r.layout.hierarchy=function(){var r=rk,n=rw,i=rT;function a(o){var s,l,c,u,f=[o],h=[];for(o.depth=0;null!=(u=f.pop());)if(h.push(u),(l=n.call(a,u,u.depth))&&(s=l.length)){for(;--s>=0;)f.push(c=l[s]),c.parent=u,c.depth=u.depth+1;i&&(u.value=0),u.children=l}else i&&(u.value=+i.call(a,u,u.depth)||0),delete u.children;return r_(o,function(n){var a,o;r&&(a=n.children)&&a.sort(r),i&&(o=n.parent)&&(o.value+=n.value)}),h}return a.sort=function(n){return arguments.length?(r=n,a):r},a.children=function(r){return arguments.length?(n=r,a):n},a.value=function(r){return arguments.length?(i=r,a):i},a.revalue=function(r){return i&&(rb(r,function(r){r.children&&(r.value=0)}),r_(r,function(r){var n;r.children||(r.value=+i.call(a,r,r.depth)||0),(n=r.parent)&&(n.value+=r.value)})),r},a},r.layout.partition=function(){var n=r.layout.hierarchy(),i=[1,1];function a(r,a){var o=n.call(this,r,a);return function r(n,i,a,o){var s=n.children;if(n.x=i,n.y=n.depth*o,n.dx=a,n.dy=o,s&&(l=s.length)){var l,c,u,f=-1;for(a=n.value?a/n.value:0;++f<l;)r(c=s[f],i,u=c.value*a,o),i+=u}}(o[0],0,i[0],i[1]/function r(n){var i=n.children,a=0;if(i&&(o=i.length))for(var o,s=-1;++s<o;)a=Math.max(a,r(i[s]));return 1+a}(o[0])),o}return a.size=function(r){return arguments.length?(i=r,a):i},rx(a,n)},r.layout.pie=function(){var n=Number,i=rM,a=0,o=tk,s=0;function l(c){var u,f=c.length,h=c.map(function(r,i){return+n.call(l,r,i)}),p=+("function"==typeof a?a.apply(this,arguments):a),d=("function"==typeof o?o.apply(this,arguments):o)-p,m=Math.min(Math.abs(d)/f,+("function"==typeof s?s.apply(this,arguments):s)),g=m*(d<0?-1:1),v=r.sum(h),y=v?(d-f*g)/v:0,x=r.range(f),b=[];return null!=i&&x.sort(i===rM?function(r,n){return h[n]-h[r]}:function(r,n){return i(c[r],c[n])}),x.forEach(function(r){b[r]={data:c[r],value:u=h[r],startAngle:p,endAngle:p+=u*y+g,padAngle:m}}),b}return l.value=function(r){return arguments.length?(n=r,l):n},l.sort=function(r){return arguments.length?(i=r,l):i},l.startAngle=function(r){return arguments.length?(a=r,l):a},l.endAngle=function(r){return arguments.length?(o=r,l):o},l.padAngle=function(r){return arguments.length?(s=r,l):s},l};var rM={};function rS(r){return r.x}function rE(r){return r.y}function rL(r,n,i){r.y0=n,r.y=i}r.layout.stack=function(){var n=P,i=rI,a=rO,o=rL,s=rS,l=rE;function c(u,f){if(!(m=u.length))return u;var h=u.map(function(r,i){return n.call(c,r,i)}),p=h.map(function(r){return r.map(function(r,n){return[s.call(c,r,n),l.call(c,r,n)]})}),d=i.call(c,p,f);h=r.permute(h,d),p=r.permute(p,d);var m,g,v,y,x=a.call(c,p,f),b=h[0].length;for(v=0;v<b;++v)for(o.call(c,h[0][v],y=x[v],p[0][v][1]),g=1;g<m;++g)o.call(c,h[g][v],y+=p[g-1][v][1],p[g][v][1]);return u}return c.values=function(r){return arguments.length?(n=r,c):n},c.order=function(r){return arguments.length?(i="function"==typeof r?r:rC.get(r)||rI,c):i},c.offset=function(r){return arguments.length?(a="function"==typeof r?r:rP.get(r)||rO,c):a},c.x=function(r){return arguments.length?(s=r,c):s},c.y=function(r){return arguments.length?(l=r,c):l},c.out=function(r){return arguments.length?(o=r,c):o},c};var rC=r.map({"inside-out":function(n){var i,a,o=n.length,s=n.map(rz),l=n.map(rD),c=r.range(o).sort(function(r,n){return s[r]-s[n]}),u=0,f=0,h=[],p=[];for(i=0;i<o;++i)a=c[i],u<f?(u+=l[a],h.push(a)):(f+=l[a],p.push(a));return p.reverse().concat(h)},reverse:function(n){return r.range(n.length).reverse()},default:rI}),rP=r.map({silhouette:function(r){var n,i,a,o=r.length,s=r[0].length,l=[],c=0,u=[];for(i=0;i<s;++i){for(n=0,a=0;n<o;n++)a+=r[n][i][1];a>c&&(c=a),l.push(a)}for(i=0;i<s;++i)u[i]=(c-l[i])/2;return u},wiggle:function(r){var n,i,a,o,s,l,c,u,f,h=r.length,p=r[0],d=p.length,m=[];for(m[0]=u=f=0,i=1;i<d;++i){for(n=0,o=0;n<h;++n)o+=r[n][i][1];for(n=0,s=0,c=p[i][0]-p[i-1][0];n<h;++n){for(a=0,l=(r[n][i][1]-r[n][i-1][1])/(2*c);a<n;++a)l+=(r[a][i][1]-r[a][i-1][1])/c;s+=l*r[n][i][1]}m[i]=u-=o?s/o*c:0,u<f&&(f=u)}for(i=0;i<d;++i)m[i]-=f;return m},expand:function(r){var n,i,a,o=r.length,s=r[0].length,l=1/o,c=[];for(i=0;i<s;++i){for(n=0,a=0;n<o;n++)a+=r[n][i][1];if(a)for(n=0;n<o;n++)r[n][i][1]/=a;else for(n=0;n<o;n++)r[n][i][1]=l}for(i=0;i<s;++i)c[i]=0;return c},zero:rO});function rI(n){return r.range(n.length)}function rO(r){for(var n=-1,i=r[0].length,a=[];++n<i;)a[n]=0;return a}function rz(r){for(var n,i=1,a=0,o=r[0][1],s=r.length;i<s;++i)(n=r[i][1])>o&&(a=i,o=n);return a}function rD(r){return r.reduce(rR,0)}function rR(r,n){return r+n[1]}function rF(r,n){return rB(r,Math.ceil(Math.log(n.length)/Math.LN2+1))}function rB(r,n){for(var i=-1,a=+r[0],o=(r[1]-a)/n,s=[];++i<=n;)s[i]=o*i+a;return s}function rN(n){return[r.min(n),r.max(n)]}function rj(r,n){return r.value-n.value}function rU(r,n){var i=r._pack_next;r._pack_next=n,n._pack_prev=r,n._pack_next=i,i._pack_prev=n}function rV(r,n){r._pack_next=n,n._pack_prev=r}function rH(r,n){var i=n.x-r.x,a=n.y-r.y,o=r.r+n.r;return .999*o*o>i*i+a*a}function rq(r){if((n=r.children)&&(u=n.length)){var n,i,a,o,s,l,c,u,f=1/0,h=-1/0,p=1/0,d=-1/0;if(n.forEach(rG),(i=n[0]).x=-i.r,i.y=0,_(i),u>1&&((a=n[1]).x=a.r,a.y=0,_(a),u>2))for(rW(i,a,o=n[2]),_(o),rU(i,o),i._pack_prev=o,rU(o,a),a=i._pack_next,s=3;s<u;s++){rW(i,a,o=n[s]);var m=0,g=1,v=1;for(l=a._pack_next;l!==a;l=l._pack_next,g++)if(rH(l,o)){m=1;break}if(1==m)for(c=i._pack_prev;c!==l._pack_prev&&!rH(c,o);c=c._pack_prev,v++);m?(g<v||g==v&&a.r<i.r?rV(i,a=l):rV(i=c,a),s--):(rU(i,o),a=o,_(o))}var y=(f+h)/2,x=(p+d)/2,b=0;for(s=0;s<u;s++)(o=n[s]).x-=y,o.y-=x,b=Math.max(b,o.r+Math.sqrt(o.x*o.x+o.y*o.y));r.r=b,n.forEach(rY)}function _(r){f=Math.min(r.x-r.r,f),h=Math.max(r.x+r.r,h),p=Math.min(r.y-r.r,p),d=Math.max(r.y+r.r,d)}}function rG(r){r._pack_next=r._pack_prev=r}function rY(r){delete r._pack_next,delete r._pack_prev}function rW(r,n,i){var a=r.r+i.r,o=n.x-r.x,s=n.y-r.y;if(a&&(o||s)){var l=n.r+i.r,c=o*o+s*s,u=.5+((a*=a)-(l*=l))/(2*c),f=Math.sqrt(Math.max(0,2*l*(a+c)-(a-=c)*a-l*l))/(2*c);i.x=r.x+u*o+f*s,i.y=r.y+u*s-f*o}else i.x=r.x+a,i.y=r.y}function rX(r,n){return r.parent==n.parent?1:2}function rZ(r){var n=r.children;return n.length?n[0]:r.t}function rJ(r){var n,i=r.children;return(n=i.length)?i[n-1]:r.t}function rK(r){return{x:r.x,y:r.y,dx:r.dx,dy:r.dy}}function rQ(r,n){var i=r.x+n[3],a=r.y+n[0],o=r.dx-n[1]-n[3],s=r.dy-n[0]-n[2];return o<0&&(i+=o/2,o=0),s<0&&(a+=s/2,s=0),{x:i,y:a,dx:o,dy:s}}function r$(r){var n=r[0],i=r[r.length-1];return n<i?[n,i]:[i,n]}function r0(r){return r.rangeExtent?r.rangeExtent():r$(r.range())}function r1(r,n,i,a){var o=i(r[0],r[1]),s=a(n[0],n[1]);return function(r){return s(o(r))}}function r2(r,n){var i,a=0,o=r.length-1,s=r[a],l=r[o];return l<s&&(i=a,a=o,o=i,i=s,s=l,l=i),r[a]=n.floor(s),r[o]=n.ceil(l),r}function r3(r){return r?{floor:function(n){return Math.floor(n/r)*r},ceil:function(n){return Math.ceil(n/r)*r}}:r5}r.layout.histogram=function(){var n=!0,i=Number,a=rN,o=rF;function s(s,l){for(var c,u,f=[],h=s.map(i,this),p=a.call(this,h,l),d=o.call(this,p,h,l),m=(l=-1,h.length),g=d.length-1,v=n?1:1/m;++l<g;)(c=f[l]=[]).dx=d[l+1]-(c.x=d[l]),c.y=0;if(g>0)for(l=-1;++l<m;)(u=h[l])>=p[0]&&u<=p[1]&&((c=f[r.bisect(d,u,1,g)-1]).y+=v,c.push(s[l]));return f}return s.value=function(r){return arguments.length?(i=r,s):i},s.range=function(r){return arguments.length?(a=t6(r),s):a},s.bins=function(r){return arguments.length?(o="number"==typeof r?function(n){return rB(n,r)}:t6(r),s):o},s.frequency=function(r){return arguments.length?(n=!!r,s):n},s},r.layout.pack=function(){var n,i=r.layout.hierarchy().sort(rj),a=0,o=[1,1];function s(r,s){var l=i.call(this,r,s),c=l[0],u=o[0],f=o[1],h=null==n?Math.sqrt:"function"==typeof n?n:function(){return n};if(c.x=c.y=0,r_(c,function(r){r.r=+h(r.value)}),r_(c,rq),a){var p=a*(n?1:Math.max(2*c.r/u,2*c.r/f))/2;r_(c,function(r){r.r+=p}),r_(c,rq),r_(c,function(r){r.r-=p})}return function r(n,i,a,o){var s=n.children;if(n.x=i+=o*n.x,n.y=a+=o*n.y,n.r*=o,s)for(var l=-1,c=s.length;++l<c;)r(s[l],i,a,o)}(c,u/2,f/2,n?1:1/Math.max(2*c.r/u,2*c.r/f)),l}return s.size=function(r){return arguments.length?(o=r,s):o},s.radius=function(r){return arguments.length?(n=null==r||"function"==typeof r?r:+r,s):n},s.padding=function(r){return arguments.length?(a=+r,s):a},rx(s,i)},r.layout.tree=function(){var n=r.layout.hierarchy().sort(null).value(null),i=rX,a=[1,1],o=null;function s(r,s){var f=n.call(this,r,s),h=f[0],p=function(r){for(var n,i={A:null,children:[r]},a=[i];null!=(n=a.pop());)for(var o,s=n.children,l=0,c=s.length;l<c;++l)a.push((s[l]=o={_:s[l],parent:n,children:(o=s[l].children)&&o.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:l}).a=o);return i.children[0]}(h);if(r_(p,l),p.parent.m=-p.z,rb(p,c),o)rb(h,u);else{var d=h,m=h,g=h;rb(h,function(r){r.x<d.x&&(d=r),r.x>m.x&&(m=r),r.depth>g.depth&&(g=r)});var v=i(d,m)/2-d.x,y=a[0]/(m.x+i(m,d)/2+v),x=a[1]/(g.depth||1);rb(h,function(r){r.x=(r.x+v)*y,r.y=r.depth*x})}return f}function l(r){var n=r.children,a=r.parent.children,o=r.i?a[r.i-1]:null;if(n.length){!function(r){for(var n,i=0,a=0,o=r.children,s=o.length;--s>=0;)(n=o[s]).z+=i,n.m+=i,i+=n.s+(a+=n.c)}(r);var s=(n[0].z+n[n.length-1].z)/2;o?(r.z=o.z+i(r._,o._),r.m=r.z-s):r.z=s}else o&&(r.z=o.z+i(r._,o._));r.parent.A=function(r,n,a){if(n){for(var o,s,l,c=r,u=r,f=n,h=c.parent.children[0],p=c.m,d=u.m,m=f.m,g=h.m;f=rJ(f),c=rZ(c),f&&c;)h=rZ(h),(u=rJ(u)).a=r,(l=f.z+m-c.z-p+i(f._,c._))>0&&(function(r,n,i){var a=i/(n.i-r.i);n.c-=a,n.s+=i,r.c+=a,n.z+=i,n.m+=i}((o=f,s=a,o.a.parent===r.parent?o.a:s),r,l),p+=l,d+=l),m+=f.m,p+=c.m,g+=h.m,d+=u.m;f&&!rJ(u)&&(u.t=f,u.m+=m-d),c&&!rZ(h)&&(h.t=c,h.m+=p-g,a=r)}return a}(r,o,r.parent.A||a[0])}function c(r){r._.x=r.z+r.parent.m,r.m+=r.parent.m}function u(r){r.x*=a[0],r.y=r.depth*a[1]}return s.separation=function(r){return arguments.length?(i=r,s):i},s.size=function(r){return arguments.length?(o=null==(a=r)?u:null,s):o?null:a},s.nodeSize=function(r){return arguments.length?(o=null==(a=r)?null:u,s):o?a:null},rx(s,n)},r.layout.cluster=function(){var n=r.layout.hierarchy().sort(null).value(null),i=rX,a=[1,1],o=!1;function s(s,l){var c,u=n.call(this,s,l),f=u[0],h=0;r_(f,function(n){var a=n.children;a&&a.length?(n.x=a.reduce(function(r,n){return r+n.x},0)/a.length,n.y=1+r.max(a,function(r){return r.y})):(n.x=c?h+=i(n,c):0,n.y=0,c=n)});var p=function r(n){var i=n.children;return i&&i.length?r(i[0]):n}(f),d=function r(n){var i,a=n.children;return a&&(i=a.length)?r(a[i-1]):n}(f),m=p.x-i(p,d)/2,g=d.x+i(d,p)/2;return r_(f,o?function(r){r.x=(r.x-f.x)*a[0],r.y=(f.y-r.y)*a[1]}:function(r){r.x=(r.x-m)/(g-m)*a[0],r.y=(1-(f.y?r.y/f.y:1))*a[1]}),u}return s.separation=function(r){return arguments.length?(i=r,s):i},s.size=function(r){return arguments.length?(o=null==(a=r),s):o?null:a},s.nodeSize=function(r){return arguments.length?(o=null!=(a=r),s):o?a:null},rx(s,n)},r.layout.treemap=function(){var n,i=r.layout.hierarchy(),a=Math.round,o=[1,1],s=null,l=rK,c=!1,u="squarify",f=.5*(1+Math.sqrt(5));function h(r,n){for(var i,a,o=-1,s=r.length;++o<s;)a=(i=r[o]).value*(n<0?0:n),i.area=isNaN(a)||a<=0?0:a}function p(r,n,i,o){var s,l=-1,c=r.length,u=i.x,f=i.y,h=n?a(r.area/n):0;if(n==i.dx){for((o||h>i.dy)&&(h=i.dy);++l<c;)(s=r[l]).x=u,s.y=f,s.dy=h,u+=s.dx=Math.min(i.x+i.dx-u,h?a(s.area/h):0);s.z=!0,s.dx+=i.x+i.dx-u,i.y+=h,i.dy-=h}else{for((o||h>i.dx)&&(h=i.dx);++l<c;)(s=r[l]).x=u,s.y=f,s.dx=h,f+=s.dy=Math.min(i.y+i.dy-f,h?a(s.area/h):0);s.z=!1,s.dy+=i.y+i.dy-f,i.x+=h,i.dx-=h}}function d(r){var a=n||i(r),s=a[0];return s.x=s.y=0,s.value?(s.dx=o[0],s.dy=o[1]):s.dx=s.dy=0,n&&i.revalue(s),h([s],s.dx*s.dy/s.value),(n?function r(n){var i=n.children;if(i&&i.length){var a,o=l(n),s=i.slice(),c=[];for(h(s,o.dx*o.dy/n.value),c.area=0;a=s.pop();)c.push(a),c.area+=a.area,null!=a.z&&(p(c,a.z?o.dx:o.dy,o,!s.length),c.length=c.area=0);i.forEach(r)}}:function r(n){var i=n.children;if(i&&i.length){var a,o,s,c=l(n),d=[],m=i.slice(),g=1/0,v="slice"===u?c.dx:"dice"===u?c.dy:"slice-dice"===u?1&n.depth?c.dy:c.dx:Math.min(c.dx,c.dy);for(h(m,c.dx*c.dy/n.value),d.area=0;(s=m.length)>0;)d.push(a=m[s-1]),d.area+=a.area,"squarify"!==u||(o=function(r,n){for(var i,a=r.area,o=0,s=1/0,l=-1,c=r.length;++l<c;)(i=r[l].area)&&(i<s&&(s=i),i>o&&(o=i));return n*=n,(a*=a)?Math.max(n*o*f/a,a/(n*s*f)):1/0}(d,v))<=g?(m.pop(),g=o):(d.area-=d.pop().area,p(d,v,c,!1),v=Math.min(c.dx,c.dy),d.length=d.area=0,g=1/0);d.length&&(p(d,v,c,!0),d.length=d.area=0),i.forEach(r)}})(s),c&&(n=a),a}return d.size=function(r){return arguments.length?(o=r,d):o},d.padding=function(r){var n;return arguments.length?(l=null==(s=r)?rK:"function"==(n=typeof r)?function(n){var i=r.call(d,n,n.depth);return null==i?rK(n):rQ(n,"number"==typeof i?[i,i,i,i]:i)}:("number"===n&&(r=[r,r,r,r]),function(n){return rQ(n,r)}),d):s},d.round=function(r){return arguments.length?(a=r?Math.round:Number,d):a!=Number},d.sticky=function(r){return arguments.length?(c=r,n=null,d):c},d.ratio=function(r){return arguments.length?(f=r,d):f},d.mode=function(r){return arguments.length?(u=r+"",d):u},rx(d,i)},r.random={normal:function(r,n){var i=arguments.length;return i<2&&(n=1),i<1&&(r=0),function(){var i,a,o;do o=(i=2*Math.random()-1)*i+(a=2*Math.random()-1)*a;while(!o||o>1);return r+n*i*Math.sqrt(-2*Math.log(o)/o)}},logNormal:function(){var n=r.random.normal.apply(r,arguments);return function(){return Math.exp(n())}},bates:function(n){var i=r.random.irwinHall(n);return function(){return i()/n}},irwinHall:function(r){return function(){for(var n=0,i=0;i<r;i++)n+=Math.random();return n}}},r.scale={};var r5={floor:P,ceil:P};function r4(n,i,a,o){var s=[],l=[],c=0,u=Math.min(n.length,i.length)-1;for(n[u]<n[0]&&(n=n.slice().reverse(),i=i.slice().reverse());++c<=u;)s.push(a(n[c-1],n[c])),l.push(o(i[c-1],i[c]));return function(i){var a=r.bisect(n,i,1,u)-1;return l[a](s[a](i))}}function r6(n,i){return r.rebind(n,i,"range","rangeRound","interpolate","clamp")}function r8(r,n){return r2(r,r3(r9(r,n)[2])),r2(r,r3(r9(r,n)[2])),r}function r9(r,n){null==n&&(n=10);var i=r$(r),a=i[1]-i[0],o=Math.pow(10,Math.floor(Math.log(a/n)/Math.LN10)),s=n/a*o;return s<=.15?o*=10:s<=.35?o*=5:s<=.75&&(o*=2),i[0]=Math.ceil(i[0]/o)*o,i[1]=Math.floor(i[1]/o)*o+.5*o,i[2]=o,i}function r7(n,i){return r.range.apply(r,r9(n,i))}r.scale.linear=function(){return function r(n,i,a,o){var s,l;function c(){var r=Math.min(n.length,i.length)>2?r4:r1,c=o?ru:rc;return s=r(n,i,c,a),l=r(i,n,c,eQ),u}function u(r){return s(r)}return u.invert=function(r){return l(r)},u.domain=function(r){return arguments.length?(n=r.map(Number),c()):n},u.range=function(r){return arguments.length?(i=r,c()):i},u.rangeRound=function(r){return u.range(r).interpolate(rr)},u.clamp=function(r){return arguments.length?(o=r,c()):o},u.interpolate=function(r){return arguments.length?(a=r,c()):a},u.ticks=function(r){return r7(n,r)},u.tickFormat=function(r,i){return d3_scale_linearTickFormat(n,r,i)},u.nice=function(r){return r8(n,r),c()},u.copy=function(){return r(n,i,a,o)},c()}([0,1],[0,1],eQ,!1)},r.scale.log=function(){return function r(n,i,a,o){function s(r){return(a?Math.log(r<0?0:r):-Math.log(r>0?0:-r))/Math.log(i)}function l(r){return a?Math.pow(i,r):-Math.pow(i,-r)}function c(r){return n(s(r))}return c.invert=function(r){return l(n.invert(r))},c.domain=function(r){return arguments.length?(a=r[0]>=0,n.domain((o=r.map(Number)).map(s)),c):o},c.base=function(r){return arguments.length?(i=+r,n.domain(o.map(s)),c):i},c.nice=function(){var r=r2(o.map(s),a?Math:nt);return n.domain(r),o=r.map(l),c},c.ticks=function(){var r=r$(o),n=[],c=r[0],u=r[1],f=Math.floor(s(c)),h=Math.ceil(s(u)),p=i%1?2:i;if(isFinite(h-f)){if(a){for(;f<h;f++)for(var d=1;d<p;d++)n.push(l(f)*d);n.push(l(f))}else for(n.push(l(f));f++<h;)for(d=p-1;d>0;d--)n.push(l(f)*d);for(f=0;n[f]<c;f++);for(h=n.length;n[h-1]>u;h--);n=n.slice(f,h)}return n},c.copy=function(){return r(n.copy(),i,a,o)},r6(c,n)}(r.scale.linear().domain([0,1]),10,!0,[1,10])};var nt={floor:function(r){return-Math.ceil(-r)},ceil:function(r){return-Math.floor(-r)}};function ne(r){return function(n){return n<0?-Math.pow(-n,r):Math.pow(n,r)}}r.scale.pow=function(){return function r(n,i,a){var o=ne(i),s=ne(1/i);function l(r){return n(o(r))}return l.invert=function(r){return s(n.invert(r))},l.domain=function(r){return arguments.length?(n.domain((a=r.map(Number)).map(o)),l):a},l.ticks=function(r){return r7(a,r)},l.tickFormat=function(r,n){return d3_scale_linearTickFormat(a,r,n)},l.nice=function(r){return l.domain(r8(a,r))},l.exponent=function(r){return arguments.length?(o=ne(i=r),s=ne(1/i),n.domain(a.map(o)),l):i},l.copy=function(){return r(n.copy(),i,a)},r6(l,n)}(r.scale.linear(),1,[0,1])},r.scale.sqrt=function(){return r.scale.pow().exponent(.5)},r.scale.ordinal=function(){return function n(i,a){var o,s,l;function c(r){return s[((o.get(r)||("range"===a.t?o.set(r,i.push(r)):NaN))-1)%s.length]}function u(n,a){return r.range(i.length).map(function(r){return n+a*r})}return c.domain=function(r){if(!arguments.length)return i;i=[],o=new w;for(var n,s=-1,l=r.length;++s<l;)o.has(n=r[s])||o.set(n,i.push(n));return c[a.t].apply(c,a.a)},c.range=function(r){return arguments.length?(s=r,l=0,a={t:"range",a:arguments},c):s},c.rangePoints=function(r,n){arguments.length<2&&(n=0);var o=r[0],f=r[1],h=i.length<2?(o=(o+f)/2,0):(f-o)/(i.length-1+n);return s=u(o+h*n/2,h),l=0,a={t:"rangePoints",a:arguments},c},c.rangeRoundPoints=function(r,n){arguments.length<2&&(n=0);var o=r[0],f=r[1],h=i.length<2?(o=f=Math.round((o+f)/2),0):(f-o)/(i.length-1+n)|0;return s=u(o+Math.round(h*n/2+(f-o-(i.length-1+n)*h)/2),h),l=0,a={t:"rangeRoundPoints",a:arguments},c},c.rangeBands=function(r,n,o){arguments.length<2&&(n=0),arguments.length<3&&(o=n);var f=r[1]<r[0],h=r[f-0],p=(r[1-f]-h)/(i.length-n+2*o);return s=u(h+p*o,p),f&&s.reverse(),l=p*(1-n),a={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(r,n,o){arguments.length<2&&(n=0),arguments.length<3&&(o=n);var f=r[1]<r[0],h=r[f-0],p=r[1-f],d=Math.floor((p-h)/(i.length-n+2*o));return s=u(h+Math.round((p-h-(i.length-n)*d)/2),d),f&&s.reverse(),l=Math.round(d*(1-n)),a={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return l},c.rangeExtent=function(){return r$(a.a[0])},c.copy=function(){return n(i,a)},c.domain(i)}([],{t:"range",a:[[]]})},r.scale.category10=function(){return r.scale.ordinal().range(nr)},r.scale.category20=function(){return r.scale.ordinal().range(nn)},r.scale.category20b=function(){return r.scale.ordinal().range(ni)},r.scale.category20c=function(){return r.scale.ordinal().range(na)};var nr=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(tK),nn=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(tK),ni=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(tK),na=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(tK);function no(){return 0}r.scale.quantile=function(){return function n(i,a){var o;function s(){var n=0,s=a.length;for(o=[];++n<s;)o[n-1]=r.quantile(i,n/s);return l}function l(n){if(!isNaN(n=+n))return a[r.bisect(o,n)]}return l.domain=function(r){return arguments.length?(i=r.map(m).filter(g).sort(d),s()):i},l.range=function(r){return arguments.length?(a=r,s()):a},l.quantiles=function(){return o},l.invertExtent=function(r){return(r=a.indexOf(r))<0?[NaN,NaN]:[r>0?o[r-1]:i[0],r<o.length?o[r]:i[i.length-1]]},l.copy=function(){return n(i,a)},s()}([],[])},r.scale.quantize=function(){return function r(n,i,a){var o,s;function l(r){return a[Math.max(0,Math.min(s,Math.floor(o*(r-n))))]}function c(){return o=a.length/(i-n),s=a.length-1,l}return l.domain=function(r){return arguments.length?(n=+r[0],i=+r[r.length-1],c()):[n,i]},l.range=function(r){return arguments.length?(a=r,c()):a},l.invertExtent=function(r){return[r=(r=a.indexOf(r))<0?NaN:r/o+n,r+1/o]},l.copy=function(){return r(n,i,a)},c()}(0,1,[0,1])},r.scale.threshold=function(){return function n(i,a){function o(n){if(n<=n)return a[r.bisect(i,n)]}return o.domain=function(r){return arguments.length?(i=r,o):i},o.range=function(r){return arguments.length?(a=r,o):a},o.invertExtent=function(r){return[i[(r=a.indexOf(r))-1],i[r]]},o.copy=function(){return n(i,a)},o}([.5],[0,1])},r.scale.identity=function(){return function r(n){function i(r){return+r}return i.invert=i,i.domain=i.range=function(r){return arguments.length?(n=r.map(i),i):n},i.ticks=function(r){return r7(n,r)},i.tickFormat=function(r,i){return d3_scale_linearTickFormat(n,r,i)},i.copy=function(){return r(n)},i}([0,1])},r.svg={},r.svg.arc=function(){var r=nl,n=nc,i=no,a=ns,o=nu,s=nf,l=nh;function c(){var c=Math.max(0,+r.apply(this,arguments)),f=Math.max(0,+n.apply(this,arguments)),h=o.apply(this,arguments)-tM,p=s.apply(this,arguments)-tM,d=Math.abs(p-h),m=h>p?0:1;if(f<c&&(g=f,f=c,c=g),d>=tA)return u(f,m)+(c?u(c,1-m):"")+"Z";var g,v,y,x,b,_,w,T,k,A,M,S,E=0,L=0,C=[];if((x=(+l.apply(this,arguments)||0)/2)&&(y=a===ns?Math.sqrt(c*c+f*f):+a.apply(this,arguments),m||(L*=-1),f&&(L=tL(y/f*Math.sin(x))),c&&(E=tL(y/c*Math.sin(x)))),f){b=f*Math.cos(h+L),_=f*Math.sin(h+L),w=f*Math.cos(p-L),T=f*Math.sin(p-L);var P=Math.abs(p-h-2*L)<=tT?0:1;if(L&&np(b,_,w,T)===m^P){var I=(h+p)/2;b=f*Math.cos(I),_=f*Math.sin(I),w=T=null}}else b=_=0;if(c){k=c*Math.cos(p-E),A=c*Math.sin(p-E),M=c*Math.cos(h+E),S=c*Math.sin(h+E);var O=Math.abs(h-p+2*E)<=tT?0:1;if(E&&np(k,A,M,S)===1-m^O){var z=(h+p)/2;k=c*Math.cos(z),A=c*Math.sin(z),M=S=null}}else k=A=0;if(d>1e-6&&(g=Math.min(Math.abs(f-c)/2,+i.apply(this,arguments)))>.001){v=c<f^m?0:1;var D=g,R=g;if(d<tT){var F=null==M?[k,A]:null==w?[b,_]:ed([b,_],[M,S],[w,T],[k,A]),B=b-F[0],N=_-F[1],j=w-F[0],U=T-F[1],V=1/Math.sin(Math.acos((B*j+N*U)/(Math.sqrt(B*B+N*N)*Math.sqrt(j*j+U*U)))/2),H=Math.sqrt(F[0]*F[0]+F[1]*F[1]);R=Math.min(g,(c-H)/(V-1)),D=Math.min(g,(f-H)/(V+1))}if(null!=w){var q=nd(null==M?[k,A]:[M,S],[b,_],f,D,m),G=nd([w,T],[k,A],f,D,m);g===D?C.push("M",q[0],"A",D,",",D," 0 0,",v," ",q[1],"A",f,",",f," 0 ",1-m^np(q[1][0],q[1][1],G[1][0],G[1][1]),",",m," ",G[1],"A",D,",",D," 0 0,",v," ",G[0]):C.push("M",q[0],"A",D,",",D," 0 1,",v," ",G[0])}else C.push("M",b,",",_);if(null!=M){var Y=nd([b,_],[M,S],c,-R,m),W=nd([k,A],null==w?[b,_]:[w,T],c,-R,m);g===R?C.push("L",W[0],"A",R,",",R," 0 0,",v," ",W[1],"A",c,",",c," 0 ",m^np(W[1][0],W[1][1],Y[1][0],Y[1][1]),",",1-m," ",Y[1],"A",R,",",R," 0 0,",v," ",Y[0]):C.push("L",W[0],"A",R,",",R," 0 0,",v," ",Y[0])}else C.push("L",k,",",A)}else C.push("M",b,",",_),null!=w&&C.push("A",f,",",f," 0 ",P,",",m," ",w,",",T),C.push("L",k,",",A),null!=M&&C.push("A",c,",",c," 0 ",O,",",1-m," ",M,",",S);return C.push("Z"),C.join("")}function u(r,n){return"M0,"+r+"A"+r+","+r+" 0 1,"+n+" 0,"+-r+"A"+r+","+r+" 0 1,"+n+" 0,"+r}return c.innerRadius=function(n){return arguments.length?(r=t6(n),c):r},c.outerRadius=function(r){return arguments.length?(n=t6(r),c):n},c.cornerRadius=function(r){return arguments.length?(i=t6(r),c):i},c.padRadius=function(r){return arguments.length?(a=r==ns?ns:t6(r),c):a},c.startAngle=function(r){return arguments.length?(o=t6(r),c):o},c.endAngle=function(r){return arguments.length?(s=t6(r),c):s},c.padAngle=function(r){return arguments.length?(l=t6(r),c):l},c.centroid=function(){var i=(+r.apply(this,arguments)+ +n.apply(this,arguments))/2,a=(+o.apply(this,arguments)+ +s.apply(this,arguments))/2-tM;return[Math.cos(a)*i,Math.sin(a)*i]},c};var ns="auto";function nl(r){return r.innerRadius}function nc(r){return r.outerRadius}function nu(r){return r.startAngle}function nf(r){return r.endAngle}function nh(r){return r&&r.padAngle}function np(r,n,i,a){return(r-i)*n-(n-a)*r>0?0:1}function nd(r,n,i,a,o){var s=r[0]-n[0],l=r[1]-n[1],c=(o?a:-a)/Math.sqrt(s*s+l*l),u=c*l,f=-c*s,h=r[0]+u,p=r[1]+f,d=n[0]+u,m=n[1]+f,g=(h+d)/2,v=(p+m)/2,y=d-h,x=m-p,b=y*y+x*x,_=i-a,w=h*m-d*p,T=(x<0?-1:1)*Math.sqrt(Math.max(0,_*_*b-w*w)),k=(w*x-y*T)/b,A=(-w*y-x*T)/b,M=(w*x+y*T)/b,S=(-w*y+x*T)/b,E=k-g,L=A-v,C=M-g,P=S-v;return E*E+L*L>C*C+P*P&&(k=M,A=S),[[k-u,A-f],[k*i/_,A*i/_]]}function nm(){return!0}function ng(r){var n=el,i=ec,a=nm,o=ny,s=o.key,l=.7;function c(s){var c,u=[],f=[],h=-1,p=s.length,d=t6(n),m=t6(i);function g(){u.push("M",o(r(f),l))}for(;++h<p;)a.call(this,c=s[h],h)?f.push([+d.call(this,c,h),+m.call(this,c,h)]):f.length&&(g(),f=[]);return f.length&&g(),u.length?u.join(""):null}return c.x=function(r){return arguments.length?(n=r,c):n},c.y=function(r){return arguments.length?(i=r,c):i},c.defined=function(r){return arguments.length?(a=r,c):a},c.interpolate=function(r){return arguments.length?(s="function"==typeof r?o=r:(o=nv.get(r)||ny).key,c):s},c.tension=function(r){return arguments.length?(l=r,c):l},c}r.svg.line=function(){return ng(P)};var nv=r.map({linear:ny,"linear-closed":nx,step:function(r){for(var n=0,i=r.length,a=r[0],o=[a[0],",",a[1]];++n<i;)o.push("H",(a[0]+(a=r[n])[0])/2,"V",a[1]);return i>1&&o.push("H",a[0]),o.join("")},"step-before":nb,"step-after":n_,basis:nk,"basis-open":function(r){if(r.length<4)return ny(r);for(var n,i=[],a=-1,o=r.length,s=[0],l=[0];++a<3;)n=r[a],s.push(n[0]),l.push(n[1]);for(i.push(nA(nE,s)+","+nA(nE,l)),--a;++a<o;)n=r[a],s.shift(),s.push(n[0]),l.shift(),l.push(n[1]),nL(i,s,l);return i.join("")},"basis-closed":function(r){for(var n,i,a=-1,o=r.length,s=o+4,l=[],c=[];++a<4;)i=r[a%o],l.push(i[0]),c.push(i[1]);for(n=[nA(nE,l),",",nA(nE,c)],--a;++a<s;)i=r[a%o],l.shift(),l.push(i[0]),c.shift(),c.push(i[1]),nL(n,l,c);return n.join("")},bundle:function(r,n){var i=r.length-1;if(i)for(var a,o,s=r[0][0],l=r[0][1],c=r[i][0]-s,u=r[i][1]-l,f=-1;++f<=i;)a=r[f],o=f/i,a[0]=n*a[0]+(1-n)*(s+o*c),a[1]=n*a[1]+(1-n)*(l+o*u);return nk(r)},cardinal:function(r,n){return r.length<3?ny(r):r[0]+nw(r,nT(r,n))},"cardinal-open":function(r,n){return r.length<4?ny(r):r[1]+nw(r.slice(1,-1),nT(r,n))},"cardinal-closed":function(r,n){return r.length<3?nx(r):r[0]+nw((r.push(r[0]),r),nT([r[r.length-2]].concat(r,[r[1]]),n))},monotone:function(r){return r.length<3?ny(r):r[0]+nw(r,function(r){for(var n,i,a,o,s=[],l=function(r){for(var n=0,i=r.length-1,a=[],o=r[0],s=r[1],l=a[0]=nC(o,s);++n<i;)a[n]=(l+(l=nC(o=s,s=r[n+1])))/2;return a[n]=l,a}(r),c=-1,u=r.length-1;++c<u;)1e-6>b(n=nC(r[c],r[c+1]))?l[c]=l[c+1]=0:(o=(i=l[c]/n)*i+(a=l[c+1]/n)*a)>9&&(o=3*n/Math.sqrt(o),l[c]=o*i,l[c+1]=o*a);for(c=-1;++c<=u;)s.push([(o=(r[Math.min(u,c+1)][0]-r[Math.max(0,c-1)][0])/(6*(1+l[c]*l[c])))||0,l[c]*o||0]);return s}(r))}});function ny(r){return r.length>1?r.join("L"):r+"Z"}function nx(r){return r.join("L")+"Z"}function nb(r){for(var n=0,i=r.length,a=r[0],o=[a[0],",",a[1]];++n<i;)o.push("V",(a=r[n])[1],"H",a[0]);return o.join("")}function n_(r){for(var n=0,i=r.length,a=r[0],o=[a[0],",",a[1]];++n<i;)o.push("H",(a=r[n])[0],"V",a[1]);return o.join("")}function nw(r,n){if(n.length<1||r.length!=n.length&&r.length!=n.length+2)return ny(r);var i=r.length!=n.length,a="",o=r[0],s=r[1],l=n[0],c=l,u=1;if(i&&(a+="Q"+(s[0]-2*l[0]/3)+","+(s[1]-2*l[1]/3)+","+s[0]+","+s[1],o=r[1],u=2),n.length>1){c=n[1],s=r[u],u++,a+="C"+(o[0]+l[0])+","+(o[1]+l[1])+","+(s[0]-c[0])+","+(s[1]-c[1])+","+s[0]+","+s[1];for(var f=2;f<n.length;f++,u++)s=r[u],c=n[f],a+="S"+(s[0]-c[0])+","+(s[1]-c[1])+","+s[0]+","+s[1]}if(i){var h=r[u];a+="Q"+(s[0]+2*c[0]/3)+","+(s[1]+2*c[1]/3)+","+h[0]+","+h[1]}return a}function nT(r,n){for(var i,a=[],o=(1-n)/2,s=r[0],l=r[1],c=1,u=r.length;++c<u;)i=s,s=l,a.push([o*((l=r[c])[0]-i[0]),o*(l[1]-i[1])]);return a}function nk(r){if(r.length<3)return ny(r);var n=1,i=r.length,a=r[0],o=a[0],s=a[1],l=[o,o,o,(a=r[1])[0]],c=[s,s,s,a[1]],u=[o,",",s,"L",nA(nE,l),",",nA(nE,c)];for(r.push(r[i-1]);++n<=i;)a=r[n],l.shift(),l.push(a[0]),c.shift(),c.push(a[1]),nL(u,l,c);return r.pop(),u.push("L",a),u.join("")}function nA(r,n){return r[0]*n[0]+r[1]*n[1]+r[2]*n[2]+r[3]*n[3]}nv.forEach(function(r,n){n.key=r,n.closed=/-closed$/.test(r)});var nM=[0,2/3,1/3,0],nS=[0,1/3,2/3,0],nE=[0,1/6,2/3,1/6];function nL(r,n,i){r.push("C",nA(nM,n),",",nA(nM,i),",",nA(nS,n),",",nA(nS,i),",",nA(nE,n),",",nA(nE,i))}function nC(r,n){return(n[1]-r[1])/(n[0]-r[0])}function nP(r){for(var n,i,a,o=-1,s=r.length;++o<s;)i=(n=r[o])[0],a=n[1]-tM,n[0]=i*Math.cos(a),n[1]=i*Math.sin(a);return r}function nI(r){var n=el,i=el,a=0,o=ec,s=nm,l=ny,c=l.key,u=l,f="L",h=.7;function p(c){var p,d,m,g=[],v=[],y=[],x=-1,b=c.length,_=t6(n),w=t6(a),T=n===i?function(){return d}:t6(i),k=a===o?function(){return m}:t6(o);function A(){g.push("M",l(r(y),h),f,u(r(v.reverse()),h),"Z")}for(;++x<b;)s.call(this,p=c[x],x)?(v.push([d=+_.call(this,p,x),m=+w.call(this,p,x)]),y.push([+T.call(this,p,x),+k.call(this,p,x)])):v.length&&(A(),v=[],y=[]);return v.length&&A(),g.length?g.join(""):null}return p.x=function(r){return arguments.length?(n=i=r,p):i},p.x0=function(r){return arguments.length?(n=r,p):n},p.x1=function(r){return arguments.length?(i=r,p):i},p.y=function(r){return arguments.length?(a=o=r,p):o},p.y0=function(r){return arguments.length?(a=r,p):a},p.y1=function(r){return arguments.length?(o=r,p):o},p.defined=function(r){return arguments.length?(s=r,p):s},p.interpolate=function(r){return arguments.length?(c="function"==typeof r?l=r:(l=nv.get(r)||ny).key,u=l.reverse||l,f=l.closed?"M":"L",p):c},p.tension=function(r){return arguments.length?(h=r,p):h},p}function nO(r){return r.source}function nz(r){return r.target}function nD(r){return r.radius}function nR(r){return[r.x,r.y]}function nF(){return 64}function nB(){return"circle"}function nN(r){var n=Math.sqrt(r/tT);return"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"Z"}r.svg.line.radial=function(){var r=ng(nP);return r.radius=r.x,delete r.x,r.angle=r.y,delete r.y,r},nb.reverse=n_,n_.reverse=nb,r.svg.area=function(){return nI(P)},r.svg.area.radial=function(){var r=nI(nP);return r.radius=r.x,delete r.x,r.innerRadius=r.x0,delete r.x0,r.outerRadius=r.x1,delete r.x1,r.angle=r.y,delete r.y,r.startAngle=r.y0,delete r.y0,r.endAngle=r.y1,delete r.y1,r},r.svg.chord=function(){var r=nO,n=nz,i=nD,a=nu,o=nf;function s(i,a){var o,s,u,f,h,p,d,m,g,v=l(this,r,i,a),y=l(this,n,i,a);return"M"+v.p0+c(v.r,v.p1,v.a1-v.a0)+(v.a0==y.a0&&v.a1==y.a1?(v.r,v.p1,v.r,"Q 0,0 "+v.p0):(v.r,v.p1,y.r,"Q 0,0 "+y.p0+c(y.r,y.p1,y.a1-y.a0)+(y.r,y.p1,v.r,"Q 0,0 "+v.p0)))+"Z"}function l(r,n,s,l){var c=n.call(r,s,l),u=i.call(r,c,l),f=a.call(r,c,l)-tM,h=o.call(r,c,l)-tM;return{r:u,a0:f,a1:h,p0:[u*Math.cos(f),u*Math.sin(f)],p1:[u*Math.cos(h),u*Math.sin(h)]}}function c(r,n,i){return"A"+r+","+r+" 0 "+ +(i>tT)+",1 "+n}return s.radius=function(r){return arguments.length?(i=t6(r),s):i},s.source=function(n){return arguments.length?(r=t6(n),s):r},s.target=function(r){return arguments.length?(n=t6(r),s):n},s.startAngle=function(r){return arguments.length?(a=t6(r),s):a},s.endAngle=function(r){return arguments.length?(o=t6(r),s):o},s},r.svg.diagonal=function(){var r=nO,n=nz,i=nR;function a(a,o){var s=r.call(this,a,o),l=n.call(this,a,o),c=(s.y+l.y)/2,u=[s,{x:s.x,y:c},{x:l.x,y:c},l];return"M"+(u=u.map(i))[0]+"C"+u[1]+" "+u[2]+" "+u[3]}return a.source=function(n){return arguments.length?(r=t6(n),a):r},a.target=function(r){return arguments.length?(n=t6(r),a):n},a.projection=function(r){return arguments.length?(i=r,a):i},a},r.svg.diagonal.radial=function(){var n=r.svg.diagonal(),i=nR,a=n.projection;return n.projection=function(r){var n;return arguments.length?a((n=i=r,function(){var r=n.apply(this,arguments),i=r[0],a=r[1]-tM;return[i*Math.cos(a),i*Math.sin(a)]})):i},n},r.svg.symbol=function(){var r=nB,n=nF;function i(i,a){return(nj.get(r.call(this,i,a))||nN)(n.call(this,i,a))}return i.type=function(n){return arguments.length?(r=t6(n),i):r},i.size=function(r){return arguments.length?(n=t6(r),i):n},i};var nj=r.map({circle:nN,cross:function(r){var n=Math.sqrt(r/5)/2;return"M"+-3*n+","+-n+"H"+-n+"V"+-3*n+"H"+n+"V"+-n+"H"+3*n+"V"+n+"H"+n+"V"+3*n+"H"+-n+"V"+n+"H"+-3*n+"Z"},diamond:function(r){var n=Math.sqrt(r/(2*nV)),i=n*nV;return"M0,"+-n+"L"+i+",0 0,"+n+" "+-i+",0Z"},square:function(r){var n=Math.sqrt(r)/2;return"M"+-n+","+-n+"L"+n+","+-n+" "+n+","+n+" "+-n+","+n+"Z"},"triangle-down":function(r){var n=Math.sqrt(r/nU),i=n*nU/2;return"M0,"+i+"L"+n+","+-i+" "+-n+","+-i+"Z"},"triangle-up":function(r){var n=Math.sqrt(r/nU),i=n*nU/2;return"M0,"+-i+"L"+n+","+i+" "+-n+","+i+"Z"}});r.svg.symbolTypes=nj.keys();var nU=Math.sqrt(3),nV=Math.tan(30*tS);Y.transition=function(r){for(var n,i,a=nY||++nZ,o=nQ(r),s=[],l=nW||{time:Date.now(),ease:e8,delay:0,duration:250},c=-1,u=this.length;++c<u;){s.push(n=[]);for(var f=this[c],h=-1,p=f.length;++h<p;)(i=f[h])&&n$(i,h,o,a,l),n.push(i)}return nG(s,o,a)},Y.interrupt=function(r){return this.each(null==r?nH:nq(nQ(r)))};var nH=nq(nQ());function nq(r){return function(){var n,i,a;(n=this[r])&&(a=n[i=n.active])&&(a.timer.c=null,a.timer.t=NaN,--n.count?delete n[i]:delete this[r],n.active+=.5,a.event&&a.event.interrupt.call(this,this.__data__,a.index))}}function nG(r,n,i){return U(r,nX),r.namespace=n,r.id=i,r}var nY,nW,nX=[],nZ=0;function nJ(r,n,i,a){var o=r.id,s=r.namespace;return tu(r,"function"==typeof i?function(r,l,c){r[s][o].tween.set(n,a(i.call(r,r.__data__,l,c)))}:(i=a(i),function(r){r[s][o].tween.set(n,i)}))}function nK(r){return null==r&&(r=""),function(){this.textContent=r}}function nQ(r){return null==r?"__transition__":"__transition_"+r+"__"}function n$(r,n,i,a,o){var s,l,c,u,f,h=r[i]||(r[i]={active:0,count:0}),p=h[a];function d(i){var o=h.active,d=h[o];for(var g in d&&(d.timer.c=null,d.timer.t=NaN,--h.count,delete h[o],d.event&&d.event.interrupt.call(r,r.__data__,d.index)),h)if(+g<a){var v=h[g];v.timer.c=null,v.timer.t=NaN,--h.count,delete h[g]}l.c=m,ei(function(){return l.c&&m(i||1)&&(l.c=null,l.t=NaN),1},0,s),h.active=a,p.event&&p.event.start.call(r,r.__data__,n),f=[],p.tween.forEach(function(i,a){(a=a.call(r,r.__data__,n))&&f.push(a)}),u=p.ease,c=p.duration}function m(o){for(var s=o/c,l=u(s),d=f.length;d>0;)f[--d].call(r,l);if(s>=1)return p.event&&p.event.end.call(r,r.__data__,n),--h.count?delete h[a]:delete r[i],1}p||(l=ei(function(r){var n=p.delay;if(l.t=n+s,n<=r)return d(r-n);l.c=d},0,s=o.time),p=h[a]={tween:new w,time:s,timer:l,delay:o.delay,duration:o.duration,ease:o.ease,index:n},o=null,++h.count)}nX.call=Y.call,nX.empty=Y.empty,nX.node=Y.node,nX.size=Y.size,r.transition=function(n,i){return n&&n.transition?nY?n.transition(i):n:r.selection().transition(n)},r.transition.prototype=nX,nX.select=function(r){var n,i,a,o=this.id,s=this.namespace,l=[];r=W(r);for(var c=-1,u=this.length;++c<u;){l.push(n=[]);for(var f=this[c],h=-1,p=f.length;++h<p;)(a=f[h])&&(i=r.call(a,a.__data__,h,c))?("__data__"in a&&(i.__data__=a.__data__),n$(i,h,s,o,a[s][o]),n.push(i)):n.push(null)}return nG(l,s,o)},nX.selectAll=function(r){var n,i,a,o,s,l=this.id,c=this.namespace,u=[];r=X(r);for(var f=-1,h=this.length;++f<h;)for(var p=this[f],d=-1,m=p.length;++d<m;)if(a=p[d]){s=a[c][l],i=r.call(a,a.__data__,d,f),u.push(n=[]);for(var g=-1,v=i.length;++g<v;)(o=i[g])&&n$(o,g,c,l,s),n.push(o)}return nG(u,c,l)},nX.filter=function(r){var n,i,a=[];"function"!=typeof r&&(r=tl(r));for(var o=0,s=this.length;o<s;o++){a.push(n=[]);for(var l,c=0,u=(l=this[o]).length;c<u;c++)(i=l[c])&&r.call(i,i.__data__,c,o)&&n.push(i)}return nG(a,this.namespace,this.id)},nX.tween=function(r,n){var i=this.id,a=this.namespace;return arguments.length<2?this.node()[a][i].tween.get(r):tu(this,null==n?function(n){n[a][i].tween.remove(r)}:function(o){o[a][i].tween.set(r,n)})},nX.attr=function(n,i){if(arguments.length<2){for(i in n)this.attr(i,n[i]);return this}var a="transform"==n?rl:eQ,o=r.ns.qualify(n);function s(){this.removeAttribute(o)}function l(){this.removeAttributeNS(o.space,o.local)}return nJ(this,"attr."+n,i,o.local?function(r){return null==r?l:(r+="",function(){var n,i=this.getAttributeNS(o.space,o.local);return i!==r&&(n=a(i,r),function(r){this.setAttributeNS(o.space,o.local,n(r))})})}:function(r){return null==r?s:(r+="",function(){var n,i=this.getAttribute(o);return i!==r&&(n=a(i,r),function(r){this.setAttribute(o,n(r))})})})},nX.attrTween=function(n,i){var a=r.ns.qualify(n);return this.tween("attr."+n,a.local?function(r,n){var o=i.call(this,r,n,this.getAttributeNS(a.space,a.local));return o&&function(r){this.setAttributeNS(a.space,a.local,o(r))}}:function(r,n){var o=i.call(this,r,n,this.getAttribute(a));return o&&function(r){this.setAttribute(a,o(r))}})},nX.style=function(r,n,i){var a=arguments.length;if(a<3){if("string"!=typeof r){for(i in a<2&&(n=""),r)this.style(i,r[i],n);return this}i=""}function o(){this.style.removeProperty(r)}return nJ(this,"style."+r,n,function(n){return null==n?o:(n+="",function(){var a,o=l(this).getComputedStyle(this,null).getPropertyValue(r);return o!==n&&(a=eQ(o,n),function(n){this.style.setProperty(r,a(n),i)})})})},nX.styleTween=function(r,n,i){return arguments.length<3&&(i=""),this.tween("style."+r,function(a,o){var s=n.call(this,a,o,l(this).getComputedStyle(this,null).getPropertyValue(r));return s&&function(n){this.style.setProperty(r,s(n),i)}})},nX.text=function(r){return nJ(this,"text",r,nK)},nX.remove=function(){var r=this.namespace;return this.each("end.transition",function(){var n;this[r].count<2&&(n=this.parentNode)&&n.removeChild(this)})},nX.ease=function(n){var i=this.id,a=this.namespace;return arguments.length<1?this.node()[a][i].ease:("function"!=typeof n&&(n=r.ease.apply(r,arguments)),tu(this,function(r){r[a][i].ease=n}))},nX.delay=function(r){var n=this.id,i=this.namespace;return arguments.length<1?this.node()[i][n].delay:tu(this,"function"==typeof r?function(a,o,s){a[i][n].delay=+r.call(a,a.__data__,o,s)}:(r=+r,function(a){a[i][n].delay=r}))},nX.duration=function(r){var n=this.id,i=this.namespace;return arguments.length<1?this.node()[i][n].duration:tu(this,"function"==typeof r?function(a,o,s){a[i][n].duration=Math.max(1,r.call(a,a.__data__,o,s))}:(r=Math.max(1,r),function(a){a[i][n].duration=r}))},nX.each=function(n,i){var a=this.id,o=this.namespace;if(arguments.length<2){var s=nW,l=nY;try{nY=a,tu(this,function(r,i,s){nW=r[o][a],n.call(r,r.__data__,i,s)})}finally{nW=s,nY=l}}else tu(this,function(s){var l=s[o][a];(l.event||(l.event=r.dispatch("start","end","interrupt"))).on(n,i)});return this},nX.transition=function(){for(var r,n,i,a=this.id,o=++nZ,s=this.namespace,l=[],c=0,u=this.length;c<u;c++){l.push(r=[]);for(var f,h=0,p=(f=this[c]).length;h<p;h++)(n=f[h])&&n$(n,h,s,o,{time:(i=n[s][a]).time,ease:i.ease,delay:i.delay+i.duration,duration:i.duration}),r.push(n)}return nG(l,s,o)},r.svg.axis=function(){var n,i=r.scale.linear(),o=n0,s=6,l=6,c=3,u=[10],f=null;function h(a){a.each(function(){var a,h=r.select(this),p=this.__chart__||i,d=this.__chart__=i.copy(),m=null==f?d.ticks?d.ticks.apply(d,u):d.domain():f,g=null==n?d.tickFormat?d.tickFormat.apply(d,u):P:n,v=h.selectAll(".tick").data(m,d),y=v.enter().insert("g",".domain").attr("class","tick").style("opacity",1e-6),x=r.transition(v.exit()).style("opacity",1e-6).remove(),b=r.transition(v.order()).style("opacity",1),_=Math.max(s,0)+c,w=r0(d),T=h.selectAll(".domain").data([0]),k=(T.enter().append("path").attr("class","domain"),r.transition(T));y.append("line"),y.append("text");var A,M,S,E,L=y.select("line"),C=b.select("line"),I=v.select("text").text(g),O=y.select("text"),z=b.select("text"),D="top"===o||"left"===o?-1:1;if("bottom"===o||"top"===o?(a=n2,A="x",S="y",M="x2",E="y2",I.attr("dy",D<0?"0em":".71em").style("text-anchor","middle"),k.attr("d","M"+w[0]+","+D*l+"V0H"+w[1]+"V"+D*l)):(a=n3,A="y",S="x",M="y2",E="x2",I.attr("dy",".32em").style("text-anchor",D<0?"end":"start"),k.attr("d","M"+D*l+","+w[0]+"H0V"+w[1]+"H"+D*l)),L.attr(E,D*s),O.attr(S,D*_),C.attr(M,0).attr(E,D*s),z.attr(A,0).attr(S,D*_),d.rangeBand){var R=d,F=R.rangeBand()/2;p=d=function(r){return R(r)+F}}else p.rangeBand?p=d:x.call(a,d,p);y.call(a,p,d),b.call(a,d,d)})}return h.scale=function(r){return arguments.length?(i=r,h):i},h.orient=function(r){return arguments.length?(o=r in n1?r+"":n0,h):o},h.ticks=function(){return arguments.length?(u=a(arguments),h):u},h.tickValues=function(r){return arguments.length?(f=r,h):f},h.tickFormat=function(r){return arguments.length?(n=r,h):n},h.tickSize=function(r){var n=arguments.length;return n?(s=+r,l=+arguments[n-1],h):s},h.innerTickSize=function(r){return arguments.length?(s=+r,h):s},h.outerTickSize=function(r){return arguments.length?(l=+r,h):l},h.tickPadding=function(r){return arguments.length?(c=+r,h):c},h.tickSubdivide=function(){return arguments.length&&h},h};var n0="bottom",n1={top:1,right:1,bottom:1,left:1};function n2(r,n,i){r.attr("transform",function(r){var a=n(r);return"translate("+(isFinite(a)?a:i(r))+",0)"})}function n3(r,n,i){r.attr("transform",function(r){var a=n(r);return"translate(0,"+(isFinite(a)?a:i(r))+")"})}r.svg.brush=function(){var n,i,a=N(d,"brushstart","brush","brushend"),o=null,s=null,c=[0,0],u=[0,0],f=!0,h=!0,p=n4[0];function d(n){n.each(function(){var n=r.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",y).on("touchstart.brush",y),i=n.selectAll(".background").data([0]);i.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),n.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=n.selectAll(".resize").data(p,P);a.exit().remove(),a.enter().append("g").attr("class",function(r){return"resize "+r}).style("cursor",function(r){return n5[r]}).append("rect").attr("x",function(r){return/[ew]$/.test(r)?-3:null}).attr("y",function(r){return/^[ns]/.test(r)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",d.empty()?"none":null);var l,c=r.transition(n),u=r.transition(i);o&&(l=r0(o),u.attr("x",l[0]).attr("width",l[1]-l[0]),g(c)),s&&(l=r0(s),u.attr("y",l[0]).attr("height",l[1]-l[0]),v(c)),m(c)})}function m(r){r.selectAll(".resize").attr("transform",function(r){return"translate("+c[+/e$/.test(r)]+","+u[+/^s/.test(r)]+")"})}function g(r){r.select(".extent").attr("x",c[0]),r.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function v(r){r.select(".extent").attr("y",u[0]),r.selectAll(".extent,.e>rect,.w>rect").attr("height",u[1]-u[0])}function y(){var p,y,x=this,b=r.select(r.event.target),_=a.of(x,arguments),w=r.select(x),T=b.datum(),k=!/^(n|s)$/.test(T)&&o,A=!/^(e|w)$/.test(T)&&s,M=b.classed("extent"),S=tx(x),E=r.mouse(x),L=r.select(l(x)).on("keydown.brush",function(){32==r.event.keyCode&&(M||(p=null,E[0]-=c[1],E[1]-=u[1],M=2),F())}).on("keyup.brush",function(){32==r.event.keyCode&&2==M&&(E[0]+=c[1],E[1]+=u[1],M=0,F())});if(r.event.changedTouches?L.on("touchmove.brush",I).on("touchend.brush",z):L.on("mousemove.brush",I).on("mouseup.brush",z),w.interrupt().selectAll("*").interrupt(),M)E[0]=c[0]-E[0],E[1]=u[0]-E[1];else if(T){var C=+/w$/.test(T),P=+/^n/.test(T);y=[c[1-C]-E[0],u[1-P]-E[1]],E[0]=c[C],E[1]=u[P]}else r.event.altKey&&(p=E.slice());function I(){var n=r.mouse(x),i=!1;y&&(n[0]+=y[0],n[1]+=y[1]),M||(r.event.altKey?(p||(p=[(c[0]+c[1])/2,(u[0]+u[1])/2]),E[0]=c[+(n[0]<p[0])],E[1]=u[+(n[1]<p[1])]):p=null),k&&O(n,o,0)&&(g(w),i=!0),A&&O(n,s,1)&&(v(w),i=!0),i&&(m(w),_({type:"brush",mode:M?"move":"resize"}))}function O(r,a,o){var s,l,d=r0(a),m=d[0],g=d[1],v=E[o],y=o?u:c,x=y[1]-y[0];if(M&&(m-=v,g-=x+v),s=(o?h:f)?Math.max(m,Math.min(g,r[o])):r[o],M?l=(s+=v)+x:(p&&(v=Math.max(m,Math.min(g,2*p[o]-s))),v<s?(l=s,s=v):l=v),y[0]!=s||y[1]!=l)return o?i=null:n=null,y[0]=s,y[1]=l,!0}function z(){I(),w.style("pointer-events","all").selectAll(".resize").style("display",d.empty()?"none":null),r.select("body").style("cursor",null),L.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),S(),_({type:"brushend"})}w.style("pointer-events","none").selectAll(".resize").style("display",null),r.select("body").style("cursor",b.style("cursor")),_({type:"brushstart"}),I()}return d.event=function(o){o.each(function(){var o=a.of(this,arguments),s={x:c,y:u,i:n,j:i},l=this.__chart__||s;this.__chart__=s,nY?r.select(this).transition().each("start.brush",function(){n=l.i,i=l.j,c=l.x,u=l.y,o({type:"brushstart"})}).tween("brush:brush",function(){var r=e$(c,s.x),a=e$(u,s.y);return n=i=null,function(n){c=s.x=r(n),u=s.y=a(n),o({type:"brush",mode:"resize"})}}).each("end.brush",function(){n=s.i,i=s.j,o({type:"brush",mode:"resize"}),o({type:"brushend"})}):(o({type:"brushstart"}),o({type:"brush",mode:"resize"}),o({type:"brushend"}))})},d.x=function(r){return arguments.length?(p=n4[!(o=r)<<1|!s],d):o},d.y=function(r){return arguments.length?(p=n4[!o<<1|!(s=r)],d):s},d.clamp=function(r){return arguments.length?(o&&s?(f=!!r[0],h=!!r[1]):o?f=!!r:s&&(h=!!r),d):o&&s?[f,h]:o?f:s?h:null},d.extent=function(r){var a,l,f,h,p;return arguments.length?(o&&(a=r[0],l=r[1],s&&(a=a[0],l=l[0]),n=[a,l],o.invert&&(a=o(a),l=o(l)),l<a&&(p=a,a=l,l=p),a==c[0]&&l==c[1]||(c=[a,l])),s&&(f=r[0],h=r[1],o&&(f=f[1],h=h[1]),i=[f,h],s.invert&&(f=s(f),h=s(h)),h<f&&(p=f,f=h,h=p),f==u[0]&&h==u[1]||(u=[f,h])),d):(o&&(n?(a=n[0],l=n[1]):(a=c[0],l=c[1],o.invert&&(a=o.invert(a),l=o.invert(l)),l<a&&(p=a,a=l,l=p))),s&&(i?(f=i[0],h=i[1]):(f=u[0],h=u[1],s.invert&&(f=s.invert(f),h=s.invert(h)),h<f&&(p=f,f=h,h=p))),o&&s?[[a,f],[l,h]]:o?[a,l]:s&&[f,h])},d.clear=function(){return d.empty()||(c=[0,0],u=[0,0],n=i=null),d},d.empty=function(){return!!o&&c[0]==c[1]||!!s&&u[0]==u[1]},r.rebind(d,a,"on")};var n5={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},n4=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function n6(r){return JSON.parse(r.responseText)}function n8(r){var n=o.createRange();return n.selectNode(o.body),n.createContextualFragment(r.responseText)}r.text=t8(function(r){return r.responseText}),r.json=function(r,n){return t9(r,"application/json",n6,n)},r.html=function(r,n){return t9(r,"text/html",n8,n)},r.xml=t8(function(r){return r.responseXML}),"object"==typeof n&&n.exports?n.exports=r:this.d3=r}).apply(self)},{}],59:[function(r,n,i){"use strict";n.exports=r("./quad")},{"./quad":60}],60:[function(r,n,i){"use strict";var a=r("binary-search-bounds"),o=r("clamp"),s=r("parse-rect"),l=r("array-bounds"),c=r("pick-by-alias"),u=r("defined"),f=r("flatten-vertex-data"),h=r("is-obj"),p=r("dtype"),d=r("math-log2");function m(r,n){for(var i=n[0],a=n[1],s=1/(n[2]-i),l=1/(n[3]-a),c=Array(r.length),u=0,f=r.length/2;u<f;u++)c[2*u]=o((r[2*u]-i)*s,0,1),c[2*u+1]=o((r[2*u+1]-a)*l,0,1);return c}n.exports=function(r,n){n||(n={}),r=f(r,"float64");var i=u((n=c(n,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"})).maxDepth,255),o=u(n.bounds,l(r,2));o[0]===o[2]&&o[2]++,o[1]===o[3]&&o[3]++;var g,v=m(r,o),y=r.length>>>1;n.dtype||(n.dtype="array"),"string"==typeof n.dtype?g=new(p(n.dtype))(y):n.dtype&&Array.isArray(g=n.dtype)&&(g.length=y);for(var x=0;x<y;++x)g[x]=x;var b=[],_=[],w=[],T=[];!function r(n,a,o,s,l,c){if(!s.length)return null;var u=b[l]||(b[l]=[]),f=w[l]||(w[l]=[]),h=_[l]||(_[l]=[]),p=u.length;if(++l>i||c>1073741824){for(var d=0;d<s.length;d++)u.push(s[d]),f.push(c),h.push(null,null,null,null);return p}if(u.push(s[0]),f.push(c),s.length<=1)return h.push(null,null,null,null),p;for(var m=.5*o,g=n+m,y=a+m,x=[],T=[],k=[],A=[],M=1,S=s.length;M<S;M++){var E=s[M],L=v[2*E],C=v[2*E+1];L<g?C<y?x.push(E):T.push(E):C<y?k.push(E):A.push(E)}return c<<=2,h.push(r(n,a,m,x,l,c),r(n,y,m,T,l,c+1),r(g,a,m,k,l,c+2),r(g,y,m,A,l,c+3)),p}(0,0,1,g,0,1);for(var k=0,A=0;A<b.length;A++){var M=b[A];if(g.set)g.set(M,k);else for(var S=0,E=M.length;S<E;S++)g[S+k]=M[S];var L=k+b[A].length;T[A]=[k,L],k=L}return g.range=function(){for(var n,i,l=[],f=arguments.length;f--;)l[f]=arguments[f];if(h(l[l.length-1])){var p=l.pop();l.length||null==p.x&&null==p.l&&null==p.left||(l=[p],i={}),i=c(p,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else i={};l.length||(l=o);var g=s.apply(void 0,l),v=[Math.min(g.x,g.x+g.width),Math.min(g.y,g.y+g.height),Math.max(g.x,g.x+g.width),Math.max(g.y,g.y+g.height)],y=v[0],x=v[1],k=v[2],A=v[3],M=m([y,x,k,A],o),S=M[0],E=M[1],L=M[2],P=M[3],I=u(i.level,b.length);if(null!=i.d&&("number"==typeof i.d?n=[i.d,i.d]:i.d.length&&(n=i.d),I=Math.min(Math.max(Math.ceil(-d(Math.abs(n[0])/(o[2]-o[0]))),Math.ceil(-d(Math.abs(n[1])/(o[3]-o[1])))),I)),I=Math.min(I,b.length),i.lod)return function(r,n,i,o,s){for(var l=[],c=0;c<s;c++){var u=w[c],f=T[c][0],h=C(r,n,c),p=C(i,o,c),d=a.ge(u,h),m=a.gt(u,p,d,u.length-1);l[c]=[d+f,m+f]}return l}(S,E,L,P,I);var O=[];return function n(i,a,o,s,l,c){if(null!==l&&null!==c&&!(S>i+o||E>a+o||L<i||P<a||s>=I||l===c)){var u=b[s];void 0===c&&(c=u.length);for(var f=l;f<c;f++){var h=u[f],p=r[2*h],d=r[2*h+1];p>=y&&p<=k&&d>=x&&d<=A&&O.push(h)}var m=_[s],g=m[4*l+0],v=m[4*l+1],w=m[4*l+2],T=m[4*l+3],M=function(r,n){for(var i=null,a=0;null===i;)if(i=r[4*n+a],++a>r.length)return null;return i}(m,l+1),C=.5*o,z=s+1;n(i,a,C,z,g,v||w||T||M),n(i,a+C,C,z,v,w||T||M),n(i+C,a,C,z,w,T||M),n(i+C,a+C,C,z,T,M)}}(0,0,1,0,0,1),O},g;function C(r,n,i){for(var a=1,o=.5,s=.5,l=.5,c=0;c<i;c++)a<<=2,a+=r<o?n<s?0:1:n<s?2:3,l*=.5,o+=r<o?-l:l,s+=n<s?-l:l;return a}}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(r,n,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=r("@turf/meta");function o(r){var n=0;if(r&&r.length>0){n+=Math.abs(s(r[0]));for(var i=1;i<r.length;i++)n-=Math.abs(s(r[i]))}return n}function s(r){var n,i,a,o,s,c,u=0,f=r.length;if(f>2){for(c=0;c<f;c++)c===f-2?(a=f-2,o=f-1,s=0):c===f-1?(a=f-1,o=0,s=1):(a=c,o=c+1,s=c+2),n=r[a],i=r[o],u+=(l(r[s][0])-l(n[0]))*Math.sin(l(i[1]));u=6378137*u*6378137/2}return u}function l(r){return r*Math.PI/180}i.default=function(r){return a.geomReduce(r,function(r,n){return r+function(r){var n,i=0;switch(r.type){case"Polygon":return o(r.coordinates);case"MultiPolygon":for(n=0;n<r.coordinates.length;n++)i+=o(r.coordinates[n]);return i}return 0}(n)},0)}},{"@turf/meta":63}],62:[function(r,n,i){"use strict";function a(r,n,i){void 0===i&&(i={});var a={type:"Feature"};return(0===i.id||i.id)&&(a.id=i.id),i.bbox&&(a.bbox=i.bbox),a.properties=n||{},a.geometry=r,a}function o(r,n,i){if(void 0===i&&(i={}),!r)throw Error("coordinates is required");if(!Array.isArray(r))throw Error("coordinates must be an Array");if(r.length<2)throw Error("coordinates must be at least 2 numbers long");if(!g(r[0])||!g(r[1]))throw Error("coordinates must contain numbers");return a({type:"Point",coordinates:r},n,i)}function s(r,n,i){void 0===i&&(i={});for(var o=0;o<r.length;o++){var s=r[o];if(s.length<4)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<s[s.length-1].length;l++)if(s[s.length-1][l]!==s[0][l])throw Error("First and last Position are not equivalent.")}return a({type:"Polygon",coordinates:r},n,i)}function l(r,n,i){if(void 0===i&&(i={}),r.length<2)throw Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:r},n,i)}function c(r,n){void 0===n&&(n={});var i={type:"FeatureCollection"};return n.id&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.features=r,i}function u(r,n,i){return void 0===i&&(i={}),a({type:"MultiLineString",coordinates:r},n,i)}function f(r,n,i){return void 0===i&&(i={}),a({type:"MultiPoint",coordinates:r},n,i)}function h(r,n,i){return void 0===i&&(i={}),a({type:"MultiPolygon",coordinates:r},n,i)}function p(r,n){void 0===n&&(n="kilometers");var a=i.factors[n];if(!a)throw Error(n+" units is invalid");return r*a}function d(r,n){void 0===n&&(n="kilometers");var a=i.factors[n];if(!a)throw Error(n+" units is invalid");return r/a}function m(r){return r%(2*Math.PI)*180/Math.PI}function g(r){return!isNaN(r)&&null!==r&&!Array.isArray(r)}Object.defineProperty(i,"__esModule",{value:!0}),i.earthRadius=6371008.8,i.factors={centimeters:100*i.earthRadius,centimetres:100*i.earthRadius,degrees:i.earthRadius/111325,feet:3.28084*i.earthRadius,inches:39.37*i.earthRadius,kilometers:i.earthRadius/1e3,kilometres:i.earthRadius/1e3,meters:i.earthRadius,metres:i.earthRadius,miles:i.earthRadius/1609.344,millimeters:1e3*i.earthRadius,millimetres:1e3*i.earthRadius,nauticalmiles:i.earthRadius/1852,radians:1,yards:1.0936*i.earthRadius},i.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/i.earthRadius,yards:1.0936133},i.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},i.feature=a,i.geometry=function(r,n,i){switch(void 0===i&&(i={}),r){case"Point":return o(n).geometry;case"LineString":return l(n).geometry;case"Polygon":return s(n).geometry;case"MultiPoint":return f(n).geometry;case"MultiLineString":return u(n).geometry;case"MultiPolygon":return h(n).geometry;default:throw Error(r+" is invalid")}},i.point=o,i.points=function(r,n,i){return void 0===i&&(i={}),c(r.map(function(r){return o(r,n)}),i)},i.polygon=s,i.polygons=function(r,n,i){return void 0===i&&(i={}),c(r.map(function(r){return s(r,n)}),i)},i.lineString=l,i.lineStrings=function(r,n,i){return void 0===i&&(i={}),c(r.map(function(r){return l(r,n)}),i)},i.featureCollection=c,i.multiLineString=u,i.multiPoint=f,i.multiPolygon=h,i.geometryCollection=function(r,n,i){return void 0===i&&(i={}),a({type:"GeometryCollection",geometries:r},n,i)},i.round=function(r,n){if(void 0===n&&(n=0),n&&!(n>=0))throw Error("precision must be a positive number");var i=Math.pow(10,n||0);return Math.round(r*i)/i},i.radiansToLength=p,i.lengthToRadians=d,i.lengthToDegrees=function(r,n){return m(d(r,n))},i.bearingToAzimuth=function(r){var n=r%360;return n<0&&(n+=360),n},i.radiansToDegrees=m,i.degreesToRadians=function(r){return r%360*Math.PI/180},i.convertLength=function(r,n,i){if(void 0===n&&(n="kilometers"),void 0===i&&(i="kilometers"),!(r>=0))throw Error("length must be a positive number");return p(d(r,n),i)},i.convertArea=function(r,n,a){if(void 0===n&&(n="meters"),void 0===a&&(a="kilometers"),!(r>=0))throw Error("area must be a positive number");var o=i.areaFactors[n];if(!o)throw Error("invalid original units");var s=i.areaFactors[a];if(!s)throw Error("invalid final units");return r/o*s},i.isNumber=g,i.isObject=function(r){return!!r&&r.constructor===Object},i.validateBBox=function(r){if(!r)throw Error("bbox is required");if(!Array.isArray(r))throw Error("bbox must be an Array");if(4!==r.length&&6!==r.length)throw Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(r){if(!g(r))throw Error("bbox must only contain numbers")})},i.validateId=function(r){if(!r)throw Error("id is required");if(-1===["string","number"].indexOf(typeof r))throw Error("id must be a number or a string")}},{}],63:[function(r,n,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=r("@turf/helpers");function o(r,n,i){if(null!==r)for(var a,s,l,c,u,f,h,p,d=0,m=0,g=r.type,v="FeatureCollection"===g,y="Feature"===g,x=v?r.features.length:1,b=0;b<x;b++){u=(p=!!(h=v?r.features[b].geometry:y?r.geometry:r)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var _=0;_<u;_++){var w=0,T=0;if(null!==(c=p?h.geometries[_]:h)){f=c.coordinates;var k=c.type;switch(d=i&&("Polygon"===k||"MultiPolygon"===k)?1:0,k){case null:break;case"Point":if(!1===n(f,m,b,w,T))return!1;m++,w++;break;case"LineString":case"MultiPoint":for(a=0;a<f.length;a++){if(!1===n(f[a],m,b,w,T))return!1;m++,"MultiPoint"===k&&w++}"LineString"===k&&w++;break;case"Polygon":case"MultiLineString":for(a=0;a<f.length;a++){for(s=0;s<f[a].length-d;s++){if(!1===n(f[a][s],m,b,w,T))return!1;m++}"MultiLineString"===k&&w++,"Polygon"===k&&T++}"Polygon"===k&&w++;break;case"MultiPolygon":for(a=0;a<f.length;a++){for(T=0,s=0;s<f[a].length;s++){for(l=0;l<f[a][s].length-d;l++){if(!1===n(f[a][s][l],m,b,w,T))return!1;m++}T++}w++}break;case"GeometryCollection":for(a=0;a<c.geometries.length;a++)if(!1===o(c.geometries[a],n,i))return!1;break;default:throw Error("Unknown Geometry Type")}}}}}function s(r,n){var i;switch(r.type){case"FeatureCollection":for(i=0;i<r.features.length&&!1!==n(r.features[i].properties,i);i++);break;case"Feature":n(r.properties,0)}}function l(r,n){if("Feature"===r.type)n(r,0);else if("FeatureCollection"===r.type)for(var i=0;i<r.features.length&&!1!==n(r.features[i],i);i++);}function c(r,n){var i,a,o,s,l,c,u,f,h,p,d=0,m="FeatureCollection"===r.type,g="Feature"===r.type,v=m?r.features.length:1;for(i=0;i<v;i++){for(c=m?r.features[i].geometry:g?r.geometry:r,f=m?r.features[i].properties:g?r.properties:{},h=m?r.features[i].bbox:g?r.bbox:void 0,p=m?r.features[i].id:g?r.id:void 0,l=(u=!!c&&"GeometryCollection"===c.type)?c.geometries.length:1,o=0;o<l;o++)if(null!==(s=u?c.geometries[o]:c))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===n(s,d,f,h,p))return!1;break;case"GeometryCollection":for(a=0;a<s.geometries.length;a++)if(!1===n(s.geometries[a],d,f,h,p))return!1;break;default:throw Error("Unknown Geometry Type")}else if(!1===n(null,d,f,h,p))return!1;d++}}function u(r,n){c(r,function(r,i,o,s,l){var c,u=null===r?null:r.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==n(a.feature(r,o,{bbox:s,id:l}),i,0)&&void 0}switch(u){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon"}for(var f=0;f<r.coordinates.length;f++){var h={type:c,coordinates:r.coordinates[f]};if(!1===n(a.feature(h,o),i,f))return!1}})}function f(r,n){u(r,function(r,i,s){var l=0;if(r.geometry){var c=r.geometry.type;if("Point"!==c&&"MultiPoint"!==c){var u,f=0,h=0,p=0;return!1!==o(r,function(o,c,d,m,g){return void 0===u||i>f||m>h||g>p?(u=o,f=i,h=m,p=g,void(l=0)):!1!==n(a.lineString([u,o],r.properties),i,s,g,l)&&void(l++,u=o)})&&void 0}}})}function h(r,n){if(!r)throw Error("geojson is required");u(r,function(r,i,o){if(null!==r.geometry){var s=r.geometry.type,l=r.geometry.coordinates;switch(s){case"LineString":if(!1===n(r,i,o,0,0))return!1;break;case"Polygon":for(var c=0;c<l.length;c++)if(!1===n(a.lineString(l[c],r.properties),i,o,c))return!1}}})}i.coordEach=o,i.coordReduce=function(r,n,i,a){var s=i;return o(r,function(r,a,o,l,c){s=0===a&&void 0===i?r:n(s,r,a,o,l,c)},a),s},i.propEach=s,i.propReduce=function(r,n,i){var a=i;return s(r,function(r,o){a=0===o&&void 0===i?r:n(a,r,o)}),a},i.featureEach=l,i.featureReduce=function(r,n,i){var a=i;return l(r,function(r,o){a=0===o&&void 0===i?r:n(a,r,o)}),a},i.coordAll=function(r){var n=[];return o(r,function(r){n.push(r)}),n},i.geomEach=c,i.geomReduce=function(r,n,i){var a=i;return c(r,function(r,o,s,l,c){a=0===o&&void 0===i?r:n(a,r,o,s,l,c)}),a},i.flattenEach=u,i.flattenReduce=function(r,n,i){var a=i;return u(r,function(r,o,s){a=0===o&&0===s&&void 0===i?r:n(a,r,o,s)}),a},i.segmentEach=f,i.segmentReduce=function(r,n,i){var a=i,o=!1;return f(r,function(r,s,l,c,u){a=!1===o&&void 0===i?r:n(a,r,s,l,c,u),o=!0}),a},i.lineEach=h,i.lineReduce=function(r,n,i){var a=i;return h(r,function(r,o,s,l){a=0===o&&void 0===i?r:n(a,r,o,s,l)}),a},i.findSegment=function(r,n){if(n=n||{},!a.isObject(n))throw Error("options is invalid");var i,o=n.featureIndex||0,s=n.multiFeatureIndex||0,l=n.geometryIndex||0,c=n.segmentIndex||0,u=n.properties;switch(r.type){case"FeatureCollection":o<0&&(o=r.features.length+o),u=u||r.features[o].properties,i=r.features[o].geometry;break;case"Feature":u=u||r.properties,i=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=r;break;default:throw Error("geojson is invalid")}if(null===i)return null;var f=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return c<0&&(c=f.length+c-1),a.lineString([f[c],f[c+1]],u,n);case"Polygon":return l<0&&(l=f.length+l),c<0&&(c=f[l].length+c-1),a.lineString([f[l][c],f[l][c+1]],u,n);case"MultiLineString":return s<0&&(s=f.length+s),c<0&&(c=f[s].length+c-1),a.lineString([f[s][c],f[s][c+1]],u,n);case"MultiPolygon":return s<0&&(s=f.length+s),l<0&&(l=f[s].length+l),c<0&&(c=f[s][l].length-c-1),a.lineString([f[s][l][c],f[s][l][c+1]],u,n)}throw Error("geojson is invalid")},i.findPoint=function(r,n){if(n=n||{},!a.isObject(n))throw Error("options is invalid");var i,o=n.featureIndex||0,s=n.multiFeatureIndex||0,l=n.geometryIndex||0,c=n.coordIndex||0,u=n.properties;switch(r.type){case"FeatureCollection":o<0&&(o=r.features.length+o),u=u||r.features[o].properties,i=r.features[o].geometry;break;case"Feature":u=u||r.properties,i=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=r;break;default:throw Error("geojson is invalid")}if(null===i)return null;var f=i.coordinates;switch(i.type){case"Point":return a.point(f,u,n);case"MultiPoint":return s<0&&(s=f.length+s),a.point(f[s],u,n);case"LineString":return c<0&&(c=f.length+c),a.point(f[c],u,n);case"Polygon":return l<0&&(l=f.length+l),c<0&&(c=f[l].length+c),a.point(f[l][c],u,n);case"MultiLineString":return s<0&&(s=f.length+s),c<0&&(c=f[s].length+c),a.point(f[s][c],u,n);case"MultiPolygon":return s<0&&(s=f.length+s),l<0&&(l=f[s].length+l),c<0&&(c=f[s][l].length-c),a.point(f[s][l][c],u,n)}throw Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(r,n,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=r("@turf/meta");function o(r){var n=[1/0,1/0,-1/0,-1/0];return a.coordEach(r,function(r){n[0]>r[0]&&(n[0]=r[0]),n[1]>r[1]&&(n[1]=r[1]),n[2]<r[0]&&(n[2]=r[0]),n[3]<r[1]&&(n[3]=r[1])}),n}o.default=o,i.default=o},{"@turf/meta":66}],65:[function(r,n,i){arguments[4][62][0].apply(i,arguments)},{dup:62}],66:[function(r,n,i){arguments[4][63][0].apply(i,arguments)},{"@turf/helpers":65,dup:63}],67:[function(r,n,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=r("@turf/meta"),o=r("@turf/helpers");i.default=function(r,n){void 0===n&&(n={});var i=0,s=0,l=0;return a.coordEach(r,function(r){i+=r[0],s+=r[1],l++}),o.point([i/l,s/l],n.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(r,n,i){"use strict";function a(r,n,i){void 0===i&&(i={});var a={type:"Feature"};return(0===i.id||i.id)&&(a.id=i.id),i.bbox&&(a.bbox=i.bbox),a.properties=n||{},a.geometry=r,a}function o(r,n,i){return void 0===i&&(i={}),a({type:"Point",coordinates:r},n,i)}function s(r,n,i){void 0===i&&(i={});for(var o=0;o<r.length;o++){var s=r[o];if(s.length<4)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<s[s.length-1].length;l++)if(s[s.length-1][l]!==s[0][l])throw Error("First and last Position are not equivalent.")}return a({type:"Polygon",coordinates:r},n,i)}function l(r,n,i){if(void 0===i&&(i={}),r.length<2)throw Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:r},n,i)}function c(r,n){void 0===n&&(n={});var i={type:"FeatureCollection"};return n.id&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.features=r,i}function u(r,n,i){return void 0===i&&(i={}),a({type:"MultiLineString",coordinates:r},n,i)}function f(r,n,i){return void 0===i&&(i={}),a({type:"MultiPoint",coordinates:r},n,i)}function h(r,n,i){return void 0===i&&(i={}),a({type:"MultiPolygon",coordinates:r},n,i)}function p(r,n){void 0===n&&(n="kilometers");var a=i.factors[n];if(!a)throw Error(n+" units is invalid");return r*a}function d(r,n){void 0===n&&(n="kilometers");var a=i.factors[n];if(!a)throw Error(n+" units is invalid");return r/a}function m(r){return r%(2*Math.PI)*180/Math.PI}function g(r){return!isNaN(r)&&null!==r&&!Array.isArray(r)&&!/^\s*$/.test(r)}Object.defineProperty(i,"__esModule",{value:!0}),i.earthRadius=6371008.8,i.factors={centimeters:100*i.earthRadius,centimetres:100*i.earthRadius,degrees:i.earthRadius/111325,feet:3.28084*i.earthRadius,inches:39.37*i.earthRadius,kilometers:i.earthRadius/1e3,kilometres:i.earthRadius/1e3,meters:i.earthRadius,metres:i.earthRadius,miles:i.earthRadius/1609.344,millimeters:1e3*i.earthRadius,millimetres:1e3*i.earthRadius,nauticalmiles:i.earthRadius/1852,radians:1,yards:i.earthRadius/1.0936},i.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/i.earthRadius,yards:1/1.0936},i.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},i.feature=a,i.geometry=function(r,n,i){switch(void 0===i&&(i={}),r){case"Point":return o(n).geometry;case"LineString":return l(n).geometry;case"Polygon":return s(n).geometry;case"MultiPoint":return f(n).geometry;case"MultiLineString":return u(n).geometry;case"MultiPolygon":return h(n).geometry;default:throw Error(r+" is invalid")}},i.point=o,i.points=function(r,n,i){return void 0===i&&(i={}),c(r.map(function(r){return o(r,n)}),i)},i.polygon=s,i.polygons=function(r,n,i){return void 0===i&&(i={}),c(r.map(function(r){return s(r,n)}),i)},i.lineString=l,i.lineStrings=function(r,n,i){return void 0===i&&(i={}),c(r.map(function(r){return l(r,n)}),i)},i.featureCollection=c,i.multiLineString=u,i.multiPoint=f,i.multiPolygon=h,i.geometryCollection=function(r,n,i){return void 0===i&&(i={}),a({type:"GeometryCollection",geometries:r},n,i)},i.round=function(r,n){if(void 0===n&&(n=0),n&&!(n>=0))throw Error("precision must be a positive number");var i=Math.pow(10,n||0);return Math.round(r*i)/i},i.radiansToLength=p,i.lengthToRadians=d,i.lengthToDegrees=function(r,n){return m(d(r,n))},i.bearingToAzimuth=function(r){var n=r%360;return n<0&&(n+=360),n},i.radiansToDegrees=m,i.degreesToRadians=function(r){return r%360*Math.PI/180},i.convertLength=function(r,n,i){if(void 0===n&&(n="kilometers"),void 0===i&&(i="kilometers"),!(r>=0))throw Error("length must be a positive number");return p(d(r,n),i)},i.convertArea=function(r,n,a){if(void 0===n&&(n="meters"),void 0===a&&(a="kilometers"),!(r>=0))throw Error("area must be a positive number");var o=i.areaFactors[n];if(!o)throw Error("invalid original units");var s=i.areaFactors[a];if(!s)throw Error("invalid final units");return r/o*s},i.isNumber=g,i.isObject=function(r){return!!r&&r.constructor===Object},i.validateBBox=function(r){if(!r)throw Error("bbox is required");if(!Array.isArray(r))throw Error("bbox must be an Array");if(4!==r.length&&6!==r.length)throw Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(r){if(!g(r))throw Error("bbox must only contain numbers")})},i.validateId=function(r){if(!r)throw Error("id is required");if(-1===["string","number"].indexOf(typeof r))throw Error("id must be a number or a string")},i.radians2degrees=function(){throw Error("method has been renamed to `radiansToDegrees`")},i.degrees2radians=function(){throw Error("method has been renamed to `degreesToRadians`")},i.distanceToDegrees=function(){throw Error("method has been renamed to `lengthToDegrees`")},i.distanceToRadians=function(){throw Error("method has been renamed to `lengthToRadians`")},i.radiansToDistance=function(){throw Error("method has been renamed to `radiansToLength`")},i.bearingToAngle=function(){throw Error("method has been renamed to `bearingToAzimuth`")},i.convertDistance=function(){throw Error("method has been renamed to `convertLength`")}},{}],69:[function(r,n,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=r("@turf/helpers");function o(r,n,i){if(null!==r)for(var a,s,l,c,u,f,h,p,d=0,m=0,g=r.type,v="FeatureCollection"===g,y="Feature"===g,x=v?r.features.length:1,b=0;b<x;b++){u=(p=!!(h=v?r.features[b].geometry:y?r.geometry:r)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var _=0;_<u;_++){var w=0,T=0;if(null!==(c=p?h.geometries[_]:h)){f=c.coordinates;var k=c.type;switch(d=i&&("Polygon"===k||"MultiPolygon"===k)?1:0,k){case null:break;case"Point":if(!1===n(f,m,b,w,T))return!1;m++,w++;break;case"LineString":case"MultiPoint":for(a=0;a<f.length;a++){if(!1===n(f[a],m,b,w,T))return!1;m++,"MultiPoint"===k&&w++}"LineString"===k&&w++;break;case"Polygon":case"MultiLineString":for(a=0;a<f.length;a++){for(s=0;s<f[a].length-d;s++){if(!1===n(f[a][s],m,b,w,T))return!1;m++}"MultiLineString"===k&&w++,"Polygon"===k&&T++}"Polygon"===k&&w++;break;case"MultiPolygon":for(a=0;a<f.length;a++){for(T=0,s=0;s<f[a].length;s++){for(l=0;l<f[a][s].length-d;l++){if(!1===n(f[a][s][l],m,b,w,T))return!1;m++}T++}w++}break;case"GeometryCollection":for(a=0;a<c.geometries.length;a++)if(!1===o(c.geometries[a],n,i))return!1;break;default:throw Error("Unknown Geometry Type")}}}}}function s(r,n){var i;switch(r.type){case"FeatureCollection":for(i=0;i<r.features.length&&!1!==n(r.features[i].properties,i);i++);break;case"Feature":n(r.properties,0)}}function l(r,n){if("Feature"===r.type)n(r,0);else if("FeatureCollection"===r.type)for(var i=0;i<r.features.length&&!1!==n(r.features[i],i);i++);}function c(r,n){var i,a,o,s,l,c,u,f,h,p,d=0,m="FeatureCollection"===r.type,g="Feature"===r.type,v=m?r.features.length:1;for(i=0;i<v;i++){for(c=m?r.features[i].geometry:g?r.geometry:r,f=m?r.features[i].properties:g?r.properties:{},h=m?r.features[i].bbox:g?r.bbox:void 0,p=m?r.features[i].id:g?r.id:void 0,l=(u=!!c&&"GeometryCollection"===c.type)?c.geometries.length:1,o=0;o<l;o++)if(null!==(s=u?c.geometries[o]:c))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===n(s,d,f,h,p))return!1;break;case"GeometryCollection":for(a=0;a<s.geometries.length;a++)if(!1===n(s.geometries[a],d,f,h,p))return!1;break;default:throw Error("Unknown Geometry Type")}else if(!1===n(null,d,f,h,p))return!1;d++}}function u(r,n){c(r,function(r,i,o,s,l){var c,u=null===r?null:r.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==n(a.feature(r,o,{bbox:s,id:l}),i,0)&&void 0}switch(u){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon"}for(var f=0;f<r.coordinates.length;f++){var h={type:c,coordinates:r.coordinates[f]};if(!1===n(a.feature(h,o),i,f))return!1}})}function f(r,n){u(r,function(r,i,s){var l=0;if(r.geometry){var c=r.geometry.type;if("Point"!==c&&"MultiPoint"!==c){var u,f=0,h=0,p=0;return!1!==o(r,function(o,c,d,m,g){return void 0===u||i>f||m>h||g>p?(u=o,f=i,h=m,p=g,void(l=0)):!1!==n(a.lineString([u,o],r.properties),i,s,g,l)&&void(l++,u=o)})&&void 0}}})}function h(r,n){if(!r)throw Error("geojson is required");u(r,function(r,i,o){if(null!==r.geometry){var s=r.geometry.type,l=r.geometry.coordinates;switch(s){case"LineString":if(!1===n(r,i,o,0,0))return!1;break;case"Polygon":for(var c=0;c<l.length;c++)if(!1===n(a.lineString(l[c],r.properties),i,o,c))return!1}}})}i.coordEach=o,i.coordReduce=function(r,n,i,a){var s=i;return o(r,function(r,a,o,l,c){s=0===a&&void 0===i?r:n(s,r,a,o,l,c)},a),s},i.propEach=s,i.propReduce=function(r,n,i){var a=i;return s(r,function(r,o){a=0===o&&void 0===i?r:n(a,r,o)}),a},i.featureEach=l,i.featureReduce=function(r,n,i){var a=i;return l(r,function(r,o){a=0===o&&void 0===i?r:n(a,r,o)}),a},i.coordAll=function(r){var n=[];return o(r,function(r){n.push(r)}),n},i.geomEach=c,i.geomReduce=function(r,n,i){var a=i;return c(r,function(r,o,s,l,c){a=0===o&&void 0===i?r:n(a,r,o,s,l,c)}),a},i.flattenEach=u,i.flattenReduce=function(r,n,i){var a=i;return u(r,function(r,o,s){a=0===o&&0===s&&void 0===i?r:n(a,r,o,s)}),a},i.segmentEach=f,i.segmentReduce=function(r,n,i){var a=i,o=!1;return f(r,function(r,s,l,c,u){a=!1===o&&void 0===i?r:n(a,r,s,l,c,u),o=!0}),a},i.lineEach=h,i.lineReduce=function(r,n,i){var a=i;return h(r,function(r,o,s,l){a=0===o&&void 0===i?r:n(a,r,o,s,l)}),a},i.findSegment=function(r,n){if(n=n||{},!a.isObject(n))throw Error("options is invalid");var i,o=n.featureIndex||0,s=n.multiFeatureIndex||0,l=n.geometryIndex||0,c=n.segmentIndex||0,u=n.properties;switch(r.type){case"FeatureCollection":o<0&&(o=r.features.length+o),u=u||r.features[o].properties,i=r.features[o].geometry;break;case"Feature":u=u||r.properties,i=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=r;break;default:throw Error("geojson is invalid")}if(null===i)return null;var f=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return c<0&&(c=f.length+c-1),a.lineString([f[c],f[c+1]],u,n);case"Polygon":return l<0&&(l=f.length+l),c<0&&(c=f[l].length+c-1),a.lineString([f[l][c],f[l][c+1]],u,n);case"MultiLineString":return s<0&&(s=f.length+s),c<0&&(c=f[s].length+c-1),a.lineString([f[s][c],f[s][c+1]],u,n);case"MultiPolygon":return s<0&&(s=f.length+s),l<0&&(l=f[s].length+l),c<0&&(c=f[s][l].length-c-1),a.lineString([f[s][l][c],f[s][l][c+1]],u,n)}throw Error("geojson is invalid")},i.findPoint=function(r,n){if(n=n||{},!a.isObject(n))throw Error("options is invalid");var i,o=n.featureIndex||0,s=n.multiFeatureIndex||0,l=n.geometryIndex||0,c=n.coordIndex||0,u=n.properties;switch(r.type){case"FeatureCollection":o<0&&(o=r.features.length+o),u=u||r.features[o].properties,i=r.features[o].geometry;break;case"Feature":u=u||r.properties,i=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=r;break;default:throw Error("geojson is invalid")}if(null===i)return null;var f=i.coordinates;switch(i.type){case"Point":return a.point(f,u,n);case"MultiPoint":return s<0&&(s=f.length+s),a.point(f[s],u,n);case"LineString":return c<0&&(c=f.length+c),a.point(f[c],u,n);case"Polygon":return l<0&&(l=f.length+l),c<0&&(c=f[l].length+c),a.point(f[l][c],u,n);case"MultiLineString":return s<0&&(s=f.length+s),c<0&&(c=f[s].length+c),a.point(f[s][c],u,n);case"MultiPolygon":return s<0&&(s=f.length+s),l<0&&(l=f[s].length+l),c<0&&(c=f[s][l].length-c),a.point(f[s][l][c],u,n)}throw Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(r,n,i){n.exports=function(r){var n=0,i=0,a=0,o=0;return r.map(function(r){var s=(r=r.slice())[0],l=s.toUpperCase();if(s!=l)switch(r[0]=l,s){case"a":r[6]+=a,r[7]+=o;break;case"v":r[1]+=o;break;case"h":r[1]+=a;break;default:for(var c=1;c<r.length;)r[c++]+=a,r[c++]+=o}switch(l){case"Z":a=n,o=i;break;case"H":a=r[1];break;case"V":o=r[1];break;case"M":a=n=r[1],o=i=r[2];break;default:a=r[r.length-2],o=r[r.length-1]}return r})}},{}],71:[function(r,n,i){"use strict";n.exports=function(r,n){if(!r||null==r.length)throw Error("Argument should be an array");n=null==n?1:Math.floor(n);for(var i=Array(2*n),a=0;a<n;a++){for(var o=-1/0,s=1/0,l=a,c=r.length;l<c;l+=n)r[l]>o&&(o=r[l]),r[l]<s&&(s=r[l]);i[a]=s,i[n+a]=o}return i}},{}],72:[function(r,n,i){"use strict";n.exports=function(r,n,i){if("function"==typeof Array.prototype.findIndex)return r.findIndex(n,i);if("function"!=typeof n)throw TypeError("predicate must be a function");var a=Object(r),o=a.length;if(0===o)return -1;for(var s=0;s<o;s++)if(n.call(i,a[s],s,a))return s;return -1}},{}],73:[function(r,n,i){"use strict";var a=r("array-bounds");n.exports=function(r,n,i){if(!r||null==r.length)throw Error("Argument should be an array");null==n&&(n=1),null==i&&(i=a(r,n));for(var o=0;o<n;o++){var s=i[n+o],l=i[o],c=o,u=r.length;if(s===1/0&&l===-1/0)for(c=o;c<u;c+=n)r[c]=r[c]===s?1:r[c]===l?0:.5;else if(s===1/0)for(c=o;c<u;c+=n)r[c]=r[c]===s?1:0;else if(l===-1/0)for(c=o;c<u;c+=n)r[c]=r[c]===l?0:1;else{var f=s-l;for(c=o;c<u;c+=n)isNaN(r[c])||(r[c]=0===f?.5:(r[c]-l)/f)}}return r}},{"array-bounds":71}],74:[function(r,n,i){n.exports=function(r,n){var i="number"==typeof r,a="number"==typeof n;i&&!a?(n=r,r=0):i||a||(r=0,n=0);var o=(n|=0)-(r|=0);if(o<0)throw Error("array length must be positive");for(var s=Array(o),l=0,c=r;l<o;l++,c++)s[l]=c;return s}},{}],75:[function(r,n,a){(function(i){(function(){"use strict";var a=r("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function o(r,n){if(r===n)return 0;for(var i=r.length,a=n.length,o=0,s=Math.min(i,a);o<s;++o)if(r[o]!==n[o]){i=r[o],a=n[o];break}return i<a?-1:a<i?1:0}function s(r){return i.Buffer&&"function"==typeof i.Buffer.isBuffer?i.Buffer.isBuffer(r):!(null==r||!r._isBuffer)}var l=r("util/"),c=Object.prototype.hasOwnProperty,u=Array.prototype.slice,f="foo"===(function(){}).name;function h(r){return Object.prototype.toString.call(r)}function p(r){return!s(r)&&"function"==typeof i.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(r):!!r&&(r instanceof DataView||!!(r.buffer&&r.buffer instanceof ArrayBuffer)))}var d=n.exports=b,m=/\s*function\s+([^\(\s]*)\s*/;function g(r){if(l.isFunction(r)){if(f)return r.name;var n=r.toString().match(m);return n&&n[1]}}function v(r,n){return"string"==typeof r?r.length<n?r:r.slice(0,n):r}function y(r){if(f||!l.isFunction(r))return l.inspect(r);var n=g(r);return"[Function"+(n?": "+n:"")+"]"}function x(r,n,i,a,o){throw new d.AssertionError({message:i,actual:r,expected:n,operator:a,stackStartFunction:o})}function b(r,n){r||x(r,!0,n,"==",d.ok)}function _(r,n,i,a){if(r===n)return!0;if(s(r)&&s(n))return 0===o(r,n);if(l.isDate(r)&&l.isDate(n))return r.getTime()===n.getTime();if(l.isRegExp(r)&&l.isRegExp(n))return r.source===n.source&&r.global===n.global&&r.multiline===n.multiline&&r.lastIndex===n.lastIndex&&r.ignoreCase===n.ignoreCase;if(null!==r&&"object"==typeof r||null!==n&&"object"==typeof n){if(p(r)&&p(n)&&h(r)===h(n)&&!(r instanceof Float32Array||r instanceof Float64Array))return 0===o(new Uint8Array(r.buffer),new Uint8Array(n.buffer));if(s(r)!==s(n))return!1;var c=(a=a||{actual:[],expected:[]}).actual.indexOf(r);return -1!==c&&c===a.expected.indexOf(n)||(a.actual.push(r),a.expected.push(n),function(r,n,i,a){if(null==r||null==n)return!1;if(l.isPrimitive(r)||l.isPrimitive(n))return r===n;if(i&&Object.getPrototypeOf(r)!==Object.getPrototypeOf(n))return!1;var o=w(r),s=w(n);if(o&&!s||!o&&s)return!1;if(o)return _(r=u.call(r),n=u.call(n),i);var c,f,h=A(r),p=A(n);if(h.length!==p.length)return!1;for(h.sort(),p.sort(),f=h.length-1;f>=0;f--)if(h[f]!==p[f])return!1;for(f=h.length-1;f>=0;f--)if(!_(r[c=h[f]],n[c],i,a))return!1;return!0}(r,n,i,a))}return i?r===n:r==n}function w(r){return"[object Arguments]"==Object.prototype.toString.call(r)}function T(r,n){if(!r||!n)return!1;if("[object RegExp]"==Object.prototype.toString.call(n))return n.test(r);try{if(r instanceof n)return!0}catch(r){}return!Error.isPrototypeOf(n)&&!0===n.call({},r)}function k(r,n,i,a){if("function"!=typeof n)throw TypeError('"block" argument must be a function');"string"==typeof i&&(a=i,i=null),o=function(r){var n;try{r()}catch(r){n=r}return n}(n),a=(i&&i.name?" ("+i.name+").":".")+(a?" "+a:"."),r&&!o&&x(o,i,"Missing expected exception"+a);var o,s="string"==typeof a,c=!r&&o&&!i;if((!r&&l.isError(o)&&s&&T(o,i)||c)&&x(o,i,"Got unwanted exception"+a),r&&o&&i&&!T(o,i)||!r&&o)throw o}d.AssertionError=function(r){this.name="AssertionError",this.actual=r.actual,this.expected=r.expected,this.operator=r.operator,r.message?(this.message=r.message,this.generatedMessage=!1):(this.message=v(y(this.actual),128)+" "+this.operator+" "+v(y(this.expected),128),this.generatedMessage=!0);var n=r.stackStartFunction||x;if(Error.captureStackTrace)Error.captureStackTrace(this,n);else{var i=Error();if(i.stack){var a=i.stack,o=g(n),s=a.indexOf("\n"+o);if(s>=0){var l=a.indexOf("\n",s+1);a=a.substring(l+1)}this.stack=a}}},l.inherits(d.AssertionError,Error),d.fail=x,d.ok=b,d.equal=function(r,n,i){r!=n&&x(r,n,i,"==",d.equal)},d.notEqual=function(r,n,i){r==n&&x(r,n,i,"!=",d.notEqual)},d.deepEqual=function(r,n,i){_(r,n,!1)||x(r,n,i,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(r,n,i){_(r,n,!0)||x(r,n,i,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(r,n,i){_(r,n,!1)&&x(r,n,i,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=function r(n,i,a){_(n,i,!0)&&x(n,i,a,"notDeepStrictEqual",r)},d.strictEqual=function(r,n,i){r!==n&&x(r,n,i,"===",d.strictEqual)},d.notStrictEqual=function(r,n,i){r===n&&x(r,n,i,"!==",d.notStrictEqual)},d.throws=function(r,n,i){k(!0,r,n,i)},d.doesNotThrow=function(r,n,i){k(!1,r,n,i)},d.ifError=function(r){if(r)throw r},d.strict=a(function r(n,i){n||x(n,!0,i,"==",r)},d,{equal:d.strictEqual,deepEqual:d.deepStrictEqual,notEqual:d.notStrictEqual,notDeepEqual:d.notDeepStrictEqual}),d.strict.strict=d.strict;var A=Object.keys||function(r){var n=[];for(var i in r)c.call(r,i)&&n.push(i);return n}}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"object-assign":247,"util/":78}],76:[function(r,n,i){"function"==typeof Object.create?n.exports=function(r,n){r.super_=n,r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(r,n){r.super_=n;var i=function(){};i.prototype=n.prototype,r.prototype=new i,r.prototype.constructor=r}},{}],77:[function(r,n,i){n.exports=function(r){return r&&"object"==typeof r&&"function"==typeof r.copy&&"function"==typeof r.fill&&"function"==typeof r.readUInt8}},{}],78:[function(r,n,a){(function(n,i){(function(){var o=/%[sdj%]/g;a.format=function(r){if(!x(r)){for(var n=[],i=0;i<arguments.length;i++)n.push(c(arguments[i]));return n.join(" ")}i=1;for(var a=arguments,s=a.length,l=String(r).replace(o,function(r){if("%%"===r)return"%";if(i>=s)return r;switch(r){case"%s":return String(a[i++]);case"%d":return Number(a[i++]);case"%j":try{return JSON.stringify(a[i++])}catch(r){return"[Circular]"}default:return r}}),u=a[i];i<s;u=a[++i])v(u)||!w(u)?l+=" "+u:l+=" "+c(u);return l},a.deprecate=function(r,o){if(b(i.process))return function(){return a.deprecate(r,o).apply(this,arguments)};if(!0===n.noDeprecation)return r;var s=!1;return function(){if(!s){if(n.throwDeprecation)throw Error(o);n.traceDeprecation?console.trace(o):console.error(o),s=!0}return r.apply(this,arguments)}};var s,l={};function c(r,n){var i={seen:[],stylize:f};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),g(n)?i.showHidden=n:n&&a._extend(i,n),b(i.showHidden)&&(i.showHidden=!1),b(i.depth)&&(i.depth=2),b(i.colors)&&(i.colors=!1),b(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=u),h(i,r,i.depth)}function u(r,n){var i=c.styles[n];return i?"\x1b["+c.colors[i][0]+"m"+r+"\x1b["+c.colors[i][1]+"m":r}function f(r,n){return r}function h(r,n,i){if(r.customInspect&&n&&A(n.inspect)&&n.inspect!==a.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o,s,l=n.inspect(i,r);return x(l)||(l=h(r,l,i)),l}var c=function(r,n){if(b(n))return r.stylize("undefined","undefined");if(x(n)){var i="'"+JSON.stringify(n).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(i,"string")}return y(n)?r.stylize(""+n,"number"):g(n)?r.stylize(""+n,"boolean"):v(n)?r.stylize("null","null"):void 0}(r,n);if(c)return c;var u=Object.keys(n),f=(M={},u.forEach(function(r,n){M[r]=!0}),M);if(r.showHidden&&(u=Object.getOwnPropertyNames(n)),k(n)&&(u.indexOf("message")>=0||u.indexOf("description")>=0))return p(n);if(0===u.length){if(A(n)){var w=n.name?": "+n.name:"";return r.stylize("[Function"+w+"]","special")}if(_(n))return r.stylize(RegExp.prototype.toString.call(n),"regexp");if(T(n))return r.stylize(Date.prototype.toString.call(n),"date");if(k(n))return p(n)}var M,S,E="",C=!1,P=["{","}"];return m(n)&&(C=!0,P=["[","]"]),A(n)&&(E=" [Function"+(n.name?": "+n.name:"")+"]"),_(n)&&(E=" "+RegExp.prototype.toString.call(n)),T(n)&&(E=" "+Date.prototype.toUTCString.call(n)),k(n)&&(E=" "+p(n)),0!==u.length||C&&0!=n.length?i<0?_(n)?r.stylize(RegExp.prototype.toString.call(n),"regexp"):r.stylize("[Object]","special"):(r.seen.push(n),S=C?function(r,n,i,a,o){for(var s=[],l=0,c=n.length;l<c;++l)L(n,String(l))?s.push(d(r,n,i,a,String(l),!0)):s.push("");return o.forEach(function(o){o.match(/^\d+$/)||s.push(d(r,n,i,a,o,!0))}),s}(r,n,i,f,u):u.map(function(a){return d(r,n,i,f,a,C)}),r.seen.pop(),o=E,s=P,S.reduce(function(r,n){return n.indexOf("\n"),r+n.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?s[0]+(""===o?"":o+"\n ")+" "+S.join(",\n  ")+" "+s[1]:s[0]+o+" "+S.join(", ")+" "+s[1]):P[0]+E+P[1]}function p(r){return"["+Error.prototype.toString.call(r)+"]"}function d(r,n,i,a,o,s){var l,c,u;if((u=Object.getOwnPropertyDescriptor(n,o)||{value:n[o]}).get?c=u.set?r.stylize("[Getter/Setter]","special"):r.stylize("[Getter]","special"):u.set&&(c=r.stylize("[Setter]","special")),L(a,o)||(l="["+o+"]"),c||(0>r.seen.indexOf(u.value)?(c=v(i)?h(r,u.value,null):h(r,u.value,i-1)).indexOf("\n")>-1&&(c=s?c.split("\n").map(function(r){return"  "+r}).join("\n").substr(2):"\n"+c.split("\n").map(function(r){return"   "+r}).join("\n")):c=r.stylize("[Circular]","special")),b(l)){if(s&&o.match(/^\d+$/))return c;(l=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=r.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=r.stylize(l,"string"))}return l+": "+c}function m(r){return Array.isArray(r)}function g(r){return"boolean"==typeof r}function v(r){return null===r}function y(r){return"number"==typeof r}function x(r){return"string"==typeof r}function b(r){return void 0===r}function _(r){return w(r)&&"[object RegExp]"===M(r)}function w(r){return"object"==typeof r&&null!==r}function T(r){return w(r)&&"[object Date]"===M(r)}function k(r){return w(r)&&("[object Error]"===M(r)||r instanceof Error)}function A(r){return"function"==typeof r}function M(r){return Object.prototype.toString.call(r)}function S(r){return r<10?"0"+r.toString(10):r.toString(10)}a.debuglog=function(r){if(b(s)&&(s=n.env.NODE_DEBUG||""),!l[r=r.toUpperCase()]){if(RegExp("\\b"+r+"\\b","i").test(s)){var i=n.pid;l[r]=function(){var n=a.format.apply(a,arguments);console.error("%s %d: %s",r,i,n)}}else l[r]=function(){}}return l[r]},a.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},a.isArray=m,a.isBoolean=g,a.isNull=v,a.isNullOrUndefined=function(r){return null==r},a.isNumber=y,a.isString=x,a.isSymbol=function(r){return"symbol"==typeof r},a.isUndefined=b,a.isRegExp=_,a.isObject=w,a.isDate=T,a.isError=k,a.isFunction=A,a.isPrimitive=function(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r},a.isBuffer=r("./support/isBuffer");var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function L(r,n){return Object.prototype.hasOwnProperty.call(r,n)}a.log=function(){var r,n;console.log("%s - %s",(n=[S((r=new Date).getHours()),S(r.getMinutes()),S(r.getSeconds())].join(":"),[r.getDate(),E[r.getMonth()],n].join(" ")),a.format.apply(a,arguments))},a.inherits=r("inherits"),a._extend=function(r,n){if(!n||!w(n))return r;for(var i=Object.keys(n),a=i.length;a--;)r[i[a]]=n[i[a]];return r}}).call(this)}).call(this,r("_process"),void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":77,_process:277,inherits:76}],79:[function(r,n,i){"use strict";i.byteLength=function(r){var n=f(r),i=n[0],a=n[1];return 3*(i+a)/4-a},i.toByteArray=function(r){var n,i,a=f(r),l=a[0],c=a[1],u=new s(3*(l+c)/4-c),h=0,p=c>0?l-4:l;for(i=0;i<p;i+=4)n=o[r.charCodeAt(i)]<<18|o[r.charCodeAt(i+1)]<<12|o[r.charCodeAt(i+2)]<<6|o[r.charCodeAt(i+3)],u[h++]=n>>16&255,u[h++]=n>>8&255,u[h++]=255&n;return 2===c&&(n=o[r.charCodeAt(i)]<<2|o[r.charCodeAt(i+1)]>>4,u[h++]=255&n),1===c&&(n=o[r.charCodeAt(i)]<<10|o[r.charCodeAt(i+1)]<<4|o[r.charCodeAt(i+2)]>>2,u[h++]=n>>8&255,u[h++]=255&n),u},i.fromByteArray=function(r){for(var n,i=r.length,o=i%3,s=[],l=0,c=i-o;l<c;l+=16383)s.push(function(r,n,i){for(var o,s=[],l=n;l<i;l+=3)s.push(a[(o=(r[l]<<16&16711680)+(r[l+1]<<8&65280)+(255&r[l+2]))>>18&63]+a[o>>12&63]+a[o>>6&63]+a[63&o]);return s.join("")}(r,l,l+16383>c?c:l+16383));return 1===o?s.push(a[(n=r[i-1])>>2]+a[n<<4&63]+"=="):2===o&&s.push(a[(n=(r[i-2]<<8)+r[i-1])>>10]+a[n>>4&63]+a[n<<2&63]+"="),s.join("")};for(var a=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=l.length;c<u;++c)a[c]=l[c],o[l.charCodeAt(c)]=c;function f(r){var n=r.length;if(n%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=r.indexOf("=");return -1===i&&(i=n),[i,i===n?0:4-i%4]}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],80:[function(r,n,i){"use strict";function a(r,n,i,a,o){for(var s=o+1;a<=o;){var l=a+o>>>1,c=r[l];(void 0!==i?i(c,n):c-n)>=0?(s=l,o=l-1):a=l+1}return s}function o(r,n,i,a,o){for(var s=o+1;a<=o;){var l=a+o>>>1,c=r[l];(void 0!==i?i(c,n):c-n)>0?(s=l,o=l-1):a=l+1}return s}function s(r,n,i,a,o){for(var s=a-1;a<=o;){var l=a+o>>>1,c=r[l];(void 0!==i?i(c,n):c-n)<0?(s=l,a=l+1):o=l-1}return s}function l(r,n,i,a,o){for(var s=a-1;a<=o;){var l=a+o>>>1,c=r[l];(void 0!==i?i(c,n):c-n)<=0?(s=l,a=l+1):o=l-1}return s}function c(r,n,i,a,o){for(;a<=o;){var s=a+o>>>1,l=r[s],c=void 0!==i?i(l,n):l-n;if(0===c)return s;c<=0?a=s+1:o=s-1}return -1}function u(r,n,i,a,o,s){return"function"==typeof i?s(r,n,i,void 0===a?0:0|a,void 0===o?r.length-1:0|o):s(r,n,void 0,void 0===i?0:0|i,void 0===a?r.length-1:0|a)}n.exports={ge:function(r,n,i,o,s){return u(r,n,i,o,s,a)},gt:function(r,n,i,a,s){return u(r,n,i,a,s,o)},lt:function(r,n,i,a,o){return u(r,n,i,a,o,s)},le:function(r,n,i,a,o){return u(r,n,i,a,o,l)},eq:function(r,n,i,a,o){return u(r,n,i,a,o,c)}}},{}],81:[function(r,n,i){"use strict";function a(r){var n=32;return(r&=-r)&&n--,65535&r&&(n-=16),16711935&r&&(n-=8),252645135&r&&(n-=4),858993459&r&&(n-=2),1431655765&r&&(n-=1),n}i.INT_BITS=32,i.INT_MAX=2147483647,i.INT_MIN=-2147483648,i.sign=function(r){return(r>0)-(r<0)},i.abs=function(r){var n=r>>31;return(r^n)-n},i.min=function(r,n){return n^(r^n)&-(r<n)},i.max=function(r,n){return r^(r^n)&-(r<n)},i.isPow2=function(r){return!(r&r-1||!r)},i.log2=function(r){var n,i;return n=(r>65535)<<4,n|=i=((r>>>=n)>255)<<3,n|=i=((r>>>=i)>15)<<2,(n|=i=((r>>>=i)>3)<<1)|(r>>>=i)>>1},i.log10=function(r){return r>=1e9?9:r>=1e8?8:r>=1e7?7:r>=1e6?6:r>=1e5?5:r>=1e4?4:r>=1e3?3:r>=100?2:r>=10?1:0},i.popCount=function(r){return 16843009*((r=(858993459&(r-=r>>>1&1431655765))+(r>>>2&858993459))+(r>>>4)&252645135)>>>24},i.countTrailingZeros=a,i.nextPow2=function(r){return r+=0===r,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,(r|=r>>>16)+1},i.prevPow2=function(r){return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,(r|=r>>>16)-(r>>>1)},i.parity=function(r){return r^=r>>>16,r^=r>>>8,r^=r>>>4,27030>>>(r&=15)&1};var o=Array(256);(function(r){for(var n=0;n<256;++n){var i=n,a=n,o=7;for(i>>>=1;i;i>>>=1)a<<=1,a|=1&i,--o;r[n]=a<<o&255}})(o),i.reverse=function(r){return o[255&r]<<24|o[r>>>8&255]<<16|o[r>>>16&255]<<8|o[r>>>24&255]},i.interleave2=function(r,n){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r&=65535)|r<<8))|r<<4))|r<<2))|r<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n&=65535)|n<<8))|n<<4))|n<<2))|n<<1))<<1},i.deinterleave2=function(r,n){return(r=65535&((r=16711935&((r=252645135&((r=858993459&((r=r>>>n&1431655765)|r>>>1))|r>>>2))|r>>>4))|r>>>16))<<16>>16},i.interleave3=function(r,n,i){return(r=1227133513&((r=3272356035&((r=251719695&((r=4278190335&((r&=1023)|r<<16))|r<<8))|r<<4))|r<<2)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<1)|(i=1227133513&((i=3272356035&((i=251719695&((i=4278190335&((i&=1023)|i<<16))|i<<8))|i<<4))|i<<2))<<2},i.deinterleave3=function(r,n){return(r=1023&((r=4278190335&((r=251719695&((r=3272356035&((r=r>>>n&1227133513)|r>>>2))|r>>>4))|r>>>8))|r>>>16))<<22>>22},i.nextCombination=function(r){var n=r|r-1;return n+1|(~n&-~n)-1>>>a(r)+1}},{}],82:[function(r,n,i){"use strict";var a=r("clamp");n.exports=function(r,n){n||(n={});var i,l,c,u,f,h,p,d,m,g,v,y=null==n.cutoff?.25:n.cutoff,x=null==n.radius?8:n.radius,b=n.channel||0;if(ArrayBuffer.isView(r)||Array.isArray(r)){if(!n.width||!n.height)throw Error("For raw data width and height should be provided by options");i=n.width,l=n.height,u=r,h=n.stride?n.stride:Math.floor(r.length/i/l)}else window.HTMLCanvasElement&&r instanceof window.HTMLCanvasElement?(p=(d=r).getContext("2d"),i=d.width,l=d.height,u=(m=p.getImageData(0,0,i,l)).data,h=4):window.CanvasRenderingContext2D&&r instanceof window.CanvasRenderingContext2D?(d=r.canvas,p=r,i=d.width,l=d.height,u=(m=p.getImageData(0,0,i,l)).data,h=4):window.ImageData&&r instanceof window.ImageData&&(m=r,i=r.width,l=r.height,u=m.data,h=4);if(c=Math.max(i,l),window.Uint8ClampedArray&&u instanceof window.Uint8ClampedArray||window.Uint8Array&&u instanceof window.Uint8Array)for(f=u,u=Array(i*l),g=0,v=f.length;g<v;g++)u[g]=f[g*h+b]/255;else if(1!==h)throw Error("Raw data can have only 1 value per pixel");var _=Array(i*l),w=Array(i*l),T=Array(c),k=Array(c),A=Array(c+1),M=Array(c);for(g=0,v=i*l;g<v;g++){var S=u[g];_[g]=1===S?0:0===S?o:Math.pow(Math.max(0,.5-S),2),w[g]=1===S?o:0===S?0:Math.pow(Math.max(0,S-.5),2)}s(_,i,l,T,k,M,A),s(w,i,l,T,k,M,A);var E=window.Float32Array?new Float32Array(i*l):Array(i*l);for(g=0,v=i*l;g<v;g++)E[g]=a(1-((_[g]-w[g])/x+y),0,1);return E};var o=1e20;function s(r,n,i,a,o,s,c){for(var u=0;u<n;u++){for(var f=0;f<i;f++)a[f]=r[f*n+u];for(l(a,o,s,c,i),f=0;f<i;f++)r[f*n+u]=o[f]}for(f=0;f<i;f++){for(u=0;u<n;u++)a[u]=r[f*n+u];for(l(a,o,s,c,n),u=0;u<n;u++)r[f*n+u]=Math.sqrt(o[u])}}function l(r,n,i,a,s){i[0]=0,a[0]=-o,a[1]=+o;for(var l=1,c=0;l<s;l++){for(var u=(r[l]+l*l-(r[i[c]]+i[c]*i[c]))/(2*l-2*i[c]);u<=a[c];)c--,u=(r[l]+l*l-(r[i[c]]+i[c]*i[c]))/(2*l-2*i[c]);i[++c]=l,a[c]=u,a[c+1]=+o}for(l=0,c=0;l<s;l++){for(;a[c+1]<l;)c++;n[l]=(l-i[c])*(l-i[c])+r[i[c]]}}},{clamp:86}],83:[function(r,n,i){},{}],84:[function(r,n,i){"use strict";var a,o="object"==typeof Reflect?Reflect:null,s=o&&"function"==typeof o.apply?o.apply:function(r,n,i){return Function.prototype.apply.call(r,n,i)};a=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:function(r){return Object.getOwnPropertyNames(r)};var l=Number.isNaN||function(r){return r!=r};function c(){c.init.call(this)}n.exports=c,n.exports.once=function(r,n){return new Promise(function(i,a){var o;function s(){void 0!==o&&r.removeListener("error",o),i([].slice.call(arguments))}"error"!==n&&(o=function(i){r.removeListener(n,s),a(i)},r.once("error",o)),r.once(n,s)})},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var u=10;function f(r){if("function"!=typeof r)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}function h(r){return void 0===r._maxListeners?c.defaultMaxListeners:r._maxListeners}function p(r,n,i,a){var o,s,l;if(f(i),void 0===(s=r._events)?(s=r._events=Object.create(null),r._eventsCount=0):(void 0!==s.newListener&&(r.emit("newListener",n,i.listener?i.listener:i),s=r._events),l=s[n]),void 0===l)l=s[n]=i,++r._eventsCount;else if("function"==typeof l?l=s[n]=a?[i,l]:[l,i]:a?l.unshift(i):l.push(i),(o=h(r))>0&&l.length>o&&!l.warned){l.warned=!0;var c=Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(n)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=r,c.type=n,c.count=l.length,console&&console.warn&&console.warn(c)}return r}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(r,n,i){var a={fired:!1,wrapFn:void 0,target:r,type:n,listener:i},o=d.bind(a);return o.listener=i,a.wrapFn=o,o}function g(r,n,i){var a=r._events;if(void 0===a)return[];var o=a[n];return void 0===o?[]:"function"==typeof o?i?[o.listener||o]:[o]:i?function(r){for(var n=Array(r.length),i=0;i<n.length;++i)n[i]=r[i].listener||r[i];return n}(o):y(o,o.length)}function v(r){var n=this._events;if(void 0!==n){var i=n[r];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function y(r,n){for(var i=Array(n),a=0;a<n;++a)i[a]=r[a];return i}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(r){if("number"!=typeof r||r<0||l(r))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");u=r}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(r){if("number"!=typeof r||r<0||l(r))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this},c.prototype.getMaxListeners=function(){return h(this)},c.prototype.emit=function(r){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var a="error"===r,o=this._events;if(void 0!==o)a=a&&void 0===o.error;else if(!a)return!1;if(a){if(n.length>0&&(l=n[0]),l instanceof Error)throw l;var l,c=Error("Unhandled error."+(l?" ("+l.message+")":""));throw c.context=l,c}var u=o[r];if(void 0===u)return!1;if("function"==typeof u)s(u,this,n);else{var f=u.length,h=y(u,f);for(i=0;i<f;++i)s(h[i],this,n)}return!0},c.prototype.addListener=function(r,n){return p(this,r,n,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(r,n){return p(this,r,n,!0)},c.prototype.once=function(r,n){return f(n),this.on(r,m(this,r,n)),this},c.prototype.prependOnceListener=function(r,n){return f(n),this.prependListener(r,m(this,r,n)),this},c.prototype.removeListener=function(r,n){var i,a,o,s,l;if(f(n),void 0===(a=this._events)||void 0===(i=a[r]))return this;if(i===n||i.listener===n)0==--this._eventsCount?this._events=Object.create(null):(delete a[r],a.removeListener&&this.emit("removeListener",r,i.listener||n));else if("function"!=typeof i){for(o=-1,s=i.length-1;s>=0;s--)if(i[s]===n||i[s].listener===n){l=i[s].listener,o=s;break}if(o<0)return this;0===o?i.shift():function(r,n){for(;n+1<r.length;n++)r[n]=r[n+1];r.pop()}(i,o),1===i.length&&(a[r]=i[0]),void 0!==a.removeListener&&this.emit("removeListener",r,l||n)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(r){var n,i,a;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[r]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[r]),this;if(0==arguments.length){var o,s=Object.keys(i);for(a=0;a<s.length;++a)"removeListener"!==(o=s[a])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(n=i[r]))this.removeListener(r,n);else if(void 0!==n)for(a=n.length-1;a>=0;a--)this.removeListener(r,n[a]);return this},c.prototype.listeners=function(r){return g(this,r,!0)},c.prototype.rawListeners=function(r){return g(this,r,!1)},c.listenerCount=function(r,n){return"function"==typeof r.listenerCount?r.listenerCount(n):v.call(r,n)},c.prototype.listenerCount=v,c.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]}},{}],85:[function(r,n,i){(function(n){(function(){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */"use strict";var n=r("base64-js"),a=r("ieee754");function o(r){if(r>2147483647)throw RangeError('The value "'+r+'" is invalid for option "size"');var n=new Uint8Array(r);return n.__proto__=s.prototype,n}function s(r,n,i){if("number"==typeof r){if("string"==typeof n)throw TypeError('The "string" argument must be of type string. Received type number');return u(r)}return l(r,n,i)}function l(r,n,i){if("string"==typeof r)return function(r,n){if("string"==typeof n&&""!==n||(n="utf8"),!s.isEncoding(n))throw TypeError("Unknown encoding: "+n);var i=0|p(r,n),a=o(i),l=a.write(r,n);return l!==i&&(a=a.slice(0,l)),a}(r,n);if(ArrayBuffer.isView(r))return f(r);if(null==r)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(E(r,ArrayBuffer)||r&&E(r.buffer,ArrayBuffer))return function(r,n,i){var a;if(n<0||r.byteLength<n)throw RangeError('"offset" is outside of buffer bounds');if(r.byteLength<n+(i||0))throw RangeError('"length" is outside of buffer bounds');return(a=void 0===n&&void 0===i?new Uint8Array(r):void 0===i?new Uint8Array(r,n):new Uint8Array(r,n,i)).__proto__=s.prototype,a}(r,n,i);if("number"==typeof r)throw TypeError('The "value" argument must not be of type number. Received type number');var a=r.valueOf&&r.valueOf();if(null!=a&&a!==r)return s.from(a,n,i);var l=function(r){if(s.isBuffer(r)){var n,i=0|h(r.length),a=o(i);return 0===a.length||r.copy(a,0,0,i),a}return void 0!==r.length?"number"!=typeof r.length||(n=r.length)!=n?o(0):f(r):"Buffer"===r.type&&Array.isArray(r.data)?f(r.data):void 0}(r);if(l)return l;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof r[Symbol.toPrimitive])return s.from(r[Symbol.toPrimitive]("string"),n,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}function c(r){if("number"!=typeof r)throw TypeError('"size" argument must be of type number');if(r<0)throw RangeError('The value "'+r+'" is invalid for option "size"')}function u(r){return c(r),o(r<0?0:0|h(r))}function f(r){for(var n=r.length<0?0:0|h(r.length),i=o(n),a=0;a<n;a+=1)i[a]=255&r[a];return i}function h(r){if(r>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|r}function p(r,n){if(s.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||E(r,ArrayBuffer))return r.byteLength;if("string"!=typeof r)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);var i=r.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===i)return 0;for(var o=!1;;)switch(n){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return A(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return M(r).length;default:if(o)return a?-1:A(r).length;n=(""+n).toLowerCase(),o=!0}}function d(r,i,a){var o,s,l=!1;if((void 0===i||i<0)&&(i=0),i>this.length||((void 0===a||a>this.length)&&(a=this.length),a<=0)||(a>>>=0)<=(i>>>=0))return"";for(r||(r="utf8");;)switch(r){case"hex":return function(r,n,i){var a,o=r.length;(!n||n<0)&&(n=0),(!i||i<0||i>o)&&(i=o);for(var s="",l=n;l<i;++l)s+=(a=r[l])<16?"0"+a.toString(16):a.toString(16);return s}(this,i,a);case"utf8":case"utf-8":return y(this,i,a);case"ascii":return function(r,n,i){var a="";i=Math.min(r.length,i);for(var o=n;o<i;++o)a+=String.fromCharCode(127&r[o]);return a}(this,i,a);case"latin1":case"binary":return function(r,n,i){var a="";i=Math.min(r.length,i);for(var o=n;o<i;++o)a+=String.fromCharCode(r[o]);return a}(this,i,a);case"base64":return o=i,s=a,0===o&&s===this.length?n.fromByteArray(this):n.fromByteArray(this.slice(o,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(r,n,i){for(var a=r.slice(n,i),o="",s=0;s<a.length;s+=2)o+=String.fromCharCode(a[s]+256*a[s+1]);return o}(this,i,a);default:if(l)throw TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),l=!0}}function m(r,n,i){var a=r[n];r[n]=r[i],r[i]=a}function g(r,n,i,a,o){var l;if(0===r.length)return -1;if("string"==typeof i?(a=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),(l=i=+i)!=l&&(i=o?0:r.length-1),i<0&&(i=r.length+i),i>=r.length){if(o)return -1;i=r.length-1}else if(i<0){if(!o)return -1;i=0}if("string"==typeof n&&(n=s.from(n,a)),s.isBuffer(n))return 0===n.length?-1:v(r,n,i,a,o);if("number"==typeof n)return n&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(r,n,i):Uint8Array.prototype.lastIndexOf.call(r,n,i):v(r,[n],i,a,o);throw TypeError("val must be string, number or Buffer")}function v(r,n,i,a,o){var s,l=1,c=r.length,u=n.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(r.length<2||n.length<2)return -1;l=2,c/=2,u/=2,i/=2}function f(r,n){return 1===l?r[n]:r.readUInt16BE(n*l)}if(o){var h=-1;for(s=i;s<c;s++)if(f(r,s)===f(n,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===u)return h*l}else -1!==h&&(s-=s-h),h=-1}else for(i+u>c&&(i=c-u),s=i;s>=0;s--){for(var p=!0,d=0;d<u;d++)if(f(r,s+d)!==f(n,d)){p=!1;break}if(p)return s}return -1}function y(r,n,i){i=Math.min(r.length,i);for(var a=[],o=n;o<i;){var s,l,c,u,f=r[o],h=null,p=f>239?4:f>223?3:f>191?2:1;if(o+p<=i)switch(p){case 1:f<128&&(h=f);break;case 2:128==(192&(s=r[o+1]))&&(u=(31&f)<<6|63&s)>127&&(h=u);break;case 3:s=r[o+1],l=r[o+2],128==(192&s)&&128==(192&l)&&(u=(15&f)<<12|(63&s)<<6|63&l)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:s=r[o+1],l=r[o+2],c=r[o+3],128==(192&s)&&128==(192&l)&&128==(192&c)&&(u=(15&f)<<18|(63&s)<<12|(63&l)<<6|63&c)>65535&&u<1114112&&(h=u)}null===h?(h=65533,p=1):h>65535&&(h-=65536,a.push(h>>>10&1023|55296),h=56320|1023&h),a.push(h),o+=p}return function(r){var n=r.length;if(n<=4096)return String.fromCharCode.apply(String,r);for(var i="",a=0;a<n;)i+=String.fromCharCode.apply(String,r.slice(a,a+=4096));return i}(a)}function x(r,n,i){if(r%1!=0||r<0)throw RangeError("offset is not uint");if(r+n>i)throw RangeError("Trying to access beyond buffer length")}function b(r,n,i,a,o,l){if(!s.isBuffer(r))throw TypeError('"buffer" argument must be a Buffer instance');if(n>o||n<l)throw RangeError('"value" argument is out of bounds');if(i+a>r.length)throw RangeError("Index out of range")}function _(r,n,i,a,o,s){if(i+a>r.length||i<0)throw RangeError("Index out of range")}function w(r,n,i,o,s){return n=+n,i>>>=0,s||_(r,0,i,4),a.write(r,n,i,o,23,4),i+4}function T(r,n,i,o,s){return n=+n,i>>>=0,s||_(r,0,i,8),a.write(r,n,i,o,52,8),i+8}i.Buffer=s,i.SlowBuffer=function(r){return+r!=r&&(r=0),s.alloc(+r)},i.INSPECT_MAX_BYTES=50,i.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===r.foo()}catch(r){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(r,n,i){return l(r,n,i)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(r,n,i){return c(r),r<=0?o(r):void 0!==n?"string"==typeof i?o(r).fill(n,i):o(r).fill(n):o(r)},s.allocUnsafe=function(r){return u(r)},s.allocUnsafeSlow=function(r){return u(r)},s.isBuffer=function(r){return null!=r&&!0===r._isBuffer&&r!==s.prototype},s.compare=function(r,n){if(E(r,Uint8Array)&&(r=s.from(r,r.offset,r.byteLength)),E(n,Uint8Array)&&(n=s.from(n,n.offset,n.byteLength)),!s.isBuffer(r)||!s.isBuffer(n))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===n)return 0;for(var i=r.length,a=n.length,o=0,l=Math.min(i,a);o<l;++o)if(r[o]!==n[o]){i=r[o],a=n[o];break}return i<a?-1:a<i?1:0},s.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(r,n){if(!Array.isArray(r))throw TypeError('"list" argument must be an Array of Buffers');if(0===r.length)return s.alloc(0);if(void 0===n)for(n=0,i=0;i<r.length;++i)n+=r[i].length;var i,a=s.allocUnsafe(n),o=0;for(i=0;i<r.length;++i){var l=r[i];if(E(l,Uint8Array)&&(l=s.from(l)),!s.isBuffer(l))throw TypeError('"list" argument must be an Array of Buffers');l.copy(a,o),o+=l.length}return a},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var r=this.length;if(r%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<r;n+=2)m(this,n,n+1);return this},s.prototype.swap32=function(){var r=this.length;if(r%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<r;n+=4)m(this,n,n+3),m(this,n+1,n+2);return this},s.prototype.swap64=function(){var r=this.length;if(r%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<r;n+=8)m(this,n,n+7),m(this,n+1,n+6),m(this,n+2,n+5),m(this,n+3,n+4);return this},s.prototype.toString=function(){var r=this.length;return 0===r?"":0==arguments.length?y(this,0,r):d.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(r){if(!s.isBuffer(r))throw TypeError("Argument must be a Buffer");return this===r||0===s.compare(this,r)},s.prototype.inspect=function(){var r="",n=i.INSPECT_MAX_BYTES;return r=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(r+=" ... "),"<Buffer "+r+">"},s.prototype.compare=function(r,n,i,a,o){if(E(r,Uint8Array)&&(r=s.from(r,r.offset,r.byteLength)),!s.isBuffer(r))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(void 0===n&&(n=0),void 0===i&&(i=r?r.length:0),void 0===a&&(a=0),void 0===o&&(o=this.length),n<0||i>r.length||a<0||o>this.length)throw RangeError("out of range index");if(a>=o&&n>=i)return 0;if(a>=o)return -1;if(n>=i)return 1;if(this===r)return 0;for(var l=(o>>>=0)-(a>>>=0),c=(i>>>=0)-(n>>>=0),u=Math.min(l,c),f=this.slice(a,o),h=r.slice(n,i),p=0;p<u;++p)if(f[p]!==h[p]){l=f[p],c=h[p];break}return l<c?-1:c<l?1:0},s.prototype.includes=function(r,n,i){return -1!==this.indexOf(r,n,i)},s.prototype.indexOf=function(r,n,i){return g(this,r,n,i,!0)},s.prototype.lastIndexOf=function(r,n,i){return g(this,r,n,i,!1)},s.prototype.write=function(r,n,i,a){if(void 0===n)a="utf8",i=this.length,n=0;else if(void 0===i&&"string"==typeof n)a=n,i=this.length,n=0;else{if(!isFinite(n))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n>>>=0,isFinite(i)?(i>>>=0,void 0===a&&(a="utf8")):(a=i,i=void 0)}var o,s,l,c,u,f,h,p,d,m,g=this.length-n;if((void 0===i||i>g)&&(i=g),r.length>0&&(i<0||n<0)||n>this.length)throw RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var v=!1;;)switch(a){case"hex":return function(r,n,i,a){i=Number(i)||0;var o=r.length-i;a?(a=Number(a))>o&&(a=o):a=o;var s=n.length;a>s/2&&(a=s/2);for(var l=0;l<a;++l){var c=parseInt(n.substr(2*l,2),16);if(c!=c)break;r[i+l]=c}return l}(this,r,n,i);case"utf8":case"utf-8":return u=n,f=i,S(A(r,this.length-u),this,u,f);case"ascii":case"latin1":case"binary":return o=this,s=r,l=n,c=i,S(function(r){for(var n=[],i=0;i<r.length;++i)n.push(255&r.charCodeAt(i));return n}(s),o,l,c);case"base64":return h=n,p=i,S(M(r),this,h,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d=n,m=i,S(function(r,n){for(var i,a,o=[],s=0;s<r.length&&!((n-=2)<0);++s)a=(i=r.charCodeAt(s))>>8,o.push(i%256),o.push(a);return o}(r,this.length-d),this,d,m);default:if(v)throw TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),v=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(r,n){var i=this.length;(r=~~r)<0?(r+=i)<0&&(r=0):r>i&&(r=i),(n=void 0===n?i:~~n)<0?(n+=i)<0&&(n=0):n>i&&(n=i),n<r&&(n=r);var a=this.subarray(r,n);return a.__proto__=s.prototype,a},s.prototype.readUIntLE=function(r,n,i){r>>>=0,n>>>=0,i||x(r,n,this.length);for(var a=this[r],o=1,s=0;++s<n&&(o*=256);)a+=this[r+s]*o;return a},s.prototype.readUIntBE=function(r,n,i){r>>>=0,n>>>=0,i||x(r,n,this.length);for(var a=this[r+--n],o=1;n>0&&(o*=256);)a+=this[r+--n]*o;return a},s.prototype.readUInt8=function(r,n){return r>>>=0,n||x(r,1,this.length),this[r]},s.prototype.readUInt16LE=function(r,n){return r>>>=0,n||x(r,2,this.length),this[r]|this[r+1]<<8},s.prototype.readUInt16BE=function(r,n){return r>>>=0,n||x(r,2,this.length),this[r]<<8|this[r+1]},s.prototype.readUInt32LE=function(r,n){return r>>>=0,n||x(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+16777216*this[r+3]},s.prototype.readUInt32BE=function(r,n){return r>>>=0,n||x(r,4,this.length),16777216*this[r]+(this[r+1]<<16|this[r+2]<<8|this[r+3])},s.prototype.readIntLE=function(r,n,i){r>>>=0,n>>>=0,i||x(r,n,this.length);for(var a=this[r],o=1,s=0;++s<n&&(o*=256);)a+=this[r+s]*o;return a>=(o*=128)&&(a-=Math.pow(2,8*n)),a},s.prototype.readIntBE=function(r,n,i){r>>>=0,n>>>=0,i||x(r,n,this.length);for(var a=n,o=1,s=this[r+--a];a>0&&(o*=256);)s+=this[r+--a]*o;return s>=(o*=128)&&(s-=Math.pow(2,8*n)),s},s.prototype.readInt8=function(r,n){return r>>>=0,n||x(r,1,this.length),128&this[r]?-1*(255-this[r]+1):this[r]},s.prototype.readInt16LE=function(r,n){r>>>=0,n||x(r,2,this.length);var i=this[r]|this[r+1]<<8;return 32768&i?4294901760|i:i},s.prototype.readInt16BE=function(r,n){r>>>=0,n||x(r,2,this.length);var i=this[r+1]|this[r]<<8;return 32768&i?4294901760|i:i},s.prototype.readInt32LE=function(r,n){return r>>>=0,n||x(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},s.prototype.readInt32BE=function(r,n){return r>>>=0,n||x(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},s.prototype.readFloatLE=function(r,n){return r>>>=0,n||x(r,4,this.length),a.read(this,r,!0,23,4)},s.prototype.readFloatBE=function(r,n){return r>>>=0,n||x(r,4,this.length),a.read(this,r,!1,23,4)},s.prototype.readDoubleLE=function(r,n){return r>>>=0,n||x(r,8,this.length),a.read(this,r,!0,52,8)},s.prototype.readDoubleBE=function(r,n){return r>>>=0,n||x(r,8,this.length),a.read(this,r,!1,52,8)},s.prototype.writeUIntLE=function(r,n,i,a){r=+r,n>>>=0,i>>>=0,a||b(this,r,n,i,Math.pow(2,8*i)-1,0);var o=1,s=0;for(this[n]=255&r;++s<i&&(o*=256);)this[n+s]=r/o&255;return n+i},s.prototype.writeUIntBE=function(r,n,i,a){r=+r,n>>>=0,i>>>=0,a||b(this,r,n,i,Math.pow(2,8*i)-1,0);var o=i-1,s=1;for(this[n+o]=255&r;--o>=0&&(s*=256);)this[n+o]=r/s&255;return n+i},s.prototype.writeUInt8=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,1,255,0),this[n]=255&r,n+1},s.prototype.writeUInt16LE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,2,65535,0),this[n]=255&r,this[n+1]=r>>>8,n+2},s.prototype.writeUInt16BE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,2,65535,0),this[n]=r>>>8,this[n+1]=255&r,n+2},s.prototype.writeUInt32LE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,4,4294967295,0),this[n+3]=r>>>24,this[n+2]=r>>>16,this[n+1]=r>>>8,this[n]=255&r,n+4},s.prototype.writeUInt32BE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,4,4294967295,0),this[n]=r>>>24,this[n+1]=r>>>16,this[n+2]=r>>>8,this[n+3]=255&r,n+4},s.prototype.writeIntLE=function(r,n,i,a){if(r=+r,n>>>=0,!a){var o=Math.pow(2,8*i-1);b(this,r,n,i,o-1,-o)}var s=0,l=1,c=0;for(this[n]=255&r;++s<i&&(l*=256);)r<0&&0===c&&0!==this[n+s-1]&&(c=1),this[n+s]=(r/l>>0)-c&255;return n+i},s.prototype.writeIntBE=function(r,n,i,a){if(r=+r,n>>>=0,!a){var o=Math.pow(2,8*i-1);b(this,r,n,i,o-1,-o)}var s=i-1,l=1,c=0;for(this[n+s]=255&r;--s>=0&&(l*=256);)r<0&&0===c&&0!==this[n+s+1]&&(c=1),this[n+s]=(r/l>>0)-c&255;return n+i},s.prototype.writeInt8=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,1,127,-128),r<0&&(r=255+r+1),this[n]=255&r,n+1},s.prototype.writeInt16LE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,2,32767,-32768),this[n]=255&r,this[n+1]=r>>>8,n+2},s.prototype.writeInt16BE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,2,32767,-32768),this[n]=r>>>8,this[n+1]=255&r,n+2},s.prototype.writeInt32LE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,4,2147483647,-2147483648),this[n]=255&r,this[n+1]=r>>>8,this[n+2]=r>>>16,this[n+3]=r>>>24,n+4},s.prototype.writeInt32BE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[n]=r>>>24,this[n+1]=r>>>16,this[n+2]=r>>>8,this[n+3]=255&r,n+4},s.prototype.writeFloatLE=function(r,n,i){return w(this,r,n,!0,i)},s.prototype.writeFloatBE=function(r,n,i){return w(this,r,n,!1,i)},s.prototype.writeDoubleLE=function(r,n,i){return T(this,r,n,!0,i)},s.prototype.writeDoubleBE=function(r,n,i){return T(this,r,n,!1,i)},s.prototype.copy=function(r,n,i,a){if(!s.isBuffer(r))throw TypeError("argument should be a Buffer");if(i||(i=0),a||0===a||(a=this.length),n>=r.length&&(n=r.length),n||(n=0),a>0&&a<i&&(a=i),a===i||0===r.length||0===this.length)return 0;if(n<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(a<0)throw RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),r.length-n<a-i&&(a=r.length-n+i);var o=a-i;if(this===r&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(n,i,a);else if(this===r&&i<n&&n<a)for(var l=o-1;l>=0;--l)r[l+n]=this[l+i];else Uint8Array.prototype.set.call(r,this.subarray(i,a),n);return o},s.prototype.fill=function(r,n,i,a){if("string"==typeof r){if("string"==typeof n?(a=n,n=0,i=this.length):"string"==typeof i&&(a=i,i=this.length),void 0!==a&&"string"!=typeof a)throw TypeError("encoding must be a string");if("string"==typeof a&&!s.isEncoding(a))throw TypeError("Unknown encoding: "+a);if(1===r.length){var o,l=r.charCodeAt(0);("utf8"===a&&l<128||"latin1"===a)&&(r=l)}}else"number"==typeof r&&(r&=255);if(n<0||this.length<n||this.length<i)throw RangeError("Out of range index");if(i<=n)return this;if(n>>>=0,i=void 0===i?this.length:i>>>0,r||(r=0),"number"==typeof r)for(o=n;o<i;++o)this[o]=r;else{var c=s.isBuffer(r)?r:s.from(r,a),u=c.length;if(0===u)throw TypeError('The value "'+r+'" is invalid for argument "value"');for(o=0;o<i-n;++o)this[o+n]=c[o%u]}return this};var k=/[^+/0-9A-Za-z-_]/g;function A(r,n){var i;n=n||1/0;for(var a=r.length,o=null,s=[],l=0;l<a;++l){if((i=r.charCodeAt(l))>55295&&i<57344){if(!o){if(i>56319||l+1===a){(n-=3)>-1&&s.push(239,191,189);continue}o=i;continue}if(i<56320){(n-=3)>-1&&s.push(239,191,189),o=i;continue}i=65536+(o-55296<<10|i-56320)}else o&&(n-=3)>-1&&s.push(239,191,189);if(o=null,i<128){if((n-=1)<0)break;s.push(i)}else if(i<2048){if((n-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((n-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw Error("Invalid code point");if((n-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function M(r){return n.toByteArray(function(r){if((r=(r=r.split("=")[0]).trim().replace(k,"")).length<2)return"";for(;r.length%4!=0;)r+="=";return r}(r))}function S(r,n,i,a){for(var o=0;o<a&&!(o+i>=n.length||o>=r.length);++o)n[o+i]=r[o];return o}function E(r,n){return r instanceof n||null!=r&&null!=r.constructor&&null!=r.constructor.name&&r.constructor.name===n.name}}).call(this)}).call(this,r("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(r,n,i){n.exports=function(r,n,i){return n<i?r<n?n:r>i?i:r:r<i?i:r>n?n:r}},{}],87:[function(r,n,i){"use strict";var a=r("clamp");function o(r,n){null==n&&(n=!0);var i=r[0],o=r[1],s=r[2],l=r[3];return null==l&&(l=n?1:255),n&&(i*=255,o*=255,s*=255,l*=255),16777216*(i=255&a(i,0,255))+((o=255&a(o,0,255))<<16)+((s=255&a(s,0,255))<<8)+(l=255&a(l,0,255))}n.exports=o,n.exports.to=o,n.exports.from=function(r,n){var i=(r=+r)>>>24,a=(16711680&r)>>>16,o=(65280&r)>>>8,s=255&r;return!1===n?[i,a,o,s]:[i/255,a/255,o/255,s/255]}},{clamp:86}],88:[function(r,n,i){"use strict";n.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(r,n,i){"use strict";var a=r("color-rgba"),o=r("clamp"),s=r("dtype");n.exports=function(r,n){"float"!==n&&n||(n="array"),"uint"===n&&(n="uint8"),"uint_clamped"===n&&(n="uint8_clamped");var i,l=new(s(n))(4),c="uint8"!==n&&"uint8_clamped"!==n;return r.length&&"string"!=typeof r||((r=a(r))[0]/=255,r[1]/=255,r[2]/=255),(i=r)instanceof Uint8Array||i instanceof Uint8ClampedArray||Array.isArray(i)&&(i[0]>1||0===i[0])&&(i[1]>1||0===i[1])&&(i[2]>1||0===i[2])&&(!i[3]||i[3]>1)?(l[0]=r[0],l[1]=r[1],l[2]=r[2],l[3]=null!=r[3]?r[3]:255,c&&(l[0]/=255,l[1]/=255,l[2]/=255,l[3]/=255)):c?(l[0]=r[0],l[1]=r[1],l[2]=r[2],l[3]=null!=r[3]?r[3]:1):(l[0]=o(Math.floor(255*r[0]),0,255),l[1]=o(Math.floor(255*r[1]),0,255),l[2]=o(Math.floor(255*r[2]),0,255),l[3]=null==r[3]?255:o(Math.floor(255*r[3]),0,255)),l}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(r,n,a){(function(i){(function(){"use strict";var a=r("color-name"),o=r("is-plain-obj"),s=r("defined");n.exports=function(r){var n,c,u=[],f=1;if("string"==typeof r){if(a[r])u=a[r].slice(),c="rgb";else if("transparent"===r)f=0,c="rgb",u=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(r)){var h=(d=r.slice(1)).length;f=1,h<=4?(u=[parseInt(d[0]+d[0],16),parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16)],4===h&&(f=parseInt(d[3]+d[3],16)/255)):(u=[parseInt(d[0]+d[1],16),parseInt(d[2]+d[3],16),parseInt(d[4]+d[5],16)],8===h&&(f=parseInt(d[6]+d[7],16)/255)),u[0]||(u[0]=0),u[1]||(u[1]=0),u[2]||(u[2]=0),c="rgb"}else if(n=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(r)){var p=n[1],d=p.replace(/a$/,"");c=d,h="cmyk"===d?4:"gray"===d?1:3,u=n[2].trim().split(/\s*,\s*/).map(function(r,n){if(/%$/.test(r))return n===h?parseFloat(r)/100:"rgb"===d?255*parseFloat(r)/100:parseFloat(r);if("h"===d[n]){if(/deg$/.test(r))return parseFloat(r);if(void 0!==l[r])return l[r]}return parseFloat(r)}),p===d&&u.push(1),f="rgb"===p||void 0===u[h]?1:u[h],u=u.slice(0,h)}else r.length>10&&/[0-9](?:\s|\/)/.test(r)&&(u=r.match(/([0-9]+)/g).map(function(r){return parseFloat(r)}),c=r.match(/([a-z])/gi).join("").toLowerCase())}else if(isNaN(r)){if(o(r)){var m=s(r.r,r.red,r.R,null);null!==m?(c="rgb",u=[m,s(r.g,r.green,r.G),s(r.b,r.blue,r.B)]):(c="hsl",u=[s(r.h,r.hue,r.H),s(r.s,r.saturation,r.S),s(r.l,r.lightness,r.L,r.b,r.brightness)]),f=s(r.a,r.alpha,r.opacity,1),null!=r.opacity&&(f/=100)}else(Array.isArray(r)||i.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(r))&&(u=[r[0],r[1],r[2]],c="rgb",f=4===r.length?r[3]:1)}else c="rgb",u=[r>>>16,(65280&r)>>>8,255&r];return{space:c,values:u,alpha:f}};var l={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(r,n,i){"use strict";var a=r("color-parse"),o=r("color-space/hsl"),s=r("clamp");n.exports=function(r){var n,i=a(r);return i.space?((n=[,,,])[0]=s(i.values[0],0,255),n[1]=s(i.values[1],0,255),n[2]=s(i.values[2],0,255),"h"===i.space[0]&&(n=o.rgb(n)),n.push(s(i.alpha,0,1)),n):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(r,n,i){"use strict";var a=r("./rgb");n.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(r){var n,i,a,o,s,l=r[0]/360,c=r[1]/100,u=r[2]/100;if(0===c)return[s=255*u,s,s];n=2*u-(i=u<.5?u*(1+c):u+c-u*c),o=[0,0,0];for(var f=0;f<3;f++)(a=l+-(1/3*(f-1)))<0?a++:a>1&&a--,s=6*a<1?n+6*(i-n)*a:2*a<1?i:3*a<2?n+(i-n)*(2/3-a)*6:n,o[f]=255*s;return o}},a.hsl=function(r){var n,i,a=r[0]/255,o=r[1]/255,s=r[2]/255,l=Math.min(a,o,s),c=Math.max(a,o,s),u=c-l;return c===l?n=0:a===c?n=(o-s)/u:o===c?n=2+(s-a)/u:s===c&&(n=4+(a-o)/u),(n=Math.min(60*n,360))<0&&(n+=360),i=(l+c)/2,[n,100*(c===l?0:i<=.5?u/(c+l):u/(2-c-l)),100*i]}},{"./rgb":93}],93:[function(r,n,i){"use strict";n.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(r,n,i){n.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xe7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xe9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xe9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xe3)o.?tom(e|\xe9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(r,n,i){n.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(r,n,i){n.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(r,n,i){n.exports=["normal","italic","oblique"]},{}],98:[function(r,n,i){n.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(r,n,i){"use strict";n.exports={parse:r("./parse"),stringify:r("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(r,n,i){"use strict";var a=r("css-font-size-keywords");n.exports={isSize:function(r){return/^[\d\.]/.test(r)||-1!==r.indexOf("/")||-1!==a.indexOf(r)}}},{"css-font-size-keywords":95}],101:[function(r,n,i){"use strict";var a=r("unquote"),o=r("css-global-keywords"),s=r("css-system-font-keywords"),l=r("css-font-weight-keywords"),c=r("css-font-style-keywords"),u=r("css-font-stretch-keywords"),f=r("string-split-by"),h=r("./lib/util").isSize;n.exports=d;var p=d.cache={};function d(r){if("string"!=typeof r)throw Error("Font argument must be a string.");if(p[r])return p[r];if(""===r)throw Error("Cannot parse an empty string.");if(-1!==s.indexOf(r))return p[r]={system:r};for(var n,i={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},d=f(r,/\s+/);n=d.shift();){if(-1!==o.indexOf(n))return["style","variant","weight","stretch"].forEach(function(r){i[r]=n}),p[r]=i;if(-1===c.indexOf(n)){if("normal"!==n&&"small-caps"!==n){if(-1===u.indexOf(n)){if(-1===l.indexOf(n)){if(h(n)){var g=f(n,"/");if(i.size=g[0],null!=g[1]?i.lineHeight=m(g[1]):"/"===d[0]&&(d.shift(),i.lineHeight=m(d.shift())),!d.length)throw Error("Missing required font-family.");return i.family=f(d.join(" "),/\s*,\s*/).map(a),p[r]=i}throw Error("Unknown or unsupported font token: "+n)}i.weight=n}else i.stretch=n}else i.variant=n}else i.style=n}throw Error("Missing required font-size.")}function m(r){var n=parseFloat(r);return n.toString()===r?n:r}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":305,unquote:328}],102:[function(r,n,i){"use strict";var a=r("pick-by-alias"),o=r("./lib/util").isSize,s=g(r("css-global-keywords")),l=g(r("css-system-font-keywords")),c=g(r("css-font-weight-keywords")),u=g(r("css-font-style-keywords")),f=g(r("css-font-stretch-keywords")),h={normal:1,"small-caps":1},p={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},d="serif";function m(r,n){if(r&&!n[r]&&!s[r])throw Error("Unknown keyword `"+r+"`");return r}function g(r){for(var n={},i=0;i<r.length;i++)n[r[i]]=1;return n}n.exports=function(r){if((r=a(r,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return r.system&&m(r.system,l),r.system;if(m(r.style,u),m(r.variant,h),m(r.weight,c),m(r.stretch,f),null==r.size&&(r.size="1rem"),"number"==typeof r.size&&(r.size+="px"),!o)throw Error("Bad size value `"+r.size+"`");r.family||(r.family=d),Array.isArray(r.family)&&(r.family.length||(r.family=[d]),r.family=r.family.map(function(r){return p[r]?r:'"'+r+'"'}).join(", "));var n=[];return n.push(r.style),r.variant!==r.style&&n.push(r.variant),r.weight!==r.variant&&r.weight!==r.style&&n.push(r.weight),r.stretch!==r.weight&&r.stretch!==r.variant&&r.stretch!==r.style&&n.push(r.stretch),n.push(r.size+(null==r.lineHeight||"normal"===r.lineHeight||r.lineHeight+""=="1"?"":"/"+r.lineHeight)),n.push(r.family),n.filter(Boolean).join(" ")}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(r,n,i){n.exports=["inherit","initial","unset"]},{}],104:[function(r,n,i){n.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(r,n,i){"use strict";var a,o=r("type/value/is"),s=r("type/value/ensure"),l=r("type/plain-function/ensure"),c=r("es5-ext/object/copy"),u=r("es5-ext/object/normalize-options"),f=r("es5-ext/object/map"),h=Function.prototype.bind,p=Object.defineProperty,d=Object.prototype.hasOwnProperty;a=function(r,n,i){var a,o=s(n)&&l(n.value);return delete(a=c(n)).writable,delete a.value,a.get=function(){return!i.overwriteDefinition&&d.call(this,r)?o:(n.value=h.call(o,i.resolveContext?i.resolveContext(this):this),p(this,r,n),this[r])},a},n.exports=function(r){var n=u(arguments[1]);return o(n.resolveContext)&&l(n.resolveContext),f(r,function(r,i){return a(i,r,n)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":321,"type/value/ensure":325,"type/value/is":326}],106:[function(r,n,i){"use strict";var a=r("type/value/is"),o=r("type/plain-function/is"),s=r("es5-ext/object/assign"),l=r("es5-ext/object/normalize-options"),c=r("es5-ext/string/#/contains");(n.exports=function(r,n){var i,o,u,f,h;return arguments.length<2||"string"!=typeof r?(f=n,n=r,r=null):f=arguments[2],a(r)?(i=c.call(r,"c"),o=c.call(r,"e"),u=c.call(r,"w")):(i=u=!0,o=!1),h={value:n,configurable:i,enumerable:o,writable:u},f?s(l(f),h):h}).gs=function(r,n,i){var u,f,h,p;return"string"!=typeof r?(h=i,i=n,n=r,r=null):h=arguments[3],a(n)?o(n)?a(i)?o(i)||(h=i,i=void 0):i=void 0:(h=n,n=i=void 0):n=void 0,a(r)?(u=c.call(r,"c"),f=c.call(r,"e")):(u=!0,f=!1),p={get:n,set:i,configurable:u,enumerable:f},h?s(l(h),p):p}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":322,"type/value/is":326}],107:[function(r,n,i){!function(r){"use strict";function n(r,n){return r<n?-1:r>n?1:r>=n?0:NaN}function i(r){var i;return 1===r.length&&(i=r,r=function(r,a){return n(i(r),a)}),{left:function(n,i,a,o){for(null==a&&(a=0),null==o&&(o=n.length);a<o;){var s=a+o>>>1;0>r(n[s],i)?a=s+1:o=s}return a},right:function(n,i,a,o){for(null==a&&(a=0),null==o&&(o=n.length);a<o;){var s=a+o>>>1;r(n[s],i)>0?o=s:a=s+1}return a}}}var a=i(n),o=a.right,s=a.left;function l(r,n){return[r,n]}function c(r){return null===r?NaN:+r}function u(r,n){var i,a,o=r.length,s=0,l=-1,u=0,f=0;if(null==n)for(;++l<o;)isNaN(i=c(r[l]))||(f+=(a=i-u)*(i-(u+=a/++s)));else for(;++l<o;)isNaN(i=c(n(r[l],l,r)))||(f+=(a=i-u)*(i-(u+=a/++s)));if(s>1)return f/(s-1)}function f(r,n){var i=u(r,n);return i?Math.sqrt(i):i}function h(r,n){var i,a,o,s=r.length,l=-1;if(null==n){for(;++l<s;)if(null!=(i=r[l])&&i>=i)for(a=o=i;++l<s;)null!=(i=r[l])&&(a>i&&(a=i),o<i&&(o=i))}else for(;++l<s;)if(null!=(i=n(r[l],l,r))&&i>=i)for(a=o=i;++l<s;)null!=(i=n(r[l],l,r))&&(a>i&&(a=i),o<i&&(o=i));return[a,o]}var p=Array.prototype,d=p.slice,m=p.map;function g(r){return function(){return r}}function v(r){return r}function y(r,n,i){r=+r,n=+n,i=(o=arguments.length)<2?(n=r,r=0,1):o<3?1:+i;for(var a=-1,o=0|Math.max(0,Math.ceil((n-r)/i)),s=Array(o);++a<o;)s[a]=r+a*i;return s}var x=Math.sqrt(50),b=Math.sqrt(10),_=Math.sqrt(2);function w(r,n,i){var a=(n-r)/Math.max(0,i),o=Math.floor(Math.log(a)/Math.LN10),s=a/Math.pow(10,o);return o>=0?(s>=x?10:s>=b?5:s>=_?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(s>=x?10:s>=b?5:s>=_?2:1)}function T(r,n,i){var a=Math.abs(n-r)/Math.max(0,i),o=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),s=a/o;return s>=x?o*=10:s>=b?o*=5:s>=_&&(o*=2),n<r?-o:o}function k(r){return Math.ceil(Math.log(r.length)/Math.LN2)+1}function A(r,n,i){if(null==i&&(i=c),a=r.length){if((n=+n)<=0||a<2)return+i(r[0],0,r);if(n>=1)return+i(r[a-1],a-1,r);var a,o=(a-1)*n,s=Math.floor(o),l=+i(r[s],s,r);return l+(+i(r[s+1],s+1,r)-l)*(o-s)}}function M(r,n){var i,a,o=r.length,s=-1;if(null==n){for(;++s<o;)if(null!=(i=r[s])&&i>=i)for(a=i;++s<o;)null!=(i=r[s])&&a>i&&(a=i)}else for(;++s<o;)if(null!=(i=n(r[s],s,r))&&i>=i)for(a=i;++s<o;)null!=(i=n(r[s],s,r))&&a>i&&(a=i);return a}function S(r){if(!(o=r.length))return[];for(var n=-1,i=M(r,E),a=Array(i);++n<i;)for(var o,s=-1,l=a[n]=Array(o);++s<o;)l[s]=r[s][n];return a}function E(r){return r.length}r.bisect=o,r.bisectRight=o,r.bisectLeft=s,r.ascending=n,r.bisector=i,r.cross=function(r,n,i){var a,o,s,c,u=r.length,f=n.length,h=Array(u*f);for(null==i&&(i=l),a=s=0;a<u;++a)for(c=r[a],o=0;o<f;++o,++s)h[s]=i(c,n[o]);return h},r.descending=function(r,n){return n<r?-1:n>r?1:n>=r?0:NaN},r.deviation=f,r.extent=h,r.histogram=function(){var r=v,n=h,i=k;function a(a){var s,l,c=a.length,u=Array(c);for(s=0;s<c;++s)u[s]=r(a[s],s,a);var f=n(u),h=f[0],p=f[1],d=i(u,h,p);Array.isArray(d)||(d=T(h,p,d),d=y(Math.ceil(h/d)*d,p,d));for(var m=d.length;d[0]<=h;)d.shift(),--m;for(;d[m-1]>p;)d.pop(),--m;var g,v=Array(m+1);for(s=0;s<=m;++s)(g=v[s]=[]).x0=s>0?d[s-1]:h,g.x1=s<m?d[s]:p;for(s=0;s<c;++s)h<=(l=u[s])&&l<=p&&v[o(d,l,0,m)].push(a[s]);return v}return a.value=function(n){return arguments.length?(r="function"==typeof n?n:g(n),a):r},a.domain=function(r){return arguments.length?(n="function"==typeof r?r:g([r[0],r[1]]),a):n},a.thresholds=function(r){return arguments.length?(i="function"==typeof r?r:Array.isArray(r)?g(d.call(r)):g(r),a):i},a},r.thresholdFreedmanDiaconis=function(r,i,a){return Math.ceil((a-i)/(2*(A(r=m.call(r,c).sort(n),.75)-A(r,.25))*Math.pow(r.length,-1/3)))},r.thresholdScott=function(r,n,i){return Math.ceil((i-n)/(3.5*f(r)*Math.pow(r.length,-1/3)))},r.thresholdSturges=k,r.max=function(r,n){var i,a,o=r.length,s=-1;if(null==n){for(;++s<o;)if(null!=(i=r[s])&&i>=i)for(a=i;++s<o;)null!=(i=r[s])&&i>a&&(a=i)}else for(;++s<o;)if(null!=(i=n(r[s],s,r))&&i>=i)for(a=i;++s<o;)null!=(i=n(r[s],s,r))&&i>a&&(a=i);return a},r.mean=function(r,n){var i,a=r.length,o=a,s=-1,l=0;if(null==n)for(;++s<a;)isNaN(i=c(r[s]))?--o:l+=i;else for(;++s<a;)isNaN(i=c(n(r[s],s,r)))?--o:l+=i;if(o)return l/o},r.median=function(r,i){var a,o=r.length,s=-1,l=[];if(null==i)for(;++s<o;)isNaN(a=c(r[s]))||l.push(a);else for(;++s<o;)isNaN(a=c(i(r[s],s,r)))||l.push(a);return A(l.sort(n),.5)},r.merge=function(r){for(var n,i,a,o=r.length,s=-1,l=0;++s<o;)l+=r[s].length;for(i=Array(l);--o>=0;)for(n=(a=r[o]).length;--n>=0;)i[--l]=a[n];return i},r.min=M,r.pairs=function(r,n){null==n&&(n=l);for(var i=0,a=r.length-1,o=r[0],s=Array(a<0?0:a);i<a;)s[i]=n(o,o=r[++i]);return s},r.permute=function(r,n){for(var i=n.length,a=Array(i);i--;)a[i]=r[n[i]];return a},r.quantile=A,r.range=y,r.scan=function(r,i){if(a=r.length){var a,o,s=0,l=0,c=r[0];for(null==i&&(i=n);++s<a;)(0>i(o=r[s],c)||0!==i(c,c))&&(c=o,l=s);return 0===i(c,c)?l:void 0}},r.shuffle=function(r,n,i){for(var a,o,s=(null==i?r.length:i)-(n=null==n?0:+n);s;)o=Math.random()*s--|0,a=r[s+n],r[s+n]=r[o+n],r[o+n]=a;return r},r.sum=function(r,n){var i,a=r.length,o=-1,s=0;if(null==n)for(;++o<a;)(i=+r[o])&&(s+=i);else for(;++o<a;)(i=+n(r[o],o,r))&&(s+=i);return s},r.ticks=function(r,n,i){var a,o,s,l,c=-1;if(i=+i,(r=+r)==(n=+n)&&i>0)return[r];if((a=n<r)&&(o=r,r=n,n=o),0===(l=w(r,n,i))||!isFinite(l))return[];if(l>0)for(r=Math.ceil(r/l),s=Array(o=Math.ceil((n=Math.floor(n/l))-r+1));++c<o;)s[c]=(r+c)*l;else for(s=Array(o=Math.ceil((r=Math.floor(r*l))-(n=Math.ceil(n*l))+1));++c<o;)s[c]=(r-c)/l;return a&&s.reverse(),s},r.tickIncrement=w,r.tickStep=T,r.transpose=S,r.variance=u,r.zip=function(){return S(arguments)},Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:this.d3=this.d3||{})},{}],108:[function(r,n,i){!function(r){"use strict";function n(){}function i(r,i){var a=new n;if(r instanceof n)r.each(function(r,n){a.set(n,r)});else if(Array.isArray(r)){var o,s=-1,l=r.length;if(null==i)for(;++s<l;)a.set(s,r[s]);else for(;++s<l;)a.set(i(o=r[s],s,r),o)}else if(r)for(var c in r)a.set(c,r[c]);return a}function a(){return{}}function o(r,n,i){r[n]=i}function s(){return i()}function l(r,n,i){r.set(n,i)}function c(){}n.prototype=i.prototype={constructor:n,has:function(r){return"$"+r in this},get:function(r){return this["$"+r]},set:function(r,n){return this["$"+r]=n,this},remove:function(r){var n="$"+r;return n in this&&delete this[n]},clear:function(){for(var r in this)"$"===r[0]&&delete this[r]},keys:function(){var r=[];for(var n in this)"$"===n[0]&&r.push(n.slice(1));return r},values:function(){var r=[];for(var n in this)"$"===n[0]&&r.push(this[n]);return r},entries:function(){var r=[];for(var n in this)"$"===n[0]&&r.push({key:n.slice(1),value:this[n]});return r},size:function(){var r=0;for(var n in this)"$"===n[0]&&++r;return r},empty:function(){for(var r in this)if("$"===r[0])return!1;return!0},each:function(r){for(var n in this)"$"===n[0]&&r(this[n],n.slice(1),this)}};var u=i.prototype;function f(r,n){var i=new c;if(r instanceof c)r.each(function(r){i.add(r)});else if(r){var a=-1,o=r.length;if(null==n)for(;++a<o;)i.add(r[a]);else for(;++a<o;)i.add(n(r[a],a,r))}return i}c.prototype=f.prototype={constructor:c,has:u.has,add:function(r){return this["$"+(r+="")]=r,this},remove:u.remove,clear:u.clear,values:u.keys,size:u.size,empty:u.empty,each:u.each},r.nest=function(){var r,n,c,u=[],f=[];function h(a,o,s,l){if(o>=u.length)return null!=r&&a.sort(r),null!=n?n(a):a;for(var c,f,p,d=-1,m=a.length,g=u[o++],v=i(),y=s();++d<m;)(p=v.get(c=g(f=a[d])+""))?p.push(f):v.set(c,[f]);return v.each(function(r,n){l(y,n,h(r,o,s,l))}),y}return c={object:function(r){return h(r,0,a,o)},map:function(r){return h(r,0,s,l)},entries:function(r){return function r(i,a){if(++a>u.length)return i;var o,s=f[a-1];return null!=n&&a>=u.length?o=i.entries():(o=[],i.each(function(n,i){o.push({key:i,values:r(n,a)})})),null!=s?o.sort(function(r,n){return s(r.key,n.key)}):o}(h(r,0,s,l),0)},key:function(r){return u.push(r),c},sortKeys:function(r){return f[u.length-1]=r,c},sortValues:function(n){return r=n,c},rollup:function(r){return n=r,c}}},r.set=f,r.map=i,r.keys=function(r){var n=[];for(var i in r)n.push(i);return n},r.values=function(r){var n=[];for(var i in r)n.push(r[i]);return n},r.entries=function(r){var n=[];for(var i in r)n.push({key:i,value:r[i]});return n},Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:this.d3=this.d3||{})},{}],109:[function(r,n,i){var a;a=this,function(r){"use strict";function n(r,n,i){r.prototype=n.prototype=i,i.constructor=r}function i(r,n){var i=Object.create(r.prototype);for(var a in n)i[a]=n[a];return i}function a(){}var o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=RegExp("^rgb\\("+[o,o,o]+"\\)$"),f=RegExp("^rgb\\("+[l,l,l]+"\\)$"),h=RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),p=RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),d=RegExp("^hsl\\("+[s,l,l]+"\\)$"),m=RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),g={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function v(){return this.rgb().formatHex()}function y(){return this.rgb().formatRgb()}function x(r){var n,i;return r=(r+"").trim().toLowerCase(),(n=c.exec(r))?(i=n[1].length,n=parseInt(n[1],16),6===i?b(n):3===i?new k(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===i?_(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===i?_(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=u.exec(r))?new k(n[1],n[2],n[3],1):(n=f.exec(r))?new k(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=h.exec(r))?_(n[1],n[2],n[3],n[4]):(n=p.exec(r))?_(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=d.exec(r))?E(n[1],n[2]/100,n[3]/100,1):(n=m.exec(r))?E(n[1],n[2]/100,n[3]/100,n[4]):g.hasOwnProperty(r)?b(g[r]):"transparent"===r?new k(NaN,NaN,NaN,0):null}function b(r){return new k(r>>16&255,r>>8&255,255&r,1)}function _(r,n,i,a){return a<=0&&(r=n=i=NaN),new k(r,n,i,a)}function w(r){return r instanceof a||(r=x(r)),r?new k((r=r.rgb()).r,r.g,r.b,r.opacity):new k}function T(r,n,i,a){return 1==arguments.length?w(r):new k(r,n,i,null==a?1:a)}function k(r,n,i,a){this.r=+r,this.g=+n,this.b=+i,this.opacity=+a}function A(){return"#"+S(this.r)+S(this.g)+S(this.b)}function M(){var r=this.opacity;return(1===(r=isNaN(r)?1:Math.max(0,Math.min(1,r)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===r?")":", "+r+")")}function S(r){return((r=Math.max(0,Math.min(255,Math.round(r)||0)))<16?"0":"")+r.toString(16)}function E(r,n,i,a){return a<=0?r=n=i=NaN:i<=0||i>=1?r=n=NaN:n<=0&&(r=NaN),new P(r,n,i,a)}function L(r){if(r instanceof P)return new P(r.h,r.s,r.l,r.opacity);if(r instanceof a||(r=x(r)),!r)return new P;if(r instanceof P)return r;var n=(r=r.rgb()).r/255,i=r.g/255,o=r.b/255,s=Math.min(n,i,o),l=Math.max(n,i,o),c=NaN,u=l-s,f=(l+s)/2;return u?(c=n===l?(i-o)/u+6*(i<o):i===l?(o-n)/u+2:(n-i)/u+4,u/=f<.5?l+s:2-l-s,c*=60):u=f>0&&f<1?0:c,new P(c,u,f,r.opacity)}function C(r,n,i,a){return 1==arguments.length?L(r):new P(r,n,i,null==a?1:a)}function P(r,n,i,a){this.h=+r,this.s=+n,this.l=+i,this.opacity=+a}function I(r,n,i){return 255*(r<60?n+(i-n)*r/60:r<180?i:r<240?n+(i-n)*(240-r)/60:n)}n(a,x,{copy:function(r){return Object.assign(new this.constructor,this,r)},displayable:function(){return this.rgb().displayable()},hex:v,formatHex:v,formatHsl:function(){return L(this).formatHsl()},formatRgb:y,toString:y}),n(k,T,i(a,{brighter:function(r){return r=null==r?1/.7:Math.pow(1/.7,r),new k(this.r*r,this.g*r,this.b*r,this.opacity)},darker:function(r){return r=null==r?.7:Math.pow(.7,r),new k(this.r*r,this.g*r,this.b*r,this.opacity)},rgb:function(){return this},displayable:function(){return -.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:A,formatHex:A,formatRgb:M,toString:M})),n(P,C,i(a,{brighter:function(r){return r=null==r?1/.7:Math.pow(1/.7,r),new P(this.h,this.s,this.l*r,this.opacity)},darker:function(r){return r=null==r?.7:Math.pow(.7,r),new P(this.h,this.s,this.l*r,this.opacity)},rgb:function(){var r=this.h%360+360*(this.h<0),n=isNaN(r)||isNaN(this.s)?0:this.s,i=this.l,a=i+(i<.5?i:1-i)*n,o=2*i-a;return new k(I(r>=240?r-240:r+120,o,a),I(r,o,a),I(r<120?r+240:r-120,o,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var r=this.opacity;return(1===(r=isNaN(r)?1:Math.max(0,Math.min(1,r)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===r?")":", "+r+")")}}));var O=Math.PI/180,z=180/Math.PI,D=6/29,R=6/29*3*(6/29);function F(r){if(r instanceof N)return new N(r.l,r.a,r.b,r.opacity);if(r instanceof Y)return W(r);r instanceof k||(r=w(r));var n,i,a=H(r.r),o=H(r.g),s=H(r.b),l=j((.2225045*a+.7168786*o+.0606169*s)/1);return a===o&&o===s?n=i=l:(n=j((.4360747*a+.3850649*o+.1430804*s)/.96422),i=j((.0139322*a+.0971045*o+.7141733*s)/.82521)),new N(116*l-16,500*(n-l),200*(l-i),r.opacity)}function B(r,n,i,a){return 1==arguments.length?F(r):new N(r,n,i,null==a?1:a)}function N(r,n,i,a){this.l=+r,this.a=+n,this.b=+i,this.opacity=+a}function j(r){return r>.008856451679035631?Math.pow(r,1/3):r/R+4/29}function U(r){return r>D?r*r*r:R*(r-4/29)}function V(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function H(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function q(r){if(r instanceof Y)return new Y(r.h,r.c,r.l,r.opacity);if(r instanceof N||(r=F(r)),0===r.a&&0===r.b)return new Y(NaN,0<r.l&&r.l<100?0:NaN,r.l,r.opacity);var n=Math.atan2(r.b,r.a)*z;return new Y(n<0?n+360:n,Math.sqrt(r.a*r.a+r.b*r.b),r.l,r.opacity)}function G(r,n,i,a){return 1==arguments.length?q(r):new Y(r,n,i,null==a?1:a)}function Y(r,n,i,a){this.h=+r,this.c=+n,this.l=+i,this.opacity=+a}function W(r){if(isNaN(r.h))return new N(r.l,0,0,r.opacity);var n=r.h*O;return new N(r.l,Math.cos(n)*r.c,Math.sin(n)*r.c,r.opacity)}n(N,B,i(a,{brighter:function(r){return new N(this.l+18*(null==r?1:r),this.a,this.b,this.opacity)},darker:function(r){return new N(this.l-18*(null==r?1:r),this.a,this.b,this.opacity)},rgb:function(){var r=(this.l+16)/116,n=isNaN(this.a)?r:r+this.a/500,i=isNaN(this.b)?r:r-this.b/200;return new k(V(3.1338561*(n=.96422*U(n))-1.6168667*(r=1*U(r))-.4906146*(i=.82521*U(i))),V(-.9787684*n+1.9161415*r+.033454*i),V(.0719453*n-.2289914*r+1.4052427*i),this.opacity)}})),n(Y,G,i(a,{brighter:function(r){return new Y(this.h,this.c,this.l+18*(null==r?1:r),this.opacity)},darker:function(r){return new Y(this.h,this.c,this.l-18*(null==r?1:r),this.opacity)},rgb:function(){return W(this).rgb()}}));var X=-1.78277*.29227-.1347134789;function Z(r,n,i,a){return 1==arguments.length?function(r){if(r instanceof J)return new J(r.h,r.s,r.l,r.opacity);r instanceof k||(r=w(r));var n=r.r/255,i=r.g/255,a=r.b/255,o=(X*a+-1.7884503806*n-3.5172982438*i)/(X+-1.7884503806-3.5172982438),s=a-o,l=-((1.97294*(i-o)- -.29227*s)/.90649),c=Math.sqrt(l*l+s*s)/(1.97294*o*(1-o)),u=c?Math.atan2(l,s)*z-120:NaN;return new J(u<0?u+360:u,c,o,r.opacity)}(r):new J(r,n,i,null==a?1:a)}function J(r,n,i,a){this.h=+r,this.s=+n,this.l=+i,this.opacity=+a}n(J,Z,i(a,{brighter:function(r){return r=null==r?1/.7:Math.pow(1/.7,r),new J(this.h,this.s,this.l*r,this.opacity)},darker:function(r){return r=null==r?.7:Math.pow(.7,r),new J(this.h,this.s,this.l*r,this.opacity)},rgb:function(){var r=isNaN(this.h)?0:(this.h+120)*O,n=+this.l,i=isNaN(this.s)?0:this.s*n*(1-n),a=Math.cos(r),o=Math.sin(r);return new k(255*(n+i*(-.14861*a+1.78277*o)),255*(n+i*(-.29227*a+-.90649*o)),255*(n+1.97294*a*i),this.opacity)}})),r.color=x,r.cubehelix=Z,r.gray=function(r,n){return new N(r,0,0,null==n?1:n)},r.hcl=G,r.hsl=C,r.lab=B,r.lch=function(r,n,i,a){return 1==arguments.length?q(r):new Y(i,n,r,null==a?1:a)},r.rgb=T,Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:(a=a||self).d3=a.d3||{})},{}],110:[function(r,n,i){var a;a=this,function(r){"use strict";var n={value:function(){}};function i(){for(var r,n=0,i=arguments.length,o={};n<i;++n){if(!(r=arguments[n]+"")||r in o||/[\s.]/.test(r))throw Error("illegal type: "+r);o[r]=[]}return new a(o)}function a(r){this._=r}function o(r,i,a){for(var o=0,s=r.length;o<s;++o)if(r[o].name===i){r[o]=n,r=r.slice(0,o).concat(r.slice(o+1));break}return null!=a&&r.push({name:i,value:a}),r}a.prototype=i.prototype={constructor:a,on:function(r,n){var i,a=this._,s=(r+"").trim().split(/^|\s+/).map(function(r){var n="",i=r.indexOf(".");if(i>=0&&(n=r.slice(i+1),r=r.slice(0,i)),r&&!a.hasOwnProperty(r))throw Error("unknown type: "+r);return{type:r,name:n}}),l=-1,c=s.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw Error("invalid callback: "+n);for(;++l<c;)if(i=(r=s[l]).type)a[i]=o(a[i],r.name,n);else if(null==n)for(i in a)a[i]=o(a[i],r.name,null);return this}for(;++l<c;)if((i=(r=s[l]).type)&&(i=function(r,n){for(var i,a=0,o=r.length;a<o;++a)if((i=r[a]).name===n)return i.value}(a[i],r.name)))return i},copy:function(){var r={},n=this._;for(var i in n)r[i]=n[i].slice();return new a(r)},call:function(r,n){if((i=arguments.length-2)>0)for(var i,a,o=Array(i),s=0;s<i;++s)o[s]=arguments[s+2];if(!this._.hasOwnProperty(r))throw Error("unknown type: "+r);for(s=0,i=(a=this._[r]).length;s<i;++s)a[s].value.apply(n,o)},apply:function(r,n,i){if(!this._.hasOwnProperty(r))throw Error("unknown type: "+r);for(var a=this._[r],o=0,s=a.length;o<s;++o)a[o].value.apply(n,i)}},r.dispatch=i,Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:(a=a||self).d3=a.d3||{})},{}],111:[function(r,n,i){var a;a=function(r,n,i,a,o){"use strict";function s(r){return function(){return r}}function l(){return 1e-6*(Math.random()-.5)}function c(r){return r.x+r.vx}function u(r){return r.y+r.vy}function f(r){return r.index}function h(r,n){var i=r.get(n);if(!i)throw Error("missing: "+n);return i}function p(r){return r.x}function d(r){return r.y}var m=Math.PI*(3-Math.sqrt(5));r.forceCenter=function(r,n){var i;function a(){var a,o,s=i.length,l=0,c=0;for(a=0;a<s;++a)l+=(o=i[a]).x,c+=o.y;for(l=l/s-r,c=c/s-n,a=0;a<s;++a)(o=i[a]).x-=l,o.y-=c}return null==r&&(r=0),null==n&&(n=0),a.initialize=function(r){i=r},a.x=function(n){return arguments.length?(r=+n,a):r},a.y=function(r){return arguments.length?(n=+r,a):n},a},r.forceCollide=function(r){var i,a,o=1,f=1;function h(){for(var r,s,h,d,m,g,v,y=i.length,x=0;x<f;++x)for(s=n.quadtree(i,c,u).visitAfter(p),r=0;r<y;++r)v=(g=a[(h=i[r]).index])*g,d=h.x+h.vx,m=h.y+h.vy,s.visit(b);function b(r,n,i,a,s){var c=r.data,u=r.r,f=g+u;if(!c)return n>d+f||a<d-f||i>m+f||s<m-f;if(c.index>h.index){var p=d-c.x-c.vx,y=m-c.y-c.vy,x=p*p+y*y;x<f*f&&(0===p&&(x+=(p=l())*p),0===y&&(x+=(y=l())*y),x=(f-(x=Math.sqrt(x)))/x*o,h.vx+=(p*=x)*(f=(u*=u)/(v+u)),h.vy+=(y*=x)*f,c.vx-=p*(f=1-f),c.vy-=y*f)}}}function p(r){if(r.data)return r.r=a[r.data.index];for(var n=r.r=0;n<4;++n)r[n]&&r[n].r>r.r&&(r.r=r[n].r)}function d(){if(i){var n,o,s=i.length;for(a=Array(s),n=0;n<s;++n)a[(o=i[n]).index]=+r(o,n,i)}}return"function"!=typeof r&&(r=s(null==r?1:+r)),h.initialize=function(r){i=r,d()},h.iterations=function(r){return arguments.length?(f=+r,h):f},h.strength=function(r){return arguments.length?(o=+r,h):o},h.radius=function(n){return arguments.length?(r="function"==typeof n?n:s(+n),d(),h):r},h},r.forceLink=function(r){var n,a,o,c,u,p=f,d=function(r){return 1/Math.min(c[r.source.index],c[r.target.index])},m=s(30),g=1;function v(i){for(var o=0,s=r.length;o<g;++o)for(var c,f,h,p,d,m,v,y=0;y<s;++y)f=(c=r[y]).source,p=(h=c.target).x+h.vx-f.x-f.vx||l(),d=h.y+h.vy-f.y-f.vy||l(),p*=m=((m=Math.sqrt(p*p+d*d))-a[y])/m*i*n[y],d*=m,h.vx-=p*(v=u[y]),h.vy-=d*v,f.vx+=p*(v=1-v),f.vy+=d*v}function y(){if(o){var s,l,f=o.length,d=r.length,m=i.map(o,p);for(s=0,c=Array(f);s<d;++s)(l=r[s]).index=s,"object"!=typeof l.source&&(l.source=h(m,l.source)),"object"!=typeof l.target&&(l.target=h(m,l.target)),c[l.source.index]=(c[l.source.index]||0)+1,c[l.target.index]=(c[l.target.index]||0)+1;for(s=0,u=Array(d);s<d;++s)l=r[s],u[s]=c[l.source.index]/(c[l.source.index]+c[l.target.index]);n=Array(d),x(),a=Array(d),b()}}function x(){if(o)for(var i=0,a=r.length;i<a;++i)n[i]=+d(r[i],i,r)}function b(){if(o)for(var n=0,i=r.length;n<i;++n)a[n]=+m(r[n],n,r)}return null==r&&(r=[]),v.initialize=function(r){o=r,y()},v.links=function(n){return arguments.length?(r=n,y(),v):r},v.id=function(r){return arguments.length?(p=r,v):p},v.iterations=function(r){return arguments.length?(g=+r,v):g},v.strength=function(r){return arguments.length?(d="function"==typeof r?r:s(+r),x(),v):d},v.distance=function(r){return arguments.length?(m="function"==typeof r?r:s(+r),b(),v):m},v},r.forceManyBody=function(){var r,i,a,o,c=s(-30),u=1,f=1/0,h=.81;function m(o){var s,l=r.length,c=n.quadtree(r,p,d).visitAfter(v);for(a=o,s=0;s<l;++s)i=r[s],c.visit(y)}function g(){if(r){var n,i,a=r.length;for(o=Array(a),n=0;n<a;++n)o[(i=r[n]).index]=+c(i,n,r)}}function v(r){var n,i,a,s,l,c=0,u=0;if(r.length){for(a=s=l=0;l<4;++l)(n=r[l])&&(i=Math.abs(n.value))&&(c+=n.value,u+=i,a+=i*n.x,s+=i*n.y);r.x=a/u,r.y=s/u}else{(n=r).x=n.data.x,n.y=n.data.y;do c+=o[n.data.index];while(n=n.next)}r.value=c}function y(r,n,s,c){if(!r.value)return!0;var p=r.x-i.x,d=r.y-i.y,m=c-n,g=p*p+d*d;if(m*m/h<g)return g<f&&(0===p&&(g+=(p=l())*p),0===d&&(g+=(d=l())*d),g<u&&(g=Math.sqrt(u*g)),i.vx+=p*r.value*a/g,i.vy+=d*r.value*a/g),!0;if(!(r.length||g>=f)){(r.data!==i||r.next)&&(0===p&&(g+=(p=l())*p),0===d&&(g+=(d=l())*d),g<u&&(g=Math.sqrt(u*g)));do r.data!==i&&(m=o[r.data.index]*a/g,i.vx+=p*m,i.vy+=d*m);while(r=r.next)}}return m.initialize=function(n){r=n,g()},m.strength=function(r){return arguments.length?(c="function"==typeof r?r:s(+r),g(),m):c},m.distanceMin=function(r){return arguments.length?(u=r*r,m):Math.sqrt(u)},m.distanceMax=function(r){return arguments.length?(f=r*r,m):Math.sqrt(f)},m.theta=function(r){return arguments.length?(h=r*r,m):Math.sqrt(h)},m},r.forceRadial=function(r,n,i){var a,o,l,c=s(.1);function u(r){for(var s=0,c=a.length;s<c;++s){var u=a[s],f=u.x-n||1e-6,h=u.y-i||1e-6,p=Math.sqrt(f*f+h*h),d=(l[s]-p)*o[s]*r/p;u.vx+=f*d,u.vy+=h*d}}function f(){if(a){var n,i=a.length;for(o=Array(i),l=Array(i),n=0;n<i;++n)l[n]=+r(a[n],n,a),o[n]=isNaN(l[n])?0:+c(a[n],n,a)}}return"function"!=typeof r&&(r=s(+r)),null==n&&(n=0),null==i&&(i=0),u.initialize=function(r){a=r,f()},u.strength=function(r){return arguments.length?(c="function"==typeof r?r:s(+r),f(),u):c},u.radius=function(n){return arguments.length?(r="function"==typeof n?n:s(+n),f(),u):r},u.x=function(r){return arguments.length?(n=+r,u):n},u.y=function(r){return arguments.length?(i=+r,u):i},u},r.forceSimulation=function(r){var n,s=1,l=.001,c=1-Math.pow(.001,1/300),u=0,f=.6,h=i.map(),p=o.timer(g),d=a.dispatch("tick","end");function g(){v(),d.call("tick",n),s<l&&(p.stop(),d.call("end",n))}function v(i){var a,o,l=r.length;void 0===i&&(i=1);for(var p=0;p<i;++p)for(s+=(u-s)*c,h.each(function(r){r(s)}),a=0;a<l;++a)null==(o=r[a]).fx?o.x+=o.vx*=f:(o.x=o.fx,o.vx=0),null==o.fy?o.y+=o.vy*=f:(o.y=o.fy,o.vy=0);return n}function y(){for(var n,i=0,a=r.length;i<a;++i){if((n=r[i]).index=i,null!=n.fx&&(n.x=n.fx),null!=n.fy&&(n.y=n.fy),isNaN(n.x)||isNaN(n.y)){var o=10*Math.sqrt(i),s=i*m;n.x=o*Math.cos(s),n.y=o*Math.sin(s)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function x(n){return n.initialize&&n.initialize(r),n}return null==r&&(r=[]),y(),n={tick:v,restart:function(){return p.restart(g),n},stop:function(){return p.stop(),n},nodes:function(i){return arguments.length?(r=i,y(),h.each(x),n):r},alpha:function(r){return arguments.length?(s=+r,n):s},alphaMin:function(r){return arguments.length?(l=+r,n):l},alphaDecay:function(r){return arguments.length?(c=+r,n):+c},alphaTarget:function(r){return arguments.length?(u=+r,n):u},velocityDecay:function(r){return arguments.length?(f=1-r,n):1-f},force:function(r,i){return arguments.length>1?(null==i?h.remove(r):h.set(r,x(i)),n):h.get(r)},find:function(n,i,a){var o,s,l,c,u,f=0,h=r.length;for(null==a?a=1/0:a*=a,f=0;f<h;++f)(l=(o=n-(c=r[f]).x)*o+(s=i-c.y)*s)<a&&(u=c,a=l);return u},on:function(r,i){return arguments.length>1?(d.on(r,i),n):d.on(r)}}},r.forceX=function(r){var n,i,a,o=s(.1);function l(r){for(var o,s=0,l=n.length;s<l;++s)(o=n[s]).vx+=(a[s]-o.x)*i[s]*r}function c(){if(n){var s,l=n.length;for(i=Array(l),a=Array(l),s=0;s<l;++s)i[s]=isNaN(a[s]=+r(n[s],s,n))?0:+o(n[s],s,n)}}return"function"!=typeof r&&(r=s(null==r?0:+r)),l.initialize=function(r){n=r,c()},l.strength=function(r){return arguments.length?(o="function"==typeof r?r:s(+r),c(),l):o},l.x=function(n){return arguments.length?(r="function"==typeof n?n:s(+n),c(),l):r},l},r.forceY=function(r){var n,i,a,o=s(.1);function l(r){for(var o,s=0,l=n.length;s<l;++s)(o=n[s]).vy+=(a[s]-o.y)*i[s]*r}function c(){if(n){var s,l=n.length;for(i=Array(l),a=Array(l),s=0;s<l;++s)i[s]=isNaN(a[s]=+r(n[s],s,n))?0:+o(n[s],s,n)}}return"function"!=typeof r&&(r=s(null==r?0:+r)),l.initialize=function(r){n=r,c()},l.strength=function(r){return arguments.length?(o="function"==typeof r?r:s(+r),c(),l):o},l.y=function(n){return arguments.length?(r="function"==typeof n?n:s(+n),c(),l):r},l},Object.defineProperty(r,"__esModule",{value:!0})},"object"==typeof i&&void 0!==n?a(i,r("d3-quadtree"),r("d3-collection"),r("d3-dispatch"),r("d3-timer")):a(this.d3=this.d3||{},this.d3,this.d3,this.d3,this.d3)},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(r,n,i){var a;a=this,function(r){"use strict";function n(r,n){if((i=(r=n?r.toExponential(n-1):r.toExponential()).indexOf("e"))<0)return null;var i,a=r.slice(0,i);return[a.length>1?a[0]+a.slice(2):a,+r.slice(i+1)]}function i(r){return(r=n(Math.abs(r)))?r[1]:NaN}var a,o=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function s(r){var n;if(!(n=o.exec(r)))throw Error("invalid format: "+r);return new l({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function l(r){this.fill=void 0===r.fill?" ":r.fill+"",this.align=void 0===r.align?">":r.align+"",this.sign=void 0===r.sign?"-":r.sign+"",this.symbol=void 0===r.symbol?"":r.symbol+"",this.zero=!!r.zero,this.width=void 0===r.width?void 0:+r.width,this.comma=!!r.comma,this.precision=void 0===r.precision?void 0:+r.precision,this.trim=!!r.trim,this.type=void 0===r.type?"":r.type+""}function c(r,i){var a=n(r,i);if(!a)return r+"";var o=a[0],s=a[1];return s<0?"0."+Array(-s).join("0")+o:o.length>s+1?o.slice(0,s+1)+"."+o.slice(s+1):o+Array(s-o.length+2).join("0")}s.prototype=l.prototype,l.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var u={"%":function(r,n){return(100*r).toFixed(n)},b:function(r){return Math.round(r).toString(2)},c:function(r){return r+""},d:function(r){return Math.abs(r=Math.round(r))>=1e21?r.toLocaleString("en").replace(/,/g,""):r.toString(10)},e:function(r,n){return r.toExponential(n)},f:function(r,n){return r.toFixed(n)},g:function(r,n){return r.toPrecision(n)},o:function(r){return Math.round(r).toString(8)},p:function(r,n){return c(100*r,n)},r:c,s:function(r,i){var o=n(r,i);if(!o)return r+"";var s=o[0],l=o[1],c=l-(a=3*Math.max(-8,Math.min(8,Math.floor(l/3))))+1,u=s.length;return c===u?s:c>u?s+Array(c-u+1).join("0"):c>0?s.slice(0,c)+"."+s.slice(c):"0."+Array(1-c).join("0")+n(r,Math.max(0,i+c-1))[0]},X:function(r){return Math.round(r).toString(16).toUpperCase()},x:function(r){return Math.round(r).toString(16)}};function f(r){return r}var h,p=Array.prototype.map,d=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function m(r){var n,o,l,c=void 0===r.grouping||void 0===r.thousands?f:(o=p.call(r.grouping,Number),l=r.thousands+"",function(r,n){for(var i=r.length,a=[],s=0,c=o[0],u=0;i>0&&c>0&&(u+c+1>n&&(c=Math.max(1,n-u)),a.push(r.substring(i-=c,i+c)),!((u+=c+1)>n));)c=o[s=(s+1)%o.length];return a.reverse().join(l)}),h=void 0===r.currency?"":r.currency[0]+"",m=void 0===r.currency?"":r.currency[1]+"",g=void 0===r.decimal?".":r.decimal+"",v=void 0===r.numerals?f:(n=p.call(r.numerals,String),function(r){return r.replace(/[0-9]/g,function(r){return n[+r]})}),y=void 0===r.percent?"%":r.percent+"",x=void 0===r.minus?"-":r.minus+"",b=void 0===r.nan?"NaN":r.nan+"";function _(r){var n=(r=s(r)).fill,i=r.align,o=r.sign,l=r.symbol,f=r.zero,p=r.width,_=r.comma,w=r.precision,T=r.trim,k=r.type;"n"===k?(_=!0,k="g"):u[k]||(void 0===w&&(w=12),T=!0,k="g"),(f||"0"===n&&"="===i)&&(f=!0,n="0",i="=");var A="$"===l?h:"#"===l&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",M="$"===l?m:/[%p]/.test(k)?y:"",S=u[k],E=/[defgprs%]/.test(k);function L(r){var s,l,u,h=A,m=M;if("c"===k)m=S(r)+m,r="";else{var y=(r=+r)<0||1/r<0;if(r=isNaN(r)?b:S(Math.abs(r),w),T&&(r=function(r){t:for(var n,i=r.length,a=1,o=-1;a<i;++a)switch(r[a]){case".":o=n=a;break;case"0":0===o&&(o=a),n=a;break;default:if(!+r[a])break t;o>0&&(o=0)}return o>0?r.slice(0,o)+r.slice(n+1):r}(r)),y&&0==+r&&"+"!==o&&(y=!1),h=(y?"("===o?o:x:"-"===o||"("===o?"":o)+h,m=("s"===k?d[8+a/3]:"")+m+(y&&"("===o?")":""),E){for(s=-1,l=r.length;++s<l;)if(48>(u=r.charCodeAt(s))||u>57){m=(46===u?g+r.slice(s+1):r.slice(s))+m,r=r.slice(0,s);break}}}_&&!f&&(r=c(r,1/0));var L=h.length+r.length+m.length,C=L<p?Array(p-L+1).join(n):"";switch(_&&f&&(r=c(C+r,C.length?p-m.length:1/0),C=""),i){case"<":r=h+r+m+C;break;case"=":r=h+C+r+m;break;case"^":r=C.slice(0,L=C.length>>1)+h+r+m+C.slice(L);break;default:r=C+h+r+m}return v(r)}return w=void 0===w?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w)),L.toString=function(){return r+""},L}return{format:_,formatPrefix:function(r,n){var a=_(((r=s(r)).type="f",r)),o=3*Math.max(-8,Math.min(8,Math.floor(i(n)/3))),l=Math.pow(10,-o),c=d[8+o/3];return function(r){return a(l*r)+c}}}}function g(n){return h=m(n),r.format=h.format,r.formatPrefix=h.formatPrefix,h}g({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),r.FormatSpecifier=l,r.formatDefaultLocale=g,r.formatLocale=m,r.formatSpecifier=s,r.precisionFixed=function(r){return Math.max(0,-i(Math.abs(r)))},r.precisionPrefix=function(r,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(i(n)/3)))-i(Math.abs(r)))},r.precisionRound=function(r,n){return Math.max(0,i(n=Math.abs(n)-(r=Math.abs(r)))-i(r))+1},Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:(a="undefined"!=typeof globalThis?globalThis:a||self).d3=a.d3||{})},{}],113:[function(r,n,i){var a;a=function(r,n,i){"use strict";var a=Math.abs,o=Math.atan,s=Math.atan2,l=Math.cos,c=Math.exp,u=Math.floor,f=Math.log,h=Math.max,p=Math.min,d=Math.pow,m=Math.round,g=Math.sign||function(r){return r>0?1:r<0?-1:0},v=Math.sin,y=Math.tan,x=Math.PI,b=x/2,_=x/4,w=Math.SQRT1_2,T=C(2),k=C(x),A=2*x,M=180/x,S=x/180;function E(r){return r>1?b:r<-1?-b:Math.asin(r)}function L(r){return r>1?0:r<-1?x:Math.acos(r)}function C(r){return r>0?Math.sqrt(r):0}function P(r){return(c(r)-c(-r))/2}function I(r){return(c(r)+c(-r))/2}function O(r){var n=y(r/2),i=2*f(l(r/2))/(n*n);function o(r,n){var a=l(r),o=l(n),s=v(n),c=o*a,u=-((1-c?f((1+c)/2)/(1-c):-.5)+i/(1+c));return[u*o*v(r),u*s]}return o.invert=function(n,o){var c,u=C(n*n+o*o),h=-r/2,p=50;if(!u)return[0,0];do{var d=h/2,m=l(d),g=v(d),y=g/m,x=-f(a(m));h-=c=(2/y*x-i*y-u)/(-x/(g*g)+1-i/(2*m*m))*(m<0?.7:1)}while(a(c)>1e-6&&--p>0);var b=v(h);return[s(n*b,u*l(h)),E(o*b/u)]},o}function z(r,n){var i,a=l(n),o=(i=L(a*l(r/=2)))?i/Math.sin(i):1;return[2*a*v(r)*o,v(n)*o]}function D(r){var n=v(r),i=l(r),o=r>=0?1:-1,c=y(o*r),u=(1+n-i)/2;function f(r,a){var f=l(a),h=l(r/=2);return[(1+f)*v(r),(o*a>-s(h,c)-.001?0:-(10*o))+u+v(a)*i-(1+f)*n*h]}return f.invert=function(r,f){var h=0,p=0,d=50;do{var m=l(h),g=v(h),y=l(p),x=v(p),b=1+y,_=b*g-r,w=u+x*i-b*n*m-f,T=b*m/2,k=-g*x,A=n*b*g/2,M=i*y+n*m*x,S=k*A-M*T,E=(w*k-_*M)/S/2,L=(_*A-w*T)/S;a(L)>2&&(L/=2),h-=E,p-=L}while((a(E)>1e-6||a(L)>1e-6)&&--d>0);return o*p>-s(l(h),c)-.001?[2*h,p]:null},f}function R(r,n){var i=y(n/2),a=C(1-i*i),o=1+a*l(r/=2),s=v(r)*a/o,c=i/o,u=s*s,f=c*c;return[4/3*s*(3+u-3*f),4/3*c*(3+3*u-f)]}z.invert=function(r,n){if(!(r*r+4*n*n>x*x+1e-6)){var i=r,o=n,s=25;do{var c,u=v(i),f=v(i/2),h=l(i/2),p=v(o),d=l(o),m=v(2*o),g=p*p,y=d*d,b=f*f,_=1-y*h*h,w=_?L(d*h)*C(c=1/_):c=0,T=2*w*d*f-r,k=w*p-n,A=c*(y*b+w*d*h*g),M=c*(.5*u*m-2*w*p*f),S=.25*c*(m*f-w*p*y*u),E=c*(g*h+w*b*d),P=M*S-E*A;if(!P)break;var I=(k*M-T*E)/P,O=(T*S-k*A)/P;i-=I,o-=O}while((a(I)>1e-6||a(O)>1e-6)&&--s>0);return[i,o]}},R.invert=function(r,n){if(n*=3/8,!(r*=3/8)&&a(n)>1)return null;var i,o,c=1+r*r+n*n,u=C((c-C(c*c-4*n*n))/2),h=E(u)/3,p=u?f((i=a(n/u))+C(i*i-1))/3:f((o=a(r))+C(o*o+1))/3,d=l(h),m=I(p),y=m*m-d*d;return[2*g(r)*s(P(p)*d,.25-y),2*g(n)*s(m*v(h),.25+y)]};var F=C(8),B=f(1+T);function N(r,n){var i=a(n);return i<_?[r,f(y(_+n/2))]:[r*l(i)*(2*T-1/v(i)),g(n)*(2*T*(i-_)-f(y(i/2)))]}function j(r){var i=2*x/r;function c(r,o){var c=n.geoAzimuthalEquidistantRaw(r,o);if(a(r)>b){var u=s(c[1],c[0]),f=C(c[0]*c[0]+c[1]*c[1]),h=i*m((u-b)/i)+b,p=s(v(u-=h),2-l(u));u=h+E(x/f*v(p))-p,c[0]=f*l(u),c[1]=f*v(u)}return c}return c.invert=function(r,a){var c=C(r*r+a*a);if(c>b){var u=s(a,r),f=i*m((u-b)/i)+b,h=u>f?-1:1,p=c*l(f-u),d=1/y(h*L((p-x)/C(x*(x-2*p)+c*c)));r=c*l(u=f+2*o((d+h*C(d*d-3))/3)),a=c*v(u)}return n.geoAzimuthalEquidistantRaw.invert(r,a)},c}function U(r,i){if(arguments.length<2&&(i=r),1===i)return n.geoAzimuthalEqualAreaRaw;if(i===1/0)return V;function a(a,o){var s=n.geoAzimuthalEqualAreaRaw(a/i,o);return s[0]*=r,s}return a.invert=function(a,o){var s=n.geoAzimuthalEqualAreaRaw.invert(a/r,o);return s[0]*=i,s},a}function V(r,n){return[r*l(n)/l(n/=2),2*v(n)]}function H(r,n,i){var o,s,l,c=100;i=void 0===i?0:+i,n=+n;do(s=r(i))===(l=r(i+1e-6))&&(l=s+1e-6),i-=o=-.000001*(s-n)/(s-l);while(c-- >0&&a(o)>1e-6);return c<0?NaN:i}function q(r,n,i){return void 0===n&&(n=40),void 0===i&&(i=1e-12),function(o,s,l,c){var u,f,h;l=void 0===l?0:+l,c=void 0===c?0:+c;for(var p=0;p<n;p++){var d=r(l,c),m=d[0]-o,g=d[1]-s;if(a(m)<i&&a(g)<i)break;var v=m*m+g*g;if(v>u)l-=f/=2,c-=h/=2;else{u=v;var y=(l>0?-1:1)*i,x=(c>0?-1:1)*i,b=r(l+y,c),_=r(l,c+x),w=(b[0]-d[0])/y,T=(b[1]-d[1])/y,k=(_[0]-d[0])/x,A=(_[1]-d[1])/x,M=A*w-T*k,S=(.5>a(M)?.5:1)/M;if(l+=f=(g*k-m*A)*S,c+=h=(m*T-g*w)*S,a(f)<i&&a(h)<i)break}}return[l,c]}}function G(){var r=U(1.68,2);function n(n,i){if(n+i<-1.4){var a=(n-i+1.6)*(n+i+1.4)/8;n+=a,i-=.8*a*v(i+x/2)}var o=r(n,i),s=(1-l(n*i))/12;return o[1]<0&&(o[0]*=1+s),o[1]>0&&(o[1]*=1+s/1.5*o[0]*o[0]),o}return n.invert=q(n),n}function Y(r,n){var i,o=r*v(n),s=30;do n-=i=(n+v(n)-o)/(1+l(n));while(a(i)>1e-6&&--s>0);return n/2}function W(r,n,i){function a(a,o){return[r*a*l(o=Y(i,o)),n*v(o)]}return a.invert=function(a,o){return[a/(r*l(o=E(o/n))),E((2*o+v(2*o))/i)]},a}N.invert=function(r,n){if((s=a(n))<B)return[r,2*o(c(n))-b];var i,s,u=_,h=25;do{var p=l(u/2),d=y(u/2);u-=i=(F*(u-_)-f(d)-s)/(F-p*p/(2*d))}while(a(i)>1e-12&&--h>0);return[r/(l(u)*(F-1/v(u))),g(n)*u]},V.invert=function(r,n){var i=2*E(n/2);return[r*l(i/2)/l(i),i]};var X=W(T/b,T,x);function Z(r,n){var i=Y(x,n);return[2.00276*r/(1/l(n)+1.11072/l(i)),(n+T*v(i))/2.00276]}function J(r){var i=0,a=n.geoProjectionMutator(r),o=a(i);return o.parallel=function(r){return arguments.length?a(i=r*S):i*M},o}function K(r,n){return[r*l(n),n]}function Q(r){if(!r)return K;var n=1/y(r);function i(i,a){var o=n+r-a,s=o?i*l(a)/o:o;return[o*v(s),n-o*l(s)]}return i.invert=function(i,a){var o=C(i*i+(a=n-a)*a),c=n+r-o;return[o/l(c)*s(i,a),c]},i}function $(r){function n(n,i){var a=b-i,o=a?n*r*v(a)/a:a;return[a*v(o)/r,b-a*l(o)]}return n.invert=function(n,i){var a=n*r,o=b-i,l=C(a*a+o*o),c=s(a,o);return[(l?l/v(l):1)*c/r,b-l]},n}Z.invert=function(r,n){var i,o,s=2.00276*n,c=n<0?-_:_,u=25;do o=s-T*v(c),c-=i=(v(2*c)+2*c-x*v(o))/(2*l(2*c)+2+x*l(o)*T*l(c));while(a(i)>1e-6&&--u>0);return[r*(1/l(o=s-T*v(c))+1.11072/l(c))/2.00276,o]},K.invert=function(r,n){return[r/l(n),n]};var tt=W(1,4/x,x);function te(r,n,i,o,c,u){var f,h=l(u);if(a(r)>1||a(u)>1)f=L(i*c+n*o*h);else{var p=v(r/2),d=v(u/2);f=2*E(C(p*p+n*o*d*d))}return a(f)>1e-6?[f,s(o*v(u),n*c-i*o*h)]:[0,0]}function tr(r,n,i){return L((r*r+n*n-i*i)/(2*r*n))}function tn(r,n,i){for(var a,o=[[r[0],r[1],v(r[1]),l(r[1])],[n[0],n[1],v(n[1]),l(n[1])],[i[0],i[1],v(i[1]),l(i[1])]],s=o[2],c=0;c<3;++c,s=a)a=o[c],s.v=te(a[1]-s[1],s[3],s[2],a[3],a[2],a[0]-s[0]),s.point=[0,0];var f=tr(o[0].v[0],o[2].v[0],o[1].v[0]),h=tr(o[0].v[0],o[1].v[0],o[2].v[0]),p=x-f;o[2].point[1]=0,o[0].point[0]=-(o[1].point[0]=o[0].v[0]/2);var d=[o[2].point[0]=o[0].point[0]+o[2].v[0]*l(f),2*(o[0].point[1]=o[1].point[1]=o[2].v[0]*v(f))];return function(r,n){var i,a=v(n),s=l(n),c=[,,,];for(i=0;i<3;++i){var f,m=o[i];if(c[i]=te(n-m[1],m[3],m[2],s,a,r-m[0]),!c[i][0])return m.point;c[i][1]=(f=c[i][1]-m.v[1])-2*x*u((f+x)/(2*x))}var g=d.slice();for(i=0;i<3;++i){var y=2==i?0:i+1,b=tr(o[i].v[0],c[i][0],c[y][0]);c[i][1]<0&&(b=-b),i?1==i?(b=h-b,g[0]-=c[i][0]*l(b),g[1]-=c[i][0]*v(b)):(b=p-b,g[0]+=c[i][0]*l(b),g[1]+=c[i][0]*v(b)):(g[0]+=c[i][0]*l(b),g[1]-=c[i][0]*v(b))}return g[0]/=3,g[1]/=3,g}}function ti(r){return r[0]*=S,r[1]*=S,r}function ta(r,i,a){var o=n.geoCentroid({type:"MultiPoint",coordinates:[r,i,a]}),s=[-o[0],-o[1]],l=n.geoRotation(s),c=tn(ti(l(r)),ti(l(i)),ti(l(a)));c.invert=q(c);var u=n.geoProjection(c).rotate(s),f=u.center;return delete u.rotate,u.center=function(r){return arguments.length?f(l(r)):l.invert(f())},u.clipAngle(90)}function to(r,n){var i=C(1-v(n));return[2/k*r*i,k*(1-i)]}function ts(r){var n=y(r);function i(r,i){return[r,(r?r/v(r):1)*(v(i)*l(r)-n*l(i))]}return i.invert=n?function(r,i){r&&(i*=v(r)/r);var a=l(r);return[r,2*s(C(a*a+n*n-i*i)-a,n-i)]}:function(r,n){return[r,E(r?n*y(r)/r:n)]},i}to.invert=function(r,n){var i=(i=n/k-1)*i;return[i>0?r*C(x/i)/2:0,E(1-i)]};var tl=C(3);function tc(r,n){return[tl*r*(2*l(2*n/3)-1)/k,tl*k*v(n/3)]}function tu(r){var n=l(r);function i(r,i){return[r*n,v(i)/n]}return i.invert=function(r,i){return[r/n,E(i*n)]},i}function tf(r){var n=l(r);function i(r,i){return[r*n,(1+n)*y(i/2)]}return i.invert=function(r,i){return[r/n,2*o(i/(1+n))]},i}function th(r,n){var i=C(8/(3*x));return[i*r*(1-a(n)/x),i*n]}function tp(r,n){var i=C(4-3*v(a(n)));return[2/C(6*x)*r*i,g(n)*C(2*x/3)*(2-i)]}function td(r,n){var i=C(x*(4+x));return[2/i*r*(1+C(1-4*n*n/(x*x))),4/i*n]}function tm(r,n){var i=(2+b)*v(n);n/=2;for(var o=0,s=1/0;o<10&&a(s)>1e-6;o++){var c=l(n);n-=s=(n+v(n)*(c+2)-i)/(2*c*(1+c))}return[2/C(x*(4+x))*r*(1+l(n)),2*C(x/(4+x))*v(n)]}function tg(r,n){return[r*(1+l(n))/C(2+x),2*n/C(2+x)]}function tv(r,n){for(var i=(1+b)*v(n),o=0,s=1/0;o<10&&a(s)>1e-6;o++)n-=s=(n+v(n)-i)/(1+l(n));return i=C(2+x),[r*(1+l(n))/i,2*n/i]}tc.invert=function(r,n){var i=3*E(n/(tl*k));return[k*r/(tl*(2*l(2*i/3)-1)),i]},th.invert=function(r,n){var i=C(8/(3*x)),o=n/i;return[r/(i*(1-a(o)/x)),o]},tp.invert=function(r,n){var i=2-a(n)/C(2*x/3);return[r*C(6*x)/(2*i),g(n)*E((4-i*i)/3)]},td.invert=function(r,n){var i=C(x*(4+x))/2;return[r*i/(1+C(1-n*n*(4+x)/(4*x))),n*i/2]},tm.invert=function(r,n){var i=n*C((4+x)/x)/2,a=E(i),o=l(a);return[r/(2/C(x*(4+x))*(1+o)),E((a+i*(o+2))/(2+b))]},tg.invert=function(r,n){var i=C(2+x),a=n*i/2;return[i*r/(1+l(a)),a]},tv.invert=function(r,n){var i=1+b,a=C(i/2);return[2*r*a/(1+l(n*=a)),E((n+v(n))/i)]};var ty=3+2*T;function tx(r,n){var i=v(r/=2),a=l(r),s=C(l(n)),c=l(n/=2),u=v(n)/(c+T*a*s),h=C(2/(1+u*u)),p=C((T*c+(a+i)*s)/(T*c+(a-i)*s));return[ty*(h*(p-1/p)-2*f(p)),ty*(h*u*(p+1/p)-2*o(u))]}tx.invert=function(r,n){if(!(i=R.invert(r/1.2,1.065*n)))return null;var i,s=i[0],c=i[1],u=20;r/=ty,n/=ty;do{var d=s/2,m=c/2,g=v(d),y=l(d),x=v(m),_=l(m),k=l(c),A=C(k),M=x/(_+T*y*A),S=M*M,E=C(2/(1+S)),L=(T*_+(y+g)*A)/(T*_+(y-g)*A),P=C(L),I=P-1/P,O=P+1/P,z=E*I-2*f(P)-r,D=E*M*O-2*o(M)-n,F=x&&w*A*g*S/x,B=(T*y*_+A)/(2*(_+T*y*A)*(_+T*y*A)*A),N=-.5*M*E*E*E,j=N*F,U=N*B,V=(V=2*_+T*A*(y-g))*V*P,H=(T*y*_*A+k)/V,q=-T*g*x/(A*V),G=I*j-2*H/P+E*(H+H/L),Y=I*U-2*q/P+E*(q+q/L),W=M*O*j-2*F/(1+S)+E*O*F+E*M*(H-H/L),X=M*O*U-2*B/(1+S)+E*O*B+E*M*(q-q/L),Z=Y*W-X*G;if(!Z)break;var J=(D*Y-z*X)/Z,K=(z*W-D*G)/Z;s-=J,c=h(-b,p(b,c-K))}while((a(J)>1e-6||a(K)>1e-6)&&--u>0);return 1e-6>a(a(c)-b)?[0,c]:u&&[s,c]};var tb=l(35*S);function t_(r,n){var i=y(n/2);return[r*tb*C(1-i*i),(1+tb)*i]}function tw(r,n){var i=n/2,a=l(i);return[2*r/k*l(n)*a*a,k*y(i)]}function tT(r){var n=1-r,i=o(x,0)[0]-o(-x,0)[0],a=C(2*(o(0,b)[1]-o(0,-b)[1])/i);function o(i,a){var o=l(a),s=v(a);return[o/(n+r*o)*i,n*a+r*s]}function s(r,n){var i=o(r,n);return[i[0]*a,i[1]/a]}function c(r){return s(0,r)[1]}return s.invert=function(i,o){var s=H(c,o);return[i/a*(r+n/l(s)),s]},s}function tk(r){return[r[0]/2,E(y(r[1]/2*S))*M]}function tA(r){return[2*r[0],2*o(v(r[1]*S))*M]}function tM(r,i){var o=2*x/i,c=r*r;function u(i,u){var f=n.geoAzimuthalEquidistantRaw(i,u),h=f[0],p=f[1],d=h*h+p*p;if(d>c){var g=C(d),y=s(p,h),_=o*m(y/o),w=y-_,T=r*l(w),k=(r*v(w)-w*v(T))/(b-T),A=tS(w,k),M=(x-r)/tE(A,T,x);h=g;var S,E=50;do h-=S=(r+tE(A,T,h)*M-g)/(A(h)*M);while(a(S)>1e-6&&--E>0);p=w*v(h),h<b&&(p-=k*(h-b));var L=v(_),P=l(_);f[0]=h*P-p*L,f[1]=h*L+p*P}return f}return u.invert=function(i,u){var f=i*i+u*u;if(f>c){var h=C(f),p=s(u,i),d=o*m(p/o),g=p-d;i=h*l(g),u=h*v(g);for(var y=i-b,_=v(i),w=u/_,T=i<b?1/0:0,k=10;;){var A=r*v(w),M=r*l(w),S=v(M),E=b-M,L=(A-w*S)/E,P=tS(w,L);if(1e-12>a(T)||!--k)break;w-=T=(w*_-L*y-u)/(_-2*y*(E*(M+w*A*l(M)-S)-A*(A-w*S))/(E*E))}i=(h=r+tE(P,M,i)*(x-r)/tE(P,M,x))*l(p=d+w),u=h*v(p)}return n.geoAzimuthalEquidistantRaw.invert(i,u)},u}function tS(r,n){return function(i){var a=r*l(i);return i<b&&(a-=n),C(1+a*a)}}function tE(r,n,i){for(var a=(i-n)/50,o=r(n)+r(i),s=1,l=n;s<50;++s)o+=2*r(l+=a);return .5*o*a}function tL(r,n,i,o,s,c,u,f){function h(a,h){if(!h)return[r*a/x,0];var p=h*h,d=r+p*(n+p*(i+p*o)),m=h*(s-1+p*(c-f+p*u)),g=(d*d+m*m)/(2*m),y=a*E(d/g)/x;return[g*v(y),h*(1+p*f)+g*(1-l(y))]}return arguments.length<8&&(f=0),h.invert=function(h,p){var d,m,g=x*h/r,y=p,b=50;do{var _=y*y,w=r+_*(n+_*(i+_*o)),T=y*(s-1+_*(c-f+_*u)),k=w*w+T*T,A=2*T,M=k/A,S=M*M,L=E(w/M)/x,P=g*L,I=w*w,O=(2*n+_*(4*i+6*_*o))*y,z=s+_*(3*c+5*_*u),D=(2*(w*O+T*(z-1))*A-2*(z-1)*k)/(A*A),R=l(P),F=v(P),B=M*R,N=M*F,j=g/x*(1/C(1-I/S))*(O*M-w*D)/S,U=N-h,V=y*(1+_*f)+M-B-p,H=D*F+B*j,q=B*L,G=1+D-(D*R-N*j),Y=N*L,W=H*Y-G*q;if(!W)break;g-=d=(V*H-U*G)/W,y-=m=(U*Y-V*q)/W}while((a(d)>1e-6||a(m)>1e-6)&&--b>0);return[g,y]},h}t_.invert=function(r,n){var i=n/(1+tb);return[r&&r/(tb*C(1-i*i)),2*o(i)]},tw.invert=function(r,n){var i=o(n/k),a=l(i),s=2*i;return[r*k/2/(l(s)*a*a),s]};var tC=tL(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),tP=tL(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),tI=tL(5/6*x,-.62636,-.0344,0,1.3493,-.05524,0,.045);function tO(r,n){var i=r*r,a=n*n;return[r*(1-.162388*a)*(.87-952426e-9*i*i),n*(1+a/12)]}tO.invert=function(r,n){var i,o=r,s=n,l=50;do{var c=s*s;s-=i=(s*(1+c/12)-n)/(1+c/4)}while(a(i)>1e-6&&--l>0);l=50,r/=1-.162388*c;do{var u=(u=o*o)*u;o-=i=(o*(.87-952426e-9*u)-r)/(.87-.00476213*u)}while(a(i)>1e-6&&--l>0);return[o,s]};var tz=tL(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function tD(r){var n=r(b,0)[0]-r(-b,0)[0];function i(i,a){var o=i>0?-.5:.5,s=r(i+o*x,a);return s[0]-=o*n,s}return r.invert&&(i.invert=function(i,a){var o=i>0?-.5:.5,s=r.invert(i+o*n,a),l=s[0]-o*x;return l<-x?l+=2*x:l>x&&(l-=2*x),s[0]=l,s}),i}function tR(r,n){var i=g(r),o=g(n),c=l(n),u=l(r)*c,f=v(r)*c,h=v(o*n);r=a(s(f,h)),n=E(u),a(r-b)>1e-6&&(r%=b);var p=function(r,n){if(n===b)return[0,0];var i,o,s=v(n),c=s*s,u=c*c,f=1+u,h=1+3*u,p=1-u,d=E(1/C(f)),m=p+c*f*d,g=(1-s)/m,y=C(g),_=g*f,w=C(_),T=y*p;if(0===r)return[0,-(T+c*w)];var k,A=l(n),M=1/A,S=2*s*A,L=(-m*A-(-3*c+d*h)*S*(1-s))/(m*m),P=-M*S,I=-M*(c*f*L+g*h*S),O=-2*M*(.5*L/y*p-2*c*y*S),z=4*r/x;if(r>.222*x||n<x/4&&r>.175*x){if(i=(T+c*C(_*(1+u)-T*T))/(1+u),r>x/4)return[i,i];var D=i,R=.5*i;i=.5*(R+D),o=50;do{var F=C(_-i*i),B=i*(O+P*F)+I*E(i/w)-z;if(!B)break;B<0?R=i:D=i,i=.5*(R+D)}while(a(D-R)>1e-6&&--o>0)}else{i=1e-6,o=25;do{var N=i*i,j=C(_-N),U=O+P*j,V=i*U+I*E(i/w)-z,H=U+(I-P*N)/j;i-=k=j?V/H:0}while(a(k)>1e-6&&--o>0)}return[i,-T-c*C(_-i*i)]}(r>x/4?b-r:r,n);return r>x/4&&(h=p[0],p[0]=-p[1],p[1]=-h),p[0]*=i,p[1]*=-o,p}function tF(r,n){if(n<1e-6)return[(f=v(r))-(i=n*(r-f*(s=l(r)))/4)*s,s+i*f,1-n*f*f/2,r-i];if(n>=.999999)return i=(1-n)/4,u=1/(s=I(r)),[(f=((p=c(2*(p=r)))-1)/(p+1))+i*((h=s*P(r))-r)/(s*s),u-i*f*u*(h-r),u+i*f*u*(h+r),2*o(c(r))-b+i*(h-r)/s];var i,s,u,f,h,p,d=[1,0,0,0,0,0,0,0,0],m=[C(n),0,0,0,0,0,0,0,0],g=0;for(s=C(1-n),h=1;a(m[g]/d[g])>1e-6&&g<8;)i=d[g++],m[g]=(i-s)/2,d[g]=(i+s)/2,s=C(i*s),h*=2;u=h*d[g]*r;do u=(E(f=m[g]*v(s=u)/d[g])+u)/2;while(--g);return[v(u),f=l(u),f/l(u-s),u]}function tB(r,n){if(!n)return r;if(1===n)return f(y(r/2+_));for(var i=1,s=C(1-n),l=C(n),c=0;a(l)>1e-6;c++){if(r%x){var u=o(s*y(r)/i);u<0&&(u+=x),r+=u+~~(r/x)*x}else r+=r;l=(i+s)/2,s=C(i*s),l=((i=l)-s)/2}return r/(d(2,c)*i)}function tN(r,n){var i,u,h,p,d,m=(T-1)/(T+1),_=C(1-m*m),w=tB(b,_*_),k=c(-1*f(y(x/4+a(n)/2)))/C(m),A=(i=k*l(-1*r),u=k*v(-1*r),h=i*i,p=u+1,[.5*((i>=0?b:-b)-s(d=1-h-u*u,2*i)),-.25*f(d*d+4*h)+.5*f(p*p+h)]),M=function(r,n,i){var s=a(r),l=P(a(n));if(s){var c=1/v(s),u=1/(y(s)*y(s)),f=-(u+l*l*c*c*i-1+i),h=(-f+C(f*f-(i-1)*u*4))/2;return[tB(o(1/C(h)),i)*g(r),tB(o(C((h/u-1)/i)),1-i)*g(n)]}return[0,tB(o(l),1-i)*g(n)]}(A[0],A[1],_*_);return[-M[1],(n>=0?1:-1)*(.5*w-M[0])]}function tj(r){var n=v(r),i=l(r),o=tU(r);function c(r,s){var c=o(r,s);r=c[0];var u=v(s=c[1]),f=l(s),h=l(r),p=L(n*u+i*f*h),d=v(p),m=a(d)>1e-6?p/d:1;return[m*i*v(r),(a(r)>b?m:-m)*(n*f-i*u*h)]}return o.invert=tU(-r),c.invert=function(r,i){var a=C(r*r+i*i),c=-v(a),u=l(a),f=a*u,h=-i*c,p=a*n,d=C(f*f+h*h-p*p),m=s(f*p+h*d,h*p-f*d),g=(a>b?-1:1)*s(r*c,a*l(m)*u+i*v(m)*c);return o.invert(g,m)},c}function tU(r){var n=v(r),i=l(r);return function(r,a){var o=l(a),c=l(r)*o,u=v(r)*o,f=v(a);return[s(u,c*i-f*n),E(f*i+c*n)]}}tR.invert=function(r,n){a(r)>1&&(r=2*g(r)-r),a(n)>1&&(n=2*g(n)-n);var i=g(r),o=g(n),c=-i*r,u=-o*n,f=u/c<1,h=function(r,n){for(var i=0,o=1,s=.5,c=50;;){var u=s*s,f=C(s),h=E(1/C(1+u)),p=1-u+s*(1+u)*h,d=(1-f)/p,m=C(d),g=d*(1+u),v=m*(1-u),y=C(g-r*r),b=n+v+s*y;if(1e-12>a(o-i)||0==--c||0===b)break;b>0?i=s:o=s,s=.5*(i+o)}if(!c)return null;var _=E(f),w=l(_),T=1/w,k=2*f*w,A=(-p*w-(-3*s+h*(1+3*u))*k*(1-f))/(p*p);return[x/4*(r*(-2*T*(.5*A/m*(1-u)-2*s*m*k)+-T*k*y)+-T*(s*(1+u)*A+d*(1+3*u)*k)*E(r/C(g))),_]}(f?u:c,f?c:u),p=h[0],d=h[1],m=l(d);return f&&(p=-b-p),[i*(s(v(p)*m,-v(d))+x),o*E(l(p)*m)]},tN.invert=function(r,n){var i,a,l,u,h,p,d,m,g,v=(T-1)/(T+1),y=C(1-v*v),x=tB(b,y*y),_=(h=-r,p=y*y,(u=.5*x-n)?(d=tF(u,p),h?(g=(m=tF(h,1-p))[1]*m[1]+p*d[0]*d[0]*m[0]*m[0],[[d[0]*m[2]/g,d[1]*d[2]*m[0]*m[1]/g],[d[1]*m[1]/g,-d[0]*d[2]*m[0]*m[2]/g],[d[2]*m[1]*m[2]/g,-p*d[0]*d[1]*m[0]/g]]):[[d[0],0],[d[1],0],[d[2],0]]):[[0,(m=tF(h,1-p))[0]/m[1]],[1/m[1],0],[m[2]/m[1],0]]),w=(i=_[0],l=(a=_[1])[0]*a[0]+a[1]*a[1],[(i[0]*a[0]+i[1]*a[1])/l,(i[1]*a[0]-i[0]*a[1])/l]);return[-(s(w[1],w[0])/1),2*o(c(-.5*f(v*w[0]*w[0]+v*w[1]*w[1])))-b]};var tV=E(1-1/3)*M,tH=tu(0);function tq(r){var n=tV*S,i=to(x,n)[0]-to(-x,n)[0],o=tH(0,n)[1],s=to(0,n)[1],l=k-s,c=A/r,f=4/A,d=o+l*l*4/A;function m(m,g){var v,y=a(g);if(y>n){var b=p(r-1,h(0,u((m+x)/c)));(v=to(m+=x*(r-1)/r-b*c,y))[0]=v[0]*A/i-A*(r-1)/(2*r)+b*A/r,v[1]=o+4*(v[1]-s)*l/A,g<0&&(v[1]=-v[1])}else v=tH(m,g);return v[0]*=f,v[1]/=d,v}return m.invert=function(n,m){n/=f;var g=a(m*=d);if(g>o){var v=p(r-1,h(0,u((n+x)/c)));n=(n+x*(r-1)/r-v*c)*i/A;var y=to.invert(n,.25*(g-o)*A/l+s);return y[0]-=x*(r-1)/r-v*c,m<0&&(y[1]=-y[1]),y}return tH.invert(n,m)},m}function tG(r,n){return[r,1&n?89.999999:tV]}function tY(r,n){return[r,1&n?-89.999999:-tV]}function tW(r){return[.999999*r[0],r[1]]}function tX(r){var n,i=1+r,o=E(v(1/i)),c=2*C(x/(n=x+4*o*i)),u=.5*c*(i+C(r*(2+r))),f=r*r,h=i*i;function p(p,d){var m,g,y=1-v(d);if(y&&y<2){var _,w=b-d,T=25;do{var k=v(w),A=l(w),M=o+s(k,i-A),S=1+h-2*i*A;w-=_=(w-f*o-i*k+S*M-.5*y*n)/(2*i*k*M)}while(a(_)>1e-12&&--T>0);m=c*C(S),g=p*M/x}else m=c*(r+y),g=p*o/x;return[m*v(g),u-m*l(g)]}return p.invert=function(r,a){var l=r*r+(a-=u)*a,p=(1+h-l/(c*c))/(2*i),d=L(p),m=v(d),g=o+s(m,i-p);return[E(r/C(l))*x/g,E(1-2*(d-f*o-i*m+(1+h-2*i*p)*g)/n)]},p}function tZ(r,n){return n>-.7109889596207567?((r=X(r,n))[1]+=.0528035274542,r):K(r,n)}function tJ(r,n){return a(n)>.7109889596207567?((r=X(r,n))[1]-=n>0?.0528035274542:-.0528035274542,r):K(r,n)}function tK(r,n,i,a){var o=C(4*x/(2*i+(1+r-n/2)*v(2*i)+(r+n)/2*v(4*i)+n/2*v(6*i))),s=C(a*v(i)*C((1+r*l(2*i)+n*l(4*i))/(1+r+n))),c=i*f(1);function u(i){return C(1+r*l(2*i)+n*l(4*i))}function f(a){var o=a*i;return(2*o+(1+r-n/2)*v(2*o)+(r+n)/2*v(4*o)+n/2*v(6*o))/i}function h(r){return u(r)*v(r)}var p=function(r,n){var a=i*H(f,c*v(n)/i,n/x);isNaN(a)&&(a=i*g(n));var h=o*u(a);return[h*s*r/x*l(a),h/s*v(a)]};return p.invert=function(r,n){var a=H(h,n*s/o);return[r*x/(l(a)*o*s*u(a)),E(i*f(a/i)/c)]},0===i&&(o=C(a/x),(p=function(r,n){return[r*o,v(n)/o]}).invert=function(r,n){return[r/o,E(n*o)]}),p}function tQ(r,n,i){function o(i){return r+(1-r)*d(1-d(i,n),1/n)}function s(r){var n,i,a,s;return void 0===n&&(n=20),i=o(0),a=o(.5*(0+r)),s=o(r),function r(n,i,a,o,s,l,c,u,f,h,p){var d,m,g,v,y,x,b,_,w,T;if(p.nanEncountered)return NaN;if(m=n(i+.25*(d=a-i)),g=n(a-.25*d),isNaN(m))p.nanEncountered=!0;else{if(!isNaN(g))return T=((x=(v=d*(o+4*m+s)/12)+(y=d*(s+4*g+l)/12))-c)/15,h>f?(p.maxDepthCount++,x+T):Math.abs(T)<u?x+T:isNaN(_=r(n,i,b=i+.5*d,o,m,s,v,.5*u,f,h+1,p))?(p.nanEncountered=!0,NaN):isNaN(w=r(n,b,a,s,g,l,y,.5*u,f,h+1,p))?(p.nanEncountered=!0,NaN):_+w;p.nanEncountered=!0}}(o,0,r,i,a,s,(i+4*a+s)*(r-0)/6,1e-4,n,1,{maxDepthCount:0,nanEncountered:!1})}for(var l=1/s(1),c=(1+1e-8)*l,u=[],f=0;f<=1e3;f++)u.push(s(f/1e3)*c);function h(r){var n=0,i=1e3,a=500;do u[a]>r?i=a:n=a,a=n+i>>1;while(a>n);var o=u[a+1]-u[a];return o&&(o=(r-u[a+1])/o),(a+1+o)/1e3}var p=2*h(1)/x*l/i,m=function(r,n){var i=h(a(v(n))),s=o(i)*r;return i/=p,[s,n>=0?i:-i]};return m.invert=function(r,n){var i;return 1>a(n*=p)&&(i=g(n)*E(s(a(n))*l)),[r/o(a(n)),i]},m}function t$(r,n){for(var i,a,o,s=-1,l=r.length,c=r[0],u=[];++s<l;){a=((i=r[s])[0]-c[0])/n,o=(i[1]-c[1])/n;for(var f=0;f<n;++f)u.push([c[0]+f*a,c[1]+f*o]);c=i}return u.push(i),u}function t0(r,o,s){function l(n,i){for(var a=i<0?-1:1,s=o[+(i<0)],l=0,c=s.length-1;l<c&&n>s[l][2][0];++l);var u=r(n-s[l][1][0],i);return u[0]+=r(s[l][1][0],a*i>a*s[l][0][1]?s[l][0][1]:i)[0],u}s?l.invert=s(l):r.invert&&(l.invert=function(n,i){for(var s=u[+(i<0)],c=o[+(i<0)],f=0,h=s.length;f<h;++f){var p=s[f];if(p[0][0]<=n&&n<p[1][0]&&p[0][1]<=i&&i<p[1][1]){var d,m,g=r.invert(n-r(c[f][1][0],0)[0],i);return g[0]+=c[f][1][0],(d=l(g[0],g[1]),m=[n,i],1e-6>a(d[0]-m[0])&&1e-6>a(d[1]-m[1]))?g:null}}});var c,u,f=n.geoProjection(l),h=f.stream;return f.stream=function(r){var i=f.rotate(),a=h(r),o=(f.rotate([0,0]),h(r));return f.rotate(i),a.sphere=function(){n.geoStream(c,o)},a},f.lobes=function(n){return arguments.length?(c=function(r){var n,a,o,s,l,c,u,f=[],h=r[0].length;for(u=0;u<h;++u)a=(n=r[0][u])[0][0],o=n[0][1],s=n[1][1],l=n[2][0],c=n[2][1],f.push(t$([[a+1e-6,o+1e-6],[a+1e-6,s-1e-6],[l-1e-6,s-1e-6],[l-1e-6,c+1e-6]],30));for(u=r[1].length-1;u>=0;--u)a=(n=r[1][u])[0][0],o=n[0][1],s=n[1][1],l=n[2][0],c=n[2][1],f.push(t$([[l-1e-6,c-1e-6],[l-1e-6,s+1e-6],[a+1e-6,s+1e-6],[a+1e-6,o-1e-6]],30));return{type:"Polygon",coordinates:[i.merge(f)]}}(n),u=(o=n.map(function(r){return r.map(function(r){return[[r[0][0]*S,r[0][1]*S],[r[1][0]*S,r[1][1]*S],[r[2][0]*S,r[2][1]*S]]})})).map(function(n){return n.map(function(n){var i,a=r(n[0][0],n[0][1])[0],o=r(n[2][0],n[2][1])[0],s=r(n[1][0],n[0][1])[1],l=r(n[1][0],n[1][1])[1];return s>l&&(i=s,s=l,l=i),[[a,s],[o,l]]})}),f):o.map(function(r){return r.map(function(r){return[[r[0][0]*M,r[0][1]*M],[r[1][0]*M,r[1][1]*M],[r[2][0]*M,r[2][1]*M]]})})},null!=o&&f.lobes(o),f}tZ.invert=function(r,n){return n>-.7109889596207567?X.invert(r,n-.0528035274542):K.invert(r,n)},tJ.invert=function(r,n){return a(n)>.7109889596207567?X.invert(r,n+(n>0?.0528035274542:-.0528035274542)):K.invert(r,n)};var t1=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],t2=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],t3=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],t5=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],t4=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],t6=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function t8(r,n){return[3/A*r*C(x*x/3-n*n),n]}function t9(r){function n(n,i){if(1e-6>a(a(i)-b))return[0,i<0?-2:2];var o=v(i),s=d((1+o)/(1-o),r/2),c=.5*(s+1/s)+l(n*=r);return[2*v(n)/c,(s-1/s)/c]}return n.invert=function(n,i){var o=a(i);if(1e-6>a(o-2))return n?null:[0,g(i)*b];if(o>2)return null;var l=(n/=2)*n,c=(i/=2)*i,u=2*i/(1+l+c);return u=d((1+u)/(1-u),1/r),[s(2*n,1-l-c)/r,E((u-1)/(u+1))]},n}t8.invert=function(r,n){return[A/3*r/C(x*x/3-n*n),n]};var t7=x/T;function et(r,n){return[r*(1+C(l(n)))/2,n/(l(n/2)*l(r/6))]}function ee(r,n){var i=r*r,a=n*n;return[r*(.975534+a*(-.0143059*i-.119161+-.0547009*a)),n*(1.00384+i*(.0802894+-.02855*a+199025e-9*i)+a*(.0998909+-.0491032*a))]}function er(r,n){return[v(r)/l(n),y(n)*l(r)]}function en(r){var n=l(r),i=y(_+r/2);function o(o,s){var l=s-r,c=1e-6>a(l)?o*n:1e-6>a(c=_+s/2)||1e-6>a(a(c)-b)?0:o*l/f(y(c)/i);return[c,l]}return o.invert=function(o,s){var l,c=s+r;return[1e-6>a(s)?o/n:1e-6>a(l=_+c/2)||1e-6>a(a(l)-b)?0:o*f(y(l)/i)/s,c]},o}function ei(r,n){return[r,1.25*f(y(_+.4*n))]}function ea(r){var n=r.length-1;function i(i,a){for(var o,s=l(a),c=2/(1+s*l(i)),u=c*s*v(i),f=c*v(a),h=n,p=r[h],d=p[0],m=p[1];--h>=0;)d=(p=r[h])[0]+u*(o=d)-f*m,m=p[1]+u*m+f*o;return[d=u*(o=d)-f*m,m=u*m+f*o]}return i.invert=function(i,c){var u=20,f=i,h=c;do{for(var p,d=n,m=r[d],g=m[0],y=m[1],x=0,b=0;--d>=0;)x=g+f*(p=x)-h*b,b=y+f*b+h*p,g=(m=r[d])[0]+f*(p=g)-h*y,y=m[1]+f*y+h*p;var _,w,T=(x=g+f*(p=x)-h*b)*x+(b=y+f*b+h*p)*b;f-=_=((g=f*(p=g)-h*y-i)*x+(y=f*y+h*p-c)*b)/T,h-=w=(y*x-g*b)/T}while(a(_)+a(w)>1e-12&&--u>0);if(u){var k=C(f*f+h*h),A=2*o(.5*k),M=v(A);return[s(f*M,k*l(A)),k?E(h*M/k):0]}},i}et.invert=function(r,n){var i=a(r),o=a(n),s=1e-6,c=b;o<t7?c*=o/t7:s+=6*L(t7/o);for(var u=0;u<25;u++){var f=v(c),h=C(l(c)),p=v(c/2),d=l(c/2),m=v(s/6),g=l(s/6),y=.5*s*(1+h)-i,x=c/(d*g)-o,_=h?-.25*s*f/h:0,w=.5*(1+h),T=(1+.5*c*p/d)/(d*g),k=c/d*(m/6)/(g*g),A=_*k-T*w,M=(y*k-x*w)/A,S=(x*_-y*T)/A;if(c-=M,s-=S,1e-6>a(M)&&1e-6>a(S))break}return[r<0?-s:s,n<0?-c:c]},ee.invert=function(r,n){var i=g(r)*x,o=n/2,s=50;do{var l=i*i,c=o*o,u=i*o,f=i*(.975534+c*(-.0143059*l-.119161+-.0547009*c))-r,h=o*(1.00384+l*(.0802894+-.02855*c+199025e-9*l)+c*(.0998909+-.0491032*c))-n,p=.975534-c*(.119161+3*l*.0143059+.0547009*c),d=-u*(.238322+.2188036*c+.0286118*l),m=u*(.1605788+7961e-7*l+-.0571*c),v=1.00384+l*(.0802894+199025e-9*l)+c*(3*(.0998909-.02855*l)-.245516*c),y=d*m-v*p,b=(h*d-f*v)/y,_=(f*m-h*p)/y;i-=b,o-=_}while((a(b)>1e-6||a(_)>1e-6)&&--s>0);return s&&[i,o]},er.invert=function(r,n){var i=r*r,a=n*n+1,o=i+a,s=r?w*C((o-C(o*o-4*i))/i):1/C(a);return[E(r*s),g(n)*L(s)]},ei.invert=function(r,n){return[r,2.5*o(c(.8*n))-.625*x]};var eo=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],es=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],el=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],ec=[[.9245,0],[0,0],[.01943,0]],eu=[[.721316,0],[0,0],[-.00881625,-.00617325]];function ef(r,i){var a=n.geoProjection(ea(r)).rotate(i).clipAngle(90),o=n.geoRotation(i),s=a.center;return delete a.rotate,a.center=function(r){return arguments.length?s(o(r)):o.invert(s())},a}var eh=C(6),ep=C(7);function ed(r,n){var i=E(7*v(n)/(3*eh));return[eh*r*(2*l(2*i/3)-1)/ep,9*v(i/3)/ep]}function em(r,n){for(var i,o=(1+w)*v(n),s=n,c=0;c<25&&(s-=i=(v(s/2)+v(s)-o)/(.5*l(s/2)+l(s)),!(1e-6>a(i)));c++);return[r*(1+2*l(s)/l(s/2))/(3*T),2*C(3)*v(s/2)/C(2+T)]}function eg(r,n){for(var i,o=C(6/(4+x)),s=(1+x/4)*v(n),c=n/2,u=0;u<25&&(c-=i=(c/2+v(c)-s)/(.5+l(c)),!(1e-6>a(i)));u++);return[o*(.5+l(c))*r/1.5,o*c]}function ev(r,n){var i=n*n,a=i*i,o=i*a;return[r*(.84719-.13063*i+o*o*(.05494*i-.04515-.02326*a+.00331*o)),n*(1.01183+a*a*(.01926*i-.02625-.00396*a))]}function ey(r,n){return[r*(1+l(n))/2,2*(n-y(n/2))]}ed.invert=function(r,n){var i=3*E(n*ep/9);return[r*ep/(eh*(2*l(2*i/3)-1)),E(3*v(i)*eh/7)]},em.invert=function(r,n){var i=n*C(2+T)/(2*C(3)),a=2*E(i);return[3*T*r/(1+2*l(a)/l(a/2)),E((i+v(a))/(1+w))]},eg.invert=function(r,n){var i=C(6/(4+x)),o=n/i;return 1e-6>a(a(o)-b)&&(o=o<0?-b:b),[1.5*r/(i*(.5+l(o))),E((o/2+v(o))/(1+x/4))]},ev.invert=function(r,n){var i,o,s,l,c=n,u=25;do c-=i=(c*(1.01183+(s=(o=c*c)*o)*s*(.01926*o-.02625-.00396*s))-n)/(1.01183+s*s*(.21186*o-.23625+-.05148*s));while(a(i)>1e-12&&--u>0);return[r/(.84719-.13063*(o=c*c)+(l=o*(s=o*o))*l*(.05494*o-.04515-.02326*s+.00331*l)),c]},ey.invert=function(r,n){for(var i=n/2,o=0,s=1/0;o<10&&a(s)>1e-6;++o){var c=l(n/2);n-=s=(n-y(n/2)-i)/(1-.5/(c*c))}return[2*r/(1+l(n)),n]};var ex=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function eb(r,n){var i=v(n),o=l(n),s=g(r);if(0===r||a(n)===b)return[0,n];if(0===n)return[r,0];if(a(r)===b)return[r*o,b*i];var c=x/(2*r)-2*r/x,u=2*n/x,f=(1-u*u)/(i-u),h=c*c,p=f*f,d=1+h/p,m=1+p/h,y=(c*i/f-c/2)/d,_=(p*i/h+f/2)/m,w=_*_-(p*i*i/h+f*i-1)/m;return[b*(y+C(y*y+o*o/d)*s),b*(_+C(w<0?0:w)*g(-n*c)*s)]}function e_(r,n){var i=n*n;return[r,n*(1.0148+i*i*(.23185+i*(.02406*i-.14499)))]}function ew(r,n){if(1e-6>a(n))return[r,0];var i=y(n),o=r*v(n);return[v(o)/i,n+(1-l(o))/i]}function eT(r,n){return[r[0]*n[0]+r[1]*n[3],r[0]*n[1]+r[1]*n[4],r[0]*n[2]+r[1]*n[5]+r[2],r[3]*n[0]+r[4]*n[3],r[3]*n[1]+r[4]*n[4],r[3]*n[2]+r[4]*n[5]+r[5]]}function ek(r,n){return[r[0]-n[0],r[1]-n[1]]}function eA(r){return C(r[0]*r[0]+r[1]*r[1])}function eM(r,i,o){function c(r,n){var a,o=i(r,n),s=o.project([r*M,n*M]);return(a=o.transform)?[a[0]*s[0]+a[1]*s[1]+a[2],-(a[3]*s[0]+a[4]*s[1]+a[5])]:(s[1]=-s[1],s)}(function r(n,i){if(n.edges=function(r){for(var n=r.length,i=[],a=r[n-1],o=0;o<n;++o)i.push([a,a=r[o]]);return i}(n.face),i.face){var a,o,c,u,f,h,p=n.shared=function(r,n){for(var i,a,o=r.length,s=null,l=0;l<o;++l){i=r[l];for(var c=n.length;--c>=0;)if(a=n[c],i[0]===a[0]&&i[1]===a[1]){if(s)return[s,i];s=i}}}(n.face,i.face),d=(a=p.map(i.project),o=p.map(n.project),c=ek(a[1],a[0]),u=ek(o[1],o[0]),f=s(c[0]*u[1]-c[1]*u[0],c[0]*u[0]+c[1]*u[1]),h=eA(c)/eA(u),eT([1,0,a[0][0],0,1,a[0][1]],eT([h,0,0,0,h,0],eT([l(f),v(f),0,-v(f),l(f),0],[1,0,-o[0][0],0,1,-o[0][1]]))));n.transform=i.transform?eT(i.transform,d):d;for(var m=i.edges,g=0,y=m.length;g<y;++g)eS(p[0],m[g][1])&&eS(p[1],m[g][0])&&(m[g]=n),eS(p[0],m[g][0])&&eS(p[1],m[g][1])&&(m[g]=n);for(m=n.edges,g=0,y=m.length;g<y;++g)eS(p[0],m[g][0])&&eS(p[1],m[g][1])&&(m[g]=i),eS(p[0],m[g][1])&&eS(p[1],m[g][0])&&(m[g]=i)}else n.transform=i.transform;return n.children&&n.children.forEach(function(i){r(i,n)}),n})(r,{transform:null}),function r(n){return n.project.invert||n.children&&n.children.some(r)}(r)&&(c.invert=function(n,a){var o=function r(n,a){var o=n.project.invert,s=n.transform,l=a;if(s&&(l=[(s=[(u=1/((c=s)[0]*c[4]-c[1]*c[3]))*c[4],-u*c[1],u*(c[1]*c[5]-c[2]*c[4]),-u*c[3],u*c[0],u*(c[2]*c[3]-c[0]*c[5])])[0]*l[0]+s[1]*l[1]+s[2],s[3]*l[0]+s[4]*l[1]+s[5]]),o&&n===i((f=h=o(l))[0]*S,f[1]*S))return h;for(var c,u,f,h,p=n.children,d=0,m=p&&p.length;d<m;++d)if(h=r(p[d],a))return h}(r,[n,-a]);return o&&(o[0]*=S,o[1]*=S,o)});var u=n.geoProjection(c),f=u.stream;return u.stream=function(i){var o=u.rotate(),s=f(i),l=(u.rotate([0,0]),f(i));return u.rotate(o),s.sphere=function(){l.polygonStart(),l.lineStart(),function r(i,o,s){var l,c,u=o.edges,f=u.length,h={type:"MultiPoint",coordinates:o.face},p=o.face.filter(function(r){return 90!==a(r[1])}),d=n.geoBounds({type:"MultiPoint",coordinates:p}),m=!1,g=-1,v=d[1][0]-d[0][0],y=180===v||360===v?[(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2]:n.geoCentroid(h);if(s)for(;++g<f&&u[g]!==s;);++g;for(var x=0;x<f;++x)Array.isArray(c=u[(x+g)%f])?(m||(i.point((l=n.geoInterpolate(c[0],y)(1e-6))[0],l[1]),m=!0),i.point((l=n.geoInterpolate(c[1],y)(1e-6))[0],l[1])):(m=!1,c!==s&&r(i,c,o))}(l,r),l.lineEnd(),l.polygonEnd()},s},u.angle(null==o?-30:o*M)}function eS(r,n){return r&&n&&r[0]===n[0]&&r[1]===n[1]}eb.invert=function(r,n){var i=(r/=b)*r,a=i+(n/=b)*n,o=x*x;return[r?(a-1+C((1-a)*(1-a)+4*i))/(2*r)*b:0,H(function(r){return a*(x*v(r)-2*r)*x+4*r*r*(n-v(r))+2*x*r-o*n},0)]},e_.invert=function(r,n){n>1.790857183?n=1.790857183:n<-1.790857183&&(n=-1.790857183);var i,o=n;do{var s=o*o;o-=i=(o*(1.0148+s*s*(.23185+s*(.02406*s-.14499)))-n)/(1.0148+s*s*(5*.23185+s*(.21654*s-1.01493)))}while(a(i)>1e-6);return[r,o]},ew.invert=function(r,n){if(1e-6>a(n))return[r,0];var i,o=r*r+n*n,s=.5*n,c=10;do{var u=y(s),f=1/l(s),h=o-2*n*s+s*s;s-=i=(u*h+2*(s-n))/(2+h*f*f+2*(s-n)*u)}while(a(i)>1e-6&&--c>0);return u=y(s),[(a(n)<a(s+1/u)?E(r*u):g(n)*g(r)*(L(a(r*u))+b))/v(s),s]};var eE=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],eL=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(r){return r.map(function(r){return eE[r]})}),eC=2/C(3);function eP(r,n){var i=to(r,n);return[i[0]*eC,i[1]]}function eI(r,n){for(var i=0,a=r.length,o=0;i<a;++i)o+=r[i]*n[i];return o}function eO(r){return[s(r[1],r[0])*M,E(h(-1,p(1,r[2])))*M]}function ez(r){var n=r[0]*S,i=r[1]*S,a=l(i);return[a*l(n),a*v(n),v(i)]}function eD(){}function eR(r,n){return{type:"FeatureCollection",features:r.features.map(function(r){return eF(r,n)})}}function eF(r,n){return{type:"Feature",id:r.id,properties:r.properties,geometry:eB(r.geometry,n)}}function eB(r,i){var a;if(!r)return null;if("GeometryCollection"===r.type)return{type:"GeometryCollection",geometries:r.geometries.map(function(r){return eB(r,i)})};switch(r.type){case"Point":case"MultiPoint":a=eU;break;case"LineString":case"MultiLineString":a=eV;break;case"Polygon":case"MultiPolygon":case"Sphere":a=eH;break;default:return null}return n.geoStream(r,i(a)),a.result()}eP.invert=function(r,n){return to.invert(r/eC,n)};var eN=[],ej=[],eU={point:function(r,n){eN.push([r,n])},result:function(){var r=eN.length?eN.length<2?{type:"Point",coordinates:eN[0]}:{type:"MultiPoint",coordinates:eN}:null;return eN=[],r}},eV={lineStart:eD,point:function(r,n){eN.push([r,n])},lineEnd:function(){eN.length&&(ej.push(eN),eN=[])},result:function(){var r=ej.length?ej.length<2?{type:"LineString",coordinates:ej[0]}:{type:"MultiLineString",coordinates:ej}:null;return ej=[],r}},eH={polygonStart:eD,lineStart:eD,point:function(r,n){eN.push([r,n])},lineEnd:function(){var r=eN.length;if(r){do eN.push(eN[0].slice());while(++r<4);ej.push(eN),eN=[]}},polygonEnd:eD,result:function(){if(!ej.length)return null;var r=[],n=[];return ej.forEach(function(i){(function(r){if((n=r.length)<4)return!1;for(var n,i=0,a=r[n-1][1]*r[0][0]-r[n-1][0]*r[0][1];++i<n;)a+=r[i-1][1]*r[i][0]-r[i-1][0]*r[i][1];return a<=0})(i)?r.push([i]):n.push(i)}),n.forEach(function(n){var i=n[0];r.some(function(r){if(function(r,n){for(var i=n[0],a=n[1],o=!1,s=0,l=r.length,c=l-1;s<l;c=s++){var u=r[s],f=u[0],h=u[1],p=r[c],d=p[0],m=p[1];h>a^m>a&&i<(d-f)*(a-h)/(m-h)+f&&(o=!o)}return o}(r[0],i))return r.push(n),!0})||r.push([n])}),ej=[],r.length?r.length>1?{type:"MultiPolygon",coordinates:r}:{type:"Polygon",coordinates:r[0]}:null}};function eq(r){var i=r(b,0)[0]-r(-b,0)[0];function o(n,o){var s=a(n)<b,l=r(s?n:n>0?n-x:n+x,o),c=(l[0]-l[1])*w,u=(l[0]+l[1])*w;if(s)return[c,u];var f=i*w,h=c>0^u>0?-1:1;return[h*c-g(u)*f,h*u-g(c)*f]}return r.invert&&(o.invert=function(n,o){var s=(n+o)*w,l=(o-n)*w,c=a(s)<.5*i&&a(l)<.5*i;if(!c){var u=i*w,f=s>0^l>0?-1:1,h=-f*n+(l>0?1:-1)*u,p=-f*o+(s>0?1:-1)*u;s=(-h-p)*w,l=(h-p)*w}var d=r.invert(s,l);return c||(d[0]+=s>0?x:-x),d}),n.geoProjection(o).rotate([-90,-90,45]).clipAngle(179.999)}function eG(){return eq(tN).scale(111.48)}function eY(r){var n=v(r);function i(i,a){var s=n?y(i*n/2)/n:i/2;if(!a)return[2*s,-r];var c=2*o(s*v(a)),u=1/y(a);return[v(c)*u,a+(1-l(c))*u-r]}return i.invert=function(i,s){if(1e-6>a(s+=r))return[n?2*o(n*i/2)/n:i,0];var c,u=i*i+s*s,f=0,h=10;do{var p=y(f),d=1/l(f),m=u-2*s*f+f*f;f-=c=(p*m+2*(f-s))/(2+m*d*d+2*(f-s)*p)}while(a(c)>1e-6&&--h>0);var g=i*(p=y(f)),b=y(a(s)<a(f+1/p)?.5*E(g):.5*L(g)+x/4)/v(f);return[n?2*o(n*b)/n:2*b,f]},i}var eW=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function eX(r,n){var i,o=p(18,36*a(n)/x),s=u(o),l=o-s,c=(i=eW[s])[0],f=i[1],h=(i=eW[++s])[0],d=i[1],m=(i=eW[p(19,++s)])[0],g=i[1];return[r*(h+l*(m-c)/2+l*l*(m-2*h+c)/2),(n>0?b:-b)*(d+l*(g-f)/2+l*l*(g-2*d+f)/2)]}function eZ(r,n){var i=function(r){function n(n,i){var a=l(i),o=(r-1)/(r-a*l(n));return[o*a*v(n),o*v(i)]}return n.invert=function(n,i){var a=n*n+i*i,o=C(a),l=(r-C(1-a*(r+1)/(r-1)))/((r-1)/o+o/(r-1));return[s(n*l,o*C(1-l*l)),o?E(i*l/o):0]},n}(r);if(!n)return i;var a=l(n),o=v(n);function c(n,s){var l=i(n,s),c=l[1],u=c*o/(r-1)+a;return[l[0]*a/u,c/u]}return c.invert=function(n,s){var l=(r-1)/(r-1-s*o);return i.invert(l*n,l*s*a)},c}function eJ(r){return r.length>0}function eK(r){return -90===r||90===r?[0,r]:[-180,Math.floor(1e4*r)/1e4]}function eQ(r){var n=r[0],i=r[1],a=!1;return n<=-179.9999?(n=-180,a=!0):n>=179.9999&&(n=180,a=!0),i<=-89.9999?(i=-90,a=!0):i>=89.9999&&(i=90,a=!0),a?[n,i]:r}function e$(r){return r.map(eQ)}function e0(r,n,i){for(var a=0,o=r.length;a<o;++a){var s=r[a].slice();i.push({index:-1,polygon:n,ring:s});for(var l=0,c=s.length;l<c;++l){var u=s[l],f=u[0],h=u[1];if(f<=-179.9999||f>=179.9999||h<=-89.9999||h>=89.9999){s[l]=eQ(u);for(var p=l+1;p<c;++p){var d=s[p],m=d[0],g=d[1];if(m>-179.9999&&m<179.9999&&g>-89.9999&&g<89.9999)break}if(p===l+1)continue;if(l){var v={index:-1,polygon:n,ring:s.slice(0,l+1)};v.ring[v.ring.length-1]=eK(h),i[i.length-1]=v}else i.pop();if(p>=c)break;i.push({index:-1,polygon:n,ring:s=s.slice(p-1)}),s[0]=eK(s[0][1]),l=-1,c=s.length}}}}function e1(r){var n,i,a,o,s,l,c=r.length,u={},f={};for(n=0;n<c;++n)a=(i=r[n]).ring[0],s=i.ring[i.ring.length-1],a[0]!==s[0]||a[1]!==s[1]?(i.index=n,u[a]=f[s]=i):(i.polygon.push(i.ring),r[n]=null);for(n=0;n<c;++n)if(i=r[n]){if(a=i.ring[0],s=i.ring[i.ring.length-1],o=f[a],l=u[s],delete u[a],delete f[s],a[0]===s[0]&&a[1]===s[1]){i.polygon.push(i.ring);continue}o?(delete f[a],delete u[o.ring[0]],o.ring.pop(),r[o.index]=null,i={index:-1,polygon:o.polygon,ring:o.ring.concat(i.ring)},o===l?i.polygon.push(i.ring):(i.index=c++,r.push(u[i.ring[0]]=f[i.ring[i.ring.length-1]]=i))):l?(delete u[s],delete f[l.ring[l.ring.length-1]],i.ring.pop(),i={index:c++,polygon:l.polygon,ring:i.ring.concat(l.ring)},r[l.index]=null,r.push(u[i.ring[0]]=f[i.ring[i.ring.length-1]]=i)):(i.ring.push(i.ring[0]),i.polygon.push(i.ring))}}function e2(r){var n={type:"Feature",geometry:e3(r.geometry)};return null!=r.id&&(n.id=r.id),null!=r.bbox&&(n.bbox=r.bbox),null!=r.properties&&(n.properties=r.properties),n}function e3(r){if(null==r)return r;switch(r.type){case"GeometryCollection":n={type:"GeometryCollection",geometries:r.geometries.map(e3)};break;case"Point":n={type:"Point",coordinates:eQ(r.coordinates)};break;case"MultiPoint":case"LineString":n={type:r.type,coordinates:e$(r.coordinates)};break;case"MultiLineString":n={type:"MultiLineString",coordinates:r.coordinates.map(e$)};break;case"Polygon":var n,i,a,o,s=[];e0(r.coordinates,s,i=[]),e1(i),n={type:"Polygon",coordinates:s};break;case"MultiPolygon":i=[],a=-1,o=r.coordinates.length;for(var l=Array(o);++a<o;)e0(r.coordinates[a],l[a]=[],i);e1(i),n={type:"MultiPolygon",coordinates:l.filter(eJ)};break;default:return r}return null!=r.bbox&&(n.bbox=r.bbox),n}function e5(r,n){var i=y(n/2),a=v(_*i);return[r*(.74482-.34588*a*a),1.70711*i]}function e4(r,i,a){var o=n.geoInterpolate(i,a),s=o(.5),l=n.geoRotation([-s[0],-s[1]])(i),c=o.distance/2,u=-E(v(l[1]*S)/v(c)),f=[-s[0],-s[1],-(l[0]>0?x-u:u)*M],h=n.geoProjection(r(c)).rotate(f),p=n.geoRotation(f),d=h.center;return delete h.rotate,h.center=function(r){return arguments.length?d(p(r)):p.invert(d())},h.clipAngle(90)}function e6(r){var i=l(r);function a(r,a){var o=n.geoGnomonicRaw(r,a);return o[0]*=i,o}return a.invert=function(r,a){return n.geoGnomonicRaw.invert(r/i,a)},a}function e8(r,n){return e4(e6,r,n)}function e9(r){if(!(r*=2))return n.geoAzimuthalEquidistantRaw;var i=-r/2,a=-i,o=r*r,c=y(a),u=.5/v(a);function f(n,s){var c=L(l(s)*l(n-i)),u=L(l(s)*l(n-a));return[((c*=c)-(u*=u))/(2*r),(s<0?-1:1)*C(4*o*u-(o-c+u)*(o-c+u))/(2*r)]}return f.invert=function(r,n){var o,f,h=n*n,p=l(C(h+(o=r+i)*o)),d=l(C(h+(o=r+a)*o));return[s(f=p-d,o=(p+d)*c),(n<0?-1:1)*L(C(o*o+f*f)*u)]},f}function e7(r,n){return e4(e9,r,n)}function rt(r,n){if(1e-6>a(n))return[r,0];var i=a(n/b),o=E(i);if(1e-6>a(r)||1e-6>a(a(n)-b))return[0,g(n)*x*y(o/2)];var s=l(o),c=a(x/r-r/x)/2,u=c*c,f=s/(i+s-1),h=f*(2/i-1),p=h*h,d=p+u,m=f-p,v=u+f;return[g(r)*x*(c*m+C(u*m*m-d*(f*f-p)))/d,g(n)*x*(h*v-c*C((u+1)*d-v*v))/d]}function re(r,n){if(1e-6>a(n))return[r,0];var i=a(n/b),o=E(i);if(1e-6>a(r)||1e-6>a(a(n)-b))return[0,g(n)*x*y(o/2)];var s=l(o),c=a(x/r-r/x)/2,u=c*c,f=s*(C(1+u)-c*s)/(1+u*i*i);return[g(r)*x*f,g(n)*x*C(1-f*(2*c+f))]}function rr(r,n){if(1e-6>a(n))return[r,0];var i=n/b,o=E(i);if(1e-6>a(r)||1e-6>a(a(n)-b))return[0,x*y(o/2)];var s=(x/r-r/x)/2,c=i/(1+l(o));return[x*(g(r)*C(s*s+1-c*c)-s),x*c]}function rn(r,n){if(!n)return[r,0];var i=a(n);if(!r||i===b)return[0,n];var o=i/b,s=o*o,l=(8*o-s*(s+2)-5)/(2*s*(o-1)),c=l*l,u=o*l,f=s+c+2*u,h=o+3*l,p=r/b,d=p+1/p,m=g(a(r)-b)*C(d*d-4),v=m*m,y=(m*(f+c-1)+2*C(f*(s+c*v-1)+(1-s)*(s*(h*h+4*c)+12*u*c+4*c*c)))/(4*f+v);return[g(r)*b*y,g(n)*b*C(1+m*a(y)-y*y)]}function ri(r,n,i,a){var o=x/3;r=h(r,1e-6),n=h(n,1e-6),r=p(r,b),n=p(n,x-1e-6),i=p(i=h(i,0),99.999999);var c=(a=h(a,1e-6))/100,u=L((i/100+1)*l(o))/o,f=v(r)/v(u*b),d=n/x,m=C(c*v(r/2)/v(n/2));return function(r,n,i,a,o){function c(s,c){var u=i*v(a*c),f=C(1-u*u),h=C(2/(1+f*l(s*=o)));return[r*f*h*v(s),n*u*h]}return c.invert=function(l,c){var u=l/r,f=c/n,h=C(u*u+f*f),p=2*E(h/2);return[s(l*y(p),r*h)/o,h&&E(c*v(p)/(n*i*h))/a]},c}(m/C(d*f*u),1/(m*C(d*f*u)),f,u,d)}function ra(){var r=65*S,i=60*S,a=20,o=200,s=n.geoProjectionMutator(ri),l=s(r,i,a,o);return l.poleline=function(n){return arguments.length?s(r=+n*S,i,a,o):r*M},l.parallels=function(n){return arguments.length?s(r,i=+n*S,a,o):i*M},l.inflation=function(n){return arguments.length?s(r,i,a=+n,o):a},l.ratio=function(n){return arguments.length?s(r,i,a,o=+n):o},l.scale(163.775)}eW.forEach(function(r){r[1]*=1.0144}),eX.invert=function(r,n){var i=n/b,o=90*i,s=p(18,a(o/5)),l=h(0,u(s));do{var c=eW[l][1],f=eW[l+1][1],d=eW[p(19,l+2)][1],m=d-c,g=d-2*f+c,v=2*(a(i)-f)/m,y=g/m,x=v*(1-y*v*(1-2*y*v));if(x>=0||1===l){o=(n>=0?5:-5)*(x+s);var _,w=50;do x=(s=p(18,a(o)/5))-(l=u(s)),c=eW[l][1],o-=(_=(n>=0?b:-b)*((f=eW[l+1][1])+x*((d=eW[p(19,l+2)][1])-c)/2+x*x*(d-2*f+c)/2)-n)*M;while(a(_)>1e-12&&--w>0);break}}while(--l>=0);var T=eW[l][0],k=eW[l+1][0],A=eW[p(19,l+2)][0];return[r/(k+x*(A-T)/2+x*x*(A-2*k+T)/2),o*S]},e5.invert=function(r,n){var i=n/1.70711,a=v(_*i);return[r/(.74482-.34588*a*a),2*o(i)]},rt.invert=function(r,n){if(1e-6>a(n))return[r,0];if(1e-6>a(r))return[0,b*v(2*o(n/x))];var i=(r/=x)*r,s=(n/=x)*n,c=i+s,u=c*c,f=-a(n)*(1+c),h=f-2*s+i,p=-2*f+1+2*s+u,d=(f-h*h/(3*p))/p,m=2*C(-d/3),y=L(3*(s/p+(2*h*h*h/(p*p*p)-9*f*h/(p*p))/27)/(d*m))/3;return[x*(c-1+C(1+2*(i-s)+u))/(2*r),g(n)*x*(-m*l(y+x/3)-h/(3*p))]},re.invert=function(r,n){if(!r)return[0,b*v(2*o(n/x))];var i=a(r/x),l=(1-i*i-(n/=x)*n)/(2*i),c=C(l*l+1);return[g(r)*x*(c-l),g(n)*b*v(2*s(C((1-2*l*i)*(l+c)-i),C(c+l+i)))]},rr.invert=function(r,n){if(!n)return[r,0];var i=n/x,a=(x*x*(1-i*i)-r*r)/(2*x*r);return[r?x*(g(r)*C(a*a+1)-a):0,b*v(2*o(i))]},rn.invert=function(r,n){if(!r||!n)return[r,n];n/=x;var i,o=g(r)*r/b,s=(o*o-1+4*n*n)/a(o),l=s*s,c=2*n,u=50;do{var f=c*c,h=(8*c-f*(f+2)-5)/(2*f*(c-1)),p=(3*c-f*c-10)/(2*f*c),d=h*h,m=c*h,v=c+h,y=v*v,_=c+3*h,w=-2*v*(4*m*d+(1-4*f+3*f*f)*(1+p)+d*(14*f-6-l+(8*f-8-2*l)*p)+m*(12*f-8+(10*f-10-l)*p)),T=C(y*(f+d*l-1)+(1-f)*(f*(_*_+4*d)+d*(12*m+4*d)));c-=i=(s*(y+d-1)+2*T-o*(4*y+l))/(s*(2*h*p+2*v*(1+p))+w/T-8*v*(s*(-1+d+y)+2*T)*(1+p)/(l+4*y))}while(i>1e-6&&--u>0);return[g(r)*(C(s*s+4)+s)*x/4,b*c]};var ro=4*x+3*C(3),rs=2*C(2*x*C(3)/ro),rl=W(rs*C(3)/x,rs,ro/6);function rc(r,n){return[r*C(1-3*n*n/(x*x)),n]}function ru(r,n){var i=l(n),a=l(r)*i,o=1-a,c=l(r=s(v(r)*i,-v(n))),u=v(r);return[u*(i=C(1-a*a))-c*o,-c*i-u*o]}function rf(r,n){var i=z(r,n);return[(i[0]+r/b)/2,(i[1]+n)/2]}rc.invert=function(r,n){return[r/C(1-3*n*n/(x*x)),n]},ru.invert=function(r,n){var i=-((r*r+n*n)/2),a=C(-i*(2+i)),o=n*i+r*a,l=r*i-n*a,c=C(l*l+o*o);return[s(a*o,c*(1+i)),c?-E(a*l/c):0]},rf.invert=function(r,n){var i=r,o=n,s=25;do{var c,u=l(o),f=v(o),h=v(2*o),p=f*f,d=u*u,m=v(i),g=l(i/2),y=v(i/2),x=y*y,_=1-d*g*g,w=_?L(u*g)*C(c=1/_):c=0,T=.5*(2*w*u*y+i/b)-r,k=.5*(w*f+o)-n,A=.5*c*(d*x+w*u*g*p)+.5/b,M=c*(m*h/4-w*f*y),S=.125*c*(h*y-w*f*d*m),E=.5*c*(p*g+w*x*u)+.5,P=M*S-E*A,I=(k*M-T*E)/P,O=(T*S-k*A)/P;i-=I,o-=O}while((a(I)>1e-6||a(O)>1e-6)&&--s>0);return[i,o]},r.geoNaturalEarth=n.geoNaturalEarth1,r.geoNaturalEarthRaw=n.geoNaturalEarth1Raw,r.geoAiry=function(){var r=b,i=n.geoProjectionMutator(O),a=i(r);return a.radius=function(n){return arguments.length?i(r=n*S):r*M},a.scale(179.976).clipAngle(147)},r.geoAiryRaw=O,r.geoAitoff=function(){return n.geoProjection(z).scale(152.63)},r.geoAitoffRaw=z,r.geoArmadillo=function(){var r=20*S,i=r>=0?1:-1,a=y(i*r),o=n.geoProjectionMutator(D),c=o(r),u=c.stream;return c.parallel=function(n){return arguments.length?(a=y((i=(r=n*S)>=0?1:-1)*r),o(r)):r*M},c.stream=function(n){var o=c.rotate(),f=u(n),h=(c.rotate([0,0]),u(n)),p=c.precision();return c.rotate(o),f.sphere=function(){h.polygonStart(),h.lineStart();for(var n=-180*i;i*n<180;n+=90*i)h.point(n,90*i);if(r)for(;i*(n-=3*i*p)>=-180;)h.point(n,-(i*s(l(n*S/2),a))*M);h.lineEnd(),h.polygonEnd()},f},c.scale(218.695).center([0,28.0974])},r.geoArmadilloRaw=D,r.geoAugust=function(){return n.geoProjection(R).scale(66.1603)},r.geoAugustRaw=R,r.geoBaker=function(){return n.geoProjection(N).scale(112.314)},r.geoBakerRaw=N,r.geoBerghaus=function(){var r=5,i=n.geoProjectionMutator(j),a=i(r),o=a.stream,c=-l(.01*S),u=v(.01*S);return a.lobes=function(n){return arguments.length?i(r=+n):r},a.stream=function(n){var i=a.rotate(),f=o(n),h=(a.rotate([0,0]),o(n));return a.rotate(i),f.sphere=function(){h.polygonStart(),h.lineStart();for(var n=0,i=360/r,a=2*x/r,o=90-180/r,f=b;n<r;++n,o-=i,f-=a)h.point(s(u*l(f),c)*M,E(u*v(f))*M),o<-90?(h.point(-90,-180-o-.01),h.point(-90,-180-o+.01)):(h.point(90,o+.01),h.point(90,o-.01));h.lineEnd(),h.polygonEnd()},f},a.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},r.geoBerghausRaw=j,r.geoBertin1953=function(){return n.geoProjection(G()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},r.geoBertin1953Raw=G,r.geoBoggs=function(){return n.geoProjection(Z).scale(160.857)},r.geoBoggsRaw=Z,r.geoBonne=function(){return J(Q).scale(123.082).center([0,26.1441]).parallel(45)},r.geoBonneRaw=Q,r.geoBottomley=function(){var r=.5,i=n.geoProjectionMutator($),a=i(r);return a.fraction=function(n){return arguments.length?i(r=+n):r},a.scale(158.837)},r.geoBottomleyRaw=$,r.geoBromley=function(){return n.geoProjection(tt).scale(152.63)},r.geoBromleyRaw=tt,r.geoChamberlin=ta,r.geoChamberlinRaw=tn,r.geoChamberlinAfrica=function(){return ta([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},r.geoCollignon=function(){return n.geoProjection(to).scale(95.6464).center([0,30])},r.geoCollignonRaw=to,r.geoCraig=function(){return J(ts).scale(249.828).clipAngle(90)},r.geoCraigRaw=ts,r.geoCraster=function(){return n.geoProjection(tc).scale(156.19)},r.geoCrasterRaw=tc,r.geoCylindricalEqualArea=function(){return J(tu).parallel(38.58).scale(195.044)},r.geoCylindricalEqualAreaRaw=tu,r.geoCylindricalStereographic=function(){return J(tf).scale(124.75)},r.geoCylindricalStereographicRaw=tf,r.geoEckert1=function(){return n.geoProjection(th).scale(165.664)},r.geoEckert1Raw=th,r.geoEckert2=function(){return n.geoProjection(tp).scale(165.664)},r.geoEckert2Raw=tp,r.geoEckert3=function(){return n.geoProjection(td).scale(180.739)},r.geoEckert3Raw=td,r.geoEckert4=function(){return n.geoProjection(tm).scale(180.739)},r.geoEckert4Raw=tm,r.geoEckert5=function(){return n.geoProjection(tg).scale(173.044)},r.geoEckert5Raw=tg,r.geoEckert6=function(){return n.geoProjection(tv).scale(173.044)},r.geoEckert6Raw=tv,r.geoEisenlohr=function(){return n.geoProjection(tx).scale(62.5271)},r.geoEisenlohrRaw=tx,r.geoFahey=function(){return n.geoProjection(t_).scale(137.152)},r.geoFaheyRaw=t_,r.geoFoucaut=function(){return n.geoProjection(tw).scale(135.264)},r.geoFoucautRaw=tw,r.geoFoucautSinusoidal=function(){var r=.5,i=n.geoProjectionMutator(tT),a=i(r);return a.alpha=function(n){return arguments.length?i(r=+n):r},a.scale(168.725)},r.geoFoucautSinusoidalRaw=tT,r.geoGilbert=function(r){null==r&&(r=n.geoOrthographic);var i=r(),a=n.geoEquirectangular().scale(M).precision(0).clipAngle(null).translate([0,0]);function o(r){return i(tk(r))}function s(r){o[r]=function(){return arguments.length?(i[r].apply(i,arguments),o):i[r]()}}return i.invert&&(o.invert=function(r){return tA(i.invert(r))}),o.stream=function(r){var n=i.stream(r),o=a.stream({point:function(r,i){n.point(r/2,E(y(-i/2*S))*M)},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}});return o.sphere=n.sphere,o},o.rotate=function(r){return arguments.length?(a.rotate(r),o):a.rotate()},o.center=function(r){return arguments.length?(i.center(tk(r)),o):tA(i.center())},s("angle"),s("clipAngle"),s("clipExtent"),s("fitExtent"),s("fitHeight"),s("fitSize"),s("fitWidth"),s("scale"),s("translate"),s("precision"),o.scale(249.5)},r.geoGingery=function(){var r=6,i=30*S,a=l(i),o=v(i),c=n.geoProjectionMutator(tM),u=c(i,r),f=u.stream,h=-l(.01*S),p=v(.01*S);return u.radius=function(n){return arguments.length?(a=l(i=n*S),o=v(i),c(i,r)):i*M},u.lobes=function(n){return arguments.length?c(i,r=+n):r},u.stream=function(n){var i=u.rotate(),c=f(n),d=(u.rotate([0,0]),f(n));return u.rotate(i),c.sphere=function(){d.polygonStart(),d.lineStart();for(var n=0,i=2*x/r,c=0;n<r;++n,c-=i)d.point(s(p*l(c),h)*M,E(p*v(c))*M),d.point(s(o*l(c-i/2),a)*M,E(o*v(c-i/2))*M);d.lineEnd(),d.polygonEnd()},c},u.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},r.geoGingeryRaw=tM,r.geoGinzburg4=function(){return n.geoProjection(tC).scale(149.995)},r.geoGinzburg4Raw=tC,r.geoGinzburg5=function(){return n.geoProjection(tP).scale(153.93)},r.geoGinzburg5Raw=tP,r.geoGinzburg6=function(){return n.geoProjection(tI).scale(130.945)},r.geoGinzburg6Raw=tI,r.geoGinzburg8=function(){return n.geoProjection(tO).scale(131.747)},r.geoGinzburg8Raw=tO,r.geoGinzburg9=function(){return n.geoProjection(tz).scale(131.087)},r.geoGinzburg9Raw=tz,r.geoGringorten=function(){return n.geoProjection(tD(tR)).scale(239.75)},r.geoGringortenRaw=tR,r.geoGuyou=function(){return n.geoProjection(tD(tN)).scale(151.496)},r.geoGuyouRaw=tN,r.geoHammer=function(){var r=2,i=n.geoProjectionMutator(U),a=i(r);return a.coefficient=function(n){return arguments.length?i(r=+n):r},a.scale(169.529)},r.geoHammerRaw=U,r.geoHammerRetroazimuthal=function(){var r=0,i=n.geoProjectionMutator(tj),a=i(r),o=a.rotate,s=a.stream,l=n.geoCircle();return a.parallel=function(n){if(!arguments.length)return r*M;var o=a.rotate();return i(r=n*S).rotate(o)},a.rotate=function(n){return arguments.length?(o.call(a,[n[0],n[1]-r*M]),l.center([-n[0],-n[1]]),a):((n=o.call(a))[1]+=r*M,n)},a.stream=function(r){return(r=s(r)).sphere=function(){r.polygonStart();var n,i=l.radius(89.99)().coordinates[0],a=i.length-1,o=-1;for(r.lineStart();++o<a;)r.point((n=i[o])[0],n[1]);for(r.lineEnd(),a=(i=l.radius(90.01)().coordinates[0]).length-1,r.lineStart();--o>=0;)r.point((n=i[o])[0],n[1]);r.lineEnd(),r.polygonEnd()},r},a.scale(79.4187).parallel(45).clipAngle(179.999)},r.geoHammerRetroazimuthalRaw=tj,r.geoHealpix=function(){var r=4,a=n.geoProjectionMutator(tq),o=a(r),s=o.stream;return o.lobes=function(n){return arguments.length?a(r=+n):r},o.stream=function(a){var l=o.rotate(),c=s(a),u=(o.rotate([0,0]),s(a));return o.rotate(l),c.sphere=function(){var a,o;n.geoStream((a=180/r,o=[].concat(i.range(-180,180+a/2,a).map(tG),i.range(180,-180-a/2,-a).map(tY)),{type:"Polygon",coordinates:[180===a?o.map(tW):o]}),u)},c},o.scale(239.75)},r.geoHealpixRaw=tq,r.geoHill=function(){var r=1,i=n.geoProjectionMutator(tX),a=i(r);return a.ratio=function(n){return arguments.length?i(r=+n):r},a.scale(167.774).center([0,18.67])},r.geoHillRaw=tX,r.geoHomolosine=function(){return n.geoProjection(tJ).scale(152.63)},r.geoHomolosineRaw=tJ,r.geoHufnagel=function(){var r=1,i=0,a=45*S,o=2,s=n.geoProjectionMutator(tK),l=s(r,i,a,o);return l.a=function(n){return arguments.length?s(r=+n,i,a,o):r},l.b=function(n){return arguments.length?s(r,i=+n,a,o):i},l.psiMax=function(n){return arguments.length?s(r,i,a=+n*S,o):a*M},l.ratio=function(n){return arguments.length?s(r,i,a,o=+n):o},l.scale(180.739)},r.geoHufnagelRaw=tK,r.geoHyperelliptical=function(){var r=0,i=2.5,a=1.183136,o=n.geoProjectionMutator(tQ),s=o(r,i,a);return s.alpha=function(n){return arguments.length?o(r=+n,i,a):r},s.k=function(n){return arguments.length?o(r,i=+n,a):i},s.gamma=function(n){return arguments.length?o(r,i,a=+n):a},s.scale(152.63)},r.geoHyperellipticalRaw=tQ,r.geoInterrupt=t0,r.geoInterruptedBoggs=function(){return t0(Z,t1).scale(160.857)},r.geoInterruptedHomolosine=function(){return t0(tJ,t2).scale(152.63)},r.geoInterruptedMollweide=function(){return t0(X,t3).scale(169.529)},r.geoInterruptedMollweideHemispheres=function(){return t0(X,t5).scale(169.529).rotate([20,0])},r.geoInterruptedSinuMollweide=function(){return t0(tZ,t4,q).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},r.geoInterruptedSinusoidal=function(){return t0(K,t6).scale(152.63).rotate([-20,0])},r.geoKavrayskiy7=function(){return n.geoProjection(t8).scale(158.837)},r.geoKavrayskiy7Raw=t8,r.geoLagrange=function(){var r=.5,i=n.geoProjectionMutator(t9),a=i(r);return a.spacing=function(n){return arguments.length?i(r=+n):r},a.scale(124.75)},r.geoLagrangeRaw=t9,r.geoLarrivee=function(){return n.geoProjection(et).scale(97.2672)},r.geoLarriveeRaw=et,r.geoLaskowski=function(){return n.geoProjection(ee).scale(139.98)},r.geoLaskowskiRaw=ee,r.geoLittrow=function(){return n.geoProjection(er).scale(144.049).clipAngle(89.999)},r.geoLittrowRaw=er,r.geoLoximuthal=function(){return J(en).parallel(40).scale(158.837)},r.geoLoximuthalRaw=en,r.geoMiller=function(){return n.geoProjection(ei).scale(108.318)},r.geoMillerRaw=ei,r.geoModifiedStereographic=ef,r.geoModifiedStereographicRaw=ea,r.geoModifiedStereographicAlaska=function(){return ef(eo,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},r.geoModifiedStereographicGs48=function(){return ef(es,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},r.geoModifiedStereographicGs50=function(){return ef(el,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},r.geoModifiedStereographicMiller=function(){return ef(ec,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},r.geoModifiedStereographicLee=function(){return ef(eu,[165,10]).scale(250).clipAngle(130).center([-165,-10])},r.geoMollweide=function(){return n.geoProjection(X).scale(169.529)},r.geoMollweideRaw=X,r.geoMtFlatPolarParabolic=function(){return n.geoProjection(ed).scale(164.859)},r.geoMtFlatPolarParabolicRaw=ed,r.geoMtFlatPolarQuartic=function(){return n.geoProjection(em).scale(188.209)},r.geoMtFlatPolarQuarticRaw=em,r.geoMtFlatPolarSinusoidal=function(){return n.geoProjection(eg).scale(166.518)},r.geoMtFlatPolarSinusoidalRaw=eg,r.geoNaturalEarth2=function(){return n.geoProjection(ev).scale(175.295)},r.geoNaturalEarth2Raw=ev,r.geoNellHammer=function(){return n.geoProjection(ey).scale(152.63)},r.geoNellHammerRaw=ey,r.geoInterruptedQuarticAuthalic=function(){return t0(U(1/0),ex).rotate([20,0]).scale(152.63)},r.geoNicolosi=function(){return n.geoProjection(eb).scale(127.267)},r.geoNicolosiRaw=eb,r.geoPatterson=function(){return n.geoProjection(e_).scale(139.319)},r.geoPattersonRaw=e_,r.geoPolyconic=function(){return n.geoProjection(ew).scale(103.74)},r.geoPolyconicRaw=ew,r.geoPolyhedral=eM,r.geoPolyhedralButterfly=function(r){r=r||function(r){var i=n.geoCentroid({type:"MultiPoint",coordinates:r});return n.geoGnomonic().scale(1).translate([0,0]).rotate([-i[0],-i[1]])};var i=eL.map(function(n){return{face:n,project:r(n)}});return[-1,0,0,1,0,1,4,5].forEach(function(r,n){var a=i[r];a&&(a.children||(a.children=[])).push(i[n])}),eM(i[0],function(r,n){return i[r<-x/2?n<0?6:4:r<0?n<0?2:0:r<x/2?n<0?3:1:n<0?7:5]}).angle(-30).scale(101.858).center([0,45])},r.geoPolyhedralCollignon=function(r){r=r||function(r){var i=n.geoCentroid({type:"MultiPoint",coordinates:r});return n.geoProjection(eP).translate([0,0]).scale(1).rotate(i[1]>0?[-i[0],0]:[180-i[0],180])};var i=eL.map(function(n){return{face:n,project:r(n)}});return[-1,0,0,1,0,1,4,5].forEach(function(r,n){var a=i[r];a&&(a.children||(a.children=[])).push(i[n])}),eM(i[0],function(r,n){return i[r<-x/2?n<0?6:4:r<0?n<0?2:0:r<x/2?n<0?3:1:n<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},r.geoPolyhedralWaterman=function(r){r=r||function(r){var i=6===r.length?n.geoCentroid({type:"MultiPoint",coordinates:r}):r[0];return n.geoGnomonic().scale(1).translate([0,0]).rotate([-i[0],-i[1]])};var i=eL.map(function(r){for(var n,i=r.map(ez),a=i.length,o=i[a-1],s=[],l=0;l<a;++l)n=i[l],s.push(eO([.9486832980505138*o[0]+.31622776601683794*n[0],.9486832980505138*o[1]+.31622776601683794*n[1],.9486832980505138*o[2]+.31622776601683794*n[2]]),eO([.9486832980505138*n[0]+.31622776601683794*o[0],.9486832980505138*n[1]+.31622776601683794*o[1],.9486832980505138*n[2]+.31622776601683794*o[2]])),o=n;return s}),a=[],o=[-1,0,0,1,0,1,4,5];i.forEach(function(r,n){for(var s,l,c=eL[n],u=c.length,f=a[n]=[],h=0;h<u;++h)i.push([c[h],r[(2*h+2)%(2*u)],r[(2*h+1)%(2*u)]]),o.push(n),f.push((s=ez(r[(2*h+2)%(2*u)]),l=ez(r[(2*h+1)%(2*u)]),[s[1]*l[2]-s[2]*l[1],s[2]*l[0]-s[0]*l[2],s[0]*l[1]-s[1]*l[0]]))});var s=i.map(function(n){return{project:r(n),face:n}});return o.forEach(function(r,n){var i=s[r];i&&(i.children||(i.children=[])).push(s[n])}),eM(s[0],function(r,n){var i=l(n),o=[i*l(r),i*v(r),v(n)],c=r<-x/2?n<0?6:4:r<0?n<0?2:0:r<x/2?n<0?3:1:n<0?7:5,u=a[c];return s[0>eI(u[0],o)?8+3*c:0>eI(u[1],o)?8+3*c+1:0>eI(u[2],o)?8+3*c+2:c]}).angle(-30).scale(110.625).center([0,45])},r.geoProject=function(r,n){var i,a=n.stream;if(!a)throw Error("invalid projection");switch(r&&r.type){case"Feature":i=eF;break;case"FeatureCollection":i=eR;break;default:i=eB}return i(r,a)},r.geoGringortenQuincuncial=function(){return eq(tR).scale(176.423)},r.geoPeirceQuincuncial=eG,r.geoPierceQuincuncial=eG,r.geoQuantize=function(r,n){if(!(0<=(n=+n)&&n<=20))throw Error("invalid digits");function i(r){var i=r.length,a=2,o=Array(i);for(o[0]=+r[0].toFixed(n),o[1]=+r[1].toFixed(n);a<i;)o[a]=r[a],++a;return o}function a(r){for(var n=i(r[0]),a=[n],o=1;o<r.length;o++){var s=i(r[o]);(s.length>2||s[0]!=n[0]||s[1]!=n[1])&&(a.push(s),n=s)}return 1===a.length&&r.length>1&&a.push(i(r[r.length-1])),a}function o(r){return r.map(a)}function s(r){var n;if(null==r)return r;switch(r.type){case"GeometryCollection":n={type:"GeometryCollection",geometries:r.geometries.map(s)};break;case"Point":n={type:"Point",coordinates:i(r.coordinates)};break;case"MultiPoint":n={type:r.type,coordinates:r.coordinates.map(i)};break;case"LineString":n={type:r.type,coordinates:a(r.coordinates)};break;case"MultiLineString":case"Polygon":n={type:r.type,coordinates:o(r.coordinates)};break;case"MultiPolygon":n={type:"MultiPolygon",coordinates:r.coordinates.map(o)};break;default:return r}return null!=r.bbox&&(n.bbox=r.bbox),n}function l(r){var n={type:"Feature",properties:r.properties,geometry:s(r.geometry)};return null!=r.id&&(n.id=r.id),null!=r.bbox&&(n.bbox=r.bbox),n}if(null!=r)switch(r.type){case"Feature":return l(r);case"FeatureCollection":var c={type:"FeatureCollection",features:r.features.map(l)};return null!=r.bbox&&(c.bbox=r.bbox),c;default:return s(r)}return r},r.geoQuincuncial=eq,r.geoRectangularPolyconic=function(){return J(eY).scale(131.215)},r.geoRectangularPolyconicRaw=eY,r.geoRobinson=function(){return n.geoProjection(eX).scale(152.63)},r.geoRobinsonRaw=eX,r.geoSatellite=function(){var r=2,i=0,a=n.geoProjectionMutator(eZ),o=a(r,i);return o.distance=function(n){return arguments.length?a(r=+n,i):r},o.tilt=function(n){return arguments.length?a(r,i=n*S):i*M},o.scale(432.147).clipAngle(L(1/r)*M-1e-6)},r.geoSatelliteRaw=eZ,r.geoSinuMollweide=function(){return n.geoProjection(tZ).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},r.geoSinuMollweideRaw=tZ,r.geoSinusoidal=function(){return n.geoProjection(K).scale(152.63)},r.geoSinusoidalRaw=K,r.geoStitch=function(r){if(null==r)return r;switch(r.type){case"Feature":return e2(r);case"FeatureCollection":var n={type:"FeatureCollection",features:r.features.map(e2)};return null!=r.bbox&&(n.bbox=r.bbox),n;default:return e3(r)}},r.geoTimes=function(){return n.geoProjection(e5).scale(146.153)},r.geoTimesRaw=e5,r.geoTwoPointAzimuthal=e8,r.geoTwoPointAzimuthalRaw=e6,r.geoTwoPointAzimuthalUsa=function(){return e8([-158,21.5],[-77,39]).clipAngle(60).scale(400)},r.geoTwoPointEquidistant=e7,r.geoTwoPointEquidistantRaw=e9,r.geoTwoPointEquidistantUsa=function(){return e7([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},r.geoVanDerGrinten=function(){return n.geoProjection(rt).scale(79.4183)},r.geoVanDerGrintenRaw=rt,r.geoVanDerGrinten2=function(){return n.geoProjection(re).scale(79.4183)},r.geoVanDerGrinten2Raw=re,r.geoVanDerGrinten3=function(){return n.geoProjection(rr).scale(79.4183)},r.geoVanDerGrinten3Raw=rr,r.geoVanDerGrinten4=function(){return n.geoProjection(rn).scale(127.16)},r.geoVanDerGrinten4Raw=rn,r.geoWagner=ra,r.geoWagner7=function(){return ra().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},r.geoWagnerRaw=ri,r.geoWagner4=function(){return n.geoProjection(rl).scale(176.84)},r.geoWagner4Raw=rl,r.geoWagner6=function(){return n.geoProjection(rc).scale(152.63)},r.geoWagner6Raw=rc,r.geoWiechel=function(){return n.geoProjection(ru).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},r.geoWiechelRaw=ru,r.geoWinkel3=function(){return n.geoProjection(rf).scale(158.837)},r.geoWinkel3Raw=rf,Object.defineProperty(r,"__esModule",{value:!0})},"object"==typeof i&&void 0!==n?a(i,r("d3-geo"),r("d3-array")):a(this.d3=this.d3||{},this.d3,this.d3)},{"d3-array":107,"d3-geo":114}],114:[function(r,n,i){var a,o;a=this,o=function(r,n){"use strict";function i(){return new a}function a(){this.reset()}a.prototype={constructor:a,reset:function(){this.s=this.t=0},add:function(r){s(o,r,this.t),s(this,o.s,this.s),this.s?this.t+=o.t:this.s=o.t},valueOf:function(){return this.s}};var o=new a;function s(r,n,i){var a=r.s=n+i,o=a-n;r.t=n-(a-o)+(i-o)}var l=Math.PI,c=l/2,u=l/4,f=2*l,h=180/l,p=l/180,d=Math.abs,m=Math.atan,g=Math.atan2,v=Math.cos,y=Math.ceil,x=Math.exp,b=Math.log,_=Math.pow,w=Math.sin,T=Math.sign||function(r){return r>0?1:r<0?-1:0},k=Math.sqrt,A=Math.tan;function M(r){return r>1?0:r<-1?l:Math.acos(r)}function S(r){return r>1?c:r<-1?-c:Math.asin(r)}function E(){}function L(r,n){r&&P.hasOwnProperty(r.type)&&P[r.type](r,n)}var C={Feature:function(r,n){L(r.geometry,n)},FeatureCollection:function(r,n){for(var i=r.features,a=-1,o=i.length;++a<o;)L(i[a].geometry,n)}},P={Sphere:function(r,n){n.sphere()},Point:function(r,n){r=r.coordinates,n.point(r[0],r[1],r[2])},MultiPoint:function(r,n){for(var i=r.coordinates,a=-1,o=i.length;++a<o;)r=i[a],n.point(r[0],r[1],r[2])},LineString:function(r,n){I(r.coordinates,n,0)},MultiLineString:function(r,n){for(var i=r.coordinates,a=-1,o=i.length;++a<o;)I(i[a],n,0)},Polygon:function(r,n){O(r.coordinates,n)},MultiPolygon:function(r,n){for(var i=r.coordinates,a=-1,o=i.length;++a<o;)O(i[a],n)},GeometryCollection:function(r,n){for(var i=r.geometries,a=-1,o=i.length;++a<o;)L(i[a],n)}};function I(r,n,i){var a,o=-1,s=r.length-i;for(n.lineStart();++o<s;)a=r[o],n.point(a[0],a[1],a[2]);n.lineEnd()}function O(r,n){var i=-1,a=r.length;for(n.polygonStart();++i<a;)I(r[i],n,1);n.polygonEnd()}function z(r,n){r&&C.hasOwnProperty(r.type)?C[r.type](r,n):L(r,n)}var D,R,F,B,N,j=i(),U=i(),V={point:E,lineStart:E,lineEnd:E,polygonStart:function(){j.reset(),V.lineStart=H,V.lineEnd=q},polygonEnd:function(){var r=+j;U.add(r<0?f+r:r),this.lineStart=this.lineEnd=this.point=E},sphere:function(){U.add(f)}};function H(){V.point=G}function q(){Y(D,R)}function G(r,n){V.point=Y,D=r,R=n,F=r*=p,B=v(n=(n*=p)/2+u),N=w(n)}function Y(r,n){var i=(r*=p)-F,a=i>=0?1:-1,o=a*i,s=v(n=(n*=p)/2+u),l=w(n),c=N*l,f=B*s+c*v(o),h=c*a*w(o);j.add(g(h,f)),F=r,B=s,N=l}function W(r){return[g(r[1],r[0]),S(r[2])]}function X(r){var n=r[0],i=r[1],a=v(i);return[a*v(n),a*w(n),w(i)]}function Z(r,n){return r[0]*n[0]+r[1]*n[1]+r[2]*n[2]}function J(r,n){return[r[1]*n[2]-r[2]*n[1],r[2]*n[0]-r[0]*n[2],r[0]*n[1]-r[1]*n[0]]}function K(r,n){r[0]+=n[0],r[1]+=n[1],r[2]+=n[2]}function Q(r,n){return[r[0]*n,r[1]*n,r[2]*n]}function $(r){var n=k(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);r[0]/=n,r[1]/=n,r[2]/=n}var tt,te,tr,tn,ti,ta,to,ts,tl,tc,tu,tf,th,tp,td,tm,tg,tv,ty,tx,tb,t_,tw,tT,tk,tA,tM=i(),tS={point:tE,lineStart:tC,lineEnd:tP,polygonStart:function(){tS.point=tI,tS.lineStart=tO,tS.lineEnd=tz,tM.reset(),V.polygonStart()},polygonEnd:function(){V.polygonEnd(),tS.point=tE,tS.lineStart=tC,tS.lineEnd=tP,j<0?(tt=-(tr=180),te=-(tn=90)):tM>1e-6?tn=90:tM<-.000001&&(te=-90),tc[0]=tt,tc[1]=tr},sphere:function(){tt=-(tr=180),te=-(tn=90)}};function tE(r,n){tl.push(tc=[tt=r,tr=r]),n<te&&(te=n),n>tn&&(tn=n)}function tL(r,n){var i=X([r*p,n*p]);if(ts){var a=J(ts,i),o=J([a[1],-a[0],0],a);$(o),o=W(o);var s,l=r-ti,c=l>0?1:-1,u=o[0]*h*c,f=d(l)>180;f^(c*ti<u&&u<c*r)?(s=o[1]*h)>tn&&(tn=s):f^(c*ti<(u=(u+360)%360-180)&&u<c*r)?(s=-o[1]*h)<te&&(te=s):(n<te&&(te=n),n>tn&&(tn=n)),f?r<ti?tD(tt,r)>tD(tt,tr)&&(tr=r):tD(r,tr)>tD(tt,tr)&&(tt=r):tr>=tt?(r<tt&&(tt=r),r>tr&&(tr=r)):r>ti?tD(tt,r)>tD(tt,tr)&&(tr=r):tD(r,tr)>tD(tt,tr)&&(tt=r)}else tl.push(tc=[tt=r,tr=r]);n<te&&(te=n),n>tn&&(tn=n),ts=i,ti=r}function tC(){tS.point=tL}function tP(){tc[0]=tt,tc[1]=tr,tS.point=tE,ts=null}function tI(r,n){if(ts){var i=r-ti;tM.add(d(i)>180?i+(i>0?360:-360):i)}else ta=r,to=n;V.point(r,n),tL(r,n)}function tO(){V.lineStart()}function tz(){tI(ta,to),V.lineEnd(),d(tM)>1e-6&&(tt=-(tr=180)),tc[0]=tt,tc[1]=tr,ts=null}function tD(r,n){return(n-=r)<0?n+360:n}function tR(r,n){return r[0]-n[0]}function tF(r,n){return r[0]<=r[1]?r[0]<=n&&n<=r[1]:n<r[0]||r[1]<n}var tB={sphere:E,point:tN,lineStart:tU,lineEnd:tq,polygonStart:function(){tB.lineStart=tG,tB.lineEnd=tY},polygonEnd:function(){tB.lineStart=tU,tB.lineEnd=tq}};function tN(r,n){r*=p;var i=v(n*=p);tj(i*v(r),i*w(r),w(n))}function tj(r,n,i){++tu,th+=(r-th)/tu,tp+=(n-tp)/tu,td+=(i-td)/tu}function tU(){tB.point=tV}function tV(r,n){r*=p;var i=v(n*=p);tT=i*v(r),tk=i*w(r),tA=w(n),tB.point=tH,tj(tT,tk,tA)}function tH(r,n){r*=p;var i=v(n*=p),a=i*v(r),o=i*w(r),s=w(n),l=g(k((l=tk*s-tA*o)*l+(l=tA*a-tT*s)*l+(l=tT*o-tk*a)*l),tT*a+tk*o+tA*s);tf+=l,tm+=l*(tT+(tT=a)),tg+=l*(tk+(tk=o)),tv+=l*(tA+(tA=s)),tj(tT,tk,tA)}function tq(){tB.point=tN}function tG(){tB.point=tW}function tY(){tX(t_,tw),tB.point=tN}function tW(r,n){t_=r,tw=n,r*=p,n*=p,tB.point=tX;var i=v(n);tT=i*v(r),tk=i*w(r),tA=w(n),tj(tT,tk,tA)}function tX(r,n){r*=p;var i=v(n*=p),a=i*v(r),o=i*w(r),s=w(n),l=tk*s-tA*o,c=tA*a-tT*s,u=tT*o-tk*a,f=k(l*l+c*c+u*u),h=S(f),d=f&&-h/f;ty+=d*l,tx+=d*c,tb+=d*u,tf+=h,tm+=h*(tT+(tT=a)),tg+=h*(tk+(tk=o)),tv+=h*(tA+(tA=s)),tj(tT,tk,tA)}function tZ(r){return function(){return r}}function tJ(r,n){function i(i,a){return n((i=r(i,a))[0],i[1])}return r.invert&&n.invert&&(i.invert=function(i,a){return(i=n.invert(i,a))&&r.invert(i[0],i[1])}),i}function tK(r,n){return[d(r)>l?r+Math.round(-r/f)*f:r,n]}function tQ(r,n,i){return(r%=f)?n||i?tJ(t0(r),t1(n,i)):t0(r):n||i?t1(n,i):tK}function t$(r){return function(n,i){return[(n+=r)>l?n-f:n<-l?n+f:n,i]}}function t0(r){var n=t$(r);return n.invert=t$(-r),n}function t1(r,n){var i=v(r),a=w(r),o=v(n),s=w(n);function l(r,n){var l=v(n),c=v(r)*l,u=w(r)*l,f=w(n),h=f*i+c*a;return[g(u*o-h*s,c*i-f*a),S(h*o+u*s)]}return l.invert=function(r,n){var l=v(n),c=v(r)*l,u=w(r)*l,f=w(n),h=f*o-u*s;return[g(u*o+f*s,c*i+h*a),S(h*i-c*a)]},l}function t2(r){function n(n){return(n=r(n[0]*p,n[1]*p))[0]*=h,n[1]*=h,n}return r=tQ(r[0]*p,r[1]*p,r.length>2?r[2]*p:0),n.invert=function(n){return(n=r.invert(n[0]*p,n[1]*p))[0]*=h,n[1]*=h,n},n}function t3(r,n,i,a,o,s){if(i){var l=v(n),c=w(n),u=a*i;null==o?(o=n+a*f,s=n-u/2):(o=t5(l,o),s=t5(l,s),(a>0?o<s:o>s)&&(o+=a*f));for(var h,p=o;a>0?p>s:p<s;p-=u)h=W([l,-c*v(p),-c*w(p)]),r.point(h[0],h[1])}}function t5(r,n){(n=X(n))[0]-=r,$(n);var i=M(-n[1]);return((0>-n[2]?-i:i)+f-1e-6)%f}function t4(){var r,n=[];return{point:function(n,i,a){r.push([n,i,a])},lineStart:function(){n.push(r=[])},lineEnd:E,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var i=n;return n=[],r=null,i}}}function t6(r,n){return 1e-6>d(r[0]-n[0])&&1e-6>d(r[1]-n[1])}function t8(r,n,i,a){this.x=r,this.z=n,this.o=i,this.e=a,this.v=!1,this.n=this.p=null}function t9(r,n,i,a,o){var s,l,c=[],u=[];if(r.forEach(function(r){if(!((n=r.length-1)<=0)){var n,i,a=r[0],l=r[n];if(t6(a,l)){if(!a[2]&&!l[2]){for(o.lineStart(),s=0;s<n;++s)o.point((a=r[s])[0],a[1]);return void o.lineEnd()}l[0]+=2e-6}c.push(i=new t8(a,r,null,!0)),u.push(i.o=new t8(a,null,i,!1)),c.push(i=new t8(l,r,null,!1)),u.push(i.o=new t8(l,null,i,!0))}}),c.length){for(u.sort(n),t7(c),t7(u),s=0,l=u.length;s<l;++s)u[s].e=i=!i;for(var f,h,p=c[0];;){for(var d=p,m=!0;d.v;)if((d=d.n)===p)return;f=d.z,o.lineStart();do{if(d.v=d.o.v=!0,d.e){if(m)for(s=0,l=f.length;s<l;++s)o.point((h=f[s])[0],h[1]);else a(d.x,d.n.x,1,o);d=d.n}else{if(m)for(s=(f=d.p.z).length-1;s>=0;--s)o.point((h=f[s])[0],h[1]);else a(d.x,d.p.x,-1,o);d=d.p}f=(d=d.o).z,m=!m}while(!d.v);o.lineEnd()}}}function t7(r){if(n=r.length){for(var n,i,a=0,o=r[0];++a<n;)o.n=i=r[a],i.p=o,o=i;o.n=i=r[0],i.p=o}}tK.invert=tK;var et=i();function ee(r){return d(r[0])<=l?r[0]:T(r[0])*((d(r[0])+l)%f-l)}function er(r,n){var i=ee(n),a=n[1],o=w(a),s=[w(i),-v(i),0],h=0,p=0;et.reset(),1===o?a=c+1e-6:-1===o&&(a=-c-1e-6);for(var d=0,m=r.length;d<m;++d)if(x=(y=r[d]).length)for(var y,x,b=y[x-1],_=ee(b),T=b[1]/2+u,k=w(T),A=v(T),M=0;M<x;++M,_=L,k=P,A=I,b=E){var E=y[M],L=ee(E),C=E[1]/2+u,P=w(C),I=v(C),O=L-_,z=O>=0?1:-1,D=z*O,R=D>l,F=k*P;if(et.add(g(F*z*w(D),A*I+F*v(D))),h+=R?O+z*f:O,R^_>=i^L>=i){var B=J(X(b),X(E));$(B);var N=J(s,B);$(N);var j=(R^O>=0?-1:1)*S(N[2]);(a>j||a===j&&(B[0]||B[1]))&&(p+=R^O>=0?1:-1)}}return(h<-.000001||h<1e-6&&et<-.000001)^1&p}function en(r,i,a,o){return function(s){var l,c,u,f=i(s),h=t4(),p=i(h),d=!1,m={point:g,lineStart:y,lineEnd:x,polygonStart:function(){m.point=b,m.lineStart=_,m.lineEnd=w,c=[],l=[]},polygonEnd:function(){m.point=g,m.lineStart=y,m.lineEnd=x,c=n.merge(c);var r=er(l,o);c.length?(d||(s.polygonStart(),d=!0),t9(c,ea,r,a,s)):r&&(d||(s.polygonStart(),d=!0),s.lineStart(),a(null,null,1,s),s.lineEnd()),d&&(s.polygonEnd(),d=!1),c=l=null},sphere:function(){s.polygonStart(),s.lineStart(),a(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function g(n,i){r(n,i)&&s.point(n,i)}function v(r,n){f.point(r,n)}function y(){m.point=v,f.lineStart()}function x(){m.point=g,f.lineEnd()}function b(r,n){u.push([r,n]),p.point(r,n)}function _(){p.lineStart(),u=[]}function w(){b(u[0][0],u[0][1]),p.lineEnd();var r,n,i,a,o=p.clean(),f=h.result(),m=f.length;if(u.pop(),l.push(u),u=null,m){if(1&o){if((n=(i=f[0]).length-1)>0){for(d||(s.polygonStart(),d=!0),s.lineStart(),r=0;r<n;++r)s.point((a=i[r])[0],a[1]);s.lineEnd()}}else m>1&&2&o&&f.push(f.pop().concat(f.shift())),c.push(f.filter(ei))}}return m}}function ei(r){return r.length>1}function ea(r,n){return((r=r.x)[0]<0?r[1]-c-1e-6:c-r[1])-((n=n.x)[0]<0?n[1]-c-1e-6:c-n[1])}var eo=en(function(){return!0},function(r){var n,i=NaN,a=NaN,o=NaN;return{lineStart:function(){r.lineStart(),n=1},point:function(s,u){var f,h,p,g,y,x,b=s>0?l:-l,_=d(s-i);1e-6>d(_-l)?(r.point(i,a=(a+u)/2>0?c:-c),r.point(o,a),r.lineEnd(),r.lineStart(),r.point(b,a),r.point(s,a),n=0):o!==b&&_>=l&&(1e-6>d(i-o)&&(i-=1e-6*o),1e-6>d(s-b)&&(s-=1e-6*b),f=i,h=a,a=d(x=w(f-(p=s)))>1e-6?m((w(h)*(y=v(u))*w(p)-w(u)*(g=v(h))*w(f))/(g*y*x)):(h+u)/2,r.point(o,a),r.lineEnd(),r.lineStart(),r.point(b,a),n=0),r.point(i=s,a=u),o=b},lineEnd:function(){r.lineEnd(),i=a=NaN},clean:function(){return 2-n}}},function(r,n,i,a){var o;if(null==r)o=i*c,a.point(-l,o),a.point(0,o),a.point(l,o),a.point(l,0),a.point(l,-o),a.point(0,-o),a.point(-l,-o),a.point(-l,0),a.point(-l,o);else if(d(r[0]-n[0])>1e-6){var s=r[0]<n[0]?l:-l;o=i*s/2,a.point(-s,o),a.point(0,o),a.point(s,o)}else a.point(n[0],n[1])},[-l,-c]);function es(r){var n=v(r),i=6*p,a=n>0,o=d(n)>1e-6;function s(r,i){return v(r)*v(i)>n}function c(r,i,a){var o=[1,0,0],s=J(X(r),X(i)),c=Z(s,s),u=s[0],f=c-u*u;if(!f)return!a&&r;var h=J(o,s),p=Q(o,n*c/f);K(p,Q(s,-n*u/f));var m=Z(p,h),g=Z(h,h),v=m*m-g*(Z(p,p)-1);if(!(v<0)){var y=k(v),x=Q(h,(-m-y)/g);if(K(x,p),x=W(x),!a)return x;var b,_=r[0],w=i[0],T=r[1],A=i[1];w<_&&(b=_,_=w,w=b);var M=w-_,S=1e-6>d(M-l);if(!S&&A<T&&(b=T,T=A,A=b),S||M<1e-6?S?T+A>0^x[1]<(1e-6>d(x[0]-_)?T:A):T<=x[1]&&x[1]<=A:M>l^(_<=x[0]&&x[0]<=w)){var E=Q(h,(-m+y)/g);return K(E,p),[x,W(E)]}}}function u(n,i){var o=a?r:l-r,s=0;return n<-o?s|=1:n>o&&(s|=2),i<-o?s|=4:i>o&&(s|=8),s}return en(s,function(r){var n,i,f,h,p;return{lineStart:function(){h=f=!1,p=1},point:function(d,m){var g,v,y=[d,m],x=s(d,m),b=a?x?0:u(d,m):x?u(d+(d<0?l:-l),m):0;(!n&&(h=f=x)&&r.lineStart(),x!==f&&(!(v=c(n,y))||t6(n,v)||t6(y,v))&&(y[2]=1),x!==f)?(p=0,x?(r.lineStart(),v=c(y,n),r.point(v[0],v[1])):(v=c(n,y),r.point(v[0],v[1],2),r.lineEnd()),n=v):o&&n&&a^x&&!(b&i)&&(g=c(y,n,!0))&&(p=0,a?(r.lineStart(),r.point(g[0][0],g[0][1]),r.point(g[1][0],g[1][1]),r.lineEnd()):(r.point(g[1][0],g[1][1]),r.lineEnd(),r.lineStart(),r.point(g[0][0],g[0][1],3))),!x||n&&t6(n,y)||r.point(y[0],y[1]),n=y,f=x,i=b},lineEnd:function(){f&&r.lineEnd(),n=null},clean:function(){return p|(h&&f)<<1}}},function(n,a,o,s){t3(s,r,i,o,n,a)},a?[0,-r]:[-l,r-l])}function el(r,i,a,o){function s(n,s){return r<=n&&n<=a&&i<=s&&s<=o}function l(n,s,l,u){var h=0,p=0;if(null==n||(h=c(n,l))!==(p=c(s,l))||0>f(n,s)^l>0)do u.point(0===h||3===h?r:a,h>1?o:i);while((h=(h+l+4)%4)!==p);else u.point(s[0],s[1])}function c(n,o){return 1e-6>d(n[0]-r)?o>0?0:3:1e-6>d(n[0]-a)?o>0?2:1:1e-6>d(n[1]-i)?o>0?1:0:o>0?3:2}function u(r,n){return f(r.x,n.x)}function f(r,n){var i=c(r,1),a=c(n,1);return i!==a?i-a:0===i?n[1]-r[1]:1===i?r[0]-n[0]:2===i?r[1]-n[1]:n[0]-r[0]}return function(c){var f,h,p,d,m,g,v,y,x,b,_,w=c,T=t4(),k={point:A,lineStart:function(){k.point=M,h&&h.push(p=[]),b=!0,x=!1,v=y=NaN},lineEnd:function(){f&&(M(d,m),g&&x&&T.rejoin(),f.push(T.result())),k.point=A,x&&w.lineEnd()},polygonStart:function(){w=T,f=[],h=[],_=!0},polygonEnd:function(){var i=function(){for(var n=0,i=0,a=h.length;i<a;++i)for(var s,l,c=h[i],u=1,f=c.length,p=c[0],d=p[0],m=p[1];u<f;++u)s=d,l=m,d=(p=c[u])[0],m=p[1],l<=o?m>o&&(d-s)*(o-l)>(m-l)*(r-s)&&++n:m<=o&&(d-s)*(o-l)<(m-l)*(r-s)&&--n;return n}(),a=_&&i,s=(f=n.merge(f)).length;(a||s)&&(c.polygonStart(),a&&(c.lineStart(),l(null,null,1,c),c.lineEnd()),s&&t9(f,u,i,l,c),c.polygonEnd()),w=c,f=h=p=null}};function A(r,n){s(r,n)&&w.point(r,n)}function M(n,l){var c=s(n,l);if(h&&p.push([n,l]),b)d=n,m=l,g=c,b=!1,c&&(w.lineStart(),w.point(n,l));else if(c&&x)w.point(n,l);else{var u=[v=Math.max(-1e9,Math.min(1e9,v)),y=Math.max(-1e9,Math.min(1e9,y))],f=[n=Math.max(-1e9,Math.min(1e9,n)),l=Math.max(-1e9,Math.min(1e9,l))];(function(r,n,i,a,o,s){var l,c=r[0],u=r[1],f=0,h=1,p=n[0]-c,d=n[1]-u;if(l=i-c,p||!(l>0)){if(l/=p,p<0){if(l<f)return;l<h&&(h=l)}else if(p>0){if(l>h)return;l>f&&(f=l)}if(l=o-c,p||!(l<0)){if(l/=p,p<0){if(l>h)return;l>f&&(f=l)}else if(p>0){if(l<f)return;l<h&&(h=l)}if(l=a-u,d||!(l>0)){if(l/=d,d<0){if(l<f)return;l<h&&(h=l)}else if(d>0){if(l>h)return;l>f&&(f=l)}if(l=s-u,d||!(l<0)){if(l/=d,d<0){if(l>h)return;l>f&&(f=l)}else if(d>0){if(l<f)return;l<h&&(h=l)}return f>0&&(r[0]=c+f*p,r[1]=u+f*d),h<1&&(n[0]=c+h*p,n[1]=u+h*d),!0}}}}})(u,f,r,i,a,o)?(x||(w.lineStart(),w.point(u[0],u[1])),w.point(f[0],f[1]),c||w.lineEnd(),_=!1):c&&(w.lineStart(),w.point(n,l),_=!1)}v=n,y=l,x=c}return k}}var ec,eu,ef,eh=i(),ep={sphere:E,point:E,lineStart:function(){ep.point=em,ep.lineEnd=ed},lineEnd:E,polygonStart:E,polygonEnd:E};function ed(){ep.point=ep.lineEnd=E}function em(r,n){ec=r*=p,eu=w(n*=p),ef=v(n),ep.point=eg}function eg(r,n){r*=p;var i=w(n*=p),a=v(n),o=d(r-ec),s=v(o),l=a*w(o),c=ef*i-eu*a*s,u=eu*i+ef*a*s;eh.add(g(k(l*l+c*c),u)),ec=r,eu=i,ef=a}function ev(r){return eh.reset(),z(r,ep),+eh}var ey=[null,null],ex={type:"LineString",coordinates:ey};function eb(r,n){return ey[0]=r,ey[1]=n,ev(ex)}var e_={Feature:function(r,n){return eT(r.geometry,n)},FeatureCollection:function(r,n){for(var i=r.features,a=-1,o=i.length;++a<o;)if(eT(i[a].geometry,n))return!0;return!1}},ew={Sphere:function(){return!0},Point:function(r,n){return 0===eb(r.coordinates,n)},MultiPoint:function(r,n){for(var i=r.coordinates,a=-1,o=i.length;++a<o;)if(0===eb(i[a],n))return!0;return!1},LineString:function(r,n){return ek(r.coordinates,n)},MultiLineString:function(r,n){for(var i=r.coordinates,a=-1,o=i.length;++a<o;)if(ek(i[a],n))return!0;return!1},Polygon:function(r,n){return eA(r.coordinates,n)},MultiPolygon:function(r,n){for(var i=r.coordinates,a=-1,o=i.length;++a<o;)if(eA(i[a],n))return!0;return!1},GeometryCollection:function(r,n){for(var i=r.geometries,a=-1,o=i.length;++a<o;)if(eT(i[a],n))return!0;return!1}};function eT(r,n){return!(!r||!ew.hasOwnProperty(r.type))&&ew[r.type](r,n)}function ek(r,n){for(var i,a,o,s=0,l=r.length;s<l;s++){if(0===(a=eb(r[s],n))||s>0&&(o=eb(r[s],r[s-1]))>0&&i<=o&&a<=o&&(i+a-o)*(1-Math.pow((i-a)/o,2))<1e-12*o)return!0;i=a}return!1}function eA(r,n){return!!er(r.map(eM),eS(n))}function eM(r){return(r=r.map(eS)).pop(),r}function eS(r){return[r[0]*p,r[1]*p]}function eE(r,i,a){var o=n.range(r,i-1e-6,a).concat(i);return function(r){return o.map(function(n){return[r,n]})}}function eL(r,i,a){var o=n.range(r,i-1e-6,a).concat(i);return function(r){return o.map(function(n){return[n,r]})}}function eC(){var r,i,a,o,s,l,c,u,f,h,p,m,g=10,v=10,x=90,b=360,_=2.5;function w(){return{type:"MultiLineString",coordinates:T()}}function T(){return n.range(y(o/x)*x,a,x).map(p).concat(n.range(y(u/b)*b,c,b).map(m)).concat(n.range(y(i/g)*g,r,g).filter(function(r){return d(r%x)>1e-6}).map(f)).concat(n.range(y(l/v)*v,s,v).filter(function(r){return d(r%b)>1e-6}).map(h))}return w.lines=function(){return T().map(function(r){return{type:"LineString",coordinates:r}})},w.outline=function(){return{type:"Polygon",coordinates:[p(o).concat(m(c).slice(1),p(a).reverse().slice(1),m(u).reverse().slice(1))]}},w.extent=function(r){return arguments.length?w.extentMajor(r).extentMinor(r):w.extentMinor()},w.extentMajor=function(r){return arguments.length?(o=+r[0][0],a=+r[1][0],u=+r[0][1],c=+r[1][1],o>a&&(r=o,o=a,a=r),u>c&&(r=u,u=c,c=r),w.precision(_)):[[o,u],[a,c]]},w.extentMinor=function(n){return arguments.length?(i=+n[0][0],r=+n[1][0],l=+n[0][1],s=+n[1][1],i>r&&(n=i,i=r,r=n),l>s&&(n=l,l=s,s=n),w.precision(_)):[[i,l],[r,s]]},w.step=function(r){return arguments.length?w.stepMajor(r).stepMinor(r):w.stepMinor()},w.stepMajor=function(r){return arguments.length?(x=+r[0],b=+r[1],w):[x,b]},w.stepMinor=function(r){return arguments.length?(g=+r[0],v=+r[1],w):[g,v]},w.precision=function(n){return arguments.length?(_=+n,f=eE(l,s,90),h=eL(i,r,_),p=eE(u,c,90),m=eL(o,a,_),w):_},w.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function eP(r){return r}var eI,eO,ez,eD,eR=i(),eF=i(),eB={point:E,lineStart:E,lineEnd:E,polygonStart:function(){eB.lineStart=eN,eB.lineEnd=eV},polygonEnd:function(){eB.lineStart=eB.lineEnd=eB.point=E,eR.add(d(eF)),eF.reset()},result:function(){return eR.reset(),eR/2}};function eN(){eB.point=ej}function ej(r,n){eB.point=eU,eI=ez=r,eO=eD=n}function eU(r,n){eF.add(eD*r-ez*n),ez=r,eD=n}function eV(){eU(eI,eO)}var eH,eq,eG,eY,eW=1/0,eX=1/0,eZ=-1/0,eJ=eZ,eK={point:function(r,n){r<eW&&(eW=r),r>eZ&&(eZ=r),n<eX&&(eX=n),n>eJ&&(eJ=n)},lineStart:E,lineEnd:E,polygonStart:E,polygonEnd:E,result:function(){var r=[[eW,eX],[eZ,eJ]];return eZ=eJ=-(eX=eW=1/0),r}},eQ=0,e$=0,e0=0,e1=0,e2=0,e3=0,e5=0,e4=0,e6=0,e8={point:e9,lineStart:e7,lineEnd:rr,polygonStart:function(){e8.lineStart=rn,e8.lineEnd=ri},polygonEnd:function(){e8.point=e9,e8.lineStart=e7,e8.lineEnd=rr},result:function(){var r=e6?[e5/e6,e4/e6]:e3?[e1/e3,e2/e3]:e0?[eQ/e0,e$/e0]:[NaN,NaN];return eQ=e$=e0=e1=e2=e3=e5=e4=e6=0,r}};function e9(r,n){eQ+=r,e$+=n,++e0}function e7(){e8.point=rt}function rt(r,n){e8.point=re,e9(eG=r,eY=n)}function re(r,n){var i=r-eG,a=n-eY,o=k(i*i+a*a);e1+=o*(eG+r)/2,e2+=o*(eY+n)/2,e3+=o,e9(eG=r,eY=n)}function rr(){e8.point=e9}function rn(){e8.point=ra}function ri(){ro(eH,eq)}function ra(r,n){e8.point=ro,e9(eH=eG=r,eq=eY=n)}function ro(r,n){var i=r-eG,a=n-eY,o=k(i*i+a*a);e1+=o*(eG+r)/2,e2+=o*(eY+n)/2,e3+=o,e5+=(o=eY*r-eG*n)*(eG+r),e4+=o*(eY+n),e6+=3*o,e9(eG=r,eY=n)}function rs(r){this._context=r}rs.prototype={_radius:4.5,pointRadius:function(r){return this._radius=r,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(r,n){switch(this._point){case 0:this._context.moveTo(r,n),this._point=1;break;case 1:this._context.lineTo(r,n);break;default:this._context.moveTo(r+this._radius,n),this._context.arc(r,n,this._radius,0,f)}},result:E};var rl,rc,ru,rf,rh,rp=i(),rd={point:E,lineStart:function(){rd.point=rm},lineEnd:function(){rl&&rg(rc,ru),rd.point=E},polygonStart:function(){rl=!0},polygonEnd:function(){rl=null},result:function(){return rp.reset(),+rp}};function rm(r,n){rd.point=rg,rc=rf=r,ru=rh=n}function rg(r,n){rf-=r,rh-=n,rp.add(k(rf*rf+rh*rh)),rf=r,rh=n}function rv(){this._string=[]}function ry(r){return"m0,"+r+"a"+r+","+r+" 0 1,1 0,"+-2*r+"a"+r+","+r+" 0 1,1 0,"+2*r+"z"}function rx(r){return function(n){var i=new rb;for(var a in r)i[a]=r[a];return i.stream=n,i}}function rb(){}function r_(r,n,i){var a=r.clipExtent&&r.clipExtent();return r.scale(150).translate([0,0]),null!=a&&r.clipExtent(null),z(i,r.stream(eK)),n(eK.result()),null!=a&&r.clipExtent(a),r}function rw(r,n,i){return r_(r,function(i){var a=n[1][0]-n[0][0],o=n[1][1]-n[0][1],s=Math.min(a/(i[1][0]-i[0][0]),o/(i[1][1]-i[0][1])),l=+n[0][0]+(a-s*(i[1][0]+i[0][0]))/2,c=+n[0][1]+(o-s*(i[1][1]+i[0][1]))/2;r.scale(150*s).translate([l,c])},i)}function rT(r,n,i){return rw(r,[[0,0],n],i)}function rk(r,n,i){return r_(r,function(i){var a=+n,o=a/(i[1][0]-i[0][0]),s=(a-o*(i[1][0]+i[0][0]))/2,l=-o*i[0][1];r.scale(150*o).translate([s,l])},i)}function rA(r,n,i){return r_(r,function(i){var a=+n,o=a/(i[1][1]-i[0][1]),s=-o*i[0][0],l=(a-o*(i[1][1]+i[0][1]))/2;r.scale(150*o).translate([s,l])},i)}rv.prototype={_radius:4.5,_circle:ry(4.5),pointRadius:function(r){return(r=+r)!==this._radius&&(this._radius=r,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(r,n){switch(this._point){case 0:this._string.push("M",r,",",n),this._point=1;break;case 1:this._string.push("L",r,",",n);break;default:null==this._circle&&(this._circle=ry(this._radius)),this._string.push("M",r,",",n,this._circle)}},result:function(){if(this._string.length){var r=this._string.join("");return this._string=[],r}return null}},rb.prototype={constructor:rb,point:function(r,n){this.stream.point(r,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var rM=v(30*p);function rS(r,n){return+n?function(r,n){function i(a,o,s,l,c,u,f,h,p,m,v,y,x,b){var _=f-a,w=h-o,T=_*_+w*w;if(T>4*n&&x--){var A=l+m,M=c+v,E=u+y,L=k(A*A+M*M+E*E),C=S(E/=L),P=1e-6>d(d(E)-1)||1e-6>d(s-p)?(s+p)/2:g(M,A),I=r(P,C),O=I[0],z=I[1],D=O-a,R=z-o,F=w*D-_*R;(F*F/T>n||d((_*D+w*R)/T-.5)>.3||l*m+c*v+u*y<rM)&&(i(a,o,s,l,c,u,O,z,P,A/=L,M/=L,E,x,b),b.point(O,z),i(O,z,P,A,M,E,f,h,p,m,v,y,x,b))}}return function(n){var a,o,s,l,c,u,f,h,p,d,m,g,v={point:y,lineStart:x,lineEnd:_,polygonStart:function(){n.polygonStart(),v.lineStart=w},polygonEnd:function(){n.polygonEnd(),v.lineStart=x}};function y(i,a){i=r(i,a),n.point(i[0],i[1])}function x(){h=NaN,v.point=b,n.lineStart()}function b(a,o){var s=X([a,o]),l=r(a,o);i(h,p,f,d,m,g,h=l[0],p=l[1],f=a,d=s[0],m=s[1],g=s[2],16,n),n.point(h,p)}function _(){v.point=y,n.lineEnd()}function w(){x(),v.point=T,v.lineEnd=k}function T(r,n){b(a=r,n),o=h,s=p,l=d,c=m,u=g,v.point=b}function k(){i(h,p,f,d,m,g,o,s,a,l,c,u,16,n),v.lineEnd=_,_()}return v}}(r,n):rx({point:function(n,i){n=r(n,i),this.stream.point(n[0],n[1])}})}var rE=rx({point:function(r,n){this.stream.point(r*p,n*p)}});function rL(r,n,i,a,o,s){var l=v(s),c=w(s),u=l*r,f=c*r,h=l/r,p=c/r,d=(c*i-l*n)/r,m=(c*n+l*i)/r;function g(r,s){return[u*(r*=a)-f*(s*=o)+n,i-f*r-u*s]}return g.invert=function(r,n){return[a*(h*r-p*n+d),o*(m-p*r-h*n)]},g}function rC(r){return rP(function(){return r})()}function rP(r){var n,i,a,o,s,l,c,u,f,d,m=150,g=480,v=250,y=0,x=0,b=0,_=0,w=0,T=0,A=1,M=1,S=null,E=eo,L=null,C=eP,P=.5;function I(r){return u(r[0]*p,r[1]*p)}function O(r){return(r=u.invert(r[0],r[1]))&&[r[0]*h,r[1]*h]}function z(){var r=rL(m,0,0,A,M,T).apply(null,n(y,x)),a=(T?rL:function(r,n,i,a,o){function s(s,l){return[n+r*(s*=a),i-r*(l*=o)]}return s.invert=function(s,l){return[(s-n)/r*a,(i-l)/r*o]},s})(m,g-r[0],v-r[1],A,M,T);return i=tQ(b,_,w),c=tJ(n,a),u=tJ(i,c),l=rS(c,P),D()}function D(){return f=d=null,I}return I.stream=function(r){var n;return f&&d===r?f:f=rE((n=i,rx({point:function(r,i){var a=n(r,i);return this.stream.point(a[0],a[1])}}))(E(l(C(d=r)))))},I.preclip=function(r){return arguments.length?(E=r,S=void 0,D()):E},I.postclip=function(r){return arguments.length?(C=r,L=a=o=s=null,D()):C},I.clipAngle=function(r){return arguments.length?(E=+r?es(S=r*p):(S=null,eo),D()):S*h},I.clipExtent=function(r){return arguments.length?(C=null==r?(L=a=o=s=null,eP):el(L=+r[0][0],a=+r[0][1],o=+r[1][0],s=+r[1][1]),D()):null==L?null:[[L,a],[o,s]]},I.scale=function(r){return arguments.length?(m=+r,z()):m},I.translate=function(r){return arguments.length?(g=+r[0],v=+r[1],z()):[g,v]},I.center=function(r){return arguments.length?(y=r[0]%360*p,x=r[1]%360*p,z()):[y*h,x*h]},I.rotate=function(r){return arguments.length?(b=r[0]%360*p,_=r[1]%360*p,w=r.length>2?r[2]%360*p:0,z()):[b*h,_*h,w*h]},I.angle=function(r){return arguments.length?(T=r%360*p,z()):T*h},I.reflectX=function(r){return arguments.length?(A=r?-1:1,z()):A<0},I.reflectY=function(r){return arguments.length?(M=r?-1:1,z()):M<0},I.precision=function(r){return arguments.length?(l=rS(c,P=r*r),D()):k(P)},I.fitExtent=function(r,n){return rw(I,r,n)},I.fitSize=function(r,n){return rT(I,r,n)},I.fitWidth=function(r,n){return rk(I,r,n)},I.fitHeight=function(r,n){return rA(I,r,n)},function(){return n=r.apply(this,arguments),I.invert=n.invert&&O,z()}}function rI(r){var n=0,i=l/3,a=rP(r),o=a(n,i);return o.parallels=function(r){return arguments.length?a(n=r[0]*p,i=r[1]*p):[n*h,i*h]},o}function rO(r,n){var i=w(r),a=(i+w(n))/2;if(1e-6>d(a))return function(r){var n=v(r);function i(r,i){return[r*n,w(i)/n]}return i.invert=function(r,i){return[r/n,S(i*n)]},i}(r);var o=1+i*(2*a-i),s=k(o)/a;function c(r,n){var i=k(o-2*a*w(n))/a;return[i*w(r*=a),s-i*v(r)]}return c.invert=function(r,n){var i=s-n,c=g(r,d(i))*T(i);return i*a<0&&(c-=l*T(r)*T(i)),[c/a,S((o-(r*r+i*i)*a*a)/(2*a))]},c}function rz(){return rI(rO).scale(155.424).center([0,33.6442])}function rD(){return rz().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function rR(r){return function(n,i){var a=v(n),o=v(i),s=r(a*o);return[s*o*w(n),s*w(i)]}}function rF(r){return function(n,i){var a=k(n*n+i*i),o=r(a),s=w(o);return[g(n*s,a*v(o)),S(a&&i*s/a)]}}var rB=rR(function(r){return k(2/(1+r))});rB.invert=rF(function(r){return 2*S(r/2)});var rN=rR(function(r){return(r=M(r))&&r/w(r)});function rj(r,n){return[r,b(A((c+n)/2))]}function rU(r){var n,i,a,o=rC(r),s=o.center,c=o.scale,u=o.translate,f=o.clipExtent,h=null;function p(){var s=l*c(),u=o(t2(o.rotate()).invert([0,0]));return f(null==h?[[u[0]-s,u[1]-s],[u[0]+s,u[1]+s]]:r===rj?[[Math.max(u[0]-s,h),n],[Math.min(u[0]+s,i),a]]:[[h,Math.max(u[1]-s,n)],[i,Math.min(u[1]+s,a)]])}return o.scale=function(r){return arguments.length?(c(r),p()):c()},o.translate=function(r){return arguments.length?(u(r),p()):u()},o.center=function(r){return arguments.length?(s(r),p()):s()},o.clipExtent=function(r){return arguments.length?(null==r?h=n=i=a=null:(h=+r[0][0],n=+r[0][1],i=+r[1][0],a=+r[1][1]),p()):null==h?null:[[h,n],[i,a]]},p()}function rV(r){return A((c+r)/2)}function rH(r,n){var i=v(r),a=r===n?w(r):b(i/v(n))/b(rV(n)/rV(r)),o=i*_(rV(r),a)/a;if(!a)return rj;function s(r,n){o>0?n<-c+1e-6&&(n=-c+1e-6):n>c-1e-6&&(n=c-1e-6);var i=o/_(rV(n),a);return[i*w(a*r),o-i*v(a*r)]}return s.invert=function(r,n){var i=o-n,s=T(a)*k(r*r+i*i),u=g(r,d(i))*T(i);return i*a<0&&(u-=l*T(r)*T(i)),[u/a,2*m(_(o/s,1/a))-c]},s}function rq(r,n){return[r,n]}function rG(r,n){var i=v(r),a=r===n?w(r):(i-v(n))/(n-r),o=i/a+r;if(1e-6>d(a))return rq;function s(r,n){var i=o-n,s=a*r;return[i*w(s),o-i*v(s)]}return s.invert=function(r,n){var i=o-n,s=g(r,d(i))*T(i);return i*a<0&&(s-=l*T(r)*T(i)),[s/a,o-T(a)*k(r*r+i*i)]},s}rN.invert=rF(function(r){return r}),rj.invert=function(r,n){return[r,2*m(x(n))-c]},rq.invert=rq;var rY=k(3)/2;function rW(r,n){var i=S(rY*w(n)),a=i*i,o=a*a*a;return[r*v(i)/(rY*(1.340264+-.24331799999999998*a+o*(.0062510000000000005+.034164*a))),i*(1.340264+-.081106*a+o*(893e-6+.003796*a))]}function rX(r,n){var i=v(n),a=v(r)*i;return[i*w(r)/a,w(n)/a]}function rZ(r,n){var i=n*n,a=i*i;return[r*(.8707-.131979*i+a*(a*(.003971*i-.001529*a)-.013791)),n*(1.007226+i*(.015085+a*(.028874*i-.044475-.005916*a)))]}function rJ(r,n){return[v(n)*w(r),w(n)]}function rK(r,n){var i=v(n),a=1+v(r)*i;return[i*w(r)/a,w(n)/a]}function rQ(r,n){return[b(A((c+n)/2)),-r]}rW.invert=function(r,n){for(var i,a=n,o=a*a,s=o*o*o,l=0;l<12&&(s=(o=(a-=i=(a*(1.340264+-.081106*o+s*(893e-6+.003796*o))-n)/(1.340264+-.24331799999999998*o+s*(.0062510000000000005+.034164*o)))*a)*o*o,!(1e-12>d(i)));++l);return[rY*r*(1.340264+-.24331799999999998*o+s*(.0062510000000000005+.034164*o))/v(a),S(w(a)/rY)]},rX.invert=rF(m),rZ.invert=function(r,n){var i,a=n,o=25;do{var s=a*a,l=s*s;a-=i=(a*(1.007226+s*(.015085+l*(.028874*s-.044475-.005916*l)))-n)/(1.007226+s*(.045255+l*(.259866*s-.311325-.005916*11*l)))}while(d(i)>1e-6&&--o>0);return[r/(.8707+(s=a*a)*(s*(s*s*s*(.003971-.001529*s)-.013791)-.131979)),a]},rJ.invert=rF(S),rK.invert=rF(function(r){return 2*m(r)}),rQ.invert=function(r,n){return[-n,2*m(x(r))-c]},r.geoAlbers=rD,r.geoAlbersUsa=function(){var r,n,i,a,o,s,l=rD(),c=rz().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=rz().rotate([157,0]).center([-3,19.9]).parallels([8,18]),f={point:function(r,n){s=[r,n]}};function h(r){var n=r[0],l=r[1];return s=null,i.point(n,l),s||(a.point(n,l),s)||(o.point(n,l),s)}function p(){return r=n=null,h}return h.invert=function(r){var n=l.scale(),i=l.translate(),a=(r[0]-i[0])/n,o=(r[1]-i[1])/n;return(o>=.12&&o<.234&&a>=-.425&&a<-.214?c:o>=.166&&o<.234&&a>=-.214&&a<-.115?u:l).invert(r)},h.stream=function(i){var a,o;return r&&n===i?r:(o=(a=[l.stream(n=i),c.stream(i),u.stream(i)]).length,r={point:function(r,n){for(var i=-1;++i<o;)a[i].point(r,n)},sphere:function(){for(var r=-1;++r<o;)a[r].sphere()},lineStart:function(){for(var r=-1;++r<o;)a[r].lineStart()},lineEnd:function(){for(var r=-1;++r<o;)a[r].lineEnd()},polygonStart:function(){for(var r=-1;++r<o;)a[r].polygonStart()},polygonEnd:function(){for(var r=-1;++r<o;)a[r].polygonEnd()}})},h.precision=function(r){return arguments.length?(l.precision(r),c.precision(r),u.precision(r),p()):l.precision()},h.scale=function(r){return arguments.length?(l.scale(r),c.scale(.35*r),u.scale(r),h.translate(l.translate())):l.scale()},h.translate=function(r){if(!arguments.length)return l.translate();var n=l.scale(),s=+r[0],h=+r[1];return i=l.translate(r).clipExtent([[s-.455*n,h-.238*n],[s+.455*n,h+.238*n]]).stream(f),a=c.translate([s-.307*n,h+.201*n]).clipExtent([[s-.425*n+1e-6,h+.12*n+1e-6],[s-.214*n-1e-6,h+.234*n-1e-6]]).stream(f),o=u.translate([s-.205*n,h+.212*n]).clipExtent([[s-.214*n+1e-6,h+.166*n+1e-6],[s-.115*n-1e-6,h+.234*n-1e-6]]).stream(f),p()},h.fitExtent=function(r,n){return rw(h,r,n)},h.fitSize=function(r,n){return rT(h,r,n)},h.fitWidth=function(r,n){return rk(h,r,n)},h.fitHeight=function(r,n){return rA(h,r,n)},h.scale(1070)},r.geoArea=function(r){return U.reset(),z(r,V),2*U},r.geoAzimuthalEqualArea=function(){return rC(rB).scale(124.75).clipAngle(179.999)},r.geoAzimuthalEqualAreaRaw=rB,r.geoAzimuthalEquidistant=function(){return rC(rN).scale(79.4188).clipAngle(179.999)},r.geoAzimuthalEquidistantRaw=rN,r.geoBounds=function(r){var n,i,a,o,s,l,c;if(tn=tr=-(tt=te=1/0),tl=[],z(r,tS),i=tl.length){for(tl.sort(tR),n=1,s=[a=tl[0]];n<i;++n)tF(a,(o=tl[n])[0])||tF(a,o[1])?(tD(a[0],o[1])>tD(a[0],a[1])&&(a[1]=o[1]),tD(o[0],a[1])>tD(a[0],a[1])&&(a[0]=o[0])):s.push(a=o);for(l=-1/0,n=0,a=s[i=s.length-1];n<=i;a=o,++n)o=s[n],(c=tD(a[1],o[0]))>l&&(l=c,tt=o[0],tr=a[1])}return tl=tc=null,tt===1/0||te===1/0?[[NaN,NaN],[NaN,NaN]]:[[tt,te],[tr,tn]]},r.geoCentroid=function(r){tu=tf=th=tp=td=tm=tg=tv=ty=tx=tb=0,z(r,tB);var n=ty,i=tx,a=tb,o=n*n+i*i+a*a;return o<1e-12&&(n=tm,i=tg,a=tv,tf<1e-6&&(n=th,i=tp,a=td),(o=n*n+i*i+a*a)<1e-12)?[NaN,NaN]:[g(i,n)*h,S(a/k(o))*h]},r.geoCircle=function(){var r,n,i=tZ([0,0]),a=tZ(90),o=tZ(6),s={point:function(i,a){r.push(i=n(i,a)),i[0]*=h,i[1]*=h}};function l(){var l=i.apply(this,arguments),c=a.apply(this,arguments)*p,u=o.apply(this,arguments)*p;return r=[],n=tQ(-l[0]*p,-l[1]*p,0).invert,t3(s,c,u,1),l={type:"Polygon",coordinates:[r]},r=n=null,l}return l.center=function(r){return arguments.length?(i="function"==typeof r?r:tZ([+r[0],+r[1]]),l):i},l.radius=function(r){return arguments.length?(a="function"==typeof r?r:tZ(+r),l):a},l.precision=function(r){return arguments.length?(o="function"==typeof r?r:tZ(+r),l):o},l},r.geoClipAntimeridian=eo,r.geoClipCircle=es,r.geoClipExtent=function(){var r,n,i,a=0,o=0,s=960,l=500;return i={stream:function(i){return r&&n===i?r:r=el(a,o,s,l)(n=i)},extent:function(c){return arguments.length?(a=+c[0][0],o=+c[0][1],s=+c[1][0],l=+c[1][1],r=n=null,i):[[a,o],[s,l]]}}},r.geoClipRectangle=el,r.geoConicConformal=function(){return rI(rH).scale(109.5).parallels([30,30])},r.geoConicConformalRaw=rH,r.geoConicEqualArea=rz,r.geoConicEqualAreaRaw=rO,r.geoConicEquidistant=function(){return rI(rG).scale(131.154).center([0,13.9389])},r.geoConicEquidistantRaw=rG,r.geoContains=function(r,n){return(r&&e_.hasOwnProperty(r.type)?e_[r.type]:eT)(r,n)},r.geoDistance=eb,r.geoEqualEarth=function(){return rC(rW).scale(177.158)},r.geoEqualEarthRaw=rW,r.geoEquirectangular=function(){return rC(rq).scale(152.63)},r.geoEquirectangularRaw=rq,r.geoGnomonic=function(){return rC(rX).scale(144.049).clipAngle(60)},r.geoGnomonicRaw=rX,r.geoGraticule=eC,r.geoGraticule10=function(){return eC()()},r.geoIdentity=function(){var r,n,i,a,o,s,l,c=1,u=0,f=0,d=1,m=1,g=0,y=null,x=1,b=1,_=rx({point:function(r,n){var i=A([r,n]);this.stream.point(i[0],i[1])}}),T=eP;function k(){return x=c*d,b=c*m,s=l=null,A}function A(i){var a=i[0]*x,o=i[1]*b;if(g){var s=o*r-a*n;a=a*r+o*n,o=s}return[a+u,o+f]}return A.invert=function(i){var a=i[0]-u,o=i[1]-f;if(g){var s=o*r+a*n;a=a*r-o*n,o=s}return[a/x,o/b]},A.stream=function(r){return s&&l===r?s:s=_(T(l=r))},A.postclip=function(r){return arguments.length?(T=r,y=i=a=o=null,k()):T},A.clipExtent=function(r){return arguments.length?(T=null==r?(y=i=a=o=null,eP):el(y=+r[0][0],i=+r[0][1],a=+r[1][0],o=+r[1][1]),k()):null==y?null:[[y,i],[a,o]]},A.scale=function(r){return arguments.length?(c=+r,k()):c},A.translate=function(r){return arguments.length?(u=+r[0],f=+r[1],k()):[u,f]},A.angle=function(i){return arguments.length?(n=w(g=i%360*p),r=v(g),k()):g*h},A.reflectX=function(r){return arguments.length?(d=r?-1:1,k()):d<0},A.reflectY=function(r){return arguments.length?(m=r?-1:1,k()):m<0},A.fitExtent=function(r,n){return rw(A,r,n)},A.fitSize=function(r,n){return rT(A,r,n)},A.fitWidth=function(r,n){return rk(A,r,n)},A.fitHeight=function(r,n){return rA(A,r,n)},A},r.geoInterpolate=function(r,n){var i,a,o=r[0]*p,s=r[1]*p,l=n[0]*p,c=n[1]*p,u=v(s),f=w(s),d=v(c),m=w(c),y=u*v(o),x=u*w(o),b=d*v(l),_=d*w(l),T=2*S(k((i=w((i=c-s)/2))*i+u*d*((a=w((a=l-o)/2))*a))),A=w(T),M=T?function(r){var n=w(r*=T)/A,i=w(T-r)/A,a=i*y+n*b,o=i*x+n*_;return[g(o,a)*h,g(i*f+n*m,k(a*a+o*o))*h]}:function(){return[o*h,s*h]};return M.distance=T,M},r.geoLength=ev,r.geoMercator=function(){return rU(rj).scale(961/f)},r.geoMercatorRaw=rj,r.geoNaturalEarth1=function(){return rC(rZ).scale(175.295)},r.geoNaturalEarth1Raw=rZ,r.geoOrthographic=function(){return rC(rJ).scale(249.5).clipAngle(90.000001)},r.geoOrthographicRaw=rJ,r.geoPath=function(r,n){var i,a,o=4.5;function s(r){return r&&("function"==typeof o&&a.pointRadius(+o.apply(this,arguments)),z(r,i(a))),a.result()}return s.area=function(r){return z(r,i(eB)),eB.result()},s.measure=function(r){return z(r,i(rd)),rd.result()},s.bounds=function(r){return z(r,i(eK)),eK.result()},s.centroid=function(r){return z(r,i(e8)),e8.result()},s.projection=function(n){return arguments.length?(i=null==n?(r=null,eP):(r=n).stream,s):r},s.context=function(r){return arguments.length?(a=null==r?(n=null,new rv):new rs(n=r),"function"!=typeof o&&a.pointRadius(o),s):n},s.pointRadius=function(r){return arguments.length?(o="function"==typeof r?r:(a.pointRadius(+r),+r),s):o},s.projection(r).context(n)},r.geoProjection=rC,r.geoProjectionMutator=rP,r.geoRotation=t2,r.geoStereographic=function(){return rC(rK).scale(250).clipAngle(142)},r.geoStereographicRaw=rK,r.geoStream=z,r.geoTransform=function(r){return{stream:rx(r)}},r.geoTransverseMercator=function(){var r=rU(rQ),n=r.center,i=r.rotate;return r.center=function(r){return arguments.length?n([-r[1],r[0]]):[(r=n())[1],-r[0]]},r.rotate=function(r){return arguments.length?i([r[0],r[1],r.length>2?r[2]+90:90]):[(r=i())[0],r[1],r[2]-90]},i([0,0,90]).scale(159.155)},r.geoTransverseMercatorRaw=rQ,Object.defineProperty(r,"__esModule",{value:!0})},"object"==typeof i&&void 0!==n?o(i,r("d3-array")):o((a=a||self).d3=a.d3||{},a.d3)},{"d3-array":107}],115:[function(r,n,i){var a;a=this,function(r){"use strict";function n(r,n){return r.parent===n.parent?1:2}function i(r,n){return r+n.x}function a(r,n){return Math.max(r,n.y)}function o(r){var n=0,i=r.children,a=i&&i.length;if(a)for(;--a>=0;)n+=i[a].value;else n=1;r.value=n}function s(r,n){var i,a,o,s,c,h=new f(r),p=+r.value&&(h.value=r.value),d=[h];for(null==n&&(n=l);i=d.pop();)if(p&&(i.value=+i.data.value),(o=n(i.data))&&(c=o.length))for(i.children=Array(c),s=c-1;s>=0;--s)d.push(a=i.children[s]=new f(o[s])),a.parent=i,a.depth=i.depth+1;return h.eachBefore(u)}function l(r){return r.children}function c(r){r.data=r.data.data}function u(r){var n=0;do r.height=n;while((r=r.parent)&&r.height<++n)}function f(r){this.data=r,this.depth=this.height=0,this.parent=null}f.prototype=s.prototype={constructor:f,count:function(){return this.eachAfter(o)},each:function(r){var n,i,a,o,s=this,l=[s];do for(n=l.reverse(),l=[];s=n.pop();)if(r(s),i=s.children)for(a=0,o=i.length;a<o;++a)l.push(i[a]);while(l.length);return this},eachAfter:function(r){for(var n,i,a,o=this,s=[o],l=[];o=s.pop();)if(l.push(o),n=o.children)for(i=0,a=n.length;i<a;++i)s.push(n[i]);for(;o=l.pop();)r(o);return this},eachBefore:function(r){for(var n,i,a=this,o=[a];a=o.pop();)if(r(a),n=a.children)for(i=n.length-1;i>=0;--i)o.push(n[i]);return this},sum:function(r){return this.eachAfter(function(n){for(var i=+r(n.data)||0,a=n.children,o=a&&a.length;--o>=0;)i+=a[o].value;n.value=i})},sort:function(r){return this.eachBefore(function(n){n.children&&n.children.sort(r)})},path:function(r){for(var n=this,i=function(r,n){if(r===n)return r;var i=r.ancestors(),a=n.ancestors(),o=null;for(r=i.pop(),n=a.pop();r===n;)o=r,r=i.pop(),n=a.pop();return o}(n,r),a=[n];n!==i;)a.push(n=n.parent);for(var o=a.length;r!==i;)a.splice(o,0,r),r=r.parent;return a},ancestors:function(){for(var r=this,n=[r];r=r.parent;)n.push(r);return n},descendants:function(){var r=[];return this.each(function(n){r.push(n)}),r},leaves:function(){var r=[];return this.eachBefore(function(n){n.children||r.push(n)}),r},links:function(){var r=this,n=[];return r.each(function(i){i!==r&&n.push({source:i.parent,target:i})}),n},copy:function(){return s(this).eachBefore(c)}};var h=Array.prototype.slice;function p(r){for(var n,i,a=0,o=(r=function(r){for(var n,i,a=r.length;a;)i=Math.random()*a--|0,n=r[a],r[a]=r[i],r[i]=n;return r}(h.call(r))).length,s=[];a<o;)n=r[a],i&&m(i,n)?++a:(i=function(r){var n;switch(r.length){case 1:return{x:(n=r[0]).x,y:n.y,r:n.r};case 2:return v(r[0],r[1]);case 3:return y(r[0],r[1],r[2])}}(s=function(r,n){var i,a;if(g(n,r))return[n];for(i=0;i<r.length;++i)if(d(n,r[i])&&g(v(r[i],n),r))return[r[i],n];for(i=0;i<r.length-1;++i)for(a=i+1;a<r.length;++a)if(d(v(r[i],r[a]),n)&&d(v(r[i],n),r[a])&&d(v(r[a],n),r[i])&&g(y(r[i],r[a],n),r))return[r[i],r[a],n];throw Error()}(s,n)),a=0);return i}function d(r,n){var i=r.r-n.r,a=n.x-r.x,o=n.y-r.y;return i<0||i*i<a*a+o*o}function m(r,n){var i=r.r-n.r+1e-6,a=n.x-r.x,o=n.y-r.y;return i>0&&i*i>a*a+o*o}function g(r,n){for(var i=0;i<n.length;++i)if(!m(r,n[i]))return!1;return!0}function v(r,n){var i=r.x,a=r.y,o=r.r,s=n.x,l=n.y,c=n.r,u=s-i,f=l-a,h=c-o,p=Math.sqrt(u*u+f*f);return{x:(i+s+u/p*h)/2,y:(a+l+f/p*h)/2,r:(p+o+c)/2}}function y(r,n,i){var a=r.x,o=r.y,s=r.r,l=n.x,c=n.y,u=n.r,f=i.x,h=i.y,p=i.r,d=a-l,m=a-f,g=o-c,v=o-h,y=u-s,x=p-s,b=a*a+o*o-s*s,_=b-l*l-c*c+u*u,w=b-f*f-h*h+p*p,T=m*g-d*v,k=(g*w-v*_)/(2*T)-a,A=(v*y-g*x)/T,M=(m*_-d*w)/(2*T)-o,S=(d*x-m*y)/T,E=A*A+S*S-1,L=2*(s+k*A+M*S),C=k*k+M*M-s*s,P=-(E?(L+Math.sqrt(L*L-4*E*C))/(2*E):C/L);return{x:a+k+A*P,y:o+M+S*P,r:P}}function x(r,n,i){var a,o,s,l,c=r.x-n.x,u=r.y-n.y,f=c*c+u*u;f?(o=n.r+i.r,o*=o,l=r.r+i.r,o>(l*=l)?(a=(f+l-o)/(2*f),s=Math.sqrt(Math.max(0,l/f-a*a)),i.x=r.x-a*c-s*u,i.y=r.y-a*u+s*c):(a=(f+o-l)/(2*f),s=Math.sqrt(Math.max(0,o/f-a*a)),i.x=n.x+a*c-s*u,i.y=n.y+a*u+s*c)):(i.x=n.x+i.r,i.y=n.y)}function b(r,n){var i=r.r+n.r-1e-6,a=n.x-r.x,o=n.y-r.y;return i>0&&i*i>a*a+o*o}function _(r){var n=r._,i=r.next._,a=n.r+i.r,o=(n.x*i.r+i.x*n.r)/a,s=(n.y*i.r+i.y*n.r)/a;return o*o+s*s}function w(r){this._=r,this.next=null,this.previous=null}function T(r){var n,i,a,o,s,l,c,u,f,h,d;if(!(o=r.length))return 0;if((n=r[0]).x=0,n.y=0,!(o>1))return n.r;if(i=r[1],n.x=-i.r,i.x=n.r,i.y=0,!(o>2))return n.r+i.r;x(i,n,a=r[2]),n=new w(n),i=new w(i),a=new w(a),n.next=a.previous=i,i.next=n.previous=a,a.next=i.previous=n;t:for(c=3;c<o;++c){x(n._,i._,a=r[c]),a=new w(a),u=i.next,f=n.previous,h=i._.r,d=n._.r;do if(h<=d){if(b(u._,a._)){i=u,n.next=i,i.previous=n,--c;continue t}h+=u._.r,u=u.next}else{if(b(f._,a._)){(n=f).next=i,i.previous=n,--c;continue t}d+=f._.r,f=f.previous}while(u!==f.next);for(a.previous=n,a.next=i,n.next=i.previous=i=a,s=_(n);(a=a.next)!==i;)(l=_(a))<s&&(n=a,s=l);i=n.next}for(n=[i._],a=i;(a=a.next)!==i;)n.push(a._);for(a=p(n),c=0;c<o;++c)(n=r[c]).x-=a.x,n.y-=a.y;return a.r}function k(r){if("function"!=typeof r)throw Error();return r}function A(){return 0}function M(r){return function(){return r}}function S(r){return Math.sqrt(r.value)}function E(r){return function(n){n.children||(n.r=Math.max(0,+r(n)||0))}}function L(r,n){return function(i){if(a=i.children){var a,o,s,l=a.length,c=r(i)*n||0;if(c)for(o=0;o<l;++o)a[o].r+=c;if(s=T(a),c)for(o=0;o<l;++o)a[o].r-=c;i.r=s+c}}}function C(r){return function(n){var i=n.parent;n.r*=r,i&&(n.x=i.x+r*n.x,n.y=i.y+r*n.y)}}function P(r){r.x0=Math.round(r.x0),r.y0=Math.round(r.y0),r.x1=Math.round(r.x1),r.y1=Math.round(r.y1)}function I(r,n,i,a,o){for(var s,l=r.children,c=-1,u=l.length,f=r.value&&(a-n)/r.value;++c<u;)(s=l[c]).y0=i,s.y1=o,s.x0=n,s.x1=n+=s.value*f}var O={depth:-1},z={};function D(r){return r.id}function R(r){return r.parentId}function F(r,n){return r.parent===n.parent?1:2}function B(r){var n=r.children;return n?n[0]:r.t}function N(r){var n=r.children;return n?n[n.length-1]:r.t}function j(r,n){this._=r,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}function U(r,n,i,a,o){for(var s,l=r.children,c=-1,u=l.length,f=r.value&&(o-i)/r.value;++c<u;)(s=l[c]).x0=n,s.x1=a,s.y0=i,s.y1=i+=s.value*f}j.prototype=Object.create(f.prototype);var V=(1+Math.sqrt(5))/2;function H(r,n,i,a,o,s){for(var l,c,u,f,h,p,d,m,g,v,y,x=[],b=n.children,_=0,w=0,T=b.length,k=n.value;_<T;){u=o-i,f=s-a;do h=b[w++].value;while(!h&&w<T);for(p=d=h,g=Math.max(d/(y=h*h*(v=Math.max(f/u,u/f)/(k*r))),y/p);w<T;++w){if(h+=c=b[w].value,c<p&&(p=c),c>d&&(d=c),(m=Math.max(d/(y=h*h*v),y/p))>g){h-=c;break}g=m}x.push(l={value:h,dice:u<f,children:b.slice(_,w)}),l.dice?I(l,i,a,o,k?a+=f*h/k:s):U(l,i,a,k?i+=u*h/k:o,s),k-=h,_=w}return x}var q=function r(n){function i(r,i,a,o,s){H(n,r,i,a,o,s)}return i.ratio=function(n){return r((n=+n)>1?n:1)},i}(V),G=function r(n){function i(r,i,a,o,s){if((l=r._squarify)&&l.ratio===n)for(var l,c,u,f,h,p=-1,d=l.length,m=r.value;++p<d;){for(u=(c=l[p]).children,f=c.value=0,h=u.length;f<h;++f)c.value+=u[f].value;c.dice?I(c,i,a,o,a+=(s-a)*c.value/m):U(c,i,a,i+=(o-i)*c.value/m,s),m-=c.value}else r._squarify=l=H(n,r,i,a,o,s),l.ratio=n}return i.ratio=function(n){return r((n=+n)>1?n:1)},i}(V);r.cluster=function(){var r=n,o=1,s=1,l=!1;function c(n){var c,u=0;n.eachAfter(function(n){var o=n.children;o?(n.x=o.reduce(i,0)/o.length,n.y=1+o.reduce(a,0)):(n.x=c?u+=r(n,c):0,n.y=0,c=n)});var f=function(r){for(var n;n=r.children;)r=n[0];return r}(n),h=function(r){for(var n;n=r.children;)r=n[n.length-1];return r}(n),p=f.x-r(f,h)/2,d=h.x+r(h,f)/2;return n.eachAfter(l?function(r){r.x=(r.x-n.x)*o,r.y=(n.y-r.y)*s}:function(r){r.x=(r.x-p)/(d-p)*o,r.y=(1-(n.y?r.y/n.y:1))*s})}return c.separation=function(n){return arguments.length?(r=n,c):r},c.size=function(r){return arguments.length?(l=!1,o=+r[0],s=+r[1],c):l?null:[o,s]},c.nodeSize=function(r){return arguments.length?(l=!0,o=+r[0],s=+r[1],c):l?[o,s]:null},c},r.hierarchy=s,r.pack=function(){var r=null,n=1,i=1,a=A;function o(o){return o.x=n/2,o.y=i/2,r?o.eachBefore(E(r)).eachAfter(L(a,.5)).eachBefore(C(1)):o.eachBefore(E(S)).eachAfter(L(A,1)).eachAfter(L(a,o.r/Math.min(n,i))).eachBefore(C(Math.min(n,i)/(2*o.r))),o}return o.radius=function(n){return arguments.length?(r=null==n?null:k(n),o):r},o.size=function(r){return arguments.length?(n=+r[0],i=+r[1],o):[n,i]},o.padding=function(r){return arguments.length?(a="function"==typeof r?r:M(+r),o):a},o},r.packEnclose=p,r.packSiblings=function(r){return T(r),r},r.partition=function(){var r=1,n=1,i=0,a=!1;function o(o){var s,l=o.height+1;return o.x0=o.y0=i,o.x1=r,o.y1=n/l,o.eachBefore((s=n,function(r){r.children&&I(r,r.x0,s*(r.depth+1)/l,r.x1,s*(r.depth+2)/l);var n=r.x0,a=r.y0,o=r.x1-i,c=r.y1-i;o<n&&(n=o=(n+o)/2),c<a&&(a=c=(a+c)/2),r.x0=n,r.y0=a,r.x1=o,r.y1=c})),a&&o.eachBefore(P),o}return o.round=function(r){return arguments.length?(a=!!r,o):a},o.size=function(i){return arguments.length?(r=+i[0],n=+i[1],o):[r,n]},o.padding=function(r){return arguments.length?(i=+r,o):i},o},r.stratify=function(){var r=D,n=R;function i(i){var a,o,s,l,c,h,p,d=i.length,m=Array(d),g={};for(o=0;o<d;++o)a=i[o],c=m[o]=new f(a),null!=(h=r(a,o,i))&&(h+="")&&(g[p="$"+(c.id=h)]=p in g?z:c);for(o=0;o<d;++o)if(c=m[o],null!=(h=n(i[o],o,i))&&(h+="")){if(!(l=g["$"+h]))throw Error("missing: "+h);if(l===z)throw Error("ambiguous: "+h);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(s)throw Error("multiple roots");s=c}if(!s)throw Error("no root");if(s.parent=O,s.eachBefore(function(r){r.depth=r.parent.depth+1,--d}).eachBefore(u),s.parent=null,d>0)throw Error("cycle");return s}return i.id=function(n){return arguments.length?(r=k(n),i):r},i.parentId=function(r){return arguments.length?(n=k(r),i):n},i},r.tree=function(){var r=F,n=1,i=1,a=null;function o(o){var u=function(r){for(var n,i,a,o,s,l=new j(r,0),c=[l];n=c.pop();)if(a=n._.children)for(n.children=Array(s=a.length),o=s-1;o>=0;--o)c.push(i=n.children[o]=new j(a[o],o)),i.parent=n;return(l.parent=new j(null,0)).children=[l],l}(o);if(u.eachAfter(s),u.parent.m=-u.z,u.eachBefore(l),a)o.eachBefore(c);else{var f=o,h=o,p=o;o.eachBefore(function(r){r.x<f.x&&(f=r),r.x>h.x&&(h=r),r.depth>p.depth&&(p=r)});var d=f===h?1:r(f,h)/2,m=d-f.x,g=n/(h.x+d+m),v=i/(p.depth||1);o.eachBefore(function(r){r.x=(r.x+m)*g,r.y=r.depth*v})}return o}function s(n){var i=n.children,a=n.parent.children,o=n.i?a[n.i-1]:null;if(i){!function(r){for(var n,i=0,a=0,o=r.children,s=o.length;--s>=0;)(n=o[s]).z+=i,n.m+=i,i+=n.s+(a+=n.c)}(n);var s=(i[0].z+i[i.length-1].z)/2;o?(n.z=o.z+r(n._,o._),n.m=n.z-s):n.z=s}else o&&(n.z=o.z+r(n._,o._));n.parent.A=function(n,i,a){if(i){for(var o,s,l,c=n,u=n,f=i,h=c.parent.children[0],p=c.m,d=u.m,m=f.m,g=h.m;f=N(f),c=B(c),f&&c;)h=B(h),(u=N(u)).a=n,(l=f.z+m-c.z-p+r(f._,c._))>0&&(function(r,n,i){var a=i/(n.i-r.i);n.c-=a,n.s+=i,r.c+=a,n.z+=i,n.m+=i}((o=f,s=a,o.a.parent===n.parent?o.a:s),n,l),p+=l,d+=l),m+=f.m,p+=c.m,g+=h.m,d+=u.m;f&&!N(u)&&(u.t=f,u.m+=m-d),c&&!B(h)&&(h.t=c,h.m+=p-g,a=n)}return a}(n,o,n.parent.A||a[0])}function l(r){r._.x=r.z+r.parent.m,r.m+=r.parent.m}function c(r){r.x*=n,r.y=r.depth*i}return o.separation=function(n){return arguments.length?(r=n,o):r},o.size=function(r){return arguments.length?(a=!1,n=+r[0],i=+r[1],o):a?null:[n,i]},o.nodeSize=function(r){return arguments.length?(a=!0,n=+r[0],i=+r[1],o):a?[n,i]:null},o},r.treemap=function(){var r=q,n=!1,i=1,a=1,o=[0],s=A,l=A,c=A,u=A,f=A;function h(r){return r.x0=r.y0=0,r.x1=i,r.y1=a,r.eachBefore(p),o=[0],n&&r.eachBefore(P),r}function p(n){var i=o[n.depth],a=n.x0+i,h=n.y0+i,p=n.x1-i,d=n.y1-i;p<a&&(a=p=(a+p)/2),d<h&&(h=d=(h+d)/2),n.x0=a,n.y0=h,n.x1=p,n.y1=d,n.children&&(i=o[n.depth+1]=s(n)/2,a+=f(n)-i,h+=l(n)-i,(p-=c(n)-i)<a&&(a=p=(a+p)/2),(d-=u(n)-i)<h&&(h=d=(h+d)/2),r(n,a,h,p,d))}return h.round=function(r){return arguments.length?(n=!!r,h):n},h.size=function(r){return arguments.length?(i=+r[0],a=+r[1],h):[i,a]},h.tile=function(n){return arguments.length?(r=k(n),h):r},h.padding=function(r){return arguments.length?h.paddingInner(r).paddingOuter(r):h.paddingInner()},h.paddingInner=function(r){return arguments.length?(s="function"==typeof r?r:M(+r),h):s},h.paddingOuter=function(r){return arguments.length?h.paddingTop(r).paddingRight(r).paddingBottom(r).paddingLeft(r):h.paddingTop()},h.paddingTop=function(r){return arguments.length?(l="function"==typeof r?r:M(+r),h):l},h.paddingRight=function(r){return arguments.length?(c="function"==typeof r?r:M(+r),h):c},h.paddingBottom=function(r){return arguments.length?(u="function"==typeof r?r:M(+r),h):u},h.paddingLeft=function(r){return arguments.length?(f="function"==typeof r?r:M(+r),h):f},h},r.treemapBinary=function(r,n,i,a,o){var s,l,c=r.children,u=c.length,f=Array(u+1);for(f[0]=l=s=0;s<u;++s)f[s+1]=l+=c[s].value;!function r(n,i,a,o,s,l,u){if(n>=i-1){var h=c[n];return h.x0=o,h.y0=s,h.x1=l,void(h.y1=u)}for(var p=f[n],d=a/2+p,m=n+1,g=i-1;m<g;){var v=m+g>>>1;f[v]<d?m=v+1:g=v}d-f[m-1]<f[m]-d&&n+1<m&&--m;var y=f[m]-p,x=a-y;if(l-o>u-s){var b=(o*x+l*y)/a;r(n,m,y,o,s,b,u),r(m,i,x,b,s,l,u)}else{var _=(s*x+u*y)/a;r(n,m,y,o,s,l,_),r(m,i,x,o,_,l,u)}}(0,u,r.value,n,i,a,o)},r.treemapDice=I,r.treemapResquarify=G,r.treemapSlice=U,r.treemapSliceDice=function(r,n,i,a,o){(1&r.depth?U:I)(r,n,i,a,o)},r.treemapSquarify=q,Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:(a=a||self).d3=a.d3||{})},{}],116:[function(r,n,i){var a,o;a=this,o=function(r,n){"use strict";function i(r,n,i,a,o){var s=r*r,l=s*r;return((1-3*r+3*s-l)*n+(4-6*s+3*l)*i+(1+3*r+3*s-3*l)*a+l*o)/6}function a(r){var n=r.length-1;return function(a){var o=a<=0?a=0:a>=1?(a=1,n-1):Math.floor(a*n),s=r[o],l=r[o+1],c=o>0?r[o-1]:2*s-l,u=o<n-1?r[o+2]:2*l-s;return i((a-o/n)*n,c,s,l,u)}}function o(r){var n=r.length;return function(a){var o=Math.floor(((a%=1)<0?++a:a)*n),s=r[(o+n-1)%n],l=r[o%n],c=r[(o+1)%n],u=r[(o+2)%n];return i((a-o/n)*n,s,l,c,u)}}function s(r){return function(){return r}}function l(r,n){return function(i){return r+i*n}}function c(r,n){var i=n-r;return i?l(r,i>180||i<-180?i-360*Math.round(i/360):i):s(isNaN(r)?n:r)}function u(r,n){var i=n-r;return i?l(r,i):s(isNaN(r)?n:r)}var f=function r(i){var a,o=1==(a=+(a=i))?u:function(r,n){var i,o,l;return n-r?(i=r,o=n,i=Math.pow(i,l=a),o=Math.pow(o,l)-i,l=1/l,function(r){return Math.pow(i+r*o,l)}):s(isNaN(r)?n:r)};function l(r,i){var a=o((r=n.rgb(r)).r,(i=n.rgb(i)).r),s=o(r.g,i.g),l=o(r.b,i.b),c=u(r.opacity,i.opacity);return function(n){return r.r=a(n),r.g=s(n),r.b=l(n),r.opacity=c(n),r+""}}return l.gamma=r,l}(1);function h(r){return function(i){var a,o,s=i.length,l=Array(s),c=Array(s),u=Array(s);for(a=0;a<s;++a)o=n.rgb(i[a]),l[a]=o.r||0,c[a]=o.g||0,u[a]=o.b||0;return l=r(l),c=r(c),u=r(u),o.opacity=1,function(r){return o.r=l(r),o.g=c(r),o.b=u(r),o+""}}}var p=h(a),d=h(o);function m(r,n){n||(n=[]);var i,a=r?Math.min(n.length,r.length):0,o=n.slice();return function(s){for(i=0;i<a;++i)o[i]=r[i]*(1-s)+n[i]*s;return o}}function g(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function v(r,n){var i,a=n?n.length:0,o=r?Math.min(a,r.length):0,s=Array(o),l=Array(a);for(i=0;i<o;++i)s[i]=k(r[i],n[i]);for(;i<a;++i)l[i]=n[i];return function(r){for(i=0;i<o;++i)l[i]=s[i](r);return l}}function y(r,n){var i=new Date;return r=+r,n=+n,function(a){return i.setTime(r*(1-a)+n*a),i}}function x(r,n){return r=+r,n=+n,function(i){return r*(1-i)+n*i}}function b(r,n){var i,a={},o={};for(i in null!==r&&"object"==typeof r||(r={}),null!==n&&"object"==typeof n||(n={}),n)i in r?a[i]=k(r[i],n[i]):o[i]=n[i];return function(r){for(i in a)o[i]=a[i](r);return o}}var _=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,w=RegExp(_.source,"g");function T(r,n){var i,a,o,s,l,c=_.lastIndex=w.lastIndex=0,u=-1,f=[],h=[];for(r+="",n+="";(o=_.exec(r))&&(s=w.exec(n));)(l=s.index)>c&&(l=n.slice(c,l),f[u]?f[u]+=l:f[++u]=l),(o=o[0])===(s=s[0])?f[u]?f[u]+=s:f[++u]=s:(f[++u]=null,h.push({i:u,x:x(o,s)})),c=w.lastIndex;return c<n.length&&(l=n.slice(c),f[u]?f[u]+=l:f[++u]=l),f.length<2?h[0]?(i=h[0].x,function(r){return i(r)+""}):(a=n,function(){return a}):(n=h.length,function(r){for(var i,a=0;a<n;++a)f[(i=h[a]).i]=i.x(r);return f.join("")})}function k(r,i){var a,o=typeof i;return null==i||"boolean"===o?s(i):("number"===o?x:"string"===o?(a=n.color(i))?(i=a,f):T:i instanceof n.color?f:i instanceof Date?y:g(i)?m:Array.isArray(i)?v:"function"!=typeof i.valueOf&&"function"!=typeof i.toString||isNaN(i)?b:x)(r,i)}var A,M,S,E,L=180/Math.PI,C={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function P(r,n,i,a,o,s){var l,c,u;return(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l),(u=r*i+n*a)&&(i-=r*u,a-=n*u),(c=Math.sqrt(i*i+a*a))&&(i/=c,a/=c,u/=c),r*a<n*i&&(r=-r,n=-n,u=-u,l=-l),{translateX:o,translateY:s,rotate:Math.atan2(n,r)*L,skewX:Math.atan(u)*L,scaleX:l,scaleY:c}}function I(r,n,i,a){function o(r){return r.length?r.pop()+" ":""}return function(s,l){var c,u,f,h,p=[],d=[];return s=r(s),l=r(l),function(r,a,o,s,l,c){if(r!==o||a!==s){var u=l.push("translate(",null,n,null,i);c.push({i:u-4,x:x(r,o)},{i:u-2,x:x(a,s)})}else(o||s)&&l.push("translate("+o+n+s+i)}(s.translateX,s.translateY,l.translateX,l.translateY,p,d),(c=s.rotate)!==(u=l.rotate)?(c-u>180?u+=360:u-c>180&&(c+=360),d.push({i:p.push(o(p)+"rotate(",null,a)-2,x:x(c,u)})):u&&p.push(o(p)+"rotate("+u+a),(f=s.skewX)!==(h=l.skewX)?d.push({i:p.push(o(p)+"skewX(",null,a)-2,x:x(f,h)}):h&&p.push(o(p)+"skewX("+h+a),function(r,n,i,a,s,l){if(r!==i||n!==a){var c=s.push(o(s)+"scale(",null,",",null,")");l.push({i:c-4,x:x(r,i)},{i:c-2,x:x(n,a)})}else 1===i&&1===a||s.push(o(s)+"scale("+i+","+a+")")}(s.scaleX,s.scaleY,l.scaleX,l.scaleY,p,d),s=l=null,function(r){for(var n,i=-1,a=d.length;++i<a;)p[(n=d[i]).i]=n.x(r);return p.join("")}}}var O=I(function(r){return"none"===r?C:(A||(A=document.createElement("DIV"),M=document.documentElement,S=document.defaultView),A.style.transform=r,r=S.getComputedStyle(M.appendChild(A),null).getPropertyValue("transform"),M.removeChild(A),P(+(r=r.slice(7,-1).split(","))[0],+r[1],+r[2],+r[3],+r[4],+r[5]))},"px, ","px)","deg)"),z=I(function(r){return null==r?C:(E||(E=document.createElementNS("http://www.w3.org/2000/svg","g")),E.setAttribute("transform",r),(r=E.transform.baseVal.consolidate())?P((r=r.matrix).a,r.b,r.c,r.d,r.e,r.f):C)},", ",")",")"),D=Math.SQRT2;function R(r){return((r=Math.exp(r))+1/r)/2}function F(r){return function(i,a){var o=r((i=n.hsl(i)).h,(a=n.hsl(a)).h),s=u(i.s,a.s),l=u(i.l,a.l),c=u(i.opacity,a.opacity);return function(r){return i.h=o(r),i.s=s(r),i.l=l(r),i.opacity=c(r),i+""}}}var B=F(c),N=F(u);function j(r){return function(i,a){var o=r((i=n.hcl(i)).h,(a=n.hcl(a)).h),s=u(i.c,a.c),l=u(i.l,a.l),c=u(i.opacity,a.opacity);return function(r){return i.h=o(r),i.c=s(r),i.l=l(r),i.opacity=c(r),i+""}}}var U=j(c),V=j(u);function H(r){return function i(a){function o(i,o){var s=r((i=n.cubehelix(i)).h,(o=n.cubehelix(o)).h),l=u(i.s,o.s),c=u(i.l,o.l),f=u(i.opacity,o.opacity);return function(r){return i.h=s(r),i.s=l(r),i.l=c(Math.pow(r,a)),i.opacity=f(r),i+""}}return a=+a,o.gamma=i,o}(1)}var q=H(c),G=H(u);r.interpolate=k,r.interpolateArray=function(r,n){return(g(n)?m:v)(r,n)},r.interpolateBasis=a,r.interpolateBasisClosed=o,r.interpolateCubehelix=q,r.interpolateCubehelixLong=G,r.interpolateDate=y,r.interpolateDiscrete=function(r){var n=r.length;return function(i){return r[Math.max(0,Math.min(n-1,Math.floor(i*n)))]}},r.interpolateHcl=U,r.interpolateHclLong=V,r.interpolateHsl=B,r.interpolateHslLong=N,r.interpolateHue=function(r,n){var i=c(+r,+n);return function(r){var n=i(r);return n-360*Math.floor(n/360)}},r.interpolateLab=function(r,i){var a=u((r=n.lab(r)).l,(i=n.lab(i)).l),o=u(r.a,i.a),s=u(r.b,i.b),l=u(r.opacity,i.opacity);return function(n){return r.l=a(n),r.a=o(n),r.b=s(n),r.opacity=l(n),r+""}},r.interpolateNumber=x,r.interpolateNumberArray=m,r.interpolateObject=b,r.interpolateRgb=f,r.interpolateRgbBasis=p,r.interpolateRgbBasisClosed=d,r.interpolateRound=function(r,n){return r=+r,n=+n,function(i){return Math.round(r*(1-i)+n*i)}},r.interpolateString=T,r.interpolateTransformCss=O,r.interpolateTransformSvg=z,r.interpolateZoom=function(r,n){var i,a,o=r[0],s=r[1],l=r[2],c=n[0],u=n[1],f=n[2],h=c-o,p=u-s,d=h*h+p*p;if(d<1e-12)a=Math.log(f/l)/D,i=function(r){return[o+r*h,s+r*p,l*Math.exp(D*r*a)]};else{var m=Math.sqrt(d),g=(f*f-l*l+4*d)/(2*l*2*m),v=(f*f-l*l-4*d)/(2*f*2*m),y=Math.log(Math.sqrt(g*g+1)-g);a=(Math.log(Math.sqrt(v*v+1)-v)-y)/D,i=function(r){var n,i,c=r*a,u=R(y),f=l/(2*m)*(((i=Math.exp(2*(i=D*c+y)))-1)/(i+1)*u-((n=Math.exp(n=y))-1/n)/2);return[o+f*h,s+f*p,l*u/R(D*c+y)]}}return i.duration=1e3*a,i},r.piecewise=function(r,n){for(var i=0,a=n.length-1,o=n[0],s=Array(a<0?0:a);i<a;)s[i]=r(o,o=n[++i]);return function(r){var n=Math.max(0,Math.min(a-1,Math.floor(r*=a)));return s[n](r-n)}},r.quantize=function(r,n){for(var i=Array(n),a=0;a<n;++a)i[a]=r(a/(n-1));return i},Object.defineProperty(r,"__esModule",{value:!0})},"object"==typeof i&&void 0!==n?o(i,r("d3-color")):o((a=a||self).d3=a.d3||{},a.d3)},{"d3-color":109}],117:[function(r,n,i){var a;a=this,function(r){"use strict";var n=Math.PI,i=2*n,a=i-1e-6;function o(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function s(){return new o}o.prototype=s.prototype={constructor:o,moveTo:function(r,n){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(r,n){this._+="L"+(this._x1=+r)+","+(this._y1=+n)},quadraticCurveTo:function(r,n,i,a){this._+="Q"+ +r+","+ +n+","+(this._x1=+i)+","+(this._y1=+a)},bezierCurveTo:function(r,n,i,a,o,s){this._+="C"+ +r+","+ +n+","+ +i+","+ +a+","+(this._x1=+o)+","+(this._y1=+s)},arcTo:function(r,i,a,o,s){r=+r,i=+i,a=+a,o=+o,s=+s;var l=this._x1,c=this._y1,u=a-r,f=o-i,h=l-r,p=c-i,d=h*h+p*p;if(s<0)throw Error("negative radius: "+s);if(null===this._x1)this._+="M"+(this._x1=r)+","+(this._y1=i);else if(d>1e-6){if(Math.abs(p*u-f*h)>1e-6&&s){var m=a-l,g=o-c,v=u*u+f*f,y=Math.sqrt(v),x=Math.sqrt(d),b=s*Math.tan((n-Math.acos((v+d-(m*m+g*g))/(2*y*x)))/2),_=b/x,w=b/y;Math.abs(_-1)>1e-6&&(this._+="L"+(r+_*h)+","+(i+_*p)),this._+="A"+s+","+s+",0,0,"+ +(p*m>h*g)+","+(this._x1=r+w*u)+","+(this._y1=i+w*f)}else this._+="L"+(this._x1=r)+","+(this._y1=i)}},arc:function(r,o,s,l,c,u){r=+r,o=+o,u=!!u;var f=(s=+s)*Math.cos(l),h=s*Math.sin(l),p=r+f,d=o+h,m=1^u,g=u?l-c:c-l;if(s<0)throw Error("negative radius: "+s);null===this._x1?this._+="M"+p+","+d:(Math.abs(this._x1-p)>1e-6||Math.abs(this._y1-d)>1e-6)&&(this._+="L"+p+","+d),s&&(g<0&&(g=g%i+i),g>a?this._+="A"+s+","+s+",0,1,"+m+","+(r-f)+","+(o-h)+"A"+s+","+s+",0,1,"+m+","+(this._x1=p)+","+(this._y1=d):g>1e-6&&(this._+="A"+s+","+s+",0,"+ +(g>=n)+","+m+","+(this._x1=r+s*Math.cos(c))+","+(this._y1=o+s*Math.sin(c))))},rect:function(r,n,i,a){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+n)+"h"+ +i+"v"+ +a+"h"+-i+"Z"},toString:function(){return this._}},r.path=s,Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:(a=a||self).d3=a.d3||{})},{}],118:[function(r,n,i){var a;a=this,function(r){"use strict";function n(r,n,i,a){if(isNaN(n)||isNaN(i))return r;var o,s,l,c,u,f,h,p,d,m=r._root,g={data:a},v=r._x0,y=r._y0,x=r._x1,b=r._y1;if(!m)return r._root=g,r;for(;m.length;)if((f=n>=(s=(v+x)/2))?v=s:x=s,(h=i>=(l=(y+b)/2))?y=l:b=l,o=m,!(m=m[p=h<<1|f]))return o[p]=g,r;if(c=+r._x.call(null,m.data),u=+r._y.call(null,m.data),n===c&&i===u)return g.next=m,o?o[p]=g:r._root=g,r;do o=o?o[p]=[,,,,]:r._root=[,,,,],(f=n>=(s=(v+x)/2))?v=s:x=s,(h=i>=(l=(y+b)/2))?y=l:b=l;while((p=h<<1|f)==(d=(u>=l)<<1|c>=s));return o[d]=m,o[p]=g,r}function i(r,n,i,a,o){this.node=r,this.x0=n,this.y0=i,this.x1=a,this.y1=o}function a(r){return r[0]}function o(r){return r[1]}function s(r,n,i){var s=new l(null==n?a:n,null==i?o:i,NaN,NaN,NaN,NaN);return null==r?s:s.addAll(r)}function l(r,n,i,a,o,s){this._x=r,this._y=n,this._x0=i,this._y0=a,this._x1=o,this._y1=s,this._root=void 0}function c(r){for(var n={data:r.data},i=n;r=r.next;)i=i.next={data:r.data};return n}var u=s.prototype=l.prototype;u.copy=function(){var r,n,i=new l(this._x,this._y,this._x0,this._y0,this._x1,this._y1),a=this._root;if(!a)return i;if(!a.length)return i._root=c(a),i;for(r=[{source:a,target:i._root=[,,,,]}];a=r.pop();)for(var o=0;o<4;++o)(n=a.source[o])&&(n.length?r.push({source:n,target:a.target[o]=[,,,,]}):a.target[o]=c(n));return i},u.add=function(r){var i=+this._x.call(null,r),a=+this._y.call(null,r);return n(this.cover(i,a),i,a,r)},u.addAll=function(r){var i,a,o,s,l=r.length,c=Array(l),u=Array(l),f=1/0,h=1/0,p=-1/0,d=-1/0;for(a=0;a<l;++a)isNaN(o=+this._x.call(null,i=r[a]))||isNaN(s=+this._y.call(null,i))||(c[a]=o,u[a]=s,o<f&&(f=o),o>p&&(p=o),s<h&&(h=s),s>d&&(d=s));if(f>p||h>d)return this;for(this.cover(f,h).cover(p,d),a=0;a<l;++a)n(this,c[a],u[a],r[a]);return this},u.cover=function(r,n){if(isNaN(r=+r)||isNaN(n=+n))return this;var i=this._x0,a=this._y0,o=this._x1,s=this._y1;if(isNaN(i))o=(i=Math.floor(r))+1,s=(a=Math.floor(n))+1;else{for(var l,c,u=o-i,f=this._root;i>r||r>=o||a>n||n>=s;)switch(c=(n<a)<<1|r<i,(l=[,,,,])[c]=f,f=l,u*=2,c){case 0:o=i+u,s=a+u;break;case 1:i=o-u,s=a+u;break;case 2:o=i+u,a=s-u;break;case 3:i=o-u,a=s-u}this._root&&this._root.length&&(this._root=f)}return this._x0=i,this._y0=a,this._x1=o,this._y1=s,this},u.data=function(){var r=[];return this.visit(function(n){if(!n.length)do r.push(n.data);while(n=n.next)}),r},u.extent=function(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},u.find=function(r,n,a){var o,s,l,c,u,f,h,p=this._x0,d=this._y0,m=this._x1,g=this._y1,v=[],y=this._root;for(y&&v.push(new i(y,p,d,m,g)),null==a?a=1/0:(p=r-a,d=n-a,m=r+a,g=n+a,a*=a);f=v.pop();)if(!(!(y=f.node)||(s=f.x0)>m||(l=f.y0)>g||(c=f.x1)<p||(u=f.y1)<d)){if(y.length){var x=(s+c)/2,b=(l+u)/2;v.push(new i(y[3],x,b,c,u),new i(y[2],s,b,x,u),new i(y[1],x,l,c,b),new i(y[0],s,l,x,b)),(h=(n>=b)<<1|r>=x)&&(f=v[v.length-1],v[v.length-1]=v[v.length-1-h],v[v.length-1-h]=f)}else{var _=r-+this._x.call(null,y.data),w=n-+this._y.call(null,y.data),T=_*_+w*w;if(T<a){var k=Math.sqrt(a=T);p=r-k,d=n-k,m=r+k,g=n+k,o=y.data}}}return o},u.remove=function(r){if(isNaN(s=+this._x.call(null,r))||isNaN(l=+this._y.call(null,r)))return this;var n,i,a,o,s,l,c,u,f,h,p,d,m=this._root,g=this._x0,v=this._y0,y=this._x1,x=this._y1;if(!m)return this;if(m.length)for(;;){if((f=s>=(c=(g+y)/2))?g=c:y=c,(h=l>=(u=(v+x)/2))?v=u:x=u,n=m,!(m=m[p=h<<1|f]))return this;if(!m.length)break;(n[p+1&3]||n[p+2&3]||n[p+3&3])&&(i=n,d=p)}for(;m.data!==r;)if(a=m,!(m=m.next))return this;return(o=m.next)&&delete m.next,a?o?a.next=o:delete a.next:n?(o?n[p]=o:delete n[p],(m=n[0]||n[1]||n[2]||n[3])&&m===(n[3]||n[2]||n[1]||n[0])&&!m.length&&(i?i[d]=m:this._root=m)):this._root=o,this},u.removeAll=function(r){for(var n=0,i=r.length;n<i;++n)this.remove(r[n]);return this},u.root=function(){return this._root},u.size=function(){var r=0;return this.visit(function(n){if(!n.length)do++r;while(n=n.next)}),r},u.visit=function(r){var n,a,o,s,l,c,u=[],f=this._root;for(f&&u.push(new i(f,this._x0,this._y0,this._x1,this._y1));n=u.pop();)if(!r(f=n.node,o=n.x0,s=n.y0,l=n.x1,c=n.y1)&&f.length){var h=(o+l)/2,p=(s+c)/2;(a=f[3])&&u.push(new i(a,h,p,l,c)),(a=f[2])&&u.push(new i(a,o,p,h,c)),(a=f[1])&&u.push(new i(a,h,s,l,p)),(a=f[0])&&u.push(new i(a,o,s,h,p))}return this},u.visitAfter=function(r){var n,a=[],o=[];for(this._root&&a.push(new i(this._root,this._x0,this._y0,this._x1,this._y1));n=a.pop();){var s=n.node;if(s.length){var l,c=n.x0,u=n.y0,f=n.x1,h=n.y1,p=(c+f)/2,d=(u+h)/2;(l=s[0])&&a.push(new i(l,c,u,p,d)),(l=s[1])&&a.push(new i(l,p,u,f,d)),(l=s[2])&&a.push(new i(l,c,d,p,h)),(l=s[3])&&a.push(new i(l,p,d,f,h))}o.push(n)}for(;n=o.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this},u.x=function(r){return arguments.length?(this._x=r,this):this._x},u.y=function(r){return arguments.length?(this._y=r,this):this._y},r.quadtree=s,Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:(a=a||self).d3=a.d3||{})},{}],119:[function(r,n,i){var a,o;a=this,o=function(r,n){"use strict";function i(r){return function(){return r}}var a=Math.abs,o=Math.atan2,s=Math.cos,l=Math.max,c=Math.min,u=Math.sin,f=Math.sqrt,h=Math.PI,p=h/2,d=2*h;function m(r){return r>=1?p:r<=-1?-p:Math.asin(r)}function g(r){return r.innerRadius}function v(r){return r.outerRadius}function y(r){return r.startAngle}function x(r){return r.endAngle}function b(r){return r&&r.padAngle}function _(r,n,i,a,o,s,c){var u=r-i,h=n-a,p=(c?s:-s)/f(u*u+h*h),d=p*h,m=-p*u,g=r+d,v=n+m,y=i+d,x=a+m,b=(g+y)/2,_=(v+x)/2,w=y-g,T=x-v,k=w*w+T*T,A=o-s,M=g*x-y*v,S=(T<0?-1:1)*f(l(0,A*A*k-M*M)),E=(M*T-w*S)/k,L=(-M*w-T*S)/k,C=(M*T+w*S)/k,P=(-M*w+T*S)/k,I=E-b,O=L-_,z=C-b,D=P-_;return I*I+O*O>z*z+D*D&&(E=C,L=P),{cx:E,cy:L,x01:-d,y01:-m,x11:E*(o/A-1),y11:L*(o/A-1)}}function w(r){this._context=r}function T(r){return new w(r)}function k(r){return r[0]}function A(r){return r[1]}function M(){var r=k,a=A,o=i(!0),s=null,l=T,c=null;function u(i){var u,f,h,p=i.length,d=!1;for(null==s&&(c=l(h=n.path())),u=0;u<=p;++u)!(u<p&&o(f=i[u],u,i))===d&&((d=!d)?c.lineStart():c.lineEnd()),d&&c.point(+r(f,u,i),+a(f,u,i));if(h)return c=null,h+""||null}return u.x=function(n){return arguments.length?(r="function"==typeof n?n:i(+n),u):r},u.y=function(r){return arguments.length?(a="function"==typeof r?r:i(+r),u):a},u.defined=function(r){return arguments.length?(o="function"==typeof r?r:i(!!r),u):o},u.curve=function(r){return arguments.length?(l=r,null!=s&&(c=l(s)),u):l},u.context=function(r){return arguments.length?(null==r?s=c=null:c=l(s=r),u):s},u}function S(){var r=k,a=null,o=i(0),s=A,l=i(!0),c=null,u=T,f=null;function h(i){var h,p,d,m,g,v=i.length,y=!1,x=Array(v),b=Array(v);for(null==c&&(f=u(g=n.path())),h=0;h<=v;++h){if(!(h<v&&l(m=i[h],h,i))===y){if(y=!y)p=h,f.areaStart(),f.lineStart();else{for(f.lineEnd(),f.lineStart(),d=h-1;d>=p;--d)f.point(x[d],b[d]);f.lineEnd(),f.areaEnd()}}y&&(x[h]=+r(m,h,i),b[h]=+o(m,h,i),f.point(a?+a(m,h,i):x[h],s?+s(m,h,i):b[h]))}if(g)return f=null,g+""||null}function p(){return M().defined(l).curve(u).context(c)}return h.x=function(n){return arguments.length?(r="function"==typeof n?n:i(+n),a=null,h):r},h.x0=function(n){return arguments.length?(r="function"==typeof n?n:i(+n),h):r},h.x1=function(r){return arguments.length?(a=null==r?null:"function"==typeof r?r:i(+r),h):a},h.y=function(r){return arguments.length?(o="function"==typeof r?r:i(+r),s=null,h):o},h.y0=function(r){return arguments.length?(o="function"==typeof r?r:i(+r),h):o},h.y1=function(r){return arguments.length?(s=null==r?null:"function"==typeof r?r:i(+r),h):s},h.lineX0=h.lineY0=function(){return p().x(r).y(o)},h.lineY1=function(){return p().x(r).y(s)},h.lineX1=function(){return p().x(a).y(o)},h.defined=function(r){return arguments.length?(l="function"==typeof r?r:i(!!r),h):l},h.curve=function(r){return arguments.length?(u=r,null!=c&&(f=u(c)),h):u},h.context=function(r){return arguments.length?(null==r?c=f=null:f=u(c=r),h):c},h}function E(r,n){return n<r?-1:n>r?1:n>=r?0:NaN}function L(r){return r}w.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,n){switch(r=+r,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 1:this._point=2;default:this._context.lineTo(r,n)}}};var C=I(T);function P(r){this._curve=r}function I(r){function n(n){return new P(r(n))}return n._curve=r,n}function O(r){var n=r.curve;return r.angle=r.x,delete r.x,r.radius=r.y,delete r.y,r.curve=function(r){return arguments.length?n(I(r)):n()._curve},r}function z(){return O(M().curve(C))}function D(){var r=S().curve(C),n=r.curve,i=r.lineX0,a=r.lineX1,o=r.lineY0,s=r.lineY1;return r.angle=r.x,delete r.x,r.startAngle=r.x0,delete r.x0,r.endAngle=r.x1,delete r.x1,r.radius=r.y,delete r.y,r.innerRadius=r.y0,delete r.y0,r.outerRadius=r.y1,delete r.y1,r.lineStartAngle=function(){return O(i())},delete r.lineX0,r.lineEndAngle=function(){return O(a())},delete r.lineX1,r.lineInnerRadius=function(){return O(o())},delete r.lineY0,r.lineOuterRadius=function(){return O(s())},delete r.lineY1,r.curve=function(r){return arguments.length?n(I(r)):n()._curve},r}function R(r,n){return[(n=+n)*Math.cos(r-=Math.PI/2),n*Math.sin(r)]}P.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(r,n){this._curve.point(n*Math.sin(r),-(n*Math.cos(r)))}};var F=Array.prototype.slice;function B(r){return r.source}function N(r){return r.target}function j(r){var a=B,o=N,s=k,l=A,c=null;function u(){var i,u=F.call(arguments),f=a.apply(this,u),h=o.apply(this,u);if(c||(c=i=n.path()),r(c,+s.apply(this,(u[0]=f,u)),+l.apply(this,u),+s.apply(this,(u[0]=h,u)),+l.apply(this,u)),i)return c=null,i+""||null}return u.source=function(r){return arguments.length?(a=r,u):a},u.target=function(r){return arguments.length?(o=r,u):o},u.x=function(r){return arguments.length?(s="function"==typeof r?r:i(+r),u):s},u.y=function(r){return arguments.length?(l="function"==typeof r?r:i(+r),u):l},u.context=function(r){return arguments.length?(c=null==r?null:r,u):c},u}function U(r,n,i,a,o){r.moveTo(n,i),r.bezierCurveTo(n=(n+a)/2,i,n,o,a,o)}function V(r,n,i,a,o){r.moveTo(n,i),r.bezierCurveTo(n,i=(i+o)/2,a,i,a,o)}function H(r,n,i,a,o){var s=R(n,i),l=R(n,i=(i+o)/2),c=R(a,i),u=R(a,o);r.moveTo(s[0],s[1]),r.bezierCurveTo(l[0],l[1],c[0],c[1],u[0],u[1])}var q={draw:function(r,n){var i=Math.sqrt(n/h);r.moveTo(i,0),r.arc(0,0,i,0,d)}},G={draw:function(r,n){var i=Math.sqrt(n/5)/2;r.moveTo(-3*i,-i),r.lineTo(-i,-i),r.lineTo(-i,-3*i),r.lineTo(i,-3*i),r.lineTo(i,-i),r.lineTo(3*i,-i),r.lineTo(3*i,i),r.lineTo(i,i),r.lineTo(i,3*i),r.lineTo(-i,3*i),r.lineTo(-i,i),r.lineTo(-3*i,i),r.closePath()}},Y=Math.sqrt(1/3),W=2*Y,X={draw:function(r,n){var i=Math.sqrt(n/W),a=i*Y;r.moveTo(0,-i),r.lineTo(a,0),r.lineTo(0,i),r.lineTo(-a,0),r.closePath()}},Z=Math.sin(h/10)/Math.sin(7*h/10),J=Math.sin(d/10)*Z,K=-Math.cos(d/10)*Z,Q={draw:function(r,n){var i=Math.sqrt(.8908130915292852*n),a=J*i,o=K*i;r.moveTo(0,-i),r.lineTo(a,o);for(var s=1;s<5;++s){var l=d*s/5,c=Math.cos(l),u=Math.sin(l);r.lineTo(u*i,-c*i),r.lineTo(c*a-u*o,u*a+c*o)}r.closePath()}},$={draw:function(r,n){var i=Math.sqrt(n),a=-i/2;r.rect(a,a,i,i)}},tt=Math.sqrt(3),te={draw:function(r,n){var i=-Math.sqrt(n/(3*tt));r.moveTo(0,2*i),r.lineTo(-tt*i,-i),r.lineTo(tt*i,-i),r.closePath()}},tr=Math.sqrt(3)/2,tn=1/Math.sqrt(12),ti=3*(tn/2+1),ta={draw:function(r,n){var i=Math.sqrt(n/ti),a=i/2,o=i*tn,s=i*tn+i,l=-a;r.moveTo(a,o),r.lineTo(a,s),r.lineTo(l,s),r.lineTo(-.5*a-tr*o,tr*a+-.5*o),r.lineTo(-.5*a-tr*s,tr*a+-.5*s),r.lineTo(-.5*l-tr*s,tr*l+-.5*s),r.lineTo(-.5*a+tr*o,-.5*o-tr*a),r.lineTo(-.5*a+tr*s,-.5*s-tr*a),r.lineTo(-.5*l+tr*s,-.5*s-tr*l),r.closePath()}},to=[q,G,X,$,Q,te,ta];function ts(){}function tl(r,n,i){r._context.bezierCurveTo((2*r._x0+r._x1)/3,(2*r._y0+r._y1)/3,(r._x0+2*r._x1)/3,(r._y0+2*r._y1)/3,(r._x0+4*r._x1+n)/6,(r._y0+4*r._y1+i)/6)}function tc(r){this._context=r}function tu(r){this._context=r}function tf(r){this._context=r}function th(r,n){this._basis=new tc(r),this._beta=n}tc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:tl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,n){switch(r=+r,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:tl(this,r,n)}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=n}},tu.prototype={areaStart:ts,areaEnd:ts,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(r,n){switch(r=+r,n=+n,this._point){case 0:this._point=1,this._x2=r,this._y2=n;break;case 1:this._point=2,this._x3=r,this._y3=n;break;case 2:this._point=3,this._x4=r,this._y4=n,this._context.moveTo((this._x0+4*this._x1+r)/6,(this._y0+4*this._y1+n)/6);break;default:tl(this,r,n)}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=n}},tf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,n){switch(r=+r,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+r)/6,a=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(i,a):this._context.moveTo(i,a);break;case 3:this._point=4;default:tl(this,r,n)}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=n}},th.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var r=this._x,n=this._y,i=r.length-1;if(i>0)for(var a,o=r[0],s=n[0],l=r[i]-o,c=n[i]-s,u=-1;++u<=i;)a=u/i,this._basis.point(this._beta*r[u]+(1-this._beta)*(o+a*l),this._beta*n[u]+(1-this._beta)*(s+a*c));this._x=this._y=null,this._basis.lineEnd()},point:function(r,n){this._x.push(+r),this._y.push(+n)}};var tp=function r(n){function i(r){return 1===n?new tc(r):new th(r,n)}return i.beta=function(n){return r(+n)},i}(.85);function td(r,n,i){r._context.bezierCurveTo(r._x1+r._k*(r._x2-r._x0),r._y1+r._k*(r._y2-r._y0),r._x2+r._k*(r._x1-n),r._y2+r._k*(r._y1-i),r._x2,r._y2)}function tm(r,n){this._context=r,this._k=(1-n)/6}tm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:td(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,n){switch(r=+r,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 1:this._point=2,this._x1=r,this._y1=n;break;case 2:this._point=3;default:td(this,r,n)}this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var tg=function r(n){function i(r){return new tm(r,n)}return i.tension=function(n){return r(+n)},i}(0);function tv(r,n){this._context=r,this._k=(1-n)/6}tv.prototype={areaStart:ts,areaEnd:ts,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(r,n){switch(r=+r,n=+n,this._point){case 0:this._point=1,this._x3=r,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=r,this._y4=n);break;case 2:this._point=3,this._x5=r,this._y5=n;break;default:td(this,r,n)}this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var ty=function r(n){function i(r){return new tv(r,n)}return i.tension=function(n){return r(+n)},i}(0);function tx(r,n){this._context=r,this._k=(1-n)/6}tx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,n){switch(r=+r,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:td(this,r,n)}this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var tb=function r(n){function i(r){return new tx(r,n)}return i.tension=function(n){return r(+n)},i}(0);function t_(r,n,i){var a=r._x1,o=r._y1,s=r._x2,l=r._y2;if(r._l01_a>1e-12){var c=2*r._l01_2a+3*r._l01_a*r._l12_a+r._l12_2a,u=3*r._l01_a*(r._l01_a+r._l12_a);a=(a*c-r._x0*r._l12_2a+r._x2*r._l01_2a)/u,o=(o*c-r._y0*r._l12_2a+r._y2*r._l01_2a)/u}if(r._l23_a>1e-12){var f=2*r._l23_2a+3*r._l23_a*r._l12_a+r._l12_2a,h=3*r._l23_a*(r._l23_a+r._l12_a);s=(s*f+r._x1*r._l23_2a-n*r._l12_2a)/h,l=(l*f+r._y1*r._l23_2a-i*r._l12_2a)/h}r._context.bezierCurveTo(a,o,s,l,r._x2,r._y2)}function tw(r,n){this._context=r,this._alpha=n}tw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,n){if(r=+r,n=+n,this._point){var i=this._x2-r,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 1:this._point=2;break;case 2:this._point=3;default:t_(this,r,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var tT=function r(n){function i(r){return n?new tw(r,n):new tm(r,0)}return i.alpha=function(n){return r(+n)},i}(.5);function tk(r,n){this._context=r,this._alpha=n}tk.prototype={areaStart:ts,areaEnd:ts,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(r,n){if(r=+r,n=+n,this._point){var i=this._x2-r,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=r,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=r,this._y4=n);break;case 2:this._point=3,this._x5=r,this._y5=n;break;default:t_(this,r,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var tA=function r(n){function i(r){return n?new tk(r,n):new tv(r,0)}return i.alpha=function(n){return r(+n)},i}(.5);function tM(r,n){this._context=r,this._alpha=n}tM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,n){if(r=+r,n=+n,this._point){var i=this._x2-r,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+a*a,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:t_(this,r,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var tS=function r(n){function i(r){return n?new tM(r,n):new tx(r,0)}return i.alpha=function(n){return r(+n)},i}(.5);function tE(r){this._context=r}function tL(r,n,i){var a=r._x1-r._x0,o=n-r._x1,s=(r._y1-r._y0)/(a||o<0&&-0),l=(i-r._y1)/(o||a<0&&-0);return((s<0?-1:1)+(l<0?-1:1))*Math.min(Math.abs(s),Math.abs(l),.5*Math.abs((s*o+l*a)/(a+o)))||0}function tC(r,n){var i=r._x1-r._x0;return i?(3*(r._y1-r._y0)/i-n)/2:n}function tP(r,n,i){var a=r._x0,o=r._y0,s=r._x1,l=r._y1,c=(s-a)/3;r._context.bezierCurveTo(a+c,o+c*n,s-c,l-c*i,s,l)}function tI(r){this._context=r}function tO(r){this._context=new tz(r)}function tz(r){this._context=r}function tD(r){this._context=r}function tR(r){var n,i,a=r.length-1,o=Array(a),s=Array(a),l=Array(a);for(o[0]=0,s[0]=2,l[0]=r[0]+2*r[1],n=1;n<a-1;++n)o[n]=1,s[n]=4,l[n]=4*r[n]+2*r[n+1];for(o[a-1]=2,s[a-1]=7,l[a-1]=8*r[a-1]+r[a],n=1;n<a;++n)i=o[n]/s[n-1],s[n]-=i,l[n]-=i*l[n-1];for(o[a-1]=l[a-1]/s[a-1],n=a-2;n>=0;--n)o[n]=(l[n]-o[n+1])/s[n];for(s[a-1]=(r[a]+o[a-1])/2,n=0;n<a-1;++n)s[n]=2*r[n+1]-o[n+1];return[o,s]}function tF(r,n){this._context=r,this._t=n}function tB(r,n){if((o=r.length)>1)for(var i,a,o,s=1,l=r[n[0]],c=l.length;s<o;++s)for(a=l,l=r[n[s]],i=0;i<c;++i)l[i][1]+=l[i][0]=isNaN(a[i][1])?a[i][0]:a[i][1]}function tN(r){for(var n=r.length,i=Array(n);--n>=0;)i[n]=n;return i}function tj(r,n){return r[n]}function tU(r){var n=r.map(tV);return tN(r).sort(function(r,i){return n[r]-n[i]})}function tV(r){for(var n,i=-1,a=0,o=r.length,s=-1/0;++i<o;)(n=+r[i][1])>s&&(s=n,a=i);return a}function tH(r){var n=r.map(tq);return tN(r).sort(function(r,i){return n[r]-n[i]})}function tq(r){for(var n,i=0,a=-1,o=r.length;++a<o;)(n=+r[a][1])&&(i+=n);return i}tE.prototype={areaStart:ts,areaEnd:ts,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(r,n){r=+r,n=+n,this._point?this._context.lineTo(r,n):(this._point=1,this._context.moveTo(r,n))}},tI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tP(this,this._t0,tC(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(r,n){var i=NaN;if(n=+n,(r=+r)!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 1:this._point=2;break;case 2:this._point=3,tP(this,tC(this,i=tL(this,r,n)),i);break;default:tP(this,this._t0,i=tL(this,r,n))}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=n,this._t0=i}}},(tO.prototype=Object.create(tI.prototype)).point=function(r,n){tI.prototype.point.call(this,n,r)},tz.prototype={moveTo:function(r,n){this._context.moveTo(n,r)},closePath:function(){this._context.closePath()},lineTo:function(r,n){this._context.lineTo(n,r)},bezierCurveTo:function(r,n,i,a,o,s){this._context.bezierCurveTo(n,r,a,i,s,o)}},tD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var r=this._x,n=this._y,i=r.length;if(i){if(this._line?this._context.lineTo(r[0],n[0]):this._context.moveTo(r[0],n[0]),2===i)this._context.lineTo(r[1],n[1]);else for(var a=tR(r),o=tR(n),s=0,l=1;l<i;++s,++l)this._context.bezierCurveTo(a[0][s],o[0][s],a[1][s],o[1][s],r[l],n[l])}(this._line||0!==this._line&&1===i)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(r,n){this._x.push(+r),this._y.push(+n)}},tF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(r,n){switch(r=+r,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(r,n);else{var i=this._x*(1-this._t)+r*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,n)}}this._x=r,this._y=n}},r.arc=function(){var r=g,l=v,w=i(0),T=null,k=y,A=x,M=b,S=null;function E(){var i,g,v=+r.apply(this,arguments),y=+l.apply(this,arguments),x=k.apply(this,arguments)-p,b=A.apply(this,arguments)-p,E=a(b-x),L=b>x;if(S||(S=i=n.path()),y<v&&(g=y,y=v,v=g),y>1e-12){if(E>d-1e-12)S.moveTo(y*s(x),y*u(x)),S.arc(0,0,y,x,b,!L),v>1e-12&&(S.moveTo(v*s(b),v*u(b)),S.arc(0,0,v,b,x,L));else{var C,P,I=x,O=b,z=x,D=b,R=E,F=E,B=M.apply(this,arguments)/2,N=B>1e-12&&(T?+T.apply(this,arguments):f(v*v+y*y)),j=c(a(y-v)/2,+w.apply(this,arguments)),U=j,V=j;if(N>1e-12){var H=m(N/v*u(B)),q=m(N/y*u(B));(R-=2*H)>1e-12?(z+=H*=L?1:-1,D-=H):(R=0,z=D=(x+b)/2),(F-=2*q)>1e-12?(I+=q*=L?1:-1,O-=q):(F=0,I=O=(x+b)/2)}var G=y*s(I),Y=y*u(I),W=v*s(D),X=v*u(D);if(j>1e-12){var Z,J=y*s(O),K=y*u(O),Q=v*s(z),$=v*u(z);if(E<h&&(Z=function(r,n,i,a,o,s,l,c){var u=i-r,f=a-n,h=l-o,p=c-s,d=p*u-h*f;if(!(d*d<1e-12))return[r+(d=(h*(n-s)-p*(r-o))/d)*u,n+d*f]}(G,Y,Q,$,J,K,W,X))){var tt,te=G-Z[0],tr=Y-Z[1],tn=J-Z[0],ti=K-Z[1],ta=1/u(((tt=(te*tn+tr*ti)/(f(te*te+tr*tr)*f(tn*tn+ti*ti)))>1?0:tt<-1?h:Math.acos(tt))/2),to=f(Z[0]*Z[0]+Z[1]*Z[1]);U=c(j,(v-to)/(ta-1)),V=c(j,(y-to)/(ta+1))}}F>1e-12?V>1e-12?(C=_(Q,$,G,Y,y,V,L),P=_(J,K,W,X,y,V,L),S.moveTo(C.cx+C.x01,C.cy+C.y01),V<j?S.arc(C.cx,C.cy,V,o(C.y01,C.x01),o(P.y01,P.x01),!L):(S.arc(C.cx,C.cy,V,o(C.y01,C.x01),o(C.y11,C.x11),!L),S.arc(0,0,y,o(C.cy+C.y11,C.cx+C.x11),o(P.cy+P.y11,P.cx+P.x11),!L),S.arc(P.cx,P.cy,V,o(P.y11,P.x11),o(P.y01,P.x01),!L))):(S.moveTo(G,Y),S.arc(0,0,y,I,O,!L)):S.moveTo(G,Y),v>1e-12&&R>1e-12?U>1e-12?(C=_(W,X,J,K,v,-U,L),P=_(G,Y,Q,$,v,-U,L),S.lineTo(C.cx+C.x01,C.cy+C.y01),U<j?S.arc(C.cx,C.cy,U,o(C.y01,C.x01),o(P.y01,P.x01),!L):(S.arc(C.cx,C.cy,U,o(C.y01,C.x01),o(C.y11,C.x11),!L),S.arc(0,0,v,o(C.cy+C.y11,C.cx+C.x11),o(P.cy+P.y11,P.cx+P.x11),L),S.arc(P.cx,P.cy,U,o(P.y11,P.x11),o(P.y01,P.x01),!L))):S.arc(0,0,v,D,z,L):S.lineTo(W,X)}}else S.moveTo(0,0);if(S.closePath(),i)return S=null,i+""||null}return E.centroid=function(){var n=(+r.apply(this,arguments)+ +l.apply(this,arguments))/2,i=(+k.apply(this,arguments)+ +A.apply(this,arguments))/2-h/2;return[s(i)*n,u(i)*n]},E.innerRadius=function(n){return arguments.length?(r="function"==typeof n?n:i(+n),E):r},E.outerRadius=function(r){return arguments.length?(l="function"==typeof r?r:i(+r),E):l},E.cornerRadius=function(r){return arguments.length?(w="function"==typeof r?r:i(+r),E):w},E.padRadius=function(r){return arguments.length?(T=null==r?null:"function"==typeof r?r:i(+r),E):T},E.startAngle=function(r){return arguments.length?(k="function"==typeof r?r:i(+r),E):k},E.endAngle=function(r){return arguments.length?(A="function"==typeof r?r:i(+r),E):A},E.padAngle=function(r){return arguments.length?(M="function"==typeof r?r:i(+r),E):M},E.context=function(r){return arguments.length?(S=null==r?null:r,E):S},E},r.area=S,r.areaRadial=D,r.curveBasis=function(r){return new tc(r)},r.curveBasisClosed=function(r){return new tu(r)},r.curveBasisOpen=function(r){return new tf(r)},r.curveBundle=tp,r.curveCardinal=tg,r.curveCardinalClosed=ty,r.curveCardinalOpen=tb,r.curveCatmullRom=tT,r.curveCatmullRomClosed=tA,r.curveCatmullRomOpen=tS,r.curveLinear=T,r.curveLinearClosed=function(r){return new tE(r)},r.curveMonotoneX=function(r){return new tI(r)},r.curveMonotoneY=function(r){return new tO(r)},r.curveNatural=function(r){return new tD(r)},r.curveStep=function(r){return new tF(r,.5)},r.curveStepAfter=function(r){return new tF(r,1)},r.curveStepBefore=function(r){return new tF(r,0)},r.line=M,r.lineRadial=z,r.linkHorizontal=function(){return j(U)},r.linkRadial=function(){var r=j(H);return r.angle=r.x,delete r.x,r.radius=r.y,delete r.y,r},r.linkVertical=function(){return j(V)},r.pie=function(){var r=L,n=E,a=null,o=i(0),s=i(d),l=i(0);function c(i){var c,u,f,h,p,m=i.length,g=0,v=Array(m),y=Array(m),x=+o.apply(this,arguments),b=Math.min(d,Math.max(-d,s.apply(this,arguments)-x)),_=Math.min(Math.abs(b)/m,l.apply(this,arguments)),w=_*(b<0?-1:1);for(c=0;c<m;++c)(p=y[v[c]=c]=+r(i[c],c,i))>0&&(g+=p);for(null!=n?v.sort(function(r,i){return n(y[r],y[i])}):null!=a&&v.sort(function(r,n){return a(i[r],i[n])}),c=0,f=g?(b-m*w)/g:0;c<m;++c,x=h)h=x+((p=y[u=v[c]])>0?p*f:0)+w,y[u]={data:i[u],index:c,value:p,startAngle:x,endAngle:h,padAngle:_};return y}return c.value=function(n){return arguments.length?(r="function"==typeof n?n:i(+n),c):r},c.sortValues=function(r){return arguments.length?(n=r,a=null,c):n},c.sort=function(r){return arguments.length?(a=r,n=null,c):a},c.startAngle=function(r){return arguments.length?(o="function"==typeof r?r:i(+r),c):o},c.endAngle=function(r){return arguments.length?(s="function"==typeof r?r:i(+r),c):s},c.padAngle=function(r){return arguments.length?(l="function"==typeof r?r:i(+r),c):l},c},r.pointRadial=R,r.radialArea=D,r.radialLine=z,r.stack=function(){var r=i([]),n=tN,a=tB,o=tj;function s(i){var s,l,c=r.apply(this,arguments),u=i.length,f=c.length,h=Array(f);for(s=0;s<f;++s){for(var p,d=c[s],m=h[s]=Array(u),g=0;g<u;++g)m[g]=p=[0,+o(i[g],d,g,i)],p.data=i[g];m.key=d}for(s=0,l=n(h);s<f;++s)h[l[s]].index=s;return a(h,l),h}return s.keys=function(n){return arguments.length?(r="function"==typeof n?n:i(F.call(n)),s):r},s.value=function(r){return arguments.length?(o="function"==typeof r?r:i(+r),s):o},s.order=function(r){return arguments.length?(n=null==r?tN:"function"==typeof r?r:i(F.call(r)),s):n},s.offset=function(r){return arguments.length?(a=null==r?tB:r,s):a},s},r.stackOffsetDiverging=function(r,n){if((c=r.length)>0)for(var i,a,o,s,l,c,u=0,f=r[n[0]].length;u<f;++u)for(s=l=0,i=0;i<c;++i)(o=(a=r[n[i]][u])[1]-a[0])>0?(a[0]=s,a[1]=s+=o):o<0?(a[1]=l,a[0]=l+=o):(a[0]=0,a[1]=o)},r.stackOffsetExpand=function(r,n){if((a=r.length)>0){for(var i,a,o,s=0,l=r[0].length;s<l;++s){for(o=i=0;i<a;++i)o+=r[i][s][1]||0;if(o)for(i=0;i<a;++i)r[i][s][1]/=o}tB(r,n)}},r.stackOffsetNone=tB,r.stackOffsetSilhouette=function(r,n){if((i=r.length)>0){for(var i,a=0,o=r[n[0]],s=o.length;a<s;++a){for(var l=0,c=0;l<i;++l)c+=r[l][a][1]||0;o[a][1]+=o[a][0]=-c/2}tB(r,n)}},r.stackOffsetWiggle=function(r,n){if((o=r.length)>0&&(a=(i=r[n[0]]).length)>0){for(var i,a,o,s=0,l=1;l<a;++l){for(var c=0,u=0,f=0;c<o;++c){for(var h=r[n[c]],p=h[l][1]||0,d=(p-(h[l-1][1]||0))/2,m=0;m<c;++m){var g=r[n[m]];d+=(g[l][1]||0)-(g[l-1][1]||0)}u+=p,f+=d*p}i[l-1][1]+=i[l-1][0]=s,u&&(s-=f/u)}i[l-1][1]+=i[l-1][0]=s,tB(r,n)}},r.stackOrderAppearance=tU,r.stackOrderAscending=tH,r.stackOrderDescending=function(r){return tH(r).reverse()},r.stackOrderInsideOut=function(r){var n,i,a=r.length,o=r.map(tq),s=tU(r),l=0,c=0,u=[],f=[];for(n=0;n<a;++n)i=s[n],l<c?(l+=o[i],u.push(i)):(c+=o[i],f.push(i));return f.reverse().concat(u)},r.stackOrderNone=tN,r.stackOrderReverse=function(r){return tN(r).reverse()},r.symbol=function(){var r=i(q),a=i(64),o=null;function s(){var i;if(o||(o=i=n.path()),r.apply(this,arguments).draw(o,+a.apply(this,arguments)),i)return o=null,i+""||null}return s.type=function(n){return arguments.length?(r="function"==typeof n?n:i(n),s):r},s.size=function(r){return arguments.length?(a="function"==typeof r?r:i(+r),s):a},s.context=function(r){return arguments.length?(o=null==r?null:r,s):o},s},r.symbolCircle=q,r.symbolCross=G,r.symbolDiamond=X,r.symbolSquare=$,r.symbolStar=Q,r.symbolTriangle=te,r.symbolWye=ta,r.symbols=to,Object.defineProperty(r,"__esModule",{value:!0})},"object"==typeof i&&void 0!==n?o(i,r("d3-path")):o((a=a||self).d3=a.d3||{},a.d3)},{"d3-path":117}],120:[function(r,n,i){var a,o;a=this,o=function(r,n){"use strict";function i(r){if(0<=r.y&&r.y<100){var n=new Date(-1,r.m,r.d,r.H,r.M,r.S,r.L);return n.setFullYear(r.y),n}return new Date(r.y,r.m,r.d,r.H,r.M,r.S,r.L)}function a(r){if(0<=r.y&&r.y<100){var n=new Date(Date.UTC(-1,r.m,r.d,r.H,r.M,r.S,r.L));return n.setUTCFullYear(r.y),n}return new Date(Date.UTC(r.y,r.m,r.d,r.H,r.M,r.S,r.L))}function o(r,n,i){return{y:r,m:n,d:i,H:0,M:0,S:0,L:0}}function s(r){var s=r.dateTime,l=r.date,u=r.time,f=r.periods,h=r.days,p=r.shortDays,d=r.months,tb=r.shortMonths,t_=m(f),tw=g(f),tT=m(h),tk=g(h),tA=m(p),tM=g(p),tS=m(d),tE=g(d),tL=m(tb),tC=g(tb),tP={a:function(r){return p[r.getDay()]},A:function(r){return h[r.getDay()]},b:function(r){return tb[r.getMonth()]},B:function(r){return d[r.getMonth()]},c:null,d:F,e:F,f:V,H:B,I:N,j:j,L:U,m:H,M:q,p:function(r){return f[+(r.getHours()>=12)]},q:function(r){return 1+~~(r.getMonth()/3)},Q:ty,s:tx,S:G,u:Y,U:W,V:X,w:Z,W:J,x:null,X:null,y:K,Y:Q,Z:$,"%":tv},tI={a:function(r){return p[r.getUTCDay()]},A:function(r){return h[r.getUTCDay()]},b:function(r){return tb[r.getUTCMonth()]},B:function(r){return d[r.getUTCMonth()]},c:null,d:tt,e:tt,f:ta,H:te,I:tr,j:tn,L:ti,m:to,M:ts,p:function(r){return f[+(r.getUTCHours()>=12)]},q:function(r){return 1+~~(r.getUTCMonth()/3)},Q:ty,s:tx,S:tl,u:tc,U:tu,V:tf,w:th,W:tp,x:null,X:null,y:td,Y:tm,Z:tg,"%":tv},tO={a:function(r,n,i){var a=tA.exec(n.slice(i));return a?(r.w=tM[a[0].toLowerCase()],i+a[0].length):-1},A:function(r,n,i){var a=tT.exec(n.slice(i));return a?(r.w=tk[a[0].toLowerCase()],i+a[0].length):-1},b:function(r,n,i){var a=tL.exec(n.slice(i));return a?(r.m=tC[a[0].toLowerCase()],i+a[0].length):-1},B:function(r,n,i){var a=tS.exec(n.slice(i));return a?(r.m=tE[a[0].toLowerCase()],i+a[0].length):-1},c:function(r,n,i){return tR(r,s,n,i)},d:S,e:S,f:O,H:L,I:L,j:E,L:I,m:M,M:C,p:function(r,n,i){var a=t_.exec(n.slice(i));return a?(r.p=tw[a[0].toLowerCase()],i+a[0].length):-1},q:A,Q:D,s:R,S:P,u:y,U:x,V:b,w:v,W:_,x:function(r,n,i){return tR(r,l,n,i)},X:function(r,n,i){return tR(r,u,n,i)},y:T,Y:w,Z:k,"%":z};function tz(r,n){return function(i){var a,o,s,l=[],u=-1,f=0,h=r.length;for(i instanceof Date||(i=new Date(+i));++u<h;)37===r.charCodeAt(u)&&(l.push(r.slice(f,u)),null!=(o=c[a=r.charAt(++u)])?a=r.charAt(++u):o="e"===a?" ":"0",(s=n[a])&&(a=s(i,o)),l.push(a),f=u+1);return l.push(r.slice(f,u)),l.join("")}}function tD(r,s){return function(l){var c,u,f=o(1900,void 0,1);if(tR(f,r,l+="",0)!=l.length)return null;if("Q"in f)return new Date(f.Q);if("s"in f)return new Date(1e3*f.s+("L"in f?f.L:0));if(!s||"Z"in f||(f.Z=0),"p"in f&&(f.H=f.H%12+12*f.p),void 0===f.m&&(f.m="q"in f?f.q:0),"V"in f){if(f.V<1||f.V>53)return null;"w"in f||(f.w=1),"Z"in f?(c=(u=(c=a(o(f.y,0,1))).getUTCDay())>4||0===u?n.utcMonday.ceil(c):n.utcMonday(c),c=n.utcDay.offset(c,7*(f.V-1)),f.y=c.getUTCFullYear(),f.m=c.getUTCMonth(),f.d=c.getUTCDate()+(f.w+6)%7):(c=(u=(c=i(o(f.y,0,1))).getDay())>4||0===u?n.timeMonday.ceil(c):n.timeMonday(c),c=n.timeDay.offset(c,7*(f.V-1)),f.y=c.getFullYear(),f.m=c.getMonth(),f.d=c.getDate()+(f.w+6)%7)}else("W"in f||"U"in f)&&("w"in f||(f.w="u"in f?f.u%7:"W"in f?1:0),u="Z"in f?a(o(f.y,0,1)).getUTCDay():i(o(f.y,0,1)).getDay(),f.m=0,f.d="W"in f?(f.w+6)%7+7*f.W-(u+5)%7:f.w+7*f.U-(u+6)%7);return"Z"in f?(f.H+=f.Z/100|0,f.M+=f.Z%100,a(f)):i(f)}}function tR(r,n,i,a){for(var o,s,l=0,u=n.length,f=i.length;l<u;){if(a>=f)return -1;if(37===(o=n.charCodeAt(l++))){if(!(s=tO[(o=n.charAt(l++))in c?n.charAt(l++):o])||(a=s(r,i,a))<0)return -1}else if(o!=i.charCodeAt(a++))return -1}return a}return tP.x=tz(l,tP),tP.X=tz(u,tP),tP.c=tz(s,tP),tI.x=tz(l,tI),tI.X=tz(u,tI),tI.c=tz(s,tI),{format:function(r){var n=tz(r+="",tP);return n.toString=function(){return r},n},parse:function(r){var n=tD(r+="",!1);return n.toString=function(){return r},n},utcFormat:function(r){var n=tz(r+="",tI);return n.toString=function(){return r},n},utcParse:function(r){var n=tD(r+="",!0);return n.toString=function(){return r},n}}}var l,c={"-":"",_:" ",0:"0"},u=/^\s*\d+/,f=/^%/,h=/[\\^$*+?|[\]().{}]/g;function p(r,n,i){var a=r<0?"-":"",o=(a?-r:r)+"",s=o.length;return a+(s<i?Array(i-s+1).join(n)+o:o)}function d(r){return r.replace(h,"\\$&")}function m(r){return RegExp("^(?:"+r.map(d).join("|")+")","i")}function g(r){for(var n={},i=-1,a=r.length;++i<a;)n[r[i].toLowerCase()]=i;return n}function v(r,n,i){var a=u.exec(n.slice(i,i+1));return a?(r.w=+a[0],i+a[0].length):-1}function y(r,n,i){var a=u.exec(n.slice(i,i+1));return a?(r.u=+a[0],i+a[0].length):-1}function x(r,n,i){var a=u.exec(n.slice(i,i+2));return a?(r.U=+a[0],i+a[0].length):-1}function b(r,n,i){var a=u.exec(n.slice(i,i+2));return a?(r.V=+a[0],i+a[0].length):-1}function _(r,n,i){var a=u.exec(n.slice(i,i+2));return a?(r.W=+a[0],i+a[0].length):-1}function w(r,n,i){var a=u.exec(n.slice(i,i+4));return a?(r.y=+a[0],i+a[0].length):-1}function T(r,n,i){var a=u.exec(n.slice(i,i+2));return a?(r.y=+a[0]+(+a[0]>68?1900:2e3),i+a[0].length):-1}function k(r,n,i){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(i,i+6));return a?(r.Z=a[1]?0:-(a[2]+(a[3]||"00")),i+a[0].length):-1}function A(r,n,i){var a=u.exec(n.slice(i,i+1));return a?(r.q=3*a[0]-3,i+a[0].length):-1}function M(r,n,i){var a=u.exec(n.slice(i,i+2));return a?(r.m=a[0]-1,i+a[0].length):-1}function S(r,n,i){var a=u.exec(n.slice(i,i+2));return a?(r.d=+a[0],i+a[0].length):-1}function E(r,n,i){var a=u.exec(n.slice(i,i+3));return a?(r.m=0,r.d=+a[0],i+a[0].length):-1}function L(r,n,i){var a=u.exec(n.slice(i,i+2));return a?(r.H=+a[0],i+a[0].length):-1}function C(r,n,i){var a=u.exec(n.slice(i,i+2));return a?(r.M=+a[0],i+a[0].length):-1}function P(r,n,i){var a=u.exec(n.slice(i,i+2));return a?(r.S=+a[0],i+a[0].length):-1}function I(r,n,i){var a=u.exec(n.slice(i,i+3));return a?(r.L=+a[0],i+a[0].length):-1}function O(r,n,i){var a=u.exec(n.slice(i,i+6));return a?(r.L=Math.floor(a[0]/1e3),i+a[0].length):-1}function z(r,n,i){var a=f.exec(n.slice(i,i+1));return a?i+a[0].length:-1}function D(r,n,i){var a=u.exec(n.slice(i));return a?(r.Q=+a[0],i+a[0].length):-1}function R(r,n,i){var a=u.exec(n.slice(i));return a?(r.s=+a[0],i+a[0].length):-1}function F(r,n){return p(r.getDate(),n,2)}function B(r,n){return p(r.getHours(),n,2)}function N(r,n){return p(r.getHours()%12||12,n,2)}function j(r,i){return p(1+n.timeDay.count(n.timeYear(r),r),i,3)}function U(r,n){return p(r.getMilliseconds(),n,3)}function V(r,n){return U(r,n)+"000"}function H(r,n){return p(r.getMonth()+1,n,2)}function q(r,n){return p(r.getMinutes(),n,2)}function G(r,n){return p(r.getSeconds(),n,2)}function Y(r){var n=r.getDay();return 0===n?7:n}function W(r,i){return p(n.timeSunday.count(n.timeYear(r)-1,r),i,2)}function X(r,i){var a=r.getDay();return r=a>=4||0===a?n.timeThursday(r):n.timeThursday.ceil(r),p(n.timeThursday.count(n.timeYear(r),r)+(4===n.timeYear(r).getDay()),i,2)}function Z(r){return r.getDay()}function J(r,i){return p(n.timeMonday.count(n.timeYear(r)-1,r),i,2)}function K(r,n){return p(r.getFullYear()%100,n,2)}function Q(r,n){return p(r.getFullYear()%1e4,n,4)}function $(r){var n=r.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+p(n/60|0,"0",2)+p(n%60,"0",2)}function tt(r,n){return p(r.getUTCDate(),n,2)}function te(r,n){return p(r.getUTCHours(),n,2)}function tr(r,n){return p(r.getUTCHours()%12||12,n,2)}function tn(r,i){return p(1+n.utcDay.count(n.utcYear(r),r),i,3)}function ti(r,n){return p(r.getUTCMilliseconds(),n,3)}function ta(r,n){return ti(r,n)+"000"}function to(r,n){return p(r.getUTCMonth()+1,n,2)}function ts(r,n){return p(r.getUTCMinutes(),n,2)}function tl(r,n){return p(r.getUTCSeconds(),n,2)}function tc(r){var n=r.getUTCDay();return 0===n?7:n}function tu(r,i){return p(n.utcSunday.count(n.utcYear(r)-1,r),i,2)}function tf(r,i){var a=r.getUTCDay();return r=a>=4||0===a?n.utcThursday(r):n.utcThursday.ceil(r),p(n.utcThursday.count(n.utcYear(r),r)+(4===n.utcYear(r).getUTCDay()),i,2)}function th(r){return r.getUTCDay()}function tp(r,i){return p(n.utcMonday.count(n.utcYear(r)-1,r),i,2)}function td(r,n){return p(r.getUTCFullYear()%100,n,2)}function tm(r,n){return p(r.getUTCFullYear()%1e4,n,4)}function tg(){return"+0000"}function tv(){return"%"}function ty(r){return+r}function tx(r){return Math.floor(+r/1e3)}function tb(n){return l=s(n),r.timeFormat=l.format,r.timeParse=l.parse,r.utcFormat=l.utcFormat,r.utcParse=l.utcParse,l}tb({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var t_=Date.prototype.toISOString?function(r){return r.toISOString()}:r.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),tw=+new Date("2000-01-01T00:00:00.000Z")?function(r){var n=new Date(r);return isNaN(n)?null:n}:r.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");r.isoFormat=t_,r.isoParse=tw,r.timeFormatDefaultLocale=tb,r.timeFormatLocale=s,Object.defineProperty(r,"__esModule",{value:!0})},"object"==typeof i&&void 0!==n?o(i,r("d3-time")):o((a=a||self).d3=a.d3||{},a.d3)},{"d3-time":121}],121:[function(r,n,i){var a;a=this,function(r){"use strict";var n=new Date,i=new Date;function a(r,o,s,l){function c(n){return r(n=0==arguments.length?new Date:new Date(+n)),n}return c.floor=function(n){return r(n=new Date(+n)),n},c.ceil=function(n){return r(n=new Date(n-1)),o(n,1),r(n),n},c.round=function(r){var n=c(r),i=c.ceil(r);return r-n<i-r?n:i},c.offset=function(r,n){return o(r=new Date(+r),null==n?1:Math.floor(n)),r},c.range=function(n,i,a){var s,l=[];if(n=c.ceil(n),a=null==a?1:Math.floor(a),!(n<i&&a>0))return l;do l.push(s=new Date(+n)),o(n,a),r(n);while(s<n&&n<i);return l},c.filter=function(n){return a(function(i){if(i>=i)for(;r(i),!n(i);)i.setTime(i-1)},function(r,i){if(r>=r){if(i<0)for(;++i<=0;)for(;o(r,-1),!n(r););else for(;--i>=0;)for(;o(r,1),!n(r););}})},s&&(c.count=function(a,o){return n.setTime(+a),i.setTime(+o),r(n),r(i),Math.floor(s(n,i))},c.every=function(r){return isFinite(r=Math.floor(r))&&r>0?r>1?c.filter(l?function(n){return l(n)%r==0}:function(n){return c.count(0,n)%r==0}):c:null}),c}var o=a(function(){},function(r,n){r.setTime(+r+n)},function(r,n){return n-r});o.every=function(r){return isFinite(r=Math.floor(r))&&r>0?r>1?a(function(n){n.setTime(Math.floor(n/r)*r)},function(n,i){n.setTime(+n+i*r)},function(n,i){return(i-n)/r}):o:null};var s=o.range,l=a(function(r){r.setTime(r-r.getMilliseconds())},function(r,n){r.setTime(+r+1e3*n)},function(r,n){return(n-r)/1e3},function(r){return r.getUTCSeconds()}),c=l.range,u=a(function(r){r.setTime(r-r.getMilliseconds()-1e3*r.getSeconds())},function(r,n){r.setTime(+r+6e4*n)},function(r,n){return(n-r)/6e4},function(r){return r.getMinutes()}),f=u.range,h=a(function(r){r.setTime(r-r.getMilliseconds()-1e3*r.getSeconds()-6e4*r.getMinutes())},function(r,n){r.setTime(+r+36e5*n)},function(r,n){return(n-r)/36e5},function(r){return r.getHours()}),p=h.range,d=a(function(r){r.setHours(0,0,0,0)},function(r,n){r.setDate(r.getDate()+n)},function(r,n){return(n-r-6e4*(n.getTimezoneOffset()-r.getTimezoneOffset()))/864e5},function(r){return r.getDate()-1}),m=d.range;function g(r){return a(function(n){n.setDate(n.getDate()-(n.getDay()+7-r)%7),n.setHours(0,0,0,0)},function(r,n){r.setDate(r.getDate()+7*n)},function(r,n){return(n-r-6e4*(n.getTimezoneOffset()-r.getTimezoneOffset()))/6048e5})}var v=g(0),y=g(1),x=g(2),b=g(3),_=g(4),w=g(5),T=g(6),k=v.range,A=y.range,M=x.range,S=b.range,E=_.range,L=w.range,C=T.range,P=a(function(r){r.setDate(1),r.setHours(0,0,0,0)},function(r,n){r.setMonth(r.getMonth()+n)},function(r,n){return n.getMonth()-r.getMonth()+12*(n.getFullYear()-r.getFullYear())},function(r){return r.getMonth()}),I=P.range,O=a(function(r){r.setMonth(0,1),r.setHours(0,0,0,0)},function(r,n){r.setFullYear(r.getFullYear()+n)},function(r,n){return n.getFullYear()-r.getFullYear()},function(r){return r.getFullYear()});O.every=function(r){return isFinite(r=Math.floor(r))&&r>0?a(function(n){n.setFullYear(Math.floor(n.getFullYear()/r)*r),n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,i){n.setFullYear(n.getFullYear()+i*r)}):null};var z=O.range,D=a(function(r){r.setUTCSeconds(0,0)},function(r,n){r.setTime(+r+6e4*n)},function(r,n){return(n-r)/6e4},function(r){return r.getUTCMinutes()}),R=D.range,F=a(function(r){r.setUTCMinutes(0,0,0)},function(r,n){r.setTime(+r+36e5*n)},function(r,n){return(n-r)/36e5},function(r){return r.getUTCHours()}),B=F.range,N=a(function(r){r.setUTCHours(0,0,0,0)},function(r,n){r.setUTCDate(r.getUTCDate()+n)},function(r,n){return(n-r)/864e5},function(r){return r.getUTCDate()-1}),j=N.range;function U(r){return a(function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-r)%7),n.setUTCHours(0,0,0,0)},function(r,n){r.setUTCDate(r.getUTCDate()+7*n)},function(r,n){return(n-r)/6048e5})}var V=U(0),H=U(1),q=U(2),G=U(3),Y=U(4),W=U(5),X=U(6),Z=V.range,J=H.range,K=q.range,Q=G.range,$=Y.range,tt=W.range,te=X.range,tr=a(function(r){r.setUTCDate(1),r.setUTCHours(0,0,0,0)},function(r,n){r.setUTCMonth(r.getUTCMonth()+n)},function(r,n){return n.getUTCMonth()-r.getUTCMonth()+12*(n.getUTCFullYear()-r.getUTCFullYear())},function(r){return r.getUTCMonth()}),tn=tr.range,ti=a(function(r){r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},function(r,n){r.setUTCFullYear(r.getUTCFullYear()+n)},function(r,n){return n.getUTCFullYear()-r.getUTCFullYear()},function(r){return r.getUTCFullYear()});ti.every=function(r){return isFinite(r=Math.floor(r))&&r>0?a(function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/r)*r),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,i){n.setUTCFullYear(n.getUTCFullYear()+i*r)}):null};var ta=ti.range;r.timeDay=d,r.timeDays=m,r.timeFriday=w,r.timeFridays=L,r.timeHour=h,r.timeHours=p,r.timeInterval=a,r.timeMillisecond=o,r.timeMilliseconds=s,r.timeMinute=u,r.timeMinutes=f,r.timeMonday=y,r.timeMondays=A,r.timeMonth=P,r.timeMonths=I,r.timeSaturday=T,r.timeSaturdays=C,r.timeSecond=l,r.timeSeconds=c,r.timeSunday=v,r.timeSundays=k,r.timeThursday=_,r.timeThursdays=E,r.timeTuesday=x,r.timeTuesdays=M,r.timeWednesday=b,r.timeWednesdays=S,r.timeWeek=v,r.timeWeeks=k,r.timeYear=O,r.timeYears=z,r.utcDay=N,r.utcDays=j,r.utcFriday=W,r.utcFridays=tt,r.utcHour=F,r.utcHours=B,r.utcMillisecond=o,r.utcMilliseconds=s,r.utcMinute=D,r.utcMinutes=R,r.utcMonday=H,r.utcMondays=J,r.utcMonth=tr,r.utcMonths=tn,r.utcSaturday=X,r.utcSaturdays=te,r.utcSecond=l,r.utcSeconds=c,r.utcSunday=V,r.utcSundays=Z,r.utcThursday=Y,r.utcThursdays=$,r.utcTuesday=q,r.utcTuesdays=K,r.utcWednesday=G,r.utcWednesdays=Q,r.utcWeek=V,r.utcWeeks=Z,r.utcYear=ti,r.utcYears=ta,Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:(a=a||self).d3=a.d3||{})},{}],122:[function(r,n,i){arguments[4][121][0].apply(i,arguments)},{dup:121}],123:[function(r,n,i){var a;a=this,function(r){"use strict";var n,i,a=0,o=0,s=0,l=0,c=0,u=0,f="object"==typeof performance&&performance.now?performance:Date,h="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function p(){return c||(h(d),c=f.now()+u)}function d(){c=0}function m(){this._call=this._time=this._next=null}function g(r,n,i){var a=new m;return a.restart(r,n,i),a}function v(){p(),++a;for(var r,i=n;i;)(r=c-i._time)>=0&&i._call.call(null,r),i=i._next;--a}function y(){c=(l=f.now())+u,a=o=0;try{v()}finally{a=0,function(){for(var r,a,o=n,s=1/0;o;)o._call?(s>o._time&&(s=o._time),r=o,o=o._next):(a=o._next,o._next=null,o=r?r._next=a:n=a);i=r,b(s)}(),c=0}}function x(){var r=f.now(),n=r-l;n>1e3&&(u-=n,l=r)}function b(r){a||(o&&(o=clearTimeout(o)),r-c>24?(r<1/0&&(o=setTimeout(y,r-f.now()-u)),s&&(s=clearInterval(s))):(s||(l=f.now(),s=setInterval(x,1e3)),a=1,h(y)))}m.prototype=g.prototype={constructor:m,restart:function(r,a,o){if("function"!=typeof r)throw TypeError("callback is not a function");o=(null==o?p():+o)+(null==a?0:+a),this._next||i===this||(i?i._next=this:n=this,i=this),this._call=r,this._time=o,b()},stop:function(){this._call&&(this._call=null,this._time=1/0,b())}},r.interval=function(r,n,i){var a=new m,o=n;return null==n?a.restart(r,n,i):(n=+n,i=null==i?p():+i,a.restart(function s(l){l+=o,a.restart(s,o+=n,i),r(l)},n,i)),a},r.now=p,r.timeout=function(r,n,i){var a=new m;return n=null==n?0:+n,a.restart(function(i){a.stop(),r(i+n)},n,i),a},r.timer=g,r.timerFlush=v,Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:(a=a||self).d3=a.d3||{})},{}],124:[function(r,n,i){n.exports=function(){for(var r=0;r<arguments.length;r++)if(void 0!==arguments[r])return arguments[r]}},{}],125:[function(r,n,i){"use strict";n.exports=s;var a=(s.canvas=document.createElement("canvas")).getContext("2d"),o=l([32,126]);function s(r,n){Array.isArray(r)&&(r=r.join(", "));var i,s={},c=16,u=.05;n&&(2===n.length&&"number"==typeof n[0]?i=l(n):Array.isArray(n)?i=n:(n.o?i=l(n.o):n.pairs&&(i=n.pairs),n.fontSize&&(c=n.fontSize),null!=n.threshold&&(u=n.threshold))),i||(i=o),a.font=c+"px "+r;for(var f=0;f<i.length;f++){var h=i[f],p=a.measureText(h[0]).width+a.measureText(h[1]).width,d=a.measureText(h).width;if(Math.abs(p-d)>c*u){var m=(d-p)/c;s[h]=1e3*m}}return s}function l(r){for(var n=[],i=r[0];i<=r[1];i++)for(var a=String.fromCharCode(i),o=r[0];o<r[1];o++){var s=a+String.fromCharCode(o);n.push(s)}return n}s.createPairs=l,s.ascii=o},{}],126:[function(r,n,i){var a=r("abs-svg-path"),o=r("normalize-svg-path"),s={M:"moveTo",C:"bezierCurveTo"};n.exports=function(r,n){r.beginPath(),o(a(n)).forEach(function(n){var i=n[0],a=n.slice(1);r[s[i]].apply(r,a)}),r.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(r,n,i){n.exports=function(r){switch(r){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(r,n,i){"use strict";n.exports=function(r,n){switch(void 0===n&&(n=0),typeof r){case"number":if(r>0)return function(r,n){var i,a;for(i=Array(r),a=0;a<r;++a)i[a]=n;return i}(0|r,n);break;case"object":if("number"==typeof r.length)return function r(n,i,a){var o=0|n[a];if(o<=0)return[];var s,l=Array(o);if(a===n.length-1)for(s=0;s<o;++s)l[s]=i;else for(s=0;s<o;++s)l[s]=r(n,i,a+1);return l}(r,n,0)}return[]}},{}],129:[function(r,n,i){"use strict";function a(r,n,i){i=i||2;var a,d,m,y,b,_,w,T=n&&n.length,k=T?n[0]*i:r.length,A=o(r,0,k,i,!0),M=[];if(!A||A.next===A.prev)return M;if(T&&(A=function(r,n,i,a){var c,h,p,d,m,y=[];for(c=0,h=n.length;c<h;c++)p=n[c]*a,d=c<h-1?n[c+1]*a:r.length,(m=o(r,p,d,a,!1))===m.next&&(m.steiner=!0),y.push(function(r){var n=r,i=r;do(n.x<i.x||n.x===i.x&&n.y<i.y)&&(i=n),n=n.next;while(n!==r);return i}(m));for(y.sort(l),c=0;c<y.length;c++)(function(r,n){if(n=function(r,n){var i,a,o,s=n,l=r.x,c=r.y,h=-1/0;do{if(c<=s.y&&c>=s.next.y&&s.next.y!==s.y){var p=s.x+(c-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(p<=l&&p>h){if(h=p,p===l){if(c===s.y)return s;if(c===s.next.y)return s.next}o=s.x<s.next.x?s:s.next}}s=s.next}while(s!==n);if(!o)return null;if(l===h)return o;var d,m=o,v=o.x,y=o.y,x=1/0;s=o;do l>=s.x&&s.x>=v&&l!==s.x&&u(c<y?l:h,c,v,y,c<y?h:l,c,s.x,s.y)&&(d=Math.abs(c-s.y)/(l-s.x),g(s,r)&&(d<x||d===x&&(s.x>o.x||s.x===o.x&&(i=o,a=s,0>f(i.prev,i,a.prev)&&0>f(a.next,i,i.next))))&&(o=s,x=d)),s=s.next;while(s!==m);return o}(r,n)){var i=v(n,r);s(n,n.next),s(i,i.next)}})(y[c],i),i=s(i,i.next);return i}(r,n,A,i)),r.length>80*i){a=m=r[0],d=y=r[1];for(var S=i;S<k;S+=i)(b=r[S])<a&&(a=b),(_=r[S+1])<d&&(d=_),b>m&&(m=b),_>y&&(y=_);w=0!==(w=Math.max(m-a,y-d))?1/w:0}return function r(n,i,a,o,l,d,m){if(n){!m&&d&&function(r,n,i,a){var o=r;do null===o.z&&(o.z=c(o.x,o.y,n,i,a)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==r);o.prevZ.nextZ=null,o.prevZ=null,function(r){var n,i,a,o,s,l,c,u,f=1;do{for(i=r,r=null,s=null,l=0;i;){for(l++,a=i,c=0,n=0;n<f&&(c++,a=a.nextZ);n++);for(u=f;c>0||u>0&&a;)0!==c&&(0===u||!a||i.z<=a.z)?(o=i,i=i.nextZ,c--):(o=a,a=a.nextZ,u--),s?s.nextZ=o:r=o,o.prevZ=s,s=o;i=a}s.nextZ=null,f*=2}while(l>1)}(o)}(n,o,l,d);for(var y,b,_=n;n.prev!==n.next;)if(y=n.prev,b=n.next,d?function(r,n,i,a){var o=r.prev,s=r.next;if(f(o,r,s)>=0)return!1;for(var l=o.x<r.x?o.x<s.x?o.x:s.x:r.x<s.x?r.x:s.x,h=o.y<r.y?o.y<s.y?o.y:s.y:r.y<s.y?r.y:s.y,p=o.x>r.x?o.x>s.x?o.x:s.x:r.x>s.x?r.x:s.x,d=o.y>r.y?o.y>s.y?o.y:s.y:r.y>s.y?r.y:s.y,m=c(l,h,n,i,a),g=c(p,d,n,i,a),v=r.prevZ,y=r.nextZ;v&&v.z>=m&&y&&y.z<=g;){if(v!==r.prev&&v!==r.next&&u(o.x,o.y,r.x,r.y,s.x,s.y,v.x,v.y)&&f(v.prev,v,v.next)>=0||(v=v.prevZ,y!==r.prev&&y!==r.next&&u(o.x,o.y,r.x,r.y,s.x,s.y,y.x,y.y)&&f(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;v&&v.z>=m;){if(v!==r.prev&&v!==r.next&&u(o.x,o.y,r.x,r.y,s.x,s.y,v.x,v.y)&&f(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;y&&y.z<=g;){if(y!==r.prev&&y!==r.next&&u(o.x,o.y,r.x,r.y,s.x,s.y,y.x,y.y)&&f(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}(n,o,l,d):function(r){var n=r.prev,i=r.next;if(f(n,r,i)>=0)return!1;for(var a=r.next.next;a!==r.prev;){if(u(n.x,n.y,r.x,r.y,i.x,i.y,a.x,a.y)&&f(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}(n))i.push(y.i/a),i.push(n.i/a),i.push(b.i/a),x(n),n=b.next,_=b.next;else if((n=b)===_){m?1===m?r(n=function(r,n,i){var a=r;do{var o=a.prev,l=a.next.next;!h(o,l)&&p(o,a,a.next,l)&&g(o,l)&&g(l,o)&&(n.push(o.i/i),n.push(a.i/i),n.push(l.i/i),x(a),x(a.next),a=r=l),a=a.next}while(a!==r);return s(a)}(s(n),i,a),i,a,o,l,d,2):2===m&&function(n,i,a,o,l,c){var u=n;do{for(var d,m,y=u.next.next;y!==u.prev;){if(u.i!==y.i&&(d=u,m=y,d.next.i!==m.i&&d.prev.i!==m.i&&!function(r,n){var i=r;do{if(i.i!==r.i&&i.next.i!==r.i&&i.i!==n.i&&i.next.i!==n.i&&p(i,i.next,r,n))return!0;i=i.next}while(i!==r);return!1}(d,m)&&(g(d,m)&&g(m,d)&&function(r,n){var i=r,a=!1,o=(r.x+n.x)/2,s=(r.y+n.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&o<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(a=!a),i=i.next;while(i!==r);return a}(d,m)&&(f(d.prev,d,m.prev)||f(d,m.prev,m))||h(d,m)&&f(d.prev,d,d.next)>0&&f(m.prev,m,m.next)>0))){var x=v(u,y);return u=s(u,u.next),x=s(x,x.next),r(u,i,a,o,l,c),void r(x,i,a,o,l,c)}y=y.next}u=u.next}while(u!==n)}(n,i,a,o,l,d):r(s(n),i,a,o,l,d,1);break}}}(A,M,i,a,d,w),M}function o(r,n,i,a,o){var s,l;if(o===_(r,n,i,a)>0)for(s=n;s<i;s+=a)l=y(s,r[s],r[s+1],l);else for(s=i-a;s>=n;s-=a)l=y(s,r[s],r[s+1],l);return l&&h(l,l.next)&&(x(l),l=l.next),l}function s(r,n){if(!r)return r;n||(n=r);var i,a=r;do if(i=!1,a.steiner||!h(a,a.next)&&0!==f(a.prev,a,a.next))a=a.next;else{if(x(a),(a=n=a.prev)===a.next)break;i=!0}while(i||a!==n);return n}function l(r,n){return r.x-n.x}function c(r,n,i,a,o){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-i)*o)|r<<8))|r<<4))|r<<2))|r<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-a)*o)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function u(r,n,i,a,o,s,l,c){return(o-l)*(n-c)-(r-l)*(s-c)>=0&&(r-l)*(a-c)-(i-l)*(n-c)>=0&&(i-l)*(s-c)-(o-l)*(a-c)>=0}function f(r,n,i){return(n.y-r.y)*(i.x-n.x)-(n.x-r.x)*(i.y-n.y)}function h(r,n){return r.x===n.x&&r.y===n.y}function p(r,n,i,a){var o=m(f(r,n,i)),s=m(f(r,n,a)),l=m(f(i,a,r)),c=m(f(i,a,n));return o!==s&&l!==c||!(0!==o||!d(r,i,n))||!(0!==s||!d(r,a,n))||!(0!==l||!d(i,r,a))||!(0!==c||!d(i,n,a))}function d(r,n,i){return n.x<=Math.max(r.x,i.x)&&n.x>=Math.min(r.x,i.x)&&n.y<=Math.max(r.y,i.y)&&n.y>=Math.min(r.y,i.y)}function m(r){return r>0?1:r<0?-1:0}function g(r,n){return 0>f(r.prev,r,r.next)?f(r,n,r.next)>=0&&f(r,r.prev,n)>=0:0>f(r,n,r.prev)||0>f(r,r.next,n)}function v(r,n){var i=new b(r.i,r.x,r.y),a=new b(n.i,n.x,n.y),o=r.next,s=n.prev;return r.next=n,n.prev=r,i.next=o,o.prev=i,a.next=i,i.prev=a,s.next=a,a.prev=s,a}function y(r,n,i,a){var o=new b(r,n,i);return a?(o.next=a.next,o.prev=a,a.next.prev=o,a.next=o):(o.prev=o,o.next=o),o}function x(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function b(r,n,i){this.i=r,this.x=n,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _(r,n,i,a){for(var o=0,s=n,l=i-a;s<i;s+=a)o+=(r[l]-r[s])*(r[s+1]+r[l+1]),l=s;return o}n.exports=a,n.exports.default=a,a.deviation=function(r,n,i,a){var o=n&&n.length,s=o?n[0]*i:r.length,l=Math.abs(_(r,0,s,i));if(o)for(var c=0,u=n.length;c<u;c++){var f=n[c]*i,h=c<u-1?n[c+1]*i:r.length;l-=Math.abs(_(r,f,h,i))}var p=0;for(c=0;c<a.length;c+=3){var d=a[c]*i,m=a[c+1]*i,g=a[c+2]*i;p+=Math.abs((r[d]-r[g])*(r[m+1]-r[d+1])-(r[d]-r[m])*(r[g+1]-r[d+1]))}return 0===l&&0===p?0:Math.abs((p-l)/l)},a.flatten=function(r){for(var n=r[0][0].length,i={vertices:[],holes:[],dimensions:n},a=0,o=0;o<r.length;o++){for(var s=0;s<r[o].length;s++)for(var l=0;l<n;l++)i.vertices.push(r[o][s][l]);o>0&&(a+=r[o-1].length,i.holes.push(a))}return i}},{}],130:[function(r,n,i){var a=r("strongly-connected-components");n.exports=function(r,n){var i,o=[],s=[],l=[],c={},u=[];i=0;for(var f=r.length;i<f;){var h=function(n){!function(n){for(var i=0;i<r.length;i++)i<n&&(r[i]=[]),r[i]=r[i].filter(function(r){return r>=n})}(n);for(var i,o=a(r).components.filter(function(r){return r.length>1}),s=1/0,l=0;l<o.length;l++)for(var c=0;c<o[l].length;c++)o[l][c]<s&&(s=o[l][c],i=l);var u=o[i];return!!u&&{leastVertex:s,adjList:r.map(function(r,n){return -1===u.indexOf(n)?[]:r.filter(function(r){return -1!==u.indexOf(r)})})}}(i);if(i=h.leastVertex,u=h.adjList){for(var p=0;p<u.length;p++)for(var d=0;d<u[p].length;d++){var m=u[p][d];l[+m]=!1,c[m]={}}(function r(a){var f,h,p=!1;for(s.push(a),l[a]=!0,f=0;f<u[a].length;f++)(h=u[a][f])===i?(function(i,a){var s=[].concat(a).concat(i);n?n(r):o.push(s)}(i,s),p=!0):l[h]||(p=r(h));if(p)!function r(n){l[n]=!1,c.hasOwnProperty(n)&&Object.keys(c[n]).forEach(function(i){delete c[n][i],l[i]&&r(i)})}(a);else for(f=0;f<u[a].length;f++){var d=c[h=u[a][f]];d||(d={},c[h]=d),d[h]=!0}return s.pop(),p})(i),i+=1}else i=f}return n?void 0:o}},{"strongly-connected-components":306}],131:[function(r,n,i){"use strict";var a=r("../../object/valid-value");n.exports=function(){return a(this).length=0,this}},{"../../object/valid-value":162}],132:[function(r,n,i){"use strict";n.exports=r("./is-implemented")()?Array.from:r("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(r,n,i){"use strict";n.exports=function(){var r,n,i=Array.from;return"function"==typeof i&&!!((n=i(r=["raz","dwa"]))&&n!==r&&"dwa"===n[1])}},{}],134:[function(r,n,i){"use strict";var a=r("es6-symbol").iterator,o=r("../../function/is-arguments"),s=r("../../function/is-function"),l=r("../../number/to-pos-integer"),c=r("../../object/valid-callable"),u=r("../../object/valid-value"),f=r("../../object/is-value"),h=r("../../string/is-string"),p=Array.isArray,d=Function.prototype.call,m={configurable:!0,enumerable:!0,writable:!0,value:null},g=Object.defineProperty;n.exports=function(r){var n,i,v,y,x,b,_,w,T,k,A=arguments[1],M=arguments[2];if(r=Object(u(r)),f(A)&&c(A),this&&this!==Array&&s(this))n=this;else{if(!A){if(o(r))return 1!==(x=r.length)?Array.apply(null,r):((y=[,])[0]=r[0],y);if(p(r)){for(y=Array(x=r.length),i=0;i<x;++i)y[i]=r[i];return y}}y=[]}if(!p(r)){if(void 0!==(T=r[a])){for(_=c(T).call(r),n&&(y=new n),w=_.next(),i=0;!w.done;)k=A?d.call(A,M,w.value,i):w.value,n?(m.value=k,g(y,i,m)):y[i]=k,w=_.next(),++i;x=i}else if(h(r)){for(x=r.length,n&&(y=new n),i=0,v=0;i<x;++i)k=r[i],i+1<x&&(b=k.charCodeAt(0))>=55296&&b<=56319&&(k+=r[++i]),k=A?d.call(A,M,k,v):k,n?(m.value=k,g(y,v,m)):y[v]=k,++v;x=v}}if(void 0===x)for(x=l(r.length),n&&(y=new n(x)),i=0;i<x;++i)k=A?d.call(A,M,r[i],i):r[i],n?(m.value=k,g(y,i,m)):y[i]=k;return n&&(m.value=null,y.length=x),y}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(r,n,i){"use strict";var a=Object.prototype.toString,o=a.call(function(){return arguments}());n.exports=function(r){return a.call(r)===o}},{}],136:[function(r,n,i){"use strict";var a=Object.prototype.toString,o=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);n.exports=function(r){return"function"==typeof r&&o(a.call(r))}},{}],137:[function(r,n,i){"use strict";n.exports=function(){}},{}],138:[function(r,n,i){"use strict";n.exports=r("./is-implemented")()?Math.sign:r("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(r,n,i){"use strict";n.exports=function(){var r=Math.sign;return"function"==typeof r&&1===r(10)&&-1===r(-20)}},{}],140:[function(r,n,i){"use strict";n.exports=function(r){return isNaN(r=Number(r))||0===r?r:r>0?1:-1}},{}],141:[function(r,n,i){"use strict";var a=r("../math/sign"),o=Math.abs,s=Math.floor;n.exports=function(r){return isNaN(r)?0:0!==(r=Number(r))&&isFinite(r)?a(r)*s(o(r)):r}},{"../math/sign":138}],142:[function(r,n,i){"use strict";var a=r("./to-integer"),o=Math.max;n.exports=function(r){return o(0,a(r))}},{"./to-integer":141}],143:[function(r,n,i){"use strict";var a=r("./valid-callable"),o=r("./valid-value"),s=Function.prototype.bind,l=Function.prototype.call,c=Object.keys,u=Object.prototype.propertyIsEnumerable;n.exports=function(r,n){return function(i,f){var h,p=arguments[2],d=arguments[3];return i=Object(o(i)),a(f),h=c(i),d&&h.sort("function"==typeof d?s.call(d,i):void 0),"function"!=typeof r&&(r=h[r]),l.call(r,h,function(r,a){return u.call(i,r)?l.call(f,p,i[r],r,i,a):n})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(r,n,i){"use strict";n.exports=r("./is-implemented")()?Object.assign:r("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(r,n,i){"use strict";n.exports=function(){var r,n=Object.assign;return"function"==typeof n&&(n(r={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),r.foo+r.bar+r.trzy==="razdwatrzy")}},{}],146:[function(r,n,i){"use strict";var a=r("../keys"),o=r("../valid-value"),s=Math.max;n.exports=function(r,n){var i,l,c,u=s(arguments.length,2);for(r=Object(o(r)),c=function(a){try{r[a]=n[a]}catch(r){i||(i=r)}},l=1;l<u;++l)a(n=arguments[l]).forEach(c);if(void 0!==i)throw i;return r}},{"../keys":152,"../valid-value":162}],147:[function(r,n,i){"use strict";var a=r("../array/from"),o=r("./assign"),s=r("./valid-value");n.exports=function(r){var n=Object(s(r)),i=arguments[1],l=Object(arguments[2]);if(n!==r&&!i)return n;var c={};return i?a(i,function(n){(l.ensure||n in r)&&(c[n]=r[n])}):o(c,r),c}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(r,n,i){"use strict";var a,o,s,l,c=Object.create;r("./set-prototype-of/is-implemented")()||(a=r("./set-prototype-of/shim")),n.exports=a?1!==a.level?c:(o={},s={},l={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(r){s[r]="__proto__"!==r?l:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(o,s),Object.defineProperty(a,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:o}),function(r,n){return c(null===r?o:r,n)}):c},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(r,n,i){"use strict";n.exports=r("./_iterate")("forEach")},{"./_iterate":143}],150:[function(r,n,i){"use strict";var a=r("./is-value"),o={function:!0,object:!0};n.exports=function(r){return a(r)&&o[typeof r]||!1}},{"./is-value":151}],151:[function(r,n,i){"use strict";var a=r("../function/noop")();n.exports=function(r){return r!==a&&null!==r}},{"../function/noop":137}],152:[function(r,n,i){"use strict";n.exports=r("./is-implemented")()?Object.keys:r("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(r,n,i){"use strict";n.exports=function(){try{return Object.keys("primitive"),!0}catch(r){return!1}}},{}],154:[function(r,n,i){"use strict";var a=r("../is-value"),o=Object.keys;n.exports=function(r){return o(a(r)?Object(r):r)}},{"../is-value":151}],155:[function(r,n,i){"use strict";var a=r("./valid-callable"),o=r("./for-each"),s=Function.prototype.call;n.exports=function(r,n){var i={},l=arguments[2];return a(n),o(r,function(r,a,o,c){i[a]=s.call(n,l,r,a,o,c)}),i}},{"./for-each":149,"./valid-callable":160}],156:[function(r,n,i){"use strict";var a=r("./is-value"),o=Array.prototype.forEach,s=Object.create,l=function(r,n){var i;for(i in r)n[i]=r[i]};n.exports=function(r){var n=s(null);return o.call(arguments,function(r){a(r)&&l(Object(r),n)}),n}},{"./is-value":151}],157:[function(r,n,i){"use strict";n.exports=r("./is-implemented")()?Object.setPrototypeOf:r("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(r,n,i){"use strict";var a=Object.create,o=Object.getPrototypeOf,s={};n.exports=function(){var r=Object.setPrototypeOf,n=arguments[0]||a;return"function"==typeof r&&o(r(n(null),s))===s}},{}],159:[function(r,n,i){"use strict";var a,o,s,l,c=r("../is-object"),u=r("../valid-value"),f=Object.prototype.isPrototypeOf,h=Object.defineProperty,p={configurable:!0,enumerable:!1,writable:!0,value:void 0};l=function(r,n){if(u(r),null===n||c(n))return r;throw TypeError("Prototype must be null or an object")},n.exports=(a=function(){var r,n=Object.create(null),i={},a=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(a){try{(r=a.set).call(n,i)}catch(r){}if(Object.getPrototypeOf(n)===i)return{set:r,level:2}}return n.__proto__=i,Object.getPrototypeOf(n)===i?{level:2}:((n={}).__proto__=i,Object.getPrototypeOf(n)===i&&{level:1})}())?(2===a.level?a.set?(s=a.set,o=function(r,n){return s.call(l(r,n),n),r}):o=function(r,n){return l(r,n).__proto__=n,r}:o=function r(n,i){var a;return l(n,i),(a=f.call(r.nullPolyfill,n))&&delete r.nullPolyfill.__proto__,null===i&&(i=r.nullPolyfill),n.__proto__=i,a&&h(r.nullPolyfill,"__proto__",p),n},Object.defineProperty(o,"level",{configurable:!1,enumerable:!1,writable:!1,value:a.level})):null,r("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(r,n,i){"use strict";n.exports=function(r){if("function"!=typeof r)throw TypeError(r+" is not a function");return r}},{}],161:[function(r,n,i){"use strict";var a=r("./is-object");n.exports=function(r){if(!a(r))throw TypeError(r+" is not an Object");return r}},{"./is-object":150}],162:[function(r,n,i){"use strict";var a=r("./is-value");n.exports=function(r){if(!a(r))throw TypeError("Cannot use null or undefined");return r}},{"./is-value":151}],163:[function(r,n,i){"use strict";n.exports=r("./is-implemented")()?String.prototype.contains:r("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(r,n,i){"use strict";var a="razdwatrzy";n.exports=function(){return"function"==typeof a.contains&&!0===a.contains("dwa")&&!1===a.contains("foo")}},{}],165:[function(r,n,i){"use strict";var a=String.prototype.indexOf;n.exports=function(r){return a.call(this,r,arguments[1])>-1}},{}],166:[function(r,n,i){"use strict";var a=Object.prototype.toString,o=a.call("");n.exports=function(r){return"string"==typeof r||r&&"object"==typeof r&&(r instanceof String||a.call(r)===o)||!1}},{}],167:[function(r,n,i){"use strict";var a=Object.create(null),o=Math.random;n.exports=function(){var r;do r=o().toString(36).slice(2);while(a[r]);return r}},{}],168:[function(r,n,i){"use strict";var a,o=r("es5-ext/object/set-prototype-of"),s=r("es5-ext/string/#/contains"),l=r("d"),c=r("es6-symbol"),u=r("./"),f=Object.defineProperty;a=n.exports=function(r,n){if(!(this instanceof a))throw TypeError("Constructor requires 'new'");u.call(this,r),f(this,"__kind__",l("",n=n?s.call(n,"key+value")?"key+value":s.call(n,"key")?"key":"value":"value"))},o&&o(a,u),delete a.prototype.constructor,a.prototype=Object.create(u.prototype,{_resolve:l(function(r){return"value"===this.__kind__?this.__list__[r]:"key+value"===this.__kind__?[r,this.__list__[r]]:r})}),f(a.prototype,c.toStringTag,l("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(r,n,i){"use strict";var a=r("es5-ext/function/is-arguments"),o=r("es5-ext/object/valid-callable"),s=r("es5-ext/string/is-string"),l=r("./get"),c=Array.isArray,u=Function.prototype.call,f=Array.prototype.some;n.exports=function(r,n){var i,h,p,d,m,g,v,y,x=arguments[2];if(c(r)||a(r)?i="array":s(r)?i="string":r=l(r),o(n),p=function(){d=!0},"array"!==i){if("string"!==i)for(h=r.next();!h.done;){if(u.call(n,x,h.value,p),d)return;h=r.next()}else for(g=r.length,m=0;m<g&&(v=r[m],m+1<g&&(y=v.charCodeAt(0))>=55296&&y<=56319&&(v+=r[++m]),u.call(n,x,v,p),!d);++m);}else f.call(r,function(r){return u.call(n,x,r,p),d})}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(r,n,i){"use strict";var a=r("es5-ext/function/is-arguments"),o=r("es5-ext/string/is-string"),s=r("./array"),l=r("./string"),c=r("./valid-iterable"),u=r("es6-symbol").iterator;n.exports=function(r){return"function"==typeof c(r)[u]?r[u]():a(r)?new s(r):o(r)?new l(r):new s(r)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(r,n,i){"use strict";var a,o=r("es5-ext/array/#/clear"),s=r("es5-ext/object/assign"),l=r("es5-ext/object/valid-callable"),c=r("es5-ext/object/valid-value"),u=r("d"),f=r("d/auto-bind"),h=r("es6-symbol"),p=Object.defineProperty,d=Object.defineProperties;n.exports=a=function(r,n){if(!(this instanceof a))throw TypeError("Constructor requires 'new'");d(this,{__list__:u("w",c(r)),__context__:u("w",n),__nextIndex__:u("w",0)}),n&&(l(n.on),n.on("_add",this._onAdd),n.on("_delete",this._onDelete),n.on("_clear",this._onClear))},delete a.prototype.constructor,d(a.prototype,s({_next:u(function(){var r;if(this.__list__)return this.__redo__&&void 0!==(r=this.__redo__.shift())?r:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:u(function(){return this._createResult(this._next())}),_createResult:u(function(r){return void 0===r?{done:!0,value:void 0}:{done:!1,value:this._resolve(r)}}),_resolve:u(function(r){return this.__list__[r]}),_unBind:u(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:u(function(){return"[object "+(this[h.toStringTag]||"Object")+"]"})},f({_onAdd:u(function(r){r>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(n,i){n>=r&&(this.__redo__[i]=++n)},this),this.__redo__.push(r)):p(this,"__redo__",u("c",[r])))}),_onDelete:u(function(r){var n;r>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(n=this.__redo__.indexOf(r))&&this.__redo__.splice(n,1),this.__redo__.forEach(function(n,i){n>r&&(this.__redo__[i]=--n)},this)))}),_onClear:u(function(){this.__redo__&&o.call(this.__redo__),this.__nextIndex__=0})}))),p(a.prototype,h.iterator,u(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(r,n,i){"use strict";var a=r("es5-ext/function/is-arguments"),o=r("es5-ext/object/is-value"),s=r("es5-ext/string/is-string"),l=r("es6-symbol").iterator,c=Array.isArray;n.exports=function(r){return!!o(r)&&(!!c(r)||!!s(r)||!!a(r)||"function"==typeof r[l])}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(r,n,i){"use strict";var a,o=r("es5-ext/object/set-prototype-of"),s=r("d"),l=r("es6-symbol"),c=r("./"),u=Object.defineProperty;a=n.exports=function(r){if(!(this instanceof a))throw TypeError("Constructor requires 'new'");r=String(r),c.call(this,r),u(this,"__length__",s("",r.length))},o&&o(a,c),delete a.prototype.constructor,a.prototype=Object.create(c.prototype,{_next:s(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:s(function(r){var n,i=this.__list__[r];return this.__nextIndex__===this.__length__?i:(n=i.charCodeAt(0))>=55296&&n<=56319?i+this.__list__[this.__nextIndex__++]:i})}),u(a.prototype,l.toStringTag,s("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(r,n,i){"use strict";var a=r("./is-iterable");n.exports=function(r){if(!a(r))throw TypeError(r+" is not iterable");return r}},{"./is-iterable":172}],175:[function(r,n,i){"use strict";n.exports=r("./is-implemented")()?r("ext/global-this").Symbol:r("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(r,n,i){"use strict";var a=r("ext/global-this"),o={object:!0,symbol:!0};n.exports=function(){var r,n=a.Symbol;if("function"!=typeof n)return!1;r=n("test symbol");try{String(r)}catch(r){return!1}return!!o[typeof n.iterator]&&!!o[typeof n.toPrimitive]&&!!o[typeof n.toStringTag]}},{"ext/global-this":188}],177:[function(r,n,i){"use strict";n.exports=function(r){return!!r&&("symbol"==typeof r||!!r.constructor&&"Symbol"===r.constructor.name&&"Symbol"===r[r.constructor.toStringTag])}},{}],178:[function(r,n,i){"use strict";var a=r("d"),o=Object.defineProperty,s=Object.prototype,l=(0,Object.create)(null);n.exports=function(r){for(var n,i,c=0;l[r+(c||"")];)++c;return l[r+=c||""]=!0,o(s,n="@@"+r,a.gs(null,function(r){i||(i=!0,o(this,n,a(r)),i=!1)})),n}},{d:106}],179:[function(r,n,i){"use strict";var a=r("d"),o=r("ext/global-this").Symbol;n.exports=function(r){return Object.defineProperties(r,{hasInstance:a("",o&&o.hasInstance||r("hasInstance")),isConcatSpreadable:a("",o&&o.isConcatSpreadable||r("isConcatSpreadable")),iterator:a("",o&&o.iterator||r("iterator")),match:a("",o&&o.match||r("match")),replace:a("",o&&o.replace||r("replace")),search:a("",o&&o.search||r("search")),species:a("",o&&o.species||r("species")),split:a("",o&&o.split||r("split")),toPrimitive:a("",o&&o.toPrimitive||r("toPrimitive")),toStringTag:a("",o&&o.toStringTag||r("toStringTag")),unscopables:a("",o&&o.unscopables||r("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(r,n,i){"use strict";var a=r("d"),o=r("../../../validate-symbol"),s=Object.create(null);n.exports=function(r){return Object.defineProperties(r,{for:a(function(n){return s[n]?s[n]:s[n]=r(String(n))}),keyFor:a(function(r){var n;for(n in o(r),s)if(s[n]===r)return n})})}},{"../../../validate-symbol":182,d:106}],181:[function(r,n,i){"use strict";var a,o,s,l=r("d"),c=r("./validate-symbol"),u=r("ext/global-this").Symbol,f=r("./lib/private/generate-name"),h=r("./lib/private/setup/standard-symbols"),p=r("./lib/private/setup/symbol-registry"),d=Object.create,m=Object.defineProperties,g=Object.defineProperty;if("function"==typeof u)try{String(u()),s=!0}catch(r){}else u=null;o=function(r){if(this instanceof o)throw TypeError("Symbol is not a constructor");return a(r)},n.exports=a=function r(n){if(this instanceof r)throw TypeError("Symbol is not a constructor");return s?u(n):m(d(o.prototype),{__description__:l("",n=void 0===n?"":String(n)),__name__:l("",f(n))})},h(a),p(a),m(o.prototype,{constructor:l(a),toString:l("",function(){return this.__name__})}),m(a.prototype,{toString:l(function(){return"Symbol ("+c(this).__description__+")"}),valueOf:l(function(){return c(this)})}),g(a.prototype,a.toPrimitive,l("",function(){var r=c(this);return"symbol"==typeof r?r:r.toString()})),g(a.prototype,a.toStringTag,l("c","Symbol")),g(o.prototype,a.toStringTag,l("c",a.prototype[a.toStringTag])),g(o.prototype,a.toPrimitive,l("c",a.prototype[a.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(r,n,i){"use strict";var a=r("./is-symbol");n.exports=function(r){if(!a(r))throw TypeError(r+" is not a symbol");return r}},{"./is-symbol":177}],183:[function(r,n,i){"use strict";n.exports=r("./is-implemented")()?WeakMap:r("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(r,n,i){"use strict";n.exports=function(){var r,n;if("function"!=typeof WeakMap)return!1;try{r=new WeakMap([[n={},"one"],[{},"two"],[{},"three"]])}catch(r){return!1}return"[object WeakMap]"===String(r)&&"function"==typeof r.set&&r.set({},1)===r&&"function"==typeof r.delete&&"function"==typeof r.has&&"one"===r.get(n)}},{}],185:[function(r,n,i){"use strict";n.exports="function"==typeof WeakMap&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)},{}],186:[function(r,n,i){"use strict";var a,o=r("es5-ext/object/is-value"),s=r("es5-ext/object/set-prototype-of"),l=r("es5-ext/object/valid-object"),c=r("es5-ext/object/valid-value"),u=r("es5-ext/string/random-uniq"),f=r("d"),h=r("es6-iterator/get"),p=r("es6-iterator/for-of"),d=r("es6-symbol").toStringTag,m=r("./is-native-implemented"),g=Array.isArray,v=Object.defineProperty,y=Object.prototype.hasOwnProperty,x=Object.getPrototypeOf;n.exports=a=function(){var r,n=arguments[0];if(!(this instanceof a))throw TypeError("Constructor requires 'new'");return r=m&&s&&WeakMap!==a?s(new WeakMap,x(this)):this,o(n)&&(g(n)||(n=h(n))),v(r,"__weakMapData__",f("c","$weakMap$"+u())),n&&p(n,function(n){c(n),r.set(n[0],n[1])}),r},m&&(s&&s(a,WeakMap),a.prototype=Object.create(WeakMap.prototype,{constructor:f(a)})),Object.defineProperties(a.prototype,{delete:f(function(r){return!!y.call(l(r),this.__weakMapData__)&&(delete r[this.__weakMapData__],!0)}),get:f(function(r){if(y.call(l(r),this.__weakMapData__))return r[this.__weakMapData__]}),has:f(function(r){return y.call(l(r),this.__weakMapData__)}),set:f(function(r,n){return v(l(r),this.__weakMapData__,f("c",n)),this}),toString:f(function(){return"[object WeakMap]"})}),v(a.prototype,d,f("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(r,n,i){var a=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw Error("Unable to resolve global `this`")};n.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(r){return a()}try{return __global__||a()}finally{delete Object.prototype.__global__}}()},{}],188:[function(r,n,i){"use strict";n.exports=r("./is-implemented")()?globalThis:r("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(r,n,i){"use strict";n.exports=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}},{}],190:[function(r,n,i){"use strict";var a=r("is-string-blank");n.exports=function(r){var n=typeof r;if("string"===n){var i=r;if(0==(r=+r)&&a(i))return!1}else if("number"!==n)return!1;return r-r<1}},{"is-string-blank":237}],191:[function(r,n,i){var a=r("dtype");n.exports=function(r,n,i){if(!r)throw TypeError("must specify data as first parameter");if(i=0|+(i||0),Array.isArray(r)&&r[0]&&"number"==typeof r[0][0]){var o,s,l,c,u=r[0].length,f=r.length*u;n&&"string"!=typeof n||(n=new(a(n||"float32"))(f+i));var h=n.length-i;if(f!==h)throw Error("source length "+f+" ("+u+"x"+r.length+") does not match destination length "+h);for(o=0,l=i;o<r.length;o++)for(s=0;s<u;s++)n[l++]=null===r[o][s]?NaN:r[o][s]}else if(n&&"string"!=typeof n)n.set(r,i);else{var p=a(n||"float32");if(Array.isArray(r)||"array"===n)for(n=new p(r.length+i),o=0,l=i,c=n.length;l<c;l++,o++)n[l]=null===r[o]?NaN:r[o];else 0===i?n=new p(r):(n=new p(r.length+i)).set(r,i)}return n}},{dtype:127}],192:[function(r,n,i){"use strict";var a=r("css-font/stringify"),o=[32,126];n.exports=function(r){var n=(r=r||{}).shape?r.shape:r.canvas?[r.canvas.width,r.canvas.height]:[512,512],i=r.canvas||document.createElement("canvas"),s=r.font,l="number"==typeof r.step?[r.step,r.step]:r.step||[32,32],c=r.chars||o;if(s&&"string"!=typeof s&&(s=a(s)),Array.isArray(c)){if(2===c.length&&"number"==typeof c[0]&&"number"==typeof c[1]){for(var u=[],f=c[0],h=0;f<=c[1];f++)u[h++]=String.fromCharCode(f);c=u}}else c=String(c).split("");n=n.slice(),i.width=n[0],i.height=n[1];var p=i.getContext("2d");p.fillStyle="#000",p.fillRect(0,0,i.width,i.height),p.font=s,p.textAlign="center",p.textBaseline="middle",p.fillStyle="#fff";var d=l[0]/2,m=l[1]/2;for(f=0;f<c.length;f++)p.fillText(c[f],d,m),(d+=l[0])>n[0]-l[0]/2&&(d=l[0]/2,m+=l[1]);return i}},{"css-font/stringify":102}],193:[function(r,n,i){"use strict";function a(r,n){n||(n={}),("string"==typeof r||Array.isArray(r))&&(n.family=r);var i=Array.isArray(n.family)?n.family.join(", "):n.family;if(!i)throw Error("`family` must be defined");var c=n.size||n.fontSize||n.em||48,u=n.weight||n.fontWeight||"",f=(r=[n.style||n.fontStyle||"",u,c].join(" ")+"px "+i,n.origin||"top");if(a.cache[i]&&c<=a.cache[i].em)return o(a.cache[i],f);var h=n.canvas||a.canvas,p=h.getContext("2d"),d={upper:void 0!==n.upper?n.upper:"H",lower:void 0!==n.lower?n.lower:"x",descent:void 0!==n.descent?n.descent:"p",ascent:void 0!==n.ascent?n.ascent:"h",tittle:void 0!==n.tittle?n.tittle:"i",overshoot:void 0!==n.overshoot?n.overshoot:"O"},m=Math.ceil(1.5*c);h.height=m,h.width=.5*m,p.font=r;var g={top:0};p.clearRect(0,0,m,m),p.textBaseline="top",p.fillStyle="black",p.fillText("H",0,0);var v=s(p.getImageData(0,0,m,m));p.clearRect(0,0,m,m),p.textBaseline="bottom",p.fillText("H",0,m);var y=s(p.getImageData(0,0,m,m));g.lineHeight=g.bottom=m-y+v,p.clearRect(0,0,m,m),p.textBaseline="alphabetic",p.fillText("H",0,m);var x=m-s(p.getImageData(0,0,m,m))-1+v;g.baseline=g.alphabetic=x,p.clearRect(0,0,m,m),p.textBaseline="middle",p.fillText("H",0,.5*m);var b=s(p.getImageData(0,0,m,m));g.median=g.middle=m-b-1+v-.5*m,p.clearRect(0,0,m,m),p.textBaseline="hanging",p.fillText("H",0,.5*m);var _=s(p.getImageData(0,0,m,m));g.hanging=m-_-1+v-.5*m,p.clearRect(0,0,m,m),p.textBaseline="ideographic",p.fillText("H",0,m);var w=s(p.getImageData(0,0,m,m));if(g.ideographic=m-w-1+v,d.upper&&(p.clearRect(0,0,m,m),p.textBaseline="top",p.fillText(d.upper,0,0),g.upper=s(p.getImageData(0,0,m,m)),g.capHeight=g.baseline-g.upper),d.lower&&(p.clearRect(0,0,m,m),p.textBaseline="top",p.fillText(d.lower,0,0),g.lower=s(p.getImageData(0,0,m,m)),g.xHeight=g.baseline-g.lower),d.tittle&&(p.clearRect(0,0,m,m),p.textBaseline="top",p.fillText(d.tittle,0,0),g.tittle=s(p.getImageData(0,0,m,m))),d.ascent&&(p.clearRect(0,0,m,m),p.textBaseline="top",p.fillText(d.ascent,0,0),g.ascent=s(p.getImageData(0,0,m,m))),d.descent&&(p.clearRect(0,0,m,m),p.textBaseline="top",p.fillText(d.descent,0,0),g.descent=l(p.getImageData(0,0,m,m))),d.overshoot){p.clearRect(0,0,m,m),p.textBaseline="top",p.fillText(d.overshoot,0,0);var T=l(p.getImageData(0,0,m,m));g.overshoot=T-x}for(var k in g)g[k]/=c;return g.em=c,a.cache[i]=g,o(g,f)}function o(r,n){var i={};for(var a in"string"==typeof n&&(n=r[n]),r)"em"!==a&&(i[a]=r[a]-n);return i}function s(r){for(var n=r.height,i=r.data,a=3;a<i.length;a+=4)if(0!==i[a])return Math.floor(.25*(a-3)/n)}function l(r){for(var n=r.height,i=r.data,a=i.length-1;a>0;a-=4)if(0!==i[a])return Math.floor(.25*(a-3)/n)}n.exports=a,a.canvas=document.createElement("canvas"),a.cache={}},{}],194:[function(r,n,i){n.exports=function(r,n){if("string"!=typeof r)throw TypeError("must specify type string");if(n=n||{},"undefined"==typeof document&&!n.canvas)return null;var i=n.canvas||document.createElement("canvas");"number"==typeof n.width&&(i.width=n.width),"number"==typeof n.height&&(i.height=n.height);var a,o=n;try{var s=[r];0===r.indexOf("webgl")&&s.push("experimental-"+r);for(var l=0;l<s.length;l++)if(a=i.getContext(s[l],o))return a}catch(r){a=null}return a||null}},{}],195:[function(r,n,i){n.exports=function(r,n){var i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],u=n[6],f=n[7],h=n[8],p=n[9],d=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15];return r[0]=c*(d*x-m*y)-p*(u*x-f*y)+v*(u*m-f*d),r[1]=-(a*(d*x-m*y)-p*(o*x-s*y)+v*(o*m-s*d)),r[2]=a*(u*x-f*y)-c*(o*x-s*y)+v*(o*f-s*u),r[3]=-(a*(u*m-f*d)-c*(o*m-s*d)+p*(o*f-s*u)),r[4]=-(l*(d*x-m*y)-h*(u*x-f*y)+g*(u*m-f*d)),r[5]=i*(d*x-m*y)-h*(o*x-s*y)+g*(o*m-s*d),r[6]=-(i*(u*x-f*y)-l*(o*x-s*y)+g*(o*f-s*u)),r[7]=i*(u*m-f*d)-l*(o*m-s*d)+h*(o*f-s*u),r[8]=l*(p*x-m*v)-h*(c*x-f*v)+g*(c*m-f*p),r[9]=-(i*(p*x-m*v)-h*(a*x-s*v)+g*(a*m-s*p)),r[10]=i*(c*x-f*v)-l*(a*x-s*v)+g*(a*f-s*c),r[11]=-(i*(c*m-f*p)-l*(a*m-s*p)+h*(a*f-s*c)),r[12]=-(l*(p*y-d*v)-h*(c*y-u*v)+g*(c*d-u*p)),r[13]=i*(p*y-d*v)-h*(a*y-o*v)+g*(a*d-o*p),r[14]=-(i*(c*y-u*v)-l*(a*y-o*v)+g*(a*u-o*c)),r[15]=i*(c*d-u*p)-l*(a*d-o*p)+h*(a*u-o*c),r}},{}],196:[function(r,n,i){n.exports=function(r){var n=new Float32Array(16);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n}},{}],197:[function(r,n,i){n.exports=function(r,n){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r}},{}],198:[function(r,n,i){n.exports=function(){var r=new Float32Array(16);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],199:[function(r,n,i){n.exports=function(r){var n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],l=r[5],c=r[6],u=r[7],f=r[8],h=r[9],p=r[10],d=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return(n*l-i*s)*(p*y-d*v)-(n*c-a*s)*(h*y-d*g)+(n*u-o*s)*(h*v-p*g)+(i*c-a*l)*(f*y-d*m)-(i*u-o*l)*(f*v-p*m)+(a*u-o*c)*(f*g-h*m)}},{}],200:[function(r,n,i){n.exports=function(r,n){var i=n[0],a=n[1],o=n[2],s=n[3],l=i+i,c=a+a,u=o+o,f=i*l,h=a*l,p=a*c,d=o*l,m=o*c,g=o*u,v=s*l,y=s*c,x=s*u;return r[0]=1-p-g,r[1]=h+x,r[2]=d-y,r[3]=0,r[4]=h-x,r[5]=1-f-g,r[6]=m+v,r[7]=0,r[8]=d+y,r[9]=m-v,r[10]=1-f-p,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],201:[function(r,n,i){n.exports=function(r,n,i){var a,o,s,l=i[0],c=i[1],u=i[2],f=Math.sqrt(l*l+c*c+u*u);return 1e-6>Math.abs(f)?null:(l*=f=1/f,c*=f,u*=f,a=Math.sin(n),s=1-(o=Math.cos(n)),r[0]=l*l*s+o,r[1]=c*l*s+u*a,r[2]=u*l*s-c*a,r[3]=0,r[4]=l*c*s-u*a,r[5]=c*c*s+o,r[6]=u*c*s+l*a,r[7]=0,r[8]=l*u*s+c*a,r[9]=c*u*s-l*a,r[10]=u*u*s+o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}},{}],202:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=n[3],c=a+a,u=o+o,f=s+s,h=a*c,p=a*u,d=a*f,m=o*u,g=o*f,v=s*f,y=l*c,x=l*u,b=l*f;return r[0]=1-(m+v),r[1]=p+b,r[2]=d-x,r[3]=0,r[4]=p-b,r[5]=1-(h+v),r[6]=g+y,r[7]=0,r[8]=d+x,r[9]=g-y,r[10]=1-(h+m),r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}},{}],203:[function(r,n,i){n.exports=function(r,n){return r[0]=n[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=n[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],204:[function(r,n,i){n.exports=function(r,n){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}},{}],205:[function(r,n,i){n.exports=function(r,n){var i=Math.sin(n),a=Math.cos(n);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=i,r[7]=0,r[8]=0,r[9]=-i,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],206:[function(r,n,i){n.exports=function(r,n){var i=Math.sin(n),a=Math.cos(n);return r[0]=a,r[1]=0,r[2]=-i,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=i,r[9]=0,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],207:[function(r,n,i){n.exports=function(r,n){var i=Math.sin(n),a=Math.cos(n);return r[0]=a,r[1]=i,r[2]=0,r[3]=0,r[4]=-i,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],208:[function(r,n,i){n.exports=function(r,n,i,a,o,s,l){var c=1/(i-n),u=1/(o-a),f=1/(s-l);return r[0]=2*s*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2*s*u,r[6]=0,r[7]=0,r[8]=(i+n)*c,r[9]=(o+a)*u,r[10]=(l+s)*f,r[11]=-1,r[12]=0,r[13]=0,r[14]=l*s*2*f,r[15]=0,r}},{}],209:[function(r,n,i){n.exports=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],210:[function(r,n,i){n.exports={create:r("./create"),clone:r("./clone"),copy:r("./copy"),identity:r("./identity"),transpose:r("./transpose"),invert:r("./invert"),adjoint:r("./adjoint"),determinant:r("./determinant"),multiply:r("./multiply"),translate:r("./translate"),scale:r("./scale"),rotate:r("./rotate"),rotateX:r("./rotateX"),rotateY:r("./rotateY"),rotateZ:r("./rotateZ"),fromRotation:r("./fromRotation"),fromRotationTranslation:r("./fromRotationTranslation"),fromScaling:r("./fromScaling"),fromTranslation:r("./fromTranslation"),fromXRotation:r("./fromXRotation"),fromYRotation:r("./fromYRotation"),fromZRotation:r("./fromZRotation"),fromQuat:r("./fromQuat"),frustum:r("./frustum"),perspective:r("./perspective"),perspectiveFromFieldOfView:r("./perspectiveFromFieldOfView"),ortho:r("./ortho"),lookAt:r("./lookAt"),str:r("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(r,n,i){n.exports=function(r,n){var i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],u=n[6],f=n[7],h=n[8],p=n[9],d=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15],b=i*c-a*l,_=i*u-o*l,w=i*f-s*l,T=a*u-o*c,k=a*f-s*c,A=o*f-s*u,M=h*v-p*g,S=h*y-d*g,E=h*x-m*g,L=p*y-d*v,C=p*x-m*v,P=d*x-m*y,I=b*P-_*C+w*L+T*E-k*S+A*M;return I?(I=1/I,r[0]=(c*P-u*C+f*L)*I,r[1]=(o*C-a*P-s*L)*I,r[2]=(v*A-y*k+x*T)*I,r[3]=(d*k-p*A-m*T)*I,r[4]=(u*E-l*P-f*S)*I,r[5]=(i*P-o*E+s*S)*I,r[6]=(y*w-g*A-x*_)*I,r[7]=(h*A-d*w+m*_)*I,r[8]=(l*C-c*E+f*M)*I,r[9]=(a*E-i*C-s*M)*I,r[10]=(g*k-v*w+x*b)*I,r[11]=(p*w-h*k-m*b)*I,r[12]=(c*S-l*L-u*M)*I,r[13]=(i*L-a*S+o*M)*I,r[14]=(v*_-g*T-y*b)*I,r[15]=(h*T-p*_+d*b)*I,r):null}},{}],212:[function(r,n,i){var a=r("./identity");n.exports=function(r,n,i,o){var s,l,c,u,f,h,p,d,m,g,v=n[0],y=n[1],x=n[2],b=o[0],_=o[1],w=o[2],T=i[0],k=i[1],A=i[2];return 1e-6>Math.abs(v-T)&&1e-6>Math.abs(y-k)&&1e-6>Math.abs(x-A)?a(r):(g=1/Math.sqrt((p=v-T)*p+(d=y-k)*d+(m=x-A)*m),(g=Math.sqrt((s=_*(m*=g)-w*(d*=g))*s+(l=w*(p*=g)-b*m)*l+(c=b*d-_*p)*c))?(s*=g=1/g,l*=g,c*=g):(s=0,l=0,c=0),(g=Math.sqrt((u=d*c-m*l)*u+(f=m*s-p*c)*f+(h=p*l-d*s)*h))?(u*=g=1/g,f*=g,h*=g):(u=0,f=0,h=0),r[0]=s,r[1]=u,r[2]=p,r[3]=0,r[4]=l,r[5]=f,r[6]=d,r[7]=0,r[8]=c,r[9]=h,r[10]=m,r[11]=0,r[12]=-(s*v+l*y+c*x),r[13]=-(u*v+f*y+h*x),r[14]=-(p*v+d*y+m*x),r[15]=1,r)}},{"./identity":209}],213:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=n[3],c=n[4],u=n[5],f=n[6],h=n[7],p=n[8],d=n[9],m=n[10],g=n[11],v=n[12],y=n[13],x=n[14],b=n[15],_=i[0],w=i[1],T=i[2],k=i[3];return r[0]=_*a+w*c+T*p+k*v,r[1]=_*o+w*u+T*d+k*y,r[2]=_*s+w*f+T*m+k*x,r[3]=_*l+w*h+T*g+k*b,_=i[4],w=i[5],T=i[6],k=i[7],r[4]=_*a+w*c+T*p+k*v,r[5]=_*o+w*u+T*d+k*y,r[6]=_*s+w*f+T*m+k*x,r[7]=_*l+w*h+T*g+k*b,_=i[8],w=i[9],T=i[10],k=i[11],r[8]=_*a+w*c+T*p+k*v,r[9]=_*o+w*u+T*d+k*y,r[10]=_*s+w*f+T*m+k*x,r[11]=_*l+w*h+T*g+k*b,_=i[12],w=i[13],T=i[14],k=i[15],r[12]=_*a+w*c+T*p+k*v,r[13]=_*o+w*u+T*d+k*y,r[14]=_*s+w*f+T*m+k*x,r[15]=_*l+w*h+T*g+k*b,r}},{}],214:[function(r,n,i){n.exports=function(r,n,i,a,o,s,l){var c=1/(n-i),u=1/(a-o),f=1/(s-l);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(n+i)*c,r[13]=(o+a)*u,r[14]=(l+s)*f,r[15]=1,r}},{}],215:[function(r,n,i){n.exports=function(r,n,i,a,o){var s=1/Math.tan(n/2),l=1/(a-o);return r[0]=s/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(o+a)*l,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*o*a*l,r[15]=0,r}},{}],216:[function(r,n,i){n.exports=function(r,n,i,a){var o=Math.tan(n.upDegrees*Math.PI/180),s=Math.tan(n.downDegrees*Math.PI/180),l=Math.tan(n.leftDegrees*Math.PI/180),c=Math.tan(n.rightDegrees*Math.PI/180),u=2/(l+c),f=2/(o+s);return r[0]=u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=f,r[6]=0,r[7]=0,r[8]=-(l-c)*u*.5,r[9]=(o-s)*f*.5,r[10]=a/(i-a),r[11]=-1,r[12]=0,r[13]=0,r[14]=a*i/(i-a),r[15]=0,r}},{}],217:[function(r,n,i){n.exports=function(r,n,i,a){var o,s,l,c,u,f,h,p,d,m,g,v,y,x,b,_,w,T,k,A,M,S,E,L,C=a[0],P=a[1],I=a[2],O=Math.sqrt(C*C+P*P+I*I);return 1e-6>Math.abs(O)?null:(C*=O=1/O,P*=O,I*=O,o=Math.sin(i),l=1-(s=Math.cos(i)),c=n[0],u=n[1],f=n[2],h=n[3],p=n[4],d=n[5],m=n[6],g=n[7],v=n[8],y=n[9],x=n[10],b=n[11],_=C*C*l+s,w=P*C*l+I*o,T=I*C*l-P*o,k=C*P*l-I*o,A=P*P*l+s,M=I*P*l+C*o,S=C*I*l+P*o,E=P*I*l-C*o,L=I*I*l+s,r[0]=c*_+p*w+v*T,r[1]=u*_+d*w+y*T,r[2]=f*_+m*w+x*T,r[3]=h*_+g*w+b*T,r[4]=c*k+p*A+v*M,r[5]=u*k+d*A+y*M,r[6]=f*k+m*A+x*M,r[7]=h*k+g*A+b*M,r[8]=c*S+p*E+v*L,r[9]=u*S+d*E+y*L,r[10]=f*S+m*E+x*L,r[11]=h*S+g*E+b*L,n!==r&&(r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r)}},{}],218:[function(r,n,i){n.exports=function(r,n,i){var a=Math.sin(i),o=Math.cos(i),s=n[4],l=n[5],c=n[6],u=n[7],f=n[8],h=n[9],p=n[10],d=n[11];return n!==r&&(r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[4]=s*o+f*a,r[5]=l*o+h*a,r[6]=c*o+p*a,r[7]=u*o+d*a,r[8]=f*o-s*a,r[9]=h*o-l*a,r[10]=p*o-c*a,r[11]=d*o-u*a,r}},{}],219:[function(r,n,i){n.exports=function(r,n,i){var a=Math.sin(i),o=Math.cos(i),s=n[0],l=n[1],c=n[2],u=n[3],f=n[8],h=n[9],p=n[10],d=n[11];return n!==r&&(r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=s*o-f*a,r[1]=l*o-h*a,r[2]=c*o-p*a,r[3]=u*o-d*a,r[8]=s*a+f*o,r[9]=l*a+h*o,r[10]=c*a+p*o,r[11]=u*a+d*o,r}},{}],220:[function(r,n,i){n.exports=function(r,n,i){var a=Math.sin(i),o=Math.cos(i),s=n[0],l=n[1],c=n[2],u=n[3],f=n[4],h=n[5],p=n[6],d=n[7];return n!==r&&(r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=s*o+f*a,r[1]=l*o+h*a,r[2]=c*o+p*a,r[3]=u*o+d*a,r[4]=f*o-s*a,r[5]=h*o-l*a,r[6]=p*o-c*a,r[7]=d*o-u*a,r}},{}],221:[function(r,n,i){n.exports=function(r,n,i){var a=i[0],o=i[1],s=i[2];return r[0]=n[0]*a,r[1]=n[1]*a,r[2]=n[2]*a,r[3]=n[3]*a,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[7]=n[7]*o,r[8]=n[8]*s,r[9]=n[9]*s,r[10]=n[10]*s,r[11]=n[11]*s,r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r}},{}],222:[function(r,n,i){n.exports=function(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}},{}],223:[function(r,n,i){n.exports=function(r,n,i){var a,o,s,l,c,u,f,h,p,d,m,g,v=i[0],y=i[1],x=i[2];return n===r?(r[12]=n[0]*v+n[4]*y+n[8]*x+n[12],r[13]=n[1]*v+n[5]*y+n[9]*x+n[13],r[14]=n[2]*v+n[6]*y+n[10]*x+n[14],r[15]=n[3]*v+n[7]*y+n[11]*x+n[15]):(a=n[0],o=n[1],s=n[2],l=n[3],c=n[4],u=n[5],f=n[6],h=n[7],p=n[8],d=n[9],m=n[10],g=n[11],r[0]=a,r[1]=o,r[2]=s,r[3]=l,r[4]=c,r[5]=u,r[6]=f,r[7]=h,r[8]=p,r[9]=d,r[10]=m,r[11]=g,r[12]=a*v+c*y+p*x+n[12],r[13]=o*v+u*y+d*x+n[13],r[14]=s*v+f*y+m*x+n[14],r[15]=l*v+h*y+g*x+n[15]),r}},{}],224:[function(r,n,i){n.exports=function(r,n){if(r===n){var i=n[1],a=n[2],o=n[3],s=n[6],l=n[7],c=n[11];r[1]=n[4],r[2]=n[8],r[3]=n[12],r[4]=i,r[6]=n[9],r[7]=n[13],r[8]=a,r[9]=s,r[11]=n[14],r[12]=o,r[13]=l,r[14]=c}else r[0]=n[0],r[1]=n[4],r[2]=n[8],r[3]=n[12],r[4]=n[1],r[5]=n[5],r[6]=n[9],r[7]=n[13],r[8]=n[2],r[9]=n[6],r[10]=n[10],r[11]=n[14],r[12]=n[3],r[13]=n[7],r[14]=n[11],r[15]=n[15];return r}},{}],225:[function(r,n,i){"use strict";var a=r("css-font"),o=r("pick-by-alias"),s=r("regl"),l=r("gl-util/context"),c=r("es6-weak-map"),u=r("color-normalize"),f=r("font-atlas"),h=r("typedarray-pool"),p=r("parse-rect"),d=r("is-plain-obj"),m=r("parse-unit"),g=r("to-px"),v=r("detect-kerning"),y=r("object-assign"),x=r("font-measure"),b=r("flatten-vertex-data"),_=r("bit-twiddle").nextPow2,w=new c,T=!1;if(document.body){var k=document.body.appendChild(document.createElement("div"));k.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(k).fontStretch&&(T=!0),document.body.removeChild(k)}var A=function(r){var n;"function"==typeof(n=r)&&n._gl&&n.prop&&n.texture&&n.buffer?(r={regl:r},this.gl=r.regl._gl):this.gl=l(r),this.shader=w.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=r.regl||s({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),w.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(d(r)?r:{})};A.prototype.createShader=function(){var r=this.regl,n=r({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:r.prop("count"),offset:r.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:r.this("sizeBuffer")},width:{offset:0,stride:8,buffer:r.this("sizeBuffer")},char:r.this("charBuffer"),position:r.this("position")},uniforms:{atlasSize:function(r,n){return[n.atlas.width,n.atlas.height]},atlasDim:function(r,n){return[n.atlas.cols,n.atlas.rows]},atlas:function(r,n){return n.atlas.texture},charStep:function(r,n){return n.atlas.step},em:function(r,n){return n.atlas.em},color:r.prop("color"),opacity:r.prop("opacity"),viewport:r.this("viewportArray"),scale:r.this("scale"),align:r.prop("align"),baseline:r.prop("baseline"),translate:r.this("translate"),positionOffset:r.prop("positionOffset")},primitive:"points",viewport:r.this("viewport"),vert:"\n			precision highp float;\n			attribute float width, charOffset, char;\n			attribute vec2 position;\n			uniform float fontSize, charStep, em, align, baseline;\n			uniform vec4 viewport;\n			uniform vec4 color;\n			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n			varying vec2 charCoord, charId;\n			varying float charWidth;\n			varying vec4 fontColor;\n			void main () {\n				vec2 offset = floor(em * (vec2(align + charOffset, baseline)\n					+ vec2(positionOffset.x, -positionOffset.y)))\n					/ (viewport.zw * scale.xy);\n\n				vec2 position = (position + translate) * scale;\n				position += offset * scale;\n\n				charCoord = position * viewport.zw + viewport.xy;\n\n				gl_Position = vec4(position * 2. - 1., 0, 1);\n\n				gl_PointSize = charStep;\n\n				charId.x = mod(char, atlasDim.x);\n				charId.y = floor(char / atlasDim.x);\n\n				charWidth = width * em;\n\n				fontColor = color / 255.;\n			}",frag:"\n			precision highp float;\n			uniform float fontSize, charStep, opacity;\n			uniform vec2 atlasSize;\n			uniform vec4 viewport;\n			uniform sampler2D atlas;\n			varying vec4 fontColor;\n			varying vec2 charCoord, charId;\n			varying float charWidth;\n\n			float lightness(vec4 color) {\n				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n			}\n\n			void main () {\n				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n				float halfCharStep = floor(charStep * .5 + .5);\n\n				// invert y and shift by 1px (FF expecially needs that)\n				uv.y = charStep - uv.y;\n\n				// ignore points outside of character bounding box\n				float halfCharWidth = ceil(charWidth * .5);\n				if (floor(uv.x) > halfCharStep + halfCharWidth ||\n					floor(uv.x) < halfCharStep - halfCharWidth) return;\n\n				uv += charId * charStep;\n				uv = uv / atlasSize;\n\n				vec4 color = fontColor;\n				vec4 mask = texture2D(atlas, uv);\n\n				float maskY = lightness(mask);\n				// float colorY = lightness(color);\n				color.a *= maskY;\n				color.a *= opacity;\n\n				// color.a += .1;\n\n				// antialiasing, see yiq color space y-channel formula\n				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n				gl_FragColor = color;\n			}"});return{regl:r,draw:n,atlas:{}}},A.prototype.update=function(r){var n,i=this;if("string"==typeof r)r={text:r};else if(!r)return;null!=(r=o(r,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity&&(Array.isArray(r.opacity)?this.opacity=r.opacity.map(function(r){return parseFloat(r)}):this.opacity=parseFloat(r.opacity)),null!=r.viewport&&(this.viewport=p(r.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=r.kerning&&(this.kerning=r.kerning),null!=r.offset&&("number"==typeof r.offset&&(r.offset=[r.offset,0]),this.positionOffset=b(r.offset)),r.direction&&(this.direction=r.direction),r.range&&(this.range=r.range,this.scale=[1/(r.range[2]-r.range[0]),1/(r.range[3]-r.range[1])],this.translate=[-r.range[0],-r.range[1]]),r.scale&&(this.scale=r.scale),r.translate&&(this.translate=r.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||r.font||(r.font=A.baseFontSize+"px sans-serif");var s,l=!1,c=!1;if(r.font&&(Array.isArray(r.font)?r.font:[r.font]).forEach(function(r,n){if("string"==typeof r)try{r=a.parse(r)}catch(n){r=a.parse(A.baseFontSize+"px "+r)}else r=a.parse(a.stringify(r));var o=a.stringify({size:A.baseFontSize,family:r.family,stretch:T?r.stretch:void 0,variant:r.variant,weight:r.weight,style:r.style}),s=m(r.size),u=Math.round(s[0]*g(s[1]));if(u!==i.fontSize[n]&&(c=!0,i.fontSize[n]=u),!(i.font[n]&&o==i.font[n].baseString||(l=!0,i.font[n]=A.fonts[o],i.font[n]))){var f=r.family.join(", "),h=[r.style];r.style!=r.variant&&h.push(r.variant),r.variant!=r.weight&&h.push(r.weight),T&&r.weight!=r.stretch&&h.push(r.stretch),i.font[n]={baseString:o,family:f,weight:r.weight,stretch:r.stretch,style:r.style,variant:r.variant,width:{},kerning:{},metrics:x(f,{origin:"top",fontSize:A.baseFontSize,fontStyle:h.join(" ")})},A.fonts[o]=i.font[n]}}),(l||c)&&this.font.forEach(function(n,o){var s=a.stringify({size:i.fontSize[o],family:n.family,stretch:T?n.stretch:void 0,variant:n.variant,weight:n.weight,style:n.style});if(i.fontAtlas[o]=i.shader.atlas[s],!i.fontAtlas[o]){var l=n.metrics;i.shader.atlas[s]=i.fontAtlas[o]={fontString:s,step:2*Math.ceil(i.fontSize[o]*l.bottom*.5),em:i.fontSize[o],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:i.regl.texture()}}null==r.text&&(r.text=i.text)}),"string"==typeof r.text&&r.position&&r.position.length>2){for(var d=Array(.5*r.position.length),w=0;w<d.length;w++)d[w]=r.text;r.text=d}if(null!=r.text||l){if(this.textOffsets=[0],Array.isArray(r.text)){this.count=r.text[0].length,this.counts=[this.count];for(var k=1;k<r.text.length;k++)this.textOffsets[k]=this.textOffsets[k-1]+r.text[k-1].length,this.count+=r.text[k].length,this.counts.push(r.text[k].length);this.text=r.text.join("")}else this.text=r.text,this.count=this.text.length,this.counts=[this.count];s=[],this.font.forEach(function(r,n){A.atlasContext.font=r.baseString;for(var a=i.fontAtlas[n],o=0;o<i.text.length;o++){var l=i.text.charAt(o);if(null==a.ids[l]&&(a.ids[l]=a.chars.length,a.chars.push(l),s.push(l)),null==r.width[l]&&(r.width[l]=A.atlasContext.measureText(l).width/A.baseFontSize,i.kerning)){var c=[];for(var u in r.width)c.push(u+l,l+u);y(r.kerning,v(r.family,{pairs:c}))}}})}if(r.position){if(r.position.length>2){for(var M=!r.position[0].length,S=h.mallocFloat(2*this.count),E=0,L=0;E<this.counts.length;E++){var C=this.counts[E];if(M)for(var P=0;P<C;P++)S[L++]=r.position[2*E],S[L++]=r.position[2*E+1];else for(var I=0;I<C;I++)S[L++]=r.position[E][0],S[L++]=r.position[E][1]}this.position.call?this.position({type:"float",data:S}):this.position=this.regl.buffer({type:"float",data:S}),h.freeFloat(S)}else this.position.destroy&&this.position.destroy(),this.position={constant:r.position}}if(r.text||l){var O=h.mallocUint8(this.count),z=h.mallocFloat(2*this.count);this.textWidth=[];for(var D=0,R=0;D<this.counts.length;D++){for(var F=this.counts[D],B=this.font[D]||this.font[0],N=this.fontAtlas[D]||this.fontAtlas[0],j=0;j<F;j++){var U=this.text.charAt(R),V=this.text.charAt(R-1);if(O[R]=N.ids[U],z[2*R]=B.width[U],j){var H=z[2*R-2],q=z[2*R],G=z[2*R-1]+.5*H+.5*q;if(this.kerning){var Y=B.kerning[V+U];Y&&(G+=.001*Y)}z[2*R+1]=G}else z[2*R+1]=.5*z[2*R];R++}this.textWidth.push(z.length?.5*z[2*R-2]+z[2*R-1]:0)}r.align||(r.align=this.align),this.charBuffer({data:O,type:"uint8",usage:"stream"}),this.sizeBuffer({data:z,type:"float",usage:"stream"}),h.freeUint8(O),h.freeFloat(z),s.length&&this.font.forEach(function(r,n){var a=i.fontAtlas[n],o=a.step,s=Math.min(Math.floor(A.maxAtlasSize/o),a.chars.length),l=Math.ceil(a.chars.length/s),c=_(s*o),u=_(l*o);a.width=c,a.height=u,a.rows=l,a.cols=s,a.em&&a.texture({data:f({canvas:A.atlasCanvas,font:a.fontString,chars:a.chars,shape:[c,u],step:[o,o]})})})}if(r.align&&(this.align=r.align,this.alignOffset=this.textWidth.map(function(r,n){var a=Array.isArray(i.align)?i.align.length>1?i.align[n]:i.align[0]:i.align;if("number"==typeof a)return a;switch(a){case"right":case"end":return-r;case"center":case"centre":case"middle":return-(.5*r)}return 0})),null==this.baseline&&null==r.baseline&&(r.baseline=0),null!=r.baseline&&(this.baseline=r.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(r,n){var a=(i.font[n]||i.font[0]).metrics;return-((0+(.5*a.bottom+("number"==typeof r?r-a.baseline:-a[r])))*1)})),null!=r.color){if(r.color||(r.color="transparent"),"string"!=typeof r.color&&isNaN(r.color)){if("number"==typeof r.color[0]&&r.color.length>this.counts.length){var W=r.color.length;n=h.mallocUint8(W);for(var X=(r.color.subarray||r.color.slice).bind(r.color),Z=0;Z<W;Z+=4)n.set(u(X(Z,Z+4),"uint8"),Z)}else{var J=r.color.length;n=h.mallocUint8(4*J);for(var K=0;K<J;K++)n.set(u(r.color[K]||0,"uint8"),4*K)}this.color=n}else this.color=u(r.color,"uint8")}if(r.position||r.text||r.color||r.baseline||r.align||r.font||r.offset||r.opacity){if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var Q=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(Q);for(var $=0;$<this.batch.length;$++)this.batch[$]={count:this.counts.length>1?this.counts[$]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[$]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*$,4*$+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[$]:this.opacity,baseline:null!=this.baselineOffset[$]?this.baselineOffset[$]:this.baselineOffset[0],align:this.align?null!=this.alignOffset[$]?this.alignOffset[$]:this.alignOffset[0]:0,atlas:this.fontAtlas[$]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*$,2*$+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]}},A.prototype.destroy=function(){},A.prototype.kerning=!0,A.prototype.position={constant:new Float32Array(2)},A.prototype.translate=null,A.prototype.scale=null,A.prototype.font=null,A.prototype.text="",A.prototype.positionOffset=[0,0],A.prototype.opacity=1,A.prototype.color=new Uint8Array([0,0,0,255]),A.prototype.alignOffset=[0,0],A.maxAtlasSize=1024,A.atlasCanvas=document.createElement("canvas"),A.atlasContext=A.atlasCanvas.getContext("2d",{alpha:!1}),A.baseFontSize=64,A.fonts={},n.exports=A},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:283,"to-px":314,"typedarray-pool":327}],226:[function(r,n,a){(function(i){(function(){"use strict";var a=r("pick-by-alias");function o(r){if(r.container){if(r.container==document.body)document.body.style.width||(r.canvas.width=r.width||r.pixelRatio*i.innerWidth),document.body.style.height||(r.canvas.height=r.height||r.pixelRatio*i.innerHeight);else{var n=r.container.getBoundingClientRect();r.canvas.width=r.width||n.right-n.left,r.canvas.height=r.height||n.bottom-n.top}}}function s(r){return"function"==typeof r.getContext&&"width"in r&&"height"in r}function l(){var r=document.createElement("canvas");return r.style.position="absolute",r.style.top=0,r.style.left=0,r}n.exports=function(r){if(r?"string"==typeof r&&(r={container:r}):r={},(r=s(r)?{container:r}:"string"==typeof(n=r).nodeName&&"function"==typeof n.appendChild&&"function"==typeof n.getBoundingClientRect?{container:r}:"function"==typeof(c=r).drawArrays||"function"==typeof c.drawElements?{gl:r}:a(r,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0)).pixelRatio||(r.pixelRatio=i.pixelRatio||1),r.gl)return r.gl;if(r.canvas&&(r.container=r.canvas.parentNode),r.container){if("string"==typeof r.container){var n,c,u=document.querySelector(r.container);if(!u)throw Error("Element "+r.container+" is not found");r.container=u}s(r.container)?(r.canvas=r.container,r.container=r.canvas.parentNode):r.canvas||(r.canvas=l(),r.container.appendChild(r.canvas),o(r))}else if(!r.canvas){if("undefined"==typeof document)throw Error("Not DOM environment. Use headless-gl.");r.container=document.body||document.documentElement,r.canvas=l(),r.container.appendChild(r.canvas),o(r)}return r.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(n){try{r.gl=r.canvas.getContext(n,r.attrs)}catch(r){}return r.gl}),r.gl}}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"pick-by-alias":253}],227:[function(r,n,i){n.exports=function(r){"string"==typeof r&&(r=[r]);for(var n=[].slice.call(arguments,1),i=[],a=0;a<r.length-1;a++)i.push(r[a],n[a]||"");return i.push(r[a]),i.join("")}},{}],228:[function(r,n,a){(function(i){(function(){"use strict";var a,o=r("is-browser");a="function"==typeof i.matchMedia?!i.matchMedia("(hover: none)").matches:o,n.exports=a}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"is-browser":232}],229:[function(r,n,i){"use strict";var a=r("is-browser");n.exports=a&&function(){var r=!1;try{var n=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("test",null,n),window.removeEventListener("test",null,n)}catch(n){r=!1}return r}()},{"is-browser":232}],230:[function(r,n,i){i.read=function(r,n,i,a,o){var s,l,c=8*o-a-1,u=(1<<c)-1,f=u>>1,h=-7,p=i?o-1:0,d=i?-1:1,m=r[n+p];for(p+=d,s=m&(1<<-h)-1,m>>=-h,h+=c;h>0;s=256*s+r[n+p],p+=d,h-=8);for(l=s&(1<<-h)-1,s>>=-h,h+=a;h>0;l=256*l+r[n+p],p+=d,h-=8);if(0===s)s=1-f;else{if(s===u)return l?NaN:1/0*(m?-1:1);l+=Math.pow(2,a),s-=f}return(m?-1:1)*l*Math.pow(2,s-a)},i.write=function(r,n,i,a,o,s){var l,c,u,f=8*s-o-1,h=(1<<f)-1,p=h>>1,d=23===o?5960464477539062e-23:0,m=a?0:s-1,g=a?1:-1,v=n<0||0===n&&1/n<0?1:0;for(isNaN(n=Math.abs(n))||n===1/0?(c=isNaN(n)?1:0,l=h):(l=Math.floor(Math.log(n)/Math.LN2),n*(u=Math.pow(2,-l))<1&&(l--,u*=2),(n+=l+p>=1?d/u:d*Math.pow(2,1-p))*u>=2&&(l++,u/=2),l+p>=h?(c=0,l=h):l+p>=1?(c=(n*u-1)*Math.pow(2,o),l+=p):(c=n*Math.pow(2,p-1)*Math.pow(2,o),l=0));o>=8;r[i+m]=255&c,m+=g,c/=256,o-=8);for(l=l<<o|c,f+=o;f>0;r[i+m]=255&l,m+=g,l/=256,f-=8);r[i+m-g]|=128*v}},{}],231:[function(r,n,i){"function"==typeof Object.create?n.exports=function(r,n){n&&(r.super_=n,r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(r,n){if(n){r.super_=n;var i=function(){};i.prototype=n.prototype,r.prototype=new i,r.prototype.constructor=r}}},{}],232:[function(r,n,i){n.exports=!0},{}],233:[function(r,n,i){"use strict";n.exports="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(r,n,i){"use strict";n.exports=s,n.exports.isMobile=s,n.exports.default=s;var a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function s(r){r||(r={});var n=r.ua;if(n||"undefined"==typeof navigator||(n=navigator.userAgent),n&&n.headers&&"string"==typeof n.headers["user-agent"]&&(n=n.headers["user-agent"]),"string"!=typeof n)return!1;var i=r.tablet?o.test(n):a.test(n);return!i&&r.tablet&&r.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==n.indexOf("Macintosh")&&-1!==n.indexOf("Safari")&&(i=!0),i}},{}],235:[function(r,n,i){"use strict";n.exports=function(r){var n=typeof r;return null!==r&&("object"===n||"function"===n)}},{}],236:[function(r,n,i){"use strict";var a=Object.prototype.toString;n.exports=function(r){var n;return"[object Object]"===a.call(r)&&(null===(n=Object.getPrototypeOf(r))||n===Object.getPrototypeOf({}))}},{}],237:[function(r,n,i){"use strict";n.exports=function(r){for(var n,i=r.length,a=0;a<i;a++)if(((n=r.charCodeAt(a))<9||n>13)&&32!==n&&133!==n&&160!==n&&5760!==n&&6158!==n&&(n<8192||n>8205)&&8232!==n&&8233!==n&&8239!==n&&8287!==n&&8288!==n&&12288!==n&&65279!==n)return!1;return!0}},{}],238:[function(r,n,i){"use strict";n.exports=function(r){return"string"==typeof r&&(r=r.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(r)&&/[\dz]$/i.test(r)&&r.length>4))}},{}],239:[function(r,n,i){var a,o;a=this,o=function(){"use strict";var r,n,i;function a(a,o){if(r){if(n){var s="var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk);",l={};r(l),(i=o(l)).workerUrl=window.URL.createObjectURL(new Blob([s],{type:"text/javascript"}))}else n=o}else r=o}return a(0,function(r){function n(r,n){return r(n={exports:{}},n.exports),n.exports}function i(r,n,i,a){this.cx=3*r,this.bx=3*(i-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(a-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=a,this.p2x=i,this.p2y=a}function a(r,n){this.x=r,this.y=n}function o(r,n,a,o){var s=new i(r,n,a,o);return function(r){return s.solve(r)}}i.prototype.sampleCurveX=function(r){return((this.ax*r+this.bx)*r+this.cx)*r},i.prototype.sampleCurveY=function(r){return((this.ay*r+this.by)*r+this.cy)*r},i.prototype.sampleCurveDerivativeX=function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},i.prototype.solveCurveX=function(r,n){var i,a,o,s,l;for(void 0===n&&(n=1e-6),o=r,l=0;l<8;l++){if(Math.abs(s=this.sampleCurveX(o)-r)<n)return o;var c=this.sampleCurveDerivativeX(o);if(1e-6>Math.abs(c))break;o-=s/c}if((o=r)<(i=0))return i;if(o>(a=1))return a;for(;i<a&&!(Math.abs((s=this.sampleCurveX(o))-r)<n);)r>s?i=o:a=o,o=.5*(a-i)+i;return o},i.prototype.solve=function(r,n){return this.sampleCurveY(this.solveCurveX(r,n))},a.prototype={clone:function(){return new a(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,n){return this.clone()._rotateAround(r,n)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var n=r.x-this.x,i=r.y-this.y;return n*n+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,n){return Math.atan2(this.x*n-this.y*r,this.x*r+this.y*n)},_matMult:function(r){var n=r[0]*this.x+r[1]*this.y,i=r[2]*this.x+r[3]*this.y;return this.x=n,this.y=i,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var n=Math.cos(r),i=Math.sin(r),a=n*this.x-i*this.y,o=i*this.x+n*this.y;return this.x=a,this.y=o,this},_rotateAround:function(r,n){var i=Math.cos(r),a=Math.sin(r),o=n.x+i*(this.x-n.x)-a*(this.y-n.y),s=n.y+a*(this.x-n.x)+i*(this.y-n.y);return this.x=o,this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(r){return r instanceof a?r:Array.isArray(r)?new a(r[0],r[1]):r};var s,l,c,u=o(.25,.1,.25,1);function f(r,n,i){return Math.min(i,Math.max(n,r))}function h(r,n,i){var a=i-n,o=((r-n)%a+a)%a+n;return o===n?i:o}function p(r){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];for(var a=0;a<n.length;a+=1){var o=n[a];for(var s in o)r[s]=o[s]}return r}var d=1;function m(){return d++}function g(){return function r(n){return n?(n^16*Math.random()>>n/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function v(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function y(r,n){r.forEach(function(r){n[r]&&(n[r]=n[r].bind(n))})}function x(r,n){return -1!==r.indexOf(n,r.length-n.length)}function b(r,n,i){var a={};for(var o in r)a[o]=n.call(i||this,r[o],o,r);return a}function _(r,n,i){var a={};for(var o in r)n.call(i||this,r[o],o,r)&&(a[o]=r[o]);return a}function w(r){return Array.isArray(r)?r.map(w):"object"==typeof r&&r?b(r,w):r}var T={};function k(r){T[r]||("undefined"!=typeof console&&console.warn(r),T[r]=!0)}function A(r,n,i){return(i.y-r.y)*(n.x-r.x)>(n.y-r.y)*(i.x-r.x)}function M(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function S(r){var n={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(r,i,a,o){var s=a||o;return n[i]=!s||s.toLowerCase(),""}),n["max-age"]){var i=parseInt(n["max-age"],10);isNaN(i)?delete n["max-age"]:n["max-age"]=i}return n}var E=null;function L(r){if(null==E){var n=r.navigator?r.navigator.userAgent:null;E=!!r.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return E}function C(r){try{var n=self[r];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var P,I,O,z,D=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),R=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,F=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,B={now:D,frame:function(r){var n=R(r);return{cancel:function(){return F(n)}}},getImageData:function(r,n){void 0===n&&(n=0);var i=self.document.createElement("canvas"),a=i.getContext("2d");if(!a)throw Error("failed to create canvas 2d context");return i.width=r.width,i.height=r.height,a.drawImage(r,0,0,r.width,r.height),a.getImageData(-n,-n,r.width+2*n,r.height+2*n)},resolveURL:function(r){return P||(P=self.document.createElement("a")),P.href=r,P.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==I&&(I=self.matchMedia("(prefers-reduced-motion: reduce)")),I.matches)}},N={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},j={supported:!1,testSupport:function(r){!U&&z&&(V?H(r):O=r)}},U=!1,V=!1;function H(r){var n=r.createTexture();r.bindTexture(r.TEXTURE_2D,n);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,z),r.isContextLost())return;j.supported=!0}catch(r){}r.deleteTexture(n),U=!0}self.document&&((z=self.document.createElement("img")).onload=function(){O&&H(O),O=null,V=!0},z.onerror=function(){U=!0,O=null},z.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var q=function(r,n){this._transformRequestFn=r,this._customAccessToken=n,this._createSkuToken()};function G(r){return 0===r.indexOf("mapbox:")}q.prototype._createSkuToken=function(){var r=function(){for(var r="",n=0;n<10;n++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1","01",r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt},q.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},q.prototype.transformRequest=function(r,n){return this._transformRequestFn&&this._transformRequestFn(r,n)||{url:r}},q.prototype.normalizeStyleURL=function(r,n){if(!G(r))return r;var i=Z(r);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||n)},q.prototype.normalizeGlyphsURL=function(r,n){if(!G(r))return r;var i=Z(r);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||n)},q.prototype.normalizeSourceURL=function(r,n){if(!G(r))return r;var i=Z(r);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||n)},q.prototype.normalizeSpriteURL=function(r,n,i,a){var o=Z(r);return G(r)?(o.path="/styles/v1"+o.path+"/sprite"+n+i,this._makeAPIURL(o,this._customAccessToken||a)):(o.path+=""+n+i,J(o))},q.prototype.normalizeTileURL=function(r,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!G(r))return r;var i=Z(r),a=B.devicePixelRatio>=2||512===n?"@2x":"",o=j.supported?".webp":"$1";i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+a+o),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var s=this._customAccessToken||function(r){for(var n=0;n<r.length;n+=1){var i=r[n].match(/^access_token=(.*)$/);if(i)return i[1]}return null}(i.params)||N.ACCESS_TOKEN;return N.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,s)},q.prototype.canonicalizeTileURL=function(r,n){var i=Z(r);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return r;var a="mapbox://tiles/";a+=i.path.replace("/v4/","");var o=i.params;return n&&(o=o.filter(function(r){return!r.match(/^access_token=/)})),o.length&&(a+="?"+o.join("&")),a},q.prototype.canonicalizeTileset=function(r,n){for(var i=!!n&&G(n),a=[],o=0,s=r.tiles||[];o<s.length;o+=1){var l=s[o];W(l)?a.push(this.canonicalizeTileURL(l,i)):a.push(l)}return a},q.prototype._makeAPIURL=function(r,n){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",a=Z(N.API_URL);if(r.protocol=a.protocol,r.authority=a.authority,"/"!==a.path&&(r.path=""+a.path+r.path),!N.REQUIRE_ACCESS_TOKEN)return J(r);if(!(n=n||N.ACCESS_TOKEN))throw Error("An API access token is required to use Mapbox GL. "+i);if("s"===n[0])throw Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return r.params=r.params.filter(function(r){return -1===r.indexOf("access_token")}),r.params.push("access_token="+n),J(r)};var Y=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function W(r){return Y.test(r)}var X=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Z(r){var n=r.match(X);if(!n)throw Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function J(r){var n=r.params.length?"?"+r.params.join("&"):"";return r.protocol+"://"+r.authority+r.path+n}function K(r){if(!r)return null;var n,i=r.split(".");if(!i||3!==i.length)return null;try{return JSON.parse((n=i[1],decodeURIComponent(self.atob(n).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(r){return null}}var Q=function(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Q.prototype.getStorageKey=function(r){var n,i=K(N.ACCESS_TOKEN),a="";return i&&i.u?(n=i.u,a=self.btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,function(r,n){return String.fromCharCode(Number("0x"+n))}))):a=N.ACCESS_TOKEN||"",r?"mapbox.eventData."+r+":"+a:"mapbox.eventData:"+a},Q.prototype.fetchEventData=function(){var r=C("localStorage"),n=this.getStorageKey(),i=this.getStorageKey("uuid");if(r)try{var a=self.localStorage.getItem(n);a&&(this.eventData=JSON.parse(a));var o=self.localStorage.getItem(i);o&&(this.anonId=o)}catch(r){k("Unable to read from LocalStorage")}},Q.prototype.saveEventData=function(){var r=C("localStorage"),n=this.getStorageKey(),i=this.getStorageKey("uuid");if(r)try{self.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(n,JSON.stringify(this.eventData))}catch(r){k("Unable to write to LocalStorage")}},Q.prototype.processRequests=function(r){},Q.prototype.postEvent=function(r,n,i,a){var o=this;if(N.EVENTS_URL){var s=Z(N.EVENTS_URL);s.params.push("access_token="+(a||N.ACCESS_TOKEN||""));var l={event:this.type,created:new Date(r).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:"01",userId:this.anonId},c=n?p(l,n):l,u={url:J(s),headers:{"Content-Type":"text/plain"},body:JSON.stringify([c])};this.pendingRequest=ty(u,function(r){o.pendingRequest=null,i(r),o.saveEventData(),o.processRequests(a)})}},Q.prototype.queueRequest=function(r,n){this.queue.push(r),this.processRequests(n)};var $,tt,te=function(r){function n(){r.call(this,"map.load"),this.success={},this.skuToken=""}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.postMapLoadEvent=function(r,n,i,a){this.skuToken=i,(N.EVENTS_URL&&a||N.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(r){return G(r)||W(r)}))&&this.queueRequest({id:n,timestamp:Date.now()},a)},n.prototype.processRequests=function(r){var n=this;if(!this.pendingRequest&&0!==this.queue.length){var i=this.queue.shift(),a=i.id,o=i.timestamp;a&&this.success[a]||(this.anonId||this.fetchEventData(),v(this.anonId)||(this.anonId=g()),this.postEvent(o,{skuToken:this.skuToken},function(r){r||a&&(n.success[a]=!0)},r))}},n}(Q),tr=new(function(r){function n(n){r.call(this,"appUserTurnstile"),this._customAccessToken=n}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.postTurnstileEvent=function(r,n){N.EVENTS_URL&&N.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(r){return G(r)||W(r)})&&this.queueRequest(Date.now(),n)},n.prototype.processRequests=function(r){var n=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var i=K(N.ACCESS_TOKEN),a=i?i.u:N.ACCESS_TOKEN,o=a!==this.eventData.tokenU;v(this.anonId)||(this.anonId=g(),o=!0);var s=this.queue.shift();if(this.eventData.lastSuccess){var l=new Date(this.eventData.lastSuccess),c=new Date(s),u=(s-this.eventData.lastSuccess)/864e5;o=o||u>=1||u<-1||l.getDate()!==c.getDate()}else o=!0;if(!o)return this.processRequests();this.postEvent(s,{"enabled.telemetry":!1},function(r){r||(n.eventData.lastSuccess=s,n.eventData.tokenU=a)},r)}},n}(Q)),tn=tr.postTurnstileEvent.bind(tr),ti=new te,ta=ti.postMapLoadEvent.bind(ti),to=500,ts=50;function tl(){self.caches&&!$&&($=self.caches.open("mapbox-tiles"))}function tc(r){var n=r.indexOf("?");return n<0?r:r.slice(0,n)}var tu,tf=1/0;function th(){return null==tu&&(tu=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),tu}var tp={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(tp);var td=function(r){function n(n,i,a){401===i&&W(a)&&(n+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),r.call(this,n),this.status=i,this.url=a,this.name=this.constructor.name,this.message=n}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},n}(Error),tm=M()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href},tg=function(r,n){var i,a,o,s,l,c,u,f,h;if(i=r.url,!(/^file:/.test(i)||/^file:/.test(tm())&&!/^\w+:/.test(i))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return o=new self.AbortController,s=new self.Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,referrer:tm(),signal:o.signal}),l=!1,c=!1,u=(a=s.url).indexOf("sku=")>0&&W(a),"json"===r.type&&s.headers.set("Accept","application/json"),f=function(i,a,o){if(!c){if(i&&"SecurityError"!==i.message&&k(i),a&&o)return h(a);var l=Date.now();self.fetch(s).then(function(i){if(i.ok){var a=u?i.clone():null;return h(i,a,l)}return n(new td(i.statusText,i.status,r.url))}).catch(function(r){20!==r.code&&n(Error(r.message))})}},h=function(i,a,o){("arrayBuffer"===r.type?i.arrayBuffer():"json"===r.type?i.json():i.text()).then(function(r){c||(a&&o&&function(r,n,i){if(tl(),$){var a={status:n.status,statusText:n.statusText,headers:new self.Headers};n.headers.forEach(function(r,n){return a.headers.set(n,r)});var o=S(n.headers.get("Cache-Control")||"");!o["no-store"]&&(o["max-age"]&&a.headers.set("Expires",new Date(i+1e3*o["max-age"]).toUTCString()),new Date(a.headers.get("Expires")).getTime()-i<42e4||function(r,n){if(void 0===tt)try{new Response(new ReadableStream),tt=!0}catch(r){tt=!1}tt?n(r.body):r.blob().then(n)}(n,function(n){var i=new self.Response(n,a);tl(),$&&$.then(function(n){return n.put(tc(r.url),i)}).catch(function(r){return k(r.message)})}))}}(s,a,o),l=!0,n(null,r,i.headers.get("Cache-Control"),i.headers.get("Expires")))}).catch(function(r){c||n(Error(r.message))})},u?function(r,n){if(tl(),!$)return n(null);var i=tc(r.url);$.then(function(r){r.match(i).then(function(a){var o=function(r){if(!r)return!1;var n=new Date(r.headers.get("Expires")||0),i=S(r.headers.get("Cache-Control")||"");return n>Date.now()&&!i["no-cache"]}(a);r.delete(i),o&&r.put(i,a.clone()),n(null,a,o)}).catch(n)}).catch(n)}(s,f):f(null,null),{cancel:function(){c=!0,l||o.abort()}};if(M()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,n,void 0,!0)}return function(r,n){var i=new self.XMLHttpRequest;for(var a in i.open(r.method||"GET",r.url,!0),"arrayBuffer"===r.type&&(i.responseType="arraybuffer"),r.headers)i.setRequestHeader(a,r.headers[a]);return"json"===r.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===r.credentials,i.onerror=function(){n(Error(i.statusText))},i.onload=function(){if((i.status>=200&&i.status<300||0===i.status)&&null!==i.response){var a=i.response;if("json"===r.type)try{a=JSON.parse(i.response)}catch(r){return n(r)}n(null,a,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else n(new td(i.statusText,i.status,r.url))},i.send(r.body),{cancel:function(){return i.abort()}}}(r,n)},tv=function(r,n){return tg(p(r,{type:"arrayBuffer"}),n)},ty=function(r,n){return tg(p(r,{method:"POST"}),n)};iR=[],iF=0;var tx=function(r,n){if(j.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),iF>=N.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:r,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return iR.push(i),i}iF++;var a=!1,o=function(){if(!a)for(a=!0,iF--;iR.length&&iF<N.MAX_PARALLEL_IMAGE_REQUESTS;){var r=iR.shift(),n=r.requestParameters,i=r.callback;r.cancelled||(r.cancel=tx(n,i).cancel)}},s=tv(r,function(r,i,a,s){var l,c,u;o(),r?n(r):i&&(th()?function(r,n){var i=new self.Blob([new Uint8Array(r)],{type:"image/png"});self.createImageBitmap(i).then(function(r){n(null,r)}).catch(function(r){n(Error("Could not load image because of "+r.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(i,n):(l=new self.Image,c=self.URL,l.onload=function(){n(null,l),c.revokeObjectURL(l.src)},l.onerror=function(){return n(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},u=new self.Blob([new Uint8Array(i)],{type:"image/png"}),l.cacheControl=a,l.expires=s,l.src=i.byteLength?c.createObjectURL(u):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="))});return{cancel:function(){s.cancel(),o()}}};function tb(r,n,i){i[r]&&-1!==i[r].indexOf(n)||(i[r]=i[r]||[],i[r].push(n))}function t_(r,n,i){if(i&&i[r]){var a=i[r].indexOf(n);-1!==a&&i[r].splice(a,1)}}var tw=function(r,n){void 0===n&&(n={}),p(this,n),this.type=r},tT=function(r){function n(n,i){void 0===i&&(i={}),r.call(this,"error",p({error:n},i))}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(tw),tk=function(){};tk.prototype.on=function(r,n){return this._listeners=this._listeners||{},tb(r,n,this._listeners),this},tk.prototype.off=function(r,n){return t_(r,n,this._listeners),t_(r,n,this._oneTimeListeners),this},tk.prototype.once=function(r,n){return this._oneTimeListeners=this._oneTimeListeners||{},tb(r,n,this._oneTimeListeners),this},tk.prototype.fire=function(r,n){"string"==typeof r&&(r=new tw(r,n||{}));var i=r.type;if(this.listens(i)){r.target=this;for(var a=0,o=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];a<o.length;a+=1)o[a].call(this,r);for(var s=0,l=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];s<l.length;s+=1){var c=l[s];t_(i,c,this._oneTimeListeners),c.call(this,r)}var u=this._eventedParent;u&&(p(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),u.fire(r))}else r instanceof tT&&console.error(r.error);return this},tk.prototype.listens=function(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)},tk.prototype.setEventedParent=function(r,n){return this._eventedParent=r,this._eventedParentData=n,this};var tA={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},tM=function(r,n,i,a){this.message=(r?r+": ":"")+i,a&&(this.identifier=a),null!=n&&n.__line__&&(this.line=n.__line__)};function tS(r){var n=r.key,i=r.value;return i?[new tM(n,i,"constants have been deprecated as of v8")]:[]}function tE(r){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];for(var a=0;a<n.length;a+=1){var o=n[a];for(var s in o)r[s]=o[s]}return r}function tL(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function tC(r){if(Array.isArray(r))return r.map(tC);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){var n={};for(var i in r)n[i]=tC(r[i]);return n}return tL(r)}var tP=function(r){function n(n,i){r.call(this,i),this.message=i,this.key=n}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(Error),tI=function(r,n){void 0===n&&(n=[]),this.parent=r,this.bindings={};for(var i=0,a=n;i<a.length;i+=1){var o=a[i],s=o[0],l=o[1];this.bindings[s]=l}};tI.prototype.concat=function(r){return new tI(this,r)},tI.prototype.get=function(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw Error(r+" not found in scope.")},tI.prototype.has=function(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)};var tO={kind:"null"},tz={kind:"number"},tD={kind:"string"},tR={kind:"boolean"},tF={kind:"color"},tB={kind:"object"},tN={kind:"value"},tj={kind:"collator"},tU={kind:"formatted"},tV={kind:"resolvedImage"};function tH(r,n){return{kind:"array",itemType:r,N:n}}function tq(r){if("array"===r.kind){var n=tq(r.itemType);return"number"==typeof r.N?"array<"+n+", "+r.N+">":"value"===r.itemType.kind?"array":"array<"+n+">"}return r.kind}var tG=[tO,tz,tD,tR,tF,tU,tB,tH(tN),tV];function tY(r,n){if("error"===n.kind)return null;if("array"===r.kind){if("array"===n.kind&&(0===n.N&&"value"===n.itemType.kind||!tY(r.itemType,n.itemType))&&("number"!=typeof r.N||r.N===n.N))return null}else{if(r.kind===n.kind)return null;if("value"===r.kind){for(var i=0;i<tG.length;i+=1)if(!tY(tG[i],n))return null}}return"Expected "+tq(r)+" but found "+tq(n)+" instead."}function tW(r,n){return n.some(function(n){return n.kind===r.kind})}function tX(r,n){return n.some(function(n){return"null"===n?null===r:"array"===n?Array.isArray(r):"object"===n?r&&!Array.isArray(r)&&"object"==typeof r:n===typeof r})}var tZ=n(function(r,n){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function a(r){return(r=Math.round(r))<0?0:r>255?255:r}function o(r){return r<0?0:r>1?1:r}function s(r){return"%"===r[r.length-1]?a(parseFloat(r)/100*255):a(parseInt(r))}function l(r){return"%"===r[r.length-1]?o(parseFloat(r)/100):o(parseFloat(r))}function c(r,n,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?r+(n-r)*i*6:2*i<1?n:3*i<2?r+(n-r)*(2/3-i)*6:r}try{n.parseCSSColor=function(r){var n,o=r.replace(/ /g,"").toLowerCase();if(o in i)return i[o].slice();if("#"===o[0])return 4===o.length?(n=parseInt(o.substr(1),16))>=0&&n<=4095?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:7===o.length&&(n=parseInt(o.substr(1),16))>=0&&n<=16777215?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var u=o.indexOf("("),f=o.indexOf(")");if(-1!==u&&f+1===o.length){var h=o.substr(0,u),p=o.substr(u+1,f-(u+1)).split(","),d=1;switch(h){case"rgba":if(4!==p.length)break;d=l(p.pop());case"rgb":return 3!==p.length?null:[s(p[0]),s(p[1]),s(p[2]),d];case"hsla":if(4!==p.length)break;d=l(p.pop());case"hsl":if(3!==p.length)break;var m=(parseFloat(p[0])%360+360)%360/360,g=l(p[1]),v=l(p[2]),y=v<=.5?v*(g+1):v+g-v*g,x=2*v-y;return[a(255*c(x,y,m+1/3)),a(255*c(x,y,m)),a(255*c(x,y,m-1/3)),d]}}return null}}catch(r){}}).parseCSSColor,tJ=function(r,n,i,a){void 0===a&&(a=1),this.r=r,this.g=n,this.b=i,this.a=a};tJ.parse=function(r){if(r){if(r instanceof tJ)return r;if("string"==typeof r){var n=tZ(r);if(n)return new tJ(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3])}}},tJ.prototype.toString=function(){var r=this.toArray();return"rgba("+Math.round(r[0])+","+Math.round(r[1])+","+Math.round(r[2])+","+r[3]+")"},tJ.prototype.toArray=function(){var r=this.r,n=this.g,i=this.b,a=this.a;return 0===a?[0,0,0,0]:[255*r/a,255*n/a,255*i/a,a]},tJ.black=new tJ(0,0,0,1),tJ.white=new tJ(1,1,1,1),tJ.transparent=new tJ(0,0,0,0),tJ.red=new tJ(1,0,0,1);var tK=function(r,n,i){this.sensitivity=r?n?"variant":"case":n?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};tK.prototype.compare=function(r,n){return this.collator.compare(r,n)},tK.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var tQ=function(r,n,i,a,o){this.text=r,this.image=n,this.scale=i,this.fontStack=a,this.textColor=o},t$=function(r){this.sections=r};t$.fromString=function(r){return new t$([new tQ(r,null,null,null,null)])},t$.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(r){return 0!==r.text.length||r.image&&0!==r.image.name.length})},t$.factory=function(r){return r instanceof t$?r:t$.fromString(r)},t$.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(r){return r.text}).join("")},t$.prototype.serialize=function(){for(var r=["format"],n=0,i=this.sections;n<i.length;n+=1){var a=i[n];if(a.image)r.push(["image",a.image.name]);else{r.push(a.text);var o={};a.fontStack&&(o["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(o["font-scale"]=a.scale),a.textColor&&(o["text-color"]=["rgba"].concat(a.textColor.toArray())),r.push(o)}}return r};var t0=function(r){this.name=r.name,this.available=r.available};function t1(r,n,i,a){return"number"==typeof r&&r>=0&&r<=255&&"number"==typeof n&&n>=0&&n<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===a||"number"==typeof a&&a>=0&&a<=1?null:"Invalid rgba value ["+[r,n,i,a].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof a?[r,n,i,a]:[r,n,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function t2(r){if(null===r||"string"==typeof r||"boolean"==typeof r||"number"==typeof r||r instanceof tJ||r instanceof tK||r instanceof t$||r instanceof t0)return!0;if(Array.isArray(r)){for(var n=0;n<r.length;n+=1)if(!t2(r[n]))return!1;return!0}if("object"==typeof r){for(var i in r)if(!t2(r[i]))return!1;return!0}return!1}function t3(r){if(null===r)return tO;if("string"==typeof r)return tD;if("boolean"==typeof r)return tR;if("number"==typeof r)return tz;if(r instanceof tJ)return tF;if(r instanceof tK)return tj;if(r instanceof t$)return tU;if(r instanceof t0)return tV;if(Array.isArray(r)){for(var n,i=r.length,a=0;a<r.length;a+=1){var o=t3(r[a]);if(n){if(n===o)continue;n=tN;break}n=o}return tH(n||tN,i)}return tB}function t5(r){var n=typeof r;return null===r?"":"string"===n||"number"===n||"boolean"===n?String(r):r instanceof tJ||r instanceof t$||r instanceof t0?r.toString():JSON.stringify(r)}t0.prototype.toString=function(){return this.name},t0.fromString=function(r){return r?new t0({name:r,available:!1}):null},t0.prototype.serialize=function(){return["image",this.name]};var t4=function(r,n){this.type=r,this.value=n};t4.parse=function(r,n){if(2!==r.length)return n.error("'literal' expression requires exactly one argument, but found "+(r.length-1)+" instead.");if(!t2(r[1]))return n.error("invalid value");var i=r[1],a=t3(i),o=n.expectedType;return"array"===a.kind&&0===a.N&&o&&"array"===o.kind&&("number"!=typeof o.N||0===o.N)&&(a=o),new t4(a,i)},t4.prototype.evaluate=function(){return this.value},t4.prototype.eachChild=function(){},t4.prototype.outputDefined=function(){return!0},t4.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof tJ?["rgba"].concat(this.value.toArray()):this.value instanceof t$?this.value.serialize():this.value};var t6=function(r){this.name="ExpressionEvaluationError",this.message=r};t6.prototype.toJSON=function(){return this.message};var t8={string:tD,number:tz,boolean:tR,object:tB},t9=function(r,n){this.type=r,this.args=n};t9.parse=function(r,n){if(r.length<2)return n.error("Expected at least one argument.");var i,a,o,s=1,l=r[0];if("array"===l){if(r.length>2){var c=r[1];if("string"!=typeof c||!(c in t8)||"object"===c)return n.error('The item type argument of "array" must be one of string, number, boolean',1);i=t8[c],s++}else i=tN;if(r.length>3){if(null!==r[2]&&("number"!=typeof r[2]||r[2]<0||r[2]!==Math.floor(r[2])))return n.error('The length argument to "array" must be a positive integer literal',2);a=r[2],s++}o=tH(i,a)}else o=t8[l];for(var u=[];s<r.length;s++){var f=n.parse(r[s],s,tN);if(!f)return null;u.push(f)}return new t9(o,u)},t9.prototype.evaluate=function(r){for(var n=0;n<this.args.length;n++){var i=this.args[n].evaluate(r);if(!tY(this.type,t3(i)))return i;if(n===this.args.length-1)throw new t6("Expected value to be of type "+tq(this.type)+", but found "+tq(t3(i))+" instead.")}return null},t9.prototype.eachChild=function(r){this.args.forEach(r)},t9.prototype.outputDefined=function(){return this.args.every(function(r){return r.outputDefined()})},t9.prototype.serialize=function(){var r=this.type,n=[r.kind];if("array"===r.kind){var i=r.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){n.push(i.kind);var a=r.N;("number"==typeof a||this.args.length>1)&&n.push(a)}}return n.concat(this.args.map(function(r){return r.serialize()}))};var t7=function(r){this.type=tU,this.sections=r};t7.parse=function(r,n){if(r.length<2)return n.error("Expected at least one argument.");var i=r[1];if(!Array.isArray(i)&&"object"==typeof i)return n.error("First argument must be an image or text section.");for(var a=[],o=!1,s=1;s<=r.length-1;++s){var l=r[s];if(o&&"object"==typeof l&&!Array.isArray(l)){o=!1;var c=null;if(l["font-scale"]&&!(c=n.parse(l["font-scale"],1,tz)))return null;var u=null;if(l["text-font"]&&!(u=n.parse(l["text-font"],1,tH(tD))))return null;var f=null;if(l["text-color"]&&!(f=n.parse(l["text-color"],1,tF)))return null;var h=a[a.length-1];h.scale=c,h.font=u,h.textColor=f}else{var p=n.parse(r[s],1,tN);if(!p)return null;var d=p.type.kind;if("string"!==d&&"value"!==d&&"null"!==d&&"resolvedImage"!==d)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,a.push({content:p,scale:null,font:null,textColor:null})}}return new t7(a)},t7.prototype.evaluate=function(r){return new t$(this.sections.map(function(n){var i=n.content.evaluate(r);return t3(i)===tV?new tQ("",i,null,null,null):new tQ(t5(i),null,n.scale?n.scale.evaluate(r):null,n.font?n.font.evaluate(r).join(","):null,n.textColor?n.textColor.evaluate(r):null)}))},t7.prototype.eachChild=function(r){for(var n=0,i=this.sections;n<i.length;n+=1){var a=i[n];r(a.content),a.scale&&r(a.scale),a.font&&r(a.font),a.textColor&&r(a.textColor)}},t7.prototype.outputDefined=function(){return!1},t7.prototype.serialize=function(){for(var r=["format"],n=0,i=this.sections;n<i.length;n+=1){var a=i[n];r.push(a.content.serialize());var o={};a.scale&&(o["font-scale"]=a.scale.serialize()),a.font&&(o["text-font"]=a.font.serialize()),a.textColor&&(o["text-color"]=a.textColor.serialize()),r.push(o)}return r};var et=function(r){this.type=tV,this.input=r};et.parse=function(r,n){if(2!==r.length)return n.error("Expected two arguments.");var i=n.parse(r[1],1,tD);return i?new et(i):n.error("No image name provided.")},et.prototype.evaluate=function(r){var n=this.input.evaluate(r),i=t0.fromString(n);return i&&r.availableImages&&(i.available=r.availableImages.indexOf(n)>-1),i},et.prototype.eachChild=function(r){r(this.input)},et.prototype.outputDefined=function(){return!1},et.prototype.serialize=function(){return["image",this.input.serialize()]};var ee={"to-boolean":tR,"to-color":tF,"to-number":tz,"to-string":tD},er=function(r,n){this.type=r,this.args=n};er.parse=function(r,n){if(r.length<2)return n.error("Expected at least one argument.");var i=r[0];if(("to-boolean"===i||"to-string"===i)&&2!==r.length)return n.error("Expected one argument.");for(var a=ee[i],o=[],s=1;s<r.length;s++){var l=n.parse(r[s],s,tN);if(!l)return null;o.push(l)}return new er(a,o)},er.prototype.evaluate=function(r){if("boolean"===this.type.kind)return!!this.args[0].evaluate(r);if("color"===this.type.kind){for(var n,i,a=0,o=this.args;a<o.length;a+=1){if(i=null,(n=o[a].evaluate(r))instanceof tJ)return n;if("string"==typeof n){var s=r.parseColor(n);if(s)return s}else if(Array.isArray(n)&&!(i=n.length<3||n.length>4?"Invalid rbga value "+JSON.stringify(n)+": expected an array containing either three or four numeric values.":t1(n[0],n[1],n[2],n[3])))return new tJ(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new t6(i||"Could not parse color from value '"+("string"==typeof n?n:String(JSON.stringify(n)))+"'")}if("number"===this.type.kind){for(var l=null,c=0,u=this.args;c<u.length;c+=1){if(null===(l=u[c].evaluate(r)))return 0;var f=Number(l);if(!isNaN(f))return f}throw new t6("Could not convert "+JSON.stringify(l)+" to number.")}return"formatted"===this.type.kind?t$.fromString(t5(this.args[0].evaluate(r))):"resolvedImage"===this.type.kind?t0.fromString(t5(this.args[0].evaluate(r))):t5(this.args[0].evaluate(r))},er.prototype.eachChild=function(r){this.args.forEach(r)},er.prototype.outputDefined=function(){return this.args.every(function(r){return r.outputDefined()})},er.prototype.serialize=function(){if("formatted"===this.type.kind)return new t7([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new et(this.args[0]).serialize();var r=["to-"+this.type.kind];return this.eachChild(function(n){r.push(n.serialize())}),r};var en=["Unknown","Point","LineString","Polygon"],ei=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};ei.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},ei.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?en[this.feature.type]:this.feature.type:null},ei.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},ei.prototype.canonicalID=function(){return this.canonical},ei.prototype.properties=function(){return this.feature&&this.feature.properties||{}},ei.prototype.parseColor=function(r){var n=this._parseColorCache[r];return n||(n=this._parseColorCache[r]=tJ.parse(r)),n};var ea=function(r,n,i,a){this.name=r,this.type=n,this._evaluate=i,this.args=a};ea.prototype.evaluate=function(r){return this._evaluate(r,this.args)},ea.prototype.eachChild=function(r){this.args.forEach(r)},ea.prototype.outputDefined=function(){return!1},ea.prototype.serialize=function(){return[this.name].concat(this.args.map(function(r){return r.serialize()}))},ea.parse=function(r,n){var i,a=r[0],o=ea.definitions[a];if(!o)return n.error('Unknown expression "'+a+'". If you wanted a literal array, use ["literal", [...]].',0);for(var s=Array.isArray(o)?o[0]:o.type,l=Array.isArray(o)?[[o[1],o[2]]]:o.overloads,c=l.filter(function(n){var i=n[0];return!Array.isArray(i)||i.length===r.length-1}),u=null,f=0;f<c.length;f+=1){var h=c[f],p=h[0],d=h[1];u=new ew(n.registry,n.path,null,n.scope);for(var m=[],g=!1,v=1;v<r.length;v++){var y=r[v],x=Array.isArray(p)?p[v-1]:p.type,b=u.parse(y,1+m.length,x);if(!b){g=!0;break}m.push(b)}if(!g){if(Array.isArray(p)&&p.length!==m.length)u.error("Expected "+p.length+" arguments, but found "+m.length+" instead.");else{for(var _=0;_<m.length;_++){var w=Array.isArray(p)?p[_]:p.type,T=m[_];u.concat(_+1).checkSubtype(w,T.type)}if(0===u.errors.length)return new ea(a,s,d,m)}}}if(1===c.length)(i=n.errors).push.apply(i,u.errors);else{for(var k=(c.length?c:l).map(function(r){var n=r[0];return Array.isArray(n)?"("+n.map(tq).join(", ")+")":"("+tq(n.type)+"...)"}).join(" | "),A=[],M=1;M<r.length;M++){var S=n.parse(r[M],1+A.length);if(!S)return null;A.push(tq(S.type))}n.error("Expected arguments of type "+k+", but found ("+A.join(", ")+") instead.")}return null},ea.register=function(r,n){for(var i in ea.definitions=n,n)r[i]=ea};var eo=function(r,n,i){this.type=tj,this.locale=i,this.caseSensitive=r,this.diacriticSensitive=n};function es(r,n){r[0]=Math.min(r[0],n[0]),r[1]=Math.min(r[1],n[1]),r[2]=Math.max(r[2],n[0]),r[3]=Math.max(r[3],n[1])}function el(r,n){return!(r[0]<=n[0])&&!(r[2]>=n[2])&&!(r[1]<=n[1])&&!(r[3]>=n[3])}function ec(r,n){for(var i,a,o,s,l,c,u,f,h=!1,p=0,d=n.length;p<d;p++)for(var m=n[p],g=0,v=m.length;g<v-1;g++){if(o=m[g],s=m[g+1],l=void 0,c=void 0,u=void 0,f=void 0,l=r[0]-o[0],c=r[1]-o[1],u=r[0]-s[0],l*(f=r[1]-s[1])-u*c==0&&l*u<=0&&c*f<=0)return!1;i=m[g],a=m[g+1],i[1]>r[1]!=a[1]>r[1]&&r[0]<(a[0]-i[0])*(r[1]-i[1])/(a[1]-i[1])+i[0]&&(h=!h)}return h}function eu(r,n,i,a){var o=r[0]-i[0],s=r[1]-i[1],l=n[0]-i[0],c=n[1]-i[1],u=a[0]-i[0],f=a[1]-i[1],h=o*f-u*s,p=l*f-u*c;return h>0&&p<0||h<0&&p>0}function ef(r,n){for(var i=0;i<r.length;++i)if(!ec(r[i],n))return!1;for(var a=0;a<r.length-1;++a)if(function(r,n,i){for(var a,o,s,l,c,u=0;u<i.length;u+=1)for(var f=i[u],h=0;h<f.length-1;++h)if(a=f[h],o=f[h+1],s=void 0,l=void 0,c=void 0,c=[n[0]-r[0],n[1]-r[1]],0!=(s=[o[0]-a[0],o[1]-a[1]])[0]*(l=c)[1]-s[1]*l[0]&&eu(r,n,a,o)&&eu(a,o,r,n))return!0;return!1}(r[a],r[a+1],n))return!1;return!0}function eh(r,n,i){for(var a=[],o=0;o<r.length;o++){for(var s=[],l=0;l<r[o].length;l++){var c=function(r,n){var i=(180+r[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,o=Math.pow(2,n.z);return[Math.round(i*o*8192),Math.round(a*o*8192)]}(r[o][l],i);es(n,c),s.push(c)}a.push(s)}return a}function ep(r,n,i){for(var a=[],o=0;o<r.length;o++){var s=eh(r[o],n,i);a.push(s)}return a}function ed(r,n,i,a){if(r[0]<i[0]||r[0]>i[2]){var o=.5*a,s=r[0]-i[0]>o?-a:i[0]-r[0]>o?a:0;0===s&&(s=r[0]-i[2]>o?-a:i[2]-r[0]>o?a:0),r[0]+=s}es(n,r)}function em(r,n,i,a){for(var o=8192*Math.pow(2,a.z),s=[8192*a.x,8192*a.y],l=[],c=0;c<r.length;c+=1)for(var u=0,f=r[c];u<f.length;u+=1){var h=f[u],p=[h.x+s[0],h.y+s[1]];ed(p,n,i,o),l.push(p)}return l}function eg(r,n,i,a){for(var o=8192*Math.pow(2,a.z),s=[8192*a.x,8192*a.y],l=[],c=0;c<r.length;c+=1){for(var u=[],f=0,h=r[c];f<h.length;f+=1){var p=h[f],d=[p.x+s[0],p.y+s[1]];es(n,d),u.push(d)}l.push(u)}if(n[2]-n[0]<=o/2){n[0]=n[1]=1/0,n[2]=n[3]=-1/0;for(var m=0;m<l.length;m+=1)for(var g=0,v=l[m];g<v.length;g+=1)ed(v[g],n,i,o)}return l}eo.parse=function(r,n){if(2!==r.length)return n.error("Expected one argument.");var i=r[1];if("object"!=typeof i||Array.isArray(i))return n.error("Collator options argument must be an object.");var a=n.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,tR);if(!a)return null;var o=n.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,tR);if(!o)return null;var s=null;return!i.locale||(s=n.parse(i.locale,1,tD))?new eo(a,o,s):null},eo.prototype.evaluate=function(r){return new tK(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)},eo.prototype.eachChild=function(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)},eo.prototype.outputDefined=function(){return!1},eo.prototype.serialize=function(){var r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]};var ev=function(r,n){this.type=tR,this.geojson=r,this.geometries=n};function ey(r){if(r instanceof ea&&("get"===r.name&&1===r.args.length||"feature-state"===r.name||"has"===r.name&&1===r.args.length||"properties"===r.name||"geometry-type"===r.name||"id"===r.name||/^filter-/.test(r.name))||r instanceof ev)return!1;var n=!0;return r.eachChild(function(r){n&&!ey(r)&&(n=!1)}),n}function ex(r){if(r instanceof ea&&"feature-state"===r.name)return!1;var n=!0;return r.eachChild(function(r){n&&!ex(r)&&(n=!1)}),n}function eb(r,n){if(r instanceof ea&&n.indexOf(r.name)>=0)return!1;var i=!0;return r.eachChild(function(r){i&&!eb(r,n)&&(i=!1)}),i}ev.parse=function(r,n){if(2!==r.length)return n.error("'within' expression requires exactly one argument, but found "+(r.length-1)+" instead.");if(t2(r[1])){var i=r[1];if("FeatureCollection"===i.type)for(var a=0;a<i.features.length;++a){var o=i.features[a].geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new ev(i,i.features[a].geometry)}else if("Feature"===i.type){var s=i.geometry.type;if("Polygon"===s||"MultiPolygon"===s)return new ev(i,i.geometry)}else if("Polygon"===i.type||"MultiPolygon"===i.type)return new ev(i,i)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")},ev.prototype.evaluate=function(r){if(null!=r.geometry()&&null!=r.canonicalID()){if("Point"===r.geometryType())return function(r,n){var i=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],o=r.canonicalID();if("Polygon"===n.type){var s=eh(n.coordinates,a,o),l=em(r.geometry(),i,a,o);if(!el(i,a))return!1;for(var c=0;c<l.length;c+=1)if(!ec(l[c],s))return!1}if("MultiPolygon"===n.type){var u=ep(n.coordinates,a,o),f=em(r.geometry(),i,a,o);if(!el(i,a))return!1;for(var h=0;h<f.length;h+=1)if(!function(r,n){for(var i=0;i<n.length;i++)if(ec(r,n[i]))return!0;return!1}(f[h],u))return!1}return!0}(r,this.geometries);if("LineString"===r.geometryType())return function(r,n){var i=[1/0,1/0,-1/0,-1/0],a=[1/0,1/0,-1/0,-1/0],o=r.canonicalID();if("Polygon"===n.type){var s=eh(n.coordinates,a,o),l=eg(r.geometry(),i,a,o);if(!el(i,a))return!1;for(var c=0;c<l.length;c+=1)if(!ef(l[c],s))return!1}if("MultiPolygon"===n.type){var u=ep(n.coordinates,a,o),f=eg(r.geometry(),i,a,o);if(!el(i,a))return!1;for(var h=0;h<f.length;h+=1)if(!function(r,n){for(var i=0;i<n.length;i++)if(ef(r,n[i]))return!0;return!1}(f[h],u))return!1}return!0}(r,this.geometries)}return!1},ev.prototype.eachChild=function(){},ev.prototype.outputDefined=function(){return!0},ev.prototype.serialize=function(){return["within",this.geojson]};var e_=function(r,n){this.type=n.type,this.name=r,this.boundExpression=n};e_.parse=function(r,n){if(2!==r.length||"string"!=typeof r[1])return n.error("'var' expression requires exactly one string literal argument.");var i=r[1];return n.scope.has(i)?new e_(i,n.scope.get(i)):n.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},e_.prototype.evaluate=function(r){return this.boundExpression.evaluate(r)},e_.prototype.eachChild=function(){},e_.prototype.outputDefined=function(){return!1},e_.prototype.serialize=function(){return["var",this.name]};var ew=function(r,n,i,a,o){void 0===n&&(n=[]),void 0===a&&(a=new tI),void 0===o&&(o=[]),this.registry=r,this.path=n,this.key=n.map(function(r){return"["+r+"]"}).join(""),this.scope=a,this.errors=o,this.expectedType=i};function eT(r,n){for(var i,a,o=r.length-1,s=0,l=o,c=0;s<=l;)if(i=r[c=Math.floor((s+l)/2)],a=r[c+1],i<=n){if(c===o||n<a)return c;s=c+1}else{if(!(i>n))throw new t6("Input is not a number.");l=c-1}return 0}ew.prototype.parse=function(r,n,i,a,o){return void 0===o&&(o={}),n?this.concat(n,i,a)._parse(r,o):this._parse(r,o)},ew.prototype._parse=function(r,n){function i(r,n,i){return"assert"===i?new t9(n,[r]):"coerce"===i?new er(n,[r]):r}if(null!==r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(r=["literal",r]),Array.isArray(r)){if(0===r.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var a=r[0];if("string"!=typeof a)return this.error("Expression name must be a string, but found "+typeof a+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var o=this.registry[a];if(o){var s=o.parse(r,this);if(!s)return null;if(this.expectedType){var l=this.expectedType,c=s.type;if("string"!==l.kind&&"number"!==l.kind&&"boolean"!==l.kind&&"object"!==l.kind&&"array"!==l.kind||"value"!==c.kind){if("color"!==l.kind&&"formatted"!==l.kind&&"resolvedImage"!==l.kind||"value"!==c.kind&&"string"!==c.kind){if(this.checkSubtype(l,c))return null}else s=i(s,l,n.typeAnnotation||"coerce")}else s=i(s,l,n.typeAnnotation||"assert")}if(!(s instanceof t4)&&"resolvedImage"!==s.type.kind&&function r(n){if(n instanceof e_)return r(n.boundExpression);if(n instanceof ea&&"error"===n.name||n instanceof eo||n instanceof ev)return!1;var i=n instanceof er||n instanceof t9,a=!0;return n.eachChild(function(n){a=i?a&&r(n):a&&n instanceof t4}),!!a&&ey(n)&&eb(n,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(s)){var u=new ei;try{s=new t4(s.type,s.evaluate(u))}catch(r){return this.error(r.message),null}}return s}return this.error('Unknown expression "'+a+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===r?this.error("'undefined' value invalid. Use null instead."):"object"==typeof r?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof r+" instead.")},ew.prototype.concat=function(r,n,i){var a="number"==typeof r?this.path.concat(r):this.path,o=i?this.scope.concat(i):this.scope;return new ew(this.registry,a,n||null,o,this.errors)},ew.prototype.error=function(r){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];var a=""+this.key+n.map(function(r){return"["+r+"]"}).join("");this.errors.push(new tP(a,r))},ew.prototype.checkSubtype=function(r,n){var i=tY(r,n);return i&&this.error(i),i};var ek=function(r,n,i){this.type=r,this.input=n,this.labels=[],this.outputs=[];for(var a=0;a<i.length;a+=1){var o=i[a],s=o[0],l=o[1];this.labels.push(s),this.outputs.push(l)}};function eA(r,n,i){return r*(1-i)+n*i}ek.parse=function(r,n){if(r.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if((r.length-1)%2!=0)return n.error("Expected an even number of arguments.");var i=n.parse(r[1],1,tz);if(!i)return null;var a=[],o=null;n.expectedType&&"value"!==n.expectedType.kind&&(o=n.expectedType);for(var s=1;s<r.length;s+=2){var l=1===s?-1/0:r[s],c=r[s+1],u=s,f=s+1;if("number"!=typeof l)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(a.length&&a[a.length-1][0]>=l)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var h=n.parse(c,f,o);if(!h)return null;o=o||h.type,a.push([l,h])}return new ek(o,i,a)},ek.prototype.evaluate=function(r){var n=this.labels,i=this.outputs;if(1===n.length)return i[0].evaluate(r);var a=this.input.evaluate(r);if(a<=n[0])return i[0].evaluate(r);var o=n.length;return a>=n[o-1]?i[o-1].evaluate(r):i[eT(n,a)].evaluate(r)},ek.prototype.eachChild=function(r){r(this.input);for(var n=0,i=this.outputs;n<i.length;n+=1)r(i[n])},ek.prototype.outputDefined=function(){return this.outputs.every(function(r){return r.outputDefined()})},ek.prototype.serialize=function(){for(var r=["step",this.input.serialize()],n=0;n<this.labels.length;n++)n>0&&r.push(this.labels[n]),r.push(this.outputs[n].serialize());return r};var eM=Object.freeze({__proto__:null,number:eA,color:function(r,n,i){return new tJ(eA(r.r,n.r,i),eA(r.g,n.g,i),eA(r.b,n.b,i),eA(r.a,n.a,i))},array:function(r,n,i){return r.map(function(r,a){return eA(r,n[a],i)})}}),eS=6/29,eE=6/29*3*(6/29),eL=Math.PI/180,eC=180/Math.PI;function eP(r){return r>.008856451679035631?Math.pow(r,1/3):r/eE+4/29}function eI(r){return r>eS?r*r*r:eE*(r-4/29)}function eO(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function ez(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function eD(r){var n=ez(r.r),i=ez(r.g),a=ez(r.b),o=eP((.4124564*n+.3575761*i+.1804375*a)/.95047),s=eP((.2126729*n+.7151522*i+.072175*a)/1);return{l:116*s-16,a:500*(o-s),b:200*(s-eP((.0193339*n+.119192*i+.9503041*a)/1.08883)),alpha:r.a}}function eR(r){var n=(r.l+16)/116,i=isNaN(r.a)?n:n+r.a/500,a=isNaN(r.b)?n:n-r.b/200;return n=1*eI(n),new tJ(eO(3.2404542*(i=.95047*eI(i))-1.5371385*n-.4985314*(a=1.08883*eI(a))),eO(-.969266*i+1.8760108*n+.041556*a),eO(.0556434*i-.2040259*n+1.0572252*a),r.alpha)}var eF={forward:eD,reverse:eR,interpolate:function(r,n,i){return{l:eA(r.l,n.l,i),a:eA(r.a,n.a,i),b:eA(r.b,n.b,i),alpha:eA(r.alpha,n.alpha,i)}}},eB={forward:function(r){var n=eD(r),i=n.l,a=n.a,o=n.b,s=Math.atan2(o,a)*eC;return{h:s<0?s+360:s,c:Math.sqrt(a*a+o*o),l:i,alpha:r.a}},reverse:function(r){var n=r.h*eL,i=r.c;return eR({l:r.l,a:Math.cos(n)*i,b:Math.sin(n)*i,alpha:r.alpha})},interpolate:function(r,n,i){var a,o;return{h:(a=r.h,o=n.h-a,a+i*(o>180||o<-180?o-360*Math.round(o/360):o)),c:eA(r.c,n.c,i),l:eA(r.l,n.l,i),alpha:eA(r.alpha,n.alpha,i)}}},eN=Object.freeze({__proto__:null,lab:eF,hcl:eB}),ej=function(r,n,i,a,o){this.type=r,this.operator=n,this.interpolation=i,this.input=a,this.labels=[],this.outputs=[];for(var s=0;s<o.length;s+=1){var l=o[s],c=l[0],u=l[1];this.labels.push(c),this.outputs.push(u)}};function eU(r,n,i,a){var o=a-i,s=r-i;return 0===o?0:1===n?s/o:(Math.pow(n,s)-1)/(Math.pow(n,o)-1)}ej.interpolationFactor=function(r,n,a,o){var s=0;if("exponential"===r.name)s=eU(n,r.base,a,o);else if("linear"===r.name)s=eU(n,1,a,o);else if("cubic-bezier"===r.name){var l=r.controlPoints;s=new i(l[0],l[1],l[2],l[3]).solve(eU(n,1,a,o))}return s},ej.parse=function(r,n){var i=r[0],a=r[1],o=r[2],s=r.slice(3);if(!Array.isArray(a)||0===a.length)return n.error("Expected an interpolation type expression.",1);if("linear"===a[0])a={name:"linear"};else if("exponential"===a[0]){var l=a[1];if("number"!=typeof l)return n.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:l}}else{if("cubic-bezier"!==a[0])return n.error("Unknown interpolation type "+String(a[0]),1,0);var c=a.slice(1);if(4!==c.length||c.some(function(r){return"number"!=typeof r||r<0||r>1}))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:c}}if(r.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if((r.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(o=n.parse(o,2,tz)))return null;var u=[],f=null;"interpolate-hcl"===i||"interpolate-lab"===i?f=tF:n.expectedType&&"value"!==n.expectedType.kind&&(f=n.expectedType);for(var h=0;h<s.length;h+=2){var p=s[h],d=s[h+1],m=h+3,g=h+4;if("number"!=typeof p)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',m);if(u.length&&u[u.length-1][0]>=p)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',m);var v=n.parse(d,g,f);if(!v)return null;f=f||v.type,u.push([p,v])}return"number"===f.kind||"color"===f.kind||"array"===f.kind&&"number"===f.itemType.kind&&"number"==typeof f.N?new ej(f,i,a,o,u):n.error("Type "+tq(f)+" is not interpolatable.")},ej.prototype.evaluate=function(r){var n=this.labels,i=this.outputs;if(1===n.length)return i[0].evaluate(r);var a=this.input.evaluate(r);if(a<=n[0])return i[0].evaluate(r);var o=n.length;if(a>=n[o-1])return i[o-1].evaluate(r);var s=eT(n,a),l=n[s],c=n[s+1],u=ej.interpolationFactor(this.interpolation,a,l,c),f=i[s].evaluate(r),h=i[s+1].evaluate(r);return"interpolate"===this.operator?eM[this.type.kind.toLowerCase()](f,h,u):"interpolate-hcl"===this.operator?eB.reverse(eB.interpolate(eB.forward(f),eB.forward(h),u)):eF.reverse(eF.interpolate(eF.forward(f),eF.forward(h),u))},ej.prototype.eachChild=function(r){r(this.input);for(var n=0,i=this.outputs;n<i.length;n+=1)r(i[n])},ej.prototype.outputDefined=function(){return this.outputs.every(function(r){return r.outputDefined()})},ej.prototype.serialize=function(){var r;r="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var n=[this.operator,r,this.input.serialize()],i=0;i<this.labels.length;i++)n.push(this.labels[i],this.outputs[i].serialize());return n};var eV=function(r,n){this.type=r,this.args=n};eV.parse=function(r,n){if(r.length<2)return n.error("Expectected at least one argument.");var i=null,a=n.expectedType;a&&"value"!==a.kind&&(i=a);for(var o=[],s=0,l=r.slice(1);s<l.length;s+=1){var c=l[s],u=n.parse(c,1+o.length,i,void 0,{typeAnnotation:"omit"});if(!u)return null;i=i||u.type,o.push(u)}return new eV(a&&o.some(function(r){return tY(a,r.type)})?tN:i,o)},eV.prototype.evaluate=function(r){for(var n,i=null,a=0,o=0,s=this.args;o<s.length&&(a++,(i=s[o].evaluate(r))&&i instanceof t0&&!i.available&&(n||(n=i.name),i=null,a===this.args.length&&(i=n)),null===i);o+=1);return i},eV.prototype.eachChild=function(r){this.args.forEach(r)},eV.prototype.outputDefined=function(){return this.args.every(function(r){return r.outputDefined()})},eV.prototype.serialize=function(){var r=["coalesce"];return this.eachChild(function(n){r.push(n.serialize())}),r};var eH=function(r,n){this.type=n.type,this.bindings=[].concat(r),this.result=n};eH.prototype.evaluate=function(r){return this.result.evaluate(r)},eH.prototype.eachChild=function(r){for(var n=0,i=this.bindings;n<i.length;n+=1)r(i[n][1]);r(this.result)},eH.parse=function(r,n){if(r.length<4)return n.error("Expected at least 3 arguments, but found "+(r.length-1)+" instead.");for(var i=[],a=1;a<r.length-1;a+=2){var o=r[a];if("string"!=typeof o)return n.error("Expected string, but found "+typeof o+" instead.",a);if(/[^a-zA-Z0-9_]/.test(o))return n.error("Variable names must contain only alphanumeric characters or '_'.",a);var s=n.parse(r[a+1],a+1);if(!s)return null;i.push([o,s])}var l=n.parse(r[r.length-1],r.length-1,n.expectedType,i);return l?new eH(i,l):null},eH.prototype.outputDefined=function(){return this.result.outputDefined()},eH.prototype.serialize=function(){for(var r=["let"],n=0,i=this.bindings;n<i.length;n+=1){var a=i[n],o=a[0],s=a[1];r.push(o,s.serialize())}return r.push(this.result.serialize()),r};var eq=function(r,n,i){this.type=r,this.index=n,this.input=i};eq.parse=function(r,n){if(3!==r.length)return n.error("Expected 2 arguments, but found "+(r.length-1)+" instead.");var i=n.parse(r[1],1,tz),a=n.parse(r[2],2,tH(n.expectedType||tN));return i&&a?new eq(a.type.itemType,i,a):null},eq.prototype.evaluate=function(r){var n=this.index.evaluate(r),i=this.input.evaluate(r);if(n<0)throw new t6("Array index out of bounds: "+n+" < 0.");if(n>=i.length)throw new t6("Array index out of bounds: "+n+" > "+(i.length-1)+".");if(n!==Math.floor(n))throw new t6("Array index must be an integer, but found "+n+" instead.");return i[n]},eq.prototype.eachChild=function(r){r(this.index),r(this.input)},eq.prototype.outputDefined=function(){return!1},eq.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var eG=function(r,n){this.type=tR,this.needle=r,this.haystack=n};eG.parse=function(r,n){if(3!==r.length)return n.error("Expected 2 arguments, but found "+(r.length-1)+" instead.");var i=n.parse(r[1],1,tN),a=n.parse(r[2],2,tN);return i&&a?tW(i.type,[tR,tD,tz,tO,tN])?new eG(i,a):n.error("Expected first argument to be of type boolean, string, number or null, but found "+tq(i.type)+" instead"):null},eG.prototype.evaluate=function(r){var n=this.needle.evaluate(r),i=this.haystack.evaluate(r);if(!i)return!1;if(!tX(n,["boolean","string","number","null"]))throw new t6("Expected first argument to be of type boolean, string, number or null, but found "+tq(t3(n))+" instead.");if(!tX(i,["string","array"]))throw new t6("Expected second argument to be of type array or string, but found "+tq(t3(i))+" instead.");return i.indexOf(n)>=0},eG.prototype.eachChild=function(r){r(this.needle),r(this.haystack)},eG.prototype.outputDefined=function(){return!0},eG.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var eY=function(r,n,i){this.type=tz,this.needle=r,this.haystack=n,this.fromIndex=i};eY.parse=function(r,n){if(r.length<=2||r.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(r.length-1)+" instead.");var i=n.parse(r[1],1,tN),a=n.parse(r[2],2,tN);if(!i||!a)return null;if(!tW(i.type,[tR,tD,tz,tO,tN]))return n.error("Expected first argument to be of type boolean, string, number or null, but found "+tq(i.type)+" instead");if(4===r.length){var o=n.parse(r[3],3,tz);return o?new eY(i,a,o):null}return new eY(i,a)},eY.prototype.evaluate=function(r){var n=this.needle.evaluate(r),i=this.haystack.evaluate(r);if(!tX(n,["boolean","string","number","null"]))throw new t6("Expected first argument to be of type boolean, string, number or null, but found "+tq(t3(n))+" instead.");if(!tX(i,["string","array"]))throw new t6("Expected second argument to be of type array or string, but found "+tq(t3(i))+" instead.");if(this.fromIndex){var a=this.fromIndex.evaluate(r);return i.indexOf(n,a)}return i.indexOf(n)},eY.prototype.eachChild=function(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)},eY.prototype.outputDefined=function(){return!1},eY.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var eW=function(r,n,i,a,o,s){this.inputType=r,this.type=n,this.input=i,this.cases=a,this.outputs=o,this.otherwise=s};eW.parse=function(r,n){if(r.length<5)return n.error("Expected at least 4 arguments, but found only "+(r.length-1)+".");if(r.length%2!=1)return n.error("Expected an even number of arguments.");n.expectedType&&"value"!==n.expectedType.kind&&(a=n.expectedType);for(var i,a,o={},s=[],l=2;l<r.length-1;l+=2){var c=r[l],u=r[l+1];Array.isArray(c)||(c=[c]);var f=n.concat(l);if(0===c.length)return f.error("Expected at least one branch label.");for(var h=0,p=c;h<p.length;h+=1){var d=p[h];if("number"!=typeof d&&"string"!=typeof d)return f.error("Branch labels must be numbers or strings.");if("number"==typeof d&&Math.abs(d)>Number.MAX_SAFE_INTEGER)return f.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof d&&Math.floor(d)!==d)return f.error("Numeric branch labels must be integer values.");if(i){if(f.checkSubtype(i,t3(d)))return null}else i=t3(d);if(void 0!==o[String(d)])return f.error("Branch labels must be unique.");o[String(d)]=s.length}var m=n.parse(u,l,a);if(!m)return null;a=a||m.type,s.push(m)}var g=n.parse(r[1],1,tN);if(!g)return null;var v=n.parse(r[r.length-1],r.length-1,a);return v?"value"!==g.type.kind&&n.concat(1).checkSubtype(i,g.type)?null:new eW(i,a,g,o,s,v):null},eW.prototype.evaluate=function(r){var n=this.input.evaluate(r);return(t3(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(r)},eW.prototype.eachChild=function(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)},eW.prototype.outputDefined=function(){return this.outputs.every(function(r){return r.outputDefined()})&&this.otherwise.outputDefined()},eW.prototype.serialize=function(){for(var r=this,n=["match",this.input.serialize()],i=[],a={},o=0,s=Object.keys(this.cases).sort();o<s.length;o+=1){var l=s[o];void 0===(h=a[this.cases[l]])?(a[this.cases[l]]=i.length,i.push([this.cases[l],[l]])):i[h][1].push(l)}for(var c=function(n){return"number"===r.inputType.kind?Number(n):n},u=0;u<i.length;u+=1){var f=i[u],h=f[0],p=f[1];1===p.length?n.push(c(p[0])):n.push(p.map(c)),n.push(this.outputs[outputIndex$1].serialize())}return n.push(this.otherwise.serialize()),n};var eX=function(r,n,i){this.type=r,this.branches=n,this.otherwise=i};eX.parse=function(r,n){if(r.length<4)return n.error("Expected at least 3 arguments, but found only "+(r.length-1)+".");if(r.length%2!=0)return n.error("Expected an odd number of arguments.");n.expectedType&&"value"!==n.expectedType.kind&&(i=n.expectedType);for(var i,a=[],o=1;o<r.length-1;o+=2){var s=n.parse(r[o],o,tR);if(!s)return null;var l=n.parse(r[o+1],o+1,i);if(!l)return null;a.push([s,l]),i=i||l.type}var c=n.parse(r[r.length-1],r.length-1,i);return c?new eX(i,a,c):null},eX.prototype.evaluate=function(r){for(var n=0,i=this.branches;n<i.length;n+=1){var a=i[n],o=a[0],s=a[1];if(o.evaluate(r))return s.evaluate(r)}return this.otherwise.evaluate(r)},eX.prototype.eachChild=function(r){for(var n=0,i=this.branches;n<i.length;n+=1){var a=i[n],o=a[0],s=a[1];r(o),r(s)}r(this.otherwise)},eX.prototype.outputDefined=function(){return this.branches.every(function(r){return r[0],r[1].outputDefined()})&&this.otherwise.outputDefined()},eX.prototype.serialize=function(){var r=["case"];return this.eachChild(function(n){r.push(n.serialize())}),r};var eZ=function(r,n,i,a){this.type=r,this.input=n,this.beginIndex=i,this.endIndex=a};function eJ(r,n){return"=="===r||"!="===r?"boolean"===n.kind||"string"===n.kind||"number"===n.kind||"null"===n.kind||"value"===n.kind:"string"===n.kind||"number"===n.kind||"value"===n.kind}function eK(r,n,i,a){return 0===a.compare(n,i)}function eQ(r,n,i){var a="=="!==r&&"!="!==r;return function(){function o(r,n,i){this.type=tR,this.lhs=r,this.rhs=n,this.collator=i,this.hasUntypedArgument="value"===r.type.kind||"value"===n.type.kind}return o.parse=function(r,n){if(3!==r.length&&4!==r.length)return n.error("Expected two or three arguments.");var i=r[0],s=n.parse(r[1],1,tN);if(!s)return null;if(!eJ(i,s.type))return n.concat(1).error('"'+i+"\" comparisons are not supported for type '"+tq(s.type)+"'.");var l=n.parse(r[2],2,tN);if(!l)return null;if(!eJ(i,l.type))return n.concat(2).error('"'+i+"\" comparisons are not supported for type '"+tq(l.type)+"'.");if(s.type.kind!==l.type.kind&&"value"!==s.type.kind&&"value"!==l.type.kind)return n.error("Cannot compare types '"+tq(s.type)+"' and '"+tq(l.type)+"'.");a&&("value"===s.type.kind&&"value"!==l.type.kind?s=new t9(l.type,[s]):"value"!==s.type.kind&&"value"===l.type.kind&&(l=new t9(s.type,[l])));var c=null;if(4===r.length){if("string"!==s.type.kind&&"string"!==l.type.kind&&"value"!==s.type.kind&&"value"!==l.type.kind)return n.error("Cannot use collator to compare non-string types.");if(!(c=n.parse(r[3],3,tj)))return null}return new o(s,l,c)},o.prototype.evaluate=function(o){var s=this.lhs.evaluate(o),l=this.rhs.evaluate(o);if(a&&this.hasUntypedArgument){var c=t3(s),u=t3(l);if(c.kind!==u.kind||"string"!==c.kind&&"number"!==c.kind)throw new t6('Expected arguments for "'+r+'" to be (string, string) or (number, number), but found ('+c.kind+", "+u.kind+") instead.")}if(this.collator&&!a&&this.hasUntypedArgument){var f=t3(s),h=t3(l);if("string"!==f.kind||"string"!==h.kind)return n(o,s,l)}return this.collator?i(o,s,l,this.collator.evaluate(o)):n(o,s,l)},o.prototype.eachChild=function(r){r(this.lhs),r(this.rhs),this.collator&&r(this.collator)},o.prototype.outputDefined=function(){return!0},o.prototype.serialize=function(){var n=[r];return this.eachChild(function(r){n.push(r.serialize())}),n},o}()}eZ.parse=function(r,n){if(r.length<=2||r.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(r.length-1)+" instead.");var i=n.parse(r[1],1,tN),a=n.parse(r[2],2,tz);if(!i||!a)return null;if(!tW(i.type,[tH(tN),tD,tN]))return n.error("Expected first argument to be of type array or string, but found "+tq(i.type)+" instead");if(4===r.length){var o=n.parse(r[3],3,tz);return o?new eZ(i.type,i,a,o):null}return new eZ(i.type,i,a)},eZ.prototype.evaluate=function(r){var n=this.input.evaluate(r),i=this.beginIndex.evaluate(r);if(!tX(n,["string","array"]))throw new t6("Expected first argument to be of type array or string, but found "+tq(t3(n))+" instead.");if(this.endIndex){var a=this.endIndex.evaluate(r);return n.slice(i,a)}return n.slice(i)},eZ.prototype.eachChild=function(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)},eZ.prototype.outputDefined=function(){return!1},eZ.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var e$=eQ("==",function(r,n,i){return n===i},eK),e0=eQ("!=",function(r,n,i){return n!==i},function(r,n,i,a){return!eK(0,n,i,a)}),e1=eQ("<",function(r,n,i){return n<i},function(r,n,i,a){return 0>a.compare(n,i)}),e2=eQ(">",function(r,n,i){return n>i},function(r,n,i,a){return a.compare(n,i)>0}),e3=eQ("<=",function(r,n,i){return n<=i},function(r,n,i,a){return 0>=a.compare(n,i)}),e5=eQ(">=",function(r,n,i){return n>=i},function(r,n,i,a){return a.compare(n,i)>=0}),e4=function(r,n,i,a,o){this.type=tD,this.number=r,this.locale=n,this.currency=i,this.minFractionDigits=a,this.maxFractionDigits=o};e4.parse=function(r,n){if(3!==r.length)return n.error("Expected two arguments.");var i=n.parse(r[1],1,tz);if(!i)return null;var a=r[2];if("object"!=typeof a||Array.isArray(a))return n.error("NumberFormat options argument must be an object.");var o=null;if(a.locale&&!(o=n.parse(a.locale,1,tD)))return null;var s=null;if(a.currency&&!(s=n.parse(a.currency,1,tD)))return null;var l=null;if(a["min-fraction-digits"]&&!(l=n.parse(a["min-fraction-digits"],1,tz)))return null;var c=null;return!a["max-fraction-digits"]||(c=n.parse(a["max-fraction-digits"],1,tz))?new e4(i,o,s,l,c):null},e4.prototype.evaluate=function(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))},e4.prototype.eachChild=function(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)},e4.prototype.outputDefined=function(){return!1},e4.prototype.serialize=function(){var r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]};var e6=function(r){this.type=tz,this.input=r};e6.parse=function(r,n){if(2!==r.length)return n.error("Expected 1 argument, but found "+(r.length-1)+" instead.");var i=n.parse(r[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?n.error("Expected argument of type string or array, but found "+tq(i.type)+" instead."):new e6(i):null},e6.prototype.evaluate=function(r){var n=this.input.evaluate(r);if("string"==typeof n||Array.isArray(n))return n.length;throw new t6("Expected value to be of type string or array, but found "+tq(t3(n))+" instead.")},e6.prototype.eachChild=function(r){r(this.input)},e6.prototype.outputDefined=function(){return!1},e6.prototype.serialize=function(){var r=["length"];return this.eachChild(function(n){r.push(n.serialize())}),r};var e8={"==":e$,"!=":e0,">":e2,"<":e1,">=":e5,"<=":e3,array:t9,at:eq,boolean:t9,case:eX,coalesce:eV,collator:eo,format:t7,image:et,in:eG,"index-of":eY,interpolate:ej,"interpolate-hcl":ej,"interpolate-lab":ej,length:e6,let:eH,literal:t4,match:eW,number:t9,"number-format":e4,object:t9,slice:eZ,step:ek,string:t9,"to-boolean":er,"to-color":er,"to-number":er,"to-string":er,var:e_,within:ev};function e9(r,n){var i=n[0],a=n[1],o=n[2],s=n[3];i=i.evaluate(r),a=a.evaluate(r),o=o.evaluate(r);var l=s?s.evaluate(r):1,c=t1(i,a,o,l);if(c)throw new t6(c);return new tJ(i/255*l,a/255*l,o/255*l,l)}function e7(r,n){var i=n[r];return void 0===i?null:i}function rt(r){return{type:r}}function re(r){return{result:"success",value:r}}function rr(r){return{result:"error",value:r}}function rn(r){return"data-driven"===r["property-type"]||"cross-faded-data-driven"===r["property-type"]}function ri(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function ra(r){return!!r.expression&&r.expression.interpolated}function ro(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":null===r?"null":typeof r}function rs(r){return"object"==typeof r&&null!==r&&!Array.isArray(r)}function rl(r){return r}function rc(r,n,i){return void 0!==r?r:void 0!==n?n:void 0!==i?i:void 0}function ru(r,n,i,a,o){return rc(typeof i===o?a[i]:void 0,r.default,n.default)}function rf(r,n,i){if("number"!==ro(i))return rc(r.default,n.default);var a=r.stops.length;if(1===a||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[a-1][0])return r.stops[a-1][1];var o=eT(r.stops.map(function(r){return r[0]}),i);return r.stops[o][1]}function rh(r,n,i){var a,o,s,l=void 0!==r.base?r.base:1;if("number"!==ro(i))return rc(r.default,n.default);var c=r.stops.length;if(1===c||i<=r.stops[0][0])return r.stops[0][1];if(i>=r.stops[c-1][0])return r.stops[c-1][1];var u=eT(r.stops.map(function(r){return r[0]}),i),f=(a=r.stops[u][0],o=r.stops[u+1][0]-a,s=i-a,0===o?0:1===l?s/o:(Math.pow(l,s)-1)/(Math.pow(l,o)-1)),h=r.stops[u][1],p=r.stops[u+1][1],d=eM[n.type]||rl;if(r.colorSpace&&"rgb"!==r.colorSpace){var m=eN[r.colorSpace];d=function(r,n){return m.reverse(m.interpolate(m.forward(r),m.forward(n),f))}}return"function"==typeof h.evaluate?{evaluate:function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];var i=h.evaluate.apply(void 0,r),a=p.evaluate.apply(void 0,r);if(void 0!==i&&void 0!==a)return d(i,a,f)}}:d(h,p,f)}function rp(r,n,i){return"color"===n.type?i=tJ.parse(i):"formatted"===n.type?i=t$.fromString(i.toString()):"resolvedImage"===n.type?i=t0.fromString(i.toString()):ro(i)===n.type||"enum"===n.type&&n.values[i]||(i=void 0),rc(i,r.default,n.default)}ea.register(e8,{error:[{kind:"error"},[tD],function(r,n){throw new t6(n[0].evaluate(r))}],typeof:[tD,[tN],function(r,n){return tq(t3(n[0].evaluate(r)))}],"to-rgba":[tH(tz,4),[tF],function(r,n){return n[0].evaluate(r).toArray()}],rgb:[tF,[tz,tz,tz],e9],rgba:[tF,[tz,tz,tz,tz],e9],has:{type:tR,overloads:[[[tD],function(r,n){return n[0].evaluate(r) in r.properties()}],[[tD,tB],function(r,n){var i=n[0],a=n[1];return i.evaluate(r) in a.evaluate(r)}]]},get:{type:tN,overloads:[[[tD],function(r,n){return e7(n[0].evaluate(r),r.properties())}],[[tD,tB],function(r,n){var i=n[0],a=n[1];return e7(i.evaluate(r),a.evaluate(r))}]]},"feature-state":[tN,[tD],function(r,n){return e7(n[0].evaluate(r),r.featureState||{})}],properties:[tB,[],function(r){return r.properties()}],"geometry-type":[tD,[],function(r){return r.geometryType()}],id:[tN,[],function(r){return r.id()}],zoom:[tz,[],function(r){return r.globals.zoom}],"heatmap-density":[tz,[],function(r){return r.globals.heatmapDensity||0}],"line-progress":[tz,[],function(r){return r.globals.lineProgress||0}],accumulated:[tN,[],function(r){return void 0===r.globals.accumulated?null:r.globals.accumulated}],"+":[tz,rt(tz),function(r,n){for(var i=0,a=0;a<n.length;a+=1)i+=n[a].evaluate(r);return i}],"*":[tz,rt(tz),function(r,n){for(var i=1,a=0;a<n.length;a+=1)i*=n[a].evaluate(r);return i}],"-":{type:tz,overloads:[[[tz,tz],function(r,n){var i=n[0],a=n[1];return i.evaluate(r)-a.evaluate(r)}],[[tz],function(r,n){return-n[0].evaluate(r)}]]},"/":[tz,[tz,tz],function(r,n){var i=n[0],a=n[1];return i.evaluate(r)/a.evaluate(r)}],"%":[tz,[tz,tz],function(r,n){var i=n[0],a=n[1];return i.evaluate(r)%a.evaluate(r)}],ln2:[tz,[],function(){return Math.LN2}],pi:[tz,[],function(){return Math.PI}],e:[tz,[],function(){return Math.E}],"^":[tz,[tz,tz],function(r,n){var i=n[0],a=n[1];return Math.pow(i.evaluate(r),a.evaluate(r))}],sqrt:[tz,[tz],function(r,n){return Math.sqrt(n[0].evaluate(r))}],log10:[tz,[tz],function(r,n){return Math.log(n[0].evaluate(r))/Math.LN10}],ln:[tz,[tz],function(r,n){return Math.log(n[0].evaluate(r))}],log2:[tz,[tz],function(r,n){return Math.log(n[0].evaluate(r))/Math.LN2}],sin:[tz,[tz],function(r,n){return Math.sin(n[0].evaluate(r))}],cos:[tz,[tz],function(r,n){return Math.cos(n[0].evaluate(r))}],tan:[tz,[tz],function(r,n){return Math.tan(n[0].evaluate(r))}],asin:[tz,[tz],function(r,n){return Math.asin(n[0].evaluate(r))}],acos:[tz,[tz],function(r,n){return Math.acos(n[0].evaluate(r))}],atan:[tz,[tz],function(r,n){return Math.atan(n[0].evaluate(r))}],min:[tz,rt(tz),function(r,n){return Math.min.apply(Math,n.map(function(n){return n.evaluate(r)}))}],max:[tz,rt(tz),function(r,n){return Math.max.apply(Math,n.map(function(n){return n.evaluate(r)}))}],abs:[tz,[tz],function(r,n){return Math.abs(n[0].evaluate(r))}],round:[tz,[tz],function(r,n){var i=n[0].evaluate(r);return i<0?-Math.round(-i):Math.round(i)}],floor:[tz,[tz],function(r,n){return Math.floor(n[0].evaluate(r))}],ceil:[tz,[tz],function(r,n){return Math.ceil(n[0].evaluate(r))}],"filter-==":[tR,[tD,tN],function(r,n){var i=n[0],a=n[1];return r.properties()[i.value]===a.value}],"filter-id-==":[tR,[tN],function(r,n){var i=n[0];return r.id()===i.value}],"filter-type-==":[tR,[tD],function(r,n){var i=n[0];return r.geometryType()===i.value}],"filter-<":[tR,[tD,tN],function(r,n){var i=n[0],a=n[1],o=r.properties()[i.value],s=a.value;return typeof o==typeof s&&o<s}],"filter-id-<":[tR,[tN],function(r,n){var i=n[0],a=r.id(),o=i.value;return typeof a==typeof o&&a<o}],"filter->":[tR,[tD,tN],function(r,n){var i=n[0],a=n[1],o=r.properties()[i.value],s=a.value;return typeof o==typeof s&&o>s}],"filter-id->":[tR,[tN],function(r,n){var i=n[0],a=r.id(),o=i.value;return typeof a==typeof o&&a>o}],"filter-<=":[tR,[tD,tN],function(r,n){var i=n[0],a=n[1],o=r.properties()[i.value],s=a.value;return typeof o==typeof s&&o<=s}],"filter-id-<=":[tR,[tN],function(r,n){var i=n[0],a=r.id(),o=i.value;return typeof a==typeof o&&a<=o}],"filter->=":[tR,[tD,tN],function(r,n){var i=n[0],a=n[1],o=r.properties()[i.value],s=a.value;return typeof o==typeof s&&o>=s}],"filter-id->=":[tR,[tN],function(r,n){var i=n[0],a=r.id(),o=i.value;return typeof a==typeof o&&a>=o}],"filter-has":[tR,[tN],function(r,n){return n[0].value in r.properties()}],"filter-has-id":[tR,[],function(r){return null!==r.id()&&void 0!==r.id()}],"filter-type-in":[tR,[tH(tD)],function(r,n){return n[0].value.indexOf(r.geometryType())>=0}],"filter-id-in":[tR,[tH(tN)],function(r,n){return n[0].value.indexOf(r.id())>=0}],"filter-in-small":[tR,[tD,tH(tN)],function(r,n){var i=n[0];return n[1].value.indexOf(r.properties()[i.value])>=0}],"filter-in-large":[tR,[tD,tH(tN)],function(r,n){var i=n[0],a=n[1];return function(r,n,i,a){for(;i<=a;){var o=i+a>>1;if(n[o]===r)return!0;n[o]>r?a=o-1:i=o+1}return!1}(r.properties()[i.value],a.value,0,a.value.length-1)}],all:{type:tR,overloads:[[[tR,tR],function(r,n){var i=n[0],a=n[1];return i.evaluate(r)&&a.evaluate(r)}],[rt(tR),function(r,n){for(var i=0;i<n.length;i+=1)if(!n[i].evaluate(r))return!1;return!0}]]},any:{type:tR,overloads:[[[tR,tR],function(r,n){var i=n[0],a=n[1];return i.evaluate(r)||a.evaluate(r)}],[rt(tR),function(r,n){for(var i=0;i<n.length;i+=1)if(n[i].evaluate(r))return!0;return!1}]]},"!":[tR,[tR],function(r,n){return!n[0].evaluate(r)}],"is-supported-script":[tR,[tD],function(r,n){var i=n[0],a=r.globals&&r.globals.isSupportedScript;return!a||a(i.evaluate(r))}],upcase:[tD,[tD],function(r,n){return n[0].evaluate(r).toUpperCase()}],downcase:[tD,[tD],function(r,n){return n[0].evaluate(r).toLowerCase()}],concat:[tD,rt(tN),function(r,n){return n.map(function(n){return t5(n.evaluate(r))}).join("")}],"resolved-locale":[tD,[tj],function(r,n){return n[0].evaluate(r).resolvedLocale()}]});var rd=function(r,n){this.expression=r,this._warningHistory={},this._evaluator=new ei,this._defaultValue=n?"color"===n.type&&rs(n.default)?new tJ(0,0,0,0):"color"===n.type?tJ.parse(n.default)||null:void 0===n.default?null:n.default:null,this._enumValues=n&&"enum"===n.type?n.values:null};function rm(r){return Array.isArray(r)&&r.length>0&&"string"==typeof r[0]&&r[0]in e8}function rg(r,n){var i,a=new ew(e8,[],n?(i={color:tF,string:tD,number:tz,enum:tD,boolean:tR,formatted:tU,resolvedImage:tV},"array"===n.type?tH(i[n.value]||tN,n.length):i[n.type]):void 0),o=a.parse(r,void 0,void 0,void 0,n&&"string"===n.type?{typeAnnotation:"coerce"}:void 0);return o?re(new rd(o,n)):rr(a.errors)}rd.prototype.evaluateWithoutErrorHandling=function(r,n,i,a,o,s){return this._evaluator.globals=r,this._evaluator.feature=n,this._evaluator.featureState=i,this._evaluator.canonical=a,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=s,this.expression.evaluate(this._evaluator)},rd.prototype.evaluate=function(r,n,i,a,o,s){this._evaluator.globals=r,this._evaluator.feature=n||null,this._evaluator.featureState=i||null,this._evaluator.canonical=a,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=s||null;try{var l=this.expression.evaluate(this._evaluator);if(null==l||"number"==typeof l&&l!=l)return this._defaultValue;if(this._enumValues&&!(l in this._enumValues))throw new t6("Expected value to be one of "+Object.keys(this._enumValues).map(function(r){return JSON.stringify(r)}).join(", ")+", but found "+JSON.stringify(l)+" instead.");return l}catch(r){return this._warningHistory[r.message]||(this._warningHistory[r.message]=!0,"undefined"!=typeof console&&console.warn(r.message)),this._defaultValue}};var rv=function(r,n){this.kind=r,this._styleExpression=n,this.isStateDependent="constant"!==r&&!ex(n.expression)};rv.prototype.evaluateWithoutErrorHandling=function(r,n,i,a,o,s){return this._styleExpression.evaluateWithoutErrorHandling(r,n,i,a,o,s)},rv.prototype.evaluate=function(r,n,i,a,o,s){return this._styleExpression.evaluate(r,n,i,a,o,s)};var ry=function(r,n,i,a){this.kind=r,this.zoomStops=i,this._styleExpression=n,this.isStateDependent="camera"!==r&&!ex(n.expression),this.interpolationType=a};function rx(r,n){if("error"===(r=rg(r,n)).result)return r;var i=r.value.expression,a=ey(i);if(!a&&!rn(n))return rr([new tP("","data expressions not supported")]);var o=eb(i,["zoom"]);if(!o&&!ri(n))return rr([new tP("","zoom expressions not supported")]);var s=function r(n){var i=null;if(n instanceof eH)i=r(n.result);else if(n instanceof eV)for(var a=0,o=n.args;a<o.length&&!(i=r(o[a]));a+=1);else(n instanceof ek||n instanceof ej)&&n.input instanceof ea&&"zoom"===n.input.name&&(i=n);return i instanceof tP||n.eachChild(function(n){var a=r(n);a instanceof tP?i=a:!i&&a?i=new tP("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&a&&i!==a&&(i=new tP("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}(i);if(!s&&!o)return rr([new tP("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(s instanceof tP)return rr([s]);if(s instanceof ej&&!ra(n))return rr([new tP("",'"interpolate" expressions cannot be used with this property')]);if(!s)return re(new rv(a?"constant":"source",r.value));var l=s instanceof ej?s.interpolation:void 0;return re(new ry(a?"camera":"composite",r.value,s.labels,l))}ry.prototype.evaluateWithoutErrorHandling=function(r,n,i,a,o,s){return this._styleExpression.evaluateWithoutErrorHandling(r,n,i,a,o,s)},ry.prototype.evaluate=function(r,n,i,a,o,s){return this._styleExpression.evaluate(r,n,i,a,o,s)},ry.prototype.interpolationFactor=function(r,n,i){return this.interpolationType?ej.interpolationFactor(this.interpolationType,r,n,i):0};var rb=function(r,n){this._parameters=r,this._specification=n,tE(this,function r(n,i){var a,o,s,l="color"===i.type,c=n.stops&&"object"==typeof n.stops[0][0],u=c||void 0!==n.property,f=n.type||(ra(i)?"exponential":"interval");if(l&&((n=tE({},n)).stops&&(n.stops=n.stops.map(function(r){return[r[0],tJ.parse(r[1])]})),n.default?n.default=tJ.parse(n.default):n.default=tJ.parse(i.default)),n.colorSpace&&"rgb"!==n.colorSpace&&!eN[n.colorSpace])throw Error("Unknown color space: "+n.colorSpace);if("exponential"===f)a=rh;else if("interval"===f)a=rf;else if("categorical"===f){a=ru,o=Object.create(null);for(var h=0,p=n.stops;h<p.length;h+=1){var d=p[h];o[d[0]]=d[1]}s=typeof n.stops[0][0]}else{if("identity"!==f)throw Error('Unknown function type "'+f+'"');a=rp}if(c){for(var m={},g=[],v=0;v<n.stops.length;v++){var y=n.stops[v],x=y[0].zoom;void 0===m[x]&&(m[x]={zoom:x,type:n.type,property:n.property,default:n.default,stops:[]},g.push(x)),m[x].stops.push([y[0].value,y[1]])}for(var b=[],_=0;_<g.length;_+=1){var w=g[_];b.push([m[w].zoom,r(m[w],i)])}var T={name:"linear"};return{kind:"composite",interpolationType:T,interpolationFactor:ej.interpolationFactor.bind(void 0,T),zoomStops:b.map(function(r){return r[0]}),evaluate:function(r,a){var o=r.zoom;return rh({stops:b,base:n.base},i,o).evaluate(o,a)}}}if(c||!u){var k="exponential"===f?{name:"exponential",base:void 0!==n.base?n.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:ej.interpolationFactor.bind(void 0,k),zoomStops:n.stops.map(function(r){return r[0]}),evaluate:function(r){var l=r.zoom;return a(n,i,l,o,s)}}}return{kind:"source",evaluate:function(r,l){var c=l&&l.properties?l.properties[n.property]:void 0;return void 0===c?rc(n.default,i.default):a(n,i,c,o,s)}}}(this._parameters,this._specification))};function r_(r){var n=r.key,i=r.value,a=r.valueSpec||{},o=r.objectElementValidators||{},s=r.style,l=r.styleSpec,c=[],u=ro(i);if("object"!==u)return[new tM(n,i,"object expected, "+u+" found")];for(var f in i){var h=f.split(".")[0],p=a[h]||a["*"],d=void 0;if(o[h])d=o[h];else if(a[h])d=rG;else if(o["*"])d=o["*"];else{if(!a["*"]){c.push(new tM(n,i[f],'unknown property "'+f+'"'));continue}d=rG}c=c.concat(d({key:(n?n+".":n)+f,value:i[f],valueSpec:p,style:s,styleSpec:l,object:i,objectKey:f},i))}for(var m in a)o[m]||a[m].required&&void 0===a[m].default&&void 0===i[m]&&c.push(new tM(n,i,'missing required property "'+m+'"'));return c}function rw(r){var n=r.value,i=r.valueSpec,a=r.style,o=r.styleSpec,s=r.key,l=r.arrayElementValidator||rG;if("array"!==ro(n))return[new tM(s,n,"array expected, "+ro(n)+" found")];if(i.length&&n.length!==i.length)return[new tM(s,n,"array length "+i.length+" expected, length "+n.length+" found")];if(i["min-length"]&&n.length<i["min-length"])return[new tM(s,n,"array length at least "+i["min-length"]+" expected, length "+n.length+" found")];var c={type:i.value,values:i.values};o.$version<7&&(c.function=i.function),"object"===ro(i.value)&&(c=i.value);for(var u=[],f=0;f<n.length;f++)u=u.concat(l({array:n,arrayIndex:f,value:n[f],valueSpec:c,style:a,styleSpec:o,key:s+"["+f+"]"}));return u}function rT(r){var n=r.key,i=r.value,a=r.valueSpec,o=ro(i);return"number"===o&&i!=i&&(o="NaN"),"number"!==o?[new tM(n,i,"number expected, "+o+" found")]:"minimum"in a&&i<a.minimum?[new tM(n,i,i+" is less than the minimum value "+a.minimum)]:"maximum"in a&&i>a.maximum?[new tM(n,i,i+" is greater than the maximum value "+a.maximum)]:[]}function rk(r){var n,i,a,o=r.valueSpec,s=tL(r.value.type),l={},c="categorical"!==s&&void 0===r.value.property,u="array"===ro(r.value.stops)&&"array"===ro(r.value.stops[0])&&"object"===ro(r.value.stops[0][0]),f=r_({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(r){if("identity"===s)return[new tM(r.key,r.value,'identity function may not have a "stops" property')];var n=[],i=r.value;return n=n.concat(rw({key:r.key,value:i,valueSpec:r.valueSpec,style:r.style,styleSpec:r.styleSpec,arrayElementValidator:h})),"array"===ro(i)&&0===i.length&&n.push(new tM(r.key,i,"array must have at least one stop")),n},default:function(r){return rG({key:r.key,value:r.value,valueSpec:o,style:r.style,styleSpec:r.styleSpec})}}});return"identity"===s&&c&&f.push(new tM(r.key,r.value,'missing required property "property"')),"identity"===s||r.value.stops||f.push(new tM(r.key,r.value,'missing required property "stops"')),"exponential"===s&&r.valueSpec.expression&&!ra(r.valueSpec)&&f.push(new tM(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(c||rn(r.valueSpec)?c&&!ri(r.valueSpec)&&f.push(new tM(r.key,r.value,"zoom functions not supported")):f.push(new tM(r.key,r.value,"property functions not supported"))),("categorical"===s||u)&&void 0===r.value.property&&f.push(new tM(r.key,r.value,'"property" property is required')),f;function h(r){var n=[],s=r.value,c=r.key;if("array"!==ro(s))return[new tM(c,s,"array expected, "+ro(s)+" found")];if(2!==s.length)return[new tM(c,s,"array length 2 expected, length "+s.length+" found")];if(u){if("object"!==ro(s[0]))return[new tM(c,s,"object expected, "+ro(s[0])+" found")];if(void 0===s[0].zoom)return[new tM(c,s,"object stop key must have zoom")];if(void 0===s[0].value)return[new tM(c,s,"object stop key must have value")];if(a&&a>tL(s[0].zoom))return[new tM(c,s[0].zoom,"stop zoom values must appear in ascending order")];tL(s[0].zoom)!==a&&(a=tL(s[0].zoom),i=void 0,l={}),n=n.concat(r_({key:c+"[0]",value:s[0],valueSpec:{zoom:{}},style:r.style,styleSpec:r.styleSpec,objectElementValidators:{zoom:rT,value:p}}))}else n=n.concat(p({key:c+"[0]",value:s[0],valueSpec:{},style:r.style,styleSpec:r.styleSpec},s));return rm(tC(s[1]))?n.concat([new tM(c+"[1]",s[1],"expressions are not allowed in function stops.")]):n.concat(rG({key:c+"[1]",value:s[1],valueSpec:o,style:r.style,styleSpec:r.styleSpec}))}function p(r,a){var c=ro(r.value),u=tL(r.value),f=null!==r.value?r.value:a;if(n){if(c!==n)return[new tM(r.key,f,c+" stop domain type must match previous stop domain type "+n)]}else n=c;if("number"!==c&&"string"!==c&&"boolean"!==c)return[new tM(r.key,f,"stop domain value must be a number, string, or boolean")];if("number"!==c&&"categorical"!==s){var h="number expected, "+c+" found";return rn(o)&&void 0===s&&(h+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new tM(r.key,f,h)]}return"categorical"!==s||"number"!==c||isFinite(u)&&Math.floor(u)===u?"categorical"!==s&&"number"===c&&void 0!==i&&u<i?[new tM(r.key,f,"stop domain values must appear in ascending order")]:(i=u,"categorical"===s&&u in l?[new tM(r.key,f,"stop domain values must be unique")]:(l[u]=!0,[])):[new tM(r.key,f,"integer expected, found "+u)]}}function rA(r){var n=("property"===r.expressionContext?rx:rg)(tC(r.value),r.valueSpec);if("error"===n.result)return n.value.map(function(n){return new tM(""+r.key+n.key,r.value,n.message)});var i=n.value.expression||n.value._styleExpression.expression;if("property"===r.expressionContext&&"text-font"===r.propertyKey&&!i.outputDefined())return[new tM(r.key,r.value,'Invalid data expression for "'+r.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===r.expressionContext&&"layout"===r.propertyType&&!ex(i))return[new tM(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===r.expressionContext&&!ex(i))return[new tM(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&0===r.expressionContext.indexOf("cluster")){if(!eb(i,["zoom","feature-state"]))return[new tM(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===r.expressionContext&&!ey(i))return[new tM(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function rM(r){var n=r.key,i=r.value,a=r.valueSpec,o=[];return Array.isArray(a.values)?-1===a.values.indexOf(tL(i))&&o.push(new tM(n,i,"expected one of ["+a.values.join(", ")+"], "+JSON.stringify(i)+" found")):-1===Object.keys(a.values).indexOf(tL(i))&&o.push(new tM(n,i,"expected one of ["+Object.keys(a.values).join(", ")+"], "+JSON.stringify(i)+" found")),o}function rS(r){if(!0===r||!1===r)return!0;if(!Array.isArray(r)||0===r.length)return!1;switch(r[0]){case"has":return r.length>=2&&"$id"!==r[1]&&"$type"!==r[1];case"in":return r.length>=3&&("string"!=typeof r[1]||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==r.length||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(var n=0,i=r.slice(1);n<i.length;n+=1){var a=i[n];if(!rS(a)&&"boolean"!=typeof a)return!1}return!0;default:return!0}}rb.deserialize=function(r){return new rb(r._parameters,r._specification)},rb.serialize=function(r){return{_parameters:r._parameters,_specification:r._specification}};var rE={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function rL(r){if(null==r)return{filter:function(){return!0},needGeometry:!1};rS(r)||(r=function r(n){if(!n)return!0;var i=n[0];return n.length<=1?"any"!==i:"=="===i?rP(n[1],n[2],"=="):"!="===i?rz(rP(n[1],n[2],"==")):"<"===i||">"===i||"<="===i||">="===i?rP(n[1],n[2],i):"any"===i?["any"].concat(n.slice(1).map(r)):"all"===i?["all"].concat(n.slice(1).map(r)):"none"===i?["all"].concat(n.slice(1).map(r).map(rz)):"in"===i?rI(n[1],n.slice(2)):"!in"===i?rz(rI(n[1],n.slice(2))):"has"===i?rO(n[1]):"!has"===i?rz(rO(n[1])):"within"!==i||n}(r));var n=rg(r,rE);if("error"===n.result)throw Error(n.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,i,a){return n.value.evaluate(r,i,{},a)},needGeometry:function r(n){if(!Array.isArray(n))return!1;if("within"===n[0])return!0;for(var i=1;i<n.length;i++)if(r(n[i]))return!0;return!1}(r)}}function rC(r,n){return r<n?-1:r>n?1:0}function rP(r,n,i){switch(r){case"$type":return["filter-type-"+i,n];case"$id":return["filter-id-"+i,n];default:return["filter-"+i,r,n]}}function rI(r,n){if(0===n.length)return!1;switch(r){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(function(r){return typeof r!=typeof n[0]})?["filter-in-large",r,["literal",n.sort(rC)]]:["filter-in-small",r,["literal",n]]}}function rO(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function rz(r){return["!",r]}function rD(r){return rS(tC(r.value))?rA(tE({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function r(n){var i=n.value,a=n.key;if("array"!==ro(i))return[new tM(a,i,"array expected, "+ro(i)+" found")];var o,s=n.styleSpec,l=[];if(i.length<1)return[new tM(a,i,"filter array must have at least 1 element")];switch(l=l.concat(rM({key:a+"[0]",value:i[0],valueSpec:s.filter_operator,style:n.style,styleSpec:n.styleSpec})),tL(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===tL(i[1])&&l.push(new tM(a,i,'"$type" cannot be use with operator "'+i[0]+'"'));case"==":case"!=":3!==i.length&&l.push(new tM(a,i,'filter array for operator "'+i[0]+'" must have 3 elements'));case"in":case"!in":i.length>=2&&"string"!==(o=ro(i[1]))&&l.push(new tM(a+"[1]",i[1],"string expected, "+o+" found"));for(var c=2;c<i.length;c++)o=ro(i[c]),"$type"===tL(i[1])?l=l.concat(rM({key:a+"["+c+"]",value:i[c],valueSpec:s.geometry_type,style:n.style,styleSpec:n.styleSpec})):"string"!==o&&"number"!==o&&"boolean"!==o&&l.push(new tM(a+"["+c+"]",i[c],"string, number, or boolean expected, "+o+" found"));break;case"any":case"all":case"none":for(var u=1;u<i.length;u++)l=l.concat(r({key:a+"["+u+"]",value:i[u],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":o=ro(i[1]),2!==i.length?l.push(new tM(a,i,'filter array for "'+i[0]+'" operator must have 2 elements')):"string"!==o&&l.push(new tM(a+"[1]",i[1],"string expected, "+o+" found"));break;case"within":o=ro(i[1]),2!==i.length?l.push(new tM(a,i,'filter array for "'+i[0]+'" operator must have 2 elements')):"object"!==o&&l.push(new tM(a+"[1]",i[1],"object expected, "+o+" found"))}return l}(r)}function rR(r,n){var i=r.key,a=r.style,o=r.styleSpec,s=r.value,l=r.objectKey,c=o[n+"_"+r.layerType];if(!c)return[];var u=l.match(/^(.*)-transition$/);if("paint"===n&&u&&c[u[1]]&&c[u[1]].transition)return rG({key:i,value:s,valueSpec:o.transition,style:a,styleSpec:o});var f,h=r.valueSpec||c[l];if(!h)return[new tM(i,s,'unknown property "'+l+'"')];if("string"===ro(s)&&rn(h)&&!h.tokens&&(f=/^{([^}]+)}$/.exec(s)))return[new tM(i,s,'"'+l+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(f[1])+" }`.")];var p=[];return"symbol"===r.layerType&&("text-field"===l&&a&&!a.glyphs&&p.push(new tM(i,s,'use of "text-field" requires a style "glyphs" property')),"text-font"===l&&rs(tC(s))&&"identity"===tL(s.type)&&p.push(new tM(i,s,'"text-font" does not support identity functions'))),p.concat(rG({key:r.key,value:s,valueSpec:h,style:a,styleSpec:o,expressionContext:"property",propertyType:n,propertyKey:l}))}function rF(r){return rR(r,"paint")}function rB(r){return rR(r,"layout")}function rN(r){var n=[],i=r.value,a=r.key,o=r.style,s=r.styleSpec;i.type||i.ref||n.push(new tM(a,i,'either "type" or "ref" is required'));var l,c=tL(i.type),u=tL(i.ref);if(i.id)for(var f=tL(i.id),h=0;h<r.arrayIndex;h++){var p=o.layers[h];tL(p.id)===f&&n.push(new tM(a,i.id,'duplicate layer id "'+i.id+'", previously used at line '+p.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(r){r in i&&n.push(new tM(a,i[r],'"'+r+'" is prohibited for ref layers'))}),o.layers.forEach(function(r){tL(r.id)===u&&(l=r)}),l?l.ref?n.push(new tM(a,i.ref,"ref cannot reference another ref layer")):c=tL(l.type):n.push(new tM(a,i.ref,'ref layer "'+u+'" not found'));else if("background"!==c){if(i.source){var d=o.sources&&o.sources[i.source],m=d&&tL(d.type);d?"vector"===m&&"raster"===c?n.push(new tM(a,i.source,'layer "'+i.id+'" requires a raster source')):"raster"===m&&"raster"!==c?n.push(new tM(a,i.source,'layer "'+i.id+'" requires a vector source')):"vector"!==m||i["source-layer"]?"raster-dem"===m&&"hillshade"!==c?n.push(new tM(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"===c&&i.paint&&i.paint["line-gradient"]&&("geojson"!==m||!d.lineMetrics)&&n.push(new tM(a,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):n.push(new tM(a,i,'layer "'+i.id+'" must specify a "source-layer"')):n.push(new tM(a,i.source,'source "'+i.source+'" not found'))}else n.push(new tM(a,i,'missing required property "source"'))}return n=n.concat(r_({key:a,value:i,valueSpec:s.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return rG({key:a+".type",value:i.type,valueSpec:s.layer.type,style:r.style,styleSpec:r.styleSpec,object:i,objectKey:"type"})},filter:rD,layout:function(r){return r_({layer:i,key:r.key,value:r.value,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":function(r){return rB(tE({layerType:c},r))}}})},paint:function(r){return r_({layer:i,key:r.key,value:r.value,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":function(r){return rF(tE({layerType:c},r))}}})}}}))}function rj(r){var n=r.value,i=r.key,a=ro(n);return"string"!==a?[new tM(i,n,"string expected, "+a+" found")]:[]}var rU={promoteId:function(r){var n=r.key,i=r.value;if("string"===ro(i))return rj({key:n,value:i});var a=[];for(var o in i)a.push.apply(a,rj({key:n+"."+o,value:i[o]}));return a}};function rV(r){var n=r.value,i=r.key,a=r.styleSpec,o=r.style;if(!n.type)return[new tM(i,n,'"type" is required')];var s,l=tL(n.type);switch(l){case"vector":case"raster":case"raster-dem":return r_({key:i,value:n,valueSpec:a["source_"+l.replace("-","_")],style:r.style,styleSpec:a,objectElementValidators:rU});case"geojson":if(s=r_({key:i,value:n,valueSpec:a.source_geojson,style:o,styleSpec:a,objectElementValidators:rU}),n.cluster)for(var c in n.clusterProperties){var u=n.clusterProperties[c],f=u[0],h=u[1],p="string"==typeof f?[f,["accumulated"],["get",c]]:f;s.push.apply(s,rA({key:i+"."+c+".map",value:h,expressionContext:"cluster-map"})),s.push.apply(s,rA({key:i+"."+c+".reduce",value:p,expressionContext:"cluster-reduce"}))}return s;case"video":return r_({key:i,value:n,valueSpec:a.source_video,style:o,styleSpec:a});case"image":return r_({key:i,value:n,valueSpec:a.source_image,style:o,styleSpec:a});case"canvas":return[new tM(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return rM({key:i+".type",value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:o,styleSpec:a})}}function rH(r){var n=r.value,i=r.styleSpec,a=i.light,o=r.style,s=[],l=ro(n);if(void 0===n)return s;if("object"!==l)return s.concat([new tM("light",n,"object expected, "+l+" found")]);for(var c in n){var u=c.match(/^(.*)-transition$/);s=u&&a[u[1]]&&a[u[1]].transition?s.concat(rG({key:c,value:n[c],valueSpec:i.transition,style:o,styleSpec:i})):a[c]?s.concat(rG({key:c,value:n[c],valueSpec:a[c],style:o,styleSpec:i})):s.concat([new tM(c,n[c],'unknown property "'+c+'"')])}return s}var rq={"*":function(){return[]},array:rw,boolean:function(r){var n=r.value,i=r.key,a=ro(n);return"boolean"!==a?[new tM(i,n,"boolean expected, "+a+" found")]:[]},number:rT,color:function(r){var n=r.key,i=r.value,a=ro(i);return"string"!==a?[new tM(n,i,"color expected, "+a+" found")]:null===tZ(i)?[new tM(n,i,'color expected, "'+i+'" found')]:[]},constants:tS,enum:rM,filter:rD,function:rk,layer:rN,object:r_,source:rV,light:rH,string:rj,formatted:function(r){return 0===rj(r).length?[]:rA(r)},resolvedImage:function(r){return 0===rj(r).length?[]:rA(r)}};function rG(r){var n=r.value,i=r.valueSpec,a=r.styleSpec;return i.expression&&rs(tL(n))?rk(r):i.expression&&rm(tC(n))?rA(r):i.type&&rq[i.type]?rq[i.type](r):r_(tE({},r,{valueSpec:i.type?a[i.type]:i}))}function rY(r){var n=r.value,i=r.key,a=rj(r);return a.length||(-1===n.indexOf("{fontstack}")&&a.push(new tM(i,n,'"glyphs" url must include a "{fontstack}" token')),-1===n.indexOf("{range}")&&a.push(new tM(i,n,'"glyphs" url must include a "{range}" token'))),a}function rW(r,n){void 0===n&&(n=tA);var i=[];return i=i.concat(rG({key:"",value:r,valueSpec:n.$root,styleSpec:n,style:r,objectElementValidators:{glyphs:rY,"*":function(){return[]}}})),r.constants&&(i=i.concat(tS({key:"constants",value:r.constants,style:r,styleSpec:n}))),rX(i)}function rX(r){return[].concat(r).sort(function(r,n){return r.line-n.line})}function rZ(r){return function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];return rX(r.apply(this,n))}}rW.source=rZ(rV),rW.light=rZ(rH),rW.layer=rZ(rN),rW.filter=rZ(rD),rW.paintProperty=rZ(rF),rW.layoutProperty=rZ(rB);var rJ=rW.light,rK=rW.paintProperty,rQ=rW.layoutProperty;function r$(r,n){var i=!1;if(n&&n.length)for(var a=0;a<n.length;a+=1){var o=n[a];r.fire(new tT(Error(o.message))),i=!0}return i}function r0(r,n,i){var a=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var o=new Int32Array(this.arrayBuffer);r=o[0],n=o[1],i=o[2],this.d=n+2*i;for(var s=0;s<this.d*this.d;s++){var l=o[3+s],c=o[3+s+1];a.push(l===c?null:o.subarray(l,c))}var u=o[3+a.length],f=o[3+a.length+1];this.keys=o.subarray(u,f),this.bboxes=o.subarray(f),this.insert=this._insertReadonly}else{this.d=n+2*i;for(var h=0;h<this.d*this.d;h++)a.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=r,this.padding=i,this.scale=n/r,this.uid=0;var p=i/n*r;this.min=-p,this.max=r+p}r0.prototype.insert=function(r,n,i,a,o){this._forEachCell(n,i,a,o,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(o)},r0.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},r0.prototype._insertCell=function(r,n,i,a,o,s){this.cells[o].push(s)},r0.prototype.query=function(r,n,i,a,o){var s=this.min,l=this.max;if(r<=s&&n<=s&&l<=i&&l<=a&&!o)return Array.prototype.slice.call(this.keys);var c=[];return this._forEachCell(r,n,i,a,this._queryCell,c,{},o),c},r0.prototype._queryCell=function(r,n,i,a,o,s,l,c){var u=this.cells[o];if(null!==u)for(var f=this.keys,h=this.bboxes,p=0;p<u.length;p++){var d=u[p];if(void 0===l[d]){var m=4*d;(c?c(h[m+0],h[m+1],h[m+2],h[m+3]):r<=h[m+2]&&n<=h[m+3]&&i>=h[m+0]&&a>=h[m+1])?(l[d]=!0,s.push(f[d])):l[d]=!1}}},r0.prototype._forEachCell=function(r,n,i,a,o,s,l,c){for(var u=this._convertToCellCoord(r),f=this._convertToCellCoord(n),h=this._convertToCellCoord(i),p=this._convertToCellCoord(a),d=u;d<=h;d++)for(var m=f;m<=p;m++){var g=this.d*m+d;if((!c||c(this._convertFromCellCoord(d),this._convertFromCellCoord(m),this._convertFromCellCoord(d+1),this._convertFromCellCoord(m+1)))&&o.call(this,r,n,i,a,g,s,l,c))return}},r0.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},r0.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},r0.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,n=3+this.cells.length+1+1,i=0,a=0;a<this.cells.length;a++)i+=this.cells[a].length;var o=new Int32Array(n+i+this.keys.length+this.bboxes.length);o[0]=this.extent,o[1]=this.n,o[2]=this.padding;for(var s=n,l=0;l<r.length;l++){var c=r[l];o[3+l]=s,o.set(c,s),s+=c.length}return o[3+r.length]=s,o.set(this.keys,s),s+=this.keys.length,o[3+r.length+1]=s,o.set(this.bboxes,s),s+=this.bboxes.length,o.buffer};var r1=self.ImageData,r2=self.ImageBitmap,r3={};function r5(r,n,i){void 0===i&&(i={}),Object.defineProperty(n,"_classRegistryKey",{value:r,writeable:!1}),r3[r]={klass:n,omit:i.omit||[],shallow:i.shallow||[]}}for(var r4 in r5("Object",Object),r0.serialize=function(r,n){var i=r.toArrayBuffer();return n&&n.push(i),{buffer:i}},r0.deserialize=function(r){return new r0(r.buffer)},r5("Grid",r0),r5("Color",tJ),r5("Error",Error),r5("ResolvedImage",t0),r5("StylePropertyFunction",rb),r5("StyleExpression",rd,{omit:["_evaluator"]}),r5("ZoomDependentExpression",ry),r5("ZoomConstantExpression",rv),r5("CompoundExpression",ea,{omit:["_evaluate"]}),e8)e8[r4]._classRegistryKey||r5("Expression_"+r4,e8[r4]);function r6(r){return r&&"undefined"!=typeof ArrayBuffer&&(r instanceof ArrayBuffer||r.constructor&&"ArrayBuffer"===r.constructor.name)}function r8(r){return r2&&r instanceof r2}function r9(r,n){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(r6(r)||r8(r))return n&&n.push(r),r;if(ArrayBuffer.isView(r))return n&&n.push(r.buffer),r;if(r instanceof r1)return n&&n.push(r.data.buffer),r;if(Array.isArray(r)){for(var i=[],a=0;a<r.length;a+=1){var o=r[a];i.push(r9(o,n))}return i}if("object"==typeof r){var s=r.constructor,l=s._classRegistryKey;if(!l)throw Error("can't serialize object of unregistered class");var c=s.serialize?s.serialize(r,n):{};if(!s.serialize){for(var u in r)if(r.hasOwnProperty(u)&&!(r3[l].omit.indexOf(u)>=0)){var f=r[u];c[u]=r3[l].shallow.indexOf(u)>=0?f:r9(f,n)}r instanceof Error&&(c.message=r.message)}if(c.$name)throw Error("$name property is reserved for worker serialization logic.");return"Object"!==l&&(c.$name=l),c}throw Error("can't serialize object of type "+typeof r)}function r7(r){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r6(r)||r8(r)||ArrayBuffer.isView(r)||r instanceof r1)return r;if(Array.isArray(r))return r.map(r7);if("object"==typeof r){var n=r.$name||"Object",i=r3[n].klass;if(!i)throw Error("can't deserialize unregistered class "+n);if(i.deserialize)return i.deserialize(r);for(var a=Object.create(i.prototype),o=0,s=Object.keys(r);o<s.length;o+=1){var l=s[o];if("$name"!==l){var c=r[l];a[l]=r3[n].shallow.indexOf(l)>=0?c:r7(c)}}return a}throw Error("can't deserialize object of type "+typeof r)}var nt=function(){this.first=!0};nt.prototype.update=function(r,n){var i=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=n),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=i,!0))};var ne={"Latin-1 Supplement":function(r){return r>=128&&r<=255},Arabic:function(r){return r>=1536&&r<=1791},"Arabic Supplement":function(r){return r>=1872&&r<=1919},"Arabic Extended-A":function(r){return r>=2208&&r<=2303},"Hangul Jamo":function(r){return r>=4352&&r<=4607},"Unified Canadian Aboriginal Syllabics":function(r){return r>=5120&&r<=5759},Khmer:function(r){return r>=6016&&r<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(r){return r>=6320&&r<=6399},"General Punctuation":function(r){return r>=8192&&r<=8303},"Letterlike Symbols":function(r){return r>=8448&&r<=8527},"Number Forms":function(r){return r>=8528&&r<=8591},"Miscellaneous Technical":function(r){return r>=8960&&r<=9215},"Control Pictures":function(r){return r>=9216&&r<=9279},"Optical Character Recognition":function(r){return r>=9280&&r<=9311},"Enclosed Alphanumerics":function(r){return r>=9312&&r<=9471},"Geometric Shapes":function(r){return r>=9632&&r<=9727},"Miscellaneous Symbols":function(r){return r>=9728&&r<=9983},"Miscellaneous Symbols and Arrows":function(r){return r>=11008&&r<=11263},"CJK Radicals Supplement":function(r){return r>=11904&&r<=12031},"Kangxi Radicals":function(r){return r>=12032&&r<=12255},"Ideographic Description Characters":function(r){return r>=12272&&r<=12287},"CJK Symbols and Punctuation":function(r){return r>=12288&&r<=12351},Hiragana:function(r){return r>=12352&&r<=12447},Katakana:function(r){return r>=12448&&r<=12543},Bopomofo:function(r){return r>=12544&&r<=12591},"Hangul Compatibility Jamo":function(r){return r>=12592&&r<=12687},Kanbun:function(r){return r>=12688&&r<=12703},"Bopomofo Extended":function(r){return r>=12704&&r<=12735},"CJK Strokes":function(r){return r>=12736&&r<=12783},"Katakana Phonetic Extensions":function(r){return r>=12784&&r<=12799},"Enclosed CJK Letters and Months":function(r){return r>=12800&&r<=13055},"CJK Compatibility":function(r){return r>=13056&&r<=13311},"CJK Unified Ideographs Extension A":function(r){return r>=13312&&r<=19903},"Yijing Hexagram Symbols":function(r){return r>=19904&&r<=19967},"CJK Unified Ideographs":function(r){return r>=19968&&r<=40959},"Yi Syllables":function(r){return r>=40960&&r<=42127},"Yi Radicals":function(r){return r>=42128&&r<=42191},"Hangul Jamo Extended-A":function(r){return r>=43360&&r<=43391},"Hangul Syllables":function(r){return r>=44032&&r<=55215},"Hangul Jamo Extended-B":function(r){return r>=55216&&r<=55295},"Private Use Area":function(r){return r>=57344&&r<=63743},"CJK Compatibility Ideographs":function(r){return r>=63744&&r<=64255},"Arabic Presentation Forms-A":function(r){return r>=64336&&r<=65023},"Vertical Forms":function(r){return r>=65040&&r<=65055},"CJK Compatibility Forms":function(r){return r>=65072&&r<=65103},"Small Form Variants":function(r){return r>=65104&&r<=65135},"Arabic Presentation Forms-B":function(r){return r>=65136&&r<=65279},"Halfwidth and Fullwidth Forms":function(r){return r>=65280&&r<=65519}};function nr(r){for(var n=0;n<r.length;n+=1)if(nn(r[n].charCodeAt(0)))return!0;return!1}function nn(r){return 746===r||747===r||!(r<4352)&&(!!ne["Bopomofo Extended"](r)||!!ne.Bopomofo(r)||!(!ne["CJK Compatibility Forms"](r)||r>=65097&&r<=65103)||!!ne["CJK Compatibility Ideographs"](r)||!!ne["CJK Compatibility"](r)||!!ne["CJK Radicals Supplement"](r)||!!ne["CJK Strokes"](r)||!(!ne["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||12336===r)||!!ne["CJK Unified Ideographs Extension A"](r)||!!ne["CJK Unified Ideographs"](r)||!!ne["Enclosed CJK Letters and Months"](r)||!!ne["Hangul Compatibility Jamo"](r)||!!ne["Hangul Jamo Extended-A"](r)||!!ne["Hangul Jamo Extended-B"](r)||!!ne["Hangul Jamo"](r)||!!ne["Hangul Syllables"](r)||!!ne.Hiragana(r)||!!ne["Ideographic Description Characters"](r)||!!ne.Kanbun(r)||!!ne["Kangxi Radicals"](r)||!!ne["Katakana Phonetic Extensions"](r)||!(!ne.Katakana(r)||12540===r)||!(!ne["Halfwidth and Fullwidth Forms"](r)||65288===r||65289===r||65293===r||r>=65306&&r<=65310||65339===r||65341===r||65343===r||r>=65371&&r<=65503||65507===r||r>=65512&&r<=65519)||!(!ne["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||!!ne["Unified Canadian Aboriginal Syllabics"](r)||!!ne["Unified Canadian Aboriginal Syllabics Extended"](r)||!!ne["Vertical Forms"](r)||!!ne["Yijing Hexagram Symbols"](r)||!!ne["Yi Syllables"](r)||!!ne["Yi Radicals"](r))}function ni(r){return!(nn(r)||!(!ne["Latin-1 Supplement"](r)||167!==r&&169!==r&&174!==r&&177!==r&&188!==r&&189!==r&&190!==r&&215!==r&&247!==r)||!(!ne["General Punctuation"](r)||8214!==r&&8224!==r&&8225!==r&&8240!==r&&8241!==r&&8251!==r&&8252!==r&&8258!==r&&8263!==r&&8264!==r&&8265!==r&&8273!==r)||ne["Letterlike Symbols"](r)||ne["Number Forms"](r)||!(!ne["Miscellaneous Technical"](r)||!(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||9003===r||r>=9085&&r<=9114||r>=9150&&r<=9165||9167===r||r>=9169&&r<=9179||r>=9186&&r<=9215))||!(!ne["Control Pictures"](r)||9251===r)||ne["Optical Character Recognition"](r)||ne["Enclosed Alphanumerics"](r)||ne["Geometric Shapes"](r)||!(!ne["Miscellaneous Symbols"](r)||r>=9754&&r<=9759)||!(!ne["Miscellaneous Symbols and Arrows"](r)||!(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243))||ne["CJK Symbols and Punctuation"](r)||ne.Katakana(r)||ne["Private Use Area"](r)||ne["CJK Compatibility Forms"](r)||ne["Small Form Variants"](r)||ne["Halfwidth and Fullwidth Forms"](r)||8734===r||8756===r||8757===r||r>=9984&&r<=10087||r>=10102&&r<=10131||65532===r||65533===r)}function na(r){return r>=1424&&r<=2303||ne["Arabic Presentation Forms-A"](r)||ne["Arabic Presentation Forms-B"](r)}var no="deferred",ns="loading",nl="loaded",nc=null,nu="unavailable",nf=null,nh=function(r){r&&"string"==typeof r&&r.indexOf("NetworkError")>-1&&(nu="error"),nc&&nc(r)};function np(){nd.fire(new tw("pluginStateChange",{pluginStatus:nu,pluginURL:nf}))}var nd=new tk,nm=function(){return nu},ng=function(){if(nu!==no||!nf)throw Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");nu=ns,np(),nf&&tv({url:nf},function(r){r?nh(r):(nu=nl,np())})},nv={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return nu===nl||null!=nv.applyArabicShaping},isLoading:function(){return nu===ns},setState:function(r){nu=r.pluginStatus,nf=r.pluginURL},isParsed:function(){return null!=nv.applyArabicShaping&&null!=nv.processBidirectionalText&&null!=nv.processStyledBidirectionalText},getPluginURL:function(){return nf}},ny=function(r,n){this.zoom=r,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new nt,this.transition={})};ny.prototype.isSupportedScript=function(r){return function(r,n){for(var i,a=0;a<r.length;a+=1)if(i=r[a].charCodeAt(0),!n&&na(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||ne.Khmer(i))return!1;return!0}(r,nv.isLoaded())},ny.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ny.prototype.getCrossfadeParameters=function(){var r=this.zoom,n=r-Math.floor(r),i=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*n}};var nx=function(r,n){this.property=r,this.value=n,this.expression=function(r,n){if(rs(r))return new rb(r,n);if(rm(r)){var i=rx(r,n);if("error"===i.result)throw Error(i.value.map(function(r){return r.key+": "+r.message}).join(", "));return i.value}var a=r;return"string"==typeof r&&"color"===n.type&&(a=tJ.parse(r)),{kind:"constant",evaluate:function(){return a}}}(void 0===n?r.specification.default:n,r.specification)};nx.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},nx.prototype.possiblyEvaluate=function(r,n,i){return this.property.possiblyEvaluate(this,r,n,i)};var nb=function(r){this.property=r,this.value=new nx(r,void 0)};nb.prototype.transitioned=function(r,n){return new nw(this.property,this.value,n,p({},r.transition,this.transition),r.now)},nb.prototype.untransitioned=function(){return new nw(this.property,this.value,null,{},0)};var n_=function(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)};n_.prototype.getValue=function(r){return w(this._values[r].value.value)},n_.prototype.setValue=function(r,n){this._values.hasOwnProperty(r)||(this._values[r]=new nb(this._values[r].property)),this._values[r].value=new nx(this._values[r].property,null===n?void 0:w(n))},n_.prototype.getTransition=function(r){return w(this._values[r].transition)},n_.prototype.setTransition=function(r,n){this._values.hasOwnProperty(r)||(this._values[r]=new nb(this._values[r].property)),this._values[r].transition=w(n)||void 0},n_.prototype.serialize=function(){for(var r={},n=0,i=Object.keys(this._values);n<i.length;n+=1){var a=i[n],o=this.getValue(a);void 0!==o&&(r[a]=o);var s=this.getTransition(a);void 0!==s&&(r[a+"-transition"]=s)}return r},n_.prototype.transitioned=function(r,n){for(var i=new nT(this._properties),a=0,o=Object.keys(this._values);a<o.length;a+=1){var s=o[a];i._values[s]=this._values[s].transitioned(r,n._values[s])}return i},n_.prototype.untransitioned=function(){for(var r=new nT(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var a=i[n];r._values[a]=this._values[a].untransitioned()}return r};var nw=function(r,n,i,a,o){this.property=r,this.value=n,this.begin=o+a.delay||0,this.end=this.begin+a.duration||0,r.specification.transition&&(a.delay||a.duration)&&(this.prior=i)};nw.prototype.possiblyEvaluate=function(r,n,i){var a=r.now||0,o=this.value.possiblyEvaluate(r,n,i),s=this.prior;if(s){if(a>this.end||this.value.isDataDriven())return this.prior=null,o;if(a<this.begin)return s.possiblyEvaluate(r,n,i);var l=(a-this.begin)/(this.end-this.begin);return this.property.interpolate(s.possiblyEvaluate(r,n,i),o,function(r){if(r<=0)return 0;if(r>=1)return 1;var n=r*r,i=n*r;return 4*(r<.5?i:3*(r-n)+i-.75)}(l))}return o};var nT=function(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)};nT.prototype.possiblyEvaluate=function(r,n,i){for(var a=new nM(this._properties),o=0,s=Object.keys(this._values);o<s.length;o+=1){var l=s[o];a._values[l]=this._values[l].possiblyEvaluate(r,n,i)}return a},nT.prototype.hasTransition=function(){for(var r=0,n=Object.keys(this._values);r<n.length;r+=1){var i=n[r];if(this._values[i].prior)return!0}return!1};var nk=function(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)};nk.prototype.getValue=function(r){return w(this._values[r].value)},nk.prototype.setValue=function(r,n){this._values[r]=new nx(this._values[r].property,null===n?void 0:w(n))},nk.prototype.serialize=function(){for(var r={},n=0,i=Object.keys(this._values);n<i.length;n+=1){var a=i[n],o=this.getValue(a);void 0!==o&&(r[a]=o)}return r},nk.prototype.possiblyEvaluate=function(r,n,i){for(var a=new nM(this._properties),o=0,s=Object.keys(this._values);o<s.length;o+=1){var l=s[o];a._values[l]=this._values[l].possiblyEvaluate(r,n,i)}return a};var nA=function(r,n,i){this.property=r,this.value=n,this.parameters=i};nA.prototype.isConstant=function(){return"constant"===this.value.kind},nA.prototype.constantOr=function(r){return"constant"===this.value.kind?this.value.value:r},nA.prototype.evaluate=function(r,n,i,a){return this.property.evaluate(this.value,this.parameters,r,n,i,a)};var nM=function(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)};nM.prototype.get=function(r){return this._values[r]};var nS=function(r){this.specification=r};nS.prototype.possiblyEvaluate=function(r,n){return r.expression.evaluate(n)},nS.prototype.interpolate=function(r,n,i){var a=eM[this.specification.type];return a?a(r,n,i):r};var nE=function(r,n){this.specification=r,this.overrides=n};nE.prototype.possiblyEvaluate=function(r,n,i,a){return"constant"===r.expression.kind||"camera"===r.expression.kind?new nA(this,{kind:"constant",value:r.expression.evaluate(n,null,{},i,a)},n):new nA(this,r.expression,n)},nE.prototype.interpolate=function(r,n,i){if("constant"!==r.value.kind||"constant"!==n.value.kind)return r;if(void 0===r.value.value||void 0===n.value.value)return new nA(this,{kind:"constant",value:void 0},r.parameters);var a=eM[this.specification.type];return a?new nA(this,{kind:"constant",value:a(r.value.value,n.value.value,i)},r.parameters):r},nE.prototype.evaluate=function(r,n,i,a,o,s){return"constant"===r.kind?r.value:r.evaluate(n,i,a,o,s)};var nL=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.possiblyEvaluate=function(r,n,i,a){if(void 0===r.value)return new nA(this,{kind:"constant",value:void 0},n);if("constant"===r.expression.kind){var o=r.expression.evaluate(n,null,{},i,a),s="resolvedImage"===r.property.specification.type&&"string"!=typeof o?o.name:o;return new nA(this,{kind:"constant",value:this._calculate(s,s,s,n)},n)}return"camera"===r.expression.kind?new nA(this,{kind:"constant",value:this._calculate(r.expression.evaluate({zoom:n.zoom-1}),r.expression.evaluate({zoom:n.zoom}),r.expression.evaluate({zoom:n.zoom+1}),n)},n):new nA(this,r.expression,n)},n.prototype.evaluate=function(r,n,i,a,o,s){if("source"===r.kind){var l=r.evaluate(n,i,a,o,s);return this._calculate(l,l,l,n)}return"composite"===r.kind?this._calculate(r.evaluate({zoom:Math.floor(n.zoom)-1},i,a),r.evaluate({zoom:Math.floor(n.zoom)},i,a),r.evaluate({zoom:Math.floor(n.zoom)+1},i,a),n):r.value},n.prototype._calculate=function(r,n,i,a){return a.zoom>a.zoomHistory.lastIntegerZoom?{from:r,to:n}:{from:i,to:n}},n.prototype.interpolate=function(r){return r},n}(nE),nC=function(r){this.specification=r};nC.prototype.possiblyEvaluate=function(r,n,i,a){if(void 0!==r.value){if("constant"===r.expression.kind){var o=r.expression.evaluate(n,null,{},i,a);return this._calculate(o,o,o,n)}return this._calculate(r.expression.evaluate(new ny(Math.floor(n.zoom-1),n)),r.expression.evaluate(new ny(Math.floor(n.zoom),n)),r.expression.evaluate(new ny(Math.floor(n.zoom+1),n)),n)}},nC.prototype._calculate=function(r,n,i,a){return a.zoom>a.zoomHistory.lastIntegerZoom?{from:r,to:n}:{from:i,to:n}},nC.prototype.interpolate=function(r){return r};var nP=function(r){this.specification=r};nP.prototype.possiblyEvaluate=function(r,n,i,a){return!!r.expression.evaluate(n,null,{},i,a)},nP.prototype.interpolate=function(){return!1};var nI=function(r){for(var n in this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],r){var i=r[n];i.specification.overridable&&this.overridableProperties.push(n);var a=this.defaultPropertyValues[n]=new nx(i,void 0),o=this.defaultTransitionablePropertyValues[n]=new nb(i);this.defaultTransitioningPropertyValues[n]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=a.possiblyEvaluate({})}};r5("DataDrivenProperty",nE),r5("DataConstantProperty",nS),r5("CrossFadedDataDrivenProperty",nL),r5("CrossFadedProperty",nC),r5("ColorRampProperty",nP);var nO=function(r){function n(n,i){if(r.call(this),this.id=n.id,this.type=n.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==n.type&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,"background"!==n.type&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),i.layout&&(this._unevaluatedLayout=new nk(i.layout)),i.paint)){for(var a in this._transitionablePaint=new n_(i.paint),n.paint)this.setPaintProperty(a,n.paint[a],{validate:!1});for(var o in n.layout)this.setLayoutProperty(o,n.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new nM(i.paint)}}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},n.prototype.getLayoutProperty=function(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)},n.prototype.setLayoutProperty=function(r,n,i){if(void 0===i&&(i={}),null!=n){var a="layers."+this.id+".layout."+r;if(this._validate(rQ,a,r,n,i))return}"visibility"!==r?this._unevaluatedLayout.setValue(r,n):this.visibility=n},n.prototype.getPaintProperty=function(r){return x(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)},n.prototype.setPaintProperty=function(r,n,i){if(void 0===i&&(i={}),null!=n){var a="layers."+this.id+".paint."+r;if(this._validate(rK,a,r,n,i))return!1}if(x(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-11),n||void 0),!1;var o=this._transitionablePaint._values[r],s="cross-faded-data-driven"===o.property.specification["property-type"],l=o.value.isDataDriven(),c=o.value;this._transitionablePaint.setValue(r,n),this._handleSpecialPaintPropertyUpdate(r);var u=this._transitionablePaint._values[r].value;return u.isDataDriven()||l||s||this._handleOverridablePaintPropertyUpdate(r,c,u)},n.prototype._handleSpecialPaintPropertyUpdate=function(r){},n.prototype._handleOverridablePaintPropertyUpdate=function(r,n,i){return!1},n.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility},n.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},n.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},n.prototype.recalculate=function(r,n){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,n)},n.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),_(r,function(r,n){return!(void 0===r||"layout"===n&&!Object.keys(r).length||"paint"===n&&!Object.keys(r).length)})},n.prototype._validate=function(r,n,i,a,o){return void 0===o&&(o={}),(!o||!1!==o.validate)&&r$(this,r.call(rW,{key:n,layerType:this.type,objectKey:i,value:a,styleSpec:tA,style:{glyphs:!0,sprite:!0}}))},n.prototype.is3D=function(){return!1},n.prototype.isTileClipped=function(){return!1},n.prototype.hasOffscreenPass=function(){return!1},n.prototype.resize=function(){},n.prototype.isStateDependent=function(){for(var r in this.paint._values){var n=this.paint.get(r);if(n instanceof nA&&rn(n.property.specification)&&("source"===n.value.kind||"composite"===n.value.kind)&&n.value.isStateDependent)return!0}return!1},n}(tk),nz={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},nD=function(r,n){this._structArray=r,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},nR=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function nF(r,n){void 0===n&&(n=1);var i=0,a=0;return{members:r.map(function(r){var o,s=nz[o=r.type].BYTES_PER_ELEMENT,l=i=nB(i,Math.max(n,s)),c=r.components||1;return a=Math.max(a,s),i+=s*c,{name:r.name,type:r.type,components:c,offset:l}}),size:nB(i,Math.max(a,n)),alignment:n}}function nB(r,n){return Math.ceil(r/n)*n}nR.serialize=function(r,n){return r._trim(),n&&(r.isTransferred=!0,n.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}},nR.deserialize=function(r){var n=Object.create(this.prototype);return n.arrayBuffer=r.arrayBuffer,n.length=r.length,n.capacity=r.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n},nR.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},nR.prototype.clear=function(){this.length=0},nR.prototype.resize=function(r){this.reserve(r),this.length=r},nR.prototype.reserve=function(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}},nR.prototype._refreshViews=function(){throw Error("_refreshViews() must be implemented by each concrete StructArray layout")};var nN=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n){var i=this.length;return this.resize(i+1),this.emplace(i,r,n)},n.prototype.emplace=function(r,n,i){var a=2*r;return this.int16[a+0]=n,this.int16[a+1]=i,r},n}(nR);nN.prototype.bytesPerElement=4,r5("StructArrayLayout2i4",nN);var nj=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a){var o=this.length;return this.resize(o+1),this.emplace(o,r,n,i,a)},n.prototype.emplace=function(r,n,i,a,o){var s=4*r;return this.int16[s+0]=n,this.int16[s+1]=i,this.int16[s+2]=a,this.int16[s+3]=o,r},n}(nR);nj.prototype.bytesPerElement=8,r5("StructArrayLayout4i8",nj);var nU=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a,o,s){var l=this.length;return this.resize(l+1),this.emplace(l,r,n,i,a,o,s)},n.prototype.emplace=function(r,n,i,a,o,s,l){var c=6*r;return this.int16[c+0]=n,this.int16[c+1]=i,this.int16[c+2]=a,this.int16[c+3]=o,this.int16[c+4]=s,this.int16[c+5]=l,r},n}(nR);nU.prototype.bytesPerElement=12,r5("StructArrayLayout2i4i12",nU);var nV=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a,o,s){var l=this.length;return this.resize(l+1),this.emplace(l,r,n,i,a,o,s)},n.prototype.emplace=function(r,n,i,a,o,s,l){var c=4*r,u=8*r;return this.int16[c+0]=n,this.int16[c+1]=i,this.uint8[u+4]=a,this.uint8[u+5]=o,this.uint8[u+6]=s,this.uint8[u+7]=l,r},n}(nR);nV.prototype.bytesPerElement=8,r5("StructArrayLayout2i4ub8",nV);var nH=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a,o,s,l,c,u,f){var h=this.length;return this.resize(h+1),this.emplace(h,r,n,i,a,o,s,l,c,u,f)},n.prototype.emplace=function(r,n,i,a,o,s,l,c,u,f,h){var p=9*r,d=18*r;return this.uint16[p+0]=n,this.uint16[p+1]=i,this.uint16[p+2]=a,this.uint16[p+3]=o,this.uint16[p+4]=s,this.uint16[p+5]=l,this.uint16[p+6]=c,this.uint16[p+7]=u,this.uint8[d+16]=f,this.uint8[d+17]=h,r},n}(nR);nH.prototype.bytesPerElement=18,r5("StructArrayLayout8ui2ub18",nH);var nq=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a,o,s,l,c,u,f,h,p){var d=this.length;return this.resize(d+1),this.emplace(d,r,n,i,a,o,s,l,c,u,f,h,p)},n.prototype.emplace=function(r,n,i,a,o,s,l,c,u,f,h,p,d){var m=12*r;return this.int16[m+0]=n,this.int16[m+1]=i,this.int16[m+2]=a,this.int16[m+3]=o,this.uint16[m+4]=s,this.uint16[m+5]=l,this.uint16[m+6]=c,this.uint16[m+7]=u,this.int16[m+8]=f,this.int16[m+9]=h,this.int16[m+10]=p,this.int16[m+11]=d,r},n}(nR);nq.prototype.bytesPerElement=24,r5("StructArrayLayout4i4ui4i24",nq);var nG=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,r,n,i)},n.prototype.emplace=function(r,n,i,a){var o=3*r;return this.float32[o+0]=n,this.float32[o+1]=i,this.float32[o+2]=a,r},n}(nR);nG.prototype.bytesPerElement=12,r5("StructArrayLayout3f12",nG);var nY=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r){var n=this.length;return this.resize(n+1),this.emplace(n,r)},n.prototype.emplace=function(r,n){return this.uint32[1*r+0]=n,r},n}(nR);nY.prototype.bytesPerElement=4,r5("StructArrayLayout1ul4",nY);var nW=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a,o,s,l,c,u){var f=this.length;return this.resize(f+1),this.emplace(f,r,n,i,a,o,s,l,c,u)},n.prototype.emplace=function(r,n,i,a,o,s,l,c,u,f){var h=10*r;return this.int16[h+0]=n,this.int16[h+1]=i,this.int16[h+2]=a,this.int16[h+3]=o,this.int16[h+4]=s,this.int16[h+5]=l,this.uint32[5*r+3]=c,this.uint16[h+8]=u,this.uint16[h+9]=f,r},n}(nR);nW.prototype.bytesPerElement=20,r5("StructArrayLayout6i1ul2ui20",nW);var nX=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a,o,s){var l=this.length;return this.resize(l+1),this.emplace(l,r,n,i,a,o,s)},n.prototype.emplace=function(r,n,i,a,o,s,l){var c=6*r;return this.int16[c+0]=n,this.int16[c+1]=i,this.int16[c+2]=a,this.int16[c+3]=o,this.int16[c+4]=s,this.int16[c+5]=l,r},n}(nR);nX.prototype.bytesPerElement=12,r5("StructArrayLayout2i2i2i12",nX);var nZ=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a,o){var s=this.length;return this.resize(s+1),this.emplace(s,r,n,i,a,o)},n.prototype.emplace=function(r,n,i,a,o,s){var l=4*r,c=8*r;return this.float32[l+0]=n,this.float32[l+1]=i,this.float32[l+2]=a,this.int16[c+6]=o,this.int16[c+7]=s,r},n}(nR);nZ.prototype.bytesPerElement=16,r5("StructArrayLayout2f1f2i16",nZ);var nJ=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a){var o=this.length;return this.resize(o+1),this.emplace(o,r,n,i,a)},n.prototype.emplace=function(r,n,i,a,o){var s=12*r,l=3*r;return this.uint8[s+0]=n,this.uint8[s+1]=i,this.float32[l+1]=a,this.float32[l+2]=o,r},n}(nR);nJ.prototype.bytesPerElement=12,r5("StructArrayLayout2ub2f12",nJ);var nK=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,r,n,i)},n.prototype.emplace=function(r,n,i,a){var o=3*r;return this.uint16[o+0]=n,this.uint16[o+1]=i,this.uint16[o+2]=a,r},n}(nR);nK.prototype.bytesPerElement=6,r5("StructArrayLayout3ui6",nK);var nQ=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v,y){var x=this.length;return this.resize(x+1),this.emplace(x,r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v,y)},n.prototype.emplace=function(r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v,y,x){var b=24*r,_=12*r,w=48*r;return this.int16[b+0]=n,this.int16[b+1]=i,this.uint16[b+2]=a,this.uint16[b+3]=o,this.uint32[_+2]=s,this.uint32[_+3]=l,this.uint32[_+4]=c,this.uint16[b+10]=u,this.uint16[b+11]=f,this.uint16[b+12]=h,this.float32[_+7]=p,this.float32[_+8]=d,this.uint8[w+36]=m,this.uint8[w+37]=g,this.uint8[w+38]=v,this.uint32[_+10]=y,this.int16[b+22]=x,r},n}(nR);nQ.prototype.bytesPerElement=48,r5("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",nQ);var n$=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v,y,x,b,_,w,T,k,A,M,S,E,L){var C=this.length;return this.resize(C+1),this.emplace(C,r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v,y,x,b,_,w,T,k,A,M,S,E,L)},n.prototype.emplace=function(r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v,y,x,b,_,w,T,k,A,M,S,E,L,C){var P=34*r,I=17*r;return this.int16[P+0]=n,this.int16[P+1]=i,this.int16[P+2]=a,this.int16[P+3]=o,this.int16[P+4]=s,this.int16[P+5]=l,this.int16[P+6]=c,this.int16[P+7]=u,this.uint16[P+8]=f,this.uint16[P+9]=h,this.uint16[P+10]=p,this.uint16[P+11]=d,this.uint16[P+12]=m,this.uint16[P+13]=g,this.uint16[P+14]=v,this.uint16[P+15]=y,this.uint16[P+16]=x,this.uint16[P+17]=b,this.uint16[P+18]=_,this.uint16[P+19]=w,this.uint16[P+20]=T,this.uint16[P+21]=k,this.uint16[P+22]=A,this.uint32[I+12]=M,this.float32[I+13]=S,this.float32[I+14]=E,this.float32[I+15]=L,this.float32[I+16]=C,r},n}(nR);n$.prototype.bytesPerElement=68,r5("StructArrayLayout8i15ui1ul4f68",n$);var n0=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r){var n=this.length;return this.resize(n+1),this.emplace(n,r)},n.prototype.emplace=function(r,n){return this.float32[1*r+0]=n,r},n}(nR);n0.prototype.bytesPerElement=4,r5("StructArrayLayout1f4",n0);var n1=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,r,n,i)},n.prototype.emplace=function(r,n,i,a){var o=3*r;return this.int16[o+0]=n,this.int16[o+1]=i,this.int16[o+2]=a,r},n}(nR);n1.prototype.bytesPerElement=6,r5("StructArrayLayout3i6",n1);var n2=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,r,n,i)},n.prototype.emplace=function(r,n,i,a){var o=4*r;return this.uint32[2*r+0]=n,this.uint16[o+2]=i,this.uint16[o+3]=a,r},n}(nR);n2.prototype.bytesPerElement=8,r5("StructArrayLayout1ul2ui8",n2);var n3=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n){var i=this.length;return this.resize(i+1),this.emplace(i,r,n)},n.prototype.emplace=function(r,n,i){var a=2*r;return this.uint16[a+0]=n,this.uint16[a+1]=i,r},n}(nR);n3.prototype.bytesPerElement=4,r5("StructArrayLayout2ui4",n3);var n5=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r){var n=this.length;return this.resize(n+1),this.emplace(n,r)},n.prototype.emplace=function(r,n){return this.uint16[1*r+0]=n,r},n}(nR);n5.prototype.bytesPerElement=2,r5("StructArrayLayout1ui2",n5);var n4=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n){var i=this.length;return this.resize(i+1),this.emplace(i,r,n)},n.prototype.emplace=function(r,n,i){var a=2*r;return this.float32[a+0]=n,this.float32[a+1]=i,r},n}(nR);n4.prototype.bytesPerElement=8,r5("StructArrayLayout2f8",n4);var n6=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(r,n,i,a){var o=this.length;return this.resize(o+1),this.emplace(o,r,n,i,a)},n.prototype.emplace=function(r,n,i,a,o){var s=4*r;return this.float32[s+0]=n,this.float32[s+1]=i,this.float32[s+2]=a,this.float32[s+3]=o,r},n}(nR);n6.prototype.bytesPerElement=16,r5("StructArrayLayout4f16",n6);var n8=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new a(this.anchorPointX,this.anchorPointY)},Object.defineProperties(n.prototype,i),n}(nD);n8.prototype.size=20;var n9=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.get=function(r){return new n8(this,r)},n}(nW);r5("CollisionBoxArray",n9);var n7=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(r){this._structArray.uint8[this._pos1+37]=r},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(r){this._structArray.uint8[this._pos1+38]=r},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(r){this._structArray.uint32[this._pos4+10]=r},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(n.prototype,i),n}(nD);n7.prototype.size=48;var it=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.get=function(r){return new n7(this,r)},n}(nQ);r5("PlacedSymbolArray",it);var ie=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(r){this._structArray.uint32[this._pos4+12]=r},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(n.prototype,i),n}(nD);ie.prototype.size=68;var ir=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.get=function(r){return new ie(this,r)},n}(n$);r5("SymbolInstanceArray",ir);var ii=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getoffsetX=function(r){return this.float32[1*r+0]},n}(n0);r5("GlyphOffsetArray",ii);var ia=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getx=function(r){return this.int16[3*r+0]},n.prototype.gety=function(r){return this.int16[3*r+1]},n.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},n}(n1);r5("SymbolLineVertexArray",ia);var io=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(n.prototype,i),n}(nD);io.prototype.size=8;var is=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.get=function(r){return new io(this,r)},n}(n2);r5("FeatureIndexArray",is);var il=nF([{name:"a_pos",components:2,type:"Int16"}],4).members,ic=function(r){void 0===r&&(r=[]),this.segments=r};function iu(r,n){return 256*(r=f(Math.floor(r),0,255))+(n=f(Math.floor(n),0,255))}ic.prototype.prepareSegment=function(r,n,i,a){var o=this.segments[this.segments.length-1];return r>ic.MAX_VERTEX_ARRAY_LENGTH&&k("Max vertices per segment is "+ic.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+r),(!o||o.vertexLength+r>ic.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==a)&&(o={vertexOffset:n.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==a&&(o.sortKey=a),this.segments.push(o)),o},ic.prototype.get=function(){return this.segments},ic.prototype.destroy=function(){for(var r=0,n=this.segments;r<n.length;r+=1){var i=n[r];for(var a in i.vaos)i.vaos[a].destroy()}},ic.simpleSegment=function(r,n,i,a){return new ic([{vertexOffset:r,primitiveOffset:n,vertexLength:i,primitiveLength:a,vaos:{},sortKey:0}])},ic.MAX_VERTEX_ARRAY_LENGTH=65535,r5("SegmentVector",ic);var ih=nF([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),ip=n(function(r){r.exports=function(r,n){var i,a,o,s,l,c;for(i=3&r.length,a=r.length-i,o=n,c=0;c<a;)l=255&r.charCodeAt(c)|(255&r.charCodeAt(++c))<<8|(255&r.charCodeAt(++c))<<16|(255&r.charCodeAt(++c))<<24,++c,o=27492+(65535&(s=5*(65535&(o=(o^=l=(65535&(l=(l=(65535&l)*3432918353+(((l>>>16)*3432918353&65535)<<16)&4294967295)<<15|l>>>17))*461845907+(((l>>>16)*461845907&65535)<<16)&4294967295)<<13|o>>>19))+((5*(o>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&r.charCodeAt(c+2))<<16;case 2:l^=(255&r.charCodeAt(c+1))<<8;case 1:o^=l=(65535&(l=(l=(65535&(l^=255&r.charCodeAt(c)))*3432918353+(((l>>>16)*3432918353&65535)<<16)&4294967295)<<15|l>>>17))*461845907+(((l>>>16)*461845907&65535)<<16)&4294967295}return o^=r.length,o=2246822507*(65535&(o^=o>>>16))+((2246822507*(o>>>16)&65535)<<16)&4294967295,o=3266489909*(65535&(o^=o>>>13))+((3266489909*(o>>>16)&65535)<<16)&4294967295,(o^=o>>>16)>>>0}}),id=n(function(r){r.exports=function(r,n){for(var i,a=r.length,o=n^a,s=0;a>=4;)i=1540483477*(65535&(i=255&r.charCodeAt(s)|(255&r.charCodeAt(++s))<<8|(255&r.charCodeAt(++s))<<16|(255&r.charCodeAt(++s))<<24))+((1540483477*(i>>>16)&65535)<<16),o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),a-=4,++s;switch(a){case 3:o^=(255&r.charCodeAt(s+2))<<16;case 2:o^=(255&r.charCodeAt(s+1))<<8;case 1:o=1540483477*(65535&(o^=255&r.charCodeAt(s)))+((1540483477*(o>>>16)&65535)<<16)}return o=1540483477*(65535&(o^=o>>>13))+((1540483477*(o>>>16)&65535)<<16),(o^=o>>>15)>>>0}});ip.murmur3=ip,ip.murmur2=id;var im=function(){this.ids=[],this.positions=[],this.indexed=!1};function ig(r){var n=+r;return!isNaN(n)&&n<=9007199254740991?n:ip(String(r))}function iv(r,n,i){var a=r[n];r[n]=r[i],r[i]=a}im.prototype.add=function(r,n,i,a){this.ids.push(ig(r)),this.positions.push(n,i,a)},im.prototype.getPositions=function(r){for(var n=ig(r),i=0,a=this.ids.length-1;i<a;){var o=i+a>>1;this.ids[o]>=n?a=o:i=o+1}for(var s=[];this.ids[i]===n;){var l=this.positions[3*i],c=this.positions[3*i+1],u=this.positions[3*i+2];s.push({index:l,start:c,end:u}),i++}return s},im.serialize=function(r,n){var i=new Float64Array(r.ids),a=new Uint32Array(r.positions);return function r(n,i,a,o){for(;a<o;){for(var s=n[a+o>>1],l=a-1,c=o+1;;){do l++;while(n[l]<s);do c--;while(n[c]>s);if(l>=c)break;iv(n,l,c),iv(i,3*l,3*c),iv(i,3*l+1,3*c+1),iv(i,3*l+2,3*c+2)}c-a<o-c?(r(n,i,a,c),a=c+1):(r(n,i,c+1,o),o=c)}}(i,a,0,i.length-1),n&&n.push(i.buffer,a.buffer),{ids:i,positions:a}},im.deserialize=function(r){var n=new im;return n.ids=r.ids,n.positions=r.positions,n.indexed=!0,n},r5("FeaturePositionMap",im);var iy=function(r,n){this.gl=r.gl,this.location=n},ix=function(r){function n(n,i){r.call(this,n,i),this.current=0}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},n}(iy),ib=function(r){function n(n,i){r.call(this,n,i),this.current=0}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},n}(iy),i_=function(r){function n(n,i){r.call(this,n,i),this.current=[0,0]}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},n}(iy),iw=function(r){function n(n,i){r.call(this,n,i),this.current=[0,0,0]}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},n}(iy),iT=function(r){function n(n,i){r.call(this,n,i),this.current=[0,0,0,0]}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},n}(iy),ik=function(r){function n(n,i){r.call(this,n,i),this.current=tJ.transparent}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},n}(iy),iA=new Float32Array(16),iM=function(r){function n(n,i){r.call(this,n,i),this.current=iA}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var n=1;n<16;n++)if(r[n]!==this.current[n]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},n}(iy);function iS(r){return[iu(255*r.r,255*r.g),iu(255*r.b,255*r.a)]}var iE=function(r,n,i){this.value=r,this.uniformNames=n.map(function(r){return"u_"+r}),this.type=i};iE.prototype.setUniform=function(r,n,i){r.set(i.constantOr(this.value))},iE.prototype.getBinding=function(r,n,i){return"color"===this.type?new ik(r,n):new ib(r,n)};var iL=function(r,n){this.uniformNames=n.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};iL.prototype.setConstantPatternPositions=function(r,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=r.tlbr},iL.prototype.setUniform=function(r,n,i,a){var o="u_pattern_to"===a?this.patternTo:"u_pattern_from"===a?this.patternFrom:"u_pixel_ratio_to"===a?this.pixelRatioTo:"u_pixel_ratio_from"===a?this.pixelRatioFrom:null;o&&r.set(o)},iL.prototype.getBinding=function(r,n,i){return"u_pattern"===i.substr(0,9)?new iT(r,n):new ib(r,n)};var iC=function(r,n,i,a){this.expression=r,this.type=i,this.maxValue=0,this.paintVertexAttributes=n.map(function(r){return{name:"a_"+r,type:"Float32",components:"color"===i?2:1,offset:0}}),this.paintVertexArray=new a};iC.prototype.populatePaintArray=function(r,n,i,a,o){var s=this.paintVertexArray.length,l=this.expression.evaluate(new ny(0),n,{},a,[],o);this.paintVertexArray.resize(r),this._setPaintValue(s,r,l)},iC.prototype.updatePaintArray=function(r,n,i,a){var o=this.expression.evaluate({zoom:0},i,a);this._setPaintValue(r,n,o)},iC.prototype._setPaintValue=function(r,n,i){if("color"===this.type)for(var a=iS(i),o=r;o<n;o++)this.paintVertexArray.emplace(o,a[0],a[1]);else{for(var s=r;s<n;s++)this.paintVertexArray.emplace(s,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},iC.prototype.upload=function(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},iC.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var iP=function(r,n,i,a,o,s){this.expression=r,this.uniformNames=n.map(function(r){return"u_"+r+"_t"}),this.type=i,this.useIntegerZoom=a,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=n.map(function(r){return{name:"a_"+r,type:"Float32",components:"color"===i?4:2,offset:0}}),this.paintVertexArray=new s};iP.prototype.populatePaintArray=function(r,n,i,a,o){var s=this.expression.evaluate(new ny(this.zoom),n,{},a,[],o),l=this.expression.evaluate(new ny(this.zoom+1),n,{},a,[],o),c=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(c,r,s,l)},iP.prototype.updatePaintArray=function(r,n,i,a){var o=this.expression.evaluate({zoom:this.zoom},i,a),s=this.expression.evaluate({zoom:this.zoom+1},i,a);this._setPaintValue(r,n,o,s)},iP.prototype._setPaintValue=function(r,n,i,a){if("color"===this.type)for(var o=iS(i),s=iS(a),l=r;l<n;l++)this.paintVertexArray.emplace(l,o[0],o[1],s[0],s[1]);else{for(var c=r;c<n;c++)this.paintVertexArray.emplace(c,i,a);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(a))}},iP.prototype.upload=function(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},iP.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},iP.prototype.setUniform=function(r,n){var i=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,a=f(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);r.set(a)},iP.prototype.getBinding=function(r,n,i){return new ib(r,n)};var iI=function(r,n,i,a,o,s){this.expression=r,this.type=n,this.useIntegerZoom=i,this.zoom=a,this.layerId=s,this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o};iI.prototype.populatePaintArray=function(r,n,i){var a=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(a,r,n.patterns&&n.patterns[this.layerId],i)},iI.prototype.updatePaintArray=function(r,n,i,a,o){this._setPaintValues(r,n,i.patterns&&i.patterns[this.layerId],o)},iI.prototype._setPaintValues=function(r,n,i,a){if(a&&i){var o=i.min,s=i.mid,l=i.max,c=a[o],u=a[s],f=a[l];if(c&&u&&f)for(var h=r;h<n;h++)this.zoomInPaintVertexArray.emplace(h,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio),this.zoomOutPaintVertexArray.emplace(h,u.tl[0],u.tl[1],u.br[0],u.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],u.pixelRatio,f.pixelRatio)}},iI.prototype.upload=function(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,ih.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,ih.members,this.expression.isStateDependent))},iI.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var iO=function(r,n,i,a){this.binders={},this.layoutAttributes=a,this._buffers=[];var o=[];for(var s in r.paint._values)if(i(s)){var l=r.paint.get(s);if(l instanceof nA&&rn(l.property.specification)){var c,u=(c=r.type,({"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]})[s]||[s.replace(c+"-","").replace(/-/g,"_")]),f=l.value,h=l.property.specification.type,p=l.property.useIntegerZoom,d=l.property.specification["property-type"],m="cross-faded"===d||"cross-faded-data-driven"===d;if("constant"===f.kind)this.binders[s]=m?new iL(f.value,u):new iE(f.value,u,h),o.push("/u_"+s);else if("source"===f.kind||m){var g=iD(s,h,"source");this.binders[s]=m?new iI(f,h,p,n,g,r.id):new iC(f,u,h,g),o.push("/a_"+s)}else{var v=iD(s,h,"composite");this.binders[s]=new iP(f,u,h,p,n,v),o.push("/z_"+s)}}}this.cacheKey=o.sort().join("")};iO.prototype.getMaxValue=function(r){var n=this.binders[r];return n instanceof iC||n instanceof iP?n.maxValue:0},iO.prototype.populatePaintArrays=function(r,n,i,a,o){for(var s in this.binders){var l=this.binders[s];(l instanceof iC||l instanceof iP||l instanceof iI)&&l.populatePaintArray(r,n,i,a,o)}},iO.prototype.setConstantPatternPositions=function(r,n){for(var i in this.binders){var a=this.binders[i];a instanceof iL&&a.setConstantPatternPositions(r,n)}},iO.prototype.updatePaintArrays=function(r,n,i,a,o){var s=!1;for(var l in r)for(var c=0,u=n.getPositions(l);c<u.length;c+=1){var f=u[c],h=i.feature(f.index);for(var p in this.binders){var d=this.binders[p];if((d instanceof iC||d instanceof iP||d instanceof iI)&&!0===d.expression.isStateDependent){var m=a.paint.get(p);d.expression=m.value,d.updatePaintArray(f.start,f.end,h,r[l],o),s=!0}}}return s},iO.prototype.defines=function(){var r=[];for(var n in this.binders){var i=this.binders[n];(i instanceof iE||i instanceof iL)&&r.push.apply(r,i.uniformNames.map(function(r){return"#define HAS_UNIFORM_"+r}))}return r},iO.prototype.getPaintVertexBuffers=function(){return this._buffers},iO.prototype.getUniforms=function(r,n){var i=[];for(var a in this.binders){var o=this.binders[a];if(o instanceof iE||o instanceof iL||o instanceof iP)for(var s=0,l=o.uniformNames;s<l.length;s+=1){var c=l[s];if(n[c]){var u=o.getBinding(r,n[c],c);i.push({name:c,property:a,binding:u})}}}return i},iO.prototype.setUniforms=function(r,n,i,a){for(var o=0;o<n.length;o+=1){var s=n[o],l=s.name,c=s.property,u=s.binding;this.binders[c].setUniform(u,a,i.get(c),l)}},iO.prototype.updatePaintBuffers=function(r){for(var n in this._buffers=[],this.binders){var i=this.binders[n];if(r&&i instanceof iI){var a=2===r.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;a&&this._buffers.push(a)}else(i instanceof iC||i instanceof iP)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},iO.prototype.upload=function(r){for(var n in this.binders){var i=this.binders[n];(i instanceof iC||i instanceof iP||i instanceof iI)&&i.upload(r)}this.updatePaintBuffers()},iO.prototype.destroy=function(){for(var r in this.binders){var n=this.binders[r];(n instanceof iC||n instanceof iP||n instanceof iI)&&n.destroy()}};var iz=function(r,n,i,a){void 0===a&&(a=function(){return!0}),this.programConfigurations={};for(var o=0;o<n.length;o+=1){var s=n[o];this.programConfigurations[s.id]=new iO(s,i,a,r)}this.needsUpload=!1,this._featureMap=new im,this._bufferOffset=0};function iD(r,n,i){var a={"line-pattern":{source:nH,composite:nH},"fill-pattern":{source:nH,composite:nH},"fill-extrusion-pattern":{source:nH,composite:nH}}[r];return a&&a[i]||({color:{source:n4,composite:n6},number:{source:n0,composite:n4}})[n][i]}iz.prototype.populatePaintArrays=function(r,n,i,a,o,s){for(var l in this.programConfigurations)this.programConfigurations[l].populatePaintArrays(r,n,a,o,s);void 0!==n.id&&this._featureMap.add(n.id,i,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0},iz.prototype.updatePaintArrays=function(r,n,i,a){for(var o=0;o<i.length;o+=1){var s=i[o];this.needsUpload=this.programConfigurations[s.id].updatePaintArrays(r,this._featureMap,n,s,a)||this.needsUpload}},iz.prototype.get=function(r){return this.programConfigurations[r]},iz.prototype.upload=function(r){if(this.needsUpload){for(var n in this.programConfigurations)this.programConfigurations[n].upload(r);this.needsUpload=!1}},iz.prototype.destroy=function(){for(var r in this.programConfigurations)this.programConfigurations[r].destroy()},r5("ConstantBinder",iE),r5("CrossFadedConstantBinder",iL),r5("SourceExpressionBinder",iC),r5("CrossFadedCompositeBinder",iI),r5("CompositeExpressionBinder",iP),r5("ProgramConfiguration",iO,{omit:["_buffers"]}),r5("ProgramConfigurationSet",iz);var iR,iF,iB={min:-16384,max:16383};function iN(r){for(var n=8192/r.extent,i=r.loadGeometry(),a=0;a<i.length;a++)for(var o=i[a],s=0;s<o.length;s++){var l=o[s];l.x=Math.round(l.x*n),l.y=Math.round(l.y*n),(l.x<iB.min||l.x>iB.max||l.y<iB.min||l.y>iB.max)&&(k("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l.x=f(l.x,iB.min,iB.max),l.y=f(l.y,iB.min,iB.max))}return i}function ij(r,n,i,a,o){r.emplaceBack(2*n+(a+1)/2,2*i+(o+1)/2)}var iU=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new nN,this.indexArray=new nK,this.segments=new ic,this.programConfigurations=new iz(il,r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};function iV(r,n){for(var i=0;i<r.length;i++)if(iX(n,r[i]))return!0;for(var a=0;a<n.length;a++)if(iX(r,n[a]))return!0;return!!iq(r,n)}function iH(r,n){if(1===r.length)return iW(n,r[0]);for(var i=0;i<n.length;i++)for(var a=n[i],o=0;o<a.length;o++)if(iX(r,a[o]))return!0;for(var s=0;s<r.length;s++)if(iW(n,r[s]))return!0;for(var l=0;l<n.length;l++)if(iq(r,n[l]))return!0;return!1}function iq(r,n){if(0===r.length||0===n.length)return!1;for(var i,a,o=0;o<r.length-1;o++)for(var s=r[o],l=r[o+1],c=0;c<n.length-1;c++)if(A(s,i=n[c],a=n[c+1])!==A(l,i,a)&&A(s,l,i)!==A(s,l,a))return!0;return!1}function iG(r,n,i){var a=i*i;if(1===n.length)return r.distSqr(n[0])<a;for(var o=1;o<n.length;o++)if(iY(r,n[o-1],n[o])<a)return!0;return!1}function iY(r,n,i){var a=n.distSqr(i);if(0===a)return r.distSqr(n);var o=((r.x-n.x)*(i.x-n.x)+(r.y-n.y)*(i.y-n.y))/a;return o<0?r.distSqr(n):o>1?r.distSqr(i):r.distSqr(i.sub(n)._mult(o)._add(n))}function iW(r,n){for(var i,a,o,s=!1,l=0;l<r.length;l++)for(var c=0,u=(i=r[l]).length-1;c<i.length;u=c++)a=i[c],o=i[u],a.y>n.y!=o.y>n.y&&n.x<(o.x-a.x)*(n.y-a.y)/(o.y-a.y)+a.x&&(s=!s);return s}function iX(r,n){for(var i=!1,a=0,o=r.length-1;a<r.length;o=a++){var s=r[a],l=r[o];s.y>n.y!=l.y>n.y&&n.x<(l.x-s.x)*(n.y-s.y)/(l.y-s.y)+s.x&&(i=!i)}return i}function iZ(r,n,i){var a=n.paint.get(r).value;return"constant"===a.kind?a.value:i.programConfigurations.get(n.id).getMaxValue(r)}function iJ(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function iK(r,n,i,o,s){if(!n[0]&&!n[1])return r;var l=a.convert(n)._mult(s);"viewport"===i&&l._rotate(-o);for(var c=[],u=0;u<r.length;u++){var f=r[u];c.push(f.sub(l))}return c}iU.prototype.populate=function(r,n,i){var a=this.layers[0],o=[],s=null;"circle"===a.type&&(s=a.layout.get("circle-sort-key"));for(var l=0;l<r.length;l+=1){var c=r[l],u=c.feature,f=c.id,h=c.index,p=c.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,m={type:u.type,id:f,properties:u.properties,geometry:d?iN(u):[]};if(this.layers[0]._featureFilter.filter(new ny(this.zoom),m,i)){d||(m.geometry=iN(u));var g=s?s.evaluate(m,{},i):void 0,v={id:f,properties:u.properties,type:u.type,sourceLayerIndex:p,index:h,geometry:m.geometry,patterns:{},sortKey:g};o.push(v)}}s&&o.sort(function(r,n){return r.sortKey-n.sortKey});for(var y=0;y<o.length;y+=1){var x=o[y],b=x.geometry,_=x.index,w=x.sourceLayerIndex,T=r[_].feature;this.addFeature(x,b,_,i),n.featureIndex.insert(T,b,_,w,this.index)}},iU.prototype.update=function(r,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,n,this.stateDependentLayers,i)},iU.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},iU.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},iU.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,il),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},iU.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},iU.prototype.addFeature=function(r,n,i,a){for(var o=0;o<n.length;o+=1)for(var s=0,l=n[o];s<l.length;s+=1){var c=l[s],u=c.x,f=c.y;if(!(u<0||u>=8192||f<0||f>=8192)){var h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),p=h.vertexLength;ij(this.layoutVertexArray,u,f,-1,-1),ij(this.layoutVertexArray,u,f,1,-1),ij(this.layoutVertexArray,u,f,1,1),ij(this.layoutVertexArray,u,f,-1,1),this.indexArray.emplaceBack(p,p+1,p+2),this.indexArray.emplaceBack(p,p+3,p+2),h.vertexLength+=4,h.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,i,{},a)},r5("CircleBucket",iU,{omit:["layers"]});var iQ=new nI({"circle-sort-key":new nE(tA.layout_circle["circle-sort-key"])}),i$={paint:new nI({"circle-radius":new nE(tA.paint_circle["circle-radius"]),"circle-color":new nE(tA.paint_circle["circle-color"]),"circle-blur":new nE(tA.paint_circle["circle-blur"]),"circle-opacity":new nE(tA.paint_circle["circle-opacity"]),"circle-translate":new nS(tA.paint_circle["circle-translate"]),"circle-translate-anchor":new nS(tA.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new nS(tA.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new nS(tA.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new nE(tA.paint_circle["circle-stroke-width"]),"circle-stroke-color":new nE(tA.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new nE(tA.paint_circle["circle-stroke-opacity"])}),layout:iQ},i0="undefined"!=typeof Float32Array?Float32Array:Array;function i1(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function i2(r,n,i){var a=n[0],o=n[1],s=n[2],l=n[3],c=n[4],u=n[5],f=n[6],h=n[7],p=n[8],d=n[9],m=n[10],g=n[11],v=n[12],y=n[13],x=n[14],b=n[15],_=i[0],w=i[1],T=i[2],k=i[3];return r[0]=_*a+w*c+T*p+k*v,r[1]=_*o+w*u+T*d+k*y,r[2]=_*s+w*f+T*m+k*x,r[3]=_*l+w*h+T*g+k*b,_=i[4],w=i[5],T=i[6],k=i[7],r[4]=_*a+w*c+T*p+k*v,r[5]=_*o+w*u+T*d+k*y,r[6]=_*s+w*f+T*m+k*x,r[7]=_*l+w*h+T*g+k*b,_=i[8],w=i[9],T=i[10],k=i[11],r[8]=_*a+w*c+T*p+k*v,r[9]=_*o+w*u+T*d+k*y,r[10]=_*s+w*f+T*m+k*x,r[11]=_*l+w*h+T*g+k*b,_=i[12],w=i[13],T=i[14],k=i[15],r[12]=_*a+w*c+T*p+k*v,r[13]=_*o+w*u+T*d+k*y,r[14]=_*s+w*f+T*m+k*x,r[15]=_*l+w*h+T*g+k*b,r}function i3(r,n,i){var a=n[0],o=n[1],s=n[2],l=n[3];return r[0]=i[0]*a+i[4]*o+i[8]*s+i[12]*l,r[1]=i[1]*a+i[5]*o+i[9]*s+i[13]*l,r[2]=i[2]*a+i[6]*o+i[10]*s+i[14]*l,r[3]=i[3]*a+i[7]*o+i[11]*s+i[15]*l,r}Math.hypot||(Math.hypot=function(){for(var r=arguments,n=0,i=arguments.length;i--;)n+=r[i]*r[i];return Math.sqrt(n)}),s=new i0(3),i0!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),l=new i0(4),i0!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0,l[3]=0);var i5=(c=new i0(2),i0!=Float32Array&&(c[0]=0,c[1]=0),function(r){function n(n){r.call(this,n,i$)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.createBucket=function(r){return new iU(r)},n.prototype.queryRadius=function(r){return iZ("circle-radius",this,r)+iZ("circle-stroke-width",this,r)+iJ(this.paint.get("circle-translate"))},n.prototype.queryIntersectsFeature=function(r,n,i,a,o,s,l,c){for(var u=iK(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,l),f=this.paint.get("circle-radius").evaluate(n,i)+this.paint.get("circle-stroke-width").evaluate(n,i),h="map"===this.paint.get("circle-pitch-alignment"),p=h?u:u.map(function(r){return i4(r,c)}),d=h?f*l:f,m=0;m<a.length;m+=1)for(var g=0,v=a[m];g<v.length;g+=1){var y,x=v[g],b=h?x:i4(x,c),_=d,w=i3([],[x.x,x.y,0,1],c);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?_*=w[3]/s.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(_*=s.cameraToCenterDistance/w[3]),y=_,iX(p,b)||iG(b,p,y))return!0}return!1},n}(nO));function i4(r,n){var i=i3([],[r.x,r.y,0,1],n);return new a(i[0]/i[3],i[1]/i[3])}var i6=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(iU);function i8(r,n,i,a){var o=n.width,s=n.height;if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==o*s*i)throw RangeError("mismatched image size")}else a=new Uint8Array(o*s*i);return r.width=o,r.height=s,r.data=a,r}function i9(r,n,i){var a=n.width,o=n.height;if(a!==r.width||o!==r.height){var s=i8({},{width:a,height:o},i);i7(r,s,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,a),height:Math.min(r.height,o)},i),r.width=a,r.height=o,r.data=s.data}}function i7(r,n,i,a,o,s){if(0===o.width||0===o.height)return n;if(o.width>r.width||o.height>r.height||i.x>r.width-o.width||i.y>r.height-o.height)throw RangeError("out of range source coordinates for image copy");if(o.width>n.width||o.height>n.height||a.x>n.width-o.width||a.y>n.height-o.height)throw RangeError("out of range destination coordinates for image copy");for(var l=r.data,c=n.data,u=0;u<o.height;u++)for(var f=((i.y+u)*r.width+i.x)*s,h=((a.y+u)*n.width+a.x)*s,p=0;p<o.width*s;p++)c[h+p]=l[f+p];return n}r5("HeatmapBucket",i6,{omit:["layers"]});var at=function(r,n){i8(this,r,1,n)};at.prototype.resize=function(r){i9(this,r,1)},at.prototype.clone=function(){return new at({width:this.width,height:this.height},new Uint8Array(this.data))},at.copy=function(r,n,i,a,o){i7(r,n,i,a,o,1)};var ae=function(r,n){i8(this,r,4,n)};ae.prototype.resize=function(r){i9(this,r,4)},ae.prototype.replace=function(r,n){n?this.data.set(r):r instanceof Uint8ClampedArray?this.data=new Uint8Array(r.buffer):this.data=r},ae.prototype.clone=function(){return new ae({width:this.width,height:this.height},new Uint8Array(this.data))},ae.copy=function(r,n,i,a,o){i7(r,n,i,a,o,4)},r5("AlphaImage",at),r5("RGBAImage",ae);var ar={paint:new nI({"heatmap-radius":new nE(tA.paint_heatmap["heatmap-radius"]),"heatmap-weight":new nE(tA.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new nS(tA.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nP(tA.paint_heatmap["heatmap-color"]),"heatmap-opacity":new nS(tA.paint_heatmap["heatmap-opacity"])})};function an(r,n){for(var i=new Uint8Array(1024),a={},o=0,s=0;o<256;o++,s+=4){a[n]=o/255;var l=r.evaluate(a);i[s+0]=Math.floor(255*l.r/l.a),i[s+1]=Math.floor(255*l.g/l.a),i[s+2]=Math.floor(255*l.b/l.a),i[s+3]=Math.floor(255*l.a)}return new ae({width:256,height:1},i)}var ai=function(r){function n(n){r.call(this,n,ar),this._updateColorRamp()}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.createBucket=function(r){return new i6(r)},n.prototype._handleSpecialPaintPropertyUpdate=function(r){"heatmap-color"===r&&this._updateColorRamp()},n.prototype._updateColorRamp=function(){var r=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=an(r,"heatmapDensity"),this.colorRampTexture=null},n.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},n}(nO),aa={paint:new nI({"hillshade-illumination-direction":new nS(tA.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new nS(tA.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new nS(tA.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new nS(tA.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new nS(tA.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new nS(tA.paint_hillshade["hillshade-accent-color"])})},ao=function(r){function n(n){r.call(this,n,aa)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},n}(nO),as=nF([{name:"a_pos",components:2,type:"Int16"}],4).members,al=ac;function ac(r,n,i){i=i||2;var a,o,s,l,c,u,f,h=n&&n.length,p=h?n[0]*i:r.length,d=au(r,0,p,i,!0),m=[];if(!d||d.next===d.prev)return m;if(h&&(d=function(r,n,i,a){var o,s,l,c,u,f=[];for(o=0,s=n.length;o<s;o++)l=n[o]*a,c=o<s-1?n[o+1]*a:r.length,(u=au(r,l,c,a,!1))===u.next&&(u.steiner=!0),f.push(function(r){var n=r,i=r;do(n.x<i.x||n.x===i.x&&n.y<i.y)&&(i=n),n=n.next;while(n!==r);return i}(u));for(f.sort(ah),o=0;o<f.length;o++)(function(r,n){if(n=function(r,n){var i,a,o,s=n,l=r.x,c=r.y,u=-1/0;do{if(c<=s.y&&c>=s.next.y&&s.next.y!==s.y){var f=s.x+(c-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(f<=l&&f>u){if(u=f,f===l){if(c===s.y)return s;if(c===s.next.y)return s.next}o=s.x<s.next.x?s:s.next}}s=s.next}while(s!==n);if(!o)return null;if(l===u)return o;var h,p=o,d=o.x,m=o.y,g=1/0;s=o;do l>=s.x&&s.x>=d&&l!==s.x&&ad(c<m?l:u,c,d,m,c<m?u:l,c,s.x,s.y)&&(h=Math.abs(c-s.y)/(l-s.x),ab(s,r)&&(h<g||h===g&&(s.x>o.x||s.x===o.x&&(i=o,a=s,0>am(i.prev,i,a.prev)&&0>am(a.next,i,i.next))))&&(o=s,g=h)),s=s.next;while(s!==p);return o}(r,n)){var i=a_(n,r);af(n,n.next),af(i,i.next)}})(f[o],i),i=af(i,i.next);return i}(r,n,d,i)),r.length>80*i){a=s=r[0],o=l=r[1];for(var g=i;g<p;g+=i)(c=r[g])<a&&(a=c),(u=r[g+1])<o&&(o=u),c>s&&(s=c),u>l&&(l=u);f=0!==(f=Math.max(s-a,l-o))?1/f:0}return function r(n,i,a,o,s,l,c){if(n){!c&&l&&function(r,n,i,a){var o=r;do null===o.z&&(o.z=ap(o.x,o.y,n,i,a)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==r);o.prevZ.nextZ=null,o.prevZ=null,function(r){var n,i,a,o,s,l,c,u,f=1;do{for(i=r,r=null,s=null,l=0;i;){for(l++,a=i,c=0,n=0;n<f&&(c++,a=a.nextZ);n++);for(u=f;c>0||u>0&&a;)0!==c&&(0===u||!a||i.z<=a.z)?(o=i,i=i.nextZ,c--):(o=a,a=a.nextZ,u--),s?s.nextZ=o:r=o,o.prevZ=s,s=o;i=a}s.nextZ=null,f*=2}while(l>1)}(o)}(n,o,s,l);for(var u,f,h=n;n.prev!==n.next;)if(u=n.prev,f=n.next,l?function(r,n,i,a){var o=r.prev,s=r.next;if(am(o,r,s)>=0)return!1;for(var l=o.x<r.x?o.x<s.x?o.x:s.x:r.x<s.x?r.x:s.x,c=o.y<r.y?o.y<s.y?o.y:s.y:r.y<s.y?r.y:s.y,u=o.x>r.x?o.x>s.x?o.x:s.x:r.x>s.x?r.x:s.x,f=o.y>r.y?o.y>s.y?o.y:s.y:r.y>s.y?r.y:s.y,h=ap(l,c,n,i,a),p=ap(u,f,n,i,a),d=r.prevZ,m=r.nextZ;d&&d.z>=h&&m&&m.z<=p;){if(d!==r.prev&&d!==r.next&&ad(o.x,o.y,r.x,r.y,s.x,s.y,d.x,d.y)&&am(d.prev,d,d.next)>=0||(d=d.prevZ,m!==r.prev&&m!==r.next&&ad(o.x,o.y,r.x,r.y,s.x,s.y,m.x,m.y)&&am(m.prev,m,m.next)>=0))return!1;m=m.nextZ}for(;d&&d.z>=h;){if(d!==r.prev&&d!==r.next&&ad(o.x,o.y,r.x,r.y,s.x,s.y,d.x,d.y)&&am(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;m&&m.z<=p;){if(m!==r.prev&&m!==r.next&&ad(o.x,o.y,r.x,r.y,s.x,s.y,m.x,m.y)&&am(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}(n,o,s,l):function(r){var n=r.prev,i=r.next;if(am(n,r,i)>=0)return!1;for(var a=r.next.next;a!==r.prev;){if(ad(n.x,n.y,r.x,r.y,i.x,i.y,a.x,a.y)&&am(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}(n))i.push(u.i/a),i.push(n.i/a),i.push(f.i/a),aT(n),n=f.next,h=f.next;else if((n=f)===h){c?1===c?r(n=function(r,n,i){var a=r;do{var o=a.prev,s=a.next.next;!ag(o,s)&&av(o,a,a.next,s)&&ab(o,s)&&ab(s,o)&&(n.push(o.i/i),n.push(a.i/i),n.push(s.i/i),aT(a),aT(a.next),a=r=s),a=a.next}while(a!==r);return af(a)}(af(n),i,a),i,a,o,s,l,2):2===c&&function(n,i,a,o,s,l){var c=n;do{for(var u,f,h=c.next.next;h!==c.prev;){if(c.i!==h.i&&(u=c,f=h,u.next.i!==f.i&&u.prev.i!==f.i&&!function(r,n){var i=r;do{if(i.i!==r.i&&i.next.i!==r.i&&i.i!==n.i&&i.next.i!==n.i&&av(i,i.next,r,n))return!0;i=i.next}while(i!==r);return!1}(u,f)&&(ab(u,f)&&ab(f,u)&&function(r,n){var i=r,a=!1,o=(r.x+n.x)/2,s=(r.y+n.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&o<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(a=!a),i=i.next;while(i!==r);return a}(u,f)&&(am(u.prev,u,f.prev)||am(u,f.prev,f))||ag(u,f)&&am(u.prev,u,u.next)>0&&am(f.prev,f,f.next)>0))){var p=a_(c,h);return c=af(c,c.next),p=af(p,p.next),r(c,i,a,o,s,l),void r(p,i,a,o,s,l)}h=h.next}c=c.next}while(c!==n)}(n,i,a,o,s,l):r(af(n),i,a,o,s,l,1);break}}}(d,m,i,a,o,f),m}function au(r,n,i,a,o){var s,l;if(o===aA(r,n,i,a)>0)for(s=n;s<i;s+=a)l=aw(s,r[s],r[s+1],l);else for(s=i-a;s>=n;s-=a)l=aw(s,r[s],r[s+1],l);return l&&ag(l,l.next)&&(aT(l),l=l.next),l}function af(r,n){if(!r)return r;n||(n=r);var i,a=r;do if(i=!1,a.steiner||!ag(a,a.next)&&0!==am(a.prev,a,a.next))a=a.next;else{if(aT(a),(a=n=a.prev)===a.next)break;i=!0}while(i||a!==n);return n}function ah(r,n){return r.x-n.x}function ap(r,n,i,a,o){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-i)*o)|r<<8))|r<<4))|r<<2))|r<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-a)*o)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function ad(r,n,i,a,o,s,l,c){return(o-l)*(n-c)-(r-l)*(s-c)>=0&&(r-l)*(a-c)-(i-l)*(n-c)>=0&&(i-l)*(s-c)-(o-l)*(a-c)>=0}function am(r,n,i){return(n.y-r.y)*(i.x-n.x)-(n.x-r.x)*(i.y-n.y)}function ag(r,n){return r.x===n.x&&r.y===n.y}function av(r,n,i,a){var o=ax(am(r,n,i)),s=ax(am(r,n,a)),l=ax(am(i,a,r)),c=ax(am(i,a,n));return o!==s&&l!==c||!(0!==o||!ay(r,i,n))||!(0!==s||!ay(r,a,n))||!(0!==l||!ay(i,r,a))||!(0!==c||!ay(i,n,a))}function ay(r,n,i){return n.x<=Math.max(r.x,i.x)&&n.x>=Math.min(r.x,i.x)&&n.y<=Math.max(r.y,i.y)&&n.y>=Math.min(r.y,i.y)}function ax(r){return r>0?1:r<0?-1:0}function ab(r,n){return 0>am(r.prev,r,r.next)?am(r,n,r.next)>=0&&am(r,r.prev,n)>=0:0>am(r,n,r.prev)||0>am(r,r.next,n)}function a_(r,n){var i=new ak(r.i,r.x,r.y),a=new ak(n.i,n.x,n.y),o=r.next,s=n.prev;return r.next=n,n.prev=r,i.next=o,o.prev=i,a.next=i,i.prev=a,s.next=a,a.prev=s,a}function aw(r,n,i,a){var o=new ak(r,n,i);return a?(o.next=a.next,o.prev=a,a.next.prev=o,a.next=o):(o.prev=o,o.next=o),o}function aT(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function ak(r,n,i){this.i=r,this.x=n,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function aA(r,n,i,a){for(var o=0,s=n,l=i-a;s<i;s+=a)o+=(r[l]-r[s])*(r[s+1]+r[l+1]),l=s;return o}function aM(r,n,i){var a=r[n];r[n]=r[i],r[i]=a}function aS(r,n){return r<n?-1:r>n?1:0}function aE(r,n){var i,a=r.length;if(a<=1)return[r];for(var o,s,l=[],c=0;c<a;c++){var u=function(r){for(var n=0,i=0,a=r.length,o=a-1,s=void 0,l=void 0;i<a;o=i++)s=r[i],n+=((l=r[o]).x-s.x)*(s.y+l.y);return n}(r[c]);0!==u&&(r[c].area=Math.abs(u),void 0===s&&(s=u<0),s===u<0?(o&&l.push(o),o=[r[c]]):o.push(r[c]))}if(o&&l.push(o),n>1)for(var f=0;f<l.length;f++)l[f].length<=n||(function r(n,i,a,o,s){for(;o>a;){if(o-a>600){var l=o-a+1,c=i-a+1,u=Math.log(l),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(l-f)/l)*(c-l/2<0?-1:1),p=Math.max(a,Math.floor(i-c*f/l+h)),d=Math.min(o,Math.floor(i+(l-c)*f/l+h));r(n,i,p,d,s)}var m=n[i],g=a,v=o;for(aM(n,a,i),s(n[o],m)>0&&aM(n,a,o);g<v;){for(aM(n,g,v),g++,v--;0>s(n[g],m);)g++;for(;s(n[v],m)>0;)v--}0===s(n[a],m)?aM(n,a,v):aM(n,++v,o),v<=i&&(a=v+1),i<=v&&(o=v-1)}}(i=l[f],n,1,l[f].length-1||i.length-1,aL||aS),l[f]=l[f].slice(0,n));return l}function aL(r,n){return n.area-r.area}function aC(r,n,i){for(var a=i.patternDependencies,o=!1,s=0;s<n.length;s+=1){var l=n[s].paint.get(r+"-pattern");l.isConstant()||(o=!0);var c=l.constantOr(null);c&&(o=!0,a[c.to]=!0,a[c.from]=!0)}return o}function aP(r,n,i,a,o){for(var s=o.patternDependencies,l=0;l<n.length;l+=1){var c=n[l],u=c.paint.get(r+"-pattern").value;if("constant"!==u.kind){var f=u.evaluate({zoom:a-1},i,{},o.availableImages),h=u.evaluate({zoom:a},i,{},o.availableImages),p=u.evaluate({zoom:a+1},i,{},o.availableImages);f=f&&f.name?f.name:f,h=h&&h.name?h.name:h,p=p&&p.name?p.name:p,s[f]=!0,s[h]=!0,s[p]=!0,i.patterns[c.id]={min:f,mid:h,max:p}}}return i}ac.deviation=function(r,n,i,a){var o=n&&n.length,s=o?n[0]*i:r.length,l=Math.abs(aA(r,0,s,i));if(o)for(var c=0,u=n.length;c<u;c++){var f=n[c]*i,h=c<u-1?n[c+1]*i:r.length;l-=Math.abs(aA(r,f,h,i))}var p=0;for(c=0;c<a.length;c+=3){var d=a[c]*i,m=a[c+1]*i,g=a[c+2]*i;p+=Math.abs((r[d]-r[g])*(r[m+1]-r[d+1])-(r[d]-r[m])*(r[g+1]-r[d+1]))}return 0===l&&0===p?0:Math.abs((p-l)/l)},ac.flatten=function(r){for(var n=r[0][0].length,i={vertices:[],holes:[],dimensions:n},a=0,o=0;o<r.length;o++){for(var s=0;s<r[o].length;s++)for(var l=0;l<n;l++)i.vertices.push(r[o][s][l]);o>0&&(a+=r[o-1].length,i.holes.push(a))}return i},al.default=ac;var aI=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new nN,this.indexArray=new nK,this.indexArray2=new n3,this.programConfigurations=new iz(as,r.layers,r.zoom),this.segments=new ic,this.segments2=new ic,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};aI.prototype.populate=function(r,n,i){this.hasPattern=aC("fill",this.layers,n);for(var a=this.layers[0].layout.get("fill-sort-key"),o=[],s=0;s<r.length;s+=1){var l=r[s],c=l.feature,u=l.id,f=l.index,h=l.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,d={type:c.type,id:u,properties:c.properties,geometry:p?iN(c):[]};if(this.layers[0]._featureFilter.filter(new ny(this.zoom),d,i)){p||(d.geometry=iN(c));var m=a?a.evaluate(d,{},i,n.availableImages):void 0,g={id:u,properties:c.properties,type:c.type,sourceLayerIndex:h,index:f,geometry:d.geometry,patterns:{},sortKey:m};o.push(g)}}a&&o.sort(function(r,n){return r.sortKey-n.sortKey});for(var v=0;v<o.length;v+=1){var y=o[v],x=y.geometry,b=y.index,_=y.sourceLayerIndex;if(this.hasPattern){var w=aP("fill",this.layers,y,this.zoom,n);this.patternFeatures.push(w)}else this.addFeature(y,x,b,i,{});var T=r[b].feature;n.featureIndex.insert(T,x,b,_,this.index)}},aI.prototype.update=function(r,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,n,this.stateDependentLayers,i)},aI.prototype.addFeatures=function(r,n,i){for(var a=0,o=this.patternFeatures;a<o.length;a+=1){var s=o[a];this.addFeature(s,s.geometry,s.index,n,i)}},aI.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},aI.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},aI.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,as),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0},aI.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},aI.prototype.addFeature=function(r,n,i,a,o){for(var s=0,l=aE(n,500);s<l.length;s+=1){for(var c=l[s],u=0,f=0;f<c.length;f+=1)u+=c[f].length;for(var h=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray),p=h.vertexLength,d=[],m=[],g=0;g<c.length;g+=1){var v=c[g];if(0!==v.length){v!==c[0]&&m.push(d.length/2);var y=this.segments2.prepareSegment(v.length,this.layoutVertexArray,this.indexArray2),x=y.vertexLength;this.layoutVertexArray.emplaceBack(v[0].x,v[0].y),this.indexArray2.emplaceBack(x+v.length-1,x),d.push(v[0].x),d.push(v[0].y);for(var b=1;b<v.length;b++)this.layoutVertexArray.emplaceBack(v[b].x,v[b].y),this.indexArray2.emplaceBack(x+b-1,x+b),d.push(v[b].x),d.push(v[b].y);y.vertexLength+=v.length,y.primitiveLength+=v.length}}for(var _=al(d,m),w=0;w<_.length;w+=3)this.indexArray.emplaceBack(p+_[w],p+_[w+1],p+_[w+2]);h.vertexLength+=u,h.primitiveLength+=_.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,i,o,a)},r5("FillBucket",aI,{omit:["layers","patternFeatures"]});var aO=new nI({"fill-sort-key":new nE(tA.layout_fill["fill-sort-key"])}),az={paint:new nI({"fill-antialias":new nS(tA.paint_fill["fill-antialias"]),"fill-opacity":new nE(tA.paint_fill["fill-opacity"]),"fill-color":new nE(tA.paint_fill["fill-color"]),"fill-outline-color":new nE(tA.paint_fill["fill-outline-color"]),"fill-translate":new nS(tA.paint_fill["fill-translate"]),"fill-translate-anchor":new nS(tA.paint_fill["fill-translate-anchor"]),"fill-pattern":new nL(tA.paint_fill["fill-pattern"])}),layout:aO},aD=function(r){function n(n){r.call(this,n,az)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.recalculate=function(n,i){r.prototype.recalculate.call(this,n,i);var a=this.paint._values["fill-outline-color"];"constant"===a.value.kind&&void 0===a.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},n.prototype.createBucket=function(r){return new aI(r)},n.prototype.queryRadius=function(){return iJ(this.paint.get("fill-translate"))},n.prototype.queryIntersectsFeature=function(r,n,i,a,o,s,l){return iH(iK(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,l),a)},n.prototype.isTileClipped=function(){return!0},n}(nO),aR=nF([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members;function aF(r,n,i,a,o){this.properties={},this.extent=i,this.type=0,this._pbf=r,this._geometry=-1,this._keys=a,this._values=o,r.readFields(aB,this,n)}function aB(r,n,i){1==r?n.id=i.readVarint():2==r?function(r,n){for(var i=r.readVarint()+r.pos;r.pos<i;){var a=n._keys[r.readVarint()],o=n._values[r.readVarint()];n.properties[a]=o}}(i,n):3==r?n.type=i.readVarint():4==r&&(n._geometry=i.pos)}function aN(r,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(aj,this,n),this.length=this._features.length}function aj(r,n,i){15===r?n.version=i.readVarint():1===r?n.name=i.readString():5===r?n.extent=i.readVarint():2===r?n._features.push(i.pos):3===r?n._keys.push(i.readString()):4===r&&n._values.push(function(r){for(var n=null,i=r.readVarint()+r.pos;r.pos<i;){var a=r.readVarint()>>3;n=1===a?r.readString():2===a?r.readFloat():3===a?r.readDouble():4===a?r.readVarint64():5===a?r.readVarint():6===a?r.readSVarint():7===a?r.readBoolean():null}return n}(i))}function aU(r,n,i){if(3===r){var a=new aN(i,i.readVarint()+i.pos);a.length&&(n[a.name]=a)}}aF.types=["Unknown","Point","LineString","Polygon"],aF.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var n,i=r.readVarint()+r.pos,o=1,s=0,l=0,c=0,u=[];r.pos<i;){if(s<=0){var f=r.readVarint();o=7&f,s=f>>3}if(s--,1===o||2===o)l+=r.readSVarint(),c+=r.readSVarint(),1===o&&(n&&u.push(n),n=[]),n.push(new a(l,c));else{if(7!==o)throw Error("unknown command "+o);n&&n.push(n[0].clone())}}return n&&u.push(n),u},aF.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var n=r.readVarint()+r.pos,i=1,a=0,o=0,s=0,l=1/0,c=-1/0,u=1/0,f=-1/0;r.pos<n;){if(a<=0){var h=r.readVarint();i=7&h,a=h>>3}if(a--,1===i||2===i)(o+=r.readSVarint())<l&&(l=o),o>c&&(c=o),(s+=r.readSVarint())<u&&(u=s),s>f&&(f=s);else if(7!==i)throw Error("unknown command "+i)}return[l,u,c,f]},aF.prototype.toGeoJSON=function(r,n,i){var a,o,s=this.extent*Math.pow(2,i),l=this.extent*r,c=this.extent*n,u=this.loadGeometry(),f=aF.types[this.type];function h(r){for(var n=0;n<r.length;n++){var i=r[n],a=180-360*(i.y+c)/s;r[n]=[360*(i.x+l)/s-180,360/Math.PI*Math.atan(Math.exp(a*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(a=0;a<u.length;a++)p[a]=u[a][0];h(u=p);break;case 2:for(a=0;a<u.length;a++)h(u[a]);break;case 3:for(u=function(r){var n=r.length;if(n<=1)return[r];for(var i,a,o=[],s=0;s<n;s++){var l=function(r){for(var n,i,a=0,o=0,s=r.length,l=s-1;o<s;l=o++)n=r[o],a+=((i=r[l]).x-n.x)*(n.y+i.y);return a}(r[s]);0!==l&&(void 0===a&&(a=l<0),a===l<0?(i&&o.push(i),i=[r[s]]):i.push(r[s]))}return i&&o.push(i),o}(u),a=0;a<u.length;a++)for(o=0;o<u[a].length;o++)h(u[a][o])}1===u.length?u=u[0]:f="Multi"+f;var d={type:"Feature",geometry:{type:f,coordinates:u},properties:this.properties};return"id"in this&&(d.id=this.id),d},aN.prototype.feature=function(r){if(r<0||r>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[r];var n=this._pbf.readVarint()+this._pbf.pos;return new aF(this._pbf,n,this.extent,this._keys,this._values)};var aV={VectorTile:function(r,n){this.layers=r.readFields(aU,{},n)},VectorTileFeature:aF,VectorTileLayer:aN},aH=aV.VectorTileFeature.types;function aq(r,n,i,a,o,s,l,c){r.emplaceBack(n,i,2*Math.floor(8192*a)+l,16384*o,16384*s,Math.round(c))}var aG=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new nU,this.indexArray=new nK,this.programConfigurations=new iz(aR,r.layers,r.zoom),this.segments=new ic,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};aG.prototype.populate=function(r,n,i){this.features=[],this.hasPattern=aC("fill-extrusion",this.layers,n);for(var a=0;a<r.length;a+=1){var o=r[a],s=o.feature,l=o.id,c=o.index,u=o.sourceLayerIndex,f=this.layers[0]._featureFilter.needGeometry,h={type:s.type,id:l,properties:s.properties,geometry:f?iN(s):[]};if(this.layers[0]._featureFilter.filter(new ny(this.zoom),h,i)){var p={id:l,sourceLayerIndex:u,index:c,geometry:f?h.geometry:iN(s),properties:s.properties,type:s.type,patterns:{}};void 0!==s.id&&(p.id=s.id),this.hasPattern?this.features.push(aP("fill-extrusion",this.layers,p,this.zoom,n)):this.addFeature(p,p.geometry,c,i,{}),n.featureIndex.insert(s,p.geometry,c,u,this.index,!0)}}},aG.prototype.addFeatures=function(r,n,i){for(var a=0,o=this.features;a<o.length;a+=1){var s=o[a],l=s.geometry;this.addFeature(s,l,s.index,n,i)}},aG.prototype.update=function(r,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,n,this.stateDependentLayers,i)},aG.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},aG.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},aG.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,aR),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},aG.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},aG.prototype.addFeature=function(r,n,i,a,o){for(var s=0,l=aE(n,500);s<l.length;s+=1){for(var c=l[s],u=0,f=0;f<c.length;f+=1)u+=c[f].length;for(var h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),p=0;p<c.length;p+=1){var d=c[p];if(0!==d.length&&!(d.every(function(r){return r.x<0})||d.every(function(r){return r.x>8192})||d.every(function(r){return r.y<0})||d.every(function(r){return r.y>8192})))for(var m=0,g=0;g<d.length;g++){var v=d[g];if(g>=1){var y=d[g-1];if((v.x!==y.x||!(v.x<0)&&!(v.x>8192))&&(v.y!==y.y||!(v.y<0)&&!(v.y>8192))){h.vertexLength+4>ic.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var x=v.sub(y)._perp()._unit(),b=y.dist(v);m+b>32768&&(m=0),aq(this.layoutVertexArray,v.x,v.y,x.x,x.y,0,0,m),aq(this.layoutVertexArray,v.x,v.y,x.x,x.y,0,1,m),m+=b,aq(this.layoutVertexArray,y.x,y.y,x.x,x.y,0,0,m),aq(this.layoutVertexArray,y.x,y.y,x.x,x.y,0,1,m);var _=h.vertexLength;this.indexArray.emplaceBack(_,_+2,_+1),this.indexArray.emplaceBack(_+1,_+2,_+3),h.vertexLength+=4,h.primitiveLength+=2}}}}if(h.vertexLength+u>ic.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(u,this.layoutVertexArray,this.indexArray)),"Polygon"===aH[r.type]){for(var w=[],T=[],k=h.vertexLength,A=0;A<c.length;A+=1){var M=c[A];if(0!==M.length){M!==c[0]&&T.push(w.length/2);for(var S=0;S<M.length;S++){var E=M[S];aq(this.layoutVertexArray,E.x,E.y,0,0,1,1,0),w.push(E.x),w.push(E.y)}}}for(var L=al(w,T),C=0;C<L.length;C+=3)this.indexArray.emplaceBack(k+L[C],k+L[C+2],k+L[C+1]);h.primitiveLength+=L.length/3,h.vertexLength+=u}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,i,o,a)},r5("FillExtrusionBucket",aG,{omit:["layers","features"]});var aY={paint:new nI({"fill-extrusion-opacity":new nS(tA["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new nE(tA["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new nS(tA["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new nS(tA["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new nL(tA["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new nE(tA["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new nE(tA["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new nS(tA["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},aW=function(r){function n(n){r.call(this,n,aY)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.createBucket=function(r){return new aG(r)},n.prototype.queryRadius=function(){return iJ(this.paint.get("fill-extrusion-translate"))},n.prototype.is3D=function(){return!0},n.prototype.queryIntersectsFeature=function(r,n,i,o,s,l,c,u){var f=iK(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),l.angle,c),h=this.paint.get("fill-extrusion-height").evaluate(n,i),p=this.paint.get("fill-extrusion-base").evaluate(n,i),d=function(r,n,i,o){for(var s=[],l=0;l<r.length;l+=1){var c=r[l],u=[c.x,c.y,0,1];i3(u,u,n),s.push(new a(u[0]/u[3],u[1]/u[3]))}return s}(f,u,0,0),m=function(r,n,i,o){for(var s=[],l=[],c=o[8]*n,u=o[9]*n,f=o[10]*n,h=o[11]*n,p=o[8]*i,d=o[9]*i,m=o[10]*i,g=o[11]*i,v=0;v<r.length;v+=1){for(var y=r[v],x=[],b=[],_=0;_<y.length;_+=1){var w=y[_],T=w.x,k=w.y,A=o[0]*T+o[4]*k+o[12],M=o[1]*T+o[5]*k+o[13],S=o[2]*T+o[6]*k+o[14],E=o[3]*T+o[7]*k+o[15],L=S+f,C=E+h,P=A+p,I=M+d,O=S+m,z=E+g,D=new a((A+c)/C,(M+u)/C);D.z=L/C,x.push(D);var R=new a(P/z,I/z);R.z=O/z,b.push(R)}s.push(x),l.push(b)}return[s,l]}(o,p,h,u);return function(r,n,i){var a=1/0;iH(i,n)&&(a=aZ(i,n[0]));for(var o=0;o<n.length;o++)for(var s=n[o],l=r[o],c=0;c<s.length-1;c++){var u=s[c],f=s[c+1],h=l[c],p=[u,f,l[c+1],h,u];iV(i,p)&&(a=Math.min(a,aZ(i,p)))}return a!==1/0&&a}(m[0],m[1],d)},n}(nO);function aX(r,n){return r.x*n.x+r.y*n.y}function aZ(r,n){if(1===r.length){for(var i,a=0,o=n[a++];!i||o.equals(i);)if(!(i=n[a++]))return 1/0;for(;a<n.length;a++){var s=n[a],l=r[0],c=i.sub(o),u=s.sub(o),f=l.sub(o),h=aX(c,c),p=aX(c,u),d=aX(u,u),m=aX(f,c),g=aX(f,u),v=h*d-p*p,y=(d*m-p*g)/v,x=(h*g-p*m)/v,b=1-y-x,_=o.z*b+i.z*y+s.z*x;if(isFinite(_))return _}return 1/0}for(var w=1/0,T=0;T<n.length;T+=1)w=Math.min(w,n[T].z);return w}var aJ=nF([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,aK=aV.VectorTileFeature.types,aQ=Math.cos(Math.PI/180*37.5),a$=function(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new nV,this.indexArray=new nK,this.programConfigurations=new iz(aJ,r.layers,r.zoom),this.segments=new ic,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};a$.prototype.populate=function(r,n,i){this.hasPattern=aC("line",this.layers,n);for(var a=this.layers[0].layout.get("line-sort-key"),o=[],s=0;s<r.length;s+=1){var l=r[s],c=l.feature,u=l.id,f=l.index,h=l.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,d={type:c.type,id:u,properties:c.properties,geometry:p?iN(c):[]};if(this.layers[0]._featureFilter.filter(new ny(this.zoom),d,i)){p||(d.geometry=iN(c));var m=a?a.evaluate(d,{},i):void 0,g={id:u,properties:c.properties,type:c.type,sourceLayerIndex:h,index:f,geometry:d.geometry,patterns:{},sortKey:m};o.push(g)}}a&&o.sort(function(r,n){return r.sortKey-n.sortKey});for(var v=0;v<o.length;v+=1){var y=o[v],x=y.geometry,b=y.index,_=y.sourceLayerIndex;if(this.hasPattern){var w=aP("line",this.layers,y,this.zoom,n);this.patternFeatures.push(w)}else this.addFeature(y,x,b,i,{});var T=r[b].feature;n.featureIndex.insert(T,x,b,_,this.index)}},a$.prototype.update=function(r,n,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,n,this.stateDependentLayers,i)},a$.prototype.addFeatures=function(r,n,i){for(var a=0,o=this.patternFeatures;a<o.length;a+=1){var s=o[a];this.addFeature(s,s.geometry,s.index,n,i)}},a$.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},a$.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},a$.prototype.upload=function(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,aJ),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0},a$.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},a$.prototype.addFeature=function(r,n,i,a,o){for(var s=this.layers[0].layout,l=s.get("line-join").evaluate(r,{}),c=s.get("line-cap"),u=s.get("line-miter-limit"),f=s.get("line-round-limit"),h=0;h<n.length;h+=1){var p=n[h];this.addLine(p,r,l,c,u,f)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,i,o,a)},a$.prototype.addLine=function(r,n,i,a,o,s){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+n.properties.mapbox_clip_start,this.clipEnd=+n.properties.mapbox_clip_end;for(var l=0;l<r.length-1;l++)this.totalDistance+=r[l].dist(r[l+1]);this.updateScaledDistance()}for(var c="Polygon"===aK[n.type],u=r.length;u>=2&&r[u-1].equals(r[u-2]);)u--;for(var f=0;f<u-1&&r[f].equals(r[f+1]);)f++;if(!(u<(c?3:2))){"bevel"===i&&(o=1.05);var h,p=this.overscaling<=16?122880/(512*this.overscaling):0,d=this.segments.prepareSegment(10*u,this.layoutVertexArray,this.indexArray),m=void 0,g=void 0,v=void 0,y=void 0;this.e1=this.e2=-1,c&&(h=r[u-2],y=r[f].sub(h)._unit()._perp());for(var x=f;x<u;x++)if(!(g=x===u-1?c?r[f+1]:void 0:r[x+1])||!r[x].equals(g)){y&&(v=y),h&&(m=h),h=r[x],y=g?g.sub(h)._unit()._perp():v;var b=(v=v||y).add(y);0===b.x&&0===b.y||b._unit();var _=v.x*y.x+v.y*y.y,w=b.x*y.x+b.y*y.y,T=0!==w?1/w:1/0,k=2*Math.sqrt(2-2*w),A=w<aQ&&m&&g,M=v.x*y.y-v.y*y.x>0;if(A&&x>f){var S=h.dist(m);if(S>2*p){var E=h.sub(h.sub(m)._mult(p/S)._round());this.updateDistance(m,E),this.addCurrentVertex(E,v,0,0,d),m=E}}var L=m&&g,C=L?i:c?"butt":a;if(L&&"round"===C&&(T<s?C="miter":T<=2&&(C="fakeround")),"miter"===C&&T>o&&(C="bevel"),"bevel"===C&&(T>2&&(C="flipbevel"),T<o&&(C="miter")),m&&this.updateDistance(m,h),"miter"===C)b._mult(T),this.addCurrentVertex(h,b,0,0,d);else if("flipbevel"===C){if(T>100)b=y.mult(-1);else{var P=T*v.add(y).mag()/v.sub(y).mag();b._perp()._mult(P*(M?-1:1))}this.addCurrentVertex(h,b,0,0,d),this.addCurrentVertex(h,b.mult(-1),0,0,d)}else if("bevel"===C||"fakeround"===C){var I=-Math.sqrt(T*T-1),O=M?I:0,z=M?0:I;if(m&&this.addCurrentVertex(h,v,O,z,d),"fakeround"===C)for(var D=Math.round(180*k/Math.PI/20),R=1;R<D;R++){var F=R/D;if(.5!==F){var B=F-.5;F+=F*B*(F-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*B*B+(.848013+_*(.215638*_-1.06021)))}var N=y.sub(v)._mult(F)._add(v)._unit()._mult(M?-1:1);this.addHalfVertex(h,N.x,N.y,!1,M,0,d)}g&&this.addCurrentVertex(h,y,-O,-z,d)}else if("butt"===C)this.addCurrentVertex(h,b,0,0,d);else if("square"===C){var j=m?1:-1;this.addCurrentVertex(h,b,j,j,d)}else"round"===C&&(m&&(this.addCurrentVertex(h,v,0,0,d),this.addCurrentVertex(h,v,1,1,d,!0)),g&&(this.addCurrentVertex(h,y,-1,-1,d,!0),this.addCurrentVertex(h,y,0,0,d)));if(A&&x<u-1){var U=h.dist(g);if(U>2*p){var V=h.add(g.sub(h)._mult(p/U)._round());this.updateDistance(h,V),this.addCurrentVertex(V,y,0,0,d),h=V}}}}},a$.prototype.addCurrentVertex=function(r,n,i,a,o,s){void 0===s&&(s=!1);var l=n.x+n.y*i,c=n.y-n.x*i,u=-n.x+n.y*a,f=-n.y-n.x*a;this.addHalfVertex(r,l,c,s,!1,i,o),this.addHalfVertex(r,u,f,s,!0,-a,o),this.distance>16384&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(r,n,i,a,o,s))},a$.prototype.addHalfVertex=function(r,n,i,a,o,s,l){var c=r.x,u=r.y,f=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((c<<1)+(a?1:0),(u<<1)+(o?1:0),Math.round(63*n)+128,Math.round(63*i)+128,1+(0===s?0:s<0?-1:1)|(63&f)<<2,f>>6);var h=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,h),l.primitiveLength++),o?this.e2=h:this.e1=h},a$.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*32767:this.distance},a$.prototype.updateDistance=function(r,n){this.distance+=r.dist(n),this.updateScaledDistance()},r5("LineBucket",a$,{omit:["layers","patternFeatures"]});var a0=new nI({"line-cap":new nS(tA.layout_line["line-cap"]),"line-join":new nE(tA.layout_line["line-join"]),"line-miter-limit":new nS(tA.layout_line["line-miter-limit"]),"line-round-limit":new nS(tA.layout_line["line-round-limit"]),"line-sort-key":new nE(tA.layout_line["line-sort-key"])}),a1={paint:new nI({"line-opacity":new nE(tA.paint_line["line-opacity"]),"line-color":new nE(tA.paint_line["line-color"]),"line-translate":new nS(tA.paint_line["line-translate"]),"line-translate-anchor":new nS(tA.paint_line["line-translate-anchor"]),"line-width":new nE(tA.paint_line["line-width"]),"line-gap-width":new nE(tA.paint_line["line-gap-width"]),"line-offset":new nE(tA.paint_line["line-offset"]),"line-blur":new nE(tA.paint_line["line-blur"]),"line-dasharray":new nC(tA.paint_line["line-dasharray"]),"line-pattern":new nL(tA.paint_line["line-pattern"]),"line-gradient":new nP(tA.paint_line["line-gradient"])}),layout:a0},a2=new(function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.possiblyEvaluate=function(n,i){return i=new ny(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),r.prototype.possiblyEvaluate.call(this,n,i)},n.prototype.evaluate=function(n,i,a,o){return i=p({},i,{zoom:Math.floor(i.zoom)}),r.prototype.evaluate.call(this,n,i,a,o)},n}(nE))(a1.paint.properties["line-width"].specification);a2.useIntegerZoom=!0;var a3=function(r){function n(n){r.call(this,n,a1)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._handleSpecialPaintPropertyUpdate=function(r){"line-gradient"===r&&this._updateGradient()},n.prototype._updateGradient=function(){var r=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=an(r,"lineProgress"),this.gradientTexture=null},n.prototype.recalculate=function(n,i){r.prototype.recalculate.call(this,n,i),this.paint._values["line-floorwidth"]=a2.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)},n.prototype.createBucket=function(r){return new a$(r)},n.prototype.queryRadius=function(r){var n,i;return n=iZ("line-width",this,r),((i=iZ("line-gap-width",this,r))>0?i+2*n:n)/2+Math.abs(iZ("line-offset",this,r))+iJ(this.paint.get("line-translate"))},n.prototype.queryIntersectsFeature=function(r,n,i,o,s,l,c){var u,f,h=iK(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),l.angle,c),p=c/2*(u=this.paint.get("line-width").evaluate(n,i),(f=this.paint.get("line-gap-width").evaluate(n,i))>0?f+2*u:u),d=this.paint.get("line-offset").evaluate(n,i);return d&&(o=function(r,n){for(var i=[],o=new a(0,0),s=0;s<r.length;s++){for(var l=r[s],c=[],u=0;u<l.length;u++){var f=l[u-1],h=l[u],p=l[u+1],d=0===u?o:h.sub(f)._unit()._perp(),m=u===l.length-1?o:p.sub(h)._unit()._perp(),g=d._add(m)._unit(),v=g.x*m.x+g.y*m.y;g._mult(1/v),c.push(g._mult(n)._add(h))}i.push(c)}return i}(o,d*c)),function(r,n,i){for(var a=0;a<n.length;a++){var o=n[a];if(r.length>=3){for(var s=0;s<o.length;s++)if(iX(r,o[s]))return!0}if(function(r,n,i){if(r.length>1){if(iq(r,n))return!0;for(var a=0;a<n.length;a++)if(iG(n[a],r,i))return!0}for(var o=0;o<r.length;o++)if(iG(r[o],n,i))return!0;return!1}(r,o,i))return!0}return!1}(h,o,p)},n.prototype.isTileClipped=function(){return!0},n}(nO),a5=nF([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),a4=nF([{name:"a_projected_pos",components:3,type:"Float32"}],4),a6=(nF([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),nF([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),a8=(nF([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),nF([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),a9=nF([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);nF([{name:"triangle",components:3,type:"Uint16"}]),nF([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),nF([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),nF([{type:"Float32",name:"offsetX"}]),nF([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var a7={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","\xa2":"","\xa3":"","\xa5":"","\xa6":"","\xac":"","\xaf":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},ot=function(r,n,i,a,o){var s,l,c=8*o-a-1,u=(1<<c)-1,f=u>>1,h=-7,p=i?o-1:0,d=i?-1:1,m=r[n+p];for(p+=d,s=m&(1<<-h)-1,m>>=-h,h+=c;h>0;s=256*s+r[n+p],p+=d,h-=8);for(l=s&(1<<-h)-1,s>>=-h,h+=a;h>0;l=256*l+r[n+p],p+=d,h-=8);if(0===s)s=1-f;else{if(s===u)return l?NaN:1/0*(m?-1:1);l+=Math.pow(2,a),s-=f}return(m?-1:1)*l*Math.pow(2,s-a)},oe=function(r,n,i,a,o,s){var l,c,u,f=8*s-o-1,h=(1<<f)-1,p=h>>1,d=23===o?5960464477539062e-23:0,m=a?0:s-1,g=a?1:-1,v=n<0||0===n&&1/n<0?1:0;for(isNaN(n=Math.abs(n))||n===1/0?(c=isNaN(n)?1:0,l=h):(l=Math.floor(Math.log(n)/Math.LN2),n*(u=Math.pow(2,-l))<1&&(l--,u*=2),(n+=l+p>=1?d/u:d*Math.pow(2,1-p))*u>=2&&(l++,u/=2),l+p>=h?(c=0,l=h):l+p>=1?(c=(n*u-1)*Math.pow(2,o),l+=p):(c=n*Math.pow(2,p-1)*Math.pow(2,o),l=0));o>=8;r[i+m]=255&c,m+=g,c/=256,o-=8);for(l=l<<o|c,f+=o;f>0;r[i+m]=255&l,m+=g,l/=256,f-=8);r[i+m-g]|=128*v};function or(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}or.Varint=0,or.Fixed64=1,or.Bytes=2,or.Fixed32=5;var on="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function oi(r){return r.type===or.Bytes?r.readVarint()+r.pos:r.pos+1}function oa(r,n,i){var a=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));i.realloc(a);for(var o=i.pos-1;o>=r;o--)i.buf[o+a]=i.buf[o]}function oo(r,n){for(var i=0;i<r.length;i++)n.writeVarint(r[i])}function os(r,n){for(var i=0;i<r.length;i++)n.writeSVarint(r[i])}function ol(r,n){for(var i=0;i<r.length;i++)n.writeFloat(r[i])}function oc(r,n){for(var i=0;i<r.length;i++)n.writeDouble(r[i])}function ou(r,n){for(var i=0;i<r.length;i++)n.writeBoolean(r[i])}function of(r,n){for(var i=0;i<r.length;i++)n.writeFixed32(r[i])}function oh(r,n){for(var i=0;i<r.length;i++)n.writeSFixed32(r[i])}function op(r,n){for(var i=0;i<r.length;i++)n.writeFixed64(r[i])}function od(r,n){for(var i=0;i<r.length;i++)n.writeSFixed64(r[i])}function om(r,n){return(r[n]|r[n+1]<<8|r[n+2]<<16)+16777216*r[n+3]}function og(r,n,i){r[i]=n,r[i+1]=n>>>8,r[i+2]=n>>>16,r[i+3]=n>>>24}function ov(r,n){return(r[n]|r[n+1]<<8|r[n+2]<<16)+(r[n+3]<<24)}function oy(r,n,i){1===r&&i.readMessage(ox,n)}function ox(r,n,i){if(3===r){var a=i.readMessage(ob,{}),o=a.id,s=a.bitmap,l=a.width,c=a.height,u=a.left,f=a.top,h=a.advance;n.push({id:o,bitmap:new at({width:l+6,height:c+6},s),metrics:{width:l,height:c,left:u,top:f,advance:h}})}}function ob(r,n,i){1===r?n.id=i.readVarint():2===r?n.bitmap=i.readBytes():3===r?n.width=i.readVarint():4===r?n.height=i.readVarint():5===r?n.left=i.readSVarint():6===r?n.top=i.readSVarint():7===r&&(n.advance=i.readVarint())}function o_(r){for(var n=0,i=0,a=0;a<r.length;a+=1){var o=r[a];n+=o.w*o.h,i=Math.max(i,o.w)}r.sort(function(r,n){return n.h-r.h});for(var s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),i),h:1/0}],l=0,c=0,u=0;u<r.length;u+=1)for(var f=r[u],h=s.length-1;h>=0;h--){var p=s[h];if(!(f.w>p.w||f.h>p.h)){if(f.x=p.x,f.y=p.y,c=Math.max(c,f.y+f.h),l=Math.max(l,f.x+f.w),f.w===p.w&&f.h===p.h){var d=s.pop();h<s.length&&(s[h]=d)}else f.h===p.h?(p.x+=f.w,p.w-=f.w):(f.w===p.w||s.push({x:p.x+f.w,y:p.y,w:p.w-f.w,h:f.h}),p.y+=f.h,p.h-=f.h);break}}return{w:l,h:c,fill:n/(l*c)||0}}or.prototype={destroy:function(){this.buf=null},readFields:function(r,n,i){for(i=i||this.length;this.pos<i;){var a=this.readVarint(),o=a>>3,s=this.pos;this.type=7&a,r(o,n,this),this.pos===s&&this.skip(a)}return n},readMessage:function(r,n){return this.readFields(r,n,this.readVarint()+this.pos)},readFixed32:function(){var r=om(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=ov(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=om(this.buf,this.pos)+4294967296*om(this.buf,this.pos+4);return this.pos+=8,r},readSFixed64:function(){var r=om(this.buf,this.pos)+4294967296*ov(this.buf,this.pos+4);return this.pos+=8,r},readFloat:function(){var r=ot(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=ot(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var n,i,a=this.buf;return n=127&(i=a[this.pos++]),i<128?n:(n|=(127&(i=a[this.pos++]))<<7,i<128?n:(n|=(127&(i=a[this.pos++]))<<14,i<128?n:(n|=(127&(i=a[this.pos++]))<<21,i<128?n:function(r,n,i){var a,o,s,l=i.buf;if(o=(112&(s=l[i.pos++]))>>4,s<128||(o|=(127&(s=l[i.pos++]))<<3,s<128)||(o|=(127&(s=l[i.pos++]))<<10,s<128)||(o|=(127&(s=l[i.pos++]))<<17,s<128)||(o|=(127&(s=l[i.pos++]))<<24,s<128)||(o|=(1&(s=l[i.pos++]))<<31,s<128))return a=o,n?4294967296*a+(r>>>0):4294967296*(a>>>0)+(r>>>0);throw Error("Expected varint not more than 10 bytes")}(n|=(15&(i=a[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?-((r+1)/2):r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r,n=this.readVarint()+this.pos,i=this.pos;return this.pos=n,n-i>=12&&on?(r=this.buf,on.decode(r.subarray(i,n))):function(r,n,i){for(var a="",o=n;o<i;){var s,l,c,u=r[o],f=null,h=u>239?4:u>223?3:u>191?2:1;if(o+h>i)break;1===h?u<128&&(f=u):2===h?128==(192&(s=r[o+1]))&&(f=(31&u)<<6|63&s)<=127&&(f=null):3===h?(s=r[o+1],l=r[o+2],128==(192&s)&&128==(192&l)&&((f=(15&u)<<12|(63&s)<<6|63&l)<=2047||f>=55296&&f<=57343)&&(f=null)):4===h&&(s=r[o+1],l=r[o+2],c=r[o+3],128==(192&s)&&128==(192&l)&&128==(192&c)&&((f=(15&u)<<18|(63&s)<<12|(63&l)<<6|63&c)<=65535||f>=1114112)&&(f=null)),null===f?(f=65533,h=1):f>65535&&(f-=65536,a+=String.fromCharCode(f>>>10&1023|55296),f=56320|1023&f),a+=String.fromCharCode(f),o+=h}return a}(this.buf,i,n)},readBytes:function(){var r=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,r);return this.pos=r,n},readPackedVarint:function(r,n){if(this.type!==or.Bytes)return r.push(this.readVarint(n));var i=oi(this);for(r=r||[];this.pos<i;)r.push(this.readVarint(n));return r},readPackedSVarint:function(r){if(this.type!==or.Bytes)return r.push(this.readSVarint());var n=oi(this);for(r=r||[];this.pos<n;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==or.Bytes)return r.push(this.readBoolean());var n=oi(this);for(r=r||[];this.pos<n;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==or.Bytes)return r.push(this.readFloat());var n=oi(this);for(r=r||[];this.pos<n;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==or.Bytes)return r.push(this.readDouble());var n=oi(this);for(r=r||[];this.pos<n;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==or.Bytes)return r.push(this.readFixed32());var n=oi(this);for(r=r||[];this.pos<n;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==or.Bytes)return r.push(this.readSFixed32());var n=oi(this);for(r=r||[];this.pos<n;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==or.Bytes)return r.push(this.readFixed64());var n=oi(this);for(r=r||[];this.pos<n;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==or.Bytes)return r.push(this.readSFixed64());var n=oi(this);for(r=r||[];this.pos<n;)r.push(this.readSFixed64());return r},skip:function(r){var n=7&r;if(n===or.Varint)for(;this.buf[this.pos++]>127;);else if(n===or.Bytes)this.pos=this.readVarint()+this.pos;else if(n===or.Fixed32)this.pos+=4;else{if(n!==or.Fixed64)throw Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(r,n){this.writeVarint(r<<3|n)},realloc:function(r){for(var n=this.length||16;n<this.pos+r;)n*=2;if(n!==this.length){var i=new Uint8Array(n);i.set(this.buf),this.buf=i,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),og(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),og(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),og(this.buf,-1&r,this.pos),og(this.buf,Math.floor(1/4294967296*r),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),og(this.buf,-1&r,this.pos),og(this.buf,Math.floor(1/4294967296*r),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(r,n){var i,a,o,s,l;if(r>=0?(i=r%4294967296|0,a=r/4294967296|0):(a=~(-r/4294967296),4294967295^(i=~(-r%4294967296))?i=i+1|0:(i=0,a=a+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw Error("Given varint doesn't fit into 10 bytes");n.realloc(10),o=i,n.buf[n.pos++]=127&o|128,o>>>=7,n.buf[n.pos++]=127&o|128,o>>>=7,n.buf[n.pos++]=127&o|128,o>>>=7,n.buf[n.pos++]=127&o|128,o>>>=7,n.buf[n.pos]=127&o,l=(7&(s=a))<<4,n.buf[n.pos++]|=l|((s>>>=3)?128:0),s&&(n.buf[n.pos++]=127&s|((s>>>=7)?128:0),s)&&(n.buf[n.pos++]=127&s|((s>>>=7)?128:0),s)&&(n.buf[n.pos++]=127&s|((s>>>=7)?128:0),s)&&(n.buf[n.pos++]=127&s|((s>>>=7)?128:0),s&&(n.buf[n.pos++]=127&s))}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?-(2*r)-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var n=this.pos;this.pos=function(r,n,i){for(var a,o,s=0;s<n.length;s++){if((a=n.charCodeAt(s))>55295&&a<57344){if(!o){a>56319||s+1===n.length?(r[i++]=239,r[i++]=191,r[i++]=189):o=a;continue}if(a<56320){r[i++]=239,r[i++]=191,r[i++]=189,o=a;continue}a=o-55296<<10|a-56320|65536,o=null}else o&&(r[i++]=239,r[i++]=191,r[i++]=189,o=null);a<128?r[i++]=a:(a<2048?r[i++]=a>>6|192:(a<65536?r[i++]=a>>12|224:(r[i++]=a>>18|240,r[i++]=a>>12&63|128),r[i++]=a>>6&63|128),r[i++]=63&a|128)}return i}(this.buf,r,this.pos);var i=this.pos-n;i>=128&&oa(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeFloat:function(r){this.realloc(4),oe(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),oe(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var n=r.length;this.writeVarint(n),this.realloc(n);for(var i=0;i<n;i++)this.buf[this.pos++]=r[i]},writeRawMessage:function(r,n){this.pos++;var i=this.pos;r(n,this);var a=this.pos-i;a>=128&&oa(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeMessage:function(r,n,i){this.writeTag(r,or.Bytes),this.writeRawMessage(n,i)},writePackedVarint:function(r,n){n.length&&this.writeMessage(r,oo,n)},writePackedSVarint:function(r,n){n.length&&this.writeMessage(r,os,n)},writePackedBoolean:function(r,n){n.length&&this.writeMessage(r,ou,n)},writePackedFloat:function(r,n){n.length&&this.writeMessage(r,ol,n)},writePackedDouble:function(r,n){n.length&&this.writeMessage(r,oc,n)},writePackedFixed32:function(r,n){n.length&&this.writeMessage(r,of,n)},writePackedSFixed32:function(r,n){n.length&&this.writeMessage(r,oh,n)},writePackedFixed64:function(r,n){n.length&&this.writeMessage(r,op,n)},writePackedSFixed64:function(r,n){n.length&&this.writeMessage(r,od,n)},writeBytesField:function(r,n){this.writeTag(r,or.Bytes),this.writeBytes(n)},writeFixed32Field:function(r,n){this.writeTag(r,or.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(r,n){this.writeTag(r,or.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(r,n){this.writeTag(r,or.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(r,n){this.writeTag(r,or.Fixed64),this.writeSFixed64(n)},writeVarintField:function(r,n){this.writeTag(r,or.Varint),this.writeVarint(n)},writeSVarintField:function(r,n){this.writeTag(r,or.Varint),this.writeSVarint(n)},writeStringField:function(r,n){this.writeTag(r,or.Bytes),this.writeString(n)},writeFloatField:function(r,n){this.writeTag(r,or.Fixed32),this.writeFloat(n)},writeDoubleField:function(r,n){this.writeTag(r,or.Fixed64),this.writeDouble(n)},writeBooleanField:function(r,n){this.writeVarintField(r,!!n)}};var ow=function(r,n){var i=n.pixelRatio,a=n.version,o=n.stretchX,s=n.stretchY,l=n.content;this.paddedRect=r,this.pixelRatio=i,this.stretchX=o,this.stretchY=s,this.content=l,this.version=a},oT={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};oT.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},oT.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},oT.tlbr.get=function(){return this.tl.concat(this.br)},oT.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(ow.prototype,oT);var ok=function(r,n){var i={},a={};this.haveRenderCallbacks=[];var o=[];this.addImages(r,i,o),this.addImages(n,a,o);var s=o_(o),l=new ae({width:s.w||1,height:s.h||1});for(var c in r){var u=r[c],f=i[c].paddedRect;ae.copy(u.data,l,{x:0,y:0},{x:f.x+1,y:f.y+1},u.data)}for(var h in n){var p=n[h],d=a[h].paddedRect,m=d.x+1,g=d.y+1,v=p.data.width,y=p.data.height;ae.copy(p.data,l,{x:0,y:0},{x:m,y:g},p.data),ae.copy(p.data,l,{x:0,y:y-1},{x:m,y:g-1},{width:v,height:1}),ae.copy(p.data,l,{x:0,y:0},{x:m,y:g+y},{width:v,height:1}),ae.copy(p.data,l,{x:v-1,y:0},{x:m-1,y:g},{width:1,height:y}),ae.copy(p.data,l,{x:0,y:0},{x:m+v,y:g},{width:1,height:y})}this.image=l,this.iconPositions=i,this.patternPositions=a};ok.prototype.addImages=function(r,n,i){for(var a in r){var o=r[a],s={x:0,y:0,w:o.data.width+2,h:o.data.height+2};i.push(s),n[a]=new ow(s,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(a)}},ok.prototype.patchUpdatedImages=function(r,n){for(var i in r.dispatchRenderCallbacks(this.haveRenderCallbacks),r.updatedImages)this.patchUpdatedImage(this.iconPositions[i],r.getImage(i),n),this.patchUpdatedImage(this.patternPositions[i],r.getImage(i),n)},ok.prototype.patchUpdatedImage=function(r,n,i){if(r&&n&&r.version!==n.version){r.version=n.version;var a=r.tl,o=a[0],s=a[1];i.update(n.data,void 0,{x:o,y:s})}},r5("ImagePosition",ow),r5("ImageAtlas",ok);var oA={horizontal:1,vertical:2,horizontalOnly:3},oM=function(){this.scale=1,this.fontStack="",this.imageName=null};oM.forText=function(r,n){var i=new oM;return i.scale=r||1,i.fontStack=n,i},oM.forImage=function(r){var n=new oM;return n.imageName=r,n};var oS=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function oE(r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v){var y,x=oS.fromFeature(r,o);p===oA.vertical&&x.verticalizePunctuation();var b=nv.processBidirectionalText,_=nv.processStyledBidirectionalText;if(b&&1===x.sections.length){y=[];for(var w=0,T=b(x.toString(),oz(x,f,s,n,a,m,g));w<T.length;w+=1){var k=T[w],A=new oS;A.text=k,A.sections=x.sections;for(var M=0;M<k.length;M++)A.sectionIndex.push(0);y.push(A)}}else if(_){y=[];for(var S=0,E=_(x.text,x.sectionIndex,oz(x,f,s,n,a,m,g));S<E.length;S+=1){var L=E[S],C=new oS;C.text=L[0],C.sectionIndex=L[1],C.sections=x.sections,y.push(C)}}else y=function(r,n){for(var i=[],a=r.text,o=0,s=0;s<n.length;s+=1){var l=n[s];i.push(r.substring(o,l)),o=l}return o<a.length&&i.push(r.substring(o,a.length)),i}(x,oz(x,f,s,n,a,m,g));var P=[],I={positionedLines:P,text:x.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:p,iconsInText:!1,verticalizable:!1};return function(r,n,i,a,o,s,l,c,u,f,h,p){for(var d=0,m=-17,g=0,v=0,y="right"===c?1:"left"===c?0:.5,x=0,b=0;b<o.length;b+=1){var _=o[b];_.trim();var w=_.getMaxScale(),T=24*(w-1),k={positionedGlyphs:[],lineOffset:0};r.positionedLines[x]=k;var A=k.positionedGlyphs,M=0;if(_.length()){for(var S=0;S<_.length();S++){var E=_.getSection(S),L=_.getSectionIndex(S),C=_.getCharCode(S),P=0,I=null,O=null,z=null,D=24,R=!(u===oA.horizontal||!h&&!nn(C)||h&&(oL[C]||ne.Arabic(C)||ne["Arabic Supplement"](C)||ne["Arabic Extended-A"](C)||ne["Arabic Presentation Forms-A"](C)||ne["Arabic Presentation Forms-B"](C)));if(E.imageName){var F=a[E.imageName];if(!F)continue;z=E.imageName,r.iconsInText=r.iconsInText||!0,O=F.paddedRect;var B=F.displaySize;E.scale=24*E.scale/p,I={width:B[0],height:B[1],left:1,top:-3,advance:R?B[1]:B[0]},P=T+(24-B[1]*E.scale),D=I.advance;var N=R?B[0]*E.scale-24*w:B[1]*E.scale-24*w;N>0&&N>M&&(M=N)}else{var j=i[E.fontStack],U=j&&j[C];if(U&&U.rect)O=U.rect,I=U.metrics;else{var V=n[E.fontStack],H=V&&V[C];if(!H)continue;I=H.metrics}P=24*(w-E.scale)}R?(r.verticalizable=!0,A.push({glyph:C,imageName:z,x:d,y:m+P,vertical:R,scale:E.scale,fontStack:E.fontStack,sectionIndex:L,metrics:I,rect:O}),d+=D*E.scale+f):(A.push({glyph:C,imageName:z,x:d,y:m+P,vertical:R,scale:E.scale,fontStack:E.fontStack,sectionIndex:L,metrics:I,rect:O}),d+=I.advance*E.scale+f)}0!==A.length&&(g=Math.max(d-f,g),function(r,n,i,a,o){if(a||o)for(var s=r[i],l=s.metrics.advance*s.scale,c=(r[i].x+l)*a,u=0;u<=i;u++)r[u].x-=c,r[u].y+=o}(A,0,A.length-1,y,M)),d=0;var q=s*w+M;k.lineOffset=Math.max(M,T),m+=q,v=Math.max(q,v),++x}else m+=s,++x}var G=m- -17,Y=oD(l),W=Y.horizontalAlign,X=Y.verticalAlign;(function(r,n,i,a,o,s,l,c,u){var f=(n-i)*o,h=0;h=s!==l?-c*a- -17:(-a*u+.5)*l;for(var p=0;p<r.length;p+=1)for(var d=r[p],m=0,g=d.positionedGlyphs;m<g.length;m+=1){var v=g[m];v.x+=f,v.y+=h}})(r.positionedLines,y,W,X,g,v,s,G,o.length),r.top+=-X*G,r.bottom=r.top+G,r.left+=-W*g,r.right=r.left+g}(I,n,i,a,y,l,c,u,p,f,d,v),!function(r){for(var n=0;n<r.length;n+=1)if(0!==r[n].positionedGlyphs.length)return!1;return!0}(P)&&I}oS.fromFeature=function(r,n){for(var i=new oS,a=0;a<r.sections.length;a++){var o=r.sections[a];o.image?i.addImageSection(o):i.addTextSection(o,n)}return i},oS.prototype.length=function(){return this.text.length},oS.prototype.getSection=function(r){return this.sections[this.sectionIndex[r]]},oS.prototype.getSectionIndex=function(r){return this.sectionIndex[r]},oS.prototype.getCharCode=function(r){return this.text.charCodeAt(r)},oS.prototype.verticalizePunctuation=function(){this.text=function(r){for(var n="",i=0;i<r.length;i++){var a=r.charCodeAt(i+1)||null,o=r.charCodeAt(i-1)||null;a&&ni(a)&&!a7[r[i+1]]||o&&ni(o)&&!a7[r[i-1]]||!a7[r[i]]?n+=r[i]:n+=a7[r[i]]}return n}(this.text)},oS.prototype.trim=function(){for(var r=0,n=0;n<this.text.length&&oL[this.text.charCodeAt(n)];n++)r++;for(var i=this.text.length,a=this.text.length-1;a>=0&&a>=r&&oL[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(r,i),this.sectionIndex=this.sectionIndex.slice(r,i)},oS.prototype.substring=function(r,n){var i=new oS;return i.text=this.text.substring(r,n),i.sectionIndex=this.sectionIndex.slice(r,n),i.sections=this.sections,i},oS.prototype.toString=function(){return this.text},oS.prototype.getMaxScale=function(){var r=this;return this.sectionIndex.reduce(function(n,i){return Math.max(n,r.sections[i].scale)},0)},oS.prototype.addTextSection=function(r,n){this.text+=r.text,this.sections.push(oM.forText(r.scale,r.fontStack||n));for(var i=this.sections.length-1,a=0;a<r.text.length;++a)this.sectionIndex.push(i)},oS.prototype.addImageSection=function(r){var n=r.image?r.image.name:"";if(0!==n.length){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(oM.forImage(n)),this.sectionIndex.push(this.sections.length-1)):k("Reached maximum number of images 6401")}else k("Can't add FormattedSection with an empty image.")},oS.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var oL={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},oC={};function oP(r,n,i,a,o,s){if(n.imageName){var l=a[n.imageName];return l?l.displaySize[0]*n.scale*24/s+o:0}var c=i[n.fontStack],u=c&&c[r];return u?u.metrics.advance*n.scale+o:0}function oI(r,n,i,a){var o=Math.pow(r-n,2);return a?r<n?o/2:2*o:o+Math.abs(i)*i}function oO(r,n,i,a,o,s){for(var l=null,c=oI(n,i,o,s),u=0;u<a.length;u+=1){var f=a[u],h=oI(n-f.x,i,o,s)+f.badness;h<=c&&(l=f,c=h)}return{index:r,x:n,priorBreak:l,badness:c}}function oz(r,n,i,a,o,s,l){if("point"!==s||!r)return[];for(var c=[],u=function(r,n,i,a,o,s){for(var l=0,c=0;c<r.length();c++){var u=r.getSection(c);l+=oP(r.getCharCode(c),u,a,o,n,s)}return l/Math.max(1,Math.ceil(l/i))}(r,n,i,a,o,l),f=r.text.indexOf("")>=0,h=0,p=0;p<r.length();p++){var d=r.getSection(p),m=r.getCharCode(p);if(oL[m]||(h+=oP(m,d,a,o,n,l)),p<r.length()-1){var g=!!(!(m<11904)&&(ne["Bopomofo Extended"](m)||ne.Bopomofo(m)||ne["CJK Compatibility Forms"](m)||ne["CJK Compatibility Ideographs"](m)||ne["CJK Compatibility"](m)||ne["CJK Radicals Supplement"](m)||ne["CJK Strokes"](m)||ne["CJK Symbols and Punctuation"](m)||ne["CJK Unified Ideographs Extension A"](m)||ne["CJK Unified Ideographs"](m)||ne["Enclosed CJK Letters and Months"](m)||ne["Halfwidth and Fullwidth Forms"](m)||ne.Hiragana(m)||ne["Ideographic Description Characters"](m)||ne["Kangxi Radicals"](m)||ne["Katakana Phonetic Extensions"](m)||ne.Katakana(m)||ne["Vertical Forms"](m)||ne["Yi Radicals"](m)||ne["Yi Syllables"](m)));(oC[m]||g||d.imageName)&&c.push(oO(p+1,h,u,c,function(r,n,i){var a=0;return 10===r&&(a-=1e4),i&&(a+=150),40!==r&&65288!==r||(a+=50),41!==n&&65289!==n||(a+=50),a}(m,r.getCharCode(p+1),g&&f),!1))}}return function r(n){return n?r(n.priorBreak).concat(n.index):[]}(oO(r.length(),h,u,c,0,!0))}function oD(r){var n=.5,i=.5;switch(r){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:n,verticalAlign:i}}function oR(r,n,i,a,o,s){var l,c=r.image;if(c.content){var u=c.content,f=c.pixelRatio||1;l=[u[0]/f,u[1]/f,c.displaySize[0]-u[2]/f,c.displaySize[1]-u[3]/f]}var h,p,d,m,g=n.left*s,v=n.right*s;"width"===i||"both"===i?(m=o[0]+g-a[3],p=o[0]+v+a[1]):p=(m=o[0]+(g+v-c.displaySize[0])/2)+c.displaySize[0];var y=n.top*s,x=n.bottom*s;return"height"===i||"both"===i?(h=o[1]+y-a[0],d=o[1]+x+a[2]):d=(h=o[1]+(y+x-c.displaySize[1])/2)+c.displaySize[1],{image:c,top:h,right:p,bottom:d,left:m,collisionPadding:l}}oC[10]=!0,oC[32]=!0,oC[38]=!0,oC[40]=!0,oC[41]=!0,oC[43]=!0,oC[45]=!0,oC[47]=!0,oC[173]=!0,oC[183]=!0,oC[8203]=!0,oC[8208]=!0,oC[8211]=!0,oC[8231]=!0;var oF=function(r){function n(n,i,a,o){r.call(this,n,i),this.angle=a,void 0!==o&&(this.segment=o)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.clone=function(){return new n(this.x,this.y,this.angle,this.segment)},n}(a);function oB(r,n){var i=n.expression;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new ny(r+1))};if("source"===i.kind)return{kind:"source"};for(var a=i.zoomStops,o=i.interpolationType,s=0;s<a.length&&a[s]<=r;)s++;for(var l=s=Math.max(0,s-1);l<a.length&&a[l]<r+1;)l++;l=Math.min(a.length-1,l);var c=a[s],u=a[l];return"composite"===i.kind?{kind:"composite",minZoom:c,maxZoom:u,interpolationType:o}:{kind:"camera",minZoom:c,maxZoom:u,minSize:i.evaluate(new ny(c)),maxSize:i.evaluate(new ny(u)),interpolationType:o}}function oN(r,n,i){var a=n.uSize,o=n.uSizeT,s=i.lowerSize,l=i.upperSize;return"source"===r.kind?s/128:"composite"===r.kind?eA(s/128,l/128,o):a}function oj(r,n){var i=0,a=0;if("constant"===r.kind)a=r.layoutSize;else if("source"!==r.kind){var o=r.interpolationType,s=r.minZoom,l=r.maxZoom,c=o?f(ej.interpolationFactor(o,n,s,l),0,1):0;"camera"===r.kind?a=eA(r.minSize,r.maxSize,c):i=c}return{uSizeT:i,uSize:a}}r5("Anchor",oF);var oU=Object.freeze({__proto__:null,getSizeData:oB,evaluateSizeForFeature:oN,evaluateSizeForZoom:oj,SIZE_PACK_FACTOR:128});function oV(r,n,i,a,o){if(void 0===n.segment)return!0;for(var s=n,l=n.segment+1,c=0;c>-i/2;){if(--l<0)return!1;c-=r[l].dist(s),s=r[l]}c+=r[l].dist(r[l+1]),l++;for(var u=[],f=0;c<i/2;){var h=r[l-1],p=r[l],d=r[l+1];if(!d)return!1;var m=h.angleTo(p)-p.angleTo(d);for(m=Math.abs((m+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:c,angleDelta:m}),f+=m;c-u[0].distance>a;)f-=u.shift().angleDelta;if(f>o)return!1;l++,c+=p.dist(d)}return!0}function oH(r){for(var n=0,i=0;i<r.length-1;i++)n+=r[i].dist(r[i+1]);return n}function oq(r,n){return Math.max(r?r.right-r.left:0,n?n.right-n.left:0)}function oG(r,n,i,o,s){for(var l=[],c=0;c<r.length;c++)for(var u=r[c],f=void 0,h=0;h<u.length-1;h++){var p=u[h],d=u[h+1];p.x<n&&d.x<n||(p.x<n?p=new a(n,p.y+(d.y-p.y)*((n-p.x)/(d.x-p.x)))._round():d.x<n&&(d=new a(n,p.y+(d.y-p.y)*((n-p.x)/(d.x-p.x)))._round()),p.y<i&&d.y<i||(p.y<i?p=new a(p.x+(d.x-p.x)*((i-p.y)/(d.y-p.y)),i)._round():d.y<i&&(d=new a(p.x+(d.x-p.x)*((i-p.y)/(d.y-p.y)),i)._round()),p.x>=o&&d.x>=o||(p.x>=o?p=new a(o,p.y+(d.y-p.y)*((o-p.x)/(d.x-p.x)))._round():d.x>=o&&(d=new a(o,p.y+(d.y-p.y)*((o-p.x)/(d.x-p.x)))._round()),p.y>=s&&d.y>=s||(p.y>=s?p=new a(p.x+(d.x-p.x)*((s-p.y)/(d.y-p.y)),s)._round():d.y>=s&&(d=new a(p.x+(d.x-p.x)*((s-p.y)/(d.y-p.y)),s)._round()),f&&p.equals(f[f.length-1])||(f=[p],l.push(f)),f.push(d)))))}return l}function oY(r,n,i,o){var s=[],l=r.image,c=l.pixelRatio,u=l.paddedRect.w-2,f=l.paddedRect.h-2,h=r.right-r.left,p=r.bottom-r.top,d=l.stretchX||[[0,u]],m=l.stretchY||[[0,f]],g=function(r,n){return r+n[1]-n[0]},v=d.reduce(g,0),y=m.reduce(g,0),x=u-v,b=f-y,_=0,w=v,T=0,k=y,A=0,M=x,S=0,E=b;if(l.content&&o){var L=l.content;_=oW(d,0,L[0]),T=oW(m,0,L[1]),w=oW(d,L[0],L[2]),k=oW(m,L[1],L[3]),A=L[0]-_,S=L[1]-T,M=L[2]-L[0]-w,E=L[3]-L[1]-k}var C=function(o,s,u,f){var d,m,g,x,b=(o.stretch-_)/w*h+r.left,L=(d=o.fixed-A,d-M*o.stretch/v),C=(s.stretch-T)/k*p+r.top,P=(m=s.fixed-S,m-E*s.stretch/y),I=(u.stretch-_)/w*h+r.left,O=(g=u.fixed-A,g-M*u.stretch/v),z=(f.stretch-T)/k*p+r.top,D=(x=f.fixed-S,x-E*f.stretch/y),R=new a(b,C),F=new a(I,C),B=new a(I,z),N=new a(b,z),j=new a(L/c,P/c),U=new a(O/c,D/c),V=n*Math.PI/180;if(V){var H=Math.sin(V),q=Math.cos(V),G=[q,-H,H,q];R._matMult(G),F._matMult(G),N._matMult(G),B._matMult(G)}var Y=o.stretch+o.fixed,W=u.stretch+u.fixed,X=s.stretch+s.fixed,Z=f.stretch+f.fixed;return{tl:R,tr:F,bl:N,br:B,tex:{x:l.paddedRect.x+1+Y,y:l.paddedRect.y+1+X,w:W-Y,h:Z-X},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:j,pixelOffsetBR:U,minFontScaleX:M/c/h,minFontScaleY:E/c/p,isSDF:i}};if(o&&(l.stretchX||l.stretchY))for(var P=oX(d,x,v),I=oX(m,b,y),O=0;O<P.length-1;O++)for(var z=P[O],D=P[O+1],R=0;R<I.length-1;R++){var F=I[R],B=I[R+1];s.push(C(z,F,D,B))}else s.push(C({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:u+1},{fixed:0,stretch:f+1}));return s}function oW(r,n,i){for(var a=0,o=0;o<r.length;o+=1){var s=r[o];a+=Math.max(n,Math.min(i,s[1]))-Math.max(n,Math.min(i,s[0]))}return a}function oX(r,n,i){for(var a=[{fixed:-1,stretch:0}],o=0;o<r.length;o+=1){var s=r[o],l=s[0],c=s[1],u=a[a.length-1];a.push({fixed:l-u.stretch,stretch:u.stretch}),a.push({fixed:l-u.stretch,stretch:u.stretch+(c-l)})}return a.push({fixed:n+1,stretch:i}),a}var oZ=function(r,n,i,o,s,l,c,u,f,h){if(this.boxStartIndex=r.length,f){var p=l.top,d=l.bottom,m=l.collisionPadding;m&&(p-=m[1],d+=m[3]);var g=d-p;g>0&&(g=Math.max(10,g),this.circleDiameter=g)}else{var v=l.top*c-u,y=l.bottom*c+u,x=l.left*c-u,b=l.right*c+u,_=l.collisionPadding;if(_&&(x-=_[0]*c,v-=_[1]*c,b+=_[2]*c,y+=_[3]*c),h){var w=new a(x,v),T=new a(b,v),k=new a(x,y),A=new a(b,y),M=h*Math.PI/180;w._rotate(M),T._rotate(M),k._rotate(M),A._rotate(M),x=Math.min(w.x,T.x,k.x,A.x),b=Math.max(w.x,T.x,k.x,A.x),v=Math.min(w.y,T.y,k.y,A.y),y=Math.max(w.y,T.y,k.y,A.y)}r.emplaceBack(n.x,n.y,x,v,b,y,i,o,s)}this.boxEndIndex=r.length},oJ=function(r,n){if(void 0===r&&(r=[]),void 0===n&&(n=oK),this.data=r,this.length=this.data.length,this.compare=n,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function oK(r,n){return r<n?-1:r>n?1:0}function oQ(r,n){return n.max-r.max}function o$(r,n,i,o){this.p=new a(r,n),this.h=i,this.d=function(r,n){for(var i=!1,a=1/0,o=0;o<n.length;o++)for(var s=n[o],l=0,c=s.length,u=c-1;l<c;u=l++){var f=s[l],h=s[u];f.y>r.y!=h.y>r.y&&r.x<(h.x-f.x)*(r.y-f.y)/(h.y-f.y)+f.x&&(i=!i),a=Math.min(a,iY(r,f,h))}return(i?1:-1)*Math.sqrt(a)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}oJ.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},oJ.prototype.pop=function(){if(0!==this.length){var r=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),r}},oJ.prototype.peek=function(){return this.data[0]},oJ.prototype._up=function(r){for(var n=this.data,i=this.compare,a=n[r];r>0;){var o=r-1>>1,s=n[o];if(i(a,s)>=0)break;n[r]=s,r=o}n[r]=a},oJ.prototype._down=function(r){for(var n=this.data,i=this.compare,a=this.length>>1,o=n[r];r<a;){var s=1+(r<<1),l=n[s],c=s+1;if(c<this.length&&0>i(n[c],l)&&(s=c,l=n[c]),i(l,o)>=0)break;n[r]=l,r=s}n[r]=o};var o0=Number.POSITIVE_INFINITY;function o1(r,n){return n[1]!==o0?function(r,n,i){var a=0,o=0;switch(n=Math.abs(n),i=Math.abs(i),r){case"top-right":case"top-left":case"top":o=i-7;break;case"bottom-right":case"bottom-left":case"bottom":o=7-i}switch(r){case"top-right":case"bottom-right":case"right":a=-n;break;case"top-left":case"bottom-left":case"left":a=n}return[a,o]}(r,n[0],n[1]):function(r,n){var i=0,a=0;n<0&&(n=0);var o=n/Math.sqrt(2);switch(r){case"top-right":case"top-left":a=o-7;break;case"bottom-right":case"bottom-left":a=7-o;break;case"bottom":a=7-n;break;case"top":a=n-7}switch(r){case"top-right":case"bottom-right":i=-o;break;case"top-left":case"bottom-left":i=o;break;case"left":i=n;break;case"right":i=-n}return[i,a]}(r,n[0])}function o2(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function o3(r,n,i,o,s,l,c,u,f,h,p,d,m,g,v){var y=function(r,n,i,o,s,l,c,u){for(var f=o.layout.get("text-rotate").evaluate(l,{})*Math.PI/180,h=[],p=0,d=n.positionedLines;p<d.length;p+=1)for(var m=d[p],g=0,v=m.positionedGlyphs;g<v.length;g+=1){var y=v[g];if(y.rect){var x=y.rect||{},b=4,_=!0,w=1,T=0,k=(s||u)&&y.vertical,A=y.metrics.advance*y.scale/2;if(u&&n.verticalizable){var M=24*(y.scale-1),S=(24-y.metrics.width*y.scale)/2;T=m.lineOffset/2-(y.imageName?-S:M)}if(y.imageName){var E=c[y.imageName];_=E.sdf,b=1/(w=E.pixelRatio)}var L=s?[y.x+A,y.y]:[0,0],C=s?[0,0]:[y.x+A+i[0],y.y+i[1]-T],P=[0,0];k&&(P=C,C=[0,0]);var I=(y.metrics.left-b)*y.scale-A+C[0],O=(-y.metrics.top-b)*y.scale+C[1],z=I+x.w*y.scale/w,D=O+x.h*y.scale/w,R=new a(I,O),F=new a(z,O),B=new a(I,D),N=new a(z,D);if(k){var j=new a(-A,A- -17),U=-Math.PI/2,V=12-A,H=y.imageName?V:0,q=new a(22-V,-H),G=new(Function.prototype.bind.apply(a,[null].concat(P)));R._rotateAround(U,j)._add(q)._add(G),F._rotateAround(U,j)._add(q)._add(G),B._rotateAround(U,j)._add(q)._add(G),N._rotateAround(U,j)._add(q)._add(G)}if(f){var Y=Math.sin(f),W=Math.cos(f),X=[W,-Y,Y,W];R._matMult(X),F._matMult(X),B._matMult(X),N._matMult(X)}var Z=new a(0,0),J=new a(0,0);h.push({tl:R,tr:F,bl:B,br:N,tex:x,writingMode:n.writingMode,glyphOffset:L,sectionIndex:y.sectionIndex,isSDF:_,pixelOffsetTL:Z,pixelOffsetBR:J,minFontScaleX:0,minFontScaleY:0})}}return h}(0,i,u,s,l,c,o,r.allowVerticalPlacement),x=r.textSizeData,b=null;"source"===x.kind?(b=[128*s.layout.get("text-size").evaluate(c,{})])[0]>32640&&k(r.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===x.kind&&((b=[128*g.compositeTextSizes[0].evaluate(c,{},v),128*g.compositeTextSizes[1].evaluate(c,{},v)])[0]>32640||b[1]>32640)&&k(r.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),r.addSymbols(r.text,y,b,u,l,c,h,n,f.lineStartIndex,f.lineLength,m,v);for(var _=0;_<p.length;_+=1)d[p[_]]=r.text.placedSymbolArray.length-1;return 4*y.length}function o5(r){for(var n in r)return r[n];return null}var o4=aV.VectorTileFeature.types,o6=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function o8(r,n,i,a,o,s,l,c,u,f,h,p,d){var m=c?Math.min(32640,Math.round(c[0])):0,g=c?Math.min(32640,Math.round(c[1])):0;r.emplaceBack(n,i,Math.round(32*a),Math.round(32*o),s,l,(m<<1)+(u?1:0),g,16*f,16*h,256*p,256*d)}function o9(r,n,i){r.emplaceBack(n.x,n.y,i),r.emplaceBack(n.x,n.y,i),r.emplaceBack(n.x,n.y,i),r.emplaceBack(n.x,n.y,i)}var o7=function(r){this.layoutVertexArray=new nq,this.indexArray=new nK,this.programConfigurations=r,this.segments=new ic,this.dynamicLayoutVertexArray=new nG,this.opacityVertexArray=new nY,this.placedSymbolArray=new it};o7.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},o7.prototype.upload=function(r,n,i,a){this.isEmpty()||(i&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,a5.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,a4.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,o6,!0),this.opacityVertexBuffer.itemSize=1),(i||a)&&this.programConfigurations.upload(r))},o7.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},r5("SymbolBuffers",o7);var st=function(r,n,i){this.layoutVertexArray=new r,this.layoutAttributes=n,this.indexArray=new i,this.segments=new ic,this.collisionVertexArray=new nJ};st.prototype.upload=function(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,a6.members,!0)},st.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},r5("CollisionBuffers",st);var se=function(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=i1([]),this.placementViewportMatrix=i1([]);var n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=oB(this.zoom,n["text-size"]),this.iconSizeData=oB(this.zoom,n["icon-size"]);var i=this.layers[0].layout,a=i.get("symbol-sort-key"),o=i.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==o&&void 0!==a.constantOr(1);var s="viewport-y"===o||"auto"===o&&!this.sortFeaturesByKey;this.sortFeaturesByY=s&&(i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement")),"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map(function(r){return oA[r]})),this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id}),this.sourceID=r.sourceID};se.prototype.createArrays=function(){this.text=new o7(new iz(a5.members,this.layers,this.zoom,function(r){return/^text/.test(r)})),this.icon=new o7(new iz(a5.members,this.layers,this.zoom,function(r){return/^icon/.test(r)})),this.glyphOffsetArray=new ii,this.lineVertexArray=new ia,this.symbolInstances=new ir},se.prototype.calculateGlyphDependencies=function(r,n,i,a,o){for(var s=0;s<r.length;s++)if(n[r.charCodeAt(s)]=!0,(i||a)&&o){var l=a7[r.charAt(s)];l&&(n[l.charCodeAt(0)]=!0)}},se.prototype.populate=function(r,n,i){var a=this.layers[0],o=a.layout,s=o.get("text-font"),l=o.get("text-field"),c=o.get("icon-image"),u=("constant"!==l.value.kind||l.value.value instanceof t$&&!l.value.value.isEmpty()||l.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),f="constant"!==c.value.kind||!!c.value.value||Object.keys(c.parameters).length>0,h=o.get("symbol-sort-key");if(this.features=[],u||f){for(var p=n.iconDependencies,d=n.glyphDependencies,m=n.availableImages,g=new ny(this.zoom),v=0;v<r.length;v+=1){var y=r[v],x=y.feature,b=y.id,_=y.index,w=y.sourceLayerIndex,T=a._featureFilter.needGeometry,k={type:x.type,id:b,properties:x.properties,geometry:T?iN(x):[]};if(a._featureFilter.filter(g,k,i)){T||(k.geometry=iN(x));var A=void 0;if(u){var M=a.getValueAndResolveTokens("text-field",k,i,m),S=t$.factory(M);(function(r){for(var n=0,i=r.sections;n<i.length;n+=1)if(function(r){for(var n=0;n<r.length;n+=1)if(na(r[n].charCodeAt(0)))return!0;return!1}(i[n].text))return!0;return!1})(S)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===nm()||this.hasRTLText&&nv.isParsed())&&(A=function(r,n,i){return r.sections.forEach(function(r){var a,o;r.text=(a=r.text,"uppercase"===(o=n.layout.get("text-transform").evaluate(i,{}))?a=a.toLocaleUpperCase():"lowercase"===o&&(a=a.toLocaleLowerCase()),nv.applyArabicShaping&&(a=nv.applyArabicShaping(a)),a)}),r}(S,a,k))}var E=void 0;if(f){var L=a.getValueAndResolveTokens("icon-image",k,i,m);E=L instanceof t0?L:t0.fromString(L)}if(A||E){var C=this.sortFeaturesByKey?h.evaluate(k,{},i):void 0,P={id:b,text:A,icon:E,index:_,sourceLayerIndex:w,geometry:iN(x),properties:x.properties,type:o4[x.type],sortKey:C};if(this.features.push(P),E&&(p[E.name]=!0),A){var I=s.evaluate(k,{},i).join(","),O="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(oA.vertical)>=0;for(var z=0,D=A.sections;z<D.length;z+=1){var R=D[z];if(R.image)p[R.image.name]=!0;else{var F=nr(A.toString()),B=R.fontStack||I,N=d[B]=d[B]||{};this.calculateGlyphDependencies(R.text,N,O,this.allowVerticalPlacement,F)}}}}}}"line"===o.get("symbol-placement")&&(this.features=function(r){var n={},i={},a=[],o=0;function s(n){a.push(r[n]),o++}function l(r,n,o){var s=i[r];return delete i[r],i[n]=s,a[s].geometry[0].pop(),a[s].geometry[0]=a[s].geometry[0].concat(o[0]),s}function c(r,i,o){var s=n[i];return delete n[i],n[r]=s,a[s].geometry[0].shift(),a[s].geometry[0]=o[0].concat(a[s].geometry[0]),s}function u(r,n,i){var a=i?n[0][n[0].length-1]:n[0][0];return r+":"+a.x+":"+a.y}for(var f=0;f<r.length;f++){var h=r[f],p=h.geometry,d=h.text?h.text.toString():null;if(d){var m=u(d,p),g=u(d,p,!0);if(m in i&&g in n&&i[m]!==n[g]){var v=c(m,g,p),y=l(m,g,a[v].geometry);delete n[m],delete i[g],i[u(d,a[y].geometry,!0)]=y,a[v].geometry=null}else m in i?l(m,g,p):g in n?c(m,g,p):(s(f),n[m]=o-1,i[g]=o-1)}else s(f)}return a.filter(function(r){return r.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(r,n){return r.sortKey-n.sortKey})}},se.prototype.update=function(r,n,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,n,this.layers,i),this.icon.programConfigurations.updatePaintArrays(r,n,this.layers,i))},se.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},se.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},se.prototype.upload=function(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},se.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},se.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},se.prototype.addToLineVertexArray=function(r,n){var i=this.lineVertexArray.length;if(void 0!==r.segment){for(var a=r.dist(n[r.segment+1]),o=r.dist(n[r.segment]),s={},l=r.segment+1;l<n.length;l++)s[l]={x:n[l].x,y:n[l].y,tileUnitDistanceFromAnchor:a},l<n.length-1&&(a+=n[l+1].dist(n[l]));for(var c=r.segment||0;c>=0;c--)s[c]={x:n[c].x,y:n[c].y,tileUnitDistanceFromAnchor:o},c>0&&(o+=n[c-1].dist(n[c]));for(var u=0;u<n.length;u++){var f=s[u];this.lineVertexArray.emplaceBack(f.x,f.y,f.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},se.prototype.addSymbols=function(r,n,i,a,o,s,l,c,u,f,h,p){for(var d=r.indexArray,m=r.layoutVertexArray,g=r.segments.prepareSegment(4*n.length,m,d,s.sortKey),v=this.glyphOffsetArray.length,y=g.vertexLength,x=this.allowVerticalPlacement&&l===oA.vertical?Math.PI/2:0,b=s.text&&s.text.sections,_=0;_<n.length;_++){var w=n[_],T=w.tl,k=w.tr,A=w.bl,M=w.br,S=w.tex,E=w.pixelOffsetTL,L=w.pixelOffsetBR,C=w.minFontScaleX,P=w.minFontScaleY,I=w.glyphOffset,O=w.isSDF,z=w.sectionIndex,D=g.vertexLength,R=I[1];o8(m,c.x,c.y,T.x,R+T.y,S.x,S.y,i,O,E.x,E.y,C,P),o8(m,c.x,c.y,k.x,R+k.y,S.x+S.w,S.y,i,O,L.x,E.y,C,P),o8(m,c.x,c.y,A.x,R+A.y,S.x,S.y+S.h,i,O,E.x,L.y,C,P),o8(m,c.x,c.y,M.x,R+M.y,S.x+S.w,S.y+S.h,i,O,L.x,L.y,C,P),o9(r.dynamicLayoutVertexArray,c,x),d.emplaceBack(D,D+1,D+2),d.emplaceBack(D+1,D+2,D+3),g.vertexLength+=4,g.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(I[0]),_!==n.length-1&&z===n[_+1].sectionIndex||r.programConfigurations.populatePaintArrays(m.length,s,s.index,{},p,b&&b[z])}r.placedSymbolArray.emplaceBack(c.x,c.y,v,this.glyphOffsetArray.length-v,y,u,f,c.segment,i?i[0]:0,i?i[1]:0,a[0],a[1],l,0,!1,0,h)},se.prototype._addCollisionDebugVertex=function(r,n,i,a,o,s){return n.emplaceBack(0,0),r.emplaceBack(i.x,i.y,a,o,Math.round(s.x),Math.round(s.y))},se.prototype.addCollisionDebugVertices=function(r,n,i,o,s,l,c){var u=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),f=u.vertexLength,h=s.layoutVertexArray,p=s.collisionVertexArray,d=c.anchorX,m=c.anchorY;this._addCollisionDebugVertex(h,p,l,d,m,new a(r,n)),this._addCollisionDebugVertex(h,p,l,d,m,new a(i,n)),this._addCollisionDebugVertex(h,p,l,d,m,new a(i,o)),this._addCollisionDebugVertex(h,p,l,d,m,new a(r,o)),u.vertexLength+=4;var g=s.indexArray;g.emplaceBack(f,f+1),g.emplaceBack(f+1,f+2),g.emplaceBack(f+2,f+3),g.emplaceBack(f+3,f),u.primitiveLength+=4},se.prototype.addDebugCollisionBoxes=function(r,n,i,a){for(var o=r;o<n;o++){var s=this.collisionBoxArray.get(o),l=s.x1,c=s.y1,u=s.x2,f=s.y2;this.addCollisionDebugVertices(l,c,u,f,a?this.textCollisionBox:this.iconCollisionBox,s.anchorPoint,i)}},se.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new st(nX,a8.members,n3),this.iconCollisionBox=new st(nX,a8.members,n3);for(var r=0;r<this.symbolInstances.length;r++){var n=this.symbolInstances.get(r);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}},se.prototype._deserializeCollisionBoxesForSymbol=function(r,n,i,a,o,s,l,c,u){for(var f={},h=n;h<i;h++){var p=r.get(h);f.textBox={x1:p.x1,y1:p.y1,x2:p.x2,y2:p.y2,anchorPointX:p.anchorPointX,anchorPointY:p.anchorPointY},f.textFeatureIndex=p.featureIndex;break}for(var d=a;d<o;d++){var m=r.get(d);f.verticalTextBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},f.verticalTextFeatureIndex=m.featureIndex;break}for(var g=s;g<l;g++){var v=r.get(g);f.iconBox={x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,anchorPointX:v.anchorPointX,anchorPointY:v.anchorPointY},f.iconFeatureIndex=v.featureIndex;break}for(var y=c;y<u;y++){var x=r.get(y);f.verticalIconBox={x1:x.x1,y1:x.y1,x2:x.x2,y2:x.y2,anchorPointX:x.anchorPointX,anchorPointY:x.anchorPointY},f.verticalIconFeatureIndex=x.featureIndex;break}return f},se.prototype.deserializeCollisionBoxes=function(r){this.collisionArrays=[];for(var n=0;n<this.symbolInstances.length;n++){var i=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},se.prototype.hasTextData=function(){return this.text.segments.get().length>0},se.prototype.hasIconData=function(){return this.icon.segments.get().length>0},se.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},se.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},se.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},se.prototype.addIndicesForPlacedSymbol=function(r,n){for(var i=r.placedSymbolArray.get(n),a=i.vertexStartIndex+4*i.numGlyphs,o=i.vertexStartIndex;o<a;o+=4)r.indexArray.emplaceBack(o,o+1,o+2),r.indexArray.emplaceBack(o+1,o+2,o+3)},se.prototype.getSortedSymbolIndexes=function(r){if(this.sortedAngle===r&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var n=Math.sin(r),i=Math.cos(r),a=[],o=[],s=[],l=0;l<this.symbolInstances.length;++l){s.push(l);var c=this.symbolInstances.get(l);a.push(0|Math.round(n*c.anchorX+i*c.anchorY)),o.push(c.featureIndex)}return s.sort(function(r,n){return a[r]-a[n]||o[n]-o[r]}),s},se.prototype.addToSortKeyRanges=function(r,n){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===n?i.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:r+1})},se.prototype.sortFeatures=function(r){var n=this;if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,a=this.symbolInstanceIndexes;i<a.length;i+=1){var o=a[i],s=this.symbolInstances.get(o);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach(function(r,i,a){r>=0&&a.indexOf(r)===i&&n.addIndicesForPlacedSymbol(n.text,r)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},r5("SymbolBucket",se,{omit:["layers","collisionBoxArray","features","compareText"]}),se.MAX_GLYPHS=65535,se.addDynamicAttributes=o9;var sr=new nI({"symbol-placement":new nS(tA.layout_symbol["symbol-placement"]),"symbol-spacing":new nS(tA.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new nS(tA.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new nE(tA.layout_symbol["symbol-sort-key"]),"symbol-z-order":new nS(tA.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new nS(tA.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new nS(tA.layout_symbol["icon-ignore-placement"]),"icon-optional":new nS(tA.layout_symbol["icon-optional"]),"icon-rotation-alignment":new nS(tA.layout_symbol["icon-rotation-alignment"]),"icon-size":new nE(tA.layout_symbol["icon-size"]),"icon-text-fit":new nS(tA.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new nS(tA.layout_symbol["icon-text-fit-padding"]),"icon-image":new nE(tA.layout_symbol["icon-image"]),"icon-rotate":new nE(tA.layout_symbol["icon-rotate"]),"icon-padding":new nS(tA.layout_symbol["icon-padding"]),"icon-keep-upright":new nS(tA.layout_symbol["icon-keep-upright"]),"icon-offset":new nE(tA.layout_symbol["icon-offset"]),"icon-anchor":new nE(tA.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new nS(tA.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new nS(tA.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new nS(tA.layout_symbol["text-rotation-alignment"]),"text-field":new nE(tA.layout_symbol["text-field"]),"text-font":new nE(tA.layout_symbol["text-font"]),"text-size":new nE(tA.layout_symbol["text-size"]),"text-max-width":new nE(tA.layout_symbol["text-max-width"]),"text-line-height":new nS(tA.layout_symbol["text-line-height"]),"text-letter-spacing":new nE(tA.layout_symbol["text-letter-spacing"]),"text-justify":new nE(tA.layout_symbol["text-justify"]),"text-radial-offset":new nE(tA.layout_symbol["text-radial-offset"]),"text-variable-anchor":new nS(tA.layout_symbol["text-variable-anchor"]),"text-anchor":new nE(tA.layout_symbol["text-anchor"]),"text-max-angle":new nS(tA.layout_symbol["text-max-angle"]),"text-writing-mode":new nS(tA.layout_symbol["text-writing-mode"]),"text-rotate":new nE(tA.layout_symbol["text-rotate"]),"text-padding":new nS(tA.layout_symbol["text-padding"]),"text-keep-upright":new nS(tA.layout_symbol["text-keep-upright"]),"text-transform":new nE(tA.layout_symbol["text-transform"]),"text-offset":new nE(tA.layout_symbol["text-offset"]),"text-allow-overlap":new nS(tA.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new nS(tA.layout_symbol["text-ignore-placement"]),"text-optional":new nS(tA.layout_symbol["text-optional"])}),sn={paint:new nI({"icon-opacity":new nE(tA.paint_symbol["icon-opacity"]),"icon-color":new nE(tA.paint_symbol["icon-color"]),"icon-halo-color":new nE(tA.paint_symbol["icon-halo-color"]),"icon-halo-width":new nE(tA.paint_symbol["icon-halo-width"]),"icon-halo-blur":new nE(tA.paint_symbol["icon-halo-blur"]),"icon-translate":new nS(tA.paint_symbol["icon-translate"]),"icon-translate-anchor":new nS(tA.paint_symbol["icon-translate-anchor"]),"text-opacity":new nE(tA.paint_symbol["text-opacity"]),"text-color":new nE(tA.paint_symbol["text-color"],{runtimeType:tF,getOverride:function(r){return r.textColor},hasOverride:function(r){return!!r.textColor}}),"text-halo-color":new nE(tA.paint_symbol["text-halo-color"]),"text-halo-width":new nE(tA.paint_symbol["text-halo-width"]),"text-halo-blur":new nE(tA.paint_symbol["text-halo-blur"]),"text-translate":new nS(tA.paint_symbol["text-translate"]),"text-translate-anchor":new nS(tA.paint_symbol["text-translate-anchor"])}),layout:sr},si=function(r){this.type=r.property.overrides?r.property.overrides.runtimeType:tO,this.defaultValue=r};si.prototype.evaluate=function(r){if(r.formattedSection){var n=this.defaultValue.property.overrides;if(n&&n.hasOverride(r.formattedSection))return n.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default},si.prototype.eachChild=function(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)},si.prototype.outputDefined=function(){return!1},si.prototype.serialize=function(){return null},r5("FormatSectionOverride",si,{omit:["defaultValue"]});var sa=function(r){function n(n){r.call(this,n,sn)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.recalculate=function(n,i){if(r.prototype.recalculate.call(this,n,i),"auto"===this.layout.get("icon-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("point"!==this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var a=this.layout.get("text-writing-mode");if(a){for(var o=[],s=0;s<a.length;s+=1){var l=a[s];0>o.indexOf(l)&&o.push(l)}this.layout._values["text-writing-mode"]=o}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},n.prototype.getValueAndResolveTokens=function(r,n,i,a){var o,s=this.layout.get(r).evaluate(n,{},i,a),l=this._unevaluatedLayout._values[r];return l.isDataDriven()||rm(l.value)||!s?s:(o=n.properties,s.replace(/{([^{}]+)}/g,function(r,n){return n in o?String(o[n]):""}))},n.prototype.createBucket=function(r){return new se(r)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype._setPaintOverrides=function(){for(var r=0,i=sn.paint.overridableProperties;r<i.length;r+=1){var a=i[r];if(n.hasPaintOverride(this.layout,a)){var o=this.paint.get(a),s=new rd(new si(o),o.property.specification),l=null;l="constant"===o.value.kind||"source"===o.value.kind?new rv("source",s):new ry("composite",s,o.value.zoomStops,o.value._interpolationType),this.paint._values[a]=new nA(o.property,l,o.parameters)}}},n.prototype._handleOverridablePaintPropertyUpdate=function(r,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&n.hasPaintOverride(this.layout,r)},n.hasPaintOverride=function(r,n){var i=r.get("text-field"),a=sn.paint.properties[n],o=!1,s=function(r){for(var n=0;n<r.length;n+=1){var i=r[n];if(a.overrides&&a.overrides.hasOverride(i))return void(o=!0)}};if("constant"===i.value.kind&&i.value.value instanceof t$)s(i.value.value.sections);else if("source"===i.value.kind){var l=function(r){o||(r instanceof t4&&t3(r.value)===tU?s(r.value.sections):r instanceof t7?s(r.sections):r.eachChild(l))},c=i.value;c._styleExpression&&l(c._styleExpression.expression)}return o},n}(nO),so={paint:new nI({"background-color":new nS(tA.paint_background["background-color"]),"background-pattern":new nC(tA.paint_background["background-pattern"]),"background-opacity":new nS(tA.paint_background["background-opacity"])})},ss=function(r){function n(n){r.call(this,n,so)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(nO),sl={paint:new nI({"raster-opacity":new nS(tA.paint_raster["raster-opacity"]),"raster-hue-rotate":new nS(tA.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new nS(tA.paint_raster["raster-brightness-min"]),"raster-brightness-max":new nS(tA.paint_raster["raster-brightness-max"]),"raster-saturation":new nS(tA.paint_raster["raster-saturation"]),"raster-contrast":new nS(tA.paint_raster["raster-contrast"]),"raster-resampling":new nS(tA.paint_raster["raster-resampling"]),"raster-fade-duration":new nS(tA.paint_raster["raster-fade-duration"])})},sc=function(r){function n(n){r.call(this,n,sl)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(nO),su=function(r){function n(n){r.call(this,n,{}),this.implementation=n}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},n.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},n.prototype.recalculate=function(){},n.prototype.updateTransitions=function(){},n.prototype.hasTransition=function(){},n.prototype.serialize=function(){},n.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},n.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},n}(nO),sf={circle:i5,heatmap:ai,hillshade:ao,fill:aD,"fill-extrusion":aW,line:a3,symbol:sa,background:ss,raster:sc},sh=self.HTMLImageElement,sp=self.HTMLCanvasElement,sd=self.HTMLVideoElement,sm=self.ImageData,sg=self.ImageBitmap,sv=function(r,n,i,a){this.context=r,this.format=i,this.texture=r.gl.createTexture(),this.update(n,a)};sv.prototype.update=function(r,n,i){var a=r.width,o=r.height,s=!(this.size&&this.size[0]===a&&this.size[1]===o||i),l=this.context,c=l.gl;if(this.useMipmap=!!(n&&n.useMipmap),c.bindTexture(c.TEXTURE_2D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(this.format===c.RGBA&&(!n||!1!==n.premultiply)),s)this.size=[a,o],r instanceof sh||r instanceof sp||r instanceof sd||r instanceof sm||sg&&r instanceof sg?c.texImage2D(c.TEXTURE_2D,0,this.format,this.format,c.UNSIGNED_BYTE,r):c.texImage2D(c.TEXTURE_2D,0,this.format,a,o,0,this.format,c.UNSIGNED_BYTE,r.data);else{var u=i||{x:0,y:0},f=u.x,h=u.y;r instanceof sh||r instanceof sp||r instanceof sd||r instanceof sm||sg&&r instanceof sg?c.texSubImage2D(c.TEXTURE_2D,0,f,h,c.RGBA,c.UNSIGNED_BYTE,r):c.texSubImage2D(c.TEXTURE_2D,0,f,h,a,o,c.RGBA,c.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&c.generateMipmap(c.TEXTURE_2D)},sv.prototype.bind=function(r,n,i){var a=this.context.gl;a.bindTexture(a.TEXTURE_2D,this.texture),i!==a.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=a.LINEAR),r!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,i||r),this.filter=r),n!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,n),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,n),this.wrap=n)},sv.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},sv.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var sy=function(r){var n=this;this._callback=r,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){n._triggered=!1,n._callback()})};sy.prototype.trigger=function(){var r=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){r._triggered=!1,r._callback()},0))},sy.prototype.remove=function(){delete this._channel,this._callback=function(){}};var sx=function(r,n,i){this.target=r,this.parent=n,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},y(["receive","process"],this),this.invoker=new sy(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=M()?r:self};function sb(r,n,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[r*a-2*Math.PI*6378137/2,n*a-2*Math.PI*6378137/2]}sx.prototype.send=function(r,n,i,a,o){var s=this;void 0===o&&(o=!1);var l=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[l]=i);var c=L(this.globalScope)?void 0:[];return this.target.postMessage({id:l,type:r,hasCallback:!!i,targetMapId:a,mustQueue:o,sourceMapId:this.mapId,data:r9(n,c)},c),{cancel:function(){i&&delete s.callbacks[l],s.target.postMessage({id:l,type:"<cancel>",targetMapId:a,sourceMapId:s.mapId})}}},sx.prototype.receive=function(r){var n=r.data,i=n.id;if(i&&(!n.targetMapId||this.mapId===n.targetMapId)){if("<cancel>"===n.type){delete this.tasks[i];var a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a()}else M()||n.mustQueue?(this.tasks[i]=n,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,n)}},sx.prototype.process=function(){if(this.taskQueue.length){var r=this.taskQueue.shift(),n=this.tasks[r];delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),n&&this.processTask(r,n)}},sx.prototype.processTask=function(r,n){var i=this;if("<response>"===n.type){var a=this.callbacks[r];delete this.callbacks[r],a&&(n.error?a(r7(n.error)):a(null,r7(n.data)))}else{var o=!1,s=L(this.globalScope)?void 0:[],l=n.hasCallback?function(n,a){o=!0,delete i.cancelCallbacks[r],i.target.postMessage({id:r,type:"<response>",sourceMapId:i.mapId,error:n?r9(n):null,data:r9(a,s)},s)}:function(r){o=!0},c=null,u=r7(n.data);if(this.parent[n.type])c=this.parent[n.type](n.sourceMapId,u,l);else if(this.parent.getWorkerSource){var f=n.type.split(".");c=this.parent.getWorkerSource(n.sourceMapId,f[0],u.source)[f[1]](u,l)}else l(Error("Could not find function "+n.type));!o&&c&&c.cancel&&(this.cancelCallbacks[r]=c.cancel)}},sx.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var s_=function(r,n){r&&(n?this.setSouthWest(r).setNorthEast(n):4===r.length?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))};s_.prototype.setNorthEast=function(r){return this._ne=r instanceof sw?new sw(r.lng,r.lat):sw.convert(r),this},s_.prototype.setSouthWest=function(r){return this._sw=r instanceof sw?new sw(r.lng,r.lat):sw.convert(r),this},s_.prototype.extend=function(r){var n,i,a=this._sw,o=this._ne;if(r instanceof sw)n=r,i=r;else{if(!(r instanceof s_))return Array.isArray(r)?4===r.length||r.every(Array.isArray)?this.extend(s_.convert(r)):this.extend(sw.convert(r)):this;if(n=r._sw,i=r._ne,!n||!i)return this}return a||o?(a.lng=Math.min(n.lng,a.lng),a.lat=Math.min(n.lat,a.lat),o.lng=Math.max(i.lng,o.lng),o.lat=Math.max(i.lat,o.lat)):(this._sw=new sw(n.lng,n.lat),this._ne=new sw(i.lng,i.lat)),this},s_.prototype.getCenter=function(){return new sw((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},s_.prototype.getSouthWest=function(){return this._sw},s_.prototype.getNorthEast=function(){return this._ne},s_.prototype.getNorthWest=function(){return new sw(this.getWest(),this.getNorth())},s_.prototype.getSouthEast=function(){return new sw(this.getEast(),this.getSouth())},s_.prototype.getWest=function(){return this._sw.lng},s_.prototype.getSouth=function(){return this._sw.lat},s_.prototype.getEast=function(){return this._ne.lng},s_.prototype.getNorth=function(){return this._ne.lat},s_.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},s_.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},s_.prototype.isEmpty=function(){return!(this._sw&&this._ne)},s_.prototype.contains=function(r){var n=sw.convert(r),i=n.lng,a=n.lat,o=this._sw.lat<=a&&a<=this._ne.lat,s=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(s=this._sw.lng>=i&&i>=this._ne.lng),o&&s},s_.convert=function(r){return!r||r instanceof s_?r:new s_(r)};var sw=function(r,n){if(isNaN(r)||isNaN(n))throw Error("Invalid LngLat object: ("+r+", "+n+")");if(this.lng=+r,this.lat=+n,this.lat>90||this.lat<-90)throw Error("Invalid LngLat latitude value: must be between -90 and 90")};sw.prototype.wrap=function(){return new sw(h(this.lng,-180,180),this.lat)},sw.prototype.toArray=function(){return[this.lng,this.lat]},sw.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},sw.prototype.distanceTo=function(r){var n=Math.PI/180,i=this.lat*n,a=r.lat*n;return 6371008.8*Math.acos(Math.min(Math.sin(i)*Math.sin(a)+Math.cos(i)*Math.cos(a)*Math.cos((r.lng-this.lng)*n),1))},sw.prototype.toBounds=function(r){void 0===r&&(r=0);var n=360*r/40075017,i=n/Math.cos(Math.PI/180*this.lat);return new s_(new sw(this.lng-i,this.lat-n),new sw(this.lng+i,this.lat+n))},sw.convert=function(r){if(r instanceof sw)return r;if(Array.isArray(r)&&(2===r.length||3===r.length))return new sw(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&"object"==typeof r&&null!==r)return new sw(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var sT=2*Math.PI*6371008.8;function sk(r){return sT*Math.cos(r*Math.PI/180)}function sA(r){return(180+r)/360}function sM(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function sS(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}var sE=function(r,n,i){void 0===i&&(i=0),this.x=+r,this.y=+n,this.z=+i};sE.fromLngLat=function(r,n){void 0===n&&(n=0);var i=sw.convert(r);return new sE(sA(i.lng),sM(i.lat),n/sk(i.lat))},sE.prototype.toLngLat=function(){return new sw(360*this.x-180,sS(this.y))},sE.prototype.toAltitude=function(){return this.z*sk(sS(this.y))},sE.prototype.meterInMercatorCoordinateUnits=function(){return 1/sT*(1/Math.cos(sS(this.y)*Math.PI/180))};var sL=function(r,n,i){this.z=r,this.x=n,this.y=i,this.key=sI(0,r,r,n,i)};sL.prototype.equals=function(r){return this.z===r.z&&this.x===r.x&&this.y===r.y},sL.prototype.url=function(r,n){var i,a,o,s,l,c=(i=this.x,a=this.y,s=sb(256*i,256*(a=Math.pow(2,o=this.z)-a-1),o),l=sb(256*(i+1),256*(a+1),o),s[0]+","+s[1]+","+l[0]+","+l[1]),u=function(r,n,i){for(var a,o="",s=r;s>0;s--)o+=(n&(a=1<<s-1)?1:0)+(i&a?2:0);return o}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",c)},sL.prototype.getTilePoint=function(r){var n=Math.pow(2,this.z);return new a(8192*(r.x*n-this.x),8192*(r.y*n-this.y))},sL.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var sC=function(r,n){this.wrap=r,this.canonical=n,this.key=sI(r,n.z,n.z,n.x,n.y)},sP=function(r,n,i,a,o){this.overscaledZ=r,this.wrap=n,this.canonical=new sL(i,+a,+o),this.key=sI(n,r,i,a,o)};function sI(r,n,i,a,o){(r*=2)<0&&(r=-1*r-1);var s=1<<i;return(s*s*r+s*o+a).toString(36)+i.toString(36)+n.toString(36)}sP.prototype.equals=function(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)},sP.prototype.scaledTo=function(r){var n=this.canonical.z-r;return r>this.canonical.z?new sP(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new sP(r,this.wrap,r,this.canonical.x>>n,this.canonical.y>>n)},sP.prototype.calculateScaledKey=function(r,n){var i=this.canonical.z-r;return r>this.canonical.z?sI(this.wrap*+n,r,this.canonical.z,this.canonical.x,this.canonical.y):sI(this.wrap*+n,r,r,this.canonical.x>>i,this.canonical.y>>i)},sP.prototype.isChildOf=function(r){if(r.wrap!==this.wrap)return!1;var n=this.canonical.z-r.canonical.z;return 0===r.overscaledZ||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>n&&r.canonical.y===this.canonical.y>>n},sP.prototype.children=function(r){if(this.overscaledZ>=r)return[new sP(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var n=this.canonical.z+1,i=2*this.canonical.x,a=2*this.canonical.y;return[new sP(n,this.wrap,n,i,a),new sP(n,this.wrap,n,i+1,a),new sP(n,this.wrap,n,i,a+1),new sP(n,this.wrap,n,i+1,a+1)]},sP.prototype.isLessThan=function(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))},sP.prototype.wrapped=function(){return new sP(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},sP.prototype.unwrapTo=function(r){return new sP(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)},sP.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},sP.prototype.toUnwrapped=function(){return new sC(this.wrap,this.canonical)},sP.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},sP.prototype.getTilePoint=function(r){return this.canonical.getTilePoint(new sE(r.x-this.wrap,r.y))},r5("CanonicalTileID",sL),r5("OverscaledTileID",sP,{omit:["posMatrix"]});var sO=function(r,n,i){if(this.uid=r,n.height!==n.width)throw RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return k('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=n.height;var a=this.dim=n.height-2;this.data=new Uint32Array(n.data.buffer),this.encoding=i||"mapbox";for(var o=0;o<a;o++)this.data[this._idx(-1,o)]=this.data[this._idx(0,o)],this.data[this._idx(a,o)]=this.data[this._idx(a-1,o)],this.data[this._idx(o,-1)]=this.data[this._idx(o,0)],this.data[this._idx(o,a)]=this.data[this._idx(o,a-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(a,-1)]=this.data[this._idx(a-1,0)],this.data[this._idx(-1,a)]=this.data[this._idx(0,a-1)],this.data[this._idx(a,a)]=this.data[this._idx(a-1,a-1)]};sO.prototype.get=function(r,n){var i=new Uint8Array(this.data.buffer),a=4*this._idx(r,n);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(i[a],i[a+1],i[a+2])},sO.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},sO.prototype._idx=function(r,n){if(r<-1||r>=this.dim+1||n<-1||n>=this.dim+1)throw RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(r+1)},sO.prototype._unpackMapbox=function(r,n,i){return(256*r*256+256*n+i)/10-1e4},sO.prototype._unpackTerrarium=function(r,n,i){return 256*r+n+i/256-32768},sO.prototype.getPixels=function(){return new ae({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},sO.prototype.backfillBorder=function(r,n,i){if(this.dim!==r.dim)throw Error("dem dimension mismatch");var a=n*this.dim,o=n*this.dim+this.dim,s=i*this.dim,l=i*this.dim+this.dim;switch(n){case -1:a=o-1;break;case 1:o=a+1}switch(i){case -1:s=l-1;break;case 1:l=s+1}for(var c=-n*this.dim,u=-i*this.dim,f=s;f<l;f++)for(var h=a;h<o;h++)this.data[this._idx(h,f)]=r.data[this._idx(h+c,f+u)]},r5("DEMData",sO);var sz=function(r){this._stringToNumber={},this._numberToString=[];for(var n=0;n<r.length;n++){var i=r[n];this._stringToNumber[i]=n,this._numberToString[n]=i}};sz.prototype.encode=function(r){return this._stringToNumber[r]},sz.prototype.decode=function(r){return this._numberToString[r]};var sD=function(r,n,i,a,o){this.type="Feature",this._vectorTileFeature=r,r._z=n,r._x=i,r._y=a,this.properties=r.properties,this.id=o},sR={geometry:{configurable:!0}};sR.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},sR.geometry.set=function(r){this._geometry=r},sD.prototype.toJSON=function(){var r={geometry:this.geometry};for(var n in this)"_geometry"!==n&&"_vectorTileFeature"!==n&&(r[n]=this[n]);return r},Object.defineProperties(sD.prototype,sR);var sF=function(){this.state={},this.stateChanges={},this.deletedStates={}};sF.prototype.updateState=function(r,n,i){var a=String(n);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][a]=this.stateChanges[r][a]||{},p(this.stateChanges[r][a],i),null===this.deletedStates[r])for(var o in this.deletedStates[r]={},this.state[r])o!==a&&(this.deletedStates[r][o]=null);else if(this.deletedStates[r]&&null===this.deletedStates[r][a])for(var s in this.deletedStates[r][a]={},this.state[r][a])i[s]||(this.deletedStates[r][a][s]=null);else for(var l in i)this.deletedStates[r]&&this.deletedStates[r][a]&&null===this.deletedStates[r][a][l]&&delete this.deletedStates[r][a][l]},sF.prototype.removeFeatureState=function(r,n,i){if(null!==this.deletedStates[r]){var a=String(n);if(this.deletedStates[r]=this.deletedStates[r]||{},i&&void 0!==n)null!==this.deletedStates[r][a]&&(this.deletedStates[r][a]=this.deletedStates[r][a]||{},this.deletedStates[r][a][i]=null);else if(void 0!==n){if(this.stateChanges[r]&&this.stateChanges[r][a])for(i in this.deletedStates[r][a]={},this.stateChanges[r][a])this.deletedStates[r][a][i]=null;else this.deletedStates[r][a]=null}else this.deletedStates[r]=null}},sF.prototype.getState=function(r,n){var i=String(n),a=this.state[r]||{},o=this.stateChanges[r]||{},s=p({},a[i],o[i]);if(null===this.deletedStates[r])return{};if(this.deletedStates[r]){var l=this.deletedStates[r][n];if(null===l)return{};for(var c in l)delete s[c]}return s},sF.prototype.initializeTileState=function(r,n){r.setFeatureState(this.state,n)},sF.prototype.coalesceChanges=function(r,n){var i={};for(var a in this.stateChanges){this.state[a]=this.state[a]||{};var o={};for(var s in this.stateChanges[a])this.state[a][s]||(this.state[a][s]={}),p(this.state[a][s],this.stateChanges[a][s]),o[s]=this.state[a][s];i[a]=o}for(var l in this.deletedStates){this.state[l]=this.state[l]||{};var c={};if(null===this.deletedStates[l])for(var u in this.state[l])c[u]={},this.state[l][u]={};else for(var f in this.deletedStates[l]){if(null===this.deletedStates[l][f])this.state[l][f]={};else for(var h=0,d=Object.keys(this.deletedStates[l][f]);h<d.length;h+=1){var m=d[h];delete this.state[l][f][m]}c[f]=this.state[l][f]}i[l]=i[l]||{},p(i[l],c)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(var g in r)r[g].setFeatureState(i,n)};var sB=function(r,n){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new r0(8192,16,0),this.grid3D=new r0(8192,16,0),this.featureIndexArray=new is,this.promoteId=n};function sN(r,n,i,a,o){return b(r,function(r,s){var l=n instanceof nM?n.get(s):null;return l&&l.evaluate?l.evaluate(i,a,o):l})}function sj(r){for(var n=1/0,i=1/0,a=-1/0,o=-1/0,s=0;s<r.length;s+=1){var l=r[s];n=Math.min(n,l.x),i=Math.min(i,l.y),a=Math.max(a,l.x),o=Math.max(o,l.y)}return{minX:n,minY:i,maxX:a,maxY:o}}function sU(r,n){return n-r}sB.prototype.insert=function(r,n,i,a,o,s){var l=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,a,o);for(var c=s?this.grid3D:this.grid,u=0;u<n.length;u++){for(var f=n[u],h=[1/0,1/0,-1/0,-1/0],p=0;p<f.length;p++){var d=f[p];h[0]=Math.min(h[0],d.x),h[1]=Math.min(h[1],d.y),h[2]=Math.max(h[2],d.x),h[3]=Math.max(h[3],d.y)}h[0]<8192&&h[1]<8192&&h[2]>=0&&h[3]>=0&&c.insert(l,h[0],h[1],h[2],h[3])}},sB.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new aV.VectorTile(new or(this.rawTileData)).layers,this.sourceLayerCoder=new sz(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},sB.prototype.query=function(r,n,i,o){var s=this;this.loadVTLayers();for(var l=r.params||{},c=8192/r.tileSize/r.scale,u=rL(l.filter),f=r.queryGeometry,h=r.queryPadding*c,p=sj(f),d=this.grid.query(p.minX-h,p.minY-h,p.maxX+h,p.maxY+h),m=sj(r.cameraQueryGeometry),g=this.grid3D.query(m.minX-h,m.minY-h,m.maxX+h,m.maxY+h,function(n,i,o,s){return function(r,n,i,o,s){for(var l=0;l<r.length;l+=1){var c=r[l];if(n<=c.x&&i<=c.y&&o>=c.x&&s>=c.y)return!0}var u=[new a(n,i),new a(n,s),new a(o,s),new a(o,i)];if(r.length>2){for(var f=0;f<u.length;f+=1)if(iX(r,u[f]))return!0}for(var h=0;h<r.length-1;h++)if(function(r,n,i){var a=i[0],o=i[2];if(r.x<a.x&&n.x<a.x||r.x>o.x&&n.x>o.x||r.y<a.y&&n.y<a.y||r.y>o.y&&n.y>o.y)return!1;var s=A(r,n,i[0]);return s!==A(r,n,i[1])||s!==A(r,n,i[2])||s!==A(r,n,i[3])}(r[h],r[h+1],u))return!0;return!1}(r.cameraQueryGeometry,n-h,i-h,o+h,s+h)}),v=0;v<g.length;v+=1){var y=g[v];d.push(y)}d.sort(sU);for(var x,b={},_=0;_<d.length;_++)(function(a){var h=d[a];if(h!==x){x=h;var p=s.featureIndexArray.get(h),m=null;s.loadMatchingFeature(b,p.bucketIndex,p.sourceLayerIndex,p.featureIndex,u,l.layers,l.availableImages,n,i,o,function(n,i,a){return m||(m=iN(n)),i.queryIntersectsFeature(f,n,a,m,s.z,r.transform,c,r.pixelPosMatrix)})}})(_);return b},sB.prototype.loadMatchingFeature=function(r,n,i,a,o,s,l,c,u,f,h){var p=this.bucketLayerIDs[n];if(!s||function(r,n){for(var i=0;i<r.length;i++)if(n.indexOf(r[i])>=0)return!0;return!1}(s,p)){var d=this.sourceLayerCoder.decode(i),m=this.vtLayers[d].feature(a);if(o.filter(new ny(this.tileID.overscaledZ),m))for(var g=this.getId(m,d),v=0;v<p.length;v++){var y=p[v];if(!(s&&0>s.indexOf(y))){var x=c[y];if(x){var b={};void 0!==g&&f&&(b=f.getState(x.sourceLayer||"_geojsonTileLayer",g));var _=u[y];_.paint=sN(_.paint,x.paint,m,b,l),_.layout=sN(_.layout,x.layout,m,b,l);var w=!h||h(m,x,b);if(w){var T=new sD(m,this.z,this.x,this.y,g);T.layer=_;var k=r[y];void 0===k&&(k=r[y]=[]),k.push({featureIndex:a,feature:T,intersectionZ:w})}}}}}},sB.prototype.lookupSymbolFeatures=function(r,n,i,a,o,s,l,c){var u={};this.loadVTLayers();for(var f=rL(o),h=0;h<r.length;h+=1){var p=r[h];this.loadMatchingFeature(u,i,a,p,f,s,l,c,n)}return u},sB.prototype.hasLayer=function(r){for(var n=0,i=this.bucketLayerIDs;n<i.length;n+=1)for(var a=0,o=i[n];a<o.length;a+=1)if(r===o[a])return!0;return!1},sB.prototype.getId=function(r,n){var i=r.id;if(this.promoteId){var a="string"==typeof this.promoteId?this.promoteId:this.promoteId[n];"boolean"==typeof(i=r.properties[a])&&(i=Number(i))}return i},r5("FeatureIndex",sB,{omit:["rawTileData","sourceLayerCoder"]});var sV=function(r,n){this.tileID=r,this.uid=m(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};sV.prototype.registerFadeDuration=function(r){var n=r+this.timeAdded;n<B.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)},sV.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},sV.prototype.loadVectorData=function(r,n,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){for(var a in r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(r,n){var i={};if(!n)return i;for(var a=function(){var r=s[o],a=r.layerIds.map(function(r){return n.getLayer(r)}).filter(Boolean);if(0!==a.length){r.layers=a,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map(function(r){return a.filter(function(n){return n.id===r})[0]}));for(var l=0,c=a;l<c.length;l+=1){var u=c[l];i[u.id]=r}}},o=0,s=r;o<s.length;o+=1)a();return i}(r.buckets,n.style),this.hasSymbolBuckets=!1,this.buckets){var o=this.buckets[a];if(o instanceof se){if(this.hasSymbolBuckets=!0,!i)break;o.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var s in this.buckets){var l=this.buckets[s];if(l instanceof se&&l.hasRTLText){this.hasRTLText=!0,nv.isLoading()||nv.isLoaded()||"deferred"!==nm()||ng();break}}for(var c in this.queryPadding=0,this.buckets){var u=this.buckets[c];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(c).queryRadius(u))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new n9},sV.prototype.unloadVectorData=function(){for(var r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},sV.prototype.getBucket=function(r){return this.buckets[r.id]},sV.prototype.upload=function(r){for(var n in this.buckets){var i=this.buckets[n];i.uploadPending()&&i.upload(r)}var a=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new sv(r,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new sv(r,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)},sV.prototype.prepare=function(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)},sV.prototype.queryRenderedFeatures=function(r,n,i,a,o,s,l,c,u,f){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:a,cameraQueryGeometry:o,scale:s,tileSize:this.tileSize,pixelPosMatrix:f,transform:c,params:l,queryPadding:this.queryPadding*u},r,n,i):{}},sV.prototype.querySourceFeatures=function(r,n){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var a=i.loadVTLayers(),o=n?n.sourceLayer:"",s=a._geojsonTileLayer||a[o];if(s)for(var l=rL(n&&n.filter),c=this.tileID.canonical,u=c.z,f=c.x,h=c.y,p={z:u,x:f,y:h},d=0;d<s.length;d++){var m=s.feature(d);if(l.filter(new ny(this.tileID.overscaledZ),m)){var g=i.getId(m,o),v=new sD(m,u,f,h,g);v.tile=p,r.push(v)}}}},sV.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},sV.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},sV.prototype.setExpiryData=function(r){var n=this.expirationTime;if(r.cacheControl){var i=S(r.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){var a=Date.now(),o=!1;if(this.expirationTime>a)o=!1;else if(n){if(this.expirationTime<n)o=!0;else{var s=this.expirationTime-n;s?this.expirationTime=a+Math.max(s,3e4):o=!0}}else o=!0;o?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},sV.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),2147483647)},sV.prototype.setFeatureState=function(r,n){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(r).length){var i=this.latestFeatureIndex.loadVTLayers();for(var a in this.buckets)if(n.style.hasLayer(a)){var o=this.buckets[a],s=o.layers[0].sourceLayer||"_geojsonTileLayer",l=i[s],c=r[s];if(l&&c&&0!==Object.keys(c).length){o.update(c,l,this.imageAtlas&&this.imageAtlas.patternPositions||{});var u=n&&n.style&&n.style.getLayer(a);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(o)))}}}},sV.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},sV.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<B.now()},sV.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},sV.prototype.setHoldDuration=function(r){this.symbolFadeHoldUntil=B.now()+r},sV.prototype.setDependencies=function(r,n){for(var i={},a=0;a<n.length;a+=1)i[n[a]]=!0;this.dependencies[r]=i},sV.prototype.hasDependency=function(r,n){for(var i=0;i<r.length;i+=1){var a=r[i],o=this.dependencies[a];if(o){for(var s=0;s<n.length;s+=1)if(o[n[s]])return!0}}return!1};var sH=self.performance,sq=function(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},sH.mark(this._marks.start)};sq.prototype.finish=function(){sH.mark(this._marks.end);var r=sH.getEntriesByName(this._marks.measure);return 0===r.length&&(sH.measure(this._marks.measure,this._marks.start,this._marks.end),r=sH.getEntriesByName(this._marks.measure),sH.clearMarks(this._marks.start),sH.clearMarks(this._marks.end),sH.clearMeasures(this._marks.measure)),r},r.Actor=sx,r.AlphaImage=at,r.CanonicalTileID=sL,r.CollisionBoxArray=n9,r.Color=tJ,r.DEMData=sO,r.DataConstantProperty=nS,r.DictionaryCoder=sz,r.EXTENT=8192,r.ErrorEvent=tT,r.EvaluationParameters=ny,r.Event=tw,r.Evented=tk,r.FeatureIndex=sB,r.FillBucket=aI,r.FillExtrusionBucket=aG,r.ImageAtlas=ok,r.ImagePosition=ow,r.LineBucket=a$,r.LngLat=sw,r.LngLatBounds=s_,r.MercatorCoordinate=sE,r.ONE_EM=24,r.OverscaledTileID=sP,r.Point=a,r.Point$1=a,r.Properties=nI,r.Protobuf=or,r.RGBAImage=ae,r.RequestManager=q,r.RequestPerformance=sq,r.ResourceType=tp,r.SegmentVector=ic,r.SourceFeatureState=sF,r.StructArrayLayout1ui2=n5,r.StructArrayLayout2f1f2i16=nZ,r.StructArrayLayout2i4=nN,r.StructArrayLayout3ui6=nK,r.StructArrayLayout4i8=nj,r.SymbolBucket=se,r.Texture=sv,r.Tile=sV,r.Transitionable=n_,r.Uniform1f=ib,r.Uniform1i=ix,r.Uniform2f=i_,r.Uniform3f=iw,r.Uniform4f=iT,r.UniformColor=ik,r.UniformMatrix4f=iM,r.UnwrappedTileID=sC,r.ValidationError=tM,r.WritingMode=oA,r.ZoomHistory=nt,r.add=function(r,n,i){return r[0]=n[0]+i[0],r[1]=n[1]+i[1],r[2]=n[2]+i[2],r},r.addDynamicAttributes=o9,r.asyncAll=function(r,n,i){if(!r.length)return i(null,[]);var a=r.length,o=Array(r.length),s=null;r.forEach(function(r,l){n(r,function(r,n){r&&(s=r),o[l]=n,0==--a&&i(s,o)})})},r.bezier=o,r.bindAll=y,r.browser=B,r.cacheEntryPossiblyAdded=function(r){++tf>ts&&(r.getActor().send("enforceCacheSizeLimit",to),tf=0)},r.clamp=f,r.clearTileCache=function(r){var n=self.caches.delete("mapbox-tiles");r&&n.catch(r).then(function(){return r()})},r.clipLine=oG,r.clone=function(r){var n=new i0(16);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n},r.clone$1=w,r.clone$2=function(r){var n=new i0(3);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n},r.collisionCircleLayout=a9,r.config=N,r.create=function(){var r=new i0(16);return i0!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},r.create$1=function(){var r=new i0(9);return i0!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r},r.create$2=function(){var r=new i0(4);return i0!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r},r.createCommonjsModule=n,r.createExpression=rg,r.createLayout=nF,r.createStyleLayer=function(r){return"custom"===r.type?new su(r):new sf[r.type](r)},r.cross=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=i[0],c=i[1],u=i[2];return r[0]=o*u-s*c,r[1]=s*l-a*u,r[2]=a*c-o*l,r},r.deepEqual=function r(n,i){if(Array.isArray(n)){if(!Array.isArray(i)||n.length!==i.length)return!1;for(var a=0;a<n.length;a++)if(!r(n[a],i[a]))return!1;return!0}if("object"==typeof n&&null!==n&&null!==i){if("object"!=typeof i||Object.keys(n).length!==Object.keys(i).length)return!1;for(var o in n)if(!r(n[o],i[o]))return!1;return!0}return n===i},r.dot=function(r,n){return r[0]*n[0]+r[1]*n[1]+r[2]*n[2]},r.dot$1=function(r,n){return r[0]*n[0]+r[1]*n[1]+r[2]*n[2]+r[3]*n[3]},r.ease=u,r.emitValidationErrors=r$,r.endsWith=x,r.enforceCacheSizeLimit=function(r){tl(),$&&$.then(function(n){n.keys().then(function(i){for(var a=0;a<i.length-r;a++)n.delete(i[a])})})},r.evaluateSizeForFeature=oN,r.evaluateSizeForZoom=oj,r.evaluateVariableOffset=o1,r.evented=nd,r.extend=p,r.featureFilter=rL,r.filterObject=_,r.fromRotation=function(r,n){var i=Math.sin(n),a=Math.cos(n);return r[0]=a,r[1]=i,r[2]=0,r[3]=-i,r[4]=a,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},r.getAnchorAlignment=oD,r.getAnchorJustification=o2,r.getArrayBuffer=tv,r.getImage=tx,r.getJSON=function(r,n){return tg(p(r,{type:"json"}),n)},r.getRTLTextPluginStatus=nm,r.getReferrer=tm,r.getVideo=function(r,n){var i,a,o=self.document.createElement("video");o.muted=!0,o.onloadstart=function(){n(null,o)};for(var s=0;s<r.length;s++){var l=self.document.createElement("source");i=r[s],a=void 0,(a=self.document.createElement("a")).href=i,(a.protocol!==self.document.location.protocol||a.host!==self.document.location.host)&&(o.crossOrigin="Anonymous"),l.src=r[s],o.appendChild(l)}return{cancel:function(){}}},r.identity=i1,r.invert=function(r,n){var i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],u=n[6],f=n[7],h=n[8],p=n[9],d=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15],b=i*c-a*l,_=i*u-o*l,w=i*f-s*l,T=a*u-o*c,k=a*f-s*c,A=o*f-s*u,M=h*v-p*g,S=h*y-d*g,E=h*x-m*g,L=p*y-d*v,C=p*x-m*v,P=d*x-m*y,I=b*P-_*C+w*L+T*E-k*S+A*M;return I?(I=1/I,r[0]=(c*P-u*C+f*L)*I,r[1]=(o*C-a*P-s*L)*I,r[2]=(v*A-y*k+x*T)*I,r[3]=(d*k-p*A-m*T)*I,r[4]=(u*E-l*P-f*S)*I,r[5]=(i*P-o*E+s*S)*I,r[6]=(y*w-g*A-x*_)*I,r[7]=(h*A-d*w+m*_)*I,r[8]=(l*C-c*E+f*M)*I,r[9]=(a*E-i*C-s*M)*I,r[10]=(g*k-v*w+x*b)*I,r[11]=(p*w-h*k-m*b)*I,r[12]=(c*S-l*L-u*M)*I,r[13]=(i*L-a*S+o*M)*I,r[14]=(v*_-g*T-y*b)*I,r[15]=(h*T-p*_+d*b)*I,r):null},r.isChar=ne,r.isMapboxURL=G,r.keysDifference=function(r,n){var i=[];for(var a in r)a in n||i.push(a);return i},r.makeRequest=tg,r.mapObject=b,r.mercatorXfromLng=sA,r.mercatorYfromLat=sM,r.mercatorZfromAltitude=function(r,n){return r/sk(n)},r.mul=i2,r.multiply=i2,r.mvt=aV,r.normalize=function(r,n){var i=n[0],a=n[1],o=n[2],s=i*i+a*a+o*o;return s>0&&(s=1/Math.sqrt(s)),r[0]=n[0]*s,r[1]=n[1]*s,r[2]=n[2]*s,r},r.number=eA,r.offscreenCanvasSupported=th,r.ortho=function(r,n,i,a,o,s,l){var c=1/(n-i),u=1/(a-o),f=1/(s-l);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(n+i)*c,r[13]=(o+a)*u,r[14]=(l+s)*f,r[15]=1,r},r.parseGlyphPBF=function(r){return new or(r).readFields(oy,[])},r.pbf=or,r.performSymbolLayout=function(r,n,i,o,s,l,c){r.createArrays();var u=512*r.overscaling;r.tilePixelRatio=8192/u,r.compareText={},r.iconsNeedLinear=!1;var f=r.layers[0].layout,h=r.layers[0]._unevaluatedLayout._values,p={};if("composite"===r.textSizeData.kind){var d=r.textSizeData,m=d.minZoom,g=d.maxZoom;p.compositeTextSizes=[h["text-size"].possiblyEvaluate(new ny(m),c),h["text-size"].possiblyEvaluate(new ny(g),c)]}if("composite"===r.iconSizeData.kind){var v=r.iconSizeData,y=v.minZoom,x=v.maxZoom;p.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new ny(y),c),h["icon-size"].possiblyEvaluate(new ny(x),c)]}p.layoutTextSize=h["text-size"].possiblyEvaluate(new ny(r.zoom+1),c),p.layoutIconSize=h["icon-size"].possiblyEvaluate(new ny(r.zoom+1),c),p.textMaxSize=h["text-size"].possiblyEvaluate(new ny(18));for(var b=24*f.get("text-line-height"),_="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),w=f.get("text-keep-upright"),T=f.get("text-size"),A=0,M=r.features;A<M.length;A+=1)(function(){var l=M[A],u=f.get("text-font").evaluate(l,{},c).join(","),h=T.evaluate(l,{},c),d=p.layoutTextSize.evaluate(l,{},c),m=p.layoutIconSize.evaluate(l,{},c),g={horizontal:{},vertical:void 0},v=l.text,y=[0,0];if(v){var x=v.toString(),S=24*f.get("text-letter-spacing").evaluate(l,{},c),E=!function(r){for(var n,i=0;i<r.length;i+=1)if(n=r[i].charCodeAt(0),ne.Arabic(n)||ne["Arabic Supplement"](n)||ne["Arabic Extended-A"](n)||ne["Arabic Presentation Forms-A"](n)||ne["Arabic Presentation Forms-B"](n))return!1;return!0}(x)?0:S,L=f.get("text-anchor").evaluate(l,{},c),C=f.get("text-variable-anchor");if(!C){var P=f.get("text-radial-offset").evaluate(l,{},c);y=P?o1(L,[24*P,o0]):f.get("text-offset").evaluate(l,{},c).map(function(r){return 24*r})}var I=_?"center":f.get("text-justify").evaluate(l,{},c),O=f.get("symbol-placement"),z="point"===O?24*f.get("text-max-width").evaluate(l,{},c):0,D=function(){r.allowVerticalPlacement&&nr(x)&&(g.vertical=oE(v,n,i,s,u,z,b,L,"left",E,y,oA.vertical,!0,O,d,h))};if(!_&&C){for(var R="auto"===I?C.map(function(r){return o2(r)}):[I],F=!1,B=0;B<R.length;B++){var N=R[B];if(!g.horizontal[N]){if(F)g.horizontal[N]=g.horizontal[0];else{var j=oE(v,n,i,s,u,z,b,"center",N,E,y,oA.horizontal,!1,O,d,h);j&&(g.horizontal[N]=j,F=1===j.positionedLines.length)}}}D()}else{"auto"===I&&(I=o2(L));var U=oE(v,n,i,s,u,z,b,L,I,E,y,oA.horizontal,!1,O,d,h);U&&(g.horizontal[I]=U),D(),nr(x)&&_&&w&&(g.vertical=oE(v,n,i,s,u,z,b,L,I,E,y,oA.vertical,!1,O,d,h))}}var V=void 0,H=!1;if(l.icon&&l.icon.name){var q,G,Y,W,X,Z,J,K,Q,$,tt=o[l.icon.name];tt&&(q=s[l.icon.name],G=f.get("icon-offset").evaluate(l,{},c),W=(Y=oD(f.get("icon-anchor").evaluate(l,{},c))).horizontalAlign,X=Y.verticalAlign,Z=G[0],J=G[1],Q=(K=Z-q.displaySize[0]*W)+q.displaySize[0],$=J-q.displaySize[1]*X,V={image:q,top:$,bottom:$+q.displaySize[1],left:K,right:Q},H=tt.sdf,void 0===r.sdfIcons?r.sdfIcons=tt.sdf:r.sdfIcons!==tt.sdf&&k("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(tt.pixelRatio!==r.pixelRatio||0!==f.get("icon-rotate").constantOr(1))&&(r.iconsNeedLinear=!0))}var te=o5(g.horizontal)||g.vertical;r.iconsInText=!!te&&te.iconsInText,(te||V)&&function(r,n,i,o,s,l,c,u,f,h,p){var d=l.textMaxSize.evaluate(n,{});void 0===d&&(d=c);var m,g=r.layers[0].layout,v=g.get("icon-offset").evaluate(n,{},p),y=o5(i.horizontal),x=c/24,b=r.tilePixelRatio*x,_=r.tilePixelRatio*d/24,w=r.tilePixelRatio*u,T=r.tilePixelRatio*g.get("symbol-spacing"),A=g.get("text-padding")*r.tilePixelRatio,M=g.get("icon-padding")*r.tilePixelRatio,S=g.get("text-max-angle")/180*Math.PI,E="map"===g.get("text-rotation-alignment")&&"point"!==g.get("symbol-placement"),L="map"===g.get("icon-rotation-alignment")&&"point"!==g.get("symbol-placement"),C=g.get("symbol-placement"),P=T/2,I=g.get("icon-text-fit");o&&"none"!==I&&(r.allowVerticalPlacement&&i.vertical&&(m=oR(o,i.vertical,I,g.get("icon-text-fit-padding"),v,x)),y&&(o=oR(o,y,I,g.get("icon-text-fit-padding"),v,x)));var O=function(a,u){u.x<0||u.x>=8192||u.y<0||u.y>=8192||function(r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v,y,x,b,_,w,T,A,M,S){var E,L,C,P,I,O=r.addToLineVertexArray(n,i),z=0,D=0,R=0,F=0,B=-1,N=-1,j={},U=ip(""),V=0,H=0;if(void 0===c._unevaluatedLayout.getValue("text-radial-offset")?(V=(E=c.layout.get("text-offset").evaluate(w,{},M).map(function(r){return 24*r}))[0],H=E[1]):(V=24*c.layout.get("text-radial-offset").evaluate(w,{},M),H=o0),r.allowVerticalPlacement&&a.vertical){var q=c.layout.get("text-rotate").evaluate(w,{},M)+90;P=new oZ(u,n,f,h,p,a.vertical,d,m,g,q),l&&(I=new oZ(u,n,f,h,p,l,y,x,g,q))}if(o){var G=c.layout.get("icon-rotate").evaluate(w,{}),Y="none"!==c.layout.get("icon-text-fit"),W=oY(o,G,A,Y),X=l?oY(l,G,A,Y):void 0;C=new oZ(u,n,f,h,p,o,y,x,!1,G),z=4*W.length;var Z=r.iconSizeData,J=null;"source"===Z.kind?(J=[128*c.layout.get("icon-size").evaluate(w,{})])[0]>32640&&k(r.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===Z.kind&&((J=[128*T.compositeIconSizes[0].evaluate(w,{},M),128*T.compositeIconSizes[1].evaluate(w,{},M)])[0]>32640||J[1]>32640)&&k(r.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),r.addSymbols(r.icon,W,J,_,b,w,!1,n,O.lineStartIndex,O.lineLength,-1,M),B=r.icon.placedSymbolArray.length-1,X&&(D=4*X.length,r.addSymbols(r.icon,X,J,_,b,w,oA.vertical,n,O.lineStartIndex,O.lineLength,-1,M),N=r.icon.placedSymbolArray.length-1)}for(var K in a.horizontal){var Q=a.horizontal[K];L||(U=ip(Q.text),L=new oZ(u,n,f,h,p,Q,d,m,g,c.layout.get("text-rotate").evaluate(w,{},M)));var $=1===Q.positionedLines.length;if(R+=o3(r,n,Q,s,c,g,w,v,O,a.vertical?oA.horizontal:oA.horizontalOnly,$?Object.keys(a.horizontal):[K],j,B,T,M),$)break}a.vertical&&(F+=o3(r,n,a.vertical,s,c,g,w,v,O,oA.vertical,["vertical"],j,N,T,M));var tt=L?L.boxStartIndex:r.collisionBoxArray.length,te=L?L.boxEndIndex:r.collisionBoxArray.length,tr=P?P.boxStartIndex:r.collisionBoxArray.length,tn=P?P.boxEndIndex:r.collisionBoxArray.length,ti=C?C.boxStartIndex:r.collisionBoxArray.length,ta=C?C.boxEndIndex:r.collisionBoxArray.length,to=I?I.boxStartIndex:r.collisionBoxArray.length,ts=I?I.boxEndIndex:r.collisionBoxArray.length,tl=-1,tc=function(r,n){return r&&r.circleDiameter?Math.max(r.circleDiameter,n):n};tl=tc(L,-1),tl=tc(P,tl),tl=tc(C,tl);var tu=(tl=tc(I,tl))>-1?1:0;tu&&(tl*=S/24),r.glyphOffsetArray.length>=se.MAX_GLYPHS&&k("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==w.sortKey&&r.addToSortKeyRanges(r.symbolInstances.length,w.sortKey),r.symbolInstances.emplaceBack(n.x,n.y,j.right>=0?j.right:-1,j.center>=0?j.center:-1,j.left>=0?j.left:-1,j.vertical||-1,B,N,U,tt,te,tr,tn,ti,ta,to,ts,f,R,F,z,D,tu,0,d,V,H,tl)}(r,u,a,i,o,s,m,r.layers[0],r.collisionBoxArray,n.index,n.sourceLayerIndex,r.index,b,A,E,f,w,M,L,v,n,l,h,p,c)};if("line"===C)for(var z=0,D=oG(n.geometry,0,0,8192,8192);z<D.length;z+=1)for(var R=D[z],F=function(r,n,i,a,o,s,l,c,u){var f=a?.6*s*l:0,h=oq(a,o),p=h*l,d=0===r[0].x||r[0].x===u||0===r[0].y||r[0].y===u;return n-p<n/4&&(n=p+n/4),function r(n,i,a,o,s,l,c,u,f){for(var h=l/2,p=oH(n),d=0,m=i-a,g=[],v=0;v<n.length-1;v++){for(var y=n[v],x=n[v+1],b=y.dist(x),_=x.angleTo(y);m+a<d+b;){var w=((m+=a)-d)/b,T=eA(y.x,x.x,w),k=eA(y.y,x.y,w);if(T>=0&&T<f&&k>=0&&k<f&&m-h>=0&&m+h<=p){var A=new oF(T,k,_,v);A._round(),o&&!oV(n,A,l,o,s)||g.push(A)}}d+=b}return u||g.length||c||(g=r(n,d/2,a,o,s,l,c,!0,f)),g}(r,d?n/2*c%n:(h/2+2*s)*l*c%n,n,f,i,p,d,!1,u)}(R,T,S,i.vertical||y,o,24,_,r.overscaling,8192),B=0;B<F.length;B+=1){var N=F[B];y&&function(r,n,i,a){var o=r.compareText;if(n in o){for(var s=o[n],l=s.length-1;l>=0;l--)if(a.dist(s[l])<i)return!0}else o[n]=[];return o[n].push(a),!1}(r,y.text,P,N)||O(R,N)}else if("line-center"===C)for(var j=0,U=n.geometry;j<U.length;j+=1){var V=U[j];if(V.length>1){var H=function(r,n,i,a,o,s){for(var l=i?.6*24*s:0,c=oq(i,a)*s,u=0,f=oH(r)/2,h=0;h<r.length-1;h++){var p=r[h],d=r[h+1],m=p.dist(d);if(u+m>f){var g=(f-u)/m,v=new oF(eA(p.x,d.x,g),eA(p.y,d.y,g),d.angleTo(p),h);return v._round(),!l||oV(r,v,c,l,n)?v:void 0}u+=m}}(V,S,i.vertical||y,o,0,_);H&&O(V,H)}}else if("Polygon"===n.type)for(var q=0,G=aE(n.geometry,0);q<G.length;q+=1){var Y=G[q],W=function(r,n,i){void 0===n&&(n=1),void 0===i&&(i=!1);for(var o=1/0,s=1/0,l=-1/0,c=-1/0,u=r[0],f=0;f<u.length;f++){var h=u[f];(!f||h.x<o)&&(o=h.x),(!f||h.y<s)&&(s=h.y),(!f||h.x>l)&&(l=h.x),(!f||h.y>c)&&(c=h.y)}var p=Math.min(l-o,c-s),d=p/2,m=new oJ([],oQ);if(0===p)return new a(o,s);for(var g=o;g<l;g+=p)for(var v=s;v<c;v+=p)m.push(new o$(g+d,v+d,d,r));for(var y=function(r){for(var n=0,i=0,a=0,o=r[0],s=0,l=o.length,c=l-1;s<l;c=s++){var u=o[s],f=o[c],h=u.x*f.y-f.x*u.y;i+=(u.x+f.x)*h,a+=(u.y+f.y)*h,n+=3*h}return new o$(i/n,a/n,0,r)}(r),x=m.length;m.length;){var b=m.pop();(b.d>y.d||!y.d)&&(y=b,i&&console.log("found best %d after %d probes",Math.round(1e4*b.d)/1e4,x)),b.max-y.d<=n||(d=b.h/2,m.push(new o$(b.p.x-d,b.p.y-d,d,r)),m.push(new o$(b.p.x+d,b.p.y-d,d,r)),m.push(new o$(b.p.x-d,b.p.y+d,d,r)),m.push(new o$(b.p.x+d,b.p.y+d,d,r)),x+=4)}return i&&(console.log("num probes: "+x),console.log("best distance: "+y.d)),y.p}(Y,16);O(Y[0],new oF(W.x,W.y,0))}else if("LineString"===n.type)for(var X=0,Z=n.geometry;X<Z.length;X+=1){var J=Z[X];O(J,new oF(J[0].x,J[0].y,0))}else if("Point"===n.type)for(var K=0,Q=n.geometry;K<Q.length;K+=1)for(var $=Q[K],tt=0;tt<$.length;tt+=1){var te=$[tt];O([te],new oF(te.x,te.y,0))}}(r,l,g,V,o,p,d,m,y,H,c)})();l&&r.generateCollisionDebugBuffers()},r.perspective=function(r,n,i,a,o){var s,l=1/Math.tan(n/2);return r[0]=l/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=l,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,null!=o&&o!==1/0?(s=1/(a-o),r[10]=(o+a)*s,r[14]=2*o*a*s):(r[10]=-1,r[14]=-2*a),r},r.pick=function(r,n){for(var i={},a=0;a<n.length;a++){var o=n[a];o in r&&(i[o]=r[o])}return i},r.plugin=nv,r.polygonIntersectsPolygon=iV,r.postMapLoadEvent=ta,r.postTurnstileEvent=tn,r.potpack=o_,r.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.register=r5,r.registerForPluginStateChange=function(r){return r({pluginStatus:nu,pluginURL:nf}),nd.on("pluginStateChange",r),r},r.rotate=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=n[3],c=Math.sin(i),u=Math.cos(i);return r[0]=a*u+s*c,r[1]=o*u+l*c,r[2]=-(a*c)+s*u,r[3]=-(o*c)+l*u,r},r.rotateX=function(r,n,i){var a=Math.sin(i),o=Math.cos(i),s=n[4],l=n[5],c=n[6],u=n[7],f=n[8],h=n[9],p=n[10],d=n[11];return n!==r&&(r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[4]=s*o+f*a,r[5]=l*o+h*a,r[6]=c*o+p*a,r[7]=u*o+d*a,r[8]=f*o-s*a,r[9]=h*o-l*a,r[10]=p*o-c*a,r[11]=d*o-u*a,r},r.rotateZ=function(r,n,i){var a=Math.sin(i),o=Math.cos(i),s=n[0],l=n[1],c=n[2],u=n[3],f=n[4],h=n[5],p=n[6],d=n[7];return n!==r&&(r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=s*o+f*a,r[1]=l*o+h*a,r[2]=c*o+p*a,r[3]=u*o+d*a,r[4]=f*o-s*a,r[5]=h*o-l*a,r[6]=p*o-c*a,r[7]=d*o-u*a,r},r.scale=function(r,n,i){var a=i[0],o=i[1],s=i[2];return r[0]=n[0]*a,r[1]=n[1]*a,r[2]=n[2]*a,r[3]=n[3]*a,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[7]=n[7]*o,r[8]=n[8]*s,r[9]=n[9]*s,r[10]=n[10]*s,r[11]=n[11]*s,r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r},r.scale$1=function(r,n,i){return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=n[3]*i,r},r.scale$2=function(r,n,i){return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r},r.setCacheLimits=function(r,n){to=r,ts=n},r.setRTLTextPlugin=function(r,n,i){if(void 0===i&&(i=!1),nu===no||nu===ns||nu===nl)throw Error("setRTLTextPlugin cannot be called multiple times.");nf=B.resolveURL(r),nu=no,nc=n,np(),i||ng()},r.sphericalToCartesian=function(r){var n=r[0],i=r[1],a=r[2];return i+=90,{x:n*Math.cos(i*=Math.PI/180)*Math.sin(a*=Math.PI/180),y:n*Math.sin(i)*Math.sin(a),z:n*Math.cos(a)}},r.sqrLen=function(r){var n=r[0],i=r[1];return n*n+i*i},r.styleSpec=tA,r.sub=function(r,n,i){return r[0]=n[0]-i[0],r[1]=n[1]-i[1],r[2]=n[2]-i[2],r},r.symbolSize=oU,r.transformMat3=function(r,n,i){var a=n[0],o=n[1],s=n[2];return r[0]=a*i[0]+o*i[3]+s*i[6],r[1]=a*i[1]+o*i[4]+s*i[7],r[2]=a*i[2]+o*i[5]+s*i[8],r},r.transformMat4=i3,r.translate=function(r,n,i){var a,o,s,l,c,u,f,h,p,d,m,g,v=i[0],y=i[1],x=i[2];return n===r?(r[12]=n[0]*v+n[4]*y+n[8]*x+n[12],r[13]=n[1]*v+n[5]*y+n[9]*x+n[13],r[14]=n[2]*v+n[6]*y+n[10]*x+n[14],r[15]=n[3]*v+n[7]*y+n[11]*x+n[15]):(a=n[0],o=n[1],s=n[2],l=n[3],c=n[4],u=n[5],f=n[6],h=n[7],p=n[8],d=n[9],m=n[10],g=n[11],r[0]=a,r[1]=o,r[2]=s,r[3]=l,r[4]=c,r[5]=u,r[6]=f,r[7]=h,r[8]=p,r[9]=d,r[10]=m,r[11]=g,r[12]=a*v+c*y+p*x+n[12],r[13]=o*v+u*y+d*x+n[13],r[14]=s*v+f*y+m*x+n[14],r[15]=l*v+h*y+g*x+n[15]),r},r.triggerPluginCompletionEvent=nh,r.uniqueId=m,r.validateCustomStyleLayer=function(r){var n=[],i=r.id;return void 0===i&&n.push({message:"layers."+i+': missing required property "id"'}),void 0===r.render&&n.push({message:"layers."+i+': missing required method "render"'}),r.renderingMode&&"2d"!==r.renderingMode&&"3d"!==r.renderingMode&&n.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),n},r.validateLight=rJ,r.validateStyle=rW,r.values=function(r){var n=[];for(var i in r)n.push(r[i]);return n},r.vectorTile=aV,r.version="1.10.1",r.warnOnce=k,r.webpSupported=j,r.window=self,r.wrap=h}),a(0,function(r){var n=function(r){this.keyCache={},r&&this.replace(r)};n.prototype.replace=function(r){this._layerConfigs={},this._layers={},this.update(r,[])},n.prototype.update=function(n,i){for(var a=this,o=0;o<n.length;o+=1){var s=n[o];this._layerConfigs[s.id]=s;var l=this._layers[s.id]=r.createStyleLayer(s);l._featureFilter=r.featureFilter(l.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}for(var c=0;c<i.length;c+=1){var u=i[c];delete this.keyCache[u],delete this._layerConfigs[u],delete this._layers[u]}this.familiesBySource={};for(var f=0,h=function(n,i){for(var a={},o=0;o<n.length;o++){var s=i&&i[n[o].id]||function(n){for(var i="",a=0,o=r.refProperties;a<o.length;a+=1)i+="/"+function r(n){var i=typeof n;if("number"===i||"boolean"===i||"string"===i||null==n)return JSON.stringify(n);if(Array.isArray(n)){for(var a="[",o=0;o<n.length;o+=1)a+=r(n[o])+",";return a+"]"}for(var s=Object.keys(n).sort(),l="{",c=0;c<s.length;c++)l+=JSON.stringify(s[c])+":"+r(n[s[c]])+",";return l+"}"}(n[o[a]]);return i}(n[o]);i&&(i[n[o].id]=s);var l=a[s];l||(l=a[s]=[]),l.push(n[o])}var c=[];for(var u in a)c.push(a[u]);return c}(r.values(this._layerConfigs),this.keyCache);f<h.length;f+=1){var p=h[f].map(function(r){return a._layers[r.id]}),d=p[0];if("none"!==d.visibility){var m=d.source||"",g=this.familiesBySource[m];g||(g=this.familiesBySource[m]={});var v=d.sourceLayer||"_geojsonTileLayer",y=g[v];y||(y=g[v]=[]),y.push(p)}}};var i=function(n){var i={},a=[];for(var o in n){var s=n[o],l=i[o]={};for(var c in s){var u=s[+c];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var f={x:0,y:0,w:u.bitmap.width+2,h:u.bitmap.height+2};a.push(f),l[c]={rect:f,metrics:u.metrics}}}}var h=r.potpack(a),p=h.w,d=h.h,m=new r.AlphaImage({width:p||1,height:d||1});for(var g in n){var v=n[g];for(var y in v){var x=v[+y];if(x&&0!==x.bitmap.width&&0!==x.bitmap.height){var b=i[g][y].rect;r.AlphaImage.copy(x.bitmap,m,{x:0,y:0},{x:b.x+1,y:b.y+1},x.bitmap)}}}this.image=m,this.positions=i};r.register("GlyphAtlas",i);var a=function(n){this.tileID=new r.OverscaledTileID(n.tileID.overscaledZ,n.tileID.wrap,n.tileID.canonical.z,n.tileID.canonical.x,n.tileID.canonical.y),this.uid=n.uid,this.zoom=n.zoom,this.pixelRatio=n.pixelRatio,this.tileSize=n.tileSize,this.source=n.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=n.showCollisionBoxes,this.collectResourceTiming=!!n.collectResourceTiming,this.returnDependencies=!!n.returnDependencies,this.promoteId=n.promoteId};function o(n,i,a){for(var o=new r.EvaluationParameters(i),s=0;s<n.length;s+=1)n[s].recalculate(o,a)}function s(n,i){var a=r.getArrayBuffer(n.request,function(n,a,o,s){n?i(n):a&&i(null,{vectorTile:new r.vectorTile.VectorTile(new r.pbf(a)),rawData:a,cacheControl:o,expires:s})});return function(){a.cancel(),i()}}a.prototype.parse=function(n,a,s,l,c){var u=this;this.status="parsing",this.data=n,this.collisionBoxArray=new r.CollisionBoxArray;var f=new r.DictionaryCoder(Object.keys(n.layers).sort()),h=new r.FeatureIndex(this.tileID,this.promoteId);h.bucketLayerIDs=[];var p,d,m,g,v={},y={featureIndex:h,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:s},x=a.familiesBySource[this.source];for(var b in x){var _=n.layers[b];if(_){1===_.version&&r.warnOnce('Vector tile source "'+this.source+'" layer "'+b+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var w=f.encode(b),T=[],k=0;k<_.length;k++){var A=_.feature(k),M=h.getId(A,b);T.push({feature:A,id:M,index:k,sourceLayerIndex:w})}for(var S=0,E=x[b];S<E.length;S+=1){var L=E[S],C=L[0];C.minzoom&&this.zoom<Math.floor(C.minzoom)||C.maxzoom&&this.zoom>=C.maxzoom||"none"===C.visibility||(o(L,this.zoom,s),(v[C.id]=C.createBucket({index:h.bucketLayerIDs.length,layers:L,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:w,sourceID:this.source})).populate(T,y,this.tileID.canonical),h.bucketLayerIDs.push(L.map(function(r){return r.id})))}}}var P=r.mapObject(y.glyphDependencies,function(r){return Object.keys(r).map(Number)});Object.keys(P).length?l.send("getGlyphs",{uid:this.uid,stacks:P},function(r,n){p||(p=r,d=n,z.call(u))}):d={};var I=Object.keys(y.iconDependencies);I.length?l.send("getImages",{icons:I,source:this.source,tileID:this.tileID,type:"icons"},function(r,n){p||(p=r,m=n,z.call(u))}):m={};var O=Object.keys(y.patternDependencies);function z(){if(p)return c(p);if(d&&m&&g){var n=new i(d),a=new r.ImageAtlas(m,g);for(var l in v){var u=v[l];u instanceof r.SymbolBucket?(o(u.layers,this.zoom,s),r.performSymbolLayout(u,d,n.positions,m,a.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):u.hasPattern&&(u instanceof r.LineBucket||u instanceof r.FillBucket||u instanceof r.FillExtrusionBucket)&&(o(u.layers,this.zoom,s),u.addFeatures(y,this.tileID.canonical,a.patternPositions))}this.status="done",c(null,{buckets:r.values(v).filter(function(r){return!r.isEmpty()}),featureIndex:h,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:n.image,imageAtlas:a,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?m:null,glyphPositions:this.returnDependencies?n.positions:null})}}O.length?l.send("getImages",{icons:O,source:this.source,tileID:this.tileID,type:"patterns"},function(r,n){p||(p=r,g=n,z.call(u))}):g={},z.call(this)};var l=function(r,n,i,a){this.actor=r,this.layerIndex=n,this.availableImages=i,this.loadVectorData=a||s,this.loading={},this.loaded={}};l.prototype.loadTile=function(n,i){var o=this,s=n.uid;this.loading||(this.loading={});var l=!!(n&&n.request&&n.request.collectResourceTiming)&&new r.RequestPerformance(n.request),c=this.loading[s]=new a(n);c.abort=this.loadVectorData(n,function(n,a){if(delete o.loading[s],n||!a)return c.status="done",o.loaded[s]=c,i(n);var u=a.rawData,f={};a.expires&&(f.expires=a.expires),a.cacheControl&&(f.cacheControl=a.cacheControl);var h={};if(l){var p=l.finish();p&&(h.resourceTiming=JSON.parse(JSON.stringify(p)))}c.vectorTile=a.vectorTile,c.parse(a.vectorTile,o.layerIndex,o.availableImages,o.actor,function(n,a){if(n||!a)return i(n);i(null,r.extend({rawTileData:u.slice(0)},a,f,h))}),o.loaded=o.loaded||{},o.loaded[s]=c})},l.prototype.reloadTile=function(r,n){var i=this,a=this.loaded,o=r.uid,s=this;if(a&&a[o]){var l=a[o];l.showCollisionBoxes=r.showCollisionBoxes;var c=function(r,a){var o=l.reloadCallback;o&&(delete l.reloadCallback,l.parse(l.vectorTile,s.layerIndex,i.availableImages,s.actor,o)),n(r,a)};"parsing"===l.status?l.reloadCallback=c:"done"===l.status&&(l.vectorTile?l.parse(l.vectorTile,this.layerIndex,this.availableImages,this.actor,c):c())}},l.prototype.abortTile=function(r,n){var i=this.loading,a=r.uid;i&&i[a]&&i[a].abort&&(i[a].abort(),delete i[a]),n()},l.prototype.removeTile=function(r,n){var i=this.loaded,a=r.uid;i&&i[a]&&delete i[a],n()};var c=r.window.ImageBitmap,u=function(){this.loaded={}};u.prototype.loadTile=function(n,i){var a=n.uid,o=n.encoding,s=n.rawImageData,l=c&&s instanceof c?this.getImageData(s):s,u=new r.DEMData(a,l,o);this.loaded=this.loaded||{},this.loaded[a]=u,i(null,u)},u.prototype.getImageData=function(n){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(n.width,n.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=n.width,this.offscreenCanvas.height=n.height,this.offscreenCanvasContext.drawImage(n,0,0,n.width,n.height);var i=this.offscreenCanvasContext.getImageData(-1,-1,n.width+2,n.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new r.RGBAImage({width:i.width,height:i.height},i.data)},u.prototype.removeTile=function(r){var n=this.loaded,i=r.uid;n&&n[i]&&delete n[i]};var f=function r(n,i){var a,o=n&&n.type;if("FeatureCollection"===o)for(a=0;a<n.features.length;a++)r(n.features[a],i);else if("GeometryCollection"===o)for(a=0;a<n.geometries.length;a++)r(n.geometries[a],i);else if("Feature"===o)r(n.geometry,i);else if("Polygon"===o)h(n.coordinates,i);else if("MultiPolygon"===o)for(a=0;a<n.coordinates.length;a++)h(n.coordinates[a],i);return n};function h(r,n){if(0!==r.length){p(r[0],n);for(var i=1;i<r.length;i++)p(r[i],!n)}}function p(r,n){for(var i=0,a=0,o=r.length,s=o-1;a<o;s=a++)i+=(r[a][0]-r[s][0])*(r[s][1]+r[a][1]);i>=0!=!!n&&r.reverse()}var d=r.vectorTile.VectorTileFeature.prototype.toGeoJSON,m=function(n){this._feature=n,this.extent=r.EXTENT,this.type=n.type,this.properties=n.tags,"id"in n&&!isNaN(n.id)&&(this.id=parseInt(n.id,10))};m.prototype.loadGeometry=function(){if(1===this._feature.type){for(var n=[],i=0,a=this._feature.geometry;i<a.length;i+=1){var o=a[i];n.push([new r.Point$1(o[0],o[1])])}return n}for(var s=[],l=0,c=this._feature.geometry;l<c.length;l+=1){for(var u=[],f=0,h=c[l];f<h.length;f+=1){var p=h[f];u.push(new r.Point$1(p[0],p[1]))}s.push(u)}return s},m.prototype.toGeoJSON=function(r,n,i){return d.call(this,r,n,i)};var g=function(n){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.EXTENT,this.length=n.length,this._features=n};g.prototype.feature=function(r){return new m(this._features[r])};var v=r.vectorTile.VectorTileFeature;function y(r,n){this.options=n||{},this.features=r,this.length=r.length}function x(r,n){this.id="number"==typeof r.id?r.id:void 0,this.type=r.type,this.rawGeometry=1===r.type?[r.geometry]:r.geometry,this.properties=r.tags,this.extent=n||4096}y.prototype.feature=function(r){return new x(this.features[r],this.options.extent)},x.prototype.loadGeometry=function(){var n=this.rawGeometry;this.geometry=[];for(var i=0;i<n.length;i++){for(var a=n[i],o=[],s=0;s<a.length;s++)o.push(new r.Point$1(a[s][0],a[s][1]));this.geometry.push(o)}return this.geometry},x.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var r=this.geometry,n=1/0,i=-1/0,a=1/0,o=-1/0,s=0;s<r.length;s++)for(var l=r[s],c=0;c<l.length;c++){var u=l[c];n=Math.min(n,u.x),i=Math.max(i,u.x),a=Math.min(a,u.y),o=Math.max(o,u.y)}return[n,a,i,o]},x.prototype.toGeoJSON=v.prototype.toGeoJSON;var b=_;function _(n){var i=new r.pbf;return function(r,n){for(var i in r.layers)n.writeMessage(3,w,r.layers[i])}(n,i),i.finish()}function w(r,n){n.writeVarintField(15,r.version||1),n.writeStringField(1,r.name||""),n.writeVarintField(5,r.extent||4096);var i,a={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<r.length;i++)a.feature=r.feature(i),n.writeMessage(2,T,a);var o=a.keys;for(i=0;i<o.length;i++)n.writeStringField(3,o[i]);var s=a.values;for(i=0;i<s.length;i++)n.writeMessage(4,M,s[i])}function T(r,n){var i=r.feature;void 0!==i.id&&n.writeVarintField(1,i.id),n.writeMessage(2,k,r),n.writeVarintField(3,i.type),n.writeMessage(4,A,i)}function k(r,n){var i=r.feature,a=r.keys,o=r.values,s=r.keycache,l=r.valuecache;for(var c in i.properties){var u=s[c];void 0===u&&(a.push(c),u=a.length-1,s[c]=u),n.writeVarint(u);var f=i.properties[c],h=typeof f;"string"!==h&&"boolean"!==h&&"number"!==h&&(f=JSON.stringify(f));var p=h+":"+f,d=l[p];void 0===d&&(o.push(f),d=o.length-1,l[p]=d),n.writeVarint(d)}}function A(r,n){for(var i=r.loadGeometry(),a=r.type,o=0,s=0,l=i.length,c=0;c<l;c++){var u=i[c],f=1;1===a&&(f=u.length),n.writeVarint((f<<3)+1);for(var h=3===a?u.length-1:u.length,p=0;p<h;p++){1===p&&1!==a&&n.writeVarint((h-1<<3)+2);var d=u[p].x-o,m=u[p].y-s;n.writeVarint(d<<1^d>>31),n.writeVarint(m<<1^m>>31),o+=d,s+=m}3===a&&n.writeVarint(15)}}function M(r,n){var i=typeof r;"string"===i?n.writeStringField(1,r):"boolean"===i?n.writeBooleanField(7,r):"number"===i&&(r%1!=0?n.writeDoubleField(3,r):r<0?n.writeSVarintField(6,r):n.writeVarintField(5,r))}function S(r,n,i,a){E(r,i,a),E(n,2*i,2*a),E(n,2*i+1,2*a+1)}function E(r,n,i){var a=r[n];r[n]=r[i],r[i]=a}function L(r,n,i,a){var o=r-i,s=n-a;return o*o+s*s}b.fromVectorTileJs=_,b.fromGeojsonVt=function(r,n){n=n||{};var i={};for(var a in r)i[a]=new y(r[a].features,n),i[a].name=a,i[a].version=n.version,i[a].extent=n.extent;return _({layers:i})},b.GeoJSONWrapper=y;var C=function(r){return r[0]},P=function(r){return r[1]},I=function(r,n,i,a,o){void 0===n&&(n=C),void 0===i&&(i=P),void 0===a&&(a=64),void 0===o&&(o=Float64Array),this.nodeSize=a,this.points=r;for(var s=r.length<65536?Uint16Array:Uint32Array,l=this.ids=new s(r.length),c=this.coords=new o(2*r.length),u=0;u<r.length;u++)l[u]=u,c[2*u]=n(r[u]),c[2*u+1]=i(r[u]);(function r(n,i,a,o,s,l){if(!(s-o<=a)){var c=o+s>>1;(function r(n,i,a,o,s,l){for(;s>o;){if(s-o>600){var c=s-o+1,u=a-o+1,f=Math.log(c),h=.5*Math.exp(2*f/3),p=.5*Math.sqrt(f*h*(c-h)/c)*(u-c/2<0?-1:1),d=Math.max(o,Math.floor(a-u*h/c+p)),m=Math.min(s,Math.floor(a+(c-u)*h/c+p));r(n,i,a,d,m,l)}var g=i[2*a+l],v=o,y=s;for(S(n,i,o,a),i[2*s+l]>g&&S(n,i,o,s);v<y;){for(S(n,i,v,y),v++,y--;i[2*v+l]<g;)v++;for(;i[2*y+l]>g;)y--}i[2*o+l]===g?S(n,i,o,y):S(n,i,++y,s),y<=a&&(o=y+1),a<=y&&(s=y-1)}})(n,i,c,o,s,l%2),r(n,i,a,o,c-1,l+1),r(n,i,a,c+1,s,l+1)}})(l,c,a,0,l.length-1,0)};I.prototype.range=function(r,n,i,a){return function(r,n,i,a,o,s,l){for(var c,u,f=[0,r.length-1,0],h=[];f.length;){var p=f.pop(),d=f.pop(),m=f.pop();if(d-m<=l)for(var g=m;g<=d;g++)c=n[2*g],u=n[2*g+1],c>=i&&c<=o&&u>=a&&u<=s&&h.push(r[g]);else{var v=Math.floor((m+d)/2);c=n[2*v],u=n[2*v+1],c>=i&&c<=o&&u>=a&&u<=s&&h.push(r[v]);var y=(p+1)%2;(0===p?i<=c:a<=u)&&(f.push(m),f.push(v-1),f.push(y)),(0===p?o>=c:s>=u)&&(f.push(v+1),f.push(d),f.push(y))}}return h}(this.ids,this.coords,r,n,i,a,this.nodeSize)},I.prototype.within=function(r,n,i){return function(r,n,i,a,o,s){for(var l=[0,r.length-1,0],c=[],u=o*o;l.length;){var f=l.pop(),h=l.pop(),p=l.pop();if(h-p<=s)for(var d=p;d<=h;d++)L(n[2*d],n[2*d+1],i,a)<=u&&c.push(r[d]);else{var m=Math.floor((p+h)/2),g=n[2*m],v=n[2*m+1];L(g,v,i,a)<=u&&c.push(r[m]);var y=(f+1)%2;(0===f?i-o<=g:a-o<=v)&&(l.push(p),l.push(m-1),l.push(y)),(0===f?i+o>=g:a+o>=v)&&(l.push(m+1),l.push(h),l.push(y))}}return c}(this.ids,this.coords,r,n,i,this.nodeSize)};var O={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(r){return r}},z=function(r){this.options=N(Object.create(O),r),this.trees=Array(this.options.maxZoom+1)};function D(r){return{type:"Feature",id:r.id,properties:R(r),geometry:{type:"Point",coordinates:[360*(r.x-.5),360*Math.atan(Math.exp((180-360*r.y)*Math.PI/180))/Math.PI-90]}}}function R(r){var n=r.numPoints,i=n>=1e4?Math.round(n/1e3)+"k":n>=1e3?Math.round(n/100)/10+"k":n;return N(N({},r.properties),{cluster:!0,cluster_id:r.id,point_count:n,point_count_abbreviated:i})}function F(r){return r/360+.5}function B(r){var n=Math.sin(r*Math.PI/180),i=.5-.25*Math.log((1+n)/(1-n))/Math.PI;return i<0?0:i>1?1:i}function N(r,n){for(var i in n)r[i]=n[i];return r}function j(r){return r.x}function U(r){return r.y}function V(r,n,i,a){var o={id:void 0===r?null:r,type:n,geometry:i,tags:a,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(r){var n=r.geometry,i=r.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)H(r,n);else if("Polygon"===i||"MultiLineString"===i)for(var a=0;a<n.length;a++)H(r,n[a]);else if("MultiPolygon"===i)for(a=0;a<n.length;a++)for(var o=0;o<n[a].length;o++)H(r,n[a][o])}(o),o}function H(r,n){for(var i=0;i<n.length;i+=3)r.minX=Math.min(r.minX,n[i]),r.minY=Math.min(r.minY,n[i+1]),r.maxX=Math.max(r.maxX,n[i]),r.maxY=Math.max(r.maxY,n[i+1])}function q(r,n,i,a){if(n.geometry){var o=n.geometry.coordinates,s=n.geometry.type,l=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),c=[],u=n.id;if(i.promoteId?u=n.properties[i.promoteId]:i.generateId&&(u=a||0),"Point"===s)G(o,c);else if("MultiPoint"===s)for(var f=0;f<o.length;f++)G(o[f],c);else if("LineString"===s)Y(o,c,l,!1);else if("MultiLineString"===s){if(i.lineMetrics){for(f=0;f<o.length;f++)c=[],Y(o[f],c,l,!1),r.push(V(u,"LineString",c,n.properties));return}W(o,c,l,!1)}else if("Polygon"===s)W(o,c,l,!0);else{if("MultiPolygon"!==s){if("GeometryCollection"===s){for(f=0;f<n.geometry.geometries.length;f++)q(r,{id:u,geometry:n.geometry.geometries[f],properties:n.properties},i,a);return}throw Error("Input data is not a valid GeoJSON object.")}for(f=0;f<o.length;f++){var h=[];W(o[f],h,l,!0),c.push(h)}}r.push(V(u,s,c,n.properties))}}function G(r,n){n.push(r[0]/360+.5),n.push(X(r[1])),n.push(0)}function Y(r,n,i,a){for(var o,s,l=0,c=0;c<r.length;c++){var u=r[c][0]/360+.5,f=X(r[c][1]);n.push(u),n.push(f),n.push(0),c>0&&(l+=a?(o*f-u*s)/2:Math.sqrt(Math.pow(u-o,2)+Math.pow(f-s,2))),o=u,s=f}var h=n.length-3;n[2]=1,function r(n,i,a,o){for(var s,l=o,c=a-i>>1,u=a-i,f=n[i],h=n[i+1],p=n[a],d=n[a+1],m=i+3;m<a;m+=3){var g=function(r,n,i,a,o,s){var l=o-i,c=s-a;if(0!==l||0!==c){var u=((r-i)*l+(n-a)*c)/(l*l+c*c);u>1?(i=o,a=s):u>0&&(i+=l*u,a+=c*u)}return(l=r-i)*l+(c=n-a)*c}(n[m],n[m+1],f,h,p,d);if(g>l)s=m,l=g;else if(g===l){var v=Math.abs(m-c);v<u&&(s=m,u=v)}}l>o&&(s-i>3&&r(n,i,s,o),n[s+2]=l,a-s>3&&r(n,s,a,o))}(n,0,h,i),n[h+2]=1,n.size=Math.abs(l),n.start=0,n.end=n.size}function W(r,n,i,a){for(var o=0;o<r.length;o++){var s=[];Y(r[o],s,i,a),n.push(s)}}function X(r){var n=Math.sin(r*Math.PI/180),i=.5-.25*Math.log((1+n)/(1-n))/Math.PI;return i<0?0:i>1?1:i}function Z(r,n,i,a,o,s,l,c){if(a/=n,s>=(i/=n)&&l<a)return r;if(l<i||s>=a)return null;for(var u=[],f=0;f<r.length;f++){var h=r[f],p=h.geometry,d=h.type,m=0===o?h.minX:h.minY,g=0===o?h.maxX:h.maxY;if(m>=i&&g<a)u.push(h);else if(!(g<i||m>=a)){var v=[];if("Point"===d||"MultiPoint"===d)(function(r,n,i,a,o){for(var s=0;s<r.length;s+=3){var l=r[s+o];l>=i&&l<=a&&(n.push(r[s]),n.push(r[s+1]),n.push(r[s+2]))}})(p,v,i,a,o);else if("LineString"===d)J(p,v,i,a,o,!1,c.lineMetrics);else if("MultiLineString"===d)Q(p,v,i,a,o,!1);else if("Polygon"===d)Q(p,v,i,a,o,!0);else if("MultiPolygon"===d)for(var y=0;y<p.length;y++){var x=[];Q(p[y],x,i,a,o,!0),x.length&&v.push(x)}if(v.length){if(c.lineMetrics&&"LineString"===d){for(y=0;y<v.length;y++)u.push(V(h.id,d,v[y],h.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===v.length?(d="LineString",v=v[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===v.length?"Point":"MultiPoint"),u.push(V(h.id,d,v,h.tags))}}}return u.length?u:null}function J(r,n,i,a,o,s,l){for(var c,u,f=K(r),h=0===o?tt:te,p=r.start,d=0;d<r.length-3;d+=3){var m=r[d],g=r[d+1],v=r[d+2],y=r[d+3],x=r[d+4],b=0===o?m:g,_=0===o?y:x,w=!1;l&&(c=Math.sqrt(Math.pow(m-y,2)+Math.pow(g-x,2))),b<i?_>i&&(u=h(f,m,g,y,x,i),l&&(f.start=p+c*u)):b>a?_<a&&(u=h(f,m,g,y,x,a),l&&(f.start=p+c*u)):$(f,m,g,v),_<i&&b>=i&&(u=h(f,m,g,y,x,i),w=!0),_>a&&b<=a&&(u=h(f,m,g,y,x,a),w=!0),!s&&w&&(l&&(f.end=p+c*u),n.push(f),f=K(r)),l&&(p+=c)}var T=r.length-3;m=r[T],g=r[T+1],v=r[T+2],(b=0===o?m:g)>=i&&b<=a&&$(f,m,g,v),T=f.length-3,s&&T>=3&&(f[T]!==f[0]||f[T+1]!==f[1])&&$(f,f[0],f[1],f[2]),f.length&&n.push(f)}function K(r){var n=[];return n.size=r.size,n.start=r.start,n.end=r.end,n}function Q(r,n,i,a,o,s){for(var l=0;l<r.length;l++)J(r[l],n,i,a,o,s,!1)}function $(r,n,i,a){r.push(n),r.push(i),r.push(a)}function tt(r,n,i,a,o,s){var l=(s-n)/(a-n);return r.push(s),r.push(i+(o-i)*l),r.push(1),l}function te(r,n,i,a,o,s){var l=(s-i)/(o-i);return r.push(n+(a-n)*l),r.push(s),r.push(1),l}function tr(r,n){for(var i=[],a=0;a<r.length;a++){var o,s=r[a],l=s.type;if("Point"===l||"MultiPoint"===l||"LineString"===l)o=tn(s.geometry,n);else if("MultiLineString"===l||"Polygon"===l){o=[];for(var c=0;c<s.geometry.length;c++)o.push(tn(s.geometry[c],n))}else if("MultiPolygon"===l)for(o=[],c=0;c<s.geometry.length;c++){for(var u=[],f=0;f<s.geometry[c].length;f++)u.push(tn(s.geometry[c][f],n));o.push(u)}i.push(V(s.id,l,o,s.tags))}return i}function tn(r,n){var i=[];i.size=r.size,void 0!==r.start&&(i.start=r.start,i.end=r.end);for(var a=0;a<r.length;a+=3)i.push(r[a]+n,r[a+1],r[a+2]);return i}function ti(r,n){if(r.transformed)return r;var i,a,o,s=1<<r.z,l=r.x,c=r.y;for(i=0;i<r.features.length;i++){var u=r.features[i],f=u.geometry,h=u.type;if(u.geometry=[],1===h)for(a=0;a<f.length;a+=2)u.geometry.push(ta(f[a],f[a+1],n,s,l,c));else for(a=0;a<f.length;a++){var p=[];for(o=0;o<f[a].length;o+=2)p.push(ta(f[a][o],f[a][o+1],n,s,l,c));u.geometry.push(p)}}return r.transformed=!0,r}function ta(r,n,i,a,o,s){return[Math.round(i*(r*a-o)),Math.round(i*(n*a-s))]}function to(r,n,i,a,o,s){var l=a*a;if(a>0&&n.size<(o?l:a))i.numPoints+=n.length/3;else{for(var c=[],u=0;u<n.length;u+=3)(0===a||n[u+2]>l)&&(i.numSimplified++,c.push(n[u]),c.push(n[u+1])),i.numPoints++;o&&function(r,n){for(var i=0,a=0,o=r.length,s=o-2;a<o;s=a,a+=2)i+=(r[a]-r[s])*(r[a+1]+r[s+1]);if(i>0===n)for(a=0,o=r.length;a<o/2;a+=2){var l=r[a],c=r[a+1];r[a]=r[o-2-a],r[a+1]=r[o-1-a],r[o-2-a]=l,r[o-1-a]=c}}(c,s),r.push(c)}}function ts(r,n){var i,a,o,s,l,c,u=(n=this.options=function(r,n){for(var i in n)r[i]=n[i];return r}(Object.create(this.options),n)).debug;if(u&&console.time("preprocess data"),n.maxZoom<0||n.maxZoom>24)throw Error("maxZoom should be in the 0-24 range");if(n.promoteId&&n.generateId)throw Error("promoteId and generateId cannot be used together.");var f=function(r,n){var i=[];if("FeatureCollection"===r.type)for(var a=0;a<r.features.length;a++)q(i,r.features[a],n,a);else"Feature"===r.type?q(i,r,n):q(i,{geometry:r},n);return i}(r,n);this.tiles={},this.tileCoords=[],u&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",n.indexMaxZoom,n.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=f,o=(a=n).buffer/a.extent,s=i,l=Z(i,1,-1-o,o,0,-1,2,a),c=Z(i,1,1-o,2+o,0,-1,2,a),(l||c)&&(s=Z(i,1,-o,1+o,0,-1,2,a)||[],l&&(s=tr(l,1).concat(s)),c&&(s=s.concat(tr(c,-1)))),f=s).length&&this.splitTile(f,0,0,0),u&&(f.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function tl(r,n,i){return 32*((1<<r)*i+n)+r}function tc(r,n){var i=r.tileID.canonical;if(!this._geoJSONIndex)return n(null,null);var a=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!a)return n(null,null);var o=new g(a.features),s=b(o);0===s.byteOffset&&s.byteLength===s.buffer.byteLength||(s=new Uint8Array(s)),n(null,{vectorTile:o,rawData:s.buffer})}z.prototype.load=function(r){var n=this.options,i=n.log,a=n.minZoom,o=n.maxZoom,s=n.nodeSize;i&&console.time("total time");var l="prepare "+r.length+" points";i&&console.time(l),this.points=r;for(var c=[],u=0;u<r.length;u++)r[u].geometry&&c.push(function(r,n){var i=r.geometry.coordinates,a=i[0],o=i[1];return{x:F(a),y:B(o),zoom:1/0,index:n,parentId:-1}}(r[u],u));this.trees[o+1]=new I(c,j,U,s,Float32Array),i&&console.timeEnd(l);for(var f=o;f>=a;f--){var h=+Date.now();c=this._cluster(c,f),this.trees[f]=new I(c,j,U,s,Float32Array),i&&console.log("z%d: %d clusters in %dms",f,c.length,+Date.now()-h)}return i&&console.timeEnd("total time"),this},z.prototype.getClusters=function(r,n){var i=((r[0]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,r[1])),o=180===r[2]?180:((r[2]+180)%360+360)%360-180,s=Math.max(-90,Math.min(90,r[3]));if(r[2]-r[0]>=360)i=-180,o=180;else if(i>o){var l=this.getClusters([i,a,180,s],n),c=this.getClusters([-180,a,o,s],n);return l.concat(c)}for(var u=this.trees[this._limitZoom(n)],f=[],h=0,p=u.range(F(i),B(s),F(o),B(a));h<p.length;h+=1){var d=p[h],m=u.points[d];f.push(m.numPoints?D(m):this.points[m.index])}return f},z.prototype.getChildren=function(r){var n=this._getOriginId(r),i=this._getOriginZoom(r),a="No cluster with the specified id.",o=this.trees[i];if(!o)throw Error(a);var s=o.points[n];if(!s)throw Error(a);for(var l=this.options.radius/(this.options.extent*Math.pow(2,i-1)),c=[],u=0,f=o.within(s.x,s.y,l);u<f.length;u+=1){var h=f[u],p=o.points[h];p.parentId===r&&c.push(p.numPoints?D(p):this.points[p.index])}if(0===c.length)throw Error(a);return c},z.prototype.getLeaves=function(r,n,i){n=n||10,i=i||0;var a=[];return this._appendLeaves(a,r,n,i,0),a},z.prototype.getTile=function(r,n,i){var a=this.trees[this._limitZoom(r)],o=Math.pow(2,r),s=this.options,l=s.extent,c=s.radius/l,u=(i-c)/o,f=(i+1+c)/o,h={features:[]};return this._addTileFeatures(a.range((n-c)/o,u,(n+1+c)/o,f),a.points,n,i,o,h),0===n&&this._addTileFeatures(a.range(1-c/o,u,1,f),a.points,o,i,o,h),n===o-1&&this._addTileFeatures(a.range(0,u,c/o,f),a.points,-1,i,o,h),h.features.length?h:null},z.prototype.getClusterExpansionZoom=function(r){for(var n=this._getOriginZoom(r)-1;n<=this.options.maxZoom;){var i=this.getChildren(r);if(n++,1!==i.length)break;r=i[0].properties.cluster_id}return n},z.prototype._appendLeaves=function(r,n,i,a,o){for(var s=0,l=this.getChildren(n);s<l.length;s+=1){var c=l[s],u=c.properties;if(u&&u.cluster?o+u.point_count<=a?o+=u.point_count:o=this._appendLeaves(r,u.cluster_id,i,a,o):o<a?o++:r.push(c),r.length===i)break}return o},z.prototype._addTileFeatures=function(r,n,i,a,o,s){for(var l=0;l<r.length;l+=1){var c=n[r[l]],u=c.numPoints,f={type:1,geometry:[[Math.round(this.options.extent*(c.x*o-i)),Math.round(this.options.extent*(c.y*o-a))]],tags:u?R(c):this.points[c.index].properties},h=void 0;u?h=c.id:this.options.generateId?h=c.index:this.points[c.index].id&&(h=this.points[c.index].id),void 0!==h&&(f.id=h),s.features.push(f)}},z.prototype._limitZoom=function(r){return Math.max(this.options.minZoom,Math.min(r,this.options.maxZoom+1))},z.prototype._cluster=function(r,n){for(var i=[],a=this.options,o=a.radius,s=a.extent,l=a.reduce,c=o/(s*Math.pow(2,n)),u=0;u<r.length;u++){var f=r[u];if(!(f.zoom<=n)){f.zoom=n;for(var h=this.trees[n+1],p=h.within(f.x,f.y,c),d=f.numPoints||1,m=f.x*d,g=f.y*d,v=l&&d>1?this._map(f,!0):null,y=(u<<5)+(n+1)+this.points.length,x=0;x<p.length;x+=1){var b=p[x],_=h.points[b];if(!(_.zoom<=n)){_.zoom=n;var w=_.numPoints||1;m+=_.x*w,g+=_.y*w,d+=w,_.parentId=y,l&&(v||(v=this._map(f,!0)),l(v,this._map(_)))}}1===d?i.push(f):(f.parentId=y,i.push({x:m/d,y:g/d,zoom:1/0,id:y,parentId:-1,numPoints:d,properties:v}))}}return i},z.prototype._getOriginId=function(r){return r-this.points.length>>5},z.prototype._getOriginZoom=function(r){return(r-this.points.length)%32},z.prototype._map=function(r,n){if(r.numPoints)return n?N({},r.properties):r.properties;var i=this.points[r.index].properties,a=this.options.map(i);return n&&a===i?N({},a):a},ts.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ts.prototype.splitTile=function(r,n,i,a,o,s,l){for(var c=[r,n,i,a],u=this.options,f=u.debug;c.length;){a=c.pop(),i=c.pop(),n=c.pop(),r=c.pop();var h=1<<n,p=tl(n,i,a),d=this.tiles[p];if(!d&&(f>1&&console.time("creation"),d=this.tiles[p]=function(r,n,i,a,o){for(var s=n===o.maxZoom?0:o.tolerance/((1<<n)*o.extent),l={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:a,z:n,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},c=0;c<r.length;c++){l.numFeatures++,function(r,n,i,a){var o=n.geometry,s=n.type,l=[];if("Point"===s||"MultiPoint"===s)for(var c=0;c<o.length;c+=3)l.push(o[c]),l.push(o[c+1]),r.numPoints++,r.numSimplified++;else if("LineString"===s)to(l,o,r,i,!1,!1);else if("MultiLineString"===s||"Polygon"===s)for(c=0;c<o.length;c++)to(l,o[c],r,i,"Polygon"===s,0===c);else if("MultiPolygon"===s)for(var u=0;u<o.length;u++){var f=o[u];for(c=0;c<f.length;c++)to(l,f[c],r,i,!0,0===c)}if(l.length){var h=n.tags||null;if("LineString"===s&&a.lineMetrics){for(var p in h={},n.tags)h[p]=n.tags[p];h.mapbox_clip_start=o.start/o.size,h.mapbox_clip_end=o.end/o.size}var d={geometry:l,type:"Polygon"===s||"MultiPolygon"===s?3:"LineString"===s||"MultiLineString"===s?2:1,tags:h};null!==n.id&&(d.id=n.id),r.features.push(d)}}(l,r[c],s,o);var u=r[c].minX,f=r[c].minY,h=r[c].maxX,p=r[c].maxY;u<l.minX&&(l.minX=u),f<l.minY&&(l.minY=f),h>l.maxX&&(l.maxX=h),p>l.maxY&&(l.maxY=p)}return l}(r,n,i,a,u),this.tileCoords.push({z:n,x:i,y:a}),f)){f>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",n,i,a,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var m="z"+n;this.stats[m]=(this.stats[m]||0)+1,this.total++}if(d.source=r,o){if(n===u.maxZoom||n===o)continue;var g=1<<o-n;if(i!==Math.floor(s/g)||a!==Math.floor(l/g))continue}else if(n===u.indexMaxZoom||d.numPoints<=u.indexMaxPoints)continue;if(d.source=null,0!==r.length){f>1&&console.time("clipping");var v,y,x,b,_,w,T=.5*u.buffer/u.extent,k=.5-T,A=.5+T,M=1+T;v=y=x=b=null,_=Z(r,h,i-T,i+A,0,d.minX,d.maxX,u),w=Z(r,h,i+k,i+M,0,d.minX,d.maxX,u),r=null,_&&(v=Z(_,h,a-T,a+A,1,d.minY,d.maxY,u),y=Z(_,h,a+k,a+M,1,d.minY,d.maxY,u),_=null),w&&(x=Z(w,h,a-T,a+A,1,d.minY,d.maxY,u),b=Z(w,h,a+k,a+M,1,d.minY,d.maxY,u),w=null),f>1&&console.timeEnd("clipping"),c.push(v||[],n+1,2*i,2*a),c.push(y||[],n+1,2*i,2*a+1),c.push(x||[],n+1,2*i+1,2*a),c.push(b||[],n+1,2*i+1,2*a+1)}}},ts.prototype.getTile=function(r,n,i){var a=this.options,o=a.extent,s=a.debug;if(r<0||r>24)return null;var l=1<<r,c=tl(r,n=(n%l+l)%l,i);if(this.tiles[c])return ti(this.tiles[c],o);s>1&&console.log("drilling down to z%d-%d-%d",r,n,i);for(var u,f=r,h=n,p=i;!u&&f>0;)f--,h=Math.floor(h/2),p=Math.floor(p/2),u=this.tiles[tl(f,h,p)];return u&&u.source?(s>1&&console.log("found parent tile z%d-%d-%d",f,h,p),s>1&&console.time("drilling down"),this.splitTile(u.source,f,h,p,r,n,i),s>1&&console.timeEnd("drilling down"),this.tiles[c]?ti(this.tiles[c],o):null):null};var tu=function(n){function i(r,i,a,o){n.call(this,r,i,a,tc),o&&(this.loadGeoJSON=o)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.loadData=function(r,n){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=n,this._pendingLoadDataParams=r,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},i.prototype._loadData=function(){var n=this;if(this._pendingCallback&&this._pendingLoadDataParams){var i=this._pendingCallback,a=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var o=!!(a&&a.request&&a.request.collectResourceTiming)&&new r.RequestPerformance(a.request);this.loadGeoJSON(a,function(s,l){if(s||!l)return i(s);if("object"!=typeof l)return i(Error("Input data given to '"+a.source+"' is not a valid GeoJSON object."));f(l,!0);try{var c;n._geoJSONIndex=a.cluster?new z(function(n){var i=n.superclusterOptions,a=n.clusterProperties;if(!a||!i)return i;for(var o={},s={},l={accumulated:null,zoom:0},c={properties:null},u=Object.keys(a),f=0;f<u.length;f+=1){var h=u[f],p=a[h],d=p[0],m=p[1],g=r.createExpression(m),v=r.createExpression("string"==typeof d?[d,["accumulated"],["get",h]]:d);o[h]=g.value,s[h]=v.value}return i.map=function(r){c.properties=r;for(var n={},i=0;i<u.length;i+=1){var a=u[i];n[a]=o[a].evaluate(l,c)}return n},i.reduce=function(r,n){c.properties=n;for(var i=0;i<u.length;i+=1){var a=u[i];l.accumulated=r[a],r[a]=s[a].evaluate(l,c)}},i}(a)).load(l.features):(c=a.geojsonVtOptions,new ts(l,c))}catch(r){return i(r)}n.loaded={};var u={};if(o){var h=o.finish();h&&(u.resourceTiming={},u.resourceTiming[a.source]=JSON.parse(JSON.stringify(h)))}i(null,u)})}},i.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},i.prototype.reloadTile=function(r,i){var a=this.loaded,o=r.uid;return a&&a[o]?n.prototype.reloadTile.call(this,r,i):this.loadTile(r,i)},i.prototype.loadGeoJSON=function(n,i){if(n.request)r.getJSON(n.request,i);else{if("string"!=typeof n.data)return i(Error("Input data given to '"+n.source+"' is not a valid GeoJSON object."));try{return i(null,JSON.parse(n.data))}catch(r){return i(Error("Input data given to '"+n.source+"' is not a valid GeoJSON object."))}}},i.prototype.removeSource=function(r,n){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),n()},i.prototype.getClusterExpansionZoom=function(r,n){try{n(null,this._geoJSONIndex.getClusterExpansionZoom(r.clusterId))}catch(r){n(r)}},i.prototype.getClusterChildren=function(r,n){try{n(null,this._geoJSONIndex.getChildren(r.clusterId))}catch(r){n(r)}},i.prototype.getClusterLeaves=function(r,n){try{n(null,this._geoJSONIndex.getLeaves(r.clusterId,r.limit,r.offset))}catch(r){n(r)}},i}(l),tf=function(n){var i=this;this.self=n,this.actor=new r.Actor(n,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:tu},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(r,n){if(i.workerSourceTypes[r])throw Error('Worker source with name "'+r+'" already registered.');i.workerSourceTypes[r]=n},this.self.registerRTLTextPlugin=function(n){if(r.plugin.isParsed())throw Error("RTL text plugin already registered.");r.plugin.applyArabicShaping=n.applyArabicShaping,r.plugin.processBidirectionalText=n.processBidirectionalText,r.plugin.processStyledBidirectionalText=n.processStyledBidirectionalText}};return tf.prototype.setReferrer=function(r,n){this.referrer=n},tf.prototype.setImages=function(r,n,i){for(var a in this.availableImages[r]=n,this.workerSources[r]){var o=this.workerSources[r][a];for(var s in o)o[s].availableImages=n}i()},tf.prototype.setLayers=function(r,n,i){this.getLayerIndex(r).replace(n),i()},tf.prototype.updateLayers=function(r,n,i){this.getLayerIndex(r).update(n.layers,n.removedIds),i()},tf.prototype.loadTile=function(r,n,i){this.getWorkerSource(r,n.type,n.source).loadTile(n,i)},tf.prototype.loadDEMTile=function(r,n,i){this.getDEMWorkerSource(r,n.source).loadTile(n,i)},tf.prototype.reloadTile=function(r,n,i){this.getWorkerSource(r,n.type,n.source).reloadTile(n,i)},tf.prototype.abortTile=function(r,n,i){this.getWorkerSource(r,n.type,n.source).abortTile(n,i)},tf.prototype.removeTile=function(r,n,i){this.getWorkerSource(r,n.type,n.source).removeTile(n,i)},tf.prototype.removeDEMTile=function(r,n){this.getDEMWorkerSource(r,n.source).removeTile(n)},tf.prototype.removeSource=function(r,n,i){if(this.workerSources[r]&&this.workerSources[r][n.type]&&this.workerSources[r][n.type][n.source]){var a=this.workerSources[r][n.type][n.source];delete this.workerSources[r][n.type][n.source],void 0!==a.removeSource?a.removeSource(n,i):i()}},tf.prototype.loadWorkerSource=function(r,n,i){try{this.self.importScripts(n.url),i()}catch(r){i(r.toString())}},tf.prototype.syncRTLPluginState=function(n,i,a){try{r.plugin.setState(i);var o=r.plugin.getPluginURL();if(r.plugin.isLoaded()&&!r.plugin.isParsed()&&null!=o){this.self.importScripts(o);var s=r.plugin.isParsed();a(s?void 0:Error("RTL Text Plugin failed to import scripts from "+o),s)}}catch(r){a(r.toString())}},tf.prototype.getAvailableImages=function(r){var n=this.availableImages[r];return n||(n=[]),n},tf.prototype.getLayerIndex=function(r){var i=this.layerIndexes[r];return i||(i=this.layerIndexes[r]=new n),i},tf.prototype.getWorkerSource=function(r,n,i){var a=this;return this.workerSources[r]||(this.workerSources[r]={}),this.workerSources[r][n]||(this.workerSources[r][n]={}),this.workerSources[r][n][i]||(this.workerSources[r][n][i]=new this.workerSourceTypes[n]({send:function(n,i,o){a.actor.send(n,i,o,r)}},this.getLayerIndex(r),this.getAvailableImages(r))),this.workerSources[r][n][i]},tf.prototype.getDEMWorkerSource=function(r,n){return this.demWorkerSources[r]||(this.demWorkerSources[r]={}),this.demWorkerSources[r][n]||(this.demWorkerSources[r][n]=new u),this.demWorkerSources[r][n]},tf.prototype.enforceCacheSizeLimit=function(n,i){r.enforceCacheSizeLimit(i)},"undefined"!=typeof WorkerGlobalScope&&void 0!==r.window&&r.window instanceof WorkerGlobalScope&&(r.window.worker=new tf(r.window)),tf}),a(0,function(r){var n=r.createCommonjsModule(function(r){function n(r){return!i(r)}function i(r){var i;return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var r,n,i=new Blob([""],{type:"text/javascript"}),a=URL.createObjectURL(i);try{n=new Worker(a),r=!0}catch(n){r=!1}return n&&n.terminate(),URL.revokeObjectURL(a),r}()?"insufficient worker support":"Uint8ClampedArray"in window?ArrayBuffer.isView?!function(){var r=document.createElement("canvas");r.width=r.height=1;var n=r.getContext("2d");if(!n)return!1;var i=n.getImageData(0,0,1,1);return i&&i.width===r.width}()?"insufficient Canvas/getImageData support":(void 0===a[i=r&&r.failIfMajorPerformanceCaveat]&&(a[i]=function(r){var i,a,o=(i=document.createElement("canvas"),(a=Object.create(n.webGLContextAttributes)).failIfMajorPerformanceCaveat=r,i.probablySupportsContext?i.probablySupportsContext("webgl",a)||i.probablySupportsContext("experimental-webgl",a):i.supportsContext?i.supportsContext("webgl",a)||i.supportsContext("experimental-webgl",a):i.getContext("webgl",a)||i.getContext("experimental-webgl",a));if(!o)return!1;var s=o.createShader(o.VERTEX_SHADER);return!(!s||o.isContextLost())&&(o.shaderSource(s,"void main() {}"),o.compileShader(s),!0===o.getShaderParameter(s,o.COMPILE_STATUS))}(i)),a[i])?void 0:"insufficient WebGL support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support"}r.exports?r.exports=n:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=n,window.mapboxgl.notSupportedReason=i);var a={};n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),i={create:function(n,i,a){var o=r.window.document.createElement(n);return void 0!==i&&(o.className=i),a&&a.appendChild(o),o},createNS:function(n,i){return r.window.document.createElementNS(n,i)}},a=r.window.document.documentElement.style;function o(r){if(!a)return r[0];for(var n=0;n<r.length;n++)if(r[n]in a)return r[n];return r[0]}var s,l=o(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);i.disableDrag=function(){a&&l&&(s=a[l],a[l]="none")},i.enableDrag=function(){a&&l&&(a[l]=s)};var c=o(["transform","WebkitTransform"]);i.setTransform=function(r,n){r.style[c]=n};var u=!1;try{var f=Object.defineProperty({},"passive",{get:function(){u=!0}});r.window.addEventListener("test",f,f),r.window.removeEventListener("test",f,f)}catch(r){u=!1}i.addEventListener=function(r,n,i,a){void 0===a&&(a={}),"passive"in a&&u?r.addEventListener(n,i,a):r.addEventListener(n,i,a.capture)},i.removeEventListener=function(r,n,i,a){void 0===a&&(a={}),"passive"in a&&u?r.removeEventListener(n,i,a):r.removeEventListener(n,i,a.capture)};var h=function(n){n.preventDefault(),n.stopPropagation(),r.window.removeEventListener("click",h,!0)};i.suppressClick=function(){r.window.addEventListener("click",h,!0),r.window.setTimeout(function(){r.window.removeEventListener("click",h,!0)},0)},i.mousePos=function(n,i){var a=n.getBoundingClientRect();return new r.Point(i.clientX-a.left-n.clientLeft,i.clientY-a.top-n.clientTop)},i.touchPos=function(n,i){for(var a=n.getBoundingClientRect(),o=[],s=0;s<i.length;s++)o.push(new r.Point(i[s].clientX-a.left-n.clientLeft,i[s].clientY-a.top-n.clientTop));return o},i.mouseButton=function(n){return void 0!==r.window.InstallTrigger&&2===n.button&&n.ctrlKey&&r.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},i.remove=function(r){r.parentNode&&r.parentNode.removeChild(r)};var p=function(n){function i(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.isLoaded=function(){return this.loaded},i.prototype.setLoaded=function(r){if(this.loaded!==r&&(this.loaded=r,r)){for(var n=0,i=this.requestors;n<i.length;n+=1){var a=i[n],o=a.ids,s=a.callback;this._notify(o,s)}this.requestors=[]}},i.prototype.getImage=function(r){return this.images[r]},i.prototype.addImage=function(r,n){this._validate(r,n)&&(this.images[r]=n)},i.prototype._validate=function(n,i){var a=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new r.ErrorEvent(Error('Image "'+n+'" has invalid "stretchX" value'))),a=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new r.ErrorEvent(Error('Image "'+n+'" has invalid "stretchY" value'))),a=!1),this._validateContent(i.content,i)||(this.fire(new r.ErrorEvent(Error('Image "'+n+'" has invalid "content" value'))),a=!1),a},i.prototype._validateStretch=function(r,n){if(!r)return!0;for(var i=0,a=0;a<r.length;a+=1){var o=r[a];if(o[0]<i||o[1]<o[0]||n<o[1])return!1;i=o[1]}return!0},i.prototype._validateContent=function(r,n){return!r||4===r.length&&!(r[0]<0||n.data.width<r[0])&&!(r[1]<0||n.data.height<r[1])&&!(r[2]<0||n.data.width<r[2])&&!(r[3]<0||n.data.height<r[3])&&!(r[2]<r[0])&&!(r[3]<r[1])},i.prototype.updateImage=function(r,n){var i=this.images[r];n.version=i.version+1,this.images[r]=n,this.updatedImages[r]=!0},i.prototype.removeImage=function(r){var n=this.images[r];delete this.images[r],delete this.patterns[r],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()},i.prototype.listImages=function(){return Object.keys(this.images)},i.prototype.getImages=function(r,n){var i=!0;if(!this.isLoaded())for(var a=0;a<r.length;a+=1){var o=r[a];this.images[o]||(i=!1)}this.isLoaded()||i?this._notify(r,n):this.requestors.push({ids:r,callback:n})},i.prototype._notify=function(n,i){for(var a={},o=0;o<n.length;o+=1){var s=n[o];this.images[s]||this.fire(new r.Event("styleimagemissing",{id:s}));var l=this.images[s];l?a[s]={data:l.data.clone(),pixelRatio:l.pixelRatio,sdf:l.sdf,version:l.version,stretchX:l.stretchX,stretchY:l.stretchY,content:l.content,hasRenderCallback:!!(l.userImage&&l.userImage.render)}:r.warnOnce('Image "'+s+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}i(null,a)},i.prototype.getPixelSize=function(){var r=this.atlasImage;return{width:r.width,height:r.height}},i.prototype.getPattern=function(n){var i=this.patterns[n],a=this.getImage(n);if(!a)return null;if(i&&i.position.version===a.version)return i.position;if(i)i.position.version=a.version;else{var o={w:a.data.width+2,h:a.data.height+2,x:0,y:0},s=new r.ImagePosition(o,a);this.patterns[n]={bin:o,position:s}}return this._updatePatternAtlas(),this.patterns[n].position},i.prototype.bind=function(n){var i=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new r.Texture(n,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)},i.prototype._updatePatternAtlas=function(){var n=[];for(var i in this.patterns)n.push(this.patterns[i].bin);var a=r.potpack(n),o=a.w,s=a.h,l=this.atlasImage;for(var c in l.resize({width:o||1,height:s||1}),this.patterns){var u=this.patterns[c].bin,f=u.x+1,h=u.y+1,p=this.images[c].data,d=p.width,m=p.height;r.RGBAImage.copy(p,l,{x:0,y:0},{x:f,y:h},{width:d,height:m}),r.RGBAImage.copy(p,l,{x:0,y:m-1},{x:f,y:h-1},{width:d,height:1}),r.RGBAImage.copy(p,l,{x:0,y:0},{x:f,y:h+m},{width:d,height:1}),r.RGBAImage.copy(p,l,{x:d-1,y:0},{x:f-1,y:h},{width:1,height:m}),r.RGBAImage.copy(p,l,{x:0,y:0},{x:f+d,y:h},{width:1,height:m})}this.dirty=!0},i.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},i.prototype.dispatchRenderCallbacks=function(r){for(var n=0;n<r.length;n+=1){var i=r[n];if(!this.callbackDispatchedThisFrame[i]){this.callbackDispatchedThisFrame[i]=!0;var a=this.images[i];(function(r){var n=r.userImage;return!!(n&&n.render&&n.render())&&(r.data.replace(new Uint8Array(n.data.buffer)),!0)})(a)&&this.updateImage(i,a)}}},i}(r.Evented);function d(r,n,i,a,o,s){this.fontSize=r||24,this.buffer=void 0===n?3:n,this.cutoff=a||.25,this.fontFamily=o||"sans-serif",this.fontWeight=s||"normal",this.radius=i||8;var l=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=l,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.d=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Int16Array(l),this.middle=Math.round(l/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function m(r,n,i,a,o,s,l){for(var c=0;c<n;c++){for(var u=0;u<i;u++)a[u]=r[u*n+c];for(g(a,o,s,l,i),u=0;u<i;u++)r[u*n+c]=o[u]}for(u=0;u<i;u++){for(c=0;c<n;c++)a[c]=r[u*n+c];for(g(a,o,s,l,n),c=0;c<n;c++)r[u*n+c]=Math.sqrt(o[c])}}function g(r,n,i,a,o){i[0]=0,a[0]=-1e20,a[1]=1e20;for(var s=1,l=0;s<o;s++){for(var c=(r[s]+s*s-(r[i[l]]+i[l]*i[l]))/(2*s-2*i[l]);c<=a[l];)l--,c=(r[s]+s*s-(r[i[l]]+i[l]*i[l]))/(2*s-2*i[l]);i[++l]=s,a[l]=c,a[l+1]=1e20}for(s=0,l=0;s<o;s++){for(;a[l+1]<s;)l++;n[s]=(s-i[l])*(s-i[l])+r[i[l]]}}d.prototype.draw=function(r){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(r,this.buffer,this.middle);for(var n=this.ctx.getImageData(0,0,this.size,this.size),i=new Uint8ClampedArray(this.size*this.size),a=0;a<this.size*this.size;a++){var o=n.data[4*a+3]/255;this.gridOuter[a]=1===o?0:0===o?1e20:Math.pow(Math.max(0,.5-o),2),this.gridInner[a]=1===o?1e20:0===o?0:Math.pow(Math.max(0,o-.5),2)}for(m(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),m(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),a=0;a<this.size*this.size;a++){var s=this.gridOuter[a]-this.gridInner[a];i[a]=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))))}return i},d.default=d;var v=function(r,n){this.requestManager=r,this.localIdeographFontFamily=n,this.entries={}};v.prototype.setURL=function(r){this.url=r},v.prototype.getGlyphs=function(n,i){var a=this,o=[];for(var s in n)for(var l=0,c=n[s];l<c.length;l+=1){var u=c[l];o.push({stack:s,id:u})}r.asyncAll(o,function(r,n){var i=r.stack,o=r.id,s=a.entries[i];s||(s=a.entries[i]={glyphs:{},requests:{},ranges:{}});var l=s.glyphs[o];if(void 0===l){if(l=a._tinySDF(s,i,o))return s.glyphs[o]=l,void n(null,{stack:i,id:o,glyph:l});var c=Math.floor(o/256);if(256*c>65535)n(Error("glyphs > 65535 not supported"));else if(s.ranges[c])n(null,{stack:i,id:o,glyph:l});else{var u=s.requests[c];u||(u=s.requests[c]=[],v.loadGlyphRange(i,c,a.url,a.requestManager,function(r,n){if(n){for(var i in n)a._doesCharSupportLocalGlyph(+i)||(s.glyphs[+i]=n[+i]);s.ranges[c]=!0}for(var o=0,l=u;o<l.length;o+=1)(0,l[o])(r,n);delete s.requests[c]})),u.push(function(r,a){r?n(r):a&&n(null,{stack:i,id:o,glyph:a[o]||null})})}}else n(null,{stack:i,id:o,glyph:l})},function(r,n){if(r)i(r);else if(n){for(var a={},o=0;o<n.length;o+=1){var s=n[o],l=s.stack,c=s.id,u=s.glyph;(a[l]||(a[l]={}))[c]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}i(null,a)}})},v.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(r.isChar["CJK Unified Ideographs"](n)||r.isChar["Hangul Syllables"](n)||r.isChar.Hiragana(n)||r.isChar.Katakana(n))},v.prototype._tinySDF=function(n,i,a){var o=this.localIdeographFontFamily;if(o&&this._doesCharSupportLocalGlyph(a)){var s=n.tinySDF;if(!s){var l="400";/bold/i.test(i)?l="900":/medium/i.test(i)?l="500":/light/i.test(i)&&(l="200"),s=n.tinySDF=new v.TinySDF(24,3,8,.25,o,l)}return{id:a,bitmap:new r.AlphaImage({width:30,height:30},s.draw(String.fromCharCode(a))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},v.loadGlyphRange=function(n,i,a,o,s){var l=256*i,c=o.transformRequest(o.normalizeGlyphsURL(a).replace("{fontstack}",n).replace("{range}",l+"-"+(l+255)),r.ResourceType.Glyphs);r.getArrayBuffer(c,function(n,i){if(n)s(n);else if(i){for(var a={},o=0,l=r.parseGlyphPBF(i);o<l.length;o+=1){var c=l[o];a[c.id]=c}s(null,a)}})},v.TinySDF=d;var y=function(){this.specification=r.styleSpec.light.position};y.prototype.possiblyEvaluate=function(n,i){return r.sphericalToCartesian(n.expression.evaluate(i))},y.prototype.interpolate=function(n,i,a){return{x:r.number(n.x,i.x,a),y:r.number(n.y,i.y,a),z:r.number(n.z,i.z,a)}};var x=new r.Properties({anchor:new r.DataConstantProperty(r.styleSpec.light.anchor),position:new y,color:new r.DataConstantProperty(r.styleSpec.light.color),intensity:new r.DataConstantProperty(r.styleSpec.light.intensity)}),b=function(n){function i(i){n.call(this),this._transitionable=new r.Transitionable(x),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.getLight=function(){return this._transitionable.serialize()},i.prototype.setLight=function(n,i){if(void 0===i&&(i={}),!this._validate(r.validateLight,n,i))for(var a in n){var o=n[a];r.endsWith(a,"-transition")?this._transitionable.setTransition(a.slice(0,-11),o):this._transitionable.setValue(a,o)}},i.prototype.updateTransitions=function(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)},i.prototype.hasTransition=function(){return this._transitioning.hasTransition()},i.prototype.recalculate=function(r){this.properties=this._transitioning.possiblyEvaluate(r)},i.prototype._validate=function(n,i,a){return(!a||!1!==a.validate)&&r.emitValidationErrors(this,n.call(r.validateStyle,r.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:r.styleSpec})))},i}(r.Evented),_=function(r,n){this.width=r,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};_.prototype.getDash=function(r,n){var i=r.join(",")+String(n);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(r,n)),this.dashEntry[i]},_.prototype.getDashRanges=function(r,n,i){var a=[],o=r.length%2==1?-r[r.length-1]*i:0,s=r[0]*i,l=!0;a.push({left:o,right:s,isDash:l,zeroLength:0===r[0]});for(var c=r[0],u=1;u<r.length;u++){l=!l;var f=r[u];o=c*i,s=(c+=f)*i,a.push({left:o,right:s,isDash:l,zeroLength:0===f})}return a},_.prototype.addRoundDash=function(r,n,i){for(var a=n/2,o=-i;o<=i;o++)for(var s=this.nextRow+i+o,l=this.width*s,c=0,u=r[c],f=0;f<this.width;f++){f/u.right>1&&(u=r[++c]);var h=Math.min(Math.abs(f-u.left),Math.abs(f-u.right)),p=void 0,d=o/i*(a+1);if(u.isDash){var m=a-Math.abs(d);p=Math.sqrt(h*h+m*m)}else p=a-Math.sqrt(h*h+d*d);this.data[l+f]=Math.max(0,Math.min(255,p+128))}},_.prototype.addRegularDash=function(r){for(var n=r.length-1;n>=0;--n){var i=r[n],a=r[n+1];i.zeroLength?r.splice(n,1):a&&a.isDash===i.isDash&&(a.left=i.left,r.splice(n,1))}var o=r[0],s=r[r.length-1];o.isDash===s.isDash&&(o.left=s.left-this.width,s.right=o.right+this.width);for(var l=this.width*this.nextRow,c=0,u=r[c],f=0;f<this.width;f++){f/u.right>1&&(u=r[++c]);var h=Math.min(Math.abs(f-u.left),Math.abs(f-u.right)),p=u.isDash?h:-h;this.data[l+f]=Math.max(0,Math.min(255,p+128))}},_.prototype.addDash=function(n,i){var a=i?7:0,o=2*a+1;if(this.nextRow+o>this.height)return r.warnOnce("LineAtlas out of space"),null;for(var s=0,l=0;l<n.length;l++)s+=n[l];if(0!==s){var c=this.width/s,u=this.getDashRanges(n,this.width,c);i?this.addRoundDash(u,c,a):this.addRegularDash(u)}var f={y:(this.nextRow+a+.5)/this.height,height:2*a/this.height,width:s};return this.nextRow+=o,this.dirty=!0,f},_.prototype.bind=function(r){var n=r.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))};var w=function n(i,a){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=r.uniqueId();for(var o=this.workerPool.acquire(this.id),s=0;s<o.length;s++){var l=o[s],c=new n.Actor(l,a,this.id);c.name="Worker "+s,this.actors.push(c)}};function T(n,i,a){var o=function(o,s){if(o)return a(o);if(s){var l=r.pick(r.extend(s,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);s.vector_layers&&(l.vectorLayers=s.vector_layers,l.vectorLayerIds=l.vectorLayers.map(function(r){return r.id})),l.tiles=i.canonicalizeTileset(l,n.url),a(null,l)}};return n.url?r.getJSON(i.transformRequest(i.normalizeSourceURL(n.url),r.ResourceType.Source),o):r.browser.frame(function(){return o(null,n)})}w.prototype.broadcast=function(n,i,a){a=a||function(){},r.asyncAll(this.actors,function(r,a){r.send(n,i,a)},a)},w.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},w.prototype.remove=function(){this.actors.forEach(function(r){r.remove()}),this.actors=[],this.workerPool.release(this.id)},w.Actor=r.Actor;var k=function(n,i,a){this.bounds=r.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=i||0,this.maxzoom=a||24};k.prototype.validateBounds=function(r){return Array.isArray(r)&&4===r.length?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]},k.prototype.contains=function(n){var i=Math.pow(2,n.z),a=Math.floor(r.mercatorXfromLng(this.bounds.getWest())*i),o=Math.floor(r.mercatorYfromLat(this.bounds.getNorth())*i),s=Math.ceil(r.mercatorXfromLng(this.bounds.getEast())*i),l=Math.ceil(r.mercatorYfromLat(this.bounds.getSouth())*i);return n.x>=a&&n.x<s&&n.y>=o&&n.y<l};var A=function(n){function i(i,a,o,s){if(n.call(this),this.id=i,this.dispatcher=o,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.extend(this,r.pick(a,["url","scheme","tileSize","promoteId"])),this._options=r.extend({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,512!==this.tileSize)throw Error("vector tile sources must have a tileSize of 512");this.setEventedParent(s)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=T(this._options,this.map._requestManager,function(i,a){n._tileJSONRequest=null,n._loaded=!0,i?n.fire(new r.ErrorEvent(i)):a&&(r.extend(n,a),a.bounds&&(n.tileBounds=new k(a.bounds,n.minzoom,n.maxzoom)),r.postTurnstileEvent(a.tiles,n.map._requestManager._customAccessToken),r.postMapLoadEvent(a.tiles,n.map._getMapId(),n.map._requestManager._skuToken,n.map._requestManager._customAccessToken),n.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.hasTile=function(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)},i.prototype.onAdd=function(r){this.map=r,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return r.extend({},this._options)},i.prototype.loadTile=function(n,i){var a=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),o={request:this.map._requestManager.transformRequest(a,r.ResourceType.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:r.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function s(a,o){return delete n.request,n.aborted?i(null):a&&404!==a.status?i(a):(o&&o.resourceTiming&&(n.resourceTiming=o.resourceTiming),this.map._refreshExpiredTiles&&o&&n.setExpiryData(o),n.loadVectorData(o,this.map.painter),r.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}o.request.collectResourceTiming=this._collectResourceTiming,n.actor&&"expired"!==n.state?"loading"===n.state?n.reloadCallback=i:n.request=n.actor.send("reloadTile",o,s.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",o,s.bind(this)))},i.prototype.abortTile=function(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id},void 0)},i.prototype.unloadTile=function(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id},void 0)},i.prototype.hasTransition=function(){return!1},i}(r.Evented),M=function(n){function i(i,a,o,s){n.call(this),this.id=i,this.dispatcher=o,this.setEventedParent(s),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.extend({type:"raster"},a),r.extend(this,r.pick(a,["url","scheme","tileSize"]))}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=T(this._options,this.map._requestManager,function(i,a){n._tileJSONRequest=null,n._loaded=!0,i?n.fire(new r.ErrorEvent(i)):a&&(r.extend(n,a),a.bounds&&(n.tileBounds=new k(a.bounds,n.minzoom,n.maxzoom)),r.postTurnstileEvent(a.tiles),r.postMapLoadEvent(a.tiles,n.map._getMapId(),n.map._requestManager._skuToken),n.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),n.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})))})},i.prototype.loaded=function(){return this._loaded},i.prototype.onAdd=function(r){this.map=r,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return r.extend({},this._options)},i.prototype.hasTile=function(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)},i.prototype.loadTile=function(n,i){var a=this,o=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);n.request=r.getImage(this.map._requestManager.transformRequest(o,r.ResourceType.Tile),function(o,s){if(delete n.request,n.aborted)n.state="unloaded",i(null);else if(o)n.state="errored",i(o);else if(s){a.map._refreshExpiredTiles&&n.setExpiryData(s),delete s.cacheControl,delete s.expires;var l=a.map.painter.context,c=l.gl;n.texture=a.map.painter.getTileTexture(s.width),n.texture?n.texture.update(s,{useMipmap:!0}):(n.texture=new r.Texture(l,s,c.RGBA,{useMipmap:!0}),n.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE,c.LINEAR_MIPMAP_NEAREST),l.extTextureFilterAnisotropic&&c.texParameterf(c.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax)),n.state="loaded",r.cacheEntryPossiblyAdded(a.dispatcher),i(null)}})},i.prototype.abortTile=function(r,n){r.request&&(r.request.cancel(),delete r.request),n()},i.prototype.unloadTile=function(r,n){r.texture&&this.map.painter.saveTileTexture(r.texture),n()},i.prototype.hasTransition=function(){return!1},i}(r.Evented),S=function(n){function i(i,a,o,s){n.call(this,i,a,o,s),this.type="raster-dem",this.maxzoom=22,this._options=r.extend({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},i.prototype.loadTile=function(n,i){var a=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function o(r,a){r&&(n.state="errored",i(r)),a&&(n.dem=a,n.needsHillshadePrepare=!0,n.state="loaded",i(null))}n.request=r.getImage(this.map._requestManager.transformRequest(a,r.ResourceType.Tile),(function(a,s){if(delete n.request,n.aborted)n.state="unloaded",i(null);else if(a)n.state="errored",i(a);else if(s){this.map._refreshExpiredTiles&&n.setExpiryData(s),delete s.cacheControl,delete s.expires;var l=r.window.ImageBitmap&&s instanceof r.window.ImageBitmap&&r.offscreenCanvasSupported()?s:r.browser.getImageData(s,1),c={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:l,encoding:this.encoding};n.actor&&"expired"!==n.state||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",c,o.bind(this)))}}).bind(this)),n.neighboringTiles=this._getNeighboringTiles(n.tileID)},i.prototype._getNeighboringTiles=function(n){var i=n.canonical,a=Math.pow(2,i.z),o=(i.x-1+a)%a,s=0===i.x?n.wrap-1:n.wrap,l=(i.x+1+a)%a,c=i.x+1===a?n.wrap+1:n.wrap,u={};return u[new r.OverscaledTileID(n.overscaledZ,s,i.z,o,i.y).key]={backfilled:!1},u[new r.OverscaledTileID(n.overscaledZ,c,i.z,l,i.y).key]={backfilled:!1},i.y>0&&(u[new r.OverscaledTileID(n.overscaledZ,s,i.z,o,i.y-1).key]={backfilled:!1},u[new r.OverscaledTileID(n.overscaledZ,n.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},u[new r.OverscaledTileID(n.overscaledZ,c,i.z,l,i.y-1).key]={backfilled:!1}),i.y+1<a&&(u[new r.OverscaledTileID(n.overscaledZ,s,i.z,o,i.y+1).key]={backfilled:!1},u[new r.OverscaledTileID(n.overscaledZ,n.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},u[new r.OverscaledTileID(n.overscaledZ,c,i.z,l,i.y+1).key]={backfilled:!1}),u},i.prototype.unloadTile=function(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&r.actor.send("removeDEMTile",{uid:r.uid,source:this.id})},i}(M),E=function(n){function i(i,a,o,s){n.call(this),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=o.getActor(),this.setEventedParent(s),this._data=a.data,this._options=r.extend({},a),this._collectResourceTiming=a.collectResourceTiming,this._resourceTiming=[],void 0!==a.maxzoom&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;var l=r.EXTENT/this.tileSize;this.workerOptions=r.extend({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(void 0!==a.buffer?a.buffer:128)*l,tolerance:(void 0!==a.tolerance?a.tolerance:.375)*l,extent:r.EXTENT,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:void 0!==a.clusterMaxZoom?Math.min(a.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:r.EXTENT,radius:(a.clusterRadius||50)*l,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties},a.workerOptions)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){var n=this;this.fire(new r.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(i){if(i)n.fire(new r.ErrorEvent(i));else{var a={dataType:"source",sourceDataType:"metadata"};n._collectResourceTiming&&n._resourceTiming&&n._resourceTiming.length>0&&(a.resourceTiming=n._resourceTiming,n._resourceTiming=[]),n.fire(new r.Event("data",a))}})},i.prototype.onAdd=function(r){this.map=r,this.load()},i.prototype.setData=function(n){var i=this;return this._data=n,this.fire(new r.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(n){if(n)i.fire(new r.ErrorEvent(n));else{var a={dataType:"source",sourceDataType:"content"};i._collectResourceTiming&&i._resourceTiming&&i._resourceTiming.length>0&&(a.resourceTiming=i._resourceTiming,i._resourceTiming=[]),i.fire(new r.Event("data",a))}}),this},i.prototype.getClusterExpansionZoom=function(r,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id},n),this},i.prototype.getClusterChildren=function(r,n){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id},n),this},i.prototype.getClusterLeaves=function(r,n,i,a){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:r,limit:n,offset:i},a),this},i.prototype._updateWorkerData=function(n){var i=this;this._loaded=!1;var a=r.extend({},this.workerOptions),o=this._data;"string"==typeof o?(a.request=this.map._requestManager.transformRequest(r.browser.resolveURL(o),r.ResourceType.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(o),this.actor.send(this.type+".loadData",a,function(r,o){i._removed||o&&o.abandoned||(i._loaded=!0,o&&o.resourceTiming&&o.resourceTiming[i.id]&&(i._resourceTiming=o.resourceTiming[i.id].slice(0)),i.actor.send(i.type+".coalesce",{source:a.source},null),n(r))})},i.prototype.loaded=function(){return this._loaded},i.prototype.loadTile=function(n,i){var a=this,o=n.actor?"reloadTile":"loadTile";n.actor=this.actor;var s={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:r.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request=this.actor.send(o,s,function(r,s){return delete n.request,n.unloadVectorData(),n.aborted?i(null):r?i(r):(n.loadVectorData(s,a.map.painter,"reloadTile"===o),i(null))})},i.prototype.abortTile=function(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0},i.prototype.unloadTile=function(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})},i.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},i.prototype.serialize=function(){return r.extend({},this._options,{type:this.type,data:this._data})},i.prototype.hasTransition=function(){return!1},i}(r.Evented),L=r.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),C=function(n){function i(r,i,a,o){n.call(this),this.id=r,this.dispatcher=a,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(o),this.options=i}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(n,i){var a=this;this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this.url=this.options.url,r.getImage(this.map._requestManager.transformRequest(this.url,r.ResourceType.Image),function(o,s){a._loaded=!0,o?a.fire(new r.ErrorEvent(o)):s&&(a.image=s,n&&(a.coordinates=n),i&&i(),a._finishLoading())})},i.prototype.loaded=function(){return this._loaded},i.prototype.updateImage=function(r){var n=this;return this.image&&r.url&&(this.options.url=r.url,this.load(r.coordinates,function(){n.texture=null})),this},i.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})))},i.prototype.onAdd=function(r){this.map=r,this.load()},i.prototype.setCoordinates=function(n){var i=this;this.coordinates=n;var a=n.map(r.MercatorCoordinate.fromLngLat);this.tileID=function(n){for(var i=1/0,a=1/0,o=-1/0,s=-1/0,l=0;l<n.length;l+=1){var c=n[l];i=Math.min(i,c.x),a=Math.min(a,c.y),o=Math.max(o,c.x),s=Math.max(s,c.y)}var u=Math.max(0,Math.floor(-Math.log(Math.max(o-i,s-a))/Math.LN2)),f=Math.pow(2,u);return new r.CanonicalTileID(u,Math.floor((i+o)/2*f),Math.floor((a+s)/2*f))}(a),this.minzoom=this.maxzoom=this.tileID.z;var o=a.map(function(r){return i.tileID.getTilePoint(r)._round()});return this._boundsArray=new r.StructArrayLayout4i8,this._boundsArray.emplaceBack(o[0].x,o[0].y,0,0),this._boundsArray.emplaceBack(o[1].x,o[1].y,r.EXTENT,0),this._boundsArray.emplaceBack(o[3].x,o[3].y,0,r.EXTENT),this._boundsArray.emplaceBack(o[2].x,o[2].y,r.EXTENT,r.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})),this},i.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var n=this.map.painter.context,i=n.gl;for(var a in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,L.members)),this.boundsSegments||(this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new r.Texture(n,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[a];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},i.prototype.loadTile=function(r,n){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={}):r.state="errored",n(null)},i.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return!1},i}(r.Evented),P=function(n){function i(r,i,a,o){n.call(this,r,i,a,o),this.roundZoom=!0,this.type="video",this.options=i}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){var n=this;this._loaded=!1;var i=this.options;this.urls=[];for(var a=0,o=i.urls;a<o.length;a+=1){var s=o[a];this.urls.push(this.map._requestManager.transformRequest(s,r.ResourceType.Source).url)}r.getVideo(this.urls,function(i,a){n._loaded=!0,i?n.fire(new r.ErrorEvent(i)):a&&(n.video=a,n.video.loop=!0,n.video.addEventListener("playing",function(){n.map.triggerRepaint()}),n.map&&n.video.play(),n._finishLoading())})},i.prototype.pause=function(){this.video&&this.video.pause()},i.prototype.play=function(){this.video&&this.video.play()},i.prototype.seek=function(n){if(this.video){var i=this.video.seekable;n<i.start(0)||n>i.end(0)?this.fire(new r.ErrorEvent(new r.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+i.start(0)+" and "+i.end(0)+"-second mark."))):this.video.currentTime=n}},i.prototype.getVideo=function(){return this.video},i.prototype.onAdd=function(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},i.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var n=this.map.painter.context,i=n.gl;for(var a in this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,L.members)),this.boundsSegments||(this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new r.Texture(n,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE)),this.tiles){var o=this.tiles[a];"loaded"!==o.state&&(o.state="loaded",o.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this.video&&!this.video.paused},i}(C),I=function(n){function i(i,a,o,s){n.call(this,i,a,o,s),a.coordinates?Array.isArray(a.coordinates)&&4===a.coordinates.length&&!a.coordinates.some(function(r){return!Array.isArray(r)||2!==r.length||r.some(function(r){return"number"!=typeof r})})||this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'missing required property "coordinates"'))),a.animate&&"boolean"!=typeof a.animate&&this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'optional "animate" property must be a boolean value'))),a.canvas?"string"==typeof a.canvas||a.canvas instanceof r.window.HTMLCanvasElement||this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.ErrorEvent(new r.ValidationError("sources."+i,null,'missing required property "canvas"'))),this.options=a,this.animate=void 0===a.animate||a.animate}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof r.window.HTMLCanvasElement?this.options.canvas:r.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.ErrorEvent(Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},i.prototype.getCanvas=function(){return this.canvas},i.prototype.onAdd=function(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()},i.prototype.onRemove=function(){this.pause()},i.prototype.prepare=function(){var n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var i=this.map.painter.context,a=i.gl;for(var o in this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,L.members)),this.boundsSegments||(this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.Texture(i,this.canvas,a.RGBA,{premultiply:!0}),this.tiles){var s=this.tiles[o];"loaded"!==s.state&&(s.state="loaded",s.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this._playing},i.prototype._hasInvalidDimensions=function(){for(var r=0,n=[this.canvas.width,this.canvas.height];r<n.length;r+=1){var i=n[r];if(isNaN(i)||i<=0)return!0}return!1},i}(C),O={vector:A,raster:M,"raster-dem":S,geojson:E,video:P,image:C,canvas:I};function z(r,n){var i=r.tileID,a=n.tileID;return i.overscaledZ-a.overscaledZ||i.canonical.y-a.canonical.y||i.wrap-a.wrap||i.canonical.x-a.canonical.x}var D=function(r,n){this.max=r,this.onRemove=n,this.reset()};D.prototype.reset=function(){for(var r in this.data)for(var n=0,i=this.data[r];n<i.length;n+=1){var a=i[n];a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value)}return this.data={},this.order=[],this},D.prototype.add=function(r,n,i){var a=this,o=r.wrapped().key;void 0===this.data[o]&&(this.data[o]=[]);var s={value:n,timeout:void 0};if(void 0!==i&&(s.timeout=setTimeout(function(){a.remove(r,s)},i)),this.data[o].push(s),this.order.push(o),this.order.length>this.max){var l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this},D.prototype.has=function(r){return r.wrapped().key in this.data},D.prototype.getAndRemove=function(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null},D.prototype._getAndRemoveByKey=function(r){var n=this.data[r].shift();return n.timeout&&clearTimeout(n.timeout),0===this.data[r].length&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),n.value},D.prototype.getByKey=function(r){var n=this.data[r];return n?n[0].value:null},D.prototype.get=function(r){return this.has(r)?this.data[r.wrapped().key][0].value:null},D.prototype.remove=function(r,n){if(!this.has(r))return this;var i=r.wrapped().key,a=void 0===n?0:this.data[i].indexOf(n),o=this.data[i][a];return this.data[i].splice(a,1),o.timeout&&clearTimeout(o.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(o.value),this.order.splice(this.order.indexOf(i),1),this},D.prototype.setMaxSize=function(r){for(this.max=r;this.order.length>this.max;){var n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this},D.prototype.filter=function(r){var n=[];for(var i in this.data)for(var a=0,o=this.data[i];a<o.length;a+=1){var s=o[a];r(s.value)||n.push(s)}for(var l=0;l<n.length;l+=1){var c=n[l];this.remove(c.value.tileID,c)}};var R=function(r,n,i){this.context=r;var a=r.gl;this.buffer=a.createBuffer(),this.dynamicDraw=!!i,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};R.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},R.prototype.updateData=function(r){var n=this.context.gl;this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)},R.prototype.destroy=function(){var r=this.context.gl;this.buffer&&(r.deleteBuffer(this.buffer),delete this.buffer)};var F={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},B=function(r,n,i,a){this.length=n.length,this.attributes=i,this.itemSize=n.bytesPerElement,this.dynamicDraw=a,this.context=r;var o=r.gl;this.buffer=o.createBuffer(),r.bindVertexBuffer.set(this.buffer),o.bufferData(o.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?o.DYNAMIC_DRAW:o.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer};B.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},B.prototype.updateData=function(r){var n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,r.arrayBuffer)},B.prototype.enableAttributes=function(r,n){for(var i=0;i<this.attributes.length;i++){var a=this.attributes[i],o=n.attributes[a.name];void 0!==o&&r.enableVertexAttribArray(o)}},B.prototype.setVertexAttribPointers=function(r,n,i){for(var a=0;a<this.attributes.length;a++){var o=this.attributes[a],s=n.attributes[o.name];void 0!==s&&r.vertexAttribPointer(s,o.components,r[F[o.type]],!1,this.itemSize,o.offset+this.itemSize*(i||0))}},B.prototype.destroy=function(){var r=this.context.gl;this.buffer&&(r.deleteBuffer(this.buffer),delete this.buffer)};var N=function(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};N.prototype.get=function(){return this.current},N.prototype.set=function(r){},N.prototype.getDefault=function(){return this.default},N.prototype.setDefault=function(){this.set(this.default)};var j=function(n){function i(){n.apply(this,arguments)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.getDefault=function(){return r.Color.transparent},i.prototype.set=function(r){var n=this.current;(r.r!==n.r||r.g!==n.g||r.b!==n.b||r.a!==n.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)},i}(N),U=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return 1},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)},n}(N),V=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return 0},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)},n}(N),H=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return[!0,!0,!0,!0]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||r[2]!==n[2]||r[3]!==n[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)},n}(N),q=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!0},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)},n}(N),G=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return 255},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)},n}(N),Y=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},n.prototype.set=function(r){var n=this.current;(r.func!==n.func||r.ref!==n.ref||r.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)},n}(N),W=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){var r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||r[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)},n}(N),X=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;r?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=r,this.dirty=!1}},n}(N),Z=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return[0,1]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)},n}(N),J=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;r?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=r,this.dirty=!1}},n}(N),K=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.LESS},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)},n}(N),Q=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;r?n.enable(n.BLEND):n.disable(n.BLEND),this.current=r,this.dirty=!1}},n}(N),$=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){var r=this.gl;return[r.ONE,r.ZERO]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)},n}(N),tt=function(n){function i(){n.apply(this,arguments)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.getDefault=function(){return r.Color.transparent},i.prototype.set=function(r){var n=this.current;(r.r!==n.r||r.g!==n.g||r.b!==n.b||r.a!==n.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)},i}(N),te=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.FUNC_ADD},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)},n}(N),tr=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;r?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=r,this.dirty=!1}},n}(N),tn=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.BACK},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)},n}(N),ti=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.CCW},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)},n}(N),ta=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)},n}(N),to=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return this.gl.TEXTURE0},n.prototype.set=function(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)},n}(N),ts=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){var r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]},n.prototype.set=function(r){var n=this.current;(r[0]!==n[0]||r[1]!==n[1]||r[2]!==n[2]||r[3]!==n[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)},n}(N),tl=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,r),this.current=r,this.dirty=!1}},n}(N),tc=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,r),this.current=r,this.dirty=!1}},n}(N),tu=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.bindTexture(n.TEXTURE_2D,r),this.current=r,this.dirty=!1}},n}(N),tf=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}},n}(N),th=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){var n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1},n}(N),tp=function(r){function n(n){r.call(this,n),this.vao=n.extVertexArrayObject}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n.prototype.set=function(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)},n}(N),td=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return 4},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}},n}(N),tm=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}},n}(N),tg=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return!1},n.prototype.set=function(r){if(r!==this.current||this.dirty){var n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}},n}(N),tv=function(r){function n(n,i){r.call(this,n),this.context=n,this.parent=i}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.getDefault=function(){return null},n}(N),ty=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.setDirty=function(){this.dirty=!0},n.prototype.set=function(r){if(r!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}},n}(tv),tx=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.set=function(r){if(r!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,r),this.current=r,this.dirty=!1}},n}(tv),tb=function(r,n,i,a){this.context=r,this.width=n,this.height=i;var o=r.gl,s=this.framebuffer=o.createFramebuffer();this.colorAttachment=new ty(r,s),a&&(this.depthAttachment=new tx(r,s))};tb.prototype.destroy=function(){var r=this.context.gl,n=this.colorAttachment.get();if(n&&r.deleteTexture(n),this.depthAttachment){var i=this.depthAttachment.get();i&&r.deleteRenderbuffer(i)}r.deleteFramebuffer(this.framebuffer)};var t_=function(r,n,i){this.func=r,this.mask=n,this.range=i};t_.ReadOnly=!1,t_.ReadWrite=!0,t_.disabled=new t_(519,t_.ReadOnly,[0,1]);var tw=function(r,n,i,a,o,s){this.test=r,this.ref=n,this.mask=i,this.fail=a,this.depthFail=o,this.pass=s};tw.disabled=new tw({func:519,mask:0},0,0,7680,7680,7680);var tT=function(r,n,i){this.blendFunction=r,this.blendColor=n,this.mask=i};tT.disabled=new tT(tT.Replace=[1,0],r.Color.transparent,[!1,!1,!1,!1]),tT.unblended=new tT(tT.Replace,r.Color.transparent,[!0,!0,!0,!0]),tT.alphaBlended=new tT([1,771],r.Color.transparent,[!0,!0,!0,!0]);var tk=function(r,n,i){this.enable=r,this.mode=n,this.frontFace=i};tk.disabled=new tk(!1,1029,2305),tk.backCCW=new tk(!0,1029,2305);var tA=function(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new j(this),this.clearDepth=new U(this),this.clearStencil=new V(this),this.colorMask=new H(this),this.depthMask=new q(this),this.stencilMask=new G(this),this.stencilFunc=new Y(this),this.stencilOp=new W(this),this.stencilTest=new X(this),this.depthRange=new Z(this),this.depthTest=new J(this),this.depthFunc=new K(this),this.blend=new Q(this),this.blendFunc=new $(this),this.blendColor=new tt(this),this.blendEquation=new te(this),this.cullFace=new tr(this),this.cullFaceSide=new tn(this),this.frontFace=new ti(this),this.program=new ta(this),this.activeTexture=new to(this),this.viewport=new ts(this),this.bindFramebuffer=new tl(this),this.bindRenderbuffer=new tc(this),this.bindTexture=new tu(this),this.bindVertexBuffer=new tf(this),this.bindElementBuffer=new th(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new tp(this),this.pixelStoreUnpack=new td(this),this.pixelStoreUnpackPremultiplyAlpha=new tm(this),this.pixelStoreUnpackFlipY=new tg(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query")};tA.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},tA.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},tA.prototype.createIndexBuffer=function(r,n){return new R(this,r,n)},tA.prototype.createVertexBuffer=function(r,n,i){return new B(this,r,n,i)},tA.prototype.createRenderbuffer=function(r,n,i){var a=this.gl,o=a.createRenderbuffer();return this.bindRenderbuffer.set(o),a.renderbufferStorage(a.RENDERBUFFER,r,n,i),this.bindRenderbuffer.set(null),o},tA.prototype.createFramebuffer=function(r,n,i){return new tb(this,r,n,i)},tA.prototype.clear=function(r){var n=r.color,i=r.depth,a=this.gl,o=0;n&&(o|=a.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),void 0!==i&&(o|=a.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(i),this.depthMask.set(!0)),a.clear(o)},tA.prototype.setCullFace=function(r){!1===r.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))},tA.prototype.setDepthMode=function(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)},tA.prototype.setStencilMode=function(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)},tA.prototype.setColorMode=function(n){r.deepEqual(n.blendFunction,tT.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},tA.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var tM=function(n){function i(i,a,o){var s=this;n.call(this),this.id=i,this.dispatcher=o,this.on("data",function(r){"source"===r.dataType&&"metadata"===r.sourceDataType&&(s._sourceLoaded=!0),s._sourceLoaded&&!s._paused&&"source"===r.dataType&&"content"===r.sourceDataType&&(s.reload(),s.transform&&s.update(s.transform))}),this.on("error",function(){s._sourceErrored=!0}),this._source=function(n,i,a,o){var s=new O[i.type](n,i,a,o);if(s.id!==n)throw Error("Expected Source id to be "+n+" instead of "+s.id);return r.bindAll(["load","abort","unload","serialize","prepare"],s),s}(i,a,o,this),this._tiles={},this._cache=new D(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new r.SourceFeatureState}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.onAdd=function(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(r)},i.prototype.onRemove=function(r){this._source&&this._source.onRemove&&this._source.onRemove(r)},i.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var r in this._tiles){var n=this._tiles[r];if("loaded"!==n.state&&"errored"!==n.state)return!1}return!0},i.prototype.getSource=function(){return this._source},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){if(this._paused){var r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}},i.prototype._loadTile=function(r,n){return this._source.loadTile(r,n)},i.prototype._unloadTile=function(r){if(this._source.unloadTile)return this._source.unloadTile(r,function(){})},i.prototype._abortTile=function(r){if(this._source.abortTile)return this._source.abortTile(r,function(){})},i.prototype.serialize=function(){return this._source.serialize()},i.prototype.prepare=function(r){for(var n in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var i=this._tiles[n];i.upload(r),i.prepare(this.map.style.imageManager)}},i.prototype.getIds=function(){return r.values(this._tiles).map(function(r){return r.tileID}).sort(tS).map(function(r){return r.key})},i.prototype.getRenderableIds=function(n){var i=this,a=[];for(var o in this._tiles)this._isIdRenderable(o,n)&&a.push(this._tiles[o]);return n?a.sort(function(n,a){var o=n.tileID,s=a.tileID,l=new r.Point(o.canonical.x,o.canonical.y)._rotate(i.transform.angle),c=new r.Point(s.canonical.x,s.canonical.y)._rotate(i.transform.angle);return o.overscaledZ-s.overscaledZ||c.y-l.y||c.x-l.x}).map(function(r){return r.tileID.key}):a.map(function(r){return r.tileID}).sort(tS).map(function(r){return r.key})},i.prototype.hasRenderableParent=function(r){var n=this.findLoadedParent(r,0);return!!n&&this._isIdRenderable(n.tileID.key)},i.prototype._isIdRenderable=function(r,n){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(n||!this._tiles[r].holdingForFade())},i.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var r in this._cache.reset(),this._tiles)"errored"!==this._tiles[r].state&&this._reloadTile(r,"reloading")},i.prototype._reloadTile=function(r,n){var i=this._tiles[r];i&&("loading"!==i.state&&(i.state=n),this._loadTile(i,this._tileLoaded.bind(this,i,r,n)))},i.prototype._tileLoaded=function(n,i,a,o){if(o)return n.state="errored",void(404!==o.status?this._source.fire(new r.ErrorEvent(o,{tile:n})):this.update(this.transform));n.timeAdded=r.browser.now(),"expired"===a&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(i,n),"raster-dem"===this.getSource().type&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new r.Event("data",{dataType:"source",tile:n,coord:n.tileID}))},i.prototype._backfillDEM=function(r){for(var n=this.getRenderableIds(),i=0;i<n.length;i++){var a=n[i];if(r.neighboringTiles&&r.neighboringTiles[a]){var o=this.getTileByID(a);s(r,o),s(o,r)}}function s(r,n){r.needsHillshadePrepare=!0;var i=n.tileID.canonical.x-r.tileID.canonical.x,a=n.tileID.canonical.y-r.tileID.canonical.y,o=Math.pow(2,r.tileID.canonical.z),s=n.tileID.key;0===i&&0===a||Math.abs(a)>1||(Math.abs(i)>1&&(1===Math.abs(i+o)?i+=o:1===Math.abs(i-o)&&(i-=o)),n.dem&&r.dem&&(r.dem.backfillBorder(n.dem,i,a),r.neighboringTiles&&r.neighboringTiles[s]&&(r.neighboringTiles[s].backfilled=!0)))}},i.prototype.getTile=function(r){return this.getTileByID(r.key)},i.prototype.getTileByID=function(r){return this._tiles[r]},i.prototype._retainLoadedChildren=function(r,n,i,a){for(var o in this._tiles){var s=this._tiles[o];if(!(a[o]||!s.hasData()||s.tileID.overscaledZ<=n||s.tileID.overscaledZ>i)){for(var l=s.tileID;s&&s.tileID.overscaledZ>n+1;){var c=s.tileID.scaledTo(s.tileID.overscaledZ-1);(s=this._tiles[c.key])&&s.hasData()&&(l=c)}for(var u=l;u.overscaledZ>n;)if(r[(u=u.scaledTo(u.overscaledZ-1)).key]){a[l.key]=l;break}}}},i.prototype.findLoadedParent=function(r,n){if(r.key in this._loadedParentTiles){var i=this._loadedParentTiles[r.key];return i&&i.tileID.overscaledZ>=n?i:null}for(var a=r.overscaledZ-1;a>=n;a--){var o=r.scaledTo(a),s=this._getLoadedTile(o);if(s)return s}},i.prototype._getLoadedTile=function(r){var n=this._tiles[r.key];return n&&n.hasData()?n:this._cache.getByKey(r.wrapped().key)},i.prototype.updateCacheSize=function(r){var n=Math.floor((Math.ceil(r.width/this._source.tileSize)+1)*(Math.ceil(r.height/this._source.tileSize)+1)*5),i="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(i)},i.prototype.handleWrapJump=function(r){var n=Math.round((r-(void 0===this._prevLng?r:this._prevLng))/360);if(this._prevLng=r,n){var i={};for(var a in this._tiles){var o=this._tiles[a];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+n),i[o.tileID.key]=o}for(var s in this._tiles=i,this._timers)clearTimeout(this._timers[s]),delete this._timers[s];for(var l in this._tiles){var c=this._tiles[l];this._setTileReloadTimer(l,c)}}},i.prototype.update=function(n){var a=this;if(this.transform=n,this._sourceLoaded&&!this._paused){this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?o=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(n){return new r.OverscaledTileID(n.canonical.z,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y)}):(o=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(o=o.filter(function(r){return a._source.hasTile(r)}))):o=[];var o,s=n.coveringZoomLevel(this._source),l=Math.max(s-i.maxOverzooming,this._source.minzoom),c=Math.max(s+i.maxUnderzooming,this._source.minzoom),u=this._updateRetainedTiles(o,s);if(tE(this._source.type)){for(var f={},h={},p=0,d=Object.keys(u);p<d.length;p+=1){var m=d[p],g=u[m],v=this._tiles[m];if(v&&!(v.fadeEndTime&&v.fadeEndTime<=r.browser.now())){var y=this.findLoadedParent(g,l);y&&(this._addTile(y.tileID),f[y.tileID.key]=y.tileID),h[m]=g}}for(var x in this._retainLoadedChildren(h,s,c,u),f)u[x]||(this._coveredTiles[x]=!0,u[x]=f[x])}for(var b in u)this._tiles[b].clearFadeHold();for(var _=0,w=r.keysDifference(this._tiles,u);_<w.length;_+=1){var T=w[_],k=this._tiles[T];k.hasSymbolBuckets&&!k.holdingForFade()?k.setHoldDuration(this.map._fadeDuration):k.hasSymbolBuckets&&!k.symbolFadeFinished()||this._removeTile(T)}this._updateLoadedParentTileCache()}},i.prototype.releaseSymbolFadeTiles=function(){for(var r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)},i.prototype._updateRetainedTiles=function(r,n){for(var a={},o={},s=Math.max(n-i.maxOverzooming,this._source.minzoom),l=Math.max(n+i.maxUnderzooming,this._source.minzoom),c={},u=0;u<r.length;u+=1){var f=r[u],h=this._addTile(f);a[f.key]=f,h.hasData()||n<this._source.maxzoom&&(c[f.key]=f)}this._retainLoadedChildren(c,n,l,a);for(var p=0;p<r.length;p+=1){var d=r[p],m=this._tiles[d.key];if(!m.hasData()){if(n+1>this._source.maxzoom){var g=d.children(this._source.maxzoom)[0],v=this.getTile(g);if(v&&v.hasData()){a[g.key]=g;continue}}else{var y=d.children(this._source.maxzoom);if(a[y[0].key]&&a[y[1].key]&&a[y[2].key]&&a[y[3].key])continue}for(var x=m.wasRequested(),b=d.overscaledZ-1;b>=s;--b){var _=d.scaledTo(b);if(o[_.key]||(o[_.key]=!0,(m=this.getTile(_))||!x||(m=this._addTile(_)),m&&(a[_.key]=_,x=m.wasRequested(),m.hasData())))break}}}return a},i.prototype._updateLoadedParentTileCache=function(){for(var r in this._loadedParentTiles={},this._tiles){for(var n=[],i=void 0,a=this._tiles[r].tileID;a.overscaledZ>0;){if(a.key in this._loadedParentTiles){i=this._loadedParentTiles[a.key];break}n.push(a.key);var o=a.scaledTo(a.overscaledZ-1);if(i=this._getLoadedTile(o))break;a=o}for(var s=0;s<n.length;s+=1){var l=n[s];this._loadedParentTiles[l]=i}}},i.prototype._addTile=function(n){var i=this._tiles[n.key];if(i)return i;(i=this._cache.getAndRemove(n))&&(this._setTileReloadTimer(n.key,i),i.tileID=n,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,i)));var a=!!i;return a||(i=new r.Tile(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(i,this._tileLoaded.bind(this,i,n.key,i.state))),i?(i.uses++,this._tiles[n.key]=i,a||this._source.fire(new r.Event("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null},i.prototype._setTileReloadTimer=function(r,n){var i=this;r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);var a=n.getExpiryTimeout();a&&(this._timers[r]=setTimeout(function(){i._reloadTile(r,"expired"),delete i._timers[r]},a))},i.prototype._removeTile=function(r){var n=this._tiles[r];n&&(n.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),n.uses>0||(n.hasData()&&"reloading"!==n.state?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))},i.prototype.clearTiles=function(){for(var r in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(r);this._cache.reset()},i.prototype.tilesIn=function(n,i,a){var o=this,s=[],l=this.transform;if(!l)return s;for(var c=a?l.getCameraQueryGeometry(n):n,u=n.map(function(r){return l.pointCoordinate(r)}),f=c.map(function(r){return l.pointCoordinate(r)}),h=this.getIds(),p=1/0,d=1/0,m=-1/0,g=-1/0,v=0;v<f.length;v+=1){var y=f[v];p=Math.min(p,y.x),d=Math.min(d,y.y),m=Math.max(m,y.x),g=Math.max(g,y.y)}for(var x=0;x<h.length;x++)(function(n){var a=o._tiles[h[n]];if(!a.holdingForFade()){var c=a.tileID,v=Math.pow(2,l.zoom-a.tileID.overscaledZ),y=i*a.queryPadding*r.EXTENT/a.tileSize/v,x=[c.getTilePoint(new r.MercatorCoordinate(p,d)),c.getTilePoint(new r.MercatorCoordinate(m,g))];if(x[0].x-y<r.EXTENT&&x[0].y-y<r.EXTENT&&x[1].x+y>=0&&x[1].y+y>=0){var b=u.map(function(r){return c.getTilePoint(r)}),_=f.map(function(r){return c.getTilePoint(r)});s.push({tile:a,tileID:c,queryGeometry:b,cameraQueryGeometry:_,scale:v})}}})(x);return s},i.prototype.getVisibleCoordinates=function(r){for(var n=this,i=this.getRenderableIds(r).map(function(r){return n._tiles[r].tileID}),a=0;a<i.length;a+=1){var o=i[a];o.posMatrix=this.transform.calculatePosMatrix(o.toUnwrapped())}return i},i.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(tE(this._source.type))for(var n in this._tiles){var i=this._tiles[n];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=r.browser.now())return!0}return!1},i.prototype.setFeatureState=function(r,n,i){r=r||"_geojsonTileLayer",this._state.updateState(r,n,i)},i.prototype.removeFeatureState=function(r,n,i){r=r||"_geojsonTileLayer",this._state.removeFeatureState(r,n,i)},i.prototype.getFeatureState=function(r,n){return r=r||"_geojsonTileLayer",this._state.getState(r,n)},i.prototype.setDependencies=function(r,n,i){var a=this._tiles[r];a&&a.setDependencies(n,i)},i.prototype.reloadTilesForDependencies=function(r,n){for(var i in this._tiles)this._tiles[i].hasDependency(r,n)&&this._reloadTile(i,"reloading");this._cache.filter(function(i){return!i.hasDependency(r,n)})},i}(r.Evented);function tS(r,n){var i=Math.abs(2*r.wrap)-+(r.wrap<0),a=Math.abs(2*n.wrap)-+(n.wrap<0);return r.overscaledZ-n.overscaledZ||a-i||n.canonical.y-r.canonical.y||n.canonical.x-r.canonical.x}function tE(r){return"raster"===r||"image"===r||"video"===r}function tL(){return new r.window.Worker(nf.workerUrl)}tM.maxOverzooming=10,tM.maxUnderzooming=3;var tC="mapboxgl_preloaded_worker_pool",tP=function(){this.active={}};tP.prototype.acquire=function(r){if(!this.workers)for(this.workers=[];this.workers.length<tP.workerCount;)this.workers.push(new tL);return this.active[r]=!0,this.workers.slice()},tP.prototype.release=function(r){delete this.active[r],0===this.numActive()&&(this.workers.forEach(function(r){r.terminate()}),this.workers=null)},tP.prototype.isPreloaded=function(){return!!this.active[tC]},tP.prototype.numActive=function(){return Object.keys(this.active).length};var tI,tO=Math.floor(r.browser.hardwareConcurrency/2);function tz(){return tI||(tI=new tP),tI}function tD(n){n=n.slice();for(var i=Object.create(null),a=0;a<n.length;a++)i[n[a].id]=n[a];for(var o=0;o<n.length;o++)"ref"in n[o]&&(n[o]=function(n,i){var a={};for(var o in n)"ref"!==o&&(a[o]=n[o]);return r.refProperties.forEach(function(r){r in i&&(a[r]=i[r])}),a}(n[o],i[n[o].ref]));return n}tP.workerCount=Math.max(Math.min(tO,6),1);var tR={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function tF(r,n,i){i.push({command:tR.addSource,args:[r,n[r]]})}function tB(r,n,i){n.push({command:tR.removeSource,args:[r]}),i[r]=!0}function tN(n,i,a,o,s,l){var c;for(c in i=i||{},n=n||{})n.hasOwnProperty(c)&&(r.deepEqual(n[c],i[c])||a.push({command:l,args:[o,c,i[c],s]}));for(c in i)i.hasOwnProperty(c)&&!n.hasOwnProperty(c)&&(r.deepEqual(n[c],i[c])||a.push({command:l,args:[o,c,i[c],s]}))}function tj(r){return r.id}function tU(r,n){return r[n.id]=n,r}var tV=function(r,n){this.reset(r,n)};tV.prototype.reset=function(r,n){this.points=r||[],this._distances=[0];for(var i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding},tV.prototype.lerp=function(n){if(1===this.points.length)return this.points[0];n=r.clamp(n,0,1);for(var i=1,a=this._distances[i],o=n*this.paddedLength+this.padding;a<o&&i<this._distances.length;)a=this._distances[++i];var s=i-1,l=this._distances[s],c=a-l,u=c>0?(o-l)/c:0;return this.points[s].mult(1-u).add(this.points[i].mult(u))};var tH=function(r,n,i){var a=this.boxCells=[],o=this.circleCells=[];this.xCellCount=Math.ceil(r/i),this.yCellCount=Math.ceil(n/i);for(var s=0;s<this.xCellCount*this.yCellCount;s++)a.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=n,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0};function tq(n,i,a,o,s){var l=r.create();return i?(r.scale(l,l,[1/s,1/s,1]),a||r.rotateZ(l,l,o.angle)):r.multiply(l,o.labelPlaneMatrix,n),l}function tG(n,i,a,o,s){if(i){var l=r.clone(n);return r.scale(l,l,[s,s,1]),a||r.rotateZ(l,l,-o.angle),l}return o.glCoordMatrix}function tY(n,i){var a=[n.x,n.y,0,1];t1(a,a,i);var o=a[3];return{point:new r.Point(a[0]/o,a[1]/o),signedDistanceFromCamera:o}}function tW(r,n){return .5+r/n*.5}function tX(r,n,i,a,o,s,l,c,u,f,h){var p=c.glyphStartIndex+c.numGlyphs,d=c.lineStartIndex,m=c.lineStartIndex+c.lineLength,g=n.getoffsetX(c.glyphStartIndex),v=n.getoffsetX(p-1),y=tQ(r*g,i,a,o,s,l,c.segment,d,m,u,f,h);if(!y)return null;var x=tQ(r*v,i,a,o,s,l,c.segment,d,m,u,f,h);return x?{first:y,last:x}:null}function tZ(n,i,a,o){return n===r.WritingMode.horizontal&&Math.abs(a.y-i.y)>Math.abs(a.x-i.x)*o?{useVertical:!0}:(n===r.WritingMode.vertical?i.y<a.y:i.x>a.x)?{needsFlipping:!0}:null}function tJ(n,i,a,o,s,l,c,u,f,h,p,d,m,g){var v,y=i/24,x=n.lineOffsetX*y,b=n.lineOffsetY*y;if(n.numGlyphs>1){var _=n.glyphStartIndex+n.numGlyphs,w=n.lineStartIndex,T=n.lineStartIndex+n.lineLength,k=tX(y,u,x,b,a,p,d,n,f,l,m);if(!k)return{notEnoughRoom:!0};var A=tY(k.first.point,c).point,M=tY(k.last.point,c).point;if(o&&!a){var S=tZ(n.writingMode,A,M,g);if(S)return S}v=[k.first];for(var E=n.glyphStartIndex+1;E<_-1;E++)v.push(tQ(y*u.getoffsetX(E),x,b,a,p,d,n.segment,w,T,f,l,m));v.push(k.last)}else{if(o&&!a){var L=tY(d,s).point,C=n.lineStartIndex+n.segment+1,P=new r.Point(f.getx(C),f.gety(C)),I=tY(P,s),O=I.signedDistanceFromCamera>0?I.point:tK(d,P,L,1,s),z=tZ(n.writingMode,L,O,g);if(z)return z}var D=tQ(y*u.getoffsetX(n.glyphStartIndex),x,b,a,p,d,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,f,l,m);if(!D)return{notEnoughRoom:!0};v=[D]}for(var R=0,F=v;R<F.length;R+=1){var B=F[R];r.addDynamicAttributes(h,B.point,B.angle)}return{}}function tK(r,n,i,a,o){var s=tY(r.add(r.sub(n)._unit()),o).point,l=i.sub(s);return i.add(l._mult(a/l.mag()))}function tQ(n,i,a,o,s,l,c,u,f,h,p,d){var m=o?n-i:n+i,g=m>0?1:-1,v=0;o&&(g*=-1,v=Math.PI),g<0&&(v+=Math.PI);for(var y=g>0?u+c:u+c+1,x=s,b=s,_=0,w=0,T=Math.abs(m),k=[];_+w<=T;){if((y+=g)<u||y>=f)return null;if(b=x,k.push(x),void 0===(x=d[y])){var A=new r.Point(h.getx(y),h.gety(y)),M=tY(A,p);if(M.signedDistanceFromCamera>0)x=d[y]=M.point;else{var S=y-g;x=tK(0===_?l:new r.Point(h.getx(S),h.gety(S)),A,b,T-_+1,p)}}_+=w,w=b.dist(x)}var E=(T-_)/w,L=x.sub(b),C=L.mult(E)._add(b);C._add(L._unit()._perp()._mult(a*g));var P=v+Math.atan2(x.y-b.y,x.x-b.x);return k.push(C),{point:C,angle:P,path:k}}tH.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},tH.prototype.insert=function(r,n,i,a,o){this._forEachCell(n,i,a,o,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(o)},tH.prototype.insertCircle=function(r,n,i,a){this._forEachCell(n-a,i-a,n+a,i+a,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(n),this.circles.push(i),this.circles.push(a)},tH.prototype._insertBoxCell=function(r,n,i,a,o,s){this.boxCells[o].push(s)},tH.prototype._insertCircleCell=function(r,n,i,a,o,s){this.circleCells[o].push(s)},tH.prototype._query=function(r,n,i,a,o,s){if(i<0||r>this.width||a<0||n>this.height)return!o&&[];var l=[];if(r<=0&&n<=0&&this.width<=i&&this.height<=a){if(o)return!0;for(var c=0;c<this.boxKeys.length;c++)l.push({key:this.boxKeys[c],x1:this.bboxes[4*c],y1:this.bboxes[4*c+1],x2:this.bboxes[4*c+2],y2:this.bboxes[4*c+3]});for(var u=0;u<this.circleKeys.length;u++){var f=this.circles[3*u],h=this.circles[3*u+1],p=this.circles[3*u+2];l.push({key:this.circleKeys[u],x1:f-p,y1:h-p,x2:f+p,y2:h+p})}return s?l.filter(s):l}return this._forEachCell(r,n,i,a,this._queryCell,l,{hitTest:o,seenUids:{box:{},circle:{}}},s),o?l.length>0:l},tH.prototype._queryCircle=function(r,n,i,a,o){var s=r-i,l=r+i,c=n-i,u=n+i;if(l<0||s>this.width||u<0||c>this.height)return!a&&[];var f=[];return this._forEachCell(s,c,l,u,this._queryCellCircle,f,{hitTest:a,circle:{x:r,y:n,radius:i},seenUids:{box:{},circle:{}}},o),a?f.length>0:f},tH.prototype.query=function(r,n,i,a,o){return this._query(r,n,i,a,!1,o)},tH.prototype.hitTest=function(r,n,i,a,o){return this._query(r,n,i,a,!0,o)},tH.prototype.hitTestCircle=function(r,n,i,a){return this._queryCircle(r,n,i,!0,a)},tH.prototype._queryCell=function(r,n,i,a,o,s,l,c){var u=l.seenUids,f=this.boxCells[o];if(null!==f)for(var h=this.bboxes,p=0;p<f.length;p+=1){var d=f[p];if(!u.box[d]){u.box[d]=!0;var m=4*d;if(r<=h[m+2]&&n<=h[m+3]&&i>=h[m+0]&&a>=h[m+1]&&(!c||c(this.boxKeys[d]))){if(l.hitTest)return s.push(!0),!0;s.push({key:this.boxKeys[d],x1:h[m],y1:h[m+1],x2:h[m+2],y2:h[m+3]})}}}var g=this.circleCells[o];if(null!==g)for(var v=this.circles,y=0;y<g.length;y+=1){var x=g[y];if(!u.circle[x]){u.circle[x]=!0;var b=3*x;if(this._circleAndRectCollide(v[b],v[b+1],v[b+2],r,n,i,a)&&(!c||c(this.circleKeys[x]))){if(l.hitTest)return s.push(!0),!0;var _=v[b],w=v[b+1],T=v[b+2];s.push({key:this.circleKeys[x],x1:_-T,y1:w-T,x2:_+T,y2:w+T})}}}},tH.prototype._queryCellCircle=function(r,n,i,a,o,s,l,c){var u=l.circle,f=l.seenUids,h=this.boxCells[o];if(null!==h)for(var p=this.bboxes,d=0;d<h.length;d+=1){var m=h[d];if(!f.box[m]){f.box[m]=!0;var g=4*m;if(this._circleAndRectCollide(u.x,u.y,u.radius,p[g+0],p[g+1],p[g+2],p[g+3])&&(!c||c(this.boxKeys[m])))return s.push(!0),!0}}var v=this.circleCells[o];if(null!==v)for(var y=this.circles,x=0;x<v.length;x+=1){var b=v[x];if(!f.circle[b]){f.circle[b]=!0;var _=3*b;if(this._circlesCollide(y[_],y[_+1],y[_+2],u.x,u.y,u.radius)&&(!c||c(this.circleKeys[b])))return s.push(!0),!0}}},tH.prototype._forEachCell=function(r,n,i,a,o,s,l,c){for(var u=this._convertToXCellCoord(r),f=this._convertToYCellCoord(n),h=this._convertToXCellCoord(i),p=this._convertToYCellCoord(a),d=u;d<=h;d++)for(var m=f;m<=p;m++){var g=this.xCellCount*m+d;if(o.call(this,r,n,i,a,g,s,l,c))return}},tH.prototype._convertToXCellCoord=function(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))},tH.prototype._convertToYCellCoord=function(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))},tH.prototype._circlesCollide=function(r,n,i,a,o,s){var l=a-r,c=o-n,u=i+s;return u*u>l*l+c*c},tH.prototype._circleAndRectCollide=function(r,n,i,a,o,s,l){var c=(s-a)/2,u=Math.abs(r-(a+c));if(u>c+i)return!1;var f=(l-o)/2,h=Math.abs(n-(o+f));if(h>f+i)return!1;if(u<=c||h<=f)return!0;var p=u-c,d=h-f;return p*p+d*d<=i*i};var t$=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function t0(r,n){for(var i=0;i<r;i++){var a=n.length;n.resize(a+4),n.float32.set(t$,3*a)}}function t1(r,n,i){var a=n[0],o=n[1];return r[0]=i[0]*a+i[4]*o+i[12],r[1]=i[1]*a+i[5]*o+i[13],r[3]=i[3]*a+i[7]*o+i[15],r}var t2=function(r,n,i){void 0===n&&(n=new tH(r.width+200,r.height+200,25)),void 0===i&&(i=new tH(r.width+200,r.height+200,25)),this.transform=r,this.grid=n,this.ignoredGrid=i,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+100,this.screenBottomBoundary=r.height+100,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200};function t3(n,i,a){return r.EXTENT/(n.tileSize*Math.pow(2,a-n.tileID.overscaledZ))*i}t2.prototype.placeCollisionBox=function(r,n,i,a,o){var s=this.projectAndGetPerspectiveRatio(a,r.anchorPointX,r.anchorPointY),l=i*s.perspectiveRatio,c=r.x1*l+s.point.x,u=r.y1*l+s.point.y,f=r.x2*l+s.point.x,h=r.y2*l+s.point.y;return!this.isInsideGrid(c,u,f,h)||!n&&this.grid.hitTest(c,u,f,h,o)?{box:[],offscreen:!1}:{box:[c,u,f,h],offscreen:this.isOffscreen(c,u,f,h)}},t2.prototype.placeCollisionCircles=function(n,i,a,o,s,l,c,u,f,h,p,d,m){var g=[],v=new r.Point(i.anchorX,i.anchorY),y=tY(v,l),x=tW(this.transform.cameraToCenterDistance,y.signedDistanceFromCamera),b=(h?s/x:s*x)/r.ONE_EM,_=tY(v,c).point,w=tX(b,o,i.lineOffsetX*b,i.lineOffsetY*b,!1,_,v,i,a,c,{}),T=!1,k=!1,A=!0;if(w){for(var M=.5*d*x+m,S=new r.Point(-100,-100),E=new r.Point(this.screenRightBoundary,this.screenBottomBoundary),L=new tV,C=w.first,P=w.last,I=[],O=C.path.length-1;O>=1;O--)I.push(C.path[O]);for(var z=1;z<P.path.length;z++)I.push(P.path[z]);var D=2.5*M;if(u){var R=I.map(function(r){return tY(r,u)});I=R.some(function(r){return r.signedDistanceFromCamera<=0})?[]:R.map(function(r){return r.point})}var F=[];if(I.length>0){for(var B=I[0].clone(),N=I[0].clone(),j=1;j<I.length;j++)B.x=Math.min(B.x,I[j].x),B.y=Math.min(B.y,I[j].y),N.x=Math.max(N.x,I[j].x),N.y=Math.max(N.y,I[j].y);F=B.x>=S.x&&N.x<=E.x&&B.y>=S.y&&N.y<=E.y?[I]:N.x<S.x||B.x>E.x||N.y<S.y||B.y>E.y?[]:r.clipLine([I],S.x,S.y,E.x,E.y)}for(var U=0,V=F;U<V.length;U+=1){var H=V[U];L.reset(H,.25*M);var q=0;q=L.length<=.5*M?1:Math.ceil(L.paddedLength/D)+1;for(var G=0;G<q;G++){var Y=G/Math.max(q-1,1),W=L.lerp(Y),X=W.x+100,Z=W.y+100;g.push(X,Z,M,0);var J=X-M,K=Z-M,Q=X+M,$=Z+M;if(A=A&&this.isOffscreen(J,K,Q,$),k=k||this.isInsideGrid(J,K,Q,$),!n&&this.grid.hitTestCircle(X,Z,M,p)&&(T=!0,!f))return{circles:[],offscreen:!1,collisionDetected:T}}}}return{circles:(f||!T)&&k?g:[],offscreen:A,collisionDetected:T}},t2.prototype.queryRenderedSymbols=function(n){if(0===n.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var i=[],a=1/0,o=1/0,s=-1/0,l=-1/0,c=0;c<n.length;c+=1){var u=n[c],f=new r.Point(u.x+100,u.y+100);a=Math.min(a,f.x),o=Math.min(o,f.y),s=Math.max(s,f.x),l=Math.max(l,f.y),i.push(f)}for(var h={},p={},d=0,m=this.grid.query(a,o,s,l).concat(this.ignoredGrid.query(a,o,s,l));d<m.length;d+=1){var g=m[d],v=g.key;if(void 0===h[v.bucketInstanceId]&&(h[v.bucketInstanceId]={}),!h[v.bucketInstanceId][v.featureIndex]){var y=[new r.Point(g.x1,g.y1),new r.Point(g.x2,g.y1),new r.Point(g.x2,g.y2),new r.Point(g.x1,g.y2)];r.polygonIntersectsPolygon(i,y)&&(h[v.bucketInstanceId][v.featureIndex]=!0,void 0===p[v.bucketInstanceId]&&(p[v.bucketInstanceId]=[]),p[v.bucketInstanceId].push(v.featureIndex))}}return p},t2.prototype.insertCollisionBox=function(r,n,i,a,o){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:a,collisionGroupID:o},r[0],r[1],r[2],r[3])},t2.prototype.insertCollisionCircles=function(r,n,i,a,o){for(var s=n?this.ignoredGrid:this.grid,l={bucketInstanceId:i,featureIndex:a,collisionGroupID:o},c=0;c<r.length;c+=4)s.insertCircle(l,r[c],r[c+1],r[c+2])},t2.prototype.projectAndGetPerspectiveRatio=function(n,i,a){var o=[i,a,0,1];return t1(o,o,n),{point:new r.Point((o[0]/o[3]+1)/2*this.transform.width+100,(-o[1]/o[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/o[3]*.5}},t2.prototype.isOffscreen=function(r,n,i,a){return i<100||r>=this.screenRightBoundary||a<100||n>this.screenBottomBoundary},t2.prototype.isInsideGrid=function(r,n,i,a){return i>=0&&r<this.gridRightBoundary&&a>=0&&n<this.gridBottomBoundary},t2.prototype.getViewportMatrix=function(){var n=r.identity([]);return r.translate(n,n,[-100,-100,0]),n};var t5=function(r,n,i,a){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?n:-n))):a&&i?1:0,this.placed=i};t5.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var t4=function(r,n,i,a,o){this.text=new t5(r?r.text:null,n,i,o),this.icon=new t5(r?r.icon:null,n,a,o)};t4.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var t6=function(r,n,i){this.text=r,this.icon=n,this.skipFade=i},t8=function(){this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.circles=[]},t9=function(r,n,i,a,o){this.bucketInstanceId=r,this.featureIndex=n,this.sourceLayerIndex=i,this.bucketIndex=a,this.tileID=o},t7=function(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}};function et(n,i,a,o,s){var l=r.getAnchorAlignment(n),c=-(l.horizontalAlign-.5)*i,u=-(l.verticalAlign-.5)*a,f=r.evaluateVariableOffset(n,o);return new r.Point(c+f[0]*s,u+f[1]*s)}function ee(n,i,a,o,s,l){var c=n.x1,u=n.x2,f=n.y1,h=n.y2,p=n.anchorPointX,d=n.anchorPointY,m=new r.Point(i,a);return o&&m._rotate(s?l:-l),{x1:c+m.x,y1:f+m.y,x2:u+m.x,y2:h+m.y,anchorPointX:p,anchorPointY:d}}t7.prototype.get=function(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){var n=++this.maxGroupID;this.collisionGroups[r]={ID:n,predicate:function(r){return r.collisionGroupID===n}}}return this.collisionGroups[r]};var er=function(r,n,i,a){this.transform=r.clone(),this.collisionIndex=new t2(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=n,this.retainedQueryData={},this.collisionGroups=new t7(i),this.collisionCircleArrays={},this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}};function en(r,n,i,a,o){r.emplaceBack(n?1:0,i?1:0,a||0,o||0),r.emplaceBack(n?1:0,i?1:0,a||0,o||0),r.emplaceBack(n?1:0,i?1:0,a||0,o||0),r.emplaceBack(n?1:0,i?1:0,a||0,o||0)}function ei(r){if(0===r.opacity&&!r.placed)return 0;if(1===r.opacity&&r.placed)return 4294967295;var n=r.placed?1:0,i=Math.floor(127*r.opacity);return 33554432*i+16777216*n+131072*i+65536*n+512*i+256*n+2*i+n}er.prototype.getBucketParts=function(n,i,a,o){var s=a.getBucket(i),l=a.latestFeatureIndex;if(s&&l&&i.id===s.layerIds[0]){var c=a.collisionBoxArray,u=s.layers[0].layout,f=Math.pow(2,this.transform.zoom-a.tileID.overscaledZ),h=a.tileSize/r.EXTENT,p=this.transform.calculatePosMatrix(a.tileID.toUnwrapped()),d="map"===u.get("text-pitch-alignment"),m="map"===u.get("text-rotation-alignment"),g=t3(a,1,this.transform.zoom),v=tq(p,d,m,this.transform,g),y=null;if(d){var x=tG(p,d,m,this.transform,g);y=r.multiply([],this.transform.labelPlaneMatrix,x)}this.retainedQueryData[s.bucketInstanceId]=new t9(s.bucketInstanceId,l,s.sourceLayerIndex,s.index,a.tileID);var b={bucket:s,layout:u,posMatrix:p,textLabelPlaneMatrix:v,labelToScreenMatrix:y,scale:f,textPixelRatio:h,holdingForFade:a.holdingForFade(),collisionBoxArray:c,partiallyEvaluatedTextSize:r.evaluateSizeForZoom(s.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(s.sourceID)};if(o)for(var _=0,w=s.sortKeyRanges;_<w.length;_+=1){var T=w[_],k=T.sortKey,A=T.symbolInstanceStart,M=T.symbolInstanceEnd;n.push({sortKey:k,symbolInstanceStart:A,symbolInstanceEnd:M,parameters:b})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:s.symbolInstances.length,parameters:b})}},er.prototype.attemptAnchorPlacement=function(r,n,i,a,o,s,l,c,u,f,h,p,d,m,g){var v,y=[p.textOffset0,p.textOffset1],x=et(r,i,a,y,o),b=this.collisionIndex.placeCollisionBox(ee(n,x.x,x.y,s,l,this.transform.angle),h,c,u,f.predicate);if((!g||0!==this.collisionIndex.placeCollisionBox(ee(g,x.x,x.y,s,l,this.transform.angle),h,c,u,f.predicate).box.length)&&b.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(v=this.prevPlacement.variableOffsets[p.crossTileID].anchor),this.variableOffsets[p.crossTileID]={textOffset:y,width:i,height:a,anchor:r,textBoxScale:o,prevAnchor:v},this.markUsedJustification(d,r,p,m),d.allowVerticalPlacement&&(this.markUsedOrientation(d,m,p),this.placedOrientations[p.crossTileID]=m),{shift:x,placedGlyphBoxes:b}},er.prototype.placeLayerBucketPart=function(n,i,a){var o=this,s=n.parameters,l=s.bucket,c=s.layout,u=s.posMatrix,f=s.textLabelPlaneMatrix,h=s.labelToScreenMatrix,p=s.textPixelRatio,d=s.holdingForFade,m=s.collisionBoxArray,g=s.partiallyEvaluatedTextSize,v=s.collisionGroup,y=c.get("text-optional"),x=c.get("icon-optional"),b=c.get("text-allow-overlap"),_=c.get("icon-allow-overlap"),w="map"===c.get("text-rotation-alignment"),T="map"===c.get("text-pitch-alignment"),k="none"!==c.get("icon-text-fit"),A="viewport-y"===c.get("symbol-z-order"),M=b&&(_||!l.hasIconData()||x),S=_&&(b||!l.hasTextData()||y);!l.collisionArrays&&m&&l.deserializeCollisionBoxes(m);var E=function(n,s){if(!i[n.crossTileID]){if(d)o.placements[n.crossTileID]=new t6(!1,!1,!1);else{var m,A=!1,E=!1,L=!0,C=null,P={box:null,offscreen:null},I={box:null,offscreen:null},O=null,z=null,D=0,R=0,F=0;s.textFeatureIndex?D=s.textFeatureIndex:n.useRuntimeCollisionCircles&&(D=n.featureIndex),s.verticalTextFeatureIndex&&(R=s.verticalTextFeatureIndex);var B=s.textBox;if(B){var N=function(i){var a=r.WritingMode.horizontal;if(l.allowVerticalPlacement&&!i&&o.prevPlacement){var s=o.prevPlacement.placedOrientations[n.crossTileID];s&&(o.placedOrientations[n.crossTileID]=s,a=s,o.markUsedOrientation(l,a,n))}return a},j=function(i,a){if(l.allowVerticalPlacement&&n.numVerticalGlyphVertices>0&&s.verticalTextBox)for(var o=0,c=l.writingModes;o<c.length&&(c[o]===r.WritingMode.vertical?I=P=a():P=i(),!P||!P.box||!P.box.length);o+=1);else P=i()};if(c.get("text-variable-anchor")){var U=c.get("text-variable-anchor");if(o.prevPlacement&&o.prevPlacement.variableOffsets[n.crossTileID]){var V=o.prevPlacement.variableOffsets[n.crossTileID];U.indexOf(V.anchor)>0&&(U=U.filter(function(r){return r!==V.anchor})).unshift(V.anchor)}var H=function(r,i,a){for(var s=r.x2-r.x1,c=r.y2-r.y1,f=n.textBoxScale,h=k&&!_?i:null,d={box:[],offscreen:!1},m=b?2*U.length:U.length,g=0;g<m;++g){var y=U[g%U.length],x=g>=U.length,M=o.attemptAnchorPlacement(y,r,s,c,f,w,T,p,u,v,x,n,l,a,h);if(M&&(d=M.placedGlyphBoxes)&&d.box&&d.box.length){A=!0,C=M.shift;break}}return d};j(function(){return H(B,s.iconBox,r.WritingMode.horizontal)},function(){var i=s.verticalTextBox,a=P&&P.box&&P.box.length;return l.allowVerticalPlacement&&!a&&n.numVerticalGlyphVertices>0&&i?H(i,s.verticalIconBox,r.WritingMode.vertical):{box:null,offscreen:null}}),P&&(A=P.box,L=P.offscreen);var q=N(P&&P.box);if(!A&&o.prevPlacement){var G=o.prevPlacement.variableOffsets[n.crossTileID];G&&(o.variableOffsets[n.crossTileID]=G,o.markUsedJustification(l,G.anchor,n,q))}}else{var Y=function(r,i){var a=o.collisionIndex.placeCollisionBox(r,b,p,u,v.predicate);return a&&a.box&&a.box.length&&(o.markUsedOrientation(l,i,n),o.placedOrientations[n.crossTileID]=i),a};j(function(){return Y(B,r.WritingMode.horizontal)},function(){var i=s.verticalTextBox;return l.allowVerticalPlacement&&n.numVerticalGlyphVertices>0&&i?Y(i,r.WritingMode.vertical):{box:null,offscreen:null}}),N(P&&P.box&&P.box.length)}}if(A=(m=P)&&m.box&&m.box.length>0,L=m&&m.offscreen,n.useRuntimeCollisionCircles){var W=l.text.placedSymbolArray.get(n.centerJustifiedTextSymbolIndex),X=r.evaluateSizeForFeature(l.textSizeData,g,W),Z=c.get("text-padding"),J=n.collisionCircleDiameter;O=o.collisionIndex.placeCollisionCircles(b,W,l.lineVertexArray,l.glyphOffsetArray,X,u,f,h,a,T,v.predicate,J,Z),A=b||O.circles.length>0&&!O.collisionDetected,L=L&&O.offscreen}if(s.iconFeatureIndex&&(F=s.iconFeatureIndex),s.iconBox){var K=function(r){var n=k&&C?ee(r,C.x,C.y,w,T,o.transform.angle):r;return o.collisionIndex.placeCollisionBox(n,_,p,u,v.predicate)};E=I&&I.box&&I.box.length&&s.verticalIconBox?(z=K(s.verticalIconBox)).box.length>0:(z=K(s.iconBox)).box.length>0,L=L&&z.offscreen}var Q=y||0===n.numHorizontalGlyphVertices&&0===n.numVerticalGlyphVertices,$=x||0===n.numIconVertices;if(Q||$?$?Q||(E=E&&A):A=E&&A:E=A=E&&A,A&&m&&m.box&&(I&&I.box&&R?o.collisionIndex.insertCollisionBox(m.box,c.get("text-ignore-placement"),l.bucketInstanceId,R,v.ID):o.collisionIndex.insertCollisionBox(m.box,c.get("text-ignore-placement"),l.bucketInstanceId,D,v.ID)),E&&z&&o.collisionIndex.insertCollisionBox(z.box,c.get("icon-ignore-placement"),l.bucketInstanceId,F,v.ID),O&&(A&&o.collisionIndex.insertCollisionCircles(O.circles,c.get("text-ignore-placement"),l.bucketInstanceId,D,v.ID),a)){var tt=l.bucketInstanceId,te=o.collisionCircleArrays[tt];void 0===te&&(te=o.collisionCircleArrays[tt]=new t8);for(var tr=0;tr<O.circles.length;tr+=4)te.circles.push(O.circles[tr+0]),te.circles.push(O.circles[tr+1]),te.circles.push(O.circles[tr+2]),te.circles.push(O.collisionDetected?1:0)}o.placements[n.crossTileID]=new t6(A||M,E||S,L||l.justReloaded),i[n.crossTileID]=!0}}};if(A)for(var L=l.getSortedSymbolIndexes(this.transform.angle),C=L.length-1;C>=0;--C){var P=L[C];E(l.symbolInstances.get(P),l.collisionArrays[P])}else for(var I=n.symbolInstanceStart;I<n.symbolInstanceEnd;I++)E(l.symbolInstances.get(I),l.collisionArrays[I]);if(a&&l.bucketInstanceId in this.collisionCircleArrays){var O=this.collisionCircleArrays[l.bucketInstanceId];r.invert(O.invProjMatrix,u),O.viewportMatrix=this.collisionIndex.getViewportMatrix()}l.justReloaded=!1},er.prototype.markUsedJustification=function(n,i,a,o){var s,l={left:a.leftJustifiedTextSymbolIndex,center:a.centerJustifiedTextSymbolIndex,right:a.rightJustifiedTextSymbolIndex};s=o===r.WritingMode.vertical?a.verticalPlacedTextSymbolIndex:l[r.getAnchorJustification(i)];for(var c=0,u=[a.leftJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.rightJustifiedTextSymbolIndex,a.verticalPlacedTextSymbolIndex];c<u.length;c+=1){var f=u[c];f>=0&&(n.text.placedSymbolArray.get(f).crossTileID=s>=0&&f!==s?0:a.crossTileID)}},er.prototype.markUsedOrientation=function(n,i,a){for(var o=i===r.WritingMode.horizontal||i===r.WritingMode.horizontalOnly?i:0,s=i===r.WritingMode.vertical?i:0,l=0,c=[a.leftJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.rightJustifiedTextSymbolIndex];l<c.length;l+=1){var u=c[l];n.text.placedSymbolArray.get(u).placedOrientation=o}a.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).placedOrientation=s)},er.prototype.commit=function(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;var n=this.prevPlacement,i=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;var a=n?n.symbolFadeChange(r):1,o=n?n.opacities:{},s=n?n.variableOffsets:{},l=n?n.placedOrientations:{};for(var c in this.placements){var u=this.placements[c],f=o[c];f?(this.opacities[c]=new t4(f,a,u.text,u.icon),i=i||u.text!==f.text.placed||u.icon!==f.icon.placed):(this.opacities[c]=new t4(null,a,u.text,u.icon,u.skipFade),i=i||u.text||u.icon)}for(var h in o){var p=o[h];if(!this.opacities[h]){var d=new t4(p,a,!1,!1);d.isHidden()||(this.opacities[h]=d,i=i||p.text.placed||p.icon.placed)}}for(var m in s)this.variableOffsets[m]||!this.opacities[m]||this.opacities[m].isHidden()||(this.variableOffsets[m]=s[m]);for(var g in l)this.placedOrientations[g]||!this.opacities[g]||this.opacities[g].isHidden()||(this.placedOrientations[g]=l[g]);i?this.lastPlacementChangeTime=r:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:r)},er.prototype.updateLayerOpacities=function(r,n){for(var i={},a=0;a<n.length;a+=1){var o=n[a],s=o.getBucket(r);s&&o.latestFeatureIndex&&r.id===s.layerIds[0]&&this.updateBucketOpacities(s,i,o.collisionBoxArray)}},er.prototype.updateBucketOpacities=function(n,i,a){var o=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var s=n.layers[0].layout,l=new t4(null,0,!1,!1,!0),c=s.get("text-allow-overlap"),u=s.get("icon-allow-overlap"),f=s.get("text-variable-anchor"),h="map"===s.get("text-rotation-alignment"),p="map"===s.get("text-pitch-alignment"),d="none"!==s.get("icon-text-fit"),m=new t4(null,0,c&&(u||!n.hasIconData()||s.get("icon-optional")),u&&(c||!n.hasTextData()||s.get("text-optional")),!0);!n.collisionArrays&&a&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(a);for(var g=function(r,n,i){for(var a=0;a<n/4;a++)r.opacityVertexArray.emplaceBack(i)},v=0;v<n.symbolInstances.length;v++)(function(a){var s=n.symbolInstances.get(a),c=s.numHorizontalGlyphVertices,u=s.numVerticalGlyphVertices,v=s.crossTileID,y=i[v],x=o.opacities[v];y?x=l:x||(x=m,o.opacities[v]=x),i[v]=!0;var b=c>0||u>0,_=s.numIconVertices>0,w=o.placedOrientations[s.crossTileID],T=w===r.WritingMode.vertical,k=w===r.WritingMode.horizontal||w===r.WritingMode.horizontalOnly;if(b){var A=ei(x.text),M=T?ea:A;g(n.text,c,M);var S=k?ea:A;g(n.text,u,S);var E=x.text.isHidden();[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach(function(r){r>=0&&(n.text.placedSymbolArray.get(r).hidden=E||T?1:0)}),s.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(s.verticalPlacedTextSymbolIndex).hidden=E||k?1:0);var L=o.variableOffsets[s.crossTileID];L&&o.markUsedJustification(n,L.anchor,s,w);var C=o.placedOrientations[s.crossTileID];C&&(o.markUsedJustification(n,"left",s,C),o.markUsedOrientation(n,C,s))}if(_){var P=ei(x.icon),I=!(d&&s.verticalPlacedIconSymbolIndex&&T);if(s.placedIconSymbolIndex>=0){var O=I?P:ea;g(n.icon,s.numIconVertices,O),n.icon.placedSymbolArray.get(s.placedIconSymbolIndex).hidden=x.icon.isHidden()}if(s.verticalPlacedIconSymbolIndex>=0){var z=I?ea:P;g(n.icon,s.numVerticalIconVertices,z),n.icon.placedSymbolArray.get(s.verticalPlacedIconSymbolIndex).hidden=x.icon.isHidden()}}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var D=n.collisionArrays[a];if(D){var R=new r.Point(0,0);if(D.textBox||D.verticalTextBox){var F=!0;if(f){var B=o.variableOffsets[v];B?(R=et(B.anchor,B.width,B.height,B.textOffset,B.textBoxScale),h&&R._rotate(p?o.transform.angle:-o.transform.angle)):F=!1}D.textBox&&en(n.textCollisionBox.collisionVertexArray,x.text.placed,!F||T,R.x,R.y),D.verticalTextBox&&en(n.textCollisionBox.collisionVertexArray,x.text.placed,!F||k,R.x,R.y)}var N=!!(!k&&D.verticalIconBox);D.iconBox&&en(n.iconCollisionBox.collisionVertexArray,x.icon.placed,N,d?R.x:0,d?R.y:0),D.verticalIconBox&&en(n.iconCollisionBox.collisionVertexArray,x.icon.placed,!N,d?R.x:0,d?R.y:0)}}})(v);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var y=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=y.invProjMatrix,n.placementViewportMatrix=y.viewportMatrix,n.collisionCircleArray=y.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},er.prototype.symbolFadeChange=function(r){return 0===this.fadeDuration?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},er.prototype.zoomAdjustment=function(r){return Math.max(0,(this.transform.zoom-r)/1.5)},er.prototype.hasTransitions=function(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration},er.prototype.stillRecent=function(r,n){var i=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*i>r},er.prototype.setStale=function(){this.stale=!0};var ea=0,eo=function(r){this._sortAcrossTiles="viewport-y"!==r.layout.get("symbol-z-order")&&void 0!==r.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};eo.prototype.continuePlacement=function(r,n,i,a,o){for(var s=this._bucketParts;this._currentTileIndex<r.length;){var l=r[this._currentTileIndex];if(n.getBucketParts(s,a,l,this._sortAcrossTiles),this._currentTileIndex++,o())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,s.sort(function(r,n){return r.sortKey-n.sortKey}));this._currentPartIndex<s.length;){var c=s[this._currentPartIndex];if(n.placeLayerBucketPart(c,this._seenCrossTileIDs,i),this._currentPartIndex++,o())return!0}return!1};var es=function(r,n,i,a,o,s,l){this.placement=new er(r,o,s,l),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=a,this._done=!1};es.prototype.isDone=function(){return this._done},es.prototype.continuePlacement=function(n,i,a){for(var o=this,s=r.browser.now(),l=function(){var n=r.browser.now()-s;return!o._forceFullPlacement&&n>2};this._currentPlacementIndex>=0;){var c=i[n[this._currentPlacementIndex]],u=this.placement.collisionIndex.transform.zoom;if("symbol"===c.type&&(!c.minzoom||c.minzoom<=u)&&(!c.maxzoom||c.maxzoom>u)){if(this._inProgressLayer||(this._inProgressLayer=new eo(c)),this._inProgressLayer.continuePlacement(a[c.source],this.placement,this._showCollisionBoxes,c,l))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},es.prototype.commit=function(r){return this.placement.commit(r),this.placement};var el=512/r.EXTENT/2,ec=function(r,n,i){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=i;for(var a=0;a<n.length;a++){var o=n.get(a),s=o.key;this.indexedSymbolInstances[s]||(this.indexedSymbolInstances[s]=[]),this.indexedSymbolInstances[s].push({crossTileID:o.crossTileID,coord:this.getScaledCoordinates(o,r)})}};ec.prototype.getScaledCoordinates=function(n,i){var a=el/Math.pow(2,i.canonical.z-this.tileID.canonical.z);return{x:Math.floor((i.canonical.x*r.EXTENT+n.anchorX)*a),y:Math.floor((i.canonical.y*r.EXTENT+n.anchorY)*a)}},ec.prototype.findMatches=function(r,n,i){for(var a=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z),o=0;o<r.length;o++){var s=r.get(o);if(!s.crossTileID){var l=this.indexedSymbolInstances[s.key];if(l)for(var c=this.getScaledCoordinates(s,n),u=0;u<l.length;u+=1){var f=l[u];if(Math.abs(f.coord.x-c.x)<=a&&Math.abs(f.coord.y-c.y)<=a&&!i[f.crossTileID]){i[f.crossTileID]=!0,s.crossTileID=f.crossTileID;break}}}}};var eu=function(){this.maxCrossTileID=0};eu.prototype.generate=function(){return++this.maxCrossTileID};var ef=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ef.prototype.handleWrapJump=function(r){var n=Math.round((r-this.lng)/360);if(0!==n)for(var i in this.indexes){var a=this.indexes[i],o={};for(var s in a){var l=a[s];l.tileID=l.tileID.unwrapTo(l.tileID.wrap+n),o[l.tileID.key]=l}this.indexes[i]=o}this.lng=r},ef.prototype.addBucket=function(r,n,i){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(var a=0;a<n.symbolInstances.length;a++)n.symbolInstances.get(a).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});var o=this.usedCrossTileIDs[r.overscaledZ];for(var s in this.indexes){var l=this.indexes[s];if(Number(s)>r.overscaledZ)for(var c in l){var u=l[c];u.tileID.isChildOf(r)&&u.findMatches(n.symbolInstances,r,o)}else{var f=l[r.scaledTo(Number(s)).key];f&&f.findMatches(n.symbolInstances,r,o)}}for(var h=0;h<n.symbolInstances.length;h++){var p=n.symbolInstances.get(h);p.crossTileID||(p.crossTileID=i.generate(),o[p.crossTileID]=!0)}return void 0===this.indexes[r.overscaledZ]&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new ec(r,n.symbolInstances,n.bucketInstanceId),!0},ef.prototype.removeBucketCrossTileIDs=function(r,n){for(var i in n.indexedSymbolInstances)for(var a=0,o=n.indexedSymbolInstances[i];a<o.length;a+=1){var s=o[a];delete this.usedCrossTileIDs[r][s.crossTileID]}},ef.prototype.removeStaleBuckets=function(r){var n=!1;for(var i in this.indexes){var a=this.indexes[i];for(var o in a)r[a[o].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,a[o]),delete a[o],n=!0)}return n};var eh=function(){this.layerIndexes={},this.crossTileIDs=new eu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};eh.prototype.addLayer=function(r,n,i){var a=this.layerIndexes[r.id];void 0===a&&(a=this.layerIndexes[r.id]=new ef);var o=!1,s={};a.handleWrapJump(i);for(var l=0;l<n.length;l+=1){var c=n[l],u=c.getBucket(r);u&&r.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),a.addBucket(c.tileID,u,this.crossTileIDs)&&(o=!0),s[u.bucketInstanceId]=!0)}return a.removeStaleBuckets(s)&&(o=!0),o},eh.prototype.pruneUnusedLayers=function(r){var n={};for(var i in r.forEach(function(r){n[r]=!0}),this.layerIndexes)n[i]||delete this.layerIndexes[i]};var ep=function(n,i){return r.emitValidationErrors(n,i&&i.filter(function(r){return"source.canvas"!==r.identifier}))},ed=r.pick(tR,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),em=r.pick(tR,["setCenter","setZoom","setBearing","setPitch"]),eg=function(){var n={},i=r.styleSpec.$version;for(var a in r.styleSpec.$root){var o=r.styleSpec.$root[a];if(o.required){var s=null;null!=(s="version"===a?i:"array"===o.type?[]:{})&&(n[a]=s)}}return n}(),ev=function(n){function i(a,o){var s=this;void 0===o&&(o={}),n.call(this),this.map=a,this.dispatcher=new w(tz(),this),this.imageManager=new p,this.imageManager.setEventedParent(this),this.glyphManager=new v(a._requestManager,o.localIdeographFontFamily),this.lineAtlas=new _(256,512),this.crossTileSymbolIndex=new eh,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new r.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",r.getReferrer());var l=this;this._rtlTextPluginCallback=i.registerForPluginStateChange(function(n){var i={pluginStatus:n.pluginStatus,pluginURL:n.pluginURL};l.dispatcher.broadcast("syncRTLPluginState",i,function(n,i){if(r.triggerPluginCompletionEvent(n),i&&i.every(function(r){return r}))for(var a in l.sourceCaches)l.sourceCaches[a].reload()})}),this.on("data",function(r){if("source"===r.dataType&&"metadata"===r.sourceDataType){var n=s.sourceCaches[r.sourceId];if(n){var i=n.getSource();if(i&&i.vectorLayerIds)for(var a in s._layers){var o=s._layers[a];o.source===i.id&&s._validateLayer(o)}}}})}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.loadURL=function(n,i){var a=this;void 0===i&&(i={}),this.fire(new r.Event("dataloading",{dataType:"style"}));var o="boolean"==typeof i.validate?i.validate:!r.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,i.accessToken);var s=this.map._requestManager.transformRequest(n,r.ResourceType.Style);this._request=r.getJSON(s,function(n,i){a._request=null,n?a.fire(new r.ErrorEvent(n)):i&&a._load(i,o)})},i.prototype.loadJSON=function(n,i){var a=this;void 0===i&&(i={}),this.fire(new r.Event("dataloading",{dataType:"style"})),this._request=r.browser.frame(function(){a._request=null,a._load(n,!1!==i.validate)})},i.prototype.loadEmpty=function(){this.fire(new r.Event("dataloading",{dataType:"style"})),this._load(eg,!1)},i.prototype._load=function(n,i){if(!i||!ep(this,r.validateStyle(n))){for(var a in this._loaded=!0,this.stylesheet=n,n.sources)this.addSource(a,n.sources[a],{validate:!1});n.sprite?this._loadSprite(n.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(n.glyphs);var o=tD(this.stylesheet.layers);this._order=o.map(function(r){return r.id}),this._layers={},this._serializedLayers={};for(var s=0;s<o.length;s+=1){var l=o[s];(l=r.createStyleLayer(l)).setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=l,this._serializedLayers[l.id]=l.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new b(this.stylesheet.light),this.fire(new r.Event("data",{dataType:"style"})),this.fire(new r.Event("style.load"))}},i.prototype._loadSprite=function(n){var i=this;this._spriteRequest=function(n,i,a){var o,s,l,c=r.browser.devicePixelRatio>1?"@2x":"",u=r.getJSON(i.transformRequest(i.normalizeSpriteURL(n,c,".json"),r.ResourceType.SpriteJSON),function(r,n){u=null,l||(l=r,o=n,h())}),f=r.getImage(i.transformRequest(i.normalizeSpriteURL(n,c,".png"),r.ResourceType.SpriteImage),function(r,n){f=null,l||(l=r,s=n,h())});function h(){if(l)a(l);else if(o&&s){var n=r.browser.getImageData(s),i={};for(var c in o){var u=o[c],f=u.width,h=u.height,p=u.x,d=u.y,m=u.sdf,g=u.pixelRatio,v=u.stretchX,y=u.stretchY,x=u.content,b=new r.RGBAImage({width:f,height:h});r.RGBAImage.copy(n,b,{x:p,y:d},{x:0,y:0},{width:f,height:h}),i[c]={data:b,pixelRatio:g,sdf:m,stretchX:v,stretchY:y,content:x}}a(null,i)}}return{cancel:function(){u&&(u.cancel(),u=null),f&&(f.cancel(),f=null)}}}(n,this.map._requestManager,function(n,a){if(i._spriteRequest=null,n)i.fire(new r.ErrorEvent(n));else if(a)for(var o in a)i.imageManager.addImage(o,a[o]);i.imageManager.setLoaded(!0),i._availableImages=i.imageManager.listImages(),i.dispatcher.broadcast("setImages",i._availableImages),i.fire(new r.Event("data",{dataType:"style"}))})},i.prototype._validateLayer=function(n){var i=this.sourceCaches[n.source];if(i){var a=n.sourceLayer;if(a){var o=i.getSource();("geojson"===o.type||o.vectorLayerIds&&-1===o.vectorLayerIds.indexOf(a))&&this.fire(new r.ErrorEvent(Error('Source layer "'+a+'" does not exist on source "'+o.id+'" as specified by style layer "'+n.id+'"')))}}},i.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()},i.prototype._serializeLayers=function(r){for(var n=[],i=0;i<r.length;i+=1){var a=r[i],o=this._layers[a];"custom"!==o.type&&n.push(o.serialize())}return n},i.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(var n in this._layers)if(this._layers[n].hasTransition())return!0;return!1},i.prototype._checkLoaded=function(){if(!this._loaded)throw Error("Style is not done loading")},i.prototype.update=function(n){if(this._loaded){var i=this._changed;if(this._changed){var a=Object.keys(this._updatedLayers),o=Object.keys(this._removedLayers);for(var s in(a.length||o.length)&&this._updateWorkerLayers(a,o),this._updatedSources){var l=this._updatedSources[s];"reload"===l?this._reloadSource(s):"clear"===l&&this._clearSource(s)}for(var c in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[c].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}for(var u in this.sourceCaches)this.sourceCaches[u].used=!1;for(var f=0,h=this._order;f<h.length;f+=1){var p=h[f],d=this._layers[p];d.recalculate(n,this._availableImages),!d.isHidden(n.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}this.light.recalculate(n),this.z=n.zoom,i&&this.fire(new r.Event("data",{dataType:"style"}))}},i.prototype._updateTilesForChangedImages=function(){var r=Object.keys(this._changedImages);if(r.length){for(var n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}},i.prototype._updateWorkerLayers=function(r,n){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:n})},i.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},i.prototype.setState=function(n){var i=this;if(this._checkLoaded(),ep(this,r.validateStyle(n)))return!1;(n=r.clone$1(n)).layers=tD(n.layers);var a=(function(n,i){if(!n)return[{command:tR.setStyle,args:[i]}];var a=[];try{if(!r.deepEqual(n.version,i.version))return[{command:tR.setStyle,args:[i]}];r.deepEqual(n.center,i.center)||a.push({command:tR.setCenter,args:[i.center]}),r.deepEqual(n.zoom,i.zoom)||a.push({command:tR.setZoom,args:[i.zoom]}),r.deepEqual(n.bearing,i.bearing)||a.push({command:tR.setBearing,args:[i.bearing]}),r.deepEqual(n.pitch,i.pitch)||a.push({command:tR.setPitch,args:[i.pitch]}),r.deepEqual(n.sprite,i.sprite)||a.push({command:tR.setSprite,args:[i.sprite]}),r.deepEqual(n.glyphs,i.glyphs)||a.push({command:tR.setGlyphs,args:[i.glyphs]}),r.deepEqual(n.transition,i.transition)||a.push({command:tR.setTransition,args:[i.transition]}),r.deepEqual(n.light,i.light)||a.push({command:tR.setLight,args:[i.light]});var o={},s=[];!function(n,i,a,o){var s,l,c;for(s in i=i||{},n=n||{})n.hasOwnProperty(s)&&(i.hasOwnProperty(s)||tB(s,a,o));for(s in i)i.hasOwnProperty(s)&&(n.hasOwnProperty(s)?r.deepEqual(n[s],i[s])||("geojson"===n[s].type&&"geojson"===i[s].type&&function(n,i,a){var o;for(o in n[a])if(n[a].hasOwnProperty(o)&&"data"!==o&&!r.deepEqual(n[a][o],i[a][o]))return!1;for(o in i[a])if(i[a].hasOwnProperty(o)&&"data"!==o&&!r.deepEqual(n[a][o],i[a][o]))return!1;return!0}(n,i,s)?a.push({command:tR.setGeoJSONSourceData,args:[s,i[s].data]}):(l=s,c=i,tB(l,a,o),tF(l,c,a))):tF(s,i,a))}(n.sources,i.sources,s,o);var l=[];n.layers&&n.layers.forEach(function(r){o[r.source]?a.push({command:tR.removeLayer,args:[r.id]}):l.push(r)}),a=a.concat(s),function(n,i,a){i=i||[];var o,s,l,c,u,f,h,p=(n=n||[]).map(tj),d=i.map(tj),m=n.reduce(tU,{}),g=i.reduce(tU,{}),v=p.slice(),y=Object.create(null);for(o=0,s=0;o<p.length;o++)l=p[o],g.hasOwnProperty(l)?s++:(a.push({command:tR.removeLayer,args:[l]}),v.splice(v.indexOf(l,s),1));for(o=0,s=0;o<d.length;o++)l=d[d.length-1-o],v[v.length-1-o]!==l&&(m.hasOwnProperty(l)?(a.push({command:tR.removeLayer,args:[l]}),v.splice(v.lastIndexOf(l,v.length-s),1)):s++,f=v[v.length-o],a.push({command:tR.addLayer,args:[g[l],f]}),v.splice(v.length-o,0,l),y[l]=!0);for(o=0;o<d.length;o++)if(c=m[l=d[o]],u=g[l],!y[l]&&!r.deepEqual(c,u)){if(r.deepEqual(c.source,u.source)&&r.deepEqual(c["source-layer"],u["source-layer"])&&r.deepEqual(c.type,u.type)){for(h in tN(c.layout,u.layout,a,l,null,tR.setLayoutProperty),tN(c.paint,u.paint,a,l,null,tR.setPaintProperty),r.deepEqual(c.filter,u.filter)||a.push({command:tR.setFilter,args:[l,u.filter]}),r.deepEqual(c.minzoom,u.minzoom)&&r.deepEqual(c.maxzoom,u.maxzoom)||a.push({command:tR.setLayerZoomRange,args:[l,u.minzoom,u.maxzoom]}),c)c.hasOwnProperty(h)&&"layout"!==h&&"paint"!==h&&"filter"!==h&&"metadata"!==h&&"minzoom"!==h&&"maxzoom"!==h&&(0===h.indexOf("paint.")?tN(c[h],u[h],a,l,h.slice(6),tR.setPaintProperty):r.deepEqual(c[h],u[h])||a.push({command:tR.setLayerProperty,args:[l,h,u[h]]}));for(h in u)u.hasOwnProperty(h)&&!c.hasOwnProperty(h)&&"layout"!==h&&"paint"!==h&&"filter"!==h&&"metadata"!==h&&"minzoom"!==h&&"maxzoom"!==h&&(0===h.indexOf("paint.")?tN(c[h],u[h],a,l,h.slice(6),tR.setPaintProperty):r.deepEqual(c[h],u[h])||a.push({command:tR.setLayerProperty,args:[l,h,u[h]]}))}else a.push({command:tR.removeLayer,args:[l]}),f=v[v.lastIndexOf(l)+1],a.push({command:tR.addLayer,args:[u,f]})}}(l,i.layers,a)}catch(r){console.warn("Unable to compute style diff:",r),a=[{command:tR.setStyle,args:[i]}]}return a})(this.serialize(),n).filter(function(r){return!(r.command in em)});if(0===a.length)return!1;var o=a.filter(function(r){return!(r.command in ed)});if(o.length>0)throw Error("Unimplemented: "+o.map(function(r){return r.command}).join(", ")+".");return a.forEach(function(r){"setTransition"!==r.command&&i[r.command].apply(i,r.args)}),this.stylesheet=n,!0},i.prototype.addImage=function(n,i){if(this.getImage(n))return this.fire(new r.ErrorEvent(Error("An image with this name already exists.")));this.imageManager.addImage(n,i),this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.fire(new r.Event("data",{dataType:"style"}))},i.prototype.updateImage=function(r,n){this.imageManager.updateImage(r,n)},i.prototype.getImage=function(r){return this.imageManager.getImage(r)},i.prototype.removeImage=function(n){if(!this.getImage(n))return this.fire(new r.ErrorEvent(Error("No image with this name exists.")));this.imageManager.removeImage(n),this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.fire(new r.Event("data",{dataType:"style"}))},i.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},i.prototype.addSource=function(n,i,a){var o=this;if(void 0===a&&(a={}),this._checkLoaded(),void 0!==this.sourceCaches[n])throw Error("There is already a source with this ID");if(!i.type)throw Error("The type property must be defined, but the only the following properties were given: "+Object.keys(i).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(i.type)>=0)||!this._validate(r.validateStyle.source,"sources."+n,i,null,a)){this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);var s=this.sourceCaches[n]=new tM(n,i,this.dispatcher);s.style=this,s.setEventedParent(this,function(){return{isSourceLoaded:o.loaded(),source:s.serialize(),sourceId:n}}),s.onAdd(this.map),this._changed=!0}},i.prototype.removeSource=function(n){if(this._checkLoaded(),void 0===this.sourceCaches[n])throw Error("There is no source with this ID");for(var i in this._layers)if(this._layers[i].source===n)return this.fire(new r.ErrorEvent(Error('Source "'+n+'" cannot be removed while layer "'+i+'" is using it.')));var a=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],a.fire(new r.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),a.setEventedParent(null),a.clearTiles(),a.onRemove&&a.onRemove(this.map),this._changed=!0},i.prototype.setGeoJSONSourceData=function(r,n){this._checkLoaded(),this.sourceCaches[r].getSource().setData(n),this._changed=!0},i.prototype.getSource=function(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()},i.prototype.addLayer=function(n,i,a){void 0===a&&(a={}),this._checkLoaded();var o=n.id;if(this.getLayer(o))this.fire(new r.ErrorEvent(Error('Layer with id "'+o+'" already exists on this map')));else{if("custom"===n.type){if(ep(this,r.validateCustomStyleLayer(n)))return;s=r.createStyleLayer(n)}else{if("object"==typeof n.source&&(this.addSource(o,n.source),n=r.clone$1(n),n=r.extend(n,{source:o})),this._validate(r.validateStyle.layer,"layers."+o,n,{arrayIndex:-1},a))return;s=r.createStyleLayer(n),this._validateLayer(s),s.setEventedParent(this,{layer:{id:o}}),this._serializedLayers[s.id]=s.serialize()}var s,l=i?this._order.indexOf(i):this._order.length;if(i&&-1===l)this.fire(new r.ErrorEvent(Error('Layer with id "'+i+'" does not exist on this map.')));else{if(this._order.splice(l,0,o),this._layerOrderChanged=!0,this._layers[o]=s,this._removedLayers[o]&&s.source&&"custom"!==s.type){var c=this._removedLayers[o];delete this._removedLayers[o],c.type!==s.type?this._updatedSources[s.source]="clear":(this._updatedSources[s.source]="reload",this.sourceCaches[s.source].pause())}this._updateLayer(s),s.onAdd&&s.onAdd(this.map)}}},i.prototype.moveLayer=function(n,i){if(this._checkLoaded(),this._changed=!0,this._layers[n]){if(n!==i){var a=this._order.indexOf(n);this._order.splice(a,1);var o=i?this._order.indexOf(i):this._order.length;i&&-1===o?this.fire(new r.ErrorEvent(Error('Layer with id "'+i+'" does not exist on this map.'))):(this._order.splice(o,0,n),this._layerOrderChanged=!0)}}else this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be moved.")))},i.prototype.removeLayer=function(n){this._checkLoaded();var i=this._layers[n];if(i){i.setEventedParent(null);var a=this._order.indexOf(n);this._order.splice(a,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=i,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],i.onRemove&&i.onRemove(this.map)}else this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be removed.")))},i.prototype.getLayer=function(r){return this._layers[r]},i.prototype.hasLayer=function(r){return r in this._layers},i.prototype.setLayerZoomRange=function(n,i,a){this._checkLoaded();var o=this.getLayer(n);o?o.minzoom===i&&o.maxzoom===a||(null!=i&&(o.minzoom=i),null!=a&&(o.maxzoom=a),this._updateLayer(o)):this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot have zoom extent.")))},i.prototype.setFilter=function(n,i,a){void 0===a&&(a={}),this._checkLoaded();var o=this.getLayer(n);if(o){if(!r.deepEqual(o.filter,i))return null==i?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(r.validateStyle.filter,"layers."+o.id+".filter",i,null,a)||(o.filter=r.clone$1(i),this._updateLayer(o)))}else this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be filtered.")))},i.prototype.getFilter=function(n){return r.clone$1(this.getLayer(n).filter)},i.prototype.setLayoutProperty=function(n,i,a,o){void 0===o&&(o={}),this._checkLoaded();var s=this.getLayer(n);s?r.deepEqual(s.getLayoutProperty(i),a)||(s.setLayoutProperty(i,a,o),this._updateLayer(s)):this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getLayoutProperty=function(n,i){var a=this.getLayer(n);if(a)return a.getLayoutProperty(i);this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style.")))},i.prototype.setPaintProperty=function(n,i,a,o){void 0===o&&(o={}),this._checkLoaded();var s=this.getLayer(n);s?r.deepEqual(s.getPaintProperty(i),a)||(s.setPaintProperty(i,a,o)&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new r.ErrorEvent(Error("The layer '"+n+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getPaintProperty=function(r,n){return this.getLayer(r).getPaintProperty(n)},i.prototype.setFeatureState=function(n,i){this._checkLoaded();var a=n.source,o=n.sourceLayer,s=this.sourceCaches[a];if(void 0!==s){var l=s.getSource().type;"geojson"===l&&o?this.fire(new r.ErrorEvent(Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==l||o?(void 0===n.id&&this.fire(new r.ErrorEvent(Error("The feature id parameter must be provided."))),s.setFeatureState(o,n.id,i)):this.fire(new r.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(Error("The source '"+a+"' does not exist in the map's style.")))},i.prototype.removeFeatureState=function(n,i){this._checkLoaded();var a=n.source,o=this.sourceCaches[a];if(void 0!==o){var s=o.getSource().type,l="vector"===s?n.sourceLayer:void 0;"vector"!==s||l?i&&"string"!=typeof n.id&&"number"!=typeof n.id?this.fire(new r.ErrorEvent(Error("A feature id is requred to remove its specific state property."))):o.removeFeatureState(l,n.id,i):this.fire(new r.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(Error("The source '"+a+"' does not exist in the map's style.")))},i.prototype.getFeatureState=function(n){this._checkLoaded();var i=n.source,a=n.sourceLayer,o=this.sourceCaches[i];if(void 0!==o){if("vector"!==o.getSource().type||a)return void 0===n.id&&this.fire(new r.ErrorEvent(Error("The feature id parameter must be provided."))),o.getFeatureState(a,n.id);this.fire(new r.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(Error("The source '"+i+"' does not exist in the map's style.")))},i.prototype.getTransition=function(){return r.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},i.prototype.serialize=function(){return r.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:r.mapObject(this.sourceCaches,function(r){return r.serialize()}),layers:this._serializeLayers(this._order)},function(r){return void 0!==r})},i.prototype._updateLayer=function(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&"raster"!==this.sourceCaches[r.source].getSource().type&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._changed=!0},i.prototype._flattenAndSortRenderedFeatures=function(r){for(var n=this,i=function(r){return"fill-extrusion"===n._layers[r].type},a={},o=[],s=this._order.length-1;s>=0;s--){var l=this._order[s];if(i(l)){a[l]=s;for(var c=0;c<r.length;c+=1){var u=r[c][l];if(u)for(var f=0;f<u.length;f+=1){var h=u[f];o.push(h)}}}}o.sort(function(r,n){return n.intersectionZ-r.intersectionZ});for(var p=[],d=this._order.length-1;d>=0;d--){var m=this._order[d];if(i(m))for(var g=o.length-1;g>=0;g--){var v=o[g].feature;if(a[v.layer.id]<d)break;p.push(v),o.pop()}else for(var y=0;y<r.length;y+=1){var x=r[y][m];if(x)for(var b=0;b<x.length;b+=1){var _=x[b];p.push(_.feature)}}}return p},i.prototype.queryRenderedFeatures=function(n,i,a){i&&i.filter&&this._validate(r.validateStyle.filter,"queryRenderedFeatures.filter",i.filter,null,i);var o={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new r.ErrorEvent(Error("parameters.layers must be an Array."))),[];for(var s=0,l=i.layers;s<l.length;s+=1){var c=l[s],u=this._layers[c];if(!u)return this.fire(new r.ErrorEvent(Error("The layer '"+c+"' does not exist in the map's style and cannot be queried for features."))),[];o[u.source]=!0}}var f=[];for(var h in i.availableImages=this._availableImages,this.sourceCaches)i.layers&&!o[h]||f.push(function(n,i,a,o,s,l){var c=function(r,n,i){if(r)for(var a=0;a<r.length;a+=1){var o=n[r[a]];if(o&&o.source===i&&"fill-extrusion"===o.type)return!0}else for(var s in n){var l=n[s];if(l.source===i&&"fill-extrusion"===l.type)return!0}return!1}(s&&s.layers,i,n.id),u=l.maxPitchScaleFactor(),f=n.tilesIn(o,u,c);f.sort(z);for(var h=[],p=0;p<f.length;p+=1){var d=f[p];h.push({wrappedTileID:d.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(i,a,n._state,d.queryGeometry,d.cameraQueryGeometry,d.scale,s,l,u,function(n,i){var a=r.identity([]);return r.translate(a,a,[1,1,0]),r.scale(a,a,[.5*n.width,.5*n.height,1]),r.multiply(a,a,n.calculatePosMatrix(i.toUnwrapped()))}(n.transform,d.tileID))})}var m=function(r){for(var n={},i={},a=0;a<r.length;a+=1){var o=r[a],s=o.queryResults,l=o.wrappedTileID,c=i[l]=i[l]||{};for(var u in s)for(var f=s[u],h=c[u]=c[u]||{},p=n[u]=n[u]||[],d=0;d<f.length;d+=1){var m=f[d];h[m.featureIndex]||(h[m.featureIndex]=!0,p.push(m))}}return n}(h);for(var g in m)m[g].forEach(function(r){var i=r.feature,a=n.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=a});return m}(this.sourceCaches[h],this._layers,this._serializedLayers,n,i,a));return this.placement&&f.push(function(r,n,i,a,o,s,l){for(var c={},u=s.queryRenderedSymbols(a),f=[],h=0,p=Object.keys(u).map(Number);h<p.length;h+=1){var d=p[h];f.push(l[d])}f.sort(z);for(var m=0;m<f.length;m+=1)(function(){var i=f[m],a=i.featureIndex.lookupSymbolFeatures(u[i.bucketInstanceId],n,i.bucketIndex,i.sourceLayerIndex,o.filter,o.layers,o.availableImages,r);for(var s in a){var l=c[s]=c[s]||[],h=a[s];h.sort(function(r,n){var a=i.featureSortOrder;if(a){var o=a.indexOf(r.featureIndex);return a.indexOf(n.featureIndex)-o}return n.featureIndex-r.featureIndex});for(var p=0;p<h.length;p+=1){var d=h[p];l.push(d)}}})();var g=function(n){c[n].forEach(function(a){var o=a.feature,s=i[r[n].source].getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=s})};for(var v in c)g(v);return c}(this._layers,this._serializedLayers,this.sourceCaches,n,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(f)},i.prototype.querySourceFeatures=function(n,i){i&&i.filter&&this._validate(r.validateStyle.filter,"querySourceFeatures.filter",i.filter,null,i);var a=this.sourceCaches[n];return a?function(r,n){for(var i=r.getRenderableIds().map(function(n){return r.getTileByID(n)}),a=[],o={},s=0;s<i.length;s++){var l=i[s],c=l.tileID.canonical.key;o[c]||(o[c]=!0,l.querySourceFeatures(a,n))}return a}(a,i):[]},i.prototype.addSourceType=function(r,n,a){return i.getSourceType(r)?a(Error('A source type called "'+r+'" already exists.')):(i.setSourceType(r,n),n.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:n.workerSourceURL},a):a(null,null))},i.prototype.getLight=function(){return this.light.getLight()},i.prototype.setLight=function(n,i){void 0===i&&(i={}),this._checkLoaded();var a=this.light.getLight(),o=!1;for(var s in n)if(!r.deepEqual(n[s],a[s])){o=!0;break}if(o){var l={now:r.browser.now(),transition:r.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,i),this.light.updateTransitions(l)}},i.prototype._validate=function(n,i,a,o,s){return void 0===s&&(s={}),(!s||!1!==s.validate)&&ep(this,n.call(r.validateStyle,r.extend({key:i,style:this.serialize(),value:a,styleSpec:r.styleSpec},o)))},i.prototype._remove=function(){for(var n in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[n].setEventedParent(null);for(var i in this.sourceCaches)this.sourceCaches[i].clearTiles(),this.sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},i.prototype._clearSource=function(r){this.sourceCaches[r].clearTiles()},i.prototype._reloadSource=function(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()},i.prototype._updateSources=function(r){for(var n in this.sourceCaches)this.sourceCaches[n].update(r)},i.prototype._generateCollisionBoxes=function(){for(var r in this.sourceCaches)this._reloadSource(r)},i.prototype._updatePlacement=function(n,i,a,o,s){void 0===s&&(s=!1);for(var l=!1,c=!1,u={},f=0,h=this._order;f<h.length;f+=1){var p=h[f],d=this._layers[p];if("symbol"===d.type){if(!u[d.source]){var m=this.sourceCaches[d.source];u[d.source]=m.getRenderableIds(!0).map(function(r){return m.getTileByID(r)}).sort(function(r,n){return n.tileID.overscaledZ-r.tileID.overscaledZ||(r.tileID.isLessThan(n.tileID)?-1:1)})}var g=this.crossTileSymbolIndex.addLayer(d,u[d.source],n.center.lng);l=l||g}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((s=s||this._layerOrderChanged||0===a)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.browser.now(),n.zoom))&&(this.pauseablePlacement=new es(n,this._order,s,i,a,o,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,u),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.browser.now()),c=!0),l&&this.pauseablePlacement.placement.setStale()),c||l)for(var v=0,y=this._order;v<y.length;v+=1){var x=y[v],b=this._layers[x];"symbol"===b.type&&this.placement.updateLayerOpacities(b,u[b.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.browser.now())},i.prototype._releaseSymbolFadeTiles=function(){for(var r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()},i.prototype.getImages=function(r,n,i){this.imageManager.getImages(n.icons,i),this._updateTilesForChangedImages();var a=this.sourceCaches[n.source];a&&a.setDependencies(n.tileID.key,n.type,n.icons)},i.prototype.getGlyphs=function(r,n,i){this.glyphManager.getGlyphs(n.stacks,i)},i.prototype.getResource=function(n,i,a){return r.makeRequest(i,a)},i}(r.Evented);ev.getSourceType=function(r){return O[r]},ev.setSourceType=function(r,n){O[r]=n},ev.registerForPluginStateChange=r.registerForPluginStateChange;var ey=r.createLayout([{name:"a_pos",type:"Int16",components:2}]),ex=eb("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}");function eb(r,n){var i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,a={};return{fragmentSource:r=r.replace(i,function(r,n,i,o,s){return a[s]=!0,"define"===n?"\n#ifndef HAS_UNIFORM_u_"+s+"\nvarying "+i+" "+o+" "+s+";\n#else\nuniform "+i+" "+o+" u_"+s+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+s+"\n    "+i+" "+o+" "+s+" = u_"+s+";\n#endif\n"}),vertexSource:n=n.replace(i,function(r,n,i,o,s){var l="float"===o?"vec2":"vec4",c=s.match(/color/)?"color":l;return a[s]?"define"===n?"\n#ifndef HAS_UNIFORM_u_"+s+"\nuniform lowp float u_"+s+"_t;\nattribute "+i+" "+l+" a_"+s+";\nvarying "+i+" "+o+" "+s+";\n#else\nuniform "+i+" "+o+" u_"+s+";\n#endif\n":"vec4"===c?"\n#ifndef HAS_UNIFORM_u_"+s+"\n    "+s+" = a_"+s+";\n#else\n    "+i+" "+o+" "+s+" = u_"+s+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+s+"\n    "+s+" = unpack_mix_"+c+"(a_"+s+", u_"+s+"_t);\n#else\n    "+i+" "+o+" "+s+" = u_"+s+";\n#endif\n":"define"===n?"\n#ifndef HAS_UNIFORM_u_"+s+"\nuniform lowp float u_"+s+"_t;\nattribute "+i+" "+l+" a_"+s+";\n#else\nuniform "+i+" "+o+" u_"+s+";\n#endif\n":"vec4"===c?"\n#ifndef HAS_UNIFORM_u_"+s+"\n    "+i+" "+o+" "+s+" = a_"+s+";\n#else\n    "+i+" "+o+" "+s+" = u_"+s+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+s+"\n    "+i+" "+o+" "+s+" = unpack_mix_"+c+"(a_"+s+", u_"+s+"_t);\n#else\n    "+i+" "+o+" "+s+" = u_"+s+";\n#endif\n"})}}var e_=Object.freeze({__proto__:null,prelude:ex,background:eb("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:eb("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:eb("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:eb("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:eb("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:eb("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:eb("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:eb("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:eb("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),fill:eb("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:eb("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:eb("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:eb("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:eb("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:eb("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:eb("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:eb("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:eb("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),lineGradient:eb("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),linePattern:eb("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:eb("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:eb("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:eb("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),symbolSDF:eb("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:eb("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}")}),ew=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};ew.prototype.bind=function(r,n,i,a,o,s,l,c){this.context=r;for(var u=this.boundPaintVertexBuffers.length!==a.length,f=0;!u&&f<a.length;f++)this.boundPaintVertexBuffers[f]!==a[f]&&(u=!0);var h=!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==i||u||this.boundIndexBuffer!==o||this.boundVertexOffset!==s||this.boundDynamicVertexBuffer!==l||this.boundDynamicVertexBuffer2!==c;!r.extVertexArrayObject||h?this.freshBind(n,i,a,o,s,l,c):(r.bindVertexArrayOES.set(this.vao),l&&l.bind(),o&&o.dynamicDraw&&o.bind(),c&&c.bind())},ew.prototype.freshBind=function(r,n,i,a,o,s,l){var c,u=r.numAttributes,f=this.context,h=f.gl;if(f.extVertexArrayObject)this.vao&&this.destroy(),this.vao=f.extVertexArrayObject.createVertexArrayOES(),f.bindVertexArrayOES.set(this.vao),c=0,this.boundProgram=r,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=a,this.boundVertexOffset=o,this.boundDynamicVertexBuffer=s,this.boundDynamicVertexBuffer2=l;else{c=f.currentNumAttributes||0;for(var p=u;p<c;p++)h.disableVertexAttribArray(p)}n.enableAttributes(h,r);for(var d=0;d<i.length;d+=1)i[d].enableAttributes(h,r);s&&s.enableAttributes(h,r),l&&l.enableAttributes(h,r),n.bind(),n.setVertexAttribPointers(h,r,o);for(var m=0;m<i.length;m+=1){var g=i[m];g.bind(),g.setVertexAttribPointers(h,r,o)}s&&(s.bind(),s.setVertexAttribPointers(h,r,o)),a&&a.bind(),l&&(l.bind(),l.setVertexAttribPointers(h,r,o)),f.currentNumAttributes=u},ew.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var eT=function(r,n,i,a,o){var s=r.gl;this.program=s.createProgram();var l=i?i.defines():[];o&&l.push("#define OVERDRAW_INSPECTOR;");var c=l.concat(ex.fragmentSource,n.fragmentSource).join("\n"),u=l.concat(ex.vertexSource,n.vertexSource).join("\n"),f=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())this.failedToCreate=!0;else{s.shaderSource(f,c),s.compileShader(f),s.attachShader(this.program,f);var h=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())this.failedToCreate=!0;else{s.shaderSource(h,u),s.compileShader(h),s.attachShader(this.program,h);for(var p=i?i.layoutAttributes:[],d=0;d<p.length;d++)s.bindAttribLocation(this.program,d,p[d].name);s.linkProgram(this.program),s.deleteShader(h),s.deleteShader(f),this.numAttributes=s.getProgramParameter(this.program,s.ACTIVE_ATTRIBUTES),this.attributes={};for(var m={},g=0;g<this.numAttributes;g++){var v=s.getActiveAttrib(this.program,g);v&&(this.attributes[v.name]=s.getAttribLocation(this.program,v.name))}for(var y=s.getProgramParameter(this.program,s.ACTIVE_UNIFORMS),x=0;x<y;x++){var b=s.getActiveUniform(this.program,x);b&&(m[b.name]=s.getUniformLocation(this.program,b.name))}this.fixedUniforms=a(r,m),this.binderUniforms=i?i.getUniforms(r,m):[]}}};function ek(r,n,i){var a=1/t3(i,1,n.transform.tileZoom),o=Math.pow(2,i.tileID.overscaledZ),s=i.tileSize*Math.pow(2,n.transform.tileZoom)/o,l=s*(i.tileID.canonical.x+i.tileID.wrap*o),c=s*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[a,r.fromScale,r.toScale],u_fade:r.t,u_pixel_coord_upper:[l>>16,c>>16],u_pixel_coord_lower:[65535&l,65535&c]}}eT.prototype.draw=function(r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v){var y,x=r.gl;if(!this.failedToCreate){for(var b in r.program.set(this.program),r.setDepthMode(i),r.setStencilMode(a),r.setColorMode(o),r.setCullFace(s),this.fixedUniforms)this.fixedUniforms[b].set(l[b]);m&&m.setUniforms(r,this.binderUniforms,p,{zoom:d});for(var _=((y={})[x.LINES]=2,y[x.TRIANGLES]=3,y[x.LINE_STRIP]=1,y)[n],w=0,T=h.get();w<T.length;w+=1){var k=T[w],A=k.vaos||(k.vaos={});(A[c]||(A[c]=new ew)).bind(r,this,u,m?m.getPaintVertexBuffers():[],f,k.vertexOffset,g,v),x.drawElements(n,k.primitiveLength*_,x.UNSIGNED_SHORT,k.primitiveOffset*_*2)}}};var eA=function(n,i,a,o){var s=i.style.light,l=s.properties.get("position"),c=[l.x,l.y,l.z],u=r.create$1();"viewport"===s.properties.get("anchor")&&r.fromRotation(u,-i.transform.angle),r.transformMat3(c,c,u);var f=s.properties.get("color");return{u_matrix:n,u_lightpos:c,u_lightintensity:s.properties.get("intensity"),u_lightcolor:[f.r,f.g,f.b],u_vertical_gradient:+a,u_opacity:o}},eM=function(r){return{u_matrix:r}},eS=function(n,i,a,o){return r.extend(eM(n),ek(a,i,o))},eE=function(n,i,a,o){var s,l,c=n.transform;if("map"===o.paint.get("circle-pitch-alignment")){var u=t3(a,1,c.zoom);s=!0,l=[u,u]}else s=!1,l=c.pixelsToGLUnits;return{u_camera_to_center_distance:c.cameraToCenterDistance,u_scale_with_map:+("map"===o.paint.get("circle-pitch-scale")),u_matrix:n.translatePosMatrix(i.posMatrix,a,o.paint.get("circle-translate"),o.paint.get("circle-translate-anchor")),u_pitch_with_map:+s,u_device_pixel_ratio:r.browser.devicePixelRatio,u_extrude_scale:l}},eL=function(r,n,i){var a=t3(i,1,n.zoom),o=Math.pow(2,n.zoom-i.tileID.overscaledZ),s=i.tileID.overscaleFactor();return{u_matrix:r,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:a,u_extrude_scale:[n.pixelsToGLUnits[0]/(a*o),n.pixelsToGLUnits[1]/(a*o)],u_overscale_factor:s}},eC=function(r,n,i){return void 0===i&&(i=1),{u_matrix:r,u_color:n,u_overlay:0,u_overlay_scale:i}},eP=function(r){return{u_matrix:r}},eI=function(n,i,a){var o=n.transform;return{u_matrix:eR(n,i,a),u_ratio:1/t3(i,1,o.zoom),u_device_pixel_ratio:r.browser.devicePixelRatio,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},eO=function(n,i,a,o){var s=n.transform,l=eD(i,s);return{u_matrix:eR(n,i,a),u_texsize:i.imageAtlasTexture.size,u_ratio:1/t3(i,1,s.zoom),u_device_pixel_ratio:r.browser.devicePixelRatio,u_image:0,u_scale:[l,o.fromScale,o.toScale],u_fade:o.t,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]]}},ez=function(n,i,a,o,s){var l=n.transform,c=n.lineAtlas,u=eD(i,l),f="round"===a.layout.get("line-cap"),h=c.getDash(o.from,f),p=c.getDash(o.to,f),d=h.width*s.fromScale,m=p.width*s.toScale;return r.extend(eI(n,i,a),{u_patternscale_a:[u/d,-h.height/2],u_patternscale_b:[u/m,-p.height/2],u_sdfgamma:c.width/(256*Math.min(d,m)*r.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:h.y,u_tex_y_b:p.y,u_mix:s.t})};function eD(r,n){return 1/t3(r,1,n.tileZoom)}function eR(r,n,i){return r.translatePosMatrix(n.tileID.posMatrix,n,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}var eF,eB=function(r,n,i,a,o){var s,l,c,u,f;return{u_matrix:r,u_tl_parent:n,u_scale_parent:i,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*o.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:o.paint.get("raster-brightness-min"),u_brightness_high:o.paint.get("raster-brightness-max"),u_saturation_factor:(l=o.paint.get("raster-saturation"))>0?1-1/(1.001-l):-l,u_contrast_factor:(s=o.paint.get("raster-contrast"))>0?1/(1-s):1+s,u_spin_weights:(u=Math.sin(c=o.paint.get("raster-hue-rotate")*(Math.PI/180)),[(2*(f=Math.cos(c))+1)/3,(-Math.sqrt(3)*u-f+1)/3,(Math.sqrt(3)*u-f+1)/3])}},eN=function(r,n,i,a,o,s,l,c,u,f){var h=o.transform;return{u_is_size_zoom_constant:+("constant"===r||"source"===r),u_is_size_feature_constant:+("constant"===r||"camera"===r),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:h.cameraToCenterDistance,u_pitch:h.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:h.width/h.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:l,u_coord_matrix:c,u_is_text:+u,u_pitch_with_map:+a,u_texsize:f,u_texture:0}},ej=function(n,i,a,o,s,l,c,u,f,h,p){var d=s.transform;return r.extend(eN(n,i,a,o,s,l,c,u,f,h),{u_gamma_scale:o?Math.cos(d._pitch)*d.cameraToCenterDistance:1,u_device_pixel_ratio:r.browser.devicePixelRatio,u_is_halo:+p})},eU=function(n,i,a,o,s,l){var c,u,f,h,p,d,m,g,v;return r.extend((c=a.imageManager.getPattern(o.from.toString()),u=a.imageManager.getPattern(o.to.toString()),h=(f=a.imageManager.getPixelSize()).width,p=f.height,d=Math.pow(2,s.tileID.overscaledZ),g=(m=s.tileSize*Math.pow(2,a.transform.tileZoom)/d)*(s.tileID.canonical.x+s.tileID.wrap*d),v=m*s.tileID.canonical.y,{u_image:0,u_pattern_tl_a:c.tl,u_pattern_br_a:c.br,u_pattern_tl_b:u.tl,u_pattern_br_b:u.br,u_texsize:[h,p],u_mix:l.t,u_pattern_size_a:c.displaySize,u_pattern_size_b:u.displaySize,u_scale_a:l.fromScale,u_scale_b:l.toScale,u_tile_units_to_pixels:1/t3(s,1,a.transform.tileZoom),u_pixel_coord_upper:[g>>16,v>>16],u_pixel_coord_lower:[65535&g,65535&v]}),{u_matrix:n,u_opacity:i})},eV={fillExtrusion:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_lightpos:new r.Uniform3f(n,i.u_lightpos),u_lightintensity:new r.Uniform1f(n,i.u_lightintensity),u_lightcolor:new r.Uniform3f(n,i.u_lightcolor),u_vertical_gradient:new r.Uniform1f(n,i.u_vertical_gradient),u_opacity:new r.Uniform1f(n,i.u_opacity)}},fillExtrusionPattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_lightpos:new r.Uniform3f(n,i.u_lightpos),u_lightintensity:new r.Uniform1f(n,i.u_lightintensity),u_lightcolor:new r.Uniform3f(n,i.u_lightcolor),u_vertical_gradient:new r.Uniform1f(n,i.u_vertical_gradient),u_height_factor:new r.Uniform1f(n,i.u_height_factor),u_image:new r.Uniform1i(n,i.u_image),u_texsize:new r.Uniform2f(n,i.u_texsize),u_pixel_coord_upper:new r.Uniform2f(n,i.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(n,i.u_pixel_coord_lower),u_scale:new r.Uniform3f(n,i.u_scale),u_fade:new r.Uniform1f(n,i.u_fade),u_opacity:new r.Uniform1f(n,i.u_opacity)}},fill:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix)}},fillPattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_image:new r.Uniform1i(n,i.u_image),u_texsize:new r.Uniform2f(n,i.u_texsize),u_pixel_coord_upper:new r.Uniform2f(n,i.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(n,i.u_pixel_coord_lower),u_scale:new r.Uniform3f(n,i.u_scale),u_fade:new r.Uniform1f(n,i.u_fade)}},fillOutline:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_world:new r.Uniform2f(n,i.u_world)}},fillOutlinePattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_world:new r.Uniform2f(n,i.u_world),u_image:new r.Uniform1i(n,i.u_image),u_texsize:new r.Uniform2f(n,i.u_texsize),u_pixel_coord_upper:new r.Uniform2f(n,i.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(n,i.u_pixel_coord_lower),u_scale:new r.Uniform3f(n,i.u_scale),u_fade:new r.Uniform1f(n,i.u_fade)}},circle:function(n,i){return{u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_scale_with_map:new r.Uniform1i(n,i.u_scale_with_map),u_pitch_with_map:new r.Uniform1i(n,i.u_pitch_with_map),u_extrude_scale:new r.Uniform2f(n,i.u_extrude_scale),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_matrix:new r.UniformMatrix4f(n,i.u_matrix)}},collisionBox:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_pixels_to_tile_units:new r.Uniform1f(n,i.u_pixels_to_tile_units),u_extrude_scale:new r.Uniform2f(n,i.u_extrude_scale),u_overscale_factor:new r.Uniform1f(n,i.u_overscale_factor)}},collisionCircle:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_inv_matrix:new r.UniformMatrix4f(n,i.u_inv_matrix),u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_viewport_size:new r.Uniform2f(n,i.u_viewport_size)}},debug:function(n,i){return{u_color:new r.UniformColor(n,i.u_color),u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_overlay:new r.Uniform1i(n,i.u_overlay),u_overlay_scale:new r.Uniform1f(n,i.u_overlay_scale)}},clippingMask:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix)}},heatmap:function(n,i){return{u_extrude_scale:new r.Uniform1f(n,i.u_extrude_scale),u_intensity:new r.Uniform1f(n,i.u_intensity),u_matrix:new r.UniformMatrix4f(n,i.u_matrix)}},heatmapTexture:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_world:new r.Uniform2f(n,i.u_world),u_image:new r.Uniform1i(n,i.u_image),u_color_ramp:new r.Uniform1i(n,i.u_color_ramp),u_opacity:new r.Uniform1f(n,i.u_opacity)}},hillshade:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_image:new r.Uniform1i(n,i.u_image),u_latrange:new r.Uniform2f(n,i.u_latrange),u_light:new r.Uniform2f(n,i.u_light),u_shadow:new r.UniformColor(n,i.u_shadow),u_highlight:new r.UniformColor(n,i.u_highlight),u_accent:new r.UniformColor(n,i.u_accent)}},hillshadePrepare:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_image:new r.Uniform1i(n,i.u_image),u_dimension:new r.Uniform2f(n,i.u_dimension),u_zoom:new r.Uniform1f(n,i.u_zoom),u_maxzoom:new r.Uniform1f(n,i.u_maxzoom),u_unpack:new r.Uniform4f(n,i.u_unpack)}},line:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_ratio:new r.Uniform1f(n,i.u_ratio),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_units_to_pixels:new r.Uniform2f(n,i.u_units_to_pixels)}},lineGradient:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_ratio:new r.Uniform1f(n,i.u_ratio),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_units_to_pixels:new r.Uniform2f(n,i.u_units_to_pixels),u_image:new r.Uniform1i(n,i.u_image)}},linePattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_texsize:new r.Uniform2f(n,i.u_texsize),u_ratio:new r.Uniform1f(n,i.u_ratio),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_image:new r.Uniform1i(n,i.u_image),u_units_to_pixels:new r.Uniform2f(n,i.u_units_to_pixels),u_scale:new r.Uniform3f(n,i.u_scale),u_fade:new r.Uniform1f(n,i.u_fade)}},lineSDF:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_ratio:new r.Uniform1f(n,i.u_ratio),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_units_to_pixels:new r.Uniform2f(n,i.u_units_to_pixels),u_patternscale_a:new r.Uniform2f(n,i.u_patternscale_a),u_patternscale_b:new r.Uniform2f(n,i.u_patternscale_b),u_sdfgamma:new r.Uniform1f(n,i.u_sdfgamma),u_image:new r.Uniform1i(n,i.u_image),u_tex_y_a:new r.Uniform1f(n,i.u_tex_y_a),u_tex_y_b:new r.Uniform1f(n,i.u_tex_y_b),u_mix:new r.Uniform1f(n,i.u_mix)}},raster:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_tl_parent:new r.Uniform2f(n,i.u_tl_parent),u_scale_parent:new r.Uniform1f(n,i.u_scale_parent),u_buffer_scale:new r.Uniform1f(n,i.u_buffer_scale),u_fade_t:new r.Uniform1f(n,i.u_fade_t),u_opacity:new r.Uniform1f(n,i.u_opacity),u_image0:new r.Uniform1i(n,i.u_image0),u_image1:new r.Uniform1i(n,i.u_image1),u_brightness_low:new r.Uniform1f(n,i.u_brightness_low),u_brightness_high:new r.Uniform1f(n,i.u_brightness_high),u_saturation_factor:new r.Uniform1f(n,i.u_saturation_factor),u_contrast_factor:new r.Uniform1f(n,i.u_contrast_factor),u_spin_weights:new r.Uniform3f(n,i.u_spin_weights)}},symbolIcon:function(n,i){return{u_is_size_zoom_constant:new r.Uniform1i(n,i.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(n,i.u_is_size_feature_constant),u_size_t:new r.Uniform1f(n,i.u_size_t),u_size:new r.Uniform1f(n,i.u_size),u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_pitch:new r.Uniform1f(n,i.u_pitch),u_rotate_symbol:new r.Uniform1i(n,i.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(n,i.u_aspect_ratio),u_fade_change:new r.Uniform1f(n,i.u_fade_change),u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(n,i.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(n,i.u_coord_matrix),u_is_text:new r.Uniform1i(n,i.u_is_text),u_pitch_with_map:new r.Uniform1i(n,i.u_pitch_with_map),u_texsize:new r.Uniform2f(n,i.u_texsize),u_texture:new r.Uniform1i(n,i.u_texture)}},symbolSDF:function(n,i){return{u_is_size_zoom_constant:new r.Uniform1i(n,i.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(n,i.u_is_size_feature_constant),u_size_t:new r.Uniform1f(n,i.u_size_t),u_size:new r.Uniform1f(n,i.u_size),u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_pitch:new r.Uniform1f(n,i.u_pitch),u_rotate_symbol:new r.Uniform1i(n,i.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(n,i.u_aspect_ratio),u_fade_change:new r.Uniform1f(n,i.u_fade_change),u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(n,i.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(n,i.u_coord_matrix),u_is_text:new r.Uniform1i(n,i.u_is_text),u_pitch_with_map:new r.Uniform1i(n,i.u_pitch_with_map),u_texsize:new r.Uniform2f(n,i.u_texsize),u_texture:new r.Uniform1i(n,i.u_texture),u_gamma_scale:new r.Uniform1f(n,i.u_gamma_scale),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_is_halo:new r.Uniform1i(n,i.u_is_halo)}},symbolTextAndIcon:function(n,i){return{u_is_size_zoom_constant:new r.Uniform1i(n,i.u_is_size_zoom_constant),u_is_size_feature_constant:new r.Uniform1i(n,i.u_is_size_feature_constant),u_size_t:new r.Uniform1f(n,i.u_size_t),u_size:new r.Uniform1f(n,i.u_size),u_camera_to_center_distance:new r.Uniform1f(n,i.u_camera_to_center_distance),u_pitch:new r.Uniform1f(n,i.u_pitch),u_rotate_symbol:new r.Uniform1i(n,i.u_rotate_symbol),u_aspect_ratio:new r.Uniform1f(n,i.u_aspect_ratio),u_fade_change:new r.Uniform1f(n,i.u_fade_change),u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_label_plane_matrix:new r.UniformMatrix4f(n,i.u_label_plane_matrix),u_coord_matrix:new r.UniformMatrix4f(n,i.u_coord_matrix),u_is_text:new r.Uniform1i(n,i.u_is_text),u_pitch_with_map:new r.Uniform1i(n,i.u_pitch_with_map),u_texsize:new r.Uniform2f(n,i.u_texsize),u_texsize_icon:new r.Uniform2f(n,i.u_texsize_icon),u_texture:new r.Uniform1i(n,i.u_texture),u_texture_icon:new r.Uniform1i(n,i.u_texture_icon),u_gamma_scale:new r.Uniform1f(n,i.u_gamma_scale),u_device_pixel_ratio:new r.Uniform1f(n,i.u_device_pixel_ratio),u_is_halo:new r.Uniform1i(n,i.u_is_halo)}},background:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_opacity:new r.Uniform1f(n,i.u_opacity),u_color:new r.UniformColor(n,i.u_color)}},backgroundPattern:function(n,i){return{u_matrix:new r.UniformMatrix4f(n,i.u_matrix),u_opacity:new r.Uniform1f(n,i.u_opacity),u_image:new r.Uniform1i(n,i.u_image),u_pattern_tl_a:new r.Uniform2f(n,i.u_pattern_tl_a),u_pattern_br_a:new r.Uniform2f(n,i.u_pattern_br_a),u_pattern_tl_b:new r.Uniform2f(n,i.u_pattern_tl_b),u_pattern_br_b:new r.Uniform2f(n,i.u_pattern_br_b),u_texsize:new r.Uniform2f(n,i.u_texsize),u_mix:new r.Uniform1f(n,i.u_mix),u_pattern_size_a:new r.Uniform2f(n,i.u_pattern_size_a),u_pattern_size_b:new r.Uniform2f(n,i.u_pattern_size_b),u_scale_a:new r.Uniform1f(n,i.u_scale_a),u_scale_b:new r.Uniform1f(n,i.u_scale_b),u_pixel_coord_upper:new r.Uniform2f(n,i.u_pixel_coord_upper),u_pixel_coord_lower:new r.Uniform2f(n,i.u_pixel_coord_lower),u_tile_units_to_pixels:new r.Uniform1f(n,i.u_tile_units_to_pixels)}}};function eH(n,i,a,o,s,l,c){for(var u=n.context,f=u.gl,h=n.useProgram("collisionBox"),p=[],d=0,m=0,g=0;g<o.length;g++){var v=o[g],y=i.getTile(v),x=y.getBucket(a);if(x){var b=v.posMatrix;0===s[0]&&0===s[1]||(b=n.translatePosMatrix(v.posMatrix,y,s,l));var _=c?x.textCollisionBox:x.iconCollisionBox,w=x.collisionCircleArray;if(w.length>0){var T=r.create(),k=b;r.mul(T,x.placementInvProjMatrix,n.transform.glCoordMatrix),r.mul(T,T,x.placementViewportMatrix),p.push({circleArray:w,circleOffset:m,transform:k,invTransform:T}),m=d+=w.length/4}_&&h.draw(u,f.LINES,t_.disabled,tw.disabled,n.colorModeForRenderPass(),tk.disabled,eL(b,n.transform,y),a.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,n.transform.zoom,null,null,_.collisionVertexBuffer)}}if(c&&p.length){var A=n.useProgram("collisionCircle"),M=new r.StructArrayLayout2f1f2i16;M.resize(4*d),M._trim();for(var S=0,E=0;E<p.length;E+=1)for(var L=p[E],C=0;C<L.circleArray.length/4;C++){var P=4*C,I=L.circleArray[P+0],O=L.circleArray[P+1],z=L.circleArray[P+2],D=L.circleArray[P+3];M.emplace(S++,I,O,z,D,0),M.emplace(S++,I,O,z,D,1),M.emplace(S++,I,O,z,D,2),M.emplace(S++,I,O,z,D,3)}(!eF||eF.length<2*d)&&(eF=function(n){var i=2*n,a=new r.StructArrayLayout3ui6;a.resize(i),a._trim();for(var o=0;o<i;o++){var s=6*o;a.uint16[s+0]=4*o+0,a.uint16[s+1]=4*o+1,a.uint16[s+2]=4*o+2,a.uint16[s+3]=4*o+2,a.uint16[s+4]=4*o+3,a.uint16[s+5]=4*o+0}return a}(d));for(var R=u.createIndexBuffer(eF,!0),F=u.createVertexBuffer(M,r.collisionCircleLayout.members,!0),B=0;B<p.length;B+=1){var N,j=p[B],U={u_matrix:j.transform,u_inv_matrix:j.invTransform,u_camera_to_center_distance:(N=n.transform).cameraToCenterDistance,u_viewport_size:[N.width,N.height]};A.draw(u,f.TRIANGLES,t_.disabled,tw.disabled,n.colorModeForRenderPass(),tk.disabled,U,a.id,F,R,r.SegmentVector.simpleSegment(0,2*j.circleOffset,j.circleArray.length,j.circleArray.length/2),null,n.transform.zoom,null,null,null)}F.destroy(),R.destroy()}}var eq=r.identity(new Float32Array(16));function eG(n,i,a,o,s,l,c,u,f,h,p,d){for(var m=n.context,g=m.gl,v=n.transform,y="map"===u,x="map"===f,b=y&&"point"!==a.layout.get("symbol-placement"),_=y&&!x&&!b,w=void 0!==a.layout.get("symbol-sort-key").constantOr(1),T=n.depthModeForSublayer(0,t_.ReadOnly),k=a.layout.get("text-variable-anchor"),A=[],M=0;M<o.length;M+=1){var S=o[M],E=i.getTile(S),L=E.getBucket(a);if(L){var C=s?L.text:L.icon;if(C&&C.segments.get().length){var P,I,O,z=C.programConfigurations.get(a.id),D=s||L.sdfIcons,R=s?L.textSizeData:L.iconSizeData,F=x||0!==v.pitch,B=n.useProgram(L.iconsInText&&s?"symbolTextAndIcon":D?"symbolSDF":"symbolIcon",z),N=r.evaluateSizeForZoom(R,v.zoom),j=void 0,U=[0,0],V=void 0,H=void 0,q=null,G=void 0;if(s){if(V=E.glyphAtlasTexture,H=g.LINEAR,j=E.glyphAtlasTexture.size,L.iconsInText){U=E.imageAtlasTexture.size,q=E.imageAtlasTexture;var Y="composite"===R.kind||"camera"===R.kind;G=F||n.options.rotating||n.options.zooming||Y?g.LINEAR:g.NEAREST}}else{var W=1!==a.layout.get("icon-size").constantOr(0)||L.iconsNeedLinear;V=E.imageAtlasTexture,H=D||n.options.rotating||n.options.zooming||W||F?g.LINEAR:g.NEAREST,j=E.imageAtlasTexture.size}var X=t3(E,1,n.transform.zoom),Z=tq(S.posMatrix,x,y,n.transform,X),J=tG(S.posMatrix,x,y,n.transform,X),K=k&&L.hasTextData(),Q="none"!==a.layout.get("icon-text-fit")&&K&&L.hasIconData();b&&function(n,i,a,o,s,l,c,u){var f=o?n.textSizeData:n.iconSizeData,h=r.evaluateSizeForZoom(f,a.transform.zoom),p=[256/a.width*2+1,256/a.height*2+1],d=o?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;d.clear();for(var m=n.lineVertexArray,g=o?n.text.placedSymbolArray:n.icon.placedSymbolArray,v=a.transform.width/a.transform.height,y=!1,x=0;x<g.length;x++){var b=g.get(x);if(b.hidden||b.writingMode===r.WritingMode.vertical&&!y)t0(b.numGlyphs,d);else{y=!1;var _=[b.anchorX,b.anchorY,0,1];if(r.transformMat4(_,_,i),function(r,n){var i=r[0]/r[3],a=r[1]/r[3];return i>=-n[0]&&i<=n[0]&&a>=-n[1]&&a<=n[1]}(_,p)){var w=_[3],T=tW(a.transform.cameraToCenterDistance,w),k=r.evaluateSizeForFeature(f,h,b),A=c?k/T:k*T,M=new r.Point(b.anchorX,b.anchorY),S=tY(M,s).point,E={},L=tJ(b,A,!1,u,i,s,l,n.glyphOffsetArray,m,d,S,M,E,v);y=L.useVertical,(L.notEnoughRoom||y||L.needsFlipping&&tJ(b,A,!0,u,i,s,l,n.glyphOffsetArray,m,d,S,M,E,v).notEnoughRoom)&&t0(b.numGlyphs,d)}else t0(b.numGlyphs,d)}}o?n.text.dynamicLayoutVertexBuffer.updateData(d):n.icon.dynamicLayoutVertexBuffer.updateData(d)}(L,S.posMatrix,n,s,Z,J,x,h);var $=n.translatePosMatrix(S.posMatrix,E,l,c),tt=b||s&&k||Q?eq:Z,te=n.translatePosMatrix(J,E,l,c,!0),tr=D&&0!==a.paint.get(s?"text-halo-width":"icon-halo-width").constantOr(1),tn={program:B,buffers:C,uniformValues:D?L.iconsInText?(P=R.kind,I=j,O=U,r.extend(ej(P,N,_,x,n,$,tt,te,!0,I,!0),{u_texsize_icon:O,u_texture_icon:1})):ej(R.kind,N,_,x,n,$,tt,te,s,j,!0):eN(R.kind,N,_,x,n,$,tt,te,s,j),atlasTexture:V,atlasTextureIcon:q,atlasInterpolation:H,atlasInterpolationIcon:G,isSDF:D,hasHalo:tr};if(w)for(var ti=0,ta=C.segments.get();ti<ta.length;ti+=1){var to=ta[ti];A.push({segments:new r.SegmentVector([to]),sortKey:to.sortKey,state:tn})}else A.push({segments:C.segments,sortKey:0,state:tn})}}}w&&A.sort(function(r,n){return r.sortKey-n.sortKey});for(var ts=0;ts<A.length;ts+=1){var tl=A[ts],tc=tl.state;if(m.activeTexture.set(g.TEXTURE0),tc.atlasTexture.bind(tc.atlasInterpolation,g.CLAMP_TO_EDGE),tc.atlasTextureIcon&&(m.activeTexture.set(g.TEXTURE1),tc.atlasTextureIcon&&tc.atlasTextureIcon.bind(tc.atlasInterpolationIcon,g.CLAMP_TO_EDGE)),tc.isSDF){var tu=tc.uniformValues;tc.hasHalo&&(tu.u_is_halo=1,eY(tc.buffers,tl.segments,a,n,tc.program,T,p,d,tu)),tu.u_is_halo=0}eY(tc.buffers,tl.segments,a,n,tc.program,T,p,d,tc.uniformValues)}}function eY(r,n,i,a,o,s,l,c,u){var f=a.context,h=f.gl;o.draw(f,h.TRIANGLES,s,l,c,tk.disabled,u,i.id,r.layoutVertexBuffer,r.indexBuffer,n,i.paint,a.transform.zoom,r.programConfigurations.get(i.id),r.dynamicLayoutVertexBuffer,r.opacityVertexBuffer)}function eW(n,i,a,o,s,l,c){var u,f,h,p,d,m=n.context.gl,g=a.paint.get("fill-pattern"),v=g&&g.constantOr(1),y=a.getCrossfadeParameters();c?(f=v&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",u=m.LINES):(f=v?"fillPattern":"fill",u=m.TRIANGLES);for(var x=0;x<o.length;x+=1){var b=o[x],_=i.getTile(b);if(!v||_.patternsLoaded()){var w=_.getBucket(a);if(w){var T=w.programConfigurations.get(a.id),k=n.useProgram(f,T);v&&(n.context.activeTexture.set(m.TEXTURE0),_.imageAtlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE),T.updatePaintBuffers(y));var A=g.constantOr(null);if(A&&_.imageAtlas){var M=_.imageAtlas,S=M.patternPositions[A.to.toString()],E=M.patternPositions[A.from.toString()];S&&E&&T.setConstantPatternPositions(S,E)}var L=n.translatePosMatrix(b.posMatrix,_,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(c){p=w.indexBuffer2,d=w.segments2;var C=[m.drawingBufferWidth,m.drawingBufferHeight];h="fillOutlinePattern"===f&&v?r.extend(eS(L,n,y,_),{u_world:C}):{u_matrix:L,u_world:C}}else p=w.indexBuffer,d=w.segments,h=v?eS(L,n,y,_):eM(L);k.draw(n.context,u,s,n.stencilModeForClipping(b),l,tk.disabled,h,a.id,w.layoutVertexBuffer,p,d,a.paint,n.transform.zoom,T)}}}}function eX(n,i,a,o,s,l,c){for(var u=n.context,f=u.gl,h=a.paint.get("fill-extrusion-pattern"),p=h.constantOr(1),d=a.getCrossfadeParameters(),m=a.paint.get("fill-extrusion-opacity"),g=0;g<o.length;g+=1){var v=o[g],y=i.getTile(v),x=y.getBucket(a);if(x){var b=x.programConfigurations.get(a.id),_=n.useProgram(p?"fillExtrusionPattern":"fillExtrusion",b);p&&(n.context.activeTexture.set(f.TEXTURE0),y.imageAtlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),b.updatePaintBuffers(d));var w=h.constantOr(null);if(w&&y.imageAtlas){var T=y.imageAtlas,k=T.patternPositions[w.to.toString()],A=T.patternPositions[w.from.toString()];k&&A&&b.setConstantPatternPositions(k,A)}var M=n.translatePosMatrix(v.posMatrix,y,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),S=a.paint.get("fill-extrusion-vertical-gradient"),E=p?r.extend(eA(M,n,S,m),ek(d,n,y),{u_height_factor:-Math.pow(2,v.overscaledZ)/y.tileSize/8}):eA(M,n,S,m);_.draw(u,u.gl.TRIANGLES,s,l,c,tk.backCCW,E,a.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,a.paint,n.transform.zoom,b)}}}var eZ=new r.Color(1,0,0,1),eJ=new r.Color(0,1,0,1),eK=new r.Color(0,0,1,1),eQ=new r.Color(1,0,1,1),e$=new r.Color(0,1,1,1);function e0(r,n,i,a){e2(r,0,n+i/2,r.transform.width,i,a)}function e1(r,n,i,a){e2(r,n-i/2,0,i,r.transform.height,a)}function e2(n,i,a,o,s,l){var c=n.context,u=c.gl;u.enable(u.SCISSOR_TEST),u.scissor(i*r.browser.devicePixelRatio,a*r.browser.devicePixelRatio,o*r.browser.devicePixelRatio,s*r.browser.devicePixelRatio),c.clear({color:l}),u.disable(u.SCISSOR_TEST)}var e3={symbol:function(n,i,a,o,s){if("translucent"===n.renderPass){var l=tw.disabled,c=n.colorModeForRenderPass();a.layout.get("text-variable-anchor")&&function(n,i,a,o,s,l,c){for(var u=i.transform,f="map"===s,h="map"===l,p=0;p<n.length;p+=1){var d=n[p],m=o.getTile(d),g=m.getBucket(a);if(g&&g.text&&g.text.segments.get().length){var v=g.textSizeData,y=r.evaluateSizeForZoom(v,u.zoom),x=t3(m,1,i.transform.zoom),b=tq(d.posMatrix,h,f,i.transform,x),_="none"!==a.layout.get("icon-text-fit")&&g.hasIconData();if(y){var w=Math.pow(2,u.zoom-m.tileID.overscaledZ);(function(n,i,a,o,s,l,c,u,f,h,p){var d=n.text.placedSymbolArray,m=n.text.dynamicLayoutVertexArray,g=n.icon.dynamicLayoutVertexArray,v={};m.clear();for(var y=0;y<d.length;y++){var x=d.get(y),b=n.allowVerticalPlacement&&!x.placedOrientation,_=x.hidden||!x.crossTileID||b?null:o[x.crossTileID];if(_){var w=new r.Point(x.anchorX,x.anchorY),T=tY(w,a?u:c),k=tW(l.cameraToCenterDistance,T.signedDistanceFromCamera),A=s.evaluateSizeForFeature(n.textSizeData,h,x)*k/r.ONE_EM;a&&(A*=n.tilePixelRatio/f);for(var M=_.width,S=_.height,E=function(n,i,a,o,s,l){var c=r.getAnchorAlignment(n),u=-(c.horizontalAlign-.5)*i,f=-(c.verticalAlign-.5)*a,h=r.evaluateVariableOffset(n,o);return new r.Point((u/s+h[0])*l,(f/s+h[1])*l)}(_.anchor,M,S,_.textOffset,_.textBoxScale,A),L=a?tY(w.add(E),c).point:T.point.add(i?E.rotate(-l.angle):E),C=n.allowVerticalPlacement&&x.placedOrientation===r.WritingMode.vertical?Math.PI/2:0,P=0;P<x.numGlyphs;P++)r.addDynamicAttributes(m,L,C);p&&x.associatedIconIndex>=0&&(v[x.associatedIconIndex]={shiftedAnchor:L,angle:C})}else t0(x.numGlyphs,m)}if(p){g.clear();for(var I=n.icon.placedSymbolArray,O=0;O<I.length;O++){var z=I.get(O);if(z.hidden)t0(z.numGlyphs,g);else{var D=v[O];if(D)for(var R=0;R<z.numGlyphs;R++)r.addDynamicAttributes(g,D.shiftedAnchor,D.angle);else t0(z.numGlyphs,g)}}n.icon.dynamicLayoutVertexBuffer.updateData(g)}n.text.dynamicLayoutVertexBuffer.updateData(m)})(g,f,h,c,r.symbolSize,u,b,d.posMatrix,w,y,_)}}}}(o,n,a,i,a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),s),0!==a.paint.get("icon-opacity").constantOr(1)&&eG(n,i,a,o,!1,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),a.layout.get("icon-rotation-alignment"),a.layout.get("icon-pitch-alignment"),a.layout.get("icon-keep-upright"),l,c),0!==a.paint.get("text-opacity").constantOr(1)&&eG(n,i,a,o,!0,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),a.layout.get("text-keep-upright"),l,c),i.map.showCollisionBoxes&&(eH(n,i,a,o,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),!0),eH(n,i,a,o,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),!1))}},circle:function(n,i,a,o){if("translucent"===n.renderPass){var s=a.paint.get("circle-opacity"),l=a.paint.get("circle-stroke-width"),c=a.paint.get("circle-stroke-opacity"),u=void 0!==a.layout.get("circle-sort-key").constantOr(1);if(0!==s.constantOr(1)||0!==l.constantOr(1)&&0!==c.constantOr(1)){for(var f=n.context,h=f.gl,p=n.depthModeForSublayer(0,t_.ReadOnly),d=tw.disabled,m=n.colorModeForRenderPass(),g=[],v=0;v<o.length;v++){var y=o[v],x=i.getTile(y),b=x.getBucket(a);if(b){var _=b.programConfigurations.get(a.id),w={programConfiguration:_,program:n.useProgram("circle",_),layoutVertexBuffer:b.layoutVertexBuffer,indexBuffer:b.indexBuffer,uniformValues:eE(n,y,x,a)};if(u)for(var T=0,k=b.segments.get();T<k.length;T+=1){var A=k[T];g.push({segments:new r.SegmentVector([A]),sortKey:A.sortKey,state:w})}else g.push({segments:b.segments,sortKey:0,state:w})}}u&&g.sort(function(r,n){return r.sortKey-n.sortKey});for(var M=0;M<g.length;M+=1){var S=g[M],E=S.state,L=E.programConfiguration,C=E.program,P=E.layoutVertexBuffer,I=E.indexBuffer,O=E.uniformValues,z=S.segments;C.draw(f,h.TRIANGLES,p,d,m,tk.disabled,O,a.id,P,I,z,a.paint,n.transform.zoom,L)}}}},heatmap:function(n,i,a,o){if(0!==a.paint.get("heatmap-opacity")){if("offscreen"===n.renderPass){var s=n.context,l=s.gl,c=tw.disabled,u=new tT([l.ONE,l.ONE],r.Color.transparent,[!0,!0,!0,!0]);(function(r,n,i){var a=r.gl;r.activeTexture.set(a.TEXTURE1),r.viewport.set([0,0,n.width/4,n.height/4]);var o=i.heatmapFbo;if(o)a.bindTexture(a.TEXTURE_2D,o.colorAttachment.get()),r.bindFramebuffer.set(o.framebuffer);else{var s,l,c,u=a.createTexture();a.bindTexture(a.TEXTURE_2D,u),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),s=o=i.heatmapFbo=r.createFramebuffer(n.width/4,n.height/4,!1),l=r.gl,c=r.extRenderToTextureHalfFloat?r.extTextureHalfFloat.HALF_FLOAT_OES:l.UNSIGNED_BYTE,l.texImage2D(l.TEXTURE_2D,0,l.RGBA,n.width/4,n.height/4,0,l.RGBA,c,null),s.colorAttachment.set(u)}})(s,n,a),s.clear({color:r.Color.transparent});for(var f=0;f<o.length;f++){var h=o[f];if(!i.hasRenderableParent(h)){var p=i.getTile(h),d=p.getBucket(a);if(d){var m,g,v=d.programConfigurations.get(a.id),y=n.useProgram("heatmap",v),x=n.transform.zoom;y.draw(s,l.TRIANGLES,t_.disabled,c,u,tk.disabled,(m=h.posMatrix,g=a.paint.get("heatmap-intensity"),{u_matrix:m,u_extrude_scale:t3(p,1,x),u_intensity:g}),a.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,a.paint,n.transform.zoom,v)}}}s.viewport.set([0,0,n.width,n.height])}else"translucent"===n.renderPass&&(n.context.setColorMode(n.colorModeForRenderPass()),function(n,i){var a=n.context,o=a.gl,s=i.heatmapFbo;if(s){a.activeTexture.set(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,s.colorAttachment.get()),a.activeTexture.set(o.TEXTURE1);var l,c,u=i.colorRampTexture;u||(u=i.colorRampTexture=new r.Texture(a,i.colorRamp,o.RGBA)),u.bind(o.LINEAR,o.CLAMP_TO_EDGE),n.useProgram("heatmapTexture").draw(a,o.TRIANGLES,t_.disabled,tw.disabled,n.colorModeForRenderPass(),tk.disabled,(l=r.create(),r.ortho(l,0,n.width,n.height,0,0,1),{u_matrix:l,u_world:[(c=n.context.gl).drawingBufferWidth,c.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:i.paint.get("heatmap-opacity")}),i.id,n.viewportBuffer,n.quadTriangleIndexBuffer,n.viewportSegments,i.paint,n.transform.zoom)}}(n,a))}},line:function(n,i,a,o){if("translucent"===n.renderPass){var s=a.paint.get("line-opacity"),l=a.paint.get("line-width");if(0!==s.constantOr(1)&&0!==l.constantOr(1)){var c=n.depthModeForSublayer(0,t_.ReadOnly),u=n.colorModeForRenderPass(),f=a.paint.get("line-dasharray"),h=a.paint.get("line-pattern"),p=h.constantOr(1),d=a.paint.get("line-gradient"),m=a.getCrossfadeParameters(),g=p?"linePattern":f?"lineSDF":d?"lineGradient":"line",v=n.context,y=v.gl,x=!0;if(d){v.activeTexture.set(y.TEXTURE0);var b=a.gradientTexture;if(!a.gradient)return;b||(b=a.gradientTexture=new r.Texture(v,a.gradient,y.RGBA)),b.bind(y.LINEAR,y.CLAMP_TO_EDGE)}for(var _=0;_<o.length;_+=1){var w=o[_],T=i.getTile(w);if(!p||T.patternsLoaded()){var k=T.getBucket(a);if(k){var A=k.programConfigurations.get(a.id),M=n.context.program.get(),S=n.useProgram(g,A),E=x||S.program!==M,L=h.constantOr(null);if(L&&T.imageAtlas){var C=T.imageAtlas,P=C.patternPositions[L.to.toString()],I=C.patternPositions[L.from.toString()];P&&I&&A.setConstantPatternPositions(P,I)}var O=p?eO(n,T,a,m):f?ez(n,T,a,f,m):d?r.extend(eI(n,T,a),{u_image:0}):eI(n,T,a);p?(v.activeTexture.set(y.TEXTURE0),T.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),A.updatePaintBuffers(m)):f&&(E||n.lineAtlas.dirty)&&(v.activeTexture.set(y.TEXTURE0),n.lineAtlas.bind(v)),S.draw(v,y.TRIANGLES,c,n.stencilModeForClipping(w),u,tk.disabled,O,a.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,a.paint,n.transform.zoom,A),x=!1}}}}}},fill:function(n,i,a,o){var s=a.paint.get("fill-color"),l=a.paint.get("fill-opacity");if(0!==l.constantOr(1)){var c=n.colorModeForRenderPass(),u=a.paint.get("fill-pattern"),f=n.opaquePassEnabledForLayer()&&!u.constantOr(1)&&1===s.constantOr(r.Color.transparent).a&&1===l.constantOr(0)?"opaque":"translucent";if(n.renderPass===f){var h=n.depthModeForSublayer(1,"opaque"===n.renderPass?t_.ReadWrite:t_.ReadOnly);eW(n,i,a,o,h,c,!1)}if("translucent"===n.renderPass&&a.paint.get("fill-antialias")){var p=n.depthModeForSublayer(a.getPaintProperty("fill-outline-color")?2:0,t_.ReadOnly);eW(n,i,a,o,p,c,!0)}}},"fill-extrusion":function(r,n,i,a){var o=i.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===r.renderPass){var s=new t_(r.context.gl.LEQUAL,t_.ReadWrite,r.depthRangeFor3D);if(1!==o||i.paint.get("fill-extrusion-pattern").constantOr(1))eX(r,n,i,a,s,tw.disabled,tT.disabled),eX(r,n,i,a,s,r.stencilModeFor3D(),r.colorModeForRenderPass());else{var l=r.colorModeForRenderPass();eX(r,n,i,a,s,tw.disabled,l)}}},hillshade:function(n,i,a,o){if("offscreen"===n.renderPass||"translucent"===n.renderPass){for(var s=n.context,l=i.getSource().maxzoom,c=n.depthModeForSublayer(0,t_.ReadOnly),u=n.colorModeForRenderPass(),f="translucent"===n.renderPass?n.stencilConfigForOverlap(o):[{},o],h=f[0],p=0,d=f[1];p<d.length;p+=1){var m=d[p],g=i.getTile(m);g.needsHillshadePrepare&&"offscreen"===n.renderPass?function(n,i,a,o,s,l,c){var u=n.context,f=u.gl,h=i.dem;if(h&&h.data){var p,d,m,g=h.dim,v=h.stride,y=h.getPixels();if(u.activeTexture.set(f.TEXTURE1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||n.getTileTexture(v),i.demTexture){var x=i.demTexture;x.update(y,{premultiply:!1}),x.bind(f.NEAREST,f.CLAMP_TO_EDGE)}else i.demTexture=new r.Texture(u,y,f.RGBA,{premultiply:!1}),i.demTexture.bind(f.NEAREST,f.CLAMP_TO_EDGE);u.activeTexture.set(f.TEXTURE0);var b=i.fbo;if(!b){var _=new r.Texture(u,{width:g,height:g,data:null},f.RGBA);_.bind(f.LINEAR,f.CLAMP_TO_EDGE),(b=i.fbo=u.createFramebuffer(g,g,!0)).colorAttachment.set(_.texture)}u.bindFramebuffer.set(b.framebuffer),u.viewport.set([0,0,g,g]),n.useProgram("hillshadePrepare").draw(u,f.TRIANGLES,s,l,c,tk.disabled,(p=i.tileID,d=h.stride,m=r.create(),r.ortho(m,0,r.EXTENT,-r.EXTENT,0,0,1),r.translate(m,m,[0,-r.EXTENT,0]),{u_matrix:m,u_image:1,u_dimension:[d,d],u_zoom:p.overscaledZ,u_maxzoom:o,u_unpack:h.getUnpackVector()}),a.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),i.needsHillshadePrepare=!1}}(n,g,a,l,c,tw.disabled,u):"translucent"===n.renderPass&&function(n,i,a,o,s,l){var c=n.context,u=c.gl,f=i.fbo;if(f){var h,p,d,m,g,v,y,x,b=n.useProgram("hillshade");c.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,f.colorAttachment.get());var _=(h=a.paint.get("hillshade-shadow-color"),p=a.paint.get("hillshade-highlight-color"),d=a.paint.get("hillshade-accent-color"),m=a.paint.get("hillshade-illumination-direction")*(Math.PI/180),"viewport"===a.paint.get("hillshade-illumination-anchor")&&(m-=n.transform.angle),g=!n.options.moving,{u_matrix:n.transform.calculatePosMatrix(i.tileID.toUnwrapped(),g),u_image:0,u_latrange:(y=Math.pow(2,(v=i.tileID).canonical.z),x=v.canonical.y,[new r.MercatorCoordinate(0,x/y).toLngLat().lat,new r.MercatorCoordinate(0,(x+1)/y).toLngLat().lat]),u_light:[a.paint.get("hillshade-exaggeration"),m],u_shadow:h,u_highlight:p,u_accent:d});b.draw(c,u.TRIANGLES,o,s,l,tk.disabled,_,a.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}(n,g,a,c,h[m.overscaledZ],u)}s.viewport.set([0,0,n.width,n.height])}},raster:function(n,i,a,o){if("translucent"===n.renderPass&&0!==a.paint.get("raster-opacity")&&o.length)for(var s=n.context,l=s.gl,c=i.getSource(),u=n.useProgram("raster"),f=n.colorModeForRenderPass(),h=c instanceof C?[{},o]:n.stencilConfigForOverlap(o),p=h[0],d=h[1],m=d[d.length-1].overscaledZ,g=!n.options.moving,v=0;v<d.length;v+=1){var y=d[v],x=n.depthModeForSublayer(y.overscaledZ-m,1===a.paint.get("raster-opacity")?t_.ReadWrite:t_.ReadOnly,l.LESS),b=i.getTile(y),_=n.transform.calculatePosMatrix(y.toUnwrapped(),g);b.registerFadeDuration(a.paint.get("raster-fade-duration"));var w=i.findLoadedParent(y,0),T=function(n,i,a,o,s){var l=o.paint.get("raster-fade-duration");if(l>0){var c=r.browser.now(),u=(c-n.timeAdded)/l,f=i?(c-i.timeAdded)/l:-1,h=a.getSource(),p=s.coveringZoomLevel({tileSize:h.tileSize,roundZoom:h.roundZoom}),d=!i||Math.abs(i.tileID.overscaledZ-p)>Math.abs(n.tileID.overscaledZ-p),m=d&&n.refreshedUponExpiration?1:r.clamp(d?u:1-f,0,1);return n.refreshedUponExpiration&&u>=1&&(n.refreshedUponExpiration=!1),i?{opacity:1,mix:1-m}:{opacity:m,mix:0}}return{opacity:1,mix:0}}(b,w,i,a,n.transform),k=void 0,A=void 0,M="nearest"===a.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;s.activeTexture.set(l.TEXTURE0),b.texture.bind(M,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),s.activeTexture.set(l.TEXTURE1),w?(w.texture.bind(M,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),k=Math.pow(2,w.tileID.overscaledZ-b.tileID.overscaledZ),A=[b.tileID.canonical.x*k%1,b.tileID.canonical.y*k%1]):b.texture.bind(M,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST);var S=eB(_,A||[0,0],k||1,T,a);c instanceof C?u.draw(s,l.TRIANGLES,x,tw.disabled,f,tk.disabled,S,a.id,c.boundsBuffer,n.quadTriangleIndexBuffer,c.boundsSegments):u.draw(s,l.TRIANGLES,x,p[y.overscaledZ],f,tk.disabled,S,a.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(r,n,i){var a=i.paint.get("background-color"),o=i.paint.get("background-opacity");if(0!==o){var s=r.context,l=s.gl,c=r.transform,u=c.tileSize,f=i.paint.get("background-pattern");if(!r.isPatternMissing(f)){var h=!f&&1===a.a&&1===o&&r.opaquePassEnabledForLayer()?"opaque":"translucent";if(r.renderPass===h){var p=tw.disabled,d=r.depthModeForSublayer(0,"opaque"===h?t_.ReadWrite:t_.ReadOnly),m=r.colorModeForRenderPass(),g=r.useProgram(f?"backgroundPattern":"background"),v=c.coveringTiles({tileSize:u});f&&(s.activeTexture.set(l.TEXTURE0),r.imageManager.bind(r.context));for(var y=i.getCrossfadeParameters(),x=0;x<v.length;x+=1){var b=v[x],_=r.transform.calculatePosMatrix(b.toUnwrapped()),w=f?eU(_,o,r,f,{tileID:b,tileSize:u},y):{u_matrix:_,u_opacity:o,u_color:a};g.draw(s,l.TRIANGLES,d,p,m,tk.disabled,w,i.id,r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments)}}}}},debug:function(n,i,a){for(var o=0;o<a.length;o++)(function(n,i,a){var o=n.context,s=o.gl,l=a.posMatrix,c=n.useProgram("debug"),u=t_.disabled,f=tw.disabled,h=n.colorModeForRenderPass();o.activeTexture.set(s.TEXTURE0),n.emptyTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),c.draw(o,s.LINE_STRIP,u,f,h,tk.disabled,eC(l,r.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var p=i.getTileByID(a.key).latestRawTileData,d=Math.floor((p&&p.byteLength||0)/1024),m=512/Math.min(i.getTile(a).tileSize,512)*(a.overscaledZ/n.transform.zoom)*.5,g=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(g+=" => "+a.overscaledZ),function(r,n){r.initDebugOverlayCanvas();var i=r.debugOverlayCanvas,a=r.context.gl,o=r.debugOverlayCanvas.getContext("2d");o.clearRect(0,0,i.width,i.height),o.shadowColor="white",o.shadowBlur=2,o.lineWidth=1.5,o.strokeStyle="white",o.textBaseline="top",o.font="bold 36px Open Sans, sans-serif",o.fillText(n,5,5),o.strokeText(n,5,5),r.debugOverlayTexture.update(i),r.debugOverlayTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}(n,g+" "+d+"kb"),c.draw(o,s.TRIANGLES,u,f,tT.alphaBlended,tk.disabled,eC(l,r.Color.transparent,m),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)})(n,i,a[o])},custom:function(r,n,i){var a=r.context,o=i.implementation;if("offscreen"===r.renderPass){var s=o.prerender;s&&(r.setCustomLayerDefaults(),a.setColorMode(r.colorModeForRenderPass()),s.call(o,a.gl,r.transform.customLayerMatrix()),a.setDirty(),r.setBaseState())}else if("translucent"===r.renderPass){r.setCustomLayerDefaults(),a.setColorMode(r.colorModeForRenderPass()),a.setStencilMode(tw.disabled);var l="3d"===o.renderingMode?new t_(r.context.gl.LEQUAL,t_.ReadWrite,r.depthRangeFor3D):r.depthModeForSublayer(0,t_.ReadOnly);a.setDepthMode(l),o.render(a.gl,r.transform.customLayerMatrix()),a.setDirty(),r.setBaseState(),a.bindFramebuffer.set(null)}}},e5=function(r,n){this.context=new tA(r),this.transform=n,this._tileTextures={},this.setup(),this.numSublayers=tM.maxUnderzooming+tM.maxOverzooming+1,this.depthEpsilon=1/65536,this.crossTileSymbolIndex=new eh,this.gpuTimers={}};e5.prototype.resize=function(n,i){if(this.width=n*r.browser.devicePixelRatio,this.height=i*r.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var a=0,o=this.style._order;a<o.length;a+=1){var s=o[a];this.style._layers[s].resize()}},e5.prototype.setup=function(){var n=this.context,i=new r.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(r.EXTENT,0),i.emplaceBack(0,r.EXTENT),i.emplaceBack(r.EXTENT,r.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(i,ey.members),this.tileExtentSegments=r.SegmentVector.simpleSegment(0,0,4,2);var a=new r.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(r.EXTENT,0),a.emplaceBack(0,r.EXTENT),a.emplaceBack(r.EXTENT,r.EXTENT),this.debugBuffer=n.createVertexBuffer(a,ey.members),this.debugSegments=r.SegmentVector.simpleSegment(0,0,4,5);var o=new r.StructArrayLayout4i8;o.emplaceBack(0,0,0,0),o.emplaceBack(r.EXTENT,0,r.EXTENT,0),o.emplaceBack(0,r.EXTENT,0,r.EXTENT),o.emplaceBack(r.EXTENT,r.EXTENT,r.EXTENT,r.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(o,L.members),this.rasterBoundsSegments=r.SegmentVector.simpleSegment(0,0,4,2);var s=new r.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(1,0),s.emplaceBack(0,1),s.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(s,ey.members),this.viewportSegments=r.SegmentVector.simpleSegment(0,0,4,2);var l=new r.StructArrayLayout1ui2;l.emplaceBack(0),l.emplaceBack(1),l.emplaceBack(3),l.emplaceBack(2),l.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(l);var c=new r.StructArrayLayout3ui6;c.emplaceBack(0,1,2),c.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(c),this.emptyTexture=new r.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var u=this.context.gl;this.stencilClearMode=new tw({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)},e5.prototype.clearStencil=function(){var n=this.context,i=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var a=r.create();r.ortho(a,0,this.width,this.height,0,0,1),r.scale(a,a,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,i.TRIANGLES,t_.disabled,this.stencilClearMode,tT.disabled,tk.disabled,eP(a),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},e5.prototype._renderTileClippingMasks=function(r,n){if(this.currentStencilSource!==r.source&&r.isTileClipped()&&n&&n.length){this.currentStencilSource=r.source;var i=this.context,a=i.gl;this.nextStencilID+n.length>256&&this.clearStencil(),i.setColorMode(tT.disabled),i.setDepthMode(t_.disabled);var o=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var s=0;s<n.length;s+=1){var l=n[s],c=this._tileClippingMaskIDs[l.key]=this.nextStencilID++;o.draw(i,a.TRIANGLES,t_.disabled,new tw({func:a.ALWAYS,mask:0},c,255,a.KEEP,a.KEEP,a.REPLACE),tT.disabled,tk.disabled,eP(l.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},e5.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var r=this.nextStencilID++,n=this.context.gl;return new tw({func:n.NOTEQUAL,mask:255},r,255,n.KEEP,n.KEEP,n.REPLACE)},e5.prototype.stencilModeForClipping=function(r){var n=this.context.gl;return new tw({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,n.KEEP,n.KEEP,n.REPLACE)},e5.prototype.stencilConfigForOverlap=function(r){var n,i=this.context.gl,a=r.sort(function(r,n){return n.overscaledZ-r.overscaledZ}),o=a[a.length-1].overscaledZ,s=a[0].overscaledZ-o+1;if(s>1){this.currentStencilSource=void 0,this.nextStencilID+s>256&&this.clearStencil();for(var l={},c=0;c<s;c++)l[c+o]=new tw({func:i.GEQUAL,mask:255},c+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=s,[l,a]}return[((n={})[o]=tw.disabled,n),a]},e5.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new tT([n.CONSTANT_COLOR,n.ONE],new r.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?tT.unblended:tT.alphaBlended},e5.prototype.depthModeForSublayer=function(r,n,i){if(!this.opaquePassEnabledForLayer())return t_.disabled;var a=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new t_(i||this.context.gl.LEQUAL,n,[a,a])},e5.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},e5.prototype.render=function(n,i){var a,o,s,l,c=this;this.style=n,this.options=i,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(r.browser.now()),this.imageManager.beginFrame();var u=this.style._order,f=this.style.sourceCaches;for(var h in f){var p=f[h];p.used&&p.prepare(this.context)}var d,m,g={},v={},y={};for(var x in f){var b=f[x];g[x]=b.getVisibleCoordinates(),v[x]=g[x].slice().reverse(),y[x]=b.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var _=0;_<u.length;_++){var w=u[_];if(this.style._layers[w].is3D()){this.opaquePassCutoff=_;break}}this.renderPass="offscreen";for(var T=0;T<u.length;T+=1){var k=u[T],A=this.style._layers[k];if(A.hasOffscreenPass()&&!A.isHidden(this.transform.zoom)){var M=v[A.source];("custom"===A.type||M.length)&&this.renderLayer(this,f[A.source],A,M)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?r.Color.black:r.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){var S=this.style._layers[u[this.currentLayer]],E=f[S.source],L=g[S.source];this._renderTileClippingMasks(S,L),this.renderLayer(this,E,S,L)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){var C=this.style._layers[u[this.currentLayer]],P=f[C.source],I=("symbol"===C.type?y:v)[C.source];this._renderTileClippingMasks(C,g[C.source]),this.renderLayer(this,P,C,I)}this.options.showTileBoundaries&&(r.values(this.style._layers).forEach(function(r){r.source&&!r.isHidden(c.transform.zoom)&&(r.source!==(m&&m.id)&&(m=c.style.sourceCaches[r.source]),(!d||d.getSource().maxzoom<m.getSource().maxzoom)&&(d=m))}),d&&e3.debug(this,d,d.getVisibleCoordinates())),this.options.showPadding&&(a=this.transform.padding,e0(this,this.transform.height-(a.top||0),3,eZ),e0(this,a.bottom||0,3,eJ),e1(this,a.left||0,3,eK),e1(this,this.transform.width-(a.right||0),3,eQ),e2(this,(s=(o=this.transform.centerPoint).x)-1,(l=this.transform.height-o.y)-10,2,20,e$),e2(this,s-10,l-1,20,2,e$)),this.context.setDefault()},e5.prototype.renderLayer=function(r,n,i,a){i.isHidden(this.transform.zoom)||("background"===i.type||"custom"===i.type||a.length)&&(this.id=i.id,this.gpuTimingStart(i),e3[i.type](r,n,i,a,this.style.placement.variableOffsets),this.gpuTimingEnd())},e5.prototype.gpuTimingStart=function(r){if(this.options.gpuTiming){var n=this.context.extTimerQuery,i=this.gpuTimers[r.id];i||(i=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:n.createQueryEXT()}),i.calls++,n.beginQueryEXT(n.TIME_ELAPSED_EXT,i.query)}},e5.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}},e5.prototype.collectGpuTimers=function(){var r=this.gpuTimers;return this.gpuTimers={},r},e5.prototype.queryGpuTimers=function(r){var n={};for(var i in r){var a=r[i],o=this.context.extTimerQuery,s=o.getQueryObjectEXT(a.query,o.QUERY_RESULT_EXT)/1e6;o.deleteQueryEXT(a.query),n[i]=s}return n},e5.prototype.translatePosMatrix=function(n,i,a,o,s){if(!a[0]&&!a[1])return n;var l=s?"map"===o?this.transform.angle:0:"viewport"===o?-this.transform.angle:0;if(l){var c=Math.sin(l),u=Math.cos(l);a=[a[0]*u-a[1]*c,a[0]*c+a[1]*u]}var f=[s?a[0]:t3(i,a[0],this.transform.zoom),s?a[1]:t3(i,a[1],this.transform.zoom),0],h=new Float32Array(16);return r.translate(h,n,f),h},e5.prototype.saveTileTexture=function(r){var n=this._tileTextures[r.size[0]];n?n.push(r):this._tileTextures[r.size[0]]=[r]},e5.prototype.getTileTexture=function(r){var n=this._tileTextures[r];return n&&n.length>0?n.pop():null},e5.prototype.isPatternMissing=function(r){if(!r)return!1;if(!r.from||!r.to)return!0;var n=this.imageManager.getPattern(r.from.toString()),i=this.imageManager.getPattern(r.to.toString());return!n||!i},e5.prototype.useProgram=function(r,n){this.cache=this.cache||{};var i=""+r+(n?n.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[i]||(this.cache[i]=new eT(this.context,e_[r],n,eV[r],this._showOverdrawInspector)),this.cache[i]},e5.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},e5.prototype.setBaseState=function(){var r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)},e5.prototype.initDebugOverlayCanvas=function(){if(null==this.debugOverlayCanvas){this.debugOverlayCanvas=r.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var n=this.context.gl;this.debugOverlayTexture=new r.Texture(this.context,this.debugOverlayCanvas,n.RGBA)}},e5.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var e4=function(r,n){this.points=r,this.planes=n};e4.fromInvProjectionMatrix=function(n,i,a){var o=Math.pow(2,a),s=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(i){return r.transformMat4([],i,n)}).map(function(n){return r.scale$1([],n,1/n[3]/i*o)}),l=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(n){var i=r.sub([],s[n[0]],s[n[1]]),a=r.sub([],s[n[2]],s[n[1]]),o=r.normalize([],r.cross([],i,a)),l=-r.dot(o,s[n[1]]);return o.concat(l)});return new e4(s,l)};var e6=function(n,i){this.min=n,this.max=i,this.center=r.scale$2([],r.add([],this.min,this.max),.5)};e6.prototype.quadrant=function(n){for(var i=[n%2==0,n<2],a=r.clone$2(this.min),o=r.clone$2(this.max),s=0;s<i.length;s++)a[s]=i[s]?this.min[s]:this.center[s],o[s]=i[s]?this.center[s]:this.max[s];return o[2]=this.max[2],new e6(a,o)},e6.prototype.distanceX=function(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]},e6.prototype.distanceY=function(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]},e6.prototype.intersects=function(n){for(var i=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],a=!0,o=0;o<n.planes.length;o++){for(var s=n.planes[o],l=0,c=0;c<i.length;c++)l+=r.dot$1(s,i[c])>=0;if(0===l)return 0;l!==i.length&&(a=!1)}if(a)return 2;for(var u=0;u<3;u++){for(var f=Number.MAX_VALUE,h=-Number.MAX_VALUE,p=0;p<n.points.length;p++){var d=n.points[p][u]-this.min[u];f=Math.min(f,d),h=Math.max(h,d)}if(h<0||f>this.max[u]-this.min[u])return 0}return 1};var e8=function(r,n,i,a){if(void 0===r&&(r=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===a&&(a=0),isNaN(r)||r<0||isNaN(n)||n<0||isNaN(i)||i<0||isNaN(a)||a<0)throw Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=n,this.left=i,this.right=a};e8.prototype.interpolate=function(n,i,a){return null!=i.top&&null!=n.top&&(this.top=r.number(n.top,i.top,a)),null!=i.bottom&&null!=n.bottom&&(this.bottom=r.number(n.bottom,i.bottom,a)),null!=i.left&&null!=n.left&&(this.left=r.number(n.left,i.left,a)),null!=i.right&&null!=n.right&&(this.right=r.number(n.right,i.right,a)),this},e8.prototype.getCenter=function(n,i){var a=r.clamp((this.left+n-this.right)/2,0,n),o=r.clamp((this.top+i-this.bottom)/2,0,i);return new r.Point(a,o)},e8.prototype.equals=function(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right},e8.prototype.clone=function(){return new e8(this.top,this.bottom,this.left,this.right)},e8.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var e9=function(n,i,a,o,s){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===s||s,this._minZoom=n||0,this._maxZoom=i||22,this._minPitch=null==a?0:a,this._maxPitch=null==o?60:o,this.setMaxBounds(),this.width=0,this.height=0,this._center=new r.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new e8,this._posMatrixCache={},this._alignedPosMatrixCache={}},e7={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};e9.prototype.clone=function(){var r=new e9(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.tileSize=this.tileSize,r.latRange=this.latRange,r.width=this.width,r.height=this.height,r._center=this._center,r.zoom=this.zoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._calcMatrices(),r},e7.minZoom.get=function(){return this._minZoom},e7.minZoom.set=function(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))},e7.maxZoom.get=function(){return this._maxZoom},e7.maxZoom.set=function(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))},e7.minPitch.get=function(){return this._minPitch},e7.minPitch.set=function(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))},e7.maxPitch.get=function(){return this._maxPitch},e7.maxPitch.set=function(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))},e7.renderWorldCopies.get=function(){return this._renderWorldCopies},e7.renderWorldCopies.set=function(r){void 0===r?r=!0:null===r&&(r=!1),this._renderWorldCopies=r},e7.worldSize.get=function(){return this.tileSize*this.scale},e7.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},e7.size.get=function(){return new r.Point(this.width,this.height)},e7.bearing.get=function(){return-this.angle/Math.PI*180},e7.bearing.set=function(n){var i=-r.wrap(n,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=r.create$2(),r.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},e7.pitch.get=function(){return this._pitch/Math.PI*180},e7.pitch.set=function(n){var i=r.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())},e7.fov.get=function(){return this._fov/Math.PI*180},e7.fov.set=function(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())},e7.zoom.get=function(){return this._zoom},e7.zoom.set=function(r){var n=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom,this._constrain(),this._calcMatrices())},e7.center.get=function(){return this._center},e7.center.set=function(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())},e7.padding.get=function(){return this._edgeInsets.toJSON()},e7.padding.set=function(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())},e7.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},e9.prototype.isPaddingEqual=function(r){return this._edgeInsets.equals(r)},e9.prototype.interpolatePadding=function(r,n,i){this._unmodified=!1,this._edgeInsets.interpolate(r,n,i),this._constrain(),this._calcMatrices()},e9.prototype.coveringZoomLevel=function(r){return Math.max(0,(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize)))},e9.prototype.getVisibleUnwrappedCoordinates=function(n){var i=[new r.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var a=this.pointCoordinate(new r.Point(0,0)),o=this.pointCoordinate(new r.Point(this.width,0)),s=this.pointCoordinate(new r.Point(this.width,this.height)),l=this.pointCoordinate(new r.Point(0,this.height)),c=Math.floor(Math.min(a.x,o.x,s.x,l.x)),u=Math.floor(Math.max(a.x,o.x,s.x,l.x)),f=c-1;f<=u+1;f++)0!==f&&i.push(new r.UnwrappedTileID(f,n));return i},e9.prototype.coveringTiles=function(n){var i=this.coveringZoomLevel(n),a=i;if(void 0!==n.minzoom&&i<n.minzoom)return[];void 0!==n.maxzoom&&i>n.maxzoom&&(i=n.maxzoom);var o=r.MercatorCoordinate.fromLngLat(this.center),s=Math.pow(2,i),l=[s*o.x,s*o.y,0],c=e4.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i),u=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(u=i);var f=function(r){return{aabb:new e6([r*s,0,0],[(r+1)*s,s,0]),zoom:0,x:0,y:0,wrap:r,fullyVisible:!1}},h=[],p=[],d=i,m=n.reparseOverscaled?a:i;if(this._renderWorldCopies)for(var g=1;g<=3;g++)h.push(f(-g)),h.push(f(g));for(h.push(f(0));h.length>0;){var v=h.pop(),y=v.x,x=v.y,b=v.fullyVisible;if(!b){var _=v.aabb.intersects(c);if(0===_)continue;b=2===_}var w=Math.max(Math.abs(v.aabb.distanceX(l)),Math.abs(v.aabb.distanceY(l))),T=3+(1<<d-v.zoom)-2;if(v.zoom===d||w>T&&v.zoom>=u)p.push({tileID:new r.OverscaledTileID(v.zoom===d?m:v.zoom,v.wrap,v.zoom,y,x),distanceSq:r.sqrLen([l[0]-.5-y,l[1]-.5-x])});else for(var k=0;k<4;k++){var A=(y<<1)+k%2,M=(x<<1)+(k>>1);h.push({aabb:v.aabb.quadrant(k),zoom:v.zoom+1,x:A,y:M,wrap:v.wrap,fullyVisible:b})}}return p.sort(function(r,n){return r.distanceSq-n.distanceSq}).map(function(r){return r.tileID})},e9.prototype.resize=function(r,n){this.width=r,this.height=n,this.pixelsToGLUnits=[2/r,-2/n],this._constrain(),this._calcMatrices()},e7.unmodified.get=function(){return this._unmodified},e9.prototype.zoomScale=function(r){return Math.pow(2,r)},e9.prototype.scaleZoom=function(r){return Math.log(r)/Math.LN2},e9.prototype.project=function(n){var i=r.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new r.Point(r.mercatorXfromLng(n.lng)*this.worldSize,r.mercatorYfromLat(i)*this.worldSize)},e9.prototype.unproject=function(n){return new r.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},e7.point.get=function(){return this.project(this.center)},e9.prototype.setLocationAtPoint=function(n,i){var a=this.pointCoordinate(i),o=this.pointCoordinate(this.centerPoint),s=this.locationCoordinate(n),l=new r.MercatorCoordinate(s.x-(a.x-o.x),s.y-(a.y-o.y));this.center=this.coordinateLocation(l),this._renderWorldCopies&&(this.center=this.center.wrap())},e9.prototype.locationPoint=function(r){return this.coordinatePoint(this.locationCoordinate(r))},e9.prototype.pointLocation=function(r){return this.coordinateLocation(this.pointCoordinate(r))},e9.prototype.locationCoordinate=function(n){return r.MercatorCoordinate.fromLngLat(n)},e9.prototype.coordinateLocation=function(r){return r.toLngLat()},e9.prototype.pointCoordinate=function(n){var i=[n.x,n.y,0,1],a=[n.x,n.y,1,1];r.transformMat4(i,i,this.pixelMatrixInverse),r.transformMat4(a,a,this.pixelMatrixInverse);var o=i[3],s=a[3],l=i[0]/o,c=a[0]/s,u=i[1]/o,f=a[1]/s,h=i[2]/o,p=a[2]/s,d=h===p?0:(0-h)/(p-h);return new r.MercatorCoordinate(r.number(l,c,d)/this.worldSize,r.number(u,f,d)/this.worldSize)},e9.prototype.coordinatePoint=function(n){var i=[n.x*this.worldSize,n.y*this.worldSize,0,1];return r.transformMat4(i,i,this.pixelMatrix),new r.Point(i[0]/i[3],i[1]/i[3])},e9.prototype.getBounds=function(){return(new r.LngLatBounds).extend(this.pointLocation(new r.Point(0,0))).extend(this.pointLocation(new r.Point(this.width,0))).extend(this.pointLocation(new r.Point(this.width,this.height))).extend(this.pointLocation(new r.Point(0,this.height)))},e9.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new r.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},e9.prototype.setMaxBounds=function(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},e9.prototype.calculatePosMatrix=function(n,i){void 0===i&&(i=!1);var a=n.key,o=i?this._alignedPosMatrixCache:this._posMatrixCache;if(o[a])return o[a];var s=n.canonical,l=this.worldSize/this.zoomScale(s.z),c=s.x+Math.pow(2,s.z)*n.wrap,u=r.identity(new Float64Array(16));return r.translate(u,u,[c*l,s.y*l,0]),r.scale(u,u,[l/r.EXTENT,l/r.EXTENT,1]),r.multiply(u,i?this.alignedProjMatrix:this.projMatrix,u),o[a]=new Float32Array(u),o[a]},e9.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},e9.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,i,a,o,s=-90,l=90,c=-180,u=180,f=this.size,h=this._unmodified;if(this.latRange){var p=this.latRange;s=r.mercatorYfromLat(p[1])*this.worldSize,n=(l=r.mercatorYfromLat(p[0])*this.worldSize)-s<f.y?f.y/(l-s):0}if(this.lngRange){var d=this.lngRange;c=r.mercatorXfromLng(d[0])*this.worldSize,i=(u=r.mercatorXfromLng(d[1])*this.worldSize)-c<f.x?f.x/(u-c):0}var m=this.point,g=Math.max(i||0,n||0);if(g)return this.center=this.unproject(new r.Point(i?(u+c)/2:m.x,n?(l+s)/2:m.y)),this.zoom+=this.scaleZoom(g),this._unmodified=h,void(this._constraining=!1);if(this.latRange){var v=m.y,y=f.y/2;v-y<s&&(o=s+y),v+y>l&&(o=l-y)}if(this.lngRange){var x=m.x,b=f.x/2;x-b<c&&(a=c+b),x+b>u&&(a=u-b)}void 0===a&&void 0===o||(this.center=this.unproject(new r.Point(void 0!==a?a:m.x,void 0!==o?o:m.y))),this._unmodified=h,this._constraining=!1}},e9.prototype._calcMatrices=function(){if(this.height){var n=this._fov/2,i=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(n)*this.height;var a=Math.PI/2+this._pitch,o=this._fov*(.5+i.y/this.height),s=Math.sin(o)*this.cameraToCenterDistance/Math.sin(r.clamp(Math.PI-a-o,.01,Math.PI-.01)),l=this.point,c=l.x,u=l.y,f=1.01*(Math.cos(Math.PI/2-this._pitch)*s+this.cameraToCenterDistance),h=this.height/50,p=new Float64Array(16);r.perspective(p,this._fov,this.width/this.height,h,f),p[8]=-(2*i.x)/this.width,p[9]=2*i.y/this.height,r.scale(p,p,[1,-1,1]),r.translate(p,p,[0,0,-this.cameraToCenterDistance]),r.rotateX(p,p,this._pitch),r.rotateZ(p,p,this.angle),r.translate(p,p,[-c,-u,0]),this.mercatorMatrix=r.scale([],p,[this.worldSize,this.worldSize,this.worldSize]),r.scale(p,p,[1,1,r.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=p,this.invProjMatrix=r.invert([],this.projMatrix);var d=this.width%2/2,m=this.height%2/2,g=Math.cos(this.angle),v=Math.sin(this.angle),y=c-Math.round(c)+g*d+v*m,x=u-Math.round(u)+g*m+v*d,b=new Float64Array(p);if(r.translate(b,b,[y>.5?y-1:y,x>.5?x-1:x,0]),this.alignedProjMatrix=b,p=r.create(),r.scale(p,p,[this.width/2,-this.height/2,1]),r.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=r.create(),r.scale(p,p,[1,-1,1]),r.translate(p,p,[-1,-1,0]),r.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.pixelMatrix=r.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(p=r.invert(new Float64Array(16),this.pixelMatrix)))throw Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}},e9.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new r.Point(0,0)),i=[n.x*this.worldSize,n.y*this.worldSize,0,1];return r.transformMat4(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance},e9.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.Point(0,n))},e9.prototype.getCameraQueryGeometry=function(n){var i=this.getCameraPoint();if(1===n.length)return[n[0],i];for(var a=i.x,o=i.y,s=i.x,l=i.y,c=0;c<n.length;c+=1){var u=n[c];a=Math.min(a,u.x),o=Math.min(o,u.y),s=Math.max(s,u.x),l=Math.max(l,u.y)}return[new r.Point(a,o),new r.Point(s,o),new r.Point(s,l),new r.Point(a,l),new r.Point(a,o)]},Object.defineProperties(e9.prototype,e7);var rt=function(n){var i,a,o,s;this._hashName=n&&encodeURIComponent(n),r.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(i=this._updateHashUnthrottled.bind(this),a=!1,o=null,s=function(){o=null,a&&(i(),o=setTimeout(s,300),a=!1)},function(){return a=!0,o||s(),o})};rt.prototype.addTo=function(n){return this._map=n,r.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},rt.prototype.remove=function(){return r.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},rt.prototype.getHashString=function(n){var i=this._map.getCenter(),a=Math.round(100*this._map.getZoom())/100,o=Math.pow(10,Math.ceil((a*Math.LN2+Math.log(512/360/.5))/Math.LN10)),s=Math.round(i.lng*o)/o,l=Math.round(i.lat*o)/o,c=this._map.getBearing(),u=this._map.getPitch(),f="";if(f+=n?"/"+s+"/"+l+"/"+a:a+"/"+l+"/"+s,(c||u)&&(f+="/"+Math.round(10*c)/10),u&&(f+="/"+Math.round(u)),this._hashName){var h=this._hashName,p=!1,d=r.window.location.hash.slice(1).split("&").map(function(r){var n=r.split("=")[0];return n===h?(p=!0,n+"="+f):r}).filter(function(r){return r});return p||d.push(h+"="+f),"#"+d.join("&")}return"#"+f},rt.prototype._getCurrentHash=function(){var n,i=this,a=r.window.location.hash.replace("#","");return this._hashName?(a.split("&").map(function(r){return r.split("=")}).forEach(function(r){r[0]===i._hashName&&(n=r)}),(n&&n[1]||"").split("/")):a.split("/")},rt.prototype._onHashChange=function(){var r=this._getCurrentHash();if(r.length>=3&&!r.some(function(r){return isNaN(r)})){var n=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:n,pitch:+(r[4]||0)}),!0}return!1},rt.prototype._updateHashUnthrottled=function(){var n=this.getHashString();try{r.window.history.replaceState(r.window.history.state,"",n)}catch(r){}};var re={linearity:.3,easing:r.bezier(0,0,.3,1)},rr=r.extend({deceleration:2500,maxSpeed:1400},re),rn=r.extend({deceleration:20,maxSpeed:1400},re),ri=r.extend({deceleration:1e3,maxSpeed:360},re),ra=r.extend({deceleration:1e3,maxSpeed:90},re),ro=function(r){this._map=r,this.clear()};function rs(r,n){(!r.duration||r.duration<n.duration)&&(r.duration=n.duration,r.easing=n.easing)}function rl(n,i,a){var o=a.maxSpeed,s=a.linearity,l=a.deceleration,c=r.clamp(n*s/(i/1e3),-o,o),u=Math.abs(c)/(l*s);return{easing:a.easing,duration:1e3*u,amount:u/2*c}}ro.prototype.clear=function(){this._inertiaBuffer=[]},ro.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.browser.now(),settings:n})},ro.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,i=r.browser.now();n.length>0&&i-n[0].time>160;)n.shift()},ro.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var i={zoom:0,bearing:0,pitch:0,pan:new r.Point(0,0),pinchAround:void 0,around:void 0},a=0,o=this._inertiaBuffer;a<o.length;a+=1){var s=o[a].settings;i.zoom+=s.zoomDelta||0,i.bearing+=s.bearingDelta||0,i.pitch+=s.pitchDelta||0,s.panDelta&&i.pan._add(s.panDelta),s.around&&(i.around=s.around),s.pinchAround&&(i.pinchAround=s.pinchAround)}var l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(i.pan.mag()){var u=rl(i.pan.mag(),l,r.extend({},rr,n||{}));c.offset=i.pan.mult(u.amount/i.pan.mag()),c.center=this._map.transform.center,rs(c,u)}if(i.zoom){var f=rl(i.zoom,l,rn);c.zoom=this._map.transform.zoom+f.amount,rs(c,f)}if(i.bearing){var h=rl(i.bearing,l,ri);c.bearing=this._map.transform.bearing+r.clamp(h.amount,-179,179),rs(c,h)}if(i.pitch){var p=rl(i.pitch,l,ra);c.pitch=this._map.transform.pitch+p.amount,rs(c,p)}if(c.zoom||c.bearing){var d=void 0===i.pinchAround?i.around:i.pinchAround;c.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),r.extend(c,{noMoveStart:!0})}};var rc=function(n){function a(a,o,s,l){void 0===l&&(l={});var c=i.mousePos(o.getCanvasContainer(),s),u=o.unproject(c);n.call(this,a,r.extend({point:c,lngLat:u,originalEvent:s},l)),this._defaultPrevented=!1,this.target=o}n&&(a.__proto__=n),a.prototype=Object.create(n&&n.prototype),a.prototype.constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(r.Event),ru=function(n){function a(a,o,s){var l="touchend"===a?s.changedTouches:s.touches,c=i.touchPos(o.getCanvasContainer(),l),u=c.map(function(r){return o.unproject(r)}),f=c.reduce(function(r,n,i,a){return r.add(n.div(a.length))},new r.Point(0,0)),h=o.unproject(f);n.call(this,a,{points:c,point:f,lngLats:u,lngLat:h,originalEvent:s}),this._defaultPrevented=!1}n&&(a.__proto__=n),a.prototype=Object.create(n&&n.prototype),a.prototype.constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(r.Event),rf=function(r){function n(n,i,a){r.call(this,n,{originalEvent:a}),this._defaultPrevented=!1}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={defaultPrevented:{configurable:!0}};return n.prototype.preventDefault=function(){this._defaultPrevented=!0},i.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(n.prototype,i),n}(r.Event),rh=function(r,n){this._map=r,this._clickTolerance=n.clickTolerance};rh.prototype.reset=function(){delete this._mousedownPos},rh.prototype.wheel=function(r){return this._firePreventable(new rf(r.type,this._map,r))},rh.prototype.mousedown=function(r,n){return this._mousedownPos=n,this._firePreventable(new rc(r.type,this._map,r))},rh.prototype.mouseup=function(r){this._map.fire(new rc(r.type,this._map,r))},rh.prototype.click=function(r,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new rc(r.type,this._map,r))},rh.prototype.dblclick=function(r){return this._firePreventable(new rc(r.type,this._map,r))},rh.prototype.mouseover=function(r){this._map.fire(new rc(r.type,this._map,r))},rh.prototype.mouseout=function(r){this._map.fire(new rc(r.type,this._map,r))},rh.prototype.touchstart=function(r){return this._firePreventable(new ru(r.type,this._map,r))},rh.prototype.touchmove=function(r){this._map.fire(new ru(r.type,this._map,r))},rh.prototype.touchend=function(r){this._map.fire(new ru(r.type,this._map,r))},rh.prototype.touchcancel=function(r){this._map.fire(new ru(r.type,this._map,r))},rh.prototype._firePreventable=function(r){if(this._map.fire(r),r.defaultPrevented)return{}},rh.prototype.isEnabled=function(){return!0},rh.prototype.isActive=function(){return!1},rh.prototype.enable=function(){},rh.prototype.disable=function(){};var rp=function(r){this._map=r};rp.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},rp.prototype.mousemove=function(r){this._map.fire(new rc(r.type,this._map,r))},rp.prototype.mousedown=function(){this._delayContextMenu=!0},rp.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new rc("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},rp.prototype.contextmenu=function(r){this._delayContextMenu?this._contextMenuEvent=r:this._map.fire(new rc(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()},rp.prototype.isEnabled=function(){return!0},rp.prototype.isActive=function(){return!1},rp.prototype.enable=function(){},rp.prototype.disable=function(){};var rd=function(r,n){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=n.clickTolerance||1};function rm(r,n){for(var i={},a=0;a<r.length;a++)i[r[a].identifier]=n[a];return i}rd.prototype.isEnabled=function(){return!!this._enabled},rd.prototype.isActive=function(){return!!this._active},rd.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},rd.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},rd.prototype.mousedown=function(r,n){this.isEnabled()&&r.shiftKey&&0===r.button&&(i.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)},rd.prototype.mousemoveWindow=function(r,n){if(this._active&&!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var a=this._startPos;this._lastPos=n,this._box||(this._box=i.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));var o=Math.min(a.x,n.x),s=Math.max(a.x,n.x),l=Math.min(a.y,n.y),c=Math.max(a.y,n.y);i.setTransform(this._box,"translate("+o+"px,"+l+"px)"),this._box.style.width=s-o+"px",this._box.style.height=c-l+"px"}},rd.prototype.mouseupWindow=function(n,a){var o=this;if(this._active&&0===n.button){var s=this._startPos;if(this.reset(),i.suppressClick(),s.x!==a.x||s.y!==a.y)return this._map.fire(new r.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(r){return r.fitScreenCoordinates(s,a,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},rd.prototype.keydown=function(r){this._active&&27===r.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",r))},rd.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(i.remove(this._box),this._box=null),i.enableDrag(),delete this._startPos,delete this._lastPos},rd.prototype._fireEvent=function(n,i){return this._map.fire(new r.Event(n,{originalEvent:i}))};var rg=function(r){this.reset(),this.numTouches=r.numTouches};rg.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},rg.prototype.touchstart=function(n,i,a){(this.centroid||a.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=n.timeStamp),a.length===this.numTouches&&(this.centroid=function(n){for(var i=new r.Point(0,0),a=0;a<n.length;a+=1){var o=n[a];i._add(o)}return i.div(n.length)}(i),this.touches=rm(a,i)))},rg.prototype.touchmove=function(r,n,i){if(!this.aborted&&this.centroid){var a=rm(i,n);for(var o in this.touches){var s=this.touches[o],l=a[o];(!l||l.dist(s)>30)&&(this.aborted=!0)}}},rg.prototype.touchend=function(r,n,i){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){var a=!this.aborted&&this.centroid;if(this.reset(),a)return a}};var rv=function(r){this.singleTap=new rg(r),this.numTaps=r.numTaps,this.reset()};rv.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},rv.prototype.touchstart=function(r,n,i){this.singleTap.touchstart(r,n,i)},rv.prototype.touchmove=function(r,n,i){this.singleTap.touchmove(r,n,i)},rv.prototype.touchend=function(r,n,i){var a=this.singleTap.touchend(r,n,i);if(a){var o=r.timeStamp-this.lastTime<500,s=!this.lastTap||30>this.lastTap.dist(a);if(o&&s||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=a,this.count===this.numTaps)return this.reset(),a}};var ry=function(){this._zoomIn=new rv({numTouches:1,numTaps:2}),this._zoomOut=new rv({numTouches:2,numTaps:1}),this.reset()};ry.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ry.prototype.touchstart=function(r,n,i){this._zoomIn.touchstart(r,n,i),this._zoomOut.touchstart(r,n,i)},ry.prototype.touchmove=function(r,n,i){this._zoomIn.touchmove(r,n,i),this._zoomOut.touchmove(r,n,i)},ry.prototype.touchend=function(r,n,i){var a=this,o=this._zoomIn.touchend(r,n,i),s=this._zoomOut.touchend(r,n,i);return o?(this._active=!0,r.preventDefault(),setTimeout(function(){return a.reset()},0),{cameraAnimation:function(n){return n.easeTo({duration:300,zoom:n.getZoom()+1,around:n.unproject(o)},{originalEvent:r})}}):s?(this._active=!0,r.preventDefault(),setTimeout(function(){return a.reset()},0),{cameraAnimation:function(n){return n.easeTo({duration:300,zoom:n.getZoom()-1,around:n.unproject(s)},{originalEvent:r})}}):void 0},ry.prototype.touchcancel=function(){this.reset()},ry.prototype.enable=function(){this._enabled=!0},ry.prototype.disable=function(){this._enabled=!1,this.reset()},ry.prototype.isEnabled=function(){return this._enabled},ry.prototype.isActive=function(){return this._active};var rx=function(r){this.reset(),this._clickTolerance=r.clickTolerance||1};rx.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},rx.prototype._correctButton=function(r,n){return!1},rx.prototype._move=function(r,n){return{}},rx.prototype.mousedown=function(r,n){if(!this._lastPoint){var a=i.mouseButton(r);this._correctButton(r,a)&&(this._lastPoint=n,this._eventButton=a)}},rx.prototype.mousemoveWindow=function(r,n){var i=this._lastPoint;if(i&&(r.preventDefault(),this._moved||!(n.dist(i)<this._clickTolerance)))return this._moved=!0,this._lastPoint=n,this._move(i,n)},rx.prototype.mouseupWindow=function(r){i.mouseButton(r)===this._eventButton&&(this._moved&&i.suppressClick(),this.reset())},rx.prototype.enable=function(){this._enabled=!0},rx.prototype.disable=function(){this._enabled=!1,this.reset()},rx.prototype.isEnabled=function(){return this._enabled},rx.prototype.isActive=function(){return this._active};var rb=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.mousedown=function(n,i){r.prototype.mousedown.call(this,n,i),this._lastPoint&&(this._active=!0)},n.prototype._correctButton=function(r,n){return 0===n&&!r.ctrlKey},n.prototype._move=function(r,n){return{around:n,panDelta:n.sub(r)}},n}(rx),r_=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._correctButton=function(r,n){return 0===n&&r.ctrlKey||2===n},n.prototype._move=function(r,n){var i=.8*(n.x-r.x);if(i)return this._active=!0,{bearingDelta:i}},n.prototype.contextmenu=function(r){r.preventDefault()},n}(rx),rw=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype._correctButton=function(r,n){return 0===n&&r.ctrlKey||2===n},n.prototype._move=function(r,n){var i=-.5*(n.y-r.y);if(i)return this._active=!0,{pitchDelta:i}},n.prototype.contextmenu=function(r){r.preventDefault()},n}(rx),rT=function(r){this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset()};rT.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new r.Point(0,0)},rT.prototype.touchstart=function(r,n,i){return this._calculateTransform(r,n,i)},rT.prototype.touchmove=function(r,n,i){if(this._active)return r.preventDefault(),this._calculateTransform(r,n,i)},rT.prototype.touchend=function(r,n,i){this._calculateTransform(r,n,i),this._active&&i.length<this._minTouches&&this.reset()},rT.prototype.touchcancel=function(){this.reset()},rT.prototype._calculateTransform=function(n,i,a){a.length>0&&(this._active=!0);var o=rm(a,i),s=new r.Point(0,0),l=new r.Point(0,0),c=0;for(var u in o){var f=o[u],h=this._touches[u];h&&(s._add(f),l._add(f.sub(h)),c++,o[u]=f)}if(this._touches=o,!(c<this._minTouches)&&l.mag()){var p=l.div(c);if(this._sum._add(p),!(this._sum.mag()<this._clickTolerance))return{around:s.div(c),panDelta:p}}},rT.prototype.enable=function(){this._enabled=!0},rT.prototype.disable=function(){this._enabled=!1,this.reset()},rT.prototype.isEnabled=function(){return this._enabled},rT.prototype.isActive=function(){return this._active};var rk=function(){this.reset()};function rA(r,n,i){for(var a=0;a<r.length;a++)if(r[a].identifier===i)return n[a]}function rM(r,n){return Math.log(r/n)/Math.LN2}rk.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},rk.prototype._start=function(r){},rk.prototype._move=function(r,n,i){return{}},rk.prototype.touchstart=function(r,n,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([n[0],n[1]]))},rk.prototype.touchmove=function(r,n,i){if(this._firstTwoTouches){r.preventDefault();var a=this._firstTwoTouches,o=a[0],s=a[1],l=rA(i,n,o),c=rA(i,n,s);if(l&&c){var u=this._aroundCenter?null:l.add(c).div(2);return this._move([l,c],u,r)}}},rk.prototype.touchend=function(r,n,a){if(this._firstTwoTouches){var o=this._firstTwoTouches,s=o[0],l=o[1],c=rA(a,n,s),u=rA(a,n,l);c&&u||(this._active&&i.suppressClick(),this.reset())}},rk.prototype.touchcancel=function(){this.reset()},rk.prototype.enable=function(r){this._enabled=!0,this._aroundCenter=!!r&&"center"===r.around},rk.prototype.disable=function(){this._enabled=!1,this.reset()},rk.prototype.isEnabled=function(){return this._enabled},rk.prototype.isActive=function(){return this._active};var rS=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.reset=function(){r.prototype.reset.call(this),delete this._distance,delete this._startDistance},n.prototype._start=function(r){this._startDistance=this._distance=r[0].dist(r[1])},n.prototype._move=function(r,n){var i=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(.1>Math.abs(rM(this._distance,this._startDistance))))return this._active=!0,{zoomDelta:rM(this._distance,i),pinchAround:n}},n}(rk);function rE(r,n){return 180*r.angleWith(n)/Math.PI}var rL=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.reset=function(){r.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},n.prototype._start=function(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])},n.prototype._move=function(r,n){var i=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:rE(this._vector,i),pinchAround:n}},n.prototype._isBelowThreshold=function(r){this._minDiameter=Math.min(this._minDiameter,r.mag());var n=25/(Math.PI*this._minDiameter)*360;return Math.abs(rE(r,this._startVector))<n},n}(rk);function rC(r){return Math.abs(r.y)>Math.abs(r.x)}var rP=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n.prototype.reset=function(){r.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},n.prototype._start=function(r){this._lastPoints=r,rC(r[0].sub(r[1]))&&(this._valid=!1)},n.prototype._move=function(r,n,i){var a=r[0].sub(this._lastPoints[0]),o=r[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(a,o,i.timeStamp),this._valid)return this._lastPoints=r,this._active=!0,{pitchDelta:-((a.y+o.y)/2*.5)}},n.prototype.gestureBeginsVertically=function(r,n,i){if(void 0!==this._valid)return this._valid;var a=r.mag()>=2,o=n.mag()>=2;if(a||o){if(!a||!o)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;var s=r.y>0==n.y>0;return rC(r)&&rC(n)&&s}},n}(rk),rI=function(){this._panStep=100,this._bearingStep=15,this._pitchStep=10};function rO(r){return r*(2-r)}rI.prototype.reset=function(){this._active=!1},rI.prototype.keydown=function(r){var n=this;if(!(r.altKey||r.ctrlKey||r.metaKey)){var i=0,a=0,o=0,s=0,l=0;switch(r.keyCode){case 61:case 107:case 171:case 187:i=1;break;case 189:case 109:case 173:i=-1;break;case 37:r.shiftKey?a=-1:(r.preventDefault(),s=-1);break;case 39:r.shiftKey?a=1:(r.preventDefault(),s=1);break;case 38:r.shiftKey?o=1:(r.preventDefault(),l=-1);break;case 40:r.shiftKey?o=-1:(r.preventDefault(),l=1);break;default:return}return{cameraAnimation:function(c){var u=c.getZoom();c.easeTo({duration:300,easeId:"keyboardHandler",easing:rO,zoom:i?Math.round(u)+i*(r.shiftKey?2:1):u,bearing:c.getBearing()+a*n._bearingStep,pitch:c.getPitch()+o*n._pitchStep,offset:[-s*n._panStep,-l*n._panStep],center:c.getCenter()},{originalEvent:r})}}}},rI.prototype.enable=function(){this._enabled=!0},rI.prototype.disable=function(){this._enabled=!1,this.reset()},rI.prototype.isEnabled=function(){return this._enabled},rI.prototype.isActive=function(){return this._active};var rz=function(n,i){this._map=n,this._el=n.getCanvasContainer(),this._handler=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,r.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};rz.prototype.setZoomRate=function(r){this._defaultZoomRate=r},rz.prototype.setWheelZoomRate=function(r){this._wheelZoomRate=r},rz.prototype.isEnabled=function(){return!!this._enabled},rz.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},rz.prototype.isZooming=function(){return!!this._zooming},rz.prototype.enable=function(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=r&&"center"===r.around)},rz.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},rz.prototype.wheel=function(n){if(this.isEnabled()){var i=n.deltaMode===r.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,a=r.browser.now(),o=a-(this._lastWheelEventTime||0);this._lastWheelEventTime=a,0!==i&&i%4.000244140625==0?this._type="wheel":0!==i&&4>Math.abs(i)?this._type="trackpad":o>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=200>Math.abs(o*i)?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),n.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=n,this._delta-=i,this._active||this._start(n)),n.preventDefault()}},rz.prototype._onTimeout=function(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},rz.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=i.mousePos(this._el,n);this._around=r.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},rz.prototype.renderFrame=function(){return this._onScrollFrame()},rz.prototype._onScrollFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var i=this._map.transform;if(0!==this._delta){var a="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,o=2/(1+Math.exp(-Math.abs(this._delta*a)));this._delta<0&&0!==o&&(o=1/o);var s="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(s*o))),"wheel"===this._type&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var l,c="number"==typeof this._targetZoom?this._targetZoom:i.zoom,u=this._startZoom,f=this._easing,h=!1;if("wheel"===this._type&&u&&f){var p=Math.min((r.browser.now()-this._lastWheelEventTime)/200,1),d=f(p);l=r.number(u,c,d),p<1?this._frameId||(this._frameId=!0):h=!0}else l=c,h=!0;return this._active=!0,h&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!h,zoomDelta:l-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},rz.prototype._smoothOutEasing=function(n){var i=r.ease;if(this._prevEase){var a=this._prevEase,o=(r.browser.now()-a.start)/a.duration,s=a.easing(o+.01)-a.easing(o),l=.27/Math.sqrt(s*s+1e-4)*.01,c=Math.sqrt(.0729-l*l);i=r.bezier(l,c,.25,1)}return this._prevEase={start:r.browser.now(),duration:n,easing:i},i},rz.prototype.reset=function(){this._active=!1};var rD=function(r,n){this._clickZoom=r,this._tapZoom=n};rD.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},rD.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},rD.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},rD.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var rR=function(){this.reset()};rR.prototype.reset=function(){this._active=!1},rR.prototype.dblclick=function(r,n){return r.preventDefault(),{cameraAnimation:function(i){i.easeTo({duration:300,zoom:i.getZoom()+(r.shiftKey?-1:1),around:i.unproject(n)},{originalEvent:r})}}},rR.prototype.enable=function(){this._enabled=!0},rR.prototype.disable=function(){this._enabled=!1,this.reset()},rR.prototype.isEnabled=function(){return this._enabled},rR.prototype.isActive=function(){return this._active};var rF=function(){this._tap=new rv({numTouches:1,numTaps:1}),this.reset()};rF.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},rF.prototype.touchstart=function(r,n,i){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=n[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(r,n,i))},rF.prototype.touchmove=function(r,n,i){if(this._tapTime){if(this._swipePoint&&i[0].identifier===this._swipeTouch){var a=n[0],o=a.y-this._swipePoint.y;return this._swipePoint=a,r.preventDefault(),this._active=!0,{zoomDelta:o/128}}}else this._tap.touchmove(r,n,i)},rF.prototype.touchend=function(r,n,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(r,n,i)&&(this._tapTime=r.timeStamp)},rF.prototype.touchcancel=function(){this.reset()},rF.prototype.enable=function(){this._enabled=!0},rF.prototype.disable=function(){this._enabled=!1,this.reset()},rF.prototype.isEnabled=function(){return this._enabled},rF.prototype.isActive=function(){return this._active};var rB=function(r,n,i){this._el=r,this._mousePan=n,this._touchPan=i};rB.prototype.enable=function(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},rB.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},rB.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},rB.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var rN=function(r,n,i){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=n,this._mousePitch=i};rN.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},rN.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},rN.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},rN.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var rj=function(r,n,i,a){this._el=r,this._touchZoom=n,this._touchRotate=i,this._tapDragZoom=a,this._rotationDisabled=!1,this._enabled=!0};rj.prototype.enable=function(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},rj.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},rj.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},rj.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},rj.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},rj.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var rU=function(r){return r.zoom||r.drag||r.pitch||r.rotate},rV=function(r){function n(){r.apply(this,arguments)}return r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n,n}(r.Event);function rH(r){return r.panDelta&&r.panDelta.mag()||r.zoomDelta||r.bearingDelta||r.pitchDelta}var rq=function(n,a){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ro(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),r.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!1}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[r.window.document,"mousemove",{capture:!0}],[r.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[r.window,"blur",void 0]];for(var s=0,l=this._listeners;s<l.length;s+=1){var c=l[s],u=c[0],f=c[1],h=c[2];i.addEventListener(u,f,u===r.window.document?this.handleWindowEvent:this.handleEvent,h)}};rq.prototype.destroy=function(){for(var n=0,a=this._listeners;n<a.length;n+=1){var o=a[n],s=o[0],l=o[1],c=o[2];i.removeEventListener(s,l,s===r.window.document?this.handleWindowEvent:this.handleEvent,c)}},rq.prototype._addDefaultHandlers=function(r){var n=this._map,i=n.getCanvasContainer();this._add("mapEvent",new rh(n,r));var a=n.boxZoom=new rd(n,r);this._add("boxZoom",a);var o=new ry,s=new rR;n.doubleClickZoom=new rD(s,o),this._add("tapZoom",o),this._add("clickZoom",s);var l=new rF;this._add("tapDragZoom",l);var c=n.touchPitch=new rP;this._add("touchPitch",c);var u=new r_(r),f=new rw(r);n.dragRotate=new rN(r,u,f),this._add("mouseRotate",u,["mousePitch"]),this._add("mousePitch",f,["mouseRotate"]);var h=new rb(r),p=new rT(r);n.dragPan=new rB(i,h,p),this._add("mousePan",h),this._add("touchPan",p,["touchZoom","touchRotate"]);var d=new rL,m=new rS;n.touchZoomRotate=new rj(i,m,d,l),this._add("touchRotate",d,["touchPan","touchZoom"]),this._add("touchZoom",m,["touchPan","touchRotate"]);var g=n.scrollZoom=new rz(n,this);this._add("scrollZoom",g,["mousePan"]);var v=n.keyboard=new rI;this._add("keyboard",v),this._add("blockableMapEvent",new rp(n));for(var y=0,x=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];y<x.length;y+=1){var b=x[y];r.interactive&&r[b]&&n[b].enable(r[b])}},rq.prototype._add=function(r,n,i){this._handlers.push({handlerName:r,handler:n,allowed:i}),this._handlersById[r]=n},rq.prototype.stop=function(){if(!this._updatingCamera){for(var r=0,n=this._handlers;r<n.length;r+=1)n[r].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},rq.prototype.isActive=function(){for(var r=0,n=this._handlers;r<n.length;r+=1)if(n[r].handler.isActive())return!0;return!1},rq.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},rq.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},rq.prototype.isMoving=function(){return!!rU(this._eventsInProgress)||this.isZooming()},rq.prototype._blockedByActive=function(r,n,i){for(var a in r)if(a!==i&&(!n||0>n.indexOf(a)))return!0;return!1},rq.prototype.handleWindowEvent=function(r){this.handleEvent(r,r.type+"Window")},rq.prototype._getMapTouches=function(r){for(var n=[],i=0;i<r.length;i+=1){var a=r[i],o=a.target;this._el.contains(o)&&n.push(a)}return n},rq.prototype.handleEvent=function(r,n){if("blur"!==r.type){this._updatingCamera=!0;for(var a="renderFrame"===r.type?void 0:r,o={needsRenderFrame:!1},s={},l={},c=r.touches?this._getMapTouches(r.touches):void 0,u=c?i.touchPos(this._el,c):i.mousePos(this._el,r),f=0,h=this._handlers;f<h.length;f+=1){var p=h[f],d=p.handlerName,m=p.handler,g=p.allowed;if(m.isEnabled()){var v=void 0;this._blockedByActive(l,g,d)?m.reset():m[n||r.type]&&(v=m[n||r.type](r,u,c),this.mergeHandlerResult(o,s,v,d,a),v&&v.needsRenderFrame&&this._triggerRenderFrame()),(v||m.isActive())&&(l[d]=m)}}var y={};for(var x in this._previousActiveHandlers)l[x]||(y[x]=a);this._previousActiveHandlers=l,(Object.keys(y).length||rH(o))&&(this._changes.push([o,s,y]),this._triggerRenderFrame()),(Object.keys(l).length||rH(o))&&this._map._stop(!0),this._updatingCamera=!1;var b=o.cameraAnimation;b&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],b(this._map))}else this.stop()},rq.prototype.mergeHandlerResult=function(n,i,a,o,s){if(a){r.extend(n,a);var l={handlerName:o,originalEvent:a.originalEvent||s};void 0!==a.zoomDelta&&(i.zoom=l),void 0!==a.panDelta&&(i.drag=l),void 0!==a.pitchDelta&&(i.pitch=l),void 0!==a.bearingDelta&&(i.rotate=l)}},rq.prototype._applyChanges=function(){for(var n={},i={},a={},o=0,s=this._changes;o<s.length;o+=1){var l=s[o],c=l[0],u=l[1],f=l[2];c.panDelta&&(n.panDelta=(n.panDelta||new r.Point(0,0))._add(c.panDelta)),c.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+c.zoomDelta),c.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+c.bearingDelta),c.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+c.pitchDelta),void 0!==c.around&&(n.around=c.around),void 0!==c.pinchAround&&(n.pinchAround=c.pinchAround),c.noInertia&&(n.noInertia=c.noInertia),r.extend(i,u),r.extend(a,f)}this._updateMapTransform(n,i,a),this._changes=[]},rq.prototype._updateMapTransform=function(r,n,i){var a=this._map,o=a.transform;if(!rH(r))return this._fireEvents(n,i);var s=r.panDelta,l=r.zoomDelta,c=r.bearingDelta,u=r.pitchDelta,f=r.around,h=r.pinchAround;void 0!==h&&(f=h),a._stop(!0),f=f||a.transform.centerPoint;var p=o.pointLocation(s?f.sub(s):f);c&&(o.bearing+=c),u&&(o.pitch+=u),l&&(o.zoom+=l),o.setLocationAtPoint(p,f),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(n,i)},rq.prototype._fireEvents=function(n,i){var a=this,o=rU(this._eventsInProgress),s=rU(n),l={};for(var c in n){var u=n[c].originalEvent;this._eventsInProgress[c]||(l[c+"start"]=u),this._eventsInProgress[c]=n[c]}for(var f in!o&&s&&this._fireEvent("movestart",s.originalEvent),l)this._fireEvent(f,l[f]);for(var h in n.rotate&&(this._bearingChanged=!0),s&&this._fireEvent("move",s.originalEvent),n){var p=n[h].originalEvent;this._fireEvent(h,p)}var d,m={};for(var g in this._eventsInProgress){var v=this._eventsInProgress[g],y=v.handlerName,x=v.originalEvent;this._handlersById[y].isActive()||(delete this._eventsInProgress[g],d=i[y]||x,m[g+"end"]=d)}for(var b in m)this._fireEvent(b,m[b]);var _=rU(this._eventsInProgress);if((o||s)&&!_){this._updatingCamera=!0;var w=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),T=function(r){return 0!==r&&-a._bearingSnap<r&&r<a._bearingSnap};w?(T(w.bearing||this._map.getBearing())&&(w.bearing=0),this._map.easeTo(w,{originalEvent:d})):(this._map.fire(new r.Event("moveend",{originalEvent:d})),T(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},rq.prototype._fireEvent=function(n,i){this._map.fire(new r.Event(n,i?{originalEvent:i}:{}))},rq.prototype._triggerRenderFrame=function(){var r=this;void 0===this._frameId&&(this._frameId=this._map._requestRenderFrame(function(n){delete r._frameId,r.handleEvent(new rV("renderFrame",{timeStamp:n})),r._applyChanges()}))};var rG=function(n){function i(i,a){n.call(this),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=a.bearingSnap,r.bindAll(["_renderFrameCallback"],this)}return n&&(i.__proto__=n),i.prototype=Object.create(n&&n.prototype),i.prototype.constructor=i,i.prototype.getCenter=function(){return new r.LngLat(this.transform.center.lng,this.transform.center.lat)},i.prototype.setCenter=function(r,n){return this.jumpTo({center:r},n)},i.prototype.panBy=function(n,i,a){return n=r.Point.convert(n).mult(-1),this.panTo(this.transform.center,r.extend({offset:n},i),a)},i.prototype.panTo=function(n,i,a){return this.easeTo(r.extend({center:n},i),a)},i.prototype.getZoom=function(){return this.transform.zoom},i.prototype.setZoom=function(r,n){return this.jumpTo({zoom:r},n),this},i.prototype.zoomTo=function(n,i,a){return this.easeTo(r.extend({zoom:n},i),a)},i.prototype.zoomIn=function(r,n){return this.zoomTo(this.getZoom()+1,r,n),this},i.prototype.zoomOut=function(r,n){return this.zoomTo(this.getZoom()-1,r,n),this},i.prototype.getBearing=function(){return this.transform.bearing},i.prototype.setBearing=function(r,n){return this.jumpTo({bearing:r},n),this},i.prototype.getPadding=function(){return this.transform.padding},i.prototype.setPadding=function(r,n){return this.jumpTo({padding:r},n),this},i.prototype.rotateTo=function(n,i,a){return this.easeTo(r.extend({bearing:n},i),a)},i.prototype.resetNorth=function(n,i){return this.rotateTo(0,r.extend({duration:1e3},n),i),this},i.prototype.resetNorthPitch=function(n,i){return this.easeTo(r.extend({bearing:0,pitch:0,duration:1e3},n),i),this},i.prototype.snapToNorth=function(r,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,n):this},i.prototype.getPitch=function(){return this.transform.pitch},i.prototype.setPitch=function(r,n){return this.jumpTo({pitch:r},n),this},i.prototype.cameraForBounds=function(n,i){return n=r.LngLatBounds.convert(n),this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),0,i)},i.prototype._cameraForBoxAndBearing=function(n,i,a,o){var s={top:0,bottom:0,right:0,left:0};if("number"==typeof(o=r.extend({padding:s,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding){var l=o.padding;o.padding={top:l,bottom:l,right:l,left:l}}o.padding=r.extend(s,o.padding);var c=this.transform,u=c.padding,f=c.project(r.LngLat.convert(n)),h=c.project(r.LngLat.convert(i)),p=f.rotate(-a*Math.PI/180),d=h.rotate(-a*Math.PI/180),m=new r.Point(Math.max(p.x,d.x),Math.max(p.y,d.y)),g=new r.Point(Math.min(p.x,d.x),Math.min(p.y,d.y)),v=m.sub(g),y=(c.width-(u.left+u.right+o.padding.left+o.padding.right))/v.x,x=(c.height-(u.top+u.bottom+o.padding.top+o.padding.bottom))/v.y;if(!(x<0||y<0)){var b=Math.min(c.scaleZoom(c.scale*Math.min(y,x)),o.maxZoom),_=r.Point.convert(o.offset),w=(o.padding.left-o.padding.right)/2,T=(o.padding.top-o.padding.bottom)/2,k=new r.Point(_.x+w,_.y+T).mult(c.scale/c.zoomScale(b));return{center:c.unproject(f.add(h).div(2).sub(k)),zoom:b,bearing:a}}r.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},i.prototype.fitBounds=function(r,n,i){return this._fitInternal(this.cameraForBounds(r,n),n,i)},i.prototype.fitScreenCoordinates=function(n,i,a,o,s){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(r.Point.convert(n)),this.transform.pointLocation(r.Point.convert(i)),a,o),o,s)},i.prototype._fitInternal=function(n,i,a){return n?(delete(i=r.extend(n,i)).padding,i.linear?this.easeTo(i,a):this.flyTo(i,a)):this},i.prototype.jumpTo=function(n,i){this.stop();var a=this.transform,o=!1,s=!1,l=!1;return"zoom"in n&&a.zoom!==+n.zoom&&(o=!0,a.zoom=+n.zoom),void 0!==n.center&&(a.center=r.LngLat.convert(n.center)),"bearing"in n&&a.bearing!==+n.bearing&&(s=!0,a.bearing=+n.bearing),"pitch"in n&&a.pitch!==+n.pitch&&(l=!0,a.pitch=+n.pitch),null==n.padding||a.isPaddingEqual(n.padding)||(a.padding=n.padding),this.fire(new r.Event("movestart",i)).fire(new r.Event("move",i)),o&&this.fire(new r.Event("zoomstart",i)).fire(new r.Event("zoom",i)).fire(new r.Event("zoomend",i)),s&&this.fire(new r.Event("rotatestart",i)).fire(new r.Event("rotate",i)).fire(new r.Event("rotateend",i)),l&&this.fire(new r.Event("pitchstart",i)).fire(new r.Event("pitch",i)).fire(new r.Event("pitchend",i)),this.fire(new r.Event("moveend",i))},i.prototype.easeTo=function(n,i){var a=this;this._stop(!1,n.easeId),(!1===(n=r.extend({offset:[0,0],duration:500,easing:r.ease},n)).animate||!n.essential&&r.browser.prefersReducedMotion)&&(n.duration=0);var o=this.transform,s=this.getZoom(),l=this.getBearing(),c=this.getPitch(),u=this.getPadding(),f="zoom"in n?+n.zoom:s,h="bearing"in n?this._normalizeBearing(n.bearing,l):l,p="pitch"in n?+n.pitch:c,d="padding"in n?n.padding:o.padding,m=r.Point.convert(n.offset),g=o.centerPoint.add(m),v=o.pointLocation(g),y=r.LngLat.convert(n.center||v);this._normalizeCenter(y);var x,b,_=o.project(v),w=o.project(y).sub(_),T=o.zoomScale(f-s);n.around&&(x=r.LngLat.convert(n.around),b=o.locationPoint(x));var k={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||f!==s,this._rotating=this._rotating||l!==h,this._pitching=this._pitching||p!==c,this._padding=!o.isPaddingEqual(d),this._easeId=n.easeId,this._prepareEase(i,n.noMoveStart,k),clearTimeout(this._easeEndTimeoutID),this._ease(function(n){if(a._zooming&&(o.zoom=r.number(s,f,n)),a._rotating&&(o.bearing=r.number(l,h,n)),a._pitching&&(o.pitch=r.number(c,p,n)),a._padding&&(o.interpolatePadding(u,d,n),g=o.centerPoint.add(m)),x)o.setLocationAtPoint(x,b);else{var v=o.zoomScale(o.zoom-s),y=Math.pow(f>s?Math.min(2,T):Math.max(.5,T),1-n),k=o.unproject(_.add(w.mult(n*y)).mult(v));o.setLocationAtPoint(o.renderWorldCopies?k.wrap():k,g)}a._fireMoveEvents(i)},function(r){a._afterEase(i,r)},n),this},i.prototype._prepareEase=function(n,i,a){void 0===a&&(a={}),this._moving=!0,i||a.moving||this.fire(new r.Event("movestart",n)),this._zooming&&!a.zooming&&this.fire(new r.Event("zoomstart",n)),this._rotating&&!a.rotating&&this.fire(new r.Event("rotatestart",n)),this._pitching&&!a.pitching&&this.fire(new r.Event("pitchstart",n))},i.prototype._fireMoveEvents=function(n){this.fire(new r.Event("move",n)),this._zooming&&this.fire(new r.Event("zoom",n)),this._rotating&&this.fire(new r.Event("rotate",n)),this._pitching&&this.fire(new r.Event("pitch",n))},i.prototype._afterEase=function(n,i){if(!this._easeId||!i||this._easeId!==i){delete this._easeId;var a=this._zooming,o=this._rotating,s=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,a&&this.fire(new r.Event("zoomend",n)),o&&this.fire(new r.Event("rotateend",n)),s&&this.fire(new r.Event("pitchend",n)),this.fire(new r.Event("moveend",n))}},i.prototype.flyTo=function(n,i){var a=this;if(!n.essential&&r.browser.prefersReducedMotion){var o=r.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(o,i)}this.stop(),n=r.extend({offset:[0,0],speed:1.2,curve:1.42,easing:r.ease},n);var s=this.transform,l=this.getZoom(),c=this.getBearing(),u=this.getPitch(),f=this.getPadding(),h="zoom"in n?r.clamp(+n.zoom,s.minZoom,s.maxZoom):l,p="bearing"in n?this._normalizeBearing(n.bearing,c):c,d="pitch"in n?+n.pitch:u,m="padding"in n?n.padding:s.padding,g=s.zoomScale(h-l),v=r.Point.convert(n.offset),y=s.centerPoint.add(v),x=s.pointLocation(y),b=r.LngLat.convert(n.center||x);this._normalizeCenter(b);var _=s.project(x),w=s.project(b).sub(_),T=n.curve,k=Math.max(s.width,s.height),A=k/g,M=w.mag();if("minZoom"in n){var S=r.clamp(Math.min(n.minZoom,l,h),s.minZoom,s.maxZoom);T=Math.sqrt(k/s.zoomScale(S-l)/M*2)}var E=T*T;function L(r){var n=(A*A-k*k+(r?-1:1)*E*E*M*M)/(2*(r?A:k)*E*M);return Math.log(Math.sqrt(n*n+1)-n)}function C(r){return(Math.exp(r)-Math.exp(-r))/2}function P(r){return(Math.exp(r)+Math.exp(-r))/2}var I=L(0),O=function(r){return P(I)/P(I+T*r)},z=function(r){var n;return(P(I)*(C(n=I+T*r)/P(n))-C(I))/E*k/M},D=(L(1)-I)/T;if(1e-6>Math.abs(M)||!isFinite(D)){if(1e-6>Math.abs(k-A))return this.easeTo(n,i);var R=A<k?-1:1;D=Math.abs(Math.log(A/k))/T,z=function(){return 0},O=function(r){return Math.exp(R*T*r)}}if("duration"in n)n.duration=+n.duration;else{var F="screenSpeed"in n?+n.screenSpeed/T:+n.speed;n.duration=1e3*D/F}return n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=c!==p,this._pitching=d!==u,this._padding=!s.isPaddingEqual(m),this._prepareEase(i,!1),this._ease(function(n){var o=n*D,g=1/O(o);s.zoom=1===n?h:l+s.scaleZoom(g),a._rotating&&(s.bearing=r.number(c,p,n)),a._pitching&&(s.pitch=r.number(u,d,n)),a._padding&&(s.interpolatePadding(f,m,n),y=s.centerPoint.add(v));var x=1===n?b:s.unproject(_.add(w.mult(z(o))).mult(g));s.setLocationAtPoint(s.renderWorldCopies?x.wrap():x,y),a._fireMoveEvents(i)},function(){return a._afterEase(i)},n),this},i.prototype.isEasing=function(){return!!this._easeFrameId},i.prototype.stop=function(){return this._stop()},i.prototype._stop=function(r,n){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var i=this._onEaseEnd;delete this._onEaseEnd,i.call(this,n)}if(!r){var a=this.handlers;a&&a.stop()}return this},i.prototype._ease=function(n,i,a){!1===a.animate||0===a.duration?(n(1),i()):(this._easeStart=r.browser.now(),this._easeOptions=a,this._onEaseFrame=n,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},i.prototype._renderFrameCallback=function(){var n=Math.min((r.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},i.prototype._normalizeBearing=function(n,i){var a=Math.abs((n=r.wrap(n,-180,180))-i);return Math.abs(n-360-i)<a&&(n-=360),Math.abs(n+360-i)<a&&(n+=360),n},i.prototype._normalizeCenter=function(r){var n=this.transform;if(n.renderWorldCopies&&!n.lngRange){var i=r.lng-n.center.lng;r.lng+=i>180?-360:i<-180?360:0}},i}(r.Evented),rY=function(n){void 0===n&&(n={}),this.options=n,r.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};rY.prototype.getDefaultPosition=function(){return"bottom-right"},rY.prototype.onAdd=function(r){var n=this.options&&this.options.compact;return this._map=r,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=i.create("div","mapboxgl-ctrl-attrib-inner",this._container),n&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===n&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},rY.prototype.onRemove=function(){i.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},rY.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.config.ACCESS_TOKEN}];if(n){var a=i.reduce(function(r,n,a){return n.value&&(r+=n.key+"="+n.value+(a<i.length-1?"&":"")),r},"?");n.href=r.config.FEEDBACK_URL+"/"+a+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow"}},rY.prototype._updateData=function(r){r&&("metadata"===r.sourceDataType||"style"===r.dataType)&&(this._updateAttributions(),this._updateEditLink())},rY.prototype._updateAttributions=function(){if(this._map.style){var r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(function(r){return"string"!=typeof r?"":r})):"string"==typeof this.options.customAttribution&&r.push(this.options.customAttribution)),this._map.style.stylesheet){var n=this._map.style.stylesheet;this.styleOwner=n.owner,this.styleId=n.id}var i=this._map.style.sourceCaches;for(var a in i){var o=i[a];if(o.used){var s=o.getSource();s.attribution&&0>r.indexOf(s.attribution)&&r.push(s.attribution)}}r.sort(function(r,n){return r.length-n.length});var l=(r=r.filter(function(n,i){for(var a=i+1;a<r.length;a++)if(r[a].indexOf(n)>=0)return!1;return!0})).join(" | ");l!==this._attribHTML&&(this._attribHTML=l,r.length?(this._innerContainer.innerHTML=l,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},rY.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var rW=function(){r.bindAll(["_updateLogo"],this),r.bindAll(["_updateCompact"],this)};rW.prototype.onAdd=function(r){this._map=r,this._container=i.create("div","mapboxgl-ctrl");var n=i.create("a","mapboxgl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://www.mapbox.com/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},rW.prototype.onRemove=function(){i.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},rW.prototype.getDefaultPosition=function(){return"bottom-left"},rW.prototype._updateLogo=function(r){r&&"metadata"!==r.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},rW.prototype._logoRequired=function(){if(this._map.style){var r=this._map.style.sourceCaches;for(var n in r)if(r[n].getSource().mapbox_logo)return!0;return!1}},rW.prototype._updateCompact=function(){var r=this._container.children;if(r.length){var n=r[0];this._map.getCanvasContainer().offsetWidth<250?n.classList.add("mapboxgl-compact"):n.classList.remove("mapboxgl-compact")}};var rX=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};rX.prototype.add=function(r){var n=++this._id;return this._queue.push({callback:r,id:n,cancelled:!1}),n},rX.prototype.remove=function(r){for(var n=this._currentlyRunning,i=0,a=n?this._queue.concat(n):this._queue;i<a.length;i+=1){var o=a[i];if(o.id===r)return void(o.cancelled=!0)}},rX.prototype.run=function(r){void 0===r&&(r=0);var n=this._currentlyRunning=this._queue;this._queue=[];for(var i=0;i<n.length;i+=1){var a=n[i];if(!a.cancelled&&(a.callback(r),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},rX.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var rZ={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},rJ=r.window.HTMLImageElement,rK=r.window.HTMLElement,rQ=r.window.ImageBitmap,r$={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},r0=function(a){function o(n){var i=this;if(null!=(n=r.extend({},r$,n)).minZoom&&null!=n.maxZoom&&n.minZoom>n.maxZoom)throw Error("maxZoom must be greater than or equal to minZoom");if(null!=n.minPitch&&null!=n.maxPitch&&n.minPitch>n.maxPitch)throw Error("maxPitch must be greater than or equal to minPitch");if(null!=n.minPitch&&n.minPitch<0)throw Error("minPitch must be greater than or equal to 0");if(null!=n.maxPitch&&n.maxPitch>60)throw Error("maxPitch must be less than or equal to 60");var o=new e9(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies);if(a.call(this,o,n),this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._failIfMajorPerformanceCaveat=n.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=n.preserveDrawingBuffer,this._antialias=n.antialias,this._trackResize=n.trackResize,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=n.refreshExpiredTiles,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=n.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=n.collectResourceTiming,this._renderTaskQueue=new rX,this._controls=[],this._mapId=r.uniqueId(),this._locale=r.extend({},rZ,n.locale),this._requestManager=new r.RequestManager(n.transformRequest,n.accessToken),"string"==typeof n.container){if(this._container=r.window.document.getElementById(n.container),!this._container)throw Error("Container '"+n.container+"' not found.")}else{if(!(n.container instanceof rK))throw Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),r.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw Error("Failed to initialize WebGL.");this.on("move",function(){return i._update(!1)}),this.on("moveend",function(){return i._update(!1)}),this.on("zoom",function(){return i._update(!0)}),void 0!==r.window&&(r.window.addEventListener("online",this._onWindowOnline,!1),r.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new rq(this,n);var s="string"==typeof n.hash&&n.hash||void 0;this._hash=n.hash&&new rt(s).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(this.resize(),this.fitBounds(n.bounds,r.extend({},n.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=n.localIdeographFontFamily,n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new rY({customAttribution:n.customAttribution})),this.addControl(new rW,n.logoPosition),this.on("style.load",function(){i.transform.unmodified&&i.jumpTo(i.style.stylesheet)}),this.on("data",function(n){i._update("style"===n.dataType),i.fire(new r.Event(n.dataType+"data",n))}),this.on("dataloading",function(n){i.fire(new r.Event(n.dataType+"dataloading",n))})}a&&(o.__proto__=a),o.prototype=Object.create(a&&a.prototype),o.prototype.constructor=o;var s={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return o.prototype._getMapId=function(){return this._mapId},o.prototype.addControl=function(n,i){if(void 0===i&&n.getDefaultPosition&&(i=n.getDefaultPosition()),void 0===i&&(i="top-right"),!n||!n.onAdd)return this.fire(new r.ErrorEvent(Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var a=n.onAdd(this);this._controls.push(n);var o=this._controlPositions[i];return -1!==i.indexOf("bottom")?o.insertBefore(a,o.firstChild):o.appendChild(a),this},o.prototype.removeControl=function(n){if(!n||!n.onRemove)return this.fire(new r.ErrorEvent(Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var i=this._controls.indexOf(n);return i>-1&&this._controls.splice(i,1),n.onRemove(this),this},o.prototype.resize=function(n){var i=this._containerDimensions(),a=i[0],o=i[1];this._resizeCanvas(a,o),this.transform.resize(a,o),this.painter.resize(a,o);var s=!this._moving;return s&&(this.stop(),this.fire(new r.Event("movestart",n)).fire(new r.Event("move",n))),this.fire(new r.Event("resize",n)),s&&this.fire(new r.Event("moveend",n)),this},o.prototype.getBounds=function(){return this.transform.getBounds()},o.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},o.prototype.setMaxBounds=function(n){return this.transform.setMaxBounds(r.LngLatBounds.convert(n)),this._update()},o.prototype.setMinZoom=function(r){if((r=null==r?-2:r)>=-2&&r<=this.transform.maxZoom)return this.transform.minZoom=r,this._update(),this.getZoom()<r&&this.setZoom(r),this;throw Error("minZoom must be between -2 and the current maxZoom, inclusive")},o.prototype.getMinZoom=function(){return this.transform.minZoom},o.prototype.setMaxZoom=function(r){if((r=null==r?22:r)>=this.transform.minZoom)return this.transform.maxZoom=r,this._update(),this.getZoom()>r&&this.setZoom(r),this;throw Error("maxZoom must be greater than the current minZoom")},o.prototype.getMaxZoom=function(){return this.transform.maxZoom},o.prototype.setMinPitch=function(r){if((r=null==r?0:r)<0)throw Error("minPitch must be greater than or equal to 0");if(r>=0&&r<=this.transform.maxPitch)return this.transform.minPitch=r,this._update(),this.getPitch()<r&&this.setPitch(r),this;throw Error("minPitch must be between 0 and the current maxPitch, inclusive")},o.prototype.getMinPitch=function(){return this.transform.minPitch},o.prototype.setMaxPitch=function(r){if((r=null==r?60:r)>60)throw Error("maxPitch must be less than or equal to 60");if(r>=this.transform.minPitch)return this.transform.maxPitch=r,this._update(),this.getPitch()>r&&this.setPitch(r),this;throw Error("maxPitch must be greater than the current minPitch")},o.prototype.getMaxPitch=function(){return this.transform.maxPitch},o.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},o.prototype.setRenderWorldCopies=function(r){return this.transform.renderWorldCopies=r,this._update()},o.prototype.project=function(n){return this.transform.locationPoint(r.LngLat.convert(n))},o.prototype.unproject=function(n){return this.transform.pointLocation(r.Point.convert(n))},o.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},o.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},o.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},o.prototype._createDelegatedListener=function(r,n,i){var a,o=this;if("mouseenter"===r||"mouseover"===r){var s=!1;return{layer:n,listener:i,delegates:{mousemove:function(a){var l=o.getLayer(n)?o.queryRenderedFeatures(a.point,{layers:[n]}):[];l.length?s||(s=!0,i.call(o,new rc(r,o,a.originalEvent,{features:l}))):s=!1},mouseout:function(){s=!1}}}}if("mouseleave"===r||"mouseout"===r){var l=!1;return{layer:n,listener:i,delegates:{mousemove:function(a){(o.getLayer(n)?o.queryRenderedFeatures(a.point,{layers:[n]}):[]).length?l=!0:l&&(l=!1,i.call(o,new rc(r,o,a.originalEvent)))},mouseout:function(n){l&&(l=!1,i.call(o,new rc(r,o,n.originalEvent)))}}}}return{layer:n,listener:i,delegates:((a={})[r]=function(r){var a=o.getLayer(n)?o.queryRenderedFeatures(r.point,{layers:[n]}):[];a.length&&(r.features=a,i.call(o,r),delete r.features)},a)}},o.prototype.on=function(r,n,i){if(void 0===i)return a.prototype.on.call(this,r,n);var o=this._createDelegatedListener(r,n,i);for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[r]=this._delegatedListeners[r]||[],this._delegatedListeners[r].push(o),o.delegates)this.on(s,o.delegates[s]);return this},o.prototype.once=function(r,n,i){if(void 0===i)return a.prototype.once.call(this,r,n);var o=this._createDelegatedListener(r,n,i);for(var s in o.delegates)this.once(s,o.delegates[s]);return this},o.prototype.off=function(r,n,i){var o=this;return void 0===i?a.prototype.off.call(this,r,n):(this._delegatedListeners&&this._delegatedListeners[r]&&function(a){for(var s=a[r],l=0;l<s.length;l++){var c=s[l];if(c.layer===n&&c.listener===i){for(var u in c.delegates)o.off(u,c.delegates[u]);return s.splice(l,1),o}}}(this._delegatedListeners),this)},o.prototype.queryRenderedFeatures=function(n,i){if(!this.style)return[];if(void 0!==i||void 0===n||n instanceof r.Point||Array.isArray(n)||(i=n,n=void 0),i=i||{},(n=n||[[0,0],[this.transform.width,this.transform.height]])instanceof r.Point||"number"==typeof n[0])a=[r.Point.convert(n)];else{var a,o=r.Point.convert(n[0]),s=r.Point.convert(n[1]);a=[o,new r.Point(s.x,o.y),s,new r.Point(o.x,s.y),o]}return this.style.queryRenderedFeatures(a,i,this.transform)},o.prototype.querySourceFeatures=function(r,n){return this.style.querySourceFeatures(r,n)},o.prototype.setStyle=function(n,i){return!1!==(i=r.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&n?(this._diffStyle(n,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(n,i))},o.prototype._getUIString=function(r){var n=this._locale[r];if(null==n)throw Error("Missing UI string '"+r+"'");return n},o.prototype._updateStyle=function(r,n){return this.style&&(this.style.setEventedParent(null),this.style._remove()),r?(this.style=new ev(this,n||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof r?this.style.loadURL(r):this.style.loadJSON(r)):delete this.style,this},o.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ev(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},o.prototype._diffStyle=function(n,i){var a=this;if("string"==typeof n){var o=this._requestManager.normalizeStyleURL(n),s=this._requestManager.transformRequest(o,r.ResourceType.Style);r.getJSON(s,function(n,o){n?a.fire(new r.ErrorEvent(n)):o&&a._updateDiff(o,i)})}else"object"==typeof n&&this._updateDiff(n,i)},o.prototype._updateDiff=function(n,i){try{this.style.setState(n)&&this._update(!0)}catch(a){r.warnOnce("Unable to perform style diff: "+(a.message||a.error||a)+".  Rebuilding the style from scratch."),this._updateStyle(n,i)}},o.prototype.getStyle=function(){if(this.style)return this.style.serialize()},o.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():r.warnOnce("There is no style added to the map.")},o.prototype.addSource=function(r,n){return this._lazyInitEmptyStyle(),this.style.addSource(r,n),this._update(!0)},o.prototype.isSourceLoaded=function(n){var i=this.style&&this.style.sourceCaches[n];if(void 0!==i)return i.loaded();this.fire(new r.ErrorEvent(Error("There is no source with ID '"+n+"'")))},o.prototype.areTilesLoaded=function(){var r=this.style&&this.style.sourceCaches;for(var n in r){var i=r[n]._tiles;for(var a in i){var o=i[a];if("loaded"!==o.state&&"errored"!==o.state)return!1}}return!0},o.prototype.addSourceType=function(r,n,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(r,n,i)},o.prototype.removeSource=function(r){return this.style.removeSource(r),this._update(!0)},o.prototype.getSource=function(r){return this.style.getSource(r)},o.prototype.addImage=function(n,i,a){void 0===a&&(a={});var o=a.pixelRatio;void 0===o&&(o=1);var s=a.sdf;void 0===s&&(s=!1);var l=a.stretchX,c=a.stretchY,u=a.content;if(this._lazyInitEmptyStyle(),i instanceof rJ||rQ&&i instanceof rQ){var f=r.browser.getImageData(i),h=f.width,p=f.height,d=f.data;this.style.addImage(n,{data:new r.RGBAImage({width:h,height:p},d),pixelRatio:o,stretchX:l,stretchY:c,content:u,sdf:s,version:0})}else{if(void 0===i.width||void 0===i.height)return this.fire(new r.ErrorEvent(Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var m=i.width,g=i.height,v=i.data;this.style.addImage(n,{data:new r.RGBAImage({width:m,height:g},new Uint8Array(v)),pixelRatio:o,stretchX:l,stretchY:c,content:u,sdf:s,version:0,userImage:i}),i.onAdd&&i.onAdd(this,n)}},o.prototype.updateImage=function(n,i){var a=this.style.getImage(n);if(!a)return this.fire(new r.ErrorEvent(Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var o=i instanceof rJ||rQ&&i instanceof rQ?r.browser.getImageData(i):i,s=o.width,l=o.height,c=o.data;return void 0===s||void 0===l?this.fire(new r.ErrorEvent(Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):s!==a.data.width||l!==a.data.height?this.fire(new r.ErrorEvent(Error("The width and height of the updated image must be that same as the previous version of the image"))):void(a.data.replace(c,!(i instanceof rJ||rQ&&i instanceof rQ)),this.style.updateImage(n,a))},o.prototype.hasImage=function(n){return n?!!this.style.getImage(n):(this.fire(new r.ErrorEvent(Error("Missing required image id"))),!1)},o.prototype.removeImage=function(r){this.style.removeImage(r)},o.prototype.loadImage=function(n,i){r.getImage(this._requestManager.transformRequest(n,r.ResourceType.Image),i)},o.prototype.listImages=function(){return this.style.listImages()},o.prototype.addLayer=function(r,n){return this._lazyInitEmptyStyle(),this.style.addLayer(r,n),this._update(!0)},o.prototype.moveLayer=function(r,n){return this.style.moveLayer(r,n),this._update(!0)},o.prototype.removeLayer=function(r){return this.style.removeLayer(r),this._update(!0)},o.prototype.getLayer=function(r){return this.style.getLayer(r)},o.prototype.setLayerZoomRange=function(r,n,i){return this.style.setLayerZoomRange(r,n,i),this._update(!0)},o.prototype.setFilter=function(r,n,i){return void 0===i&&(i={}),this.style.setFilter(r,n,i),this._update(!0)},o.prototype.getFilter=function(r){return this.style.getFilter(r)},o.prototype.setPaintProperty=function(r,n,i,a){return void 0===a&&(a={}),this.style.setPaintProperty(r,n,i,a),this._update(!0)},o.prototype.getPaintProperty=function(r,n){return this.style.getPaintProperty(r,n)},o.prototype.setLayoutProperty=function(r,n,i,a){return void 0===a&&(a={}),this.style.setLayoutProperty(r,n,i,a),this._update(!0)},o.prototype.getLayoutProperty=function(r,n){return this.style.getLayoutProperty(r,n)},o.prototype.setLight=function(r,n){return void 0===n&&(n={}),this._lazyInitEmptyStyle(),this.style.setLight(r,n),this._update(!0)},o.prototype.getLight=function(){return this.style.getLight()},o.prototype.setFeatureState=function(r,n){return this.style.setFeatureState(r,n),this._update()},o.prototype.removeFeatureState=function(r,n){return this.style.removeFeatureState(r,n),this._update()},o.prototype.getFeatureState=function(r){return this.style.getFeatureState(r)},o.prototype.getContainer=function(){return this._container},o.prototype.getCanvasContainer=function(){return this._canvasContainer},o.prototype.getCanvas=function(){return this._canvas},o.prototype._containerDimensions=function(){var r=0,n=0;return this._container&&(r=this._container.clientWidth||400,n=this._container.clientHeight||300),[r,n]},o.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==r.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&r.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},o.prototype._setupContainer=function(){var r=this._container;r.classList.add("mapboxgl-map"),(this._missingCSSCanary=i.create("div","mapboxgl-canary",r)).style.visibility="hidden",this._detectMissingCSS();var n=this._canvasContainer=i.create("div","mapboxgl-canvas-container",r);this._interactive&&n.classList.add("mapboxgl-interactive"),this._canvas=i.create("canvas","mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var a=this._containerDimensions();this._resizeCanvas(a[0],a[1]);var o=this._controlContainer=i.create("div","mapboxgl-control-container",r),s=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(r){s[r]=i.create("div","mapboxgl-ctrl-"+r,o)})},o.prototype._resizeCanvas=function(n,i){var a=r.browser.devicePixelRatio||1;this._canvas.width=a*n,this._canvas.height=a*i,this._canvas.style.width=n+"px",this._canvas.style.height=i+"px"},o.prototype._setupPainter=function(){var i=r.extend({},n.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._canvas.getContext("webgl",i)||this._canvas.getContext("experimental-webgl",i);a?(this.painter=new e5(a,this.transform),r.webpSupported.testSupport(a)):this.fire(new r.ErrorEvent(Error("Failed to initialize WebGL")))},o.prototype._contextLost=function(n){n.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.Event("webglcontextlost",{originalEvent:n}))},o.prototype._contextRestored=function(n){this._setupPainter(),this.resize(),this._update(),this.fire(new r.Event("webglcontextrestored",{originalEvent:n}))},o.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},o.prototype._update=function(r){return this.style&&(this._styleDirty=this._styleDirty||r,this._sourcesDirty=!0,this.triggerRepaint()),this},o.prototype._requestRenderFrame=function(r){return this._update(),this._renderTaskQueue.add(r)},o.prototype._cancelRenderFrame=function(r){this._renderTaskQueue.remove(r)},o.prototype._render=function(n){var i,a=this,o=0,s=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(i=s.createQueryEXT(),s.beginQueryEXT(s.TIME_ELAPSED_EXT,i),o=r.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(n),!this._removed){var l=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var c=this.transform.zoom,u=r.browser.now();this.style.zoomHistory.update(c,u);var f=new r.EvaluationParameters(c,{now:u,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),h=f.crossFadingFactor();1===h&&h===this._crossFadingFactor||(l=!0,this._crossFadingFactor=h),this.style.update(f)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new r.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new r.Event("load"))),this.style&&(this.style.hasTransitions()||l)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var p=r.browser.now()-o;s.endQueryEXT(s.TIME_ELAPSED_EXT,i),setTimeout(function(){var n=s.getQueryObjectEXT(i,s.QUERY_RESULT_EXT)/1e6;s.deleteQueryEXT(i),a.fire(new r.Event("gpu-timing-frame",{cpuTime:p,gpuTime:n}))},50)}if(this.listens("gpu-timing-layer")){var d=this.painter.collectGpuTimers();setTimeout(function(){var n=a.painter.queryGpuTimers(d);a.fire(new r.Event("gpu-timing-layer",{layerTimes:n}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new r.Event("idle"))),this}},o.prototype.remove=function(){this._hash&&this._hash.remove();for(var n=0,i=this._controls;n<i.length;n+=1)i[n].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==r.window&&(r.window.removeEventListener("resize",this._onWindowResize,!1),r.window.removeEventListener("online",this._onWindowOnline,!1));var a=this.painter.context.gl.getExtension("WEBGL_lose_context");a&&a.loseContext(),r1(this._canvasContainer),r1(this._controlContainer),r1(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new r.Event("remove"))},o.prototype.triggerRepaint=function(){var n=this;this.style&&!this._frame&&(this._frame=r.browser.frame(function(r){n._frame=null,n._render(r)}))},o.prototype._onWindowOnline=function(){this._update()},o.prototype._onWindowResize=function(r){this._trackResize&&this.resize({originalEvent:r})._update()},s.showTileBoundaries.get=function(){return!!this._showTileBoundaries},s.showTileBoundaries.set=function(r){this._showTileBoundaries!==r&&(this._showTileBoundaries=r,this._update())},s.showPadding.get=function(){return!!this._showPadding},s.showPadding.set=function(r){this._showPadding!==r&&(this._showPadding=r,this._update())},s.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},s.showCollisionBoxes.set=function(r){this._showCollisionBoxes!==r&&(this._showCollisionBoxes=r,r?this.style._generateCollisionBoxes():this._update())},s.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},s.showOverdrawInspector.set=function(r){this._showOverdrawInspector!==r&&(this._showOverdrawInspector=r,this._update())},s.repaint.get=function(){return!!this._repaint},s.repaint.set=function(r){this._repaint!==r&&(this._repaint=r,this.triggerRepaint())},s.vertices.get=function(){return!!this._vertices},s.vertices.set=function(r){this._vertices=r,this._update()},o.prototype._setCacheLimits=function(n,i){r.setCacheLimits(n,i)},s.version.get=function(){return r.version},Object.defineProperties(o.prototype,s),o}(rG);function r1(r){r.parentNode&&r.parentNode.removeChild(r)}var r2={showCompass:!0,showZoom:!0,visualizePitch:!1},r3=function(n){var a=this;this.options=r.extend({},r2,n),this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(r){return r.preventDefault()}),this.options.showZoom&&(r.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(r){return a._map.zoomIn({},{originalEvent:r})}),i.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(r){return a._map.zoomOut({},{originalEvent:r})}),i.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(r.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(r){a.options.visualizePitch?a._map.resetNorthPitch({},{originalEvent:r}):a._map.resetNorth({},{originalEvent:r})}),this._compassIcon=i.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};r3.prototype._updateZoomButtons=function(){var r=this._map.getZoom();this._zoomInButton.disabled=r===this._map.getMaxZoom(),this._zoomOutButton.disabled=r===this._map.getMinZoom()},r3.prototype._rotateCompassArrow=function(){var r=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=r},r3.prototype.onAdd=function(r){return this._map=r,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new r5(this._map,this._compass,this.options.visualizePitch)),this._container},r3.prototype.onRemove=function(){i.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},r3.prototype._createButton=function(r,n){var a=i.create("button",r,this._container);return a.type="button",a.addEventListener("click",n),a},r3.prototype._setButtonTitle=function(r,n){var i=this._map._getUIString("NavigationControl."+n);r.title=i,r.setAttribute("aria-label",i)};var r5=function(n,a,o){void 0===o&&(o=!1),this._clickTolerance=10,this.element=a,this.mouseRotate=new r_({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new rw({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),r.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),i.addEventListener(a,"mousedown",this.mousedown),i.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),i.addEventListener(a,"touchmove",this.touchmove),i.addEventListener(a,"touchend",this.touchend),i.addEventListener(a,"touchcancel",this.reset)};function r4(n,i,a){if(n=new r.LngLat(n.lng,n.lat),i){var o=new r.LngLat(n.lng-360,n.lat),s=new r.LngLat(n.lng+360,n.lat),l=a.locationPoint(n).distSqr(i);a.locationPoint(o).distSqr(i)<l?n=o:a.locationPoint(s).distSqr(i)<l&&(n=s)}for(;Math.abs(n.lng-a.center.lng)>180;){var c=a.locationPoint(n);if(c.x>=0&&c.y>=0&&c.x<=a.width&&c.y<=a.height)break;n.lng>a.center.lng?n.lng-=360:n.lng+=360}return n}r5.prototype.down=function(r,n){this.mouseRotate.mousedown(r,n),this.mousePitch&&this.mousePitch.mousedown(r,n),i.disableDrag()},r5.prototype.move=function(r,n){var i=this.map,a=this.mouseRotate.mousemoveWindow(r,n);if(a&&a.bearingDelta&&i.setBearing(i.getBearing()+a.bearingDelta),this.mousePitch){var o=this.mousePitch.mousemoveWindow(r,n);o&&o.pitchDelta&&i.setPitch(i.getPitch()+o.pitchDelta)}},r5.prototype.off=function(){var r=this.element;i.removeEventListener(r,"mousedown",this.mousedown),i.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),i.removeEventListener(r,"touchmove",this.touchmove),i.removeEventListener(r,"touchend",this.touchend),i.removeEventListener(r,"touchcancel",this.reset),this.offTemp()},r5.prototype.offTemp=function(){i.enableDrag(),i.removeEventListener(r.window,"mousemove",this.mousemove),i.removeEventListener(r.window,"mouseup",this.mouseup)},r5.prototype.mousedown=function(n){this.down(r.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),i.mousePos(this.element,n)),i.addEventListener(r.window,"mousemove",this.mousemove),i.addEventListener(r.window,"mouseup",this.mouseup)},r5.prototype.mousemove=function(r){this.move(r,i.mousePos(this.element,r))},r5.prototype.mouseup=function(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()},r5.prototype.touchstart=function(r){1!==r.targetTouches.length?this.reset():(this._startPos=this._lastPos=i.touchPos(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return r.preventDefault()}},this._startPos))},r5.prototype.touchmove=function(r){1!==r.targetTouches.length?this.reset():(this._lastPos=i.touchPos(this.element,r.targetTouches)[0],this.move({preventDefault:function(){return r.preventDefault()}},this._lastPos))},r5.prototype.touchend=function(r){0===r.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},r5.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var r6={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function r8(r,n,i){var a=r.classList;for(var o in r6)a.remove("mapboxgl-"+i+"-anchor-"+o);a.add("mapboxgl-"+i+"-anchor-"+n)}var r9,r7=function(n){function a(a,o){var s=this;if(n.call(this),(a instanceof r.window.HTMLElement||o)&&(a=r.extend({element:a},o)),r.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._draggable=a&&a.draggable||!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&"auto"!==a.pitchAlignment?a.pitchAlignment:this._rotationAlignment,a&&a.element)this._element=a.element,this._offset=r.Point.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=i.create("div"),this._element.setAttribute("aria-label","Map marker");var l=i.createNS("http://www.w3.org/2000/svg","svg");l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height","41px"),l.setAttributeNS(null,"width","27px"),l.setAttributeNS(null,"viewBox","0 0 27 41");var c=i.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"stroke","none"),c.setAttributeNS(null,"stroke-width","1"),c.setAttributeNS(null,"fill","none"),c.setAttributeNS(null,"fill-rule","evenodd");var u=i.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill-rule","nonzero");var f=i.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(3.0, 29.0)"),f.setAttributeNS(null,"fill","#000000");for(var h=0,p=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];h<p.length;h+=1){var d=p[h],m=i.createNS("http://www.w3.org/2000/svg","ellipse");m.setAttributeNS(null,"opacity","0.04"),m.setAttributeNS(null,"cx","10.5"),m.setAttributeNS(null,"cy","5.80029008"),m.setAttributeNS(null,"rx",d.rx),m.setAttributeNS(null,"ry",d.ry),f.appendChild(m)}var g=i.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"fill",this._color);var v=i.createNS("http://www.w3.org/2000/svg","path");v.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),g.appendChild(v);var y=i.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"opacity","0.25"),y.setAttributeNS(null,"fill","#000000");var x=i.createNS("http://www.w3.org/2000/svg","path");x.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),y.appendChild(x);var b=i.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(6.0, 7.0)"),b.setAttributeNS(null,"fill","#FFFFFF");var _=i.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"transform","translate(8.0, 8.0)");var w=i.createNS("http://www.w3.org/2000/svg","circle");w.setAttributeNS(null,"fill","#000000"),w.setAttributeNS(null,"opacity","0.25"),w.setAttributeNS(null,"cx","5.5"),w.setAttributeNS(null,"cy","5.5"),w.setAttributeNS(null,"r","5.4999962");var T=i.createNS("http://www.w3.org/2000/svg","circle");T.setAttributeNS(null,"fill","#FFFFFF"),T.setAttributeNS(null,"cx","5.5"),T.setAttributeNS(null,"cy","5.5"),T.setAttributeNS(null,"r","5.4999962"),_.appendChild(w),_.appendChild(T),u.appendChild(f),u.appendChild(g),u.appendChild(y),u.appendChild(b),u.appendChild(_),l.appendChild(u),this._element.appendChild(l),this._offset=r.Point.convert(a&&a.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(r){r.preventDefault()}),this._element.addEventListener("mousedown",function(r){r.preventDefault()}),this._element.addEventListener("focus",function(){var r=s._map.getContainer();r.scrollTop=0,r.scrollLeft=0}),r8(this._element,this._anchor,"marker"),this._popup=null}return n&&(a.__proto__=n),a.prototype=Object.create(n&&n.prototype),a.prototype.constructor=a,a.prototype.addTo=function(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),i.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=r.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){var n=Math.sqrt(91.125);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[n,-1*(24.6+n)],"bottom-right":[-n,-1*(24.6+n)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(r){var n=r.code,i=r.charCode||r.keyCode;"Space"!==n&&"Enter"!==n&&32!==i&&13!==i||this.togglePopup()},a.prototype._onMapClick=function(r){var n=r.originalEvent.target,i=this._element;this._popup&&(n===i||i.contains(n))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var r=this._popup;return r&&(r.isOpen()?r.remove():r.addTo(this._map)),this},a.prototype._update=function(r){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=r4(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var n="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?n="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(n="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var a="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?a="rotateX(0deg)":"map"===this._pitchAlignment&&(a="rotateX("+this._map.getPitch()+"deg)"),r&&"moveend"!==r.type||(this._pos=this._pos.round()),i.setTransform(this._element,r6[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+a+" "+n)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(n){return this._offset=r.Point.convert(n),this._update(),this},a.prototype._onMove=function(n){this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new r.Event("dragstart"))),this.fire(new r.Event("drag"))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new r.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(r){this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(r){return this._rotation=r||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(r){return this._rotationAlignment=r||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(r){return this._pitchAlignment=r&&"auto"!==r?r:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(r.Evented),nt={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},ne=0,nr=!1,nn=function(n){function a(i){n.call(this),this.options=r.extend({},nt,i),r.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(a.__proto__=n),a.prototype=Object.create(n&&n.prototype),a.prototype.constructor=a,a.prototype.onAdd=function(n){var a;return this._map=n,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),a=this._setupUI,void 0!==r9?a(r9):void 0!==r.window.navigator.permissions?r.window.navigator.permissions.query({name:"geolocation"}).then(function(r){a(r9="denied"!==r.state)}):a(r9=!!r.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(r.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),i.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ne=0,nr=!1},a.prototype._isOutOfMapMaxBounds=function(r){var n=this._map.getMaxBounds(),i=r.coords;return n&&(i.longitude<n.getWest()||i.longitude>n.getEast()||i.latitude<n.getSouth()||i.latitude>n.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(n){if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new r.Event("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(n),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("geolocate",n)),this._finish()}},a.prototype._updateCamera=function(n){var i=new r.LngLat(n.coords.longitude,n.coords.latitude),a=n.coords.accuracy,o=this._map.getBearing(),s=r.extend({bearing:o},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(a),s,{geolocateSource:!0})},a.prototype._updateMarker=function(n){if(n){var i=new r.LngLat(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var r=this._map._container.clientHeight/2,n=this._map.unproject([0,r]),i=this._map.unproject([1,r]),a=n.distanceTo(i),o=Math.ceil(2*this._accuracy/a);this._circleElement.style.width=o+"px",this._circleElement.style.height=o+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(n){if(this._map){if(this.options.trackUserLocation){if(1===n.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===n.code&&nr)return;this._setErrorState()}}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("error",n)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(n){var a=this;if(this._container.addEventListener("contextmenu",function(r){return r.preventDefault()}),this._geolocateButton=i.create("button","mapboxgl-ctrl-geolocate",this._container),i.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===n){r.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{var s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=i.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new r7(this._dotElement),this._circleElement=i.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new r7({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(n){var i=n.originalEvent&&"resize"===n.originalEvent.type;n.geolocateSource||"ACTIVE_LOCK"!==a._watchState||i||(a._watchState="BACKGROUND",a._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),a._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),a.fire(new r.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return r.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ne--,nr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var n;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++ne>1?(n={maximumAge:6e5,timeout:0},nr=!0):(n=this.options.positionOptions,nr=!1),this._geolocationWatchID=r.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,n)}}else r.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){r.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(r.Evented),ni={maxWidth:100,unit:"metric"},na=function(n){this.options=r.extend({},ni,n),r.bindAll(["_onMove","setUnit"],this)};function no(r,n,i){var a=i&&i.maxWidth||100,o=r._container.clientHeight/2,s=r.unproject([0,o]),l=r.unproject([a,o]),c=s.distanceTo(l);if(i&&"imperial"===i.unit){var u=3.2808*c;u>5280?ns(n,a,u/5280,r._getUIString("ScaleControl.Miles")):ns(n,a,u,r._getUIString("ScaleControl.Feet"))}else i&&"nautical"===i.unit?ns(n,a,c/1852,r._getUIString("ScaleControl.NauticalMiles")):c>=1e3?ns(n,a,c/1e3,r._getUIString("ScaleControl.Kilometers")):ns(n,a,c,r._getUIString("ScaleControl.Meters"))}function ns(r,n,i,a){var o,s,l,c,u=(l=Math.pow(10,(""+Math.floor(i)).length-1),c=(c=i/l)>=10?10:c>=5?5:c>=3?3:c>=2?2:c>=1?1:(s=Math.pow(10,Math.ceil(-Math.log(o=c)/Math.LN10)),Math.round(o*s)/s),l*c);r.style.width=u/i*n+"px",r.innerHTML=u+"&nbsp;"+a}na.prototype.getDefaultPosition=function(){return"bottom-left"},na.prototype._onMove=function(){no(this._map,this._container,this.options)},na.prototype.onAdd=function(r){return this._map=r,this._container=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",r.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},na.prototype.onRemove=function(){i.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},na.prototype.setUnit=function(r){this.options.unit=r,no(this._map,this._container,this.options)};var nl=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof r.window.HTMLElement?this._container=n.container:r.warnOnce("Full screen control 'container' must be a DOM element.")),r.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in r.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in r.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in r.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in r.window.document&&(this._fullscreenchange="MSFullscreenChange")};nl.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=i.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},nl.prototype.onRemove=function(){i.remove(this._controlContainer),this._map=null,r.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},nl.prototype._checkFullscreenSupport=function(){return!!(r.window.document.fullscreenEnabled||r.window.document.mozFullScreenEnabled||r.window.document.msFullscreenEnabled||r.window.document.webkitFullscreenEnabled)},nl.prototype._setupUI=function(){var n=this._fullscreenButton=i.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);i.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),r.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},nl.prototype._updateTitle=function(){var r=this._getTitle();this._fullscreenButton.setAttribute("aria-label",r),this._fullscreenButton.title=r},nl.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},nl.prototype._isFullscreen=function(){return this._fullscreen},nl.prototype._changeIcon=function(){(r.window.document.fullscreenElement||r.window.document.mozFullScreenElement||r.window.document.webkitFullscreenElement||r.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},nl.prototype._onClickFullscreen=function(){this._isFullscreen()?r.window.document.exitFullscreen?r.window.document.exitFullscreen():r.window.document.mozCancelFullScreen?r.window.document.mozCancelFullScreen():r.window.document.msExitFullscreen?r.window.document.msExitFullscreen():r.window.document.webkitCancelFullScreen&&r.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var nc={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},nu=function(n){function a(i){n.call(this),this.options=r.extend(Object.create(nc),i),r.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(a.__proto__=n),a.prototype=Object.create(n&&n.prototype),a.prototype.constructor=a,a.prototype.addTo=function(n){return this._map&&this.remove(),this._map=n,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new r.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&i.remove(this._content),this._container&&(i.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new r.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(n){return this._lngLat=r.LngLat.convert(n),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(n){return this.setDOMContent(r.window.document.createTextNode(n))},a.prototype.setHTML=function(n){var i,a=r.window.document.createDocumentFragment(),o=r.window.document.createElement("body");for(o.innerHTML=n;i=o.firstChild;)a.appendChild(i);return this.setDOMContent(a)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(r){return this.options.maxWidth=r,this._update(),this},a.prototype.setDOMContent=function(r){return this._createContent(),this._content.appendChild(r),this._update(),this},a.prototype.addClassName=function(r){this._container&&this._container.classList.add(r)},a.prototype.removeClassName=function(r){this._container&&this._container.classList.remove(r)},a.prototype.toggleClassName=function(r){if(this._container)return this._container.classList.toggle(r)},a.prototype._createContent=function(){this._content&&i.remove(this._content),this._content=i.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=i.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(r){this._update(r.point)},a.prototype._onMouseMove=function(r){this._update(r.point)},a.prototype._onDrag=function(r){this._update(r.point)},a.prototype._update=function(n){var a=this,o=this._lngLat||this._trackPointer;if(this._map&&o&&this._content&&(this._container||(this._container=i.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=i.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(r){return a._container.classList.add(r)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=r4(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||n)){var s=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat),l=this.options.anchor,c=function n(i){if(i){if("number"==typeof i){var a=Math.round(Math.sqrt(.5*Math.pow(i,2)));return{center:new r.Point(0,0),top:new r.Point(0,i),"top-left":new r.Point(a,a),"top-right":new r.Point(-a,a),bottom:new r.Point(0,-i),"bottom-left":new r.Point(a,-a),"bottom-right":new r.Point(-a,-a),left:new r.Point(i,0),right:new r.Point(-i,0)}}if(i instanceof r.Point||Array.isArray(i)){var o=r.Point.convert(i);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:r.Point.convert(i.center||[0,0]),top:r.Point.convert(i.top||[0,0]),"top-left":r.Point.convert(i["top-left"]||[0,0]),"top-right":r.Point.convert(i["top-right"]||[0,0]),bottom:r.Point.convert(i.bottom||[0,0]),"bottom-left":r.Point.convert(i["bottom-left"]||[0,0]),"bottom-right":r.Point.convert(i["bottom-right"]||[0,0]),left:r.Point.convert(i.left||[0,0]),right:r.Point.convert(i.right||[0,0])}}return n(new r.Point(0,0))}(this.options.offset);if(!l){var u,f=this._container.offsetWidth,h=this._container.offsetHeight;u=s.y+c.bottom.y<h?["top"]:s.y>this._map.transform.height-h?["bottom"]:[],s.x<f/2?u.push("left"):s.x>this._map.transform.width-f/2&&u.push("right"),l=0===u.length?"bottom":u.join("-")}var p=s.add(c[l]).round();i.setTransform(this._container,r6[l]+" translate("+p.x+"px,"+p.y+"px)"),r8(this._container,l,"popup")}},a.prototype._onClose=function(){this.remove()},a}(r.Evented),nf={version:r.version,supported:n,setRTLTextPlugin:r.setRTLTextPlugin,getRTLTextPluginStatus:r.getRTLTextPluginStatus,Map:r0,NavigationControl:r3,GeolocateControl:nn,AttributionControl:rY,ScaleControl:na,FullscreenControl:nl,Popup:nu,Marker:r7,Style:ev,LngLat:r.LngLat,LngLatBounds:r.LngLatBounds,Point:r.Point,MercatorCoordinate:r.MercatorCoordinate,Evented:r.Evented,config:r.config,prewarm:function(){tz().acquire(tC)},clearPrewarmedResources:function(){var r=tI;r&&(r.isPreloaded()&&1===r.numActive()?(r.release(tC),tI=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return r.config.ACCESS_TOKEN},set accessToken(e){r.config.ACCESS_TOKEN=e},get baseApiUrl(){return r.config.API_URL},set baseApiUrl(e){r.config.API_URL=e},get workerCount(){return tP.workerCount},set workerCount(t){tP.workerCount=t},get maxParallelImageRequests(){return r.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){r.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage:function(n){r.clearTileCache(n)},workerUrl:""};return nf}),i},"object"==typeof i&&void 0!==n?n.exports=o():(a=a||self).mapboxgl=o()},{}],240:[function(r,n,i){"use strict";n.exports=Math.log2||function(r){return Math.log(r)*Math.LOG2E}},{}],241:[function(r,n,i){"use strict";n.exports=function(r,n){n||(n=r,r=window);var i=0,o=0,s=0,l={shift:!1,alt:!1,control:!1,meta:!1},c=!1;function u(r){var n=!1;return"altKey"in r&&(n=n||r.altKey!==l.alt,l.alt=!!r.altKey),"shiftKey"in r&&(n=n||r.shiftKey!==l.shift,l.shift=!!r.shiftKey),"ctrlKey"in r&&(n=n||r.ctrlKey!==l.control,l.control=!!r.ctrlKey),"metaKey"in r&&(n=n||r.metaKey!==l.meta,l.meta=!!r.metaKey),n}function f(r,c){var f=a.x(c),h=a.y(c);"buttons"in c&&(r=0|c.buttons),(r!==i||f!==o||h!==s||u(c))&&(i=0|r,o=f||0,s=h||0,n&&n(i,o,s,l))}function h(r){f(0,r)}function p(){(i||o||s||l.shift||l.alt||l.meta||l.control)&&(o=s=0,i=0,l.shift=l.alt=l.control=l.meta=!1,n&&n(0,0,0,l))}function d(r){u(r)&&n&&n(i,o,s,l)}function m(r){0===a.buttons(r)?f(0,r):f(i,r)}function g(r){f(i|a.buttons(r),r)}function v(r){f(i&~a.buttons(r),r)}function y(){c||(c=!0,r.addEventListener("mousemove",m),r.addEventListener("mousedown",g),r.addEventListener("mouseup",v),r.addEventListener("mouseleave",h),r.addEventListener("mouseenter",h),r.addEventListener("mouseout",h),r.addEventListener("mouseover",h),r.addEventListener("blur",p),r.addEventListener("keyup",d),r.addEventListener("keydown",d),r.addEventListener("keypress",d),r!==window&&(window.addEventListener("blur",p),window.addEventListener("keyup",d),window.addEventListener("keydown",d),window.addEventListener("keypress",d)))}y();var x={element:r};return Object.defineProperties(x,{enabled:{get:function(){return c},set:function(n){n?y():c&&(c=!1,r.removeEventListener("mousemove",m),r.removeEventListener("mousedown",g),r.removeEventListener("mouseup",v),r.removeEventListener("mouseleave",h),r.removeEventListener("mouseenter",h),r.removeEventListener("mouseout",h),r.removeEventListener("mouseover",h),r.removeEventListener("blur",p),r.removeEventListener("keyup",d),r.removeEventListener("keydown",d),r.removeEventListener("keypress",d),r!==window&&(window.removeEventListener("blur",p),window.removeEventListener("keyup",d),window.removeEventListener("keydown",d),window.removeEventListener("keypress",d)))},enumerable:!0},buttons:{get:function(){return i},enumerable:!0},x:{get:function(){return o},enumerable:!0},y:{get:function(){return s},enumerable:!0},mods:{get:function(){return l},enumerable:!0}}),x};var a=r("mouse-event")},{"mouse-event":243}],242:[function(r,n,i){var a={left:0,top:0};n.exports=function(r,n,i){n=n||r.currentTarget||r.srcElement,Array.isArray(i)||(i=[0,0]);var o,s=r.clientX||0,l=r.clientY||0,c=(o=n)===window||o===document||o===document.body?a:o.getBoundingClientRect();return i[0]=s-c.left,i[1]=l-c.top,i}},{}],243:[function(r,n,i){"use strict";function a(r){return r.target||r.srcElement||window}i.buttons=function(r){if("object"==typeof r){if("buttons"in r)return r.buttons;if("which"in r){if(2===(n=r.which))return 4;if(3===n)return 2;if(n>0)return 1<<n-1}else if("button"in r){var n;if(1===(n=r.button))return 4;if(2===n)return 2;if(n>=0)return 1<<n}}return 0},i.element=a,i.x=function(r){if("object"==typeof r){if("offsetX"in r)return r.offsetX;var n=a(r).getBoundingClientRect();return r.clientX-n.left}return 0},i.y=function(r){if("object"==typeof r){if("offsetY"in r)return r.offsetY;var n=a(r).getBoundingClientRect();return r.clientY-n.top}return 0}},{}],244:[function(r,n,i){"use strict";var a=r("to-px");n.exports=function(r,n,i){"function"==typeof r&&(i=!!n,n=r,r=window);var o=a("ex",r),s=function(r){i&&r.preventDefault();var a=r.deltaX||0,s=r.deltaY||0,l=r.deltaZ||0,c=1;switch(r.deltaMode){case 1:c=o;break;case 2:c=window.innerHeight}if(s*=c,l*=c,(a*=c)||s||l)return n(a,s,l,r)};return r.addEventListener("wheel",s),s}},{"to-px":314}],245:[function(r,n,a){(function(r,i){(function(){var a,o;/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/a="Promise",(o=void 0!==r?r:this)[a]=o[a]||function(){"use strict";var r,n,a,o=Object.prototype.toString,s=void 0!==i?function(r){return i(r)}:setTimeout;try{Object.defineProperty({},"x",{}),r=function(r,n,i,a){return Object.defineProperty(r,n,{value:i,writable:!0,configurable:!1!==a})}}catch(n){r=function(r,n,i){return r[n]=i,r}}function l(r,i){a.add(r,i),n||(n=s(a.drain))}function c(r){var n,i=typeof r;return null==r||"object"!=i&&"function"!=i||(n=r.then),"function"==typeof n&&n}function u(){for(var r=0;r<this.chain.length;r++)(function(r,n,i){var a,o;try{!1===n?i.reject(r.msg):(a=!0===n?r.msg:n.call(void 0,r.msg))===i.promise?i.reject(TypeError("Promise-chain cycle")):(o=c(a))?o.call(a,i.resolve,i.reject):i.resolve(a)}catch(r){i.reject(r)}})(this,1===this.state?this.chain[r].success:this.chain[r].failure,this.chain[r]);this.chain.length=0}function f(r){var n,i=this;if(!i.triggered){i.triggered=!0,i.def&&(i=i.def);try{(n=c(r))?l(function(){var a=new d(i);try{n.call(r,function(){f.apply(a,arguments)},function(){h.apply(a,arguments)})}catch(r){h.call(a,r)}}):(i.msg=r,i.state=1,i.chain.length>0&&l(u,i))}catch(r){h.call(new d(i),r)}}}function h(r){var n=this;n.triggered||(n.triggered=!0,n.def&&(n=n.def),n.msg=r,n.state=2,n.chain.length>0&&l(u,n))}function p(r,n,i,a){for(var o=0;o<n.length;o++)!function(o){r.resolve(n[o]).then(function(r){i(o,r)},a)}(o)}function d(r){this.def=r,this.triggered=!1}function m(r){this.promise=r,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function g(r){if("function"!=typeof r)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var n=new m(this);this.then=function(r,i){var a={success:"function"!=typeof r||r,failure:"function"==typeof i&&i};return a.promise=new this.constructor(function(r,n){if("function"!=typeof r||"function"!=typeof n)throw TypeError("Not a function");a.resolve=r,a.reject=n}),n.chain.push(a),0!==n.state&&l(u,n),a.promise},this.catch=function(r){return this.then(void 0,r)};try{r.call(void 0,function(r){f.call(n,r)},function(r){h.call(n,r)})}catch(r){h.call(n,r)}}a=function(){var r,i,a;function o(r,n){this.fn=r,this.self=n,this.next=void 0}return{add:function(n,s){a=new o(n,s),i?i.next=a:r=a,i=a,a=void 0},drain:function(){var a=r;for(r=i=n=void 0;a;)a.fn.call(a.self),a=a.next}}}();var v=r({},"constructor",g,!1);return g.prototype=v,r(v,"__NPO__",0,!1),r(g,"resolve",function(r){return r&&"object"==typeof r&&1===r.__NPO__?r:new this(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");n(r)})}),r(g,"reject",function(r){return new this(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");i(r)})}),r(g,"all",function(r){var n=this;return"[object Array]"!=o.call(r)?n.reject(TypeError("Not an array")):0===r.length?n.resolve([]):new n(function(i,a){if("function"!=typeof i||"function"!=typeof a)throw TypeError("Not a function");var o=r.length,s=Array(o),l=0;p(n,r,function(r,n){s[r]=n,++l===o&&i(s)},a)})}),r(g,"race",function(r){var n=this;return"[object Array]"!=o.call(r)?n.reject(TypeError("Not an array")):new n(function(i,a){if("function"!=typeof i||"function"!=typeof a)throw TypeError("Not a function");p(n,r,function(r,n){i(n)},a)})}),g}(),void 0!==n&&n.exports&&(n.exports=o[a])}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},r("timers").setImmediate)},{timers:311}],246:[function(r,n,i){var a=Math.PI,o=a/180*120;function s(r,n,i,a){return["C",r,n,i,a,i,a]}function l(r,n,i,a,o,s){return["C",r/3+2/3*i,n/3+2/3*a,o/3+2/3*i,s/3+2/3*a,o,s]}function c(r,n,i){return{x:r*Math.cos(i)-n*Math.sin(i),y:r*Math.sin(i)+n*Math.cos(i)}}n.exports=function(r){for(var n,i=[],u=0,f=0,h=0,p=0,d=null,m=null,g=0,v=0,y=0,x=r.length;y<x;y++){var b=r[y],_=b[0];switch(_){case"M":h=b[1],p=b[2];break;case"A":(b=function r(n,i,s,l,u,f,h,p,d,m){if(m)A=m[0],M=m[1],T=m[2],k=m[3];else{var g=c(n,i,-u);n=g.x,i=g.y;var v=(n-(p=(g=c(p,d,-u)).x))/2,y=(i-(d=g.y))/2,x=v*v/(s*s)+y*y/(l*l);x>1&&(s*=x=Math.sqrt(x),l*=x);var b=s*s,_=l*l,w=(f==h?-1:1)*Math.sqrt(Math.abs((b*_-b*y*y-_*v*v)/(b*y*y+_*v*v)));w==1/0&&(w=1);var T=w*s*y/l+(n+p)/2,k=-(w*l)*v/s+(i+d)/2,A=Math.asin(((i-k)/l).toFixed(9)),M=Math.asin(((d-k)/l).toFixed(9));(A=n<T?a-A:A)<0&&(A=2*a+A),(M=p<T?a-M:M)<0&&(M=2*a+M),h&&A>M&&(A-=2*a),!h&&M>A&&(M-=2*a)}if(Math.abs(M-A)>o)var S=M,E=p,L=d,C=r(p=T+s*Math.cos(M=A+o*(h&&M>A?1:-1)),d=k+l*Math.sin(M),s,l,u,0,h,E,L,[M,S,T,k]);var P=Math.tan((M-A)/4),I=4/3*s*P,O=4/3*l*P,z=[2*n-(n+I*Math.sin(A)),2*i-(i-O*Math.cos(A)),p+I*Math.sin(M),d-O*Math.cos(M),p,d];if(m)return z;C&&(z=z.concat(C));for(var D=0;D<z.length;){var R=c(z[D],z[D+1],u);z[D++]=R.x,z[D++]=R.y}return z}(g,v,b[1],b[2],a/180*b[3],b[4],b[5],b[6],b[7])).unshift("C"),b.length>7&&(i.push(b.splice(0,7)),b.unshift("C"));break;case"S":var w=g,T=v;"C"!=n&&"S"!=n||(w+=w-u,T+=T-f),b=["C",w,T,b[1],b[2],b[3],b[4]];break;case"T":"Q"==n||"T"==n?(d=2*g-d,m=2*v-m):(d=g,m=v),b=l(g,v,d,m,b[1],b[2]);break;case"Q":d=b[1],m=b[2],b=l(g,v,b[1],b[2],b[3],b[4]);break;case"L":b=s(g,v,b[1],b[2]);break;case"H":b=s(g,v,b[1],v);break;case"V":b=s(g,v,g,b[1]);break;case"Z":b=s(g,v,h,p)}n=_,g=b[b.length-2],v=b[b.length-1],b.length>4?(u=b[b.length-4],f=b[b.length-3]):(u=g,f=v),i.push(b)}return i}},{}],247:[function(r,n,i){/*
object-assign
(c) Sindre Sorhus
@license MIT
*/"use strict";var a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;n.exports=!function(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de","5"===Object.getOwnPropertyNames(r)[0])return!1;for(var n={},i=0;i<10;i++)n["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(n).map(function(r){return n[r]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(r){a[r]=r}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(r){return!1}}()?function(r,n){for(var i,l,c=function(r){if(null==r)throw TypeError("Object.assign cannot be called with null or undefined");return Object(r)}(r),u=1;u<arguments.length;u++){for(var f in i=Object(arguments[u]))o.call(i,f)&&(c[f]=i[f]);if(a){l=a(i);for(var h=0;h<l.length;h++)s.call(i,l[h])&&(c[l[h]]=i[l[h]])}}return c}:Object.assign},{}],248:[function(r,n,i){"use strict";function a(r,n){if("string"!=typeof r)return[r];var i=[r];"string"==typeof n||Array.isArray(n)?n={brackets:n}:n||(n={});var a=n.brackets?Array.isArray(n.brackets)?n.brackets:[n.brackets]:["{}","[]","()"],o=n.escape||"___",s=!!n.flat;a.forEach(function(r){var n=new RegExp(["\\",r[0],"[^\\",r[0],"\\",r[1],"]*\\",r[1]].join("")),a=[];function s(n,s,l){var c=i.push(n.slice(r[0].length,-r[1].length))-1;return a.push(c),o+c+o}i.forEach(function(r,a){for(var o,l=0;r!=o;)if(o=r,r=r.replace(n,s),l++>1e4)throw Error("References have circular dependency. Please, check them.");i[a]=r}),a=a.reverse(),i=i.map(function(n){return a.forEach(function(i){n=n.replace(RegExp("(\\"+o+i+"\\"+o+")","g"),r[0]+"$1"+r[1])}),n})});var l=RegExp("\\"+o+"([0-9]+)\\"+o);return s?i:function r(n,i,a){for(var o,s=[],c=0;o=l.exec(n);){if(c++>1e4)throw Error("Circular references in parenthesis");s.push(n.slice(0,o.index)),s.push(r(i[o[1]],i)),n=n.slice(o.index+o[0].length)}return s.push(n),s}(i[0],i)}function o(r,n){if(n&&n.flat){var i,a=n&&n.escape||"___",o=r[0];if(!o)return"";for(var s=RegExp("\\"+a+"([0-9]+)\\"+a),l=0;o!=i;){if(l++>1e4)throw Error("Circular references in "+r);i=o,o=o.replace(s,c)}return o}return r.reduce(function r(n,i){return Array.isArray(i)&&(i=i.reduce(r,"")),n+i},"");function c(n,i){if(null==r[i])throw Error("Reference "+i+"is undefined");return r[i]}}function s(r,n){return Array.isArray(r)?o(r,n):a(r,n)}s.parse=a,s.stringify=o,n.exports=s},{}],249:[function(r,n,i){"use strict";var a=r("pick-by-alias");n.exports=function(r){var n;return arguments.length>1&&(r=arguments),"string"==typeof r?r=r.split(/\s/).map(parseFloat):"number"==typeof r&&(r=[r]),r.length&&"number"==typeof r[0]?n=1===r.length?{width:r[0],height:r[0],x:0,y:0}:2===r.length?{width:r[0],height:r[1],x:0,y:0}:{x:r[0],y:r[1],width:r[2]-r[0]||0,height:r[3]-r[1]||0}:r&&(n={x:(r=a(r,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"})).left||0,y:r.top||0},null==r.width?r.right?n.width=r.right-n.x:n.width=0:n.width=r.width,null==r.height?r.bottom?n.height=r.bottom-n.y:n.height=0:n.height=r.height),n}},{"pick-by-alias":253}],250:[function(r,n,i){n.exports=function(r){var n=[];return r.replace(o,function(r,i,o){var l,c=i.toLowerCase();for(o=(l=o.match(s))?l.map(Number):[],"m"==c&&o.length>2&&(n.push([i].concat(o.splice(0,2))),c="l",i="m"==i?"l":"L");;){if(o.length==a[c])return o.unshift(i),n.push(o);if(o.length<a[c])throw Error("malformed path data");n.push([i].concat(o.splice(0,a[c])))}}),n};var a={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=/([astvzqmhlc])([^astvzqmhlc]*)/gi,s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],251:[function(r,n,i){n.exports=function(r,n){n||(n=[0,""]);var i=parseFloat(r=String(r),10);return n[0]=i,n[1]=r.match(/[\d.\-\+]*\s*(.*)/)[1]||"",n}},{}],252:[function(r,n,i){(function(r){(function(){(function(){var i,a,o,s;"undefined"!=typeof performance&&null!==performance&&performance.now?n.exports=function(){return performance.now()}:null!=r&&r.hrtime?(n.exports=function(){return(i()-s)/1e6},a=r.hrtime,s=(i=function(){var r;return 1e9*(r=a())[0]+r[1]})()-1e9*r.uptime()):Date.now?(n.exports=function(){return Date.now()-o},o=Date.now()):(n.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(this)}).call(this,r("_process"))},{_process:277}],253:[function(r,n,i){"use strict";n.exports=function(r,n,i){var a,s,l={};if("string"==typeof n&&(n=o(n)),Array.isArray(n)){var c={};for(s=0;s<n.length;s++)c[n[s]]=!0;n=c}for(a in n)n[a]=o(n[a]);var u={};for(a in n){var f=n[a];if(Array.isArray(f))for(s=0;s<f.length;s++){var h=f[s];if(i&&(u[h]=!0),h in r){if(l[a]=r[h],i)for(var p=s;p<f.length;p++)u[f[p]]=!0;break}}else a in r&&(n[a]&&(l[a]=r[a]),i&&(u[a]=!0))}if(i)for(a in r)u[a]||(l[a]=r[a]);return l};var a={};function o(r){return a[r]?a[r]:("string"==typeof r&&(r=a[r]=r.split(/\s*,\s*|\s+/)),r)}},{}],254:[function(r,n,i){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var a,o=r("./lib/build-log"),s=r("./lib/epsilon"),l=r("./lib/intersecter"),c=r("./lib/segment-chainer"),u=r("./lib/segment-selector"),f=r("./lib/geojson"),h=!1,p=s();function d(r,n,i){var o=a.segments(r),s=a.segments(n),l=i(a.combine(o,s));return a.polygon(l)}a={buildLog:function(r){return!0===r?h=o():!1===r&&(h=!1),!1!==h&&h.list},epsilon:function(r){return p.epsilon(r)},segments:function(r){var n=l(!0,p,h);return r.regions.forEach(n.addRegion),{segments:n.calculate(r.inverted),inverted:r.inverted}},combine:function(r,n){return{combined:l(!1,p,h).calculate(r.segments,r.inverted,n.segments,n.inverted),inverted1:r.inverted,inverted2:n.inverted}},selectUnion:function(r){return{segments:u.union(r.combined,h),inverted:r.inverted1||r.inverted2}},selectIntersect:function(r){return{segments:u.intersect(r.combined,h),inverted:r.inverted1&&r.inverted2}},selectDifference:function(r){return{segments:u.difference(r.combined,h),inverted:r.inverted1&&!r.inverted2}},selectDifferenceRev:function(r){return{segments:u.differenceRev(r.combined,h),inverted:!r.inverted1&&r.inverted2}},selectXor:function(r){return{segments:u.xor(r.combined,h),inverted:r.inverted1!==r.inverted2}},polygon:function(r){return{regions:c(r.segments,p,h),inverted:r.inverted}},polygonFromGeoJSON:function(r){return f.toPolygon(a,r)},polygonToGeoJSON:function(r){return f.fromPolygon(a,p,r)},union:function(r,n){return d(r,n,a.selectUnion)},intersect:function(r,n){return d(r,n,a.selectIntersect)},difference:function(r,n){return d(r,n,a.selectDifference)},differenceRev:function(r,n){return d(r,n,a.selectDifferenceRev)},xor:function(r,n){return d(r,n,a.selectXor)}},"object"==typeof window&&(window.PolyBool=a),n.exports=a},{"./lib/build-log":255,"./lib/epsilon":256,"./lib/geojson":257,"./lib/intersecter":258,"./lib/segment-chainer":260,"./lib/segment-selector":261}],255:[function(r,n,i){n.exports=function(){var r,n=0,i=!1;function a(n,i){return r.list.push({type:n,data:i?JSON.parse(JSON.stringify(i)):void 0}),r}return r={list:[],segmentId:function(){return n++},checkIntersection:function(r,n){return a("check",{seg1:r,seg2:n})},segmentChop:function(r,n){return a("div_seg",{seg:r,pt:n}),a("chop",{seg:r,pt:n})},statusRemove:function(r){return a("pop_seg",{seg:r})},segmentUpdate:function(r){return a("seg_update",{seg:r})},segmentNew:function(r,n){return a("new_seg",{seg:r,primary:n})},segmentRemove:function(r){return a("rem_seg",{seg:r})},tempStatus:function(r,n,i){return a("temp_status",{seg:r,above:n,below:i})},rewind:function(r){return a("rewind",{seg:r})},status:function(r,n,i){return a("status",{seg:r,above:n,below:i})},vert:function(n){return n===i?r:(i=n,a("vert",{x:n}))},log:function(r){return"string"!=typeof r&&(r=JSON.stringify(r,!1,"  ")),a("log",{txt:r})},reset:function(){return a("reset")},selected:function(r){return a("selected",{segs:r})},chainStart:function(r){return a("chain_start",{seg:r})},chainRemoveHead:function(r,n){return a("chain_rem_head",{index:r,pt:n})},chainRemoveTail:function(r,n){return a("chain_rem_tail",{index:r,pt:n})},chainNew:function(r,n){return a("chain_new",{pt1:r,pt2:n})},chainMatch:function(r){return a("chain_match",{index:r})},chainClose:function(r){return a("chain_close",{index:r})},chainAddHead:function(r,n){return a("chain_add_head",{index:r,pt:n})},chainAddTail:function(r,n){return a("chain_add_tail",{index:r,pt:n})},chainConnect:function(r,n){return a("chain_con",{index1:r,index2:n})},chainReverse:function(r){return a("chain_rev",{index:r})},chainJoin:function(r,n){return a("chain_join",{index1:r,index2:n})},done:function(){return a("done")}}}},{}],256:[function(r,n,i){n.exports=function(r){"number"!=typeof r&&(r=1e-10);var n={epsilon:function(n){return"number"==typeof n&&(r=n),r},pointAboveOrOnLine:function(n,i,a){var o=i[0],s=i[1],l=a[0],c=a[1],u=n[0];return(l-o)*(n[1]-s)-(c-s)*(u-o)>=-r},pointBetween:function(n,i,a){var o=n[1]-i[1],s=a[0]-i[0],l=n[0]-i[0],c=a[1]-i[1],u=l*s+o*c;return!(u<r)&&!(u-(s*s+c*c)>-r)},pointsSameX:function(n,i){return Math.abs(n[0]-i[0])<r},pointsSameY:function(n,i){return Math.abs(n[1]-i[1])<r},pointsSame:function(r,i){return n.pointsSameX(r,i)&&n.pointsSameY(r,i)},pointsCompare:function(r,i){return n.pointsSameX(r,i)?n.pointsSameY(r,i)?0:r[1]<i[1]?-1:1:r[0]<i[0]?-1:1},pointsCollinear:function(n,i,a){var o=n[0]-i[0],s=n[1]-i[1],l=i[0]-a[0];return Math.abs(o*(i[1]-a[1])-l*s)<r},linesIntersect:function(n,i,a,o){var s=i[0]-n[0],l=i[1]-n[1],c=o[0]-a[0],u=o[1]-a[1],f=s*u-l*c;if(Math.abs(f)<r)return!1;var h=n[0]-a[0],p=n[1]-a[1],d=(c*p-u*h)/f,m=(s*p-l*h)/f,g={alongA:0,alongB:0,pt:[n[0]+d*s,n[1]+d*l]};return g.alongA=d<=-r?-2:d<r?-1:d-1<=-r?0:d-1<r?1:2,g.alongB=m<=-r?-2:m<r?-1:m-1<=-r?0:m-1<r?1:2,g},pointInsideRegion:function(n,i){for(var a=n[0],o=n[1],s=i[i.length-1][0],l=i[i.length-1][1],c=!1,u=0;u<i.length;u++){var f=i[u][0],h=i[u][1];h-o>r!=l-o>r&&(s-f)*(o-h)/(l-h)+f-a>r&&(c=!c),s=f,l=h}return c}};return n}},{}],257:[function(r,n,i){n.exports={toPolygon:function(r,n){function i(n){if(n.length<=0)return r.segments({inverted:!1,regions:[]});function i(n){var i=n.slice(0,n.length-1);return r.segments({inverted:!1,regions:[i]})}for(var a=i(n[0]),o=1;o<n.length;o++)a=r.selectDifference(r.combine(a,i(n[o])));return a}if("Polygon"===n.type)return r.polygon(i(n.coordinates));if("MultiPolygon"===n.type){for(var a=r.segments({inverted:!1,regions:[]}),o=0;o<n.coordinates.length;o++)a=r.selectUnion(r.combine(a,i(n.coordinates[o])));return r.polygon(a)}throw Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(r,n,i){function a(r,i){return n.pointInsideRegion([.5*(r[0][0]+r[1][0]),.5*(r[0][1]+r[1][1])],i)}function o(r){return{region:r,children:[]}}i=r.polygon(r.segments(i));for(var s=o(null),l=0;l<i.regions.length;l++){var c=i.regions[l];c.length<3||function r(n,i){for(var s,l=0;l<n.children.length;l++)if(a(i,(s=n.children[l]).region))return void r(s,i);var c=o(i);for(l=0;l<n.children.length;l++)a((s=n.children[l]).region,i)&&(c.children.push(s),n.children.splice(l,1),l--);n.children.push(c)}(s,c)}function u(r,n){for(var i=0,a=r[r.length-1][0],o=r[r.length-1][1],s=[],l=0;l<r.length;l++){var c=r[l][0],u=r[l][1];s.push([c,u]),i+=u*a-c*o,a=c,o=u}return i<0!==n&&s.reverse(),s.push([s[0][0],s[0][1]]),s}var f=[];for(l=0;l<s.children.length;l++)!function r(n){var i=[u(n.region,!1)];f.push(i);for(var a=0;a<n.children.length;a++)i.push(function(n){for(var i=0;i<n.children.length;i++)r(n.children[i]);return u(n.region,!0)}(n.children[a]))}(s.children[l]);return f.length<=0?{type:"Polygon",coordinates:[]}:1==f.length?{type:"Polygon",coordinates:f[0]}:{type:"MultiPolygon",coordinates:f}}}},{}],258:[function(r,n,i){var a=r("./linked-list");n.exports=function(r,n,i){function o(r,n,a){return{id:i?i.segmentId():-1,start:r,end:n,myFill:{above:a.myFill.above,below:a.myFill.below},otherFill:null}}var s=a.create();function l(r,i){s.insertBefore(r,function(a){var o,s,l,c,u,f;return 0>(o=r.isStart,s=r.pt,l=a.isStart,c=a.pt,u=a.other.pt,0!==(f=n.pointsCompare(s,c))?f:n.pointsSame(i,u)?0:o!==l?o?1:-1:n.pointAboveOrOnLine(i,l?c:u,l?u:c)?1:-1)})}function c(r,n){var i,o,s=(l(i=a.node({isStart:!0,pt:r.start,seg:r,primary:n,other:null,status:null}),r.end),i);return o=a.node({isStart:!1,pt:r.end,seg:r,primary:n,other:s,status:null}),s.other=o,l(o,s.pt),s}function u(r,n){var a=o(n,r.seg.end,r.seg);return i&&i.segmentChop(r.seg,n),r.other.remove(),r.seg.end=n,r.other.pt=n,l(r.other,r.pt),c(a,r.primary)}function f(o,l){var c=a.create();function f(r,a){var o=r.seg,s=a.seg,l=o.start,c=o.end,f=s.start,h=s.end;i&&i.checkIntersection(o,s);var p=n.linesIntersect(l,c,f,h);if(!1===p){if(!n.pointsCollinear(l,c,f)||n.pointsSame(l,h)||n.pointsSame(c,f))return!1;var d=n.pointsSame(l,f),m=n.pointsSame(c,h);if(d&&m)return a;var g=!d&&n.pointBetween(l,f,h),v=!m&&n.pointBetween(c,f,h);if(d)return v?u(a,c):u(r,h),a;g&&(m||(v?u(a,c):u(r,h)),u(a,l))}else 0===p.alongA&&(-1===p.alongB?u(r,f):0===p.alongB?u(r,p.pt):1===p.alongB&&u(r,h)),0===p.alongB&&(-1===p.alongA?u(a,l):0===p.alongA?u(a,p.pt):1===p.alongA&&u(a,c));return!1}for(var h=[];!s.isEmpty();){var p=s.getHead();if(i&&i.vert(p.pt[0]),p.isStart){i&&i.segmentNew(p.seg,p.primary);var d,m=function(r){return c.findTransition(function(i){var a,o,s,l,c;return a=i.ev,o=r.seg.start,s=r.seg.end,l=a.seg.start,c=a.seg.end,(n.pointsCollinear(o,l,c)?n.pointsCollinear(s,l,c)||n.pointAboveOrOnLine(s,l,c)?1:-1:n.pointAboveOrOnLine(o,l,c)?1:-1)>0})}(p),g=m.before?m.before.ev:null,v=m.after?m.after.ev:null;i&&i.tempStatus(p.seg,!!g&&g.seg,!!v&&v.seg);var y,x=function(){if(g){var r=f(p,g);if(r)return r}return!!v&&f(p,v)}();if(x&&(r?(d=null===p.seg.myFill.below||p.seg.myFill.above!==p.seg.myFill.below)&&(x.seg.myFill.above=!x.seg.myFill.above):x.seg.otherFill=p.seg.myFill,i&&i.segmentUpdate(x.seg),p.other.remove(),p.remove()),s.getHead()!==p){i&&i.rewind(p.seg);continue}r?(d=null===p.seg.myFill.below||p.seg.myFill.above!==p.seg.myFill.below,p.seg.myFill.below=v?v.seg.myFill.above:o,p.seg.myFill.above=d?!p.seg.myFill.below:p.seg.myFill.below):null===p.seg.otherFill&&(y=v?p.primary===v.primary?v.seg.otherFill.above:v.seg.myFill.above:p.primary?l:o,p.seg.otherFill={above:y,below:y}),i&&i.status(p.seg,!!g&&g.seg,!!v&&v.seg),p.other.status=m.insert(a.node({ev:p}))}else{var b=p.status;if(null===b)throw Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(c.exists(b.prev)&&c.exists(b.next)&&f(b.prev.ev,b.next.ev),i&&i.statusRemove(b.ev.seg),b.remove(),!p.primary){var _=p.seg.myFill;p.seg.myFill=p.seg.otherFill,p.seg.otherFill=_}h.push(p.seg)}s.getHead().remove()}return i&&i.done(),h}return r?{addRegion:function(r){for(var a,o,s,l=r[r.length-1],u=0;u<r.length;u++){a=l,l=r[u];var f=n.pointsCompare(a,l);0!==f&&c((o=f<0?a:l,s=f<0?l:a,{id:i?i.segmentId():-1,start:o,end:s,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(r){return f(r,!1)}}:{calculate:function(r,n,i,a){return r.forEach(function(r){c(o(r.start,r.end,r),!0)}),i.forEach(function(r){c(o(r.start,r.end,r),!1)}),f(n,a)}}}},{"./linked-list":259}],259:[function(r,n,i){n.exports={create:function(){var r={root:{root:!0,next:null},exists:function(n){return null!==n&&n!==r.root},isEmpty:function(){return null===r.root.next},getHead:function(){return r.root.next},insertBefore:function(n,i){for(var a=r.root,o=r.root.next;null!==o;){if(i(o))return n.prev=o.prev,n.next=o,o.prev.next=n,void(o.prev=n);a=o,o=o.next}a.next=n,n.prev=a,n.next=null},findTransition:function(n){for(var i=r.root,a=r.root.next;null!==a&&!n(a);)i=a,a=a.next;return{before:i===r.root?null:i,after:a,insert:function(r){return r.prev=i,r.next=a,i.next=r,null!==a&&(a.prev=r),r}}}};return r},node:function(r){return r.prev=null,r.next=null,r.remove=function(){r.prev.next=r.next,r.next&&(r.next.prev=r.prev),r.prev=null,r.next=null},r}}},{}],260:[function(r,n,i){n.exports=function(r,n,i){var a=[],o=[];return r.forEach(function(r){var s=r.start,l=r.end;if(n.pointsSame(s,l))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{i&&i.chainStart(r);for(var c={index:0,matches_head:!1,matches_pt1:!1},u={index:0,matches_head:!1,matches_pt1:!1},f=c,h=0;h<a.length;h++){var p=(y=a[h])[0],d=(y[1],y[y.length-1]);if(y[y.length-2],n.pointsSame(p,s)){if(M(h,!0,!0))break}else if(n.pointsSame(p,l)){if(M(h,!0,!1))break}else if(n.pointsSame(d,s)){if(M(h,!1,!0))break}else if(n.pointsSame(d,l)&&M(h,!1,!1))break}if(f===c)return a.push([s,l]),void(i&&i.chainNew(s,l));if(f===u){i&&i.chainMatch(c.index);var m=c.index,g=c.matches_pt1?l:s,v=c.matches_head,y=a[m],x=v?y[0]:y[y.length-1],b=v?y[1]:y[y.length-2],_=v?y[y.length-1]:y[0],w=v?y[y.length-2]:y[1];return n.pointsCollinear(b,x,g)&&(v?(i&&i.chainRemoveHead(c.index,g),y.shift()):(i&&i.chainRemoveTail(c.index,g),y.pop()),x=b),n.pointsSame(_,g)?(a.splice(m,1),n.pointsCollinear(w,_,x)&&(v?(i&&i.chainRemoveTail(c.index,x),y.pop()):(i&&i.chainRemoveHead(c.index,x),y.shift())),i&&i.chainClose(c.index),void o.push(y)):void(v?(i&&i.chainAddHead(c.index,g),y.unshift(g)):(i&&i.chainAddTail(c.index,g),y.push(g)))}var T=c.index,k=u.index;i&&i.chainConnect(T,k);var A=a[T].length<a[k].length;c.matches_head?u.matches_head?A?(S(T),E(T,k)):(S(k),E(k,T)):E(k,T):u.matches_head?E(T,k):A?(S(T),E(k,T)):(S(k),E(T,k))}function M(r,n,i){return f.index=r,f.matches_head=n,f.matches_pt1=i,f===c?(f=u,!1):(f=null,!0)}function S(r){i&&i.chainReverse(r),a[r].reverse()}function E(r,o){var s=a[r],l=a[o],c=s[s.length-1],u=s[s.length-2],f=l[0],h=l[1];n.pointsCollinear(u,c,f)&&(i&&i.chainRemoveTail(r,c),s.pop(),c=u),n.pointsCollinear(c,f,h)&&(i&&i.chainRemoveHead(o,f),l.shift()),i&&i.chainJoin(r,o),a[r]=s.concat(l),a.splice(o,1)}}),o}},{}],261:[function(r,n,i){function a(r,n,i){var a=[];return r.forEach(function(r){var o=(r.myFill.above?8:0)+(r.myFill.below?4:0)+(r.otherFill&&r.otherFill.above?2:0)+(r.otherFill&&r.otherFill.below?1:0);0!==n[o]&&a.push({id:i?i.segmentId():-1,start:r.start,end:r.end,myFill:{above:1===n[o],below:2===n[o]},otherFill:null})}),i&&i.selected(a),a}n.exports={union:function(r,n){return a(r,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],n)},intersect:function(r,n){return a(r,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],n)},difference:function(r,n){return a(r,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],n)},differenceRev:function(r,n){return a(r,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],n)},xor:function(r,n){return a(r,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],n)}}},{}],262:[function(r,n,i){"use strict";var a=r("stream").Transform,o=r("stream-parser");function s(){a.call(this,{readableObjectMode:!0})}function l(r,n,i){Error.call(this),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=r,n&&(this.code=n),i&&(this.statusCode=i)}s.prototype=Object.create(a.prototype),s.prototype.constructor=s,o(s.prototype),i.ParserStream=s,i.sliceEq=function(r,n,i){for(var a=n,o=0;o<i.length;)if(r[a++]!==i[o++])return!1;return!0},i.str2arr=function(r,n){var i=[],a=0;if(n&&"hex"===n)for(;a<r.length;)i.push(parseInt(r.slice(a,a+2),16)),a+=2;else for(;a<r.length;a++)i.push(255&r.charCodeAt(a));return i},i.readUInt16LE=function(r,n){return r[n]|r[n+1]<<8},i.readUInt16BE=function(r,n){return r[n+1]|r[n]<<8},i.readUInt32LE=function(r,n){return r[n]|r[n+1]<<8|r[n+2]<<16|16777216*r[n+3]},i.readUInt32BE=function(r,n){return r[n+3]|r[n+2]<<8|r[n+1]<<16|16777216*r[n]},l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,i.ProbeError=l},{stream:285,"stream-parser":301}],263:[function(r,n,i){"use strict";function a(r,n){var i=Error(r);return i.code=n,i}function o(r,n,i){this.input=r.subarray(n,i),this.start=n;var o=String.fromCharCode.apply(null,this.input.subarray(0,4));if("II*\x00"!==o&&"MM\x00*"!==o)throw a("invalid TIFF signature","EBADDATA");this.big_endian="M"===o[0]}o.prototype.each=function(r){this.aborted=!1;var n=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:n}];this.ifds_to_read.length>0&&!this.aborted;){var i=this.ifds_to_read.shift();i.offset&&this.scan_ifd(i.id,i.offset,r)}},o.prototype.read_uint16=function(r){var n=this.input;if(r+2>n.length)throw a("unexpected EOF","EBADDATA");return this.big_endian?256*n[r]+n[r+1]:n[r]+256*n[r+1]},o.prototype.read_uint32=function(r){var n=this.input;if(r+4>n.length)throw a("unexpected EOF","EBADDATA");return this.big_endian?16777216*n[r]+65536*n[r+1]+256*n[r+2]+n[r+3]:n[r]+256*n[r+1]+65536*n[r+2]+16777216*n[r+3]},o.prototype.is_subifd_link=function(r,n){return 0===r&&34665===n||0===r&&34853===n||34665===r&&40965===n},o.prototype.exif_format_length=function(r){switch(r){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},o.prototype.exif_format_read=function(r,n){var i;switch(r){case 1:case 2:return this.input[n];case 6:return(i=this.input[n])|33554430*(128&i);case 3:return this.read_uint16(n);case 8:return(i=this.read_uint16(n))|131070*(32768&i);case 4:return this.read_uint32(n);case 9:return 0|(i=this.read_uint32(n));default:return null}},o.prototype.scan_ifd=function(r,n,i){var o=this.read_uint16(n);n+=2;for(var s=0;s<o;s++){var l=this.read_uint16(n),c=this.read_uint16(n+2),u=this.read_uint32(n+4),f=this.exif_format_length(c),h=u*f,p=h<=4?n+8:this.read_uint32(n+8),d=!1;if(p+h>this.input.length)throw a("unexpected EOF","EBADDATA");for(var m=[],g=p,v=0;v<u;v++,g+=f){var y=this.exif_format_read(c,g);if(null===y){m=null;break}m.push(y)}if(Array.isArray(m)&&2===c&&(m=function(r){try{return decodeURIComponent(escape(r))}catch(n){return r}}(String.fromCharCode.apply(null,m)))&&"\x00"===m[m.length-1]&&(m=m.slice(0,-1)),this.is_subifd_link(r,l)&&Array.isArray(m)&&Number.isInteger(m[0])&&m[0]>0&&(this.ifds_to_read.push({id:l,offset:m[0]}),d=!0),!1===i({is_big_endian:this.big_endian,ifd:r,tag:l,format:c,count:u,entry_offset:n+this.start,data_length:h,data_offset:p+this.start,value:m,is_subifd_link:d}))return void(this.aborted=!0);n+=12}0===r&&this.ifds_to_read.push({id:1,offset:this.read_uint32(n)})},n.exports.ExifParser=o,n.exports.get_orientation=function(r){var n=0;try{return new o(r,0,r.length).each(function(r){if(0===r.ifd&&274===r.tag&&Array.isArray(r.value))return n=r.value[0],!1}),n}catch(r){return -1}}},{}],264:[function(r,n,i){"use strict";var a=r("./common").readUInt16BE,o=r("./common").readUInt32BE;function s(r,n){if(r.length<4+n)return null;var i=o(r,n);return r.length<i+n||i<8?null:{boxtype:String.fromCharCode.apply(null,r.slice(n+4,n+8)),data:r.slice(n+8,n+i),end:n+i}}function l(r,n,i){for(var a=0,o=0;o<i;o++)a=256*a+(r[n+o]||0);return a}n.exports.unbox=s,n.exports.readSizeFromMeta=function(r){var n={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(r,n){for(var i=4;;){var c=s(r,i);if(!c)break;"iprp"===c.boxtype&&function(r,n){for(var i=0;;){var a=s(r,i);if(!a)break;"ipco"===a.boxtype&&function(r,n){for(var i=0;;){var a=s(r,i);if(!a)break;switch(a.boxtype){case"ispe":n.sizes.push({width:o(a.data,4),height:o(a.data,8)});break;case"irot":n.transforms.push({type:"irot",value:3&a.data[0]});break;case"imir":n.transforms.push({type:"imir",value:1&a.data[0]})}i=a.end}}(a.data,n),i=a.end}}(c.data,n),"iloc"===c.boxtype&&function(r,n){for(var i=r[4]>>4&15,o=15&r[4],s=r[5]>>4&15,c=a(r,6),u=8,f=0;f<c;f++){var h=a(r,u),p=a(r,u+=2),d=l(r,u+=2,s),m=a(r,u+=s);if(u+=2,0===p&&1===m){var g=l(r,u,i),v=l(r,u+i,o);n.item_loc[h]={length:v,offset:g+d}}u+=m*(i+o)}}(c.data,n),"iinf"===c.boxtype&&function(r,n){for(var i=a(r,4),o=6,l=0;l<i;l++){var c=s(r,o);if(!c)break;if("infe"===c.boxtype){for(var u=a(c.data,4),f="",h=8;h<c.data.length&&c.data[h];h++)f+=String.fromCharCode(c.data[h]);n.item_inf[f]=u}o=c.end}}(c.data,n),i=c.end}}(r,n),n.sizes.length){var i,c,u,f=(c=(i=n.sizes).reduce(function(r,n){return r.width>n.width||r.width===n.width&&r.height>n.height?r:n}),u=i.reduce(function(r,n){return r.height>n.height||r.height===n.height&&r.width>n.width?r:n}),c.width>u.height||c.width===u.height&&c.height>u.width?c:u),h=1;n.transforms.forEach(function(r){var n={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},i={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if("imir"===r.type&&(h=0===r.value?i[h]:n[h=n[h=i[h]]]),"irot"===r.type)for(var a=0;a<r.value;a++)h=n[h]});var p=null;return n.item_inf.Exif&&(p=n.item_loc[n.item_inf.Exif]),{width:f.width,height:f.height,orientation:n.transforms.length?h:null,variants:n.sizes,exif_location:p}}},n.exports.getMimeType=function(r){var n=String.fromCharCode.apply(null,r.slice(0,4)),i={};i[n]=!0;for(var a=8;a<r.length;a+=4)i[String.fromCharCode.apply(null,r.slice(a,a+4))]=!0;if(i.mif1||i.msf1||i.miaf)return"avif"===n||"avis"===n||"avio"===n?{type:"avif",mime:"image/avif"}:"heic"===n||"heix"===n?{type:"heic",mime:"image/heic"}:"hevc"===n||"hevx"===n?{type:"heic",mime:"image/heic-sequence"}:i.avif||i.avis?{type:"avif",mime:"image/avif"}:i.heic||i.heix||i.hevc||i.hevx||i.heis?i.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":262}],265:[function(r,n,i){"use strict";var a=r("../common").str2arr,o=r("../common").sliceEq,s=r("../common").readUInt32BE,l=r("../miaf_utils"),c=r("../exif_utils"),u=a("ftyp");n.exports=function(r){if(o(r,4,u)){var n=l.unbox(r,0);if(n){var i=l.getMimeType(n.data);if(i){for(var a,f=n.end;;){var h=l.unbox(r,f);if(!h)break;if(f=h.end,"mdat"===h.boxtype)return;if("meta"===h.boxtype){a=h.data;break}}if(a){var p=l.readSizeFromMeta(a);if(p){var d={width:p.width,height:p.height,type:i.type,mime:i.mime,wUnits:"px",hUnits:"px"};if(p.variants.length>1&&(d.variants=p.variants),p.orientation&&(d.orientation=p.orientation),p.exif_location&&p.exif_location.offset+p.exif_location.length<=r.length){var m=s(r,p.exif_location.offset),g=r.slice(p.exif_location.offset+m+4,p.exif_location.offset+p.exif_location.length),v=c.get_orientation(g);v>0&&(d.orientation=v)}return d}}}}}}},{"../common":262,"../exif_utils":263,"../miaf_utils":264}],266:[function(r,n,i){"use strict";var a=r("../common").str2arr,o=r("../common").sliceEq,s=r("../common").readUInt16LE,l=a("BM");n.exports=function(r){if(!(r.length<26)&&o(r,0,l))return{width:s(r,18),height:s(r,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":262}],267:[function(r,n,i){"use strict";var a=r("../common").str2arr,o=r("../common").sliceEq,s=r("../common").readUInt16LE,l=a("GIF87a"),c=a("GIF89a");n.exports=function(r){if(!(r.length<10)&&(o(r,0,l)||o(r,0,c)))return{width:s(r,6),height:s(r,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":262}],268:[function(r,n,i){"use strict";var a=r("../common").readUInt16LE;n.exports=function(r){var n=a(r,0),i=a(r,2),o=a(r,4);if(0===n&&1===i&&o){for(var s=[],l={width:0,height:0},c=0;c<o;c++){var u=r[6+16*c]||256,f=r[6+16*c+1]||256,h={width:u,height:f};s.push(h),(u>l.width||f>l.height)&&(l=h)}return{width:l.width,height:l.height,variants:s,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":262}],269:[function(r,n,i){"use strict";var a=r("../common").readUInt16BE,o=r("../common").str2arr,s=r("../common").sliceEq,l=r("../exif_utils"),c=o("Exif\x00\x00");n.exports=function(r){if(!(r.length<2)&&255===r[0]&&216===r[1]&&255===r[2])for(var n=2;;){for(;;){if(r.length-n<2)return;if(255===r[n++])break}for(var i,o,u=r[n++];255===u;)u=r[n++];if(208<=u&&u<=217||1===u)i=0;else{if(!(192<=u&&u<=254)||r.length-n<2)return;i=a(r,n)-2,n+=2}if(217===u||218===u)return;if(225===u&&i>=10&&s(r,n,c)&&(o=l.get_orientation(r.slice(n+6,n+i))),i>=5&&192<=u&&u<=207&&196!==u&&200!==u&&204!==u){if(r.length-n<i)return;var f={width:a(r,n+3),height:a(r,n+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return o>0&&(f.orientation=o),f}n+=i}}},{"../common":262,"../exif_utils":263}],270:[function(r,n,i){"use strict";var a=r("../common").str2arr,o=r("../common").sliceEq,s=r("../common").readUInt32BE,l=a("\x89PNG\r\n\x1a\n"),c=a("IHDR");n.exports=function(r){if(!(r.length<24)&&o(r,0,l)&&o(r,12,c))return{width:s(r,16),height:s(r,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":262}],271:[function(r,n,i){"use strict";var a=r("../common").str2arr,o=r("../common").sliceEq,s=r("../common").readUInt32BE,l=a("8BPS\x00\x01");n.exports=function(r){if(!(r.length<22)&&o(r,0,l))return{width:s(r,18),height:s(r,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":262}],272:[function(r,n,i){"use strict";function a(r){return"number"==typeof r&&isFinite(r)&&r>0}var o=/<[-_.:a-zA-Z0-9][^>]*>/,s=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,l=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,c=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,u=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,f=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function h(r){return f.test(r)?r.match(f)[0]:"px"}n.exports=function(r){if(function(r){var n,i=0,a=r.length;for(239===r[0]&&187===r[1]&&191===r[2]&&(i=3);i<a&&(32===(n=r[i])||9===n||13===n||10===n);)i++;return i!==a&&60===r[i]}(r)){for(var n="",i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);var f=(n.match(o)||[""])[0];if(s.test(f)){var p,d,m,g=(p=f.match(l),d=f.match(c),m=f.match(u),{width:p&&(p[1]||p[2]),height:d&&(d[1]||d[2]),viewbox:m&&(m[1]||m[2])}),v=parseFloat(g.width),y=parseFloat(g.height);if(g.width&&g.height){if(!a(v)||!a(y))return;return{width:v,height:y,type:"svg",mime:"image/svg+xml",wUnits:h(g.width),hUnits:h(g.height)}}var x=(g.viewbox||"").split(" "),b={width:x[2],height:x[3]},_=parseFloat(b.width),w=parseFloat(b.height);if(a(_)&&a(w)&&h(b.width)===h(b.height)){var T=_/w;if(g.width){if(!a(v))return;return{width:v,height:v/T,type:"svg",mime:"image/svg+xml",wUnits:h(g.width),hUnits:h(g.width)}}if(g.height){if(!a(y))return;return{width:y*T,height:y,type:"svg",mime:"image/svg+xml",wUnits:h(g.height),hUnits:h(g.height)}}return{width:_,height:w,type:"svg",mime:"image/svg+xml",wUnits:h(b.width),hUnits:h(b.height)}}}}}},{}],273:[function(r,n,i){"use strict";var a=r("../common").str2arr,o=r("../common").sliceEq,s=r("../common").readUInt16LE,l=r("../common").readUInt16BE,c=r("../common").readUInt32LE,u=r("../common").readUInt32BE,f=a("II*\x00"),h=a("MM\x00*");function p(r,n,i){return i?l(r,n):s(r,n)}function d(r,n,i){return i?u(r,n):c(r,n)}function m(r,n,i){var a=p(r,n+2,i);return 1!==d(r,n+4,i)||3!==a&&4!==a?null:3===a?p(r,n+8,i):d(r,n+8,i)}n.exports=function(r){if(!(r.length<8)&&(o(r,0,f)||o(r,0,h))){var n=77===r[0],i=d(r,4,n)-8;if(!(i<0)){var a=i+8;if(!(r.length-a<2)){var s,l,c,u,g=12*p(r,a+0,n);if(!(g<=0||(a+=2,r.length-a<g))){for(s=0;s<g;s+=12)256===(u=p(r,a+s,n))?l=m(r,a+s,n):257===u&&(c=m(r,a+s,n));return l&&c?{width:l,height:c,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":262}],274:[function(r,n,i){"use strict";var a=r("../common").str2arr,o=r("../common").sliceEq,s=r("../common").readUInt16LE,l=r("../common").readUInt32LE,c=r("../exif_utils"),u=a("RIFF"),f=a("WEBP");n.exports=function(r){if(!(r.length<16)&&(o(r,0,u)||o(r,8,f))){var n=12,i=null,a=0,h=l(r,4)+8;if(!(h>r.length)){for(;n+8<h;)if(0!==r[n]){var p,d=String.fromCharCode.apply(null,r.slice(n,n+4)),m=l(r,n+4);"VP8 "===d&&m>=10?i=i||function(r,n){if(157===r[n+3]&&1===r[n+4]&&42===r[n+5])return{width:16383&s(r,n+6),height:16383&s(r,n+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}(r,n+8):"VP8L"===d&&m>=9?i=i||function(r,n){if(47===r[n]){var i=l(r,n+1);return{width:1+(16383&i),height:1+(i>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}(r,n+8):"VP8X"===d&&m>=10?i=i||{width:1+(r[(p=n+8)+6]<<16|r[p+5]<<8|r[p+4]),height:1+(r[p+9]<<p|r[p+8]<<8|r[p+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}:"EXIF"===d&&(a=c.get_orientation(r.slice(n+8,n+8+m)),n=1/0),n+=8+m}else n++;if(i)return a>0&&(i.orientation=a),i}}}},{"../common":262,"../exif_utils":263}],275:[function(r,n,i){"use strict";n.exports={avif:r("./parse_sync/avif"),bmp:r("./parse_sync/bmp"),gif:r("./parse_sync/gif"),ico:r("./parse_sync/ico"),jpeg:r("./parse_sync/jpeg"),png:r("./parse_sync/png"),psd:r("./parse_sync/psd"),svg:r("./parse_sync/svg"),tiff:r("./parse_sync/tiff"),webp:r("./parse_sync/webp")}},{"./parse_sync/avif":265,"./parse_sync/bmp":266,"./parse_sync/gif":267,"./parse_sync/ico":268,"./parse_sync/jpeg":269,"./parse_sync/png":270,"./parse_sync/psd":271,"./parse_sync/svg":272,"./parse_sync/tiff":273,"./parse_sync/webp":274}],276:[function(r,n,i){"use strict";var a=r("./lib/parsers_sync");n.exports=function(r){return function(r){for(var n=Object.keys(a),i=0;i<n.length;i++){var o=a[n[i]](r);if(o)return o}return null}(r)},n.exports.parsers=a},{"./lib/parsers_sync":275}],277:[function(r,n,i){var a,o,s=n.exports={};function l(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function u(r){if(a===setTimeout)return setTimeout(r,0);if((a===l||!a)&&setTimeout)return a=setTimeout,setTimeout(r,0);try{return a(r,0)}catch(n){try{return a.call(null,r,0)}catch(n){return a.call(this,r,0)}}}!function(){try{a="function"==typeof setTimeout?setTimeout:l}catch(r){a=l}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(r){o=c}}();var f,h=[],p=!1,d=-1;function m(){p&&f&&(p=!1,f.length?h=f.concat(h):d=-1,h.length&&g())}function g(){if(!p){var r=u(m);p=!0;for(var n=h.length;n;){for(f=h,h=[];++d<n;)f&&f[d].run();d=-1,n=h.length}f=null,p=!1,function(r){if(o===clearTimeout)return clearTimeout(r);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(r);try{o(r)}catch(n){try{return o.call(null,r)}catch(n){return o.call(this,r)}}}(r)}}function v(r,n){this.fun=r,this.array=n}function y(){}s.nextTick=function(r){var n=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)n[i-1]=arguments[i];h.push(new v(r,n)),1!==h.length||p||u(g)},v.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=y,s.addListener=y,s.once=y,s.off=y,s.removeListener=y,s.removeAllListeners=y,s.emit=y,s.prependListener=y,s.prependOnceListener=y,s.listeners=function(r){return[]},s.binding=function(r){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(r){throw Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],278:[function(r,n,a){(function(i){(function(){for(var a=r("performance-now"),o="undefined"==typeof window?i:window,s=["moz","webkit"],l="AnimationFrame",c=o["request"+l],u=o["cancel"+l]||o["cancelRequest"+l],f=0;!c&&f<s.length;f++)c=o[s[f]+"Request"+l],u=o[s[f]+"Cancel"+l]||o[s[f]+"CancelRequest"+l];if(!c||!u){var h=0,p=0,d=[];c=function(r){if(0===d.length){var n=a(),i=Math.max(0,1e3/60-(n-h));h=i+n,setTimeout(function(){var r=d.slice(0);d.length=0;for(var n=0;n<r.length;n++)if(!r[n].cancelled)try{r[n].callback(h)}catch(r){setTimeout(function(){throw r},0)}},Math.round(i))}return d.push({handle:++p,callback:r,cancelled:!1}),p},u=function(r){for(var n=0;n<d.length;n++)d[n].handle===r&&(d[n].cancelled=!0)}}n.exports=function(r){return c.call(o,r)},n.exports.cancel=function(){u.apply(o,arguments)},n.exports.polyfill=function(r){r||(r=o),r.requestAnimationFrame=c,r.cancelAnimationFrame=u}}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"performance-now":252}],279:[function(r,n,i){"use strict";var a=r("array-bounds"),o=r("color-normalize"),s=r("update-diff"),l=r("pick-by-alias"),c=r("object-assign"),u=r("flatten-vertex-data"),f=r("to-float32"),h=f.float32,p=f.fract32;n.exports=function(r,n){if("function"==typeof r?(n||(n={}),n.regl=r):n=r,n.length&&(n.positions=n),!(r=n.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var i,f,m,g,v,y,x=r._gl,b={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},_=[];return g=r.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),f=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),m=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),v=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),y=r.buffer({usage:"static",type:"float",data:d}),A(n),i=r({vert:"\n		precision highp float;\n\n		attribute vec2 position, positionFract;\n		attribute vec4 error;\n		attribute vec4 color;\n\n		attribute vec2 direction, lineOffset, capOffset;\n\n		uniform vec4 viewport;\n		uniform float lineWidth, capSize;\n		uniform vec2 scale, scaleFract, translate, translateFract;\n\n		varying vec4 fragColor;\n\n		void main() {\n			fragColor = color / 255.;\n\n			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n			vec2 position = position + dxy;\n\n			vec2 pos = (position + translate) * scale\n				+ (positionFract + translateFract) * scale\n				+ (position + translate) * scaleFract\n				+ (positionFract + translateFract) * scaleFract;\n\n			pos += pixelOffset / viewport.zw;\n\n			gl_Position = vec4(pos * 2. - 1., 0, 1);\n		}\n		",frag:"\n		precision highp float;\n\n		varying vec4 fragColor;\n\n		uniform float opacity;\n\n		void main() {\n			gl_FragColor = fragColor;\n			gl_FragColor.a *= opacity;\n		}\n		",uniforms:{range:r.prop("range"),lineWidth:r.prop("lineWidth"),capSize:r.prop("capSize"),opacity:r.prop("opacity"),scale:r.prop("scale"),translate:r.prop("translate"),scaleFract:r.prop("scaleFract"),translateFract:r.prop("translateFract"),viewport:function(r,n){return[n.viewport.x,n.viewport.y,r.viewportWidth,r.viewportHeight]}},attributes:{color:{buffer:g,offset:function(r,n){return 4*n.offset},divisor:1},position:{buffer:f,offset:function(r,n){return 8*n.offset},divisor:1},positionFract:{buffer:m,offset:function(r,n){return 8*n.offset},divisor:1},error:{buffer:v,offset:function(r,n){return 16*n.offset},divisor:1},direction:{buffer:y,stride:24,offset:0},lineOffset:{buffer:y,stride:24,offset:8},capOffset:{buffer:y,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:r.prop("viewport")},viewport:r.prop("viewport"),stencil:!1,instances:r.prop("count"),count:d.length}),c(w,{update:A,draw:T,destroy:M,regl:r,gl:x,canvas:x.canvas,groups:_}),w;function w(r){r?A(r):null===r&&M(),T()}function T(n){if("number"==typeof n)return k(n);n&&!Array.isArray(n)&&(n=[n]),r._refresh(),_.forEach(function(r,i){r&&(n&&(n[i]?r.draw=!0:r.draw=!1),r.draw?k(i):r.draw=!0)})}function k(r){"number"==typeof r&&(r=_[r]),null!=r&&r&&r.count&&r.color&&r.opacity&&r.positions&&r.positions.length>1&&(r.scaleRatio=[r.scale[0]*r.viewport.width,r.scale[1]*r.viewport.height],i(r),r.after&&r.after(r))}function A(r){if(r){null!=r.length?"number"==typeof r[0]&&(r=[{positions:r}]):Array.isArray(r)||(r=[r]);var n=0,i=0;if(w.groups=_=r.map(function(r,f){var h=_[f];return r&&("function"==typeof r?r={after:r}:"number"==typeof r[0]&&(r={positions:r}),r=l(r,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),h||(_[f]=h={id:f,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},r=c({},b,r)),s(h,r,[{lineWidth:function(r){return .5*+r},capSize:function(r){return .5*+r},opacity:parseFloat,errors:function(r){return r=u(r),i+=r.length,r},positions:function(r,i){return r=u(r,"float64"),i.count=Math.floor(r.length/2),i.bounds=a(r,2),i.offset=n,n+=i.count,r}},{color:function(r,n){var i=n.count;if(r||(r="transparent"),!Array.isArray(r)||"number"==typeof r[0]){var a=r;r=Array(i);for(var s=0;s<i;s++)r[s]=a}if(r.length<i)throw Error("Not enough colors");for(var l=new Uint8Array(4*i),c=0;c<i;c++){var u=o(r[c],"uint8");l.set(u,4*c)}return l},range:function(r,n,i){var a=n.bounds;return r||(r=a),n.scale=[1/(r[2]-r[0]),1/(r[3]-r[1])],n.translate=[-r[0],-r[1]],n.scaleFract=p(n.scale),n.translateFract=p(n.translate),r},viewport:function(r){var n;return Array.isArray(r)?n={x:r[0],y:r[1],width:r[2]-r[0],height:r[3]-r[1]}:r?(n={x:r.x||r.left||0,y:r.y||r.top||0},r.right?n.width=r.right-n.x:n.width=r.w||r.width||0,r.bottom?n.height=r.bottom-n.y:n.height=r.h||r.height||0):n={x:0,y:0,width:x.drawingBufferWidth,height:x.drawingBufferHeight},n}}])),h}),n||i){var d=_.reduce(function(r,n,i){return r+(n?n.count:0)},0),y=new Float64Array(2*d),T=new Uint8Array(4*d),k=new Float32Array(4*d);_.forEach(function(r,n){if(r){var i=r.positions,a=r.count,o=r.offset,s=r.color,l=r.errors;a&&(T.set(s,4*o),k.set(l,4*o),y.set(i,2*o))}});var A=h(y);f(A),m(p(y,A)),g(T),v(k)}}}function M(){f.destroy(),m.destroy(),g.destroy(),v.destroy(),y.destroy()}};var d=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":313,"update-diff":329}],280:[function(r,n,i){"use strict";var a=r("color-normalize"),o=r("array-bounds"),s=r("object-assign"),l=r("glslify"),c=r("pick-by-alias"),u=r("flatten-vertex-data"),f=r("earcut"),h=r("array-normalize"),p=r("to-float32"),d=p.float32,m=p.fract32,g=r("es6-weak-map"),v=r("parse-rect"),y=r("array-find-index");function x(r,n){if(!(this instanceof x))return new x(r,n);if("function"==typeof r?(n||(n={}),n.regl=r):n=r,n.length&&(n.positions=n),!(r=n.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=r._gl,this.regl=r,this.passes=[],this.shaders=x.shaders.has(r)?x.shaders.get(r):x.shaders.set(r,x.createShaders(r)).get(r),this.update(n)}n.exports=x,x.dashMult=2,x.maxPatternLength=256,x.precisionThreshold=3e6,x.maxPoints=1e4,x.maxLines=2048,x.shaders=new g,x.createShaders=function(r){var n,i=r.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),a={primitive:"triangle strip",instances:r.prop("count"),count:4,offset:0,uniforms:{miterMode:function(r,n){return"round"===n.join?2:1},miterLimit:r.prop("miterLimit"),scale:r.prop("scale"),scaleFract:r.prop("scaleFract"),translateFract:r.prop("translateFract"),translate:r.prop("translate"),thickness:r.prop("thickness"),dashTexture:r.prop("dashTexture"),opacity:r.prop("opacity"),pixelRatio:r.context("pixelRatio"),id:r.prop("id"),dashLength:r.prop("dashLength"),viewport:function(r,n){return[n.viewport.x,n.viewport.y,r.viewportWidth,r.viewportHeight]},depth:r.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(r,n){return!n.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:r.prop("viewport")},viewport:r.prop("viewport")},o=r(s({vert:l(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n	// the order is important\n	return position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n	float lineStart = 1. - lineEnd;\n	float lineOffset = lineTop * 2. - 1.;\n\n	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n	tangent = normalize(diff * scale * viewport.zw);\n	vec2 normal = vec2(-tangent.y, tangent.x);\n\n	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n		+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n	fragColor = color / 255.;\n}\n"]),frag:l(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n	float alpha = 1.;\n\n	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n	float dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n	gl_FragColor = fragColor;\n	gl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:i,divisor:0,stride:8,offset:0},lineTop:{buffer:i,divisor:0,stride:8,offset:4},aCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:r.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:r.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:r.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},a));try{n=r(s({cull:{enable:!0,face:"back"},vert:l(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n	vec2 diff = b - a;\n	vec2 perp = normalize(vec2(-diff.y, diff.x));\n	return dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n	vec2 normalWidth = thickness / scaleRatio;\n\n	float lineStart = 1. - lineEnd;\n	float lineBot = 1. - lineTop;\n\n	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n	vec2 prevDiff = aCoord - prevCoord;\n	vec2 currDiff = bCoord - aCoord;\n	vec2 nextDiff = nextCoord - bCoord;\n\n	vec2 prevTangent = normalize(prevDiff * scaleRatio);\n	vec2 currTangent = normalize(currDiff * scaleRatio);\n	vec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n	vec2 currNormal = vec2(-currTangent.y, currTangent.x);\n	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n	vec2 startJoinDirection = normalize(prevTangent - currTangent);\n	vec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n	// collapsed/unidirectional segment cases\n	// FIXME: there should be more elegant solution\n	vec2 prevTanDiff = abs(prevTangent - currTangent);\n	vec2 nextTanDiff = abs(nextTangent - currTangent);\n	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n		startJoinDirection = currNormal;\n	}\n	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n		endJoinDirection = currNormal;\n	}\n	if (aCoord == bCoord) {\n		endJoinDirection = startJoinDirection;\n		currNormal = prevNormal;\n		currTangent = prevTangent;\n	}\n\n	tangent = currTangent;\n\n	//calculate join shifts relative to normals\n	float startJoinShift = dot(currNormal, startJoinDirection);\n	float endJoinShift = dot(currNormal, endJoinDirection);\n\n	float startMiterRatio = abs(1. / startJoinShift);\n	float endMiterRatio = abs(1. / endJoinShift);\n\n	vec2 startJoin = startJoinDirection * startMiterRatio;\n	vec2 endJoin = endJoinDirection * endMiterRatio;\n\n	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n	startTopJoin = sign(startJoinShift) * startJoin * .5;\n	startBotJoin = -startTopJoin;\n\n	endTopJoin = sign(endJoinShift) * endJoin * .5;\n	endBotJoin = -endTopJoin;\n\n	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n	//miter anti-clipping\n	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n	//prevent close to reverse direction switch\n	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n	if (prevReverse) {\n		//make join rectangular\n		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n	}\n	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n		//handle miter clipping\n		bTopCoord -= normalWidth * endTopJoin;\n		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n	}\n\n	if (nextReverse) {\n		//make join rectangular\n		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n	}\n	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n		//handle miter clipping\n		aBotCoord -= normalWidth * startBotJoin;\n		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n	}\n\n	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n	//position is normalized 0..1 coord on the screen\n	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n	enableStartMiter = step(dot(currTangent, prevTangent), .5);\n	enableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n	//bevel miter cutoffs\n	if (miterMode == 1.) {\n		if (enableStartMiter == 1.) {\n			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n			startCutoff = vec4(aCoord, aCoord);\n			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n			startCutoff += viewport.xyxy;\n			startCutoff += startMiterWidth.xyxy;\n		}\n\n		if (enableEndMiter == 1.) {\n			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n			endCutoff = vec4(bCoord, bCoord);\n			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n			endCutoff += viewport.xyxy;\n			endCutoff += endMiterWidth.xyxy;\n		}\n	}\n\n	//round miter cutoffs\n	else if (miterMode == 2.) {\n		if (enableStartMiter == 1.) {\n			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n			startCutoff = vec4(aCoord, aCoord);\n			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n			startCutoff += viewport.xyxy;\n			startCutoff += startMiterWidth.xyxy;\n		}\n\n		if (enableEndMiter == 1.) {\n			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n			endCutoff = vec4(bCoord, bCoord);\n			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n			endCutoff += viewport.xyxy;\n			endCutoff += endMiterWidth.xyxy;\n		}\n	}\n}\n"]),frag:l(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n	vec2 diff = b - a;\n	vec2 perp = normalize(vec2(-diff.y, diff.x));\n	return dot(p - a, perp);\n}\n\nvoid main() {\n	float alpha = 1., distToStart, distToEnd;\n	float cutoff = thickness * .5;\n\n	//bevel miter\n	if (miterMode == 1.) {\n		if (enableStartMiter == 1.) {\n			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n			if (distToStart < -1.) {\n				discard;\n				return;\n			}\n			alpha *= min(max(distToStart + 1., 0.), 1.);\n		}\n\n		if (enableEndMiter == 1.) {\n			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n			if (distToEnd < -1.) {\n				discard;\n				return;\n			}\n			alpha *= min(max(distToEnd + 1., 0.), 1.);\n		}\n	}\n\n	// round miter\n	else if (miterMode == 2.) {\n		if (enableStartMiter == 1.) {\n			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n			if (distToStart < 0.) {\n				float radius = length(gl_FragCoord.xy - startCoord);\n\n				if(radius > cutoff + .5) {\n					discard;\n					return;\n				}\n\n				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n			}\n		}\n\n		if (enableEndMiter == 1.) {\n			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n			if (distToEnd < 0.) {\n				float radius = length(gl_FragCoord.xy - endCoord);\n\n				if(radius > cutoff + .5) {\n					discard;\n					return;\n				}\n\n				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n			}\n		}\n	}\n\n	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n	float dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n	gl_FragColor = fragColor;\n	gl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:i,divisor:0,stride:8,offset:0},lineTop:{buffer:i,divisor:0,stride:8,offset:4},aColor:{buffer:r.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:r.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},a))}catch(r){n=o}return{fill:r({primitive:"triangle",elements:function(r,n){return n.triangles},offset:0,vert:l(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n	vec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n	fragColor = color / 255.;\n	fragColor.a *= opacity;\n}\n"]),frag:l(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n	gl_FragColor = fragColor;\n}\n"]),uniforms:{scale:r.prop("scale"),color:r.prop("fill"),scaleFract:r.prop("scaleFract"),translateFract:r.prop("translateFract"),translate:r.prop("translate"),opacity:r.prop("opacity"),pixelRatio:r.context("pixelRatio"),id:r.prop("id"),viewport:function(r,n){return[n.viewport.x,n.viewport.y,r.viewportWidth,r.viewportHeight]}},attributes:{position:{buffer:r.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:r.prop("positionFractBuffer"),stride:8,offset:8}},blend:a.blend,depth:{enable:!1},scissor:a.scissor,stencil:a.stencil,viewport:a.viewport}),rect:o,miter:n}},x.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},x.prototype.render=function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];r.length&&this.update.apply(this,r),this.draw()},x.prototype.draw=function(){for(var r=this,n=[],i=arguments.length;i--;)n[i]=arguments[i];return(n.length?n:this.passes).forEach(function(n,i){if(n&&Array.isArray(n))return r.draw.apply(r,n);"number"==typeof n&&(n=r.passes[n]),n&&n.count>1&&n.opacity&&(r.regl._refresh(),n.fill&&n.triangles&&n.triangles.length>2&&r.shaders.fill(n),n.thickness&&(n.scale[0]*n.viewport.width>x.precisionThreshold||n.scale[1]*n.viewport.height>x.precisionThreshold||"rect"===n.join||!n.join&&(n.thickness<=2||n.count>=x.maxPoints)?r.shaders.rect(n):r.shaders.miter(n)))}),this},x.prototype.update=function(r){var n=this;if(r){null!=r.length?"number"==typeof r[0]&&(r=[{positions:r}]):Array.isArray(r)||(r=[r]);var i=this.regl,l=this.gl;if(r.forEach(function(r,p){var g=n.passes[p];if(void 0!==r){if(null!==r){if("number"==typeof r[0]&&(r={positions:r}),r=c(r,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),g||(n.passes[p]=g={id:p,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:i.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:i.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:i.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},r=s({},x.defaults,r)),null!=r.thickness&&(g.thickness=parseFloat(r.thickness)),null!=r.opacity&&(g.opacity=parseFloat(r.opacity)),null!=r.miterLimit&&(g.miterLimit=parseFloat(r.miterLimit)),null!=r.overlay&&(g.overlay=!!r.overlay,p<x.maxLines&&(g.depth=2*(x.maxLines-1-p%x.maxLines)/x.maxLines-1)),null!=r.join&&(g.join=r.join),null!=r.hole&&(g.hole=r.hole),null!=r.fill&&(g.fill=r.fill?a(r.fill,"uint8"):null),null!=r.viewport&&(g.viewport=v(r.viewport)),g.viewport||(g.viewport=v([l.drawingBufferWidth,l.drawingBufferHeight])),null!=r.close&&(g.close=r.close),null===r.positions&&(r.positions=[]),r.positions){if(r.positions.x&&r.positions.y){var b,_,w=r.positions.x,T=r.positions.y;_=g.count=Math.max(w.length,T.length),b=new Float64Array(2*_);for(var k=0;k<_;k++)b[2*k]=w[k],b[2*k+1]=T[k]}else b=u(r.positions,"float64"),_=g.count=Math.floor(b.length/2);var A=g.bounds=o(b,2);if(g.fill){for(var M=[],S={},E=0,L=0,C=0,P=g.count;L<P;L++){var I=b[2*L],O=b[2*L+1];isNaN(I)||isNaN(O)||null==I||null==O?(I=b[2*E],O=b[2*E+1],S[L]=E):E=L,M[C++]=I,M[C++]=O}if(r.splitNull){g.count-1 in S||(S[g.count]=g.count-1);var z=Object.keys(S).map(Number).sort(function(r,n){return r-n}),D=[],R=0,F=null!=g.hole?g.hole[0]:null;if(null!=F){var B=y(z,function(r){return r>=F});(z=z.slice(0,B)).push(F)}for(var N=function(r){var n=f(M.slice(2*R,2*z[r]).concat(F?M.slice(2*F):[]),(g.hole||[]).map(function(n){return n-F+(z[r]-R)}));n=n.map(function(n){return n+R+(n+R<z[r]?0:F-z[r])}),D.push.apply(D,n),R=z[r]+1},j=0;j<z.length;j++)N(j);for(var U=0,V=D.length;U<V;U++)null!=S[D[U]]&&(D[U]=S[D[U]]);g.triangles=D}else{for(var H=f(M,g.hole||[]),q=0,G=H.length;q<G;q++)null!=S[H[q]]&&(H[q]=S[H[q]]);g.triangles=H}}var Y=new Float64Array(b);h(Y,2,A);var W=new Float64Array(2*_+6);g.close?b[0]===b[2*_-2]&&b[1]===b[2*_-1]?(W[0]=Y[2*_-4],W[1]=Y[2*_-3]):(W[0]=Y[2*_-2],W[1]=Y[2*_-1]):(W[0]=Y[0],W[1]=Y[1]),W.set(Y,2),g.close?b[0]===b[2*_-2]&&b[1]===b[2*_-1]?(W[2*_+2]=Y[2],W[2*_+3]=Y[3],g.count-=1):(W[2*_+2]=Y[0],W[2*_+3]=Y[1],W[2*_+4]=Y[2],W[2*_+5]=Y[3]):(W[2*_+2]=Y[2*_-2],W[2*_+3]=Y[2*_-1],W[2*_+4]=Y[2*_-2],W[2*_+5]=Y[2*_-1]);var X=d(W);g.positionBuffer(X);var Z=m(W,X);g.positionFractBuffer(Z)}if(r.range?g.range=r.range:g.range||(g.range=g.bounds),(r.range||r.positions)&&g.count){var J=g.bounds,K=J[2]-J[0],Q=J[3]-J[1],$=g.range[2]-g.range[0],tt=g.range[3]-g.range[1];g.scale=[K/$,Q/tt],g.translate=[-g.range[0]/$+J[0]/$||0,-g.range[1]/tt+J[1]/tt||0],g.scaleFract=m(g.scale),g.translateFract=m(g.translate)}if(r.dashes){var te,tr=0;if(!r.dashes||r.dashes.length<2)tr=1,te=new Uint8Array([255,255,255,255,255,255,255,255]);else{tr=0;for(var tn=0;tn<r.dashes.length;++tn)tr+=r.dashes[tn];te=new Uint8Array(tr*x.dashMult);for(var ti=0,ta=255,to=0;to<2;to++)for(var ts=0;ts<r.dashes.length;++ts){for(var tl=0,tc=r.dashes[ts]*x.dashMult*.5;tl<tc;++tl)te[ti++]=ta;ta^=255}}g.dashLength=tr,g.dashTexture({channels:1,data:te,width:te.length,height:1,mag:"linear",min:"linear"},0,0)}if(r.color){var tu=g.count,tf=r.color;tf||(tf="transparent");var th=new Uint8Array(4*tu+4);if(Array.isArray(tf)&&"number"!=typeof tf[0]){for(var tp=0;tp<tu;tp++){var td=a(tf[tp],"uint8");th.set(td,4*tp)}th.set(a(tf[0],"uint8"),4*tu)}else for(var tm=a(tf,"uint8"),tg=0;tg<tu+1;tg++)th.set(tm,4*tg);g.colorBuffer({usage:"dynamic",type:"uint8",data:th})}}else n.passes[p]=null}}),r.length<this.passes.length){for(var p=r.length;p<this.passes.length;p++){var g=this.passes[p];g&&(g.colorBuffer.destroy(),g.positionBuffer.destroy(),g.dashTexture.destroy())}this.passes.length=r.length}for(var b=[],_=0;_<this.passes.length;_++)null!==this.passes[_]&&b.push(this.passes[_]);return this.passes=b,this}},x.prototype.destroy=function(){return this.passes.forEach(function(r){r.colorBuffer.destroy(),r.positionBuffer.destroy(),r.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":313}],281:[function(r,n,i){"use strict";function a(r,n){if(r){if("string"==typeof r)return o(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);return"Object"===i&&r.constructor&&(i=r.constructor.name),"Map"===i||"Set"===i?Array.from(r):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(r,n):void 0}}function o(r,n){(null==n||n>r.length)&&(n=r.length);for(var i=0,a=Array(n);i<n;i++)a[i]=r[i];return a}var s=r("color-normalize"),l=r("array-bounds"),c=r("color-id"),u=r("@plotly/point-cluster"),f=r("object-assign"),h=r("glslify"),p=r("pick-by-alias"),d=r("update-diff"),m=r("flatten-vertex-data"),g=r("is-iexplorer"),v=r("to-float32"),y=r("parse-rect");function x(r,n){var i=this;if(!(this instanceof x))return new x(r,n);"function"==typeof r?(n||(n={}),n.regl=r):(n=r,r=null),n&&n.length&&(n.positions=n);var a,o=(r=n.regl)._gl,s=[];this.tooManyColors=g,a=r.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),f(this,{regl:r,gl:o,groups:[],markerCache:[null],markerTextures:[null],palette:s,paletteIds:{},paletteTexture:a,maxColors:255,maxSize:100,canvas:o.canvas}),this.update(n);var l={uniforms:{constPointSize:!!n.constPointSize,opacity:r.prop("opacity"),paletteSize:function(r,n){return[i.tooManyColors?0:255,a.height]},pixelRatio:r.context("pixelRatio"),scale:r.prop("scale"),scaleFract:r.prop("scaleFract"),translate:r.prop("translate"),translateFract:r.prop("translateFract"),markerTexture:r.prop("markerTexture"),paletteTexture:a},attributes:{x:function(r,n){return n.xAttr||{buffer:n.positionBuffer,stride:8,offset:0}},y:function(r,n){return n.yAttr||{buffer:n.positionBuffer,stride:8,offset:4}},xFract:function(r,n){return n.xAttr?{constant:[0,0]}:{buffer:n.positionFractBuffer,stride:8,offset:0}},yFract:function(r,n){return n.yAttr?{constant:[0,0]}:{buffer:n.positionFractBuffer,stride:8,offset:4}},size:function(r,n){return n.size.length?{buffer:n.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*n.size/i.maxSize)]}},borderSize:function(r,n){return n.borderSize.length?{buffer:n.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*n.borderSize/i.maxSize)]}},colorId:function(r,n){return n.color.length?{buffer:n.colorBuffer,stride:i.tooManyColors?8:4,offset:0}:{constant:i.tooManyColors?s.slice(4*n.color,4*n.color+4):[n.color]}},borderColorId:function(r,n){return n.borderColor.length?{buffer:n.colorBuffer,stride:i.tooManyColors?8:4,offset:i.tooManyColors?4:2}:{constant:i.tooManyColors?s.slice(4*n.borderColor,4*n.borderColor+4):[n.borderColor]}},isActive:function(r,n){return!0===n.activation?{constant:[1]}:n.activation?n.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:r.prop("viewport")},viewport:r.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:r.prop("elements"),count:r.prop("count"),offset:r.prop("offset"),primitive:"points"},c=f({},l);c.frag=h(["precision highp float;\n#define GLSLIFY 1\n\nuniform float opacity;\nuniform sampler2D markerTexture;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),c.vert=h(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pointSizeScale;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=r(c);var u=f({},l);u.frag=h(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nuniform float opacity;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n	float t;\n	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n	return t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n	float radius, alpha = 1.0, delta = fragWidth;\n\n	radius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n	if (radius > 1.0 + delta) {\n		discard;\n	}\n\n	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n	float borderRadius = fragBorderRadius;\n	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n	vec4 color = mix(fragColor, fragBorderColor, ratio);\n	color.a *= alpha * opacity;\n	gl_FragColor = color;\n}\n"]),u.vert=h(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 paletteSize, scale, scaleFract, translate, translateFract;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pointSizeScale;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),g&&(u.frag=u.frag.replace("smoothstep","smoothStep"),c.frag=c.frag.replace("smoothstep","smoothStep")),this.drawCircle=r(u)}x.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},x.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},x.prototype.draw=function(){for(var r=this,n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var o=this.groups;if(1===i.length&&Array.isArray(i[0])&&(null===i[0][0]||Array.isArray(i[0][0]))&&(i=i[0]),this.regl._refresh(),i.length)for(var s=0;s<i.length;s++)this.drawItem(s,i[s]);else o.forEach(function(n,i){r.drawItem(i)});return this},x.prototype.drawItem=function(r,n){var i=this.groups,s=i[r];if("number"==typeof n&&(r=n,s=i[n],n=null),s&&s.count&&s.opacity){s.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,s,n));for(var l,c=[],u=1;u<s.activation.length;u++)s.activation[u]&&(!0===s.activation[u]||s.activation[u].data.length)&&c.push.apply(c,function(r){if(Array.isArray(r))return o(r)}(l=this.getMarkerDrawOptions(u,s,n))||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(l)||a(l)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());c.length&&this.drawMarker(c)}},x.prototype.getMarkerDrawOptions=function(r,n,i){var o=n.range,s=n.tree,l=n.viewport,c=n.activation,u=n.selectionBuffer,h=n.count;if(this.regl,!s)return i?[f({},n,{markerTexture:this.markerTextures[r],activation:c[r],count:i.length,elements:i,offset:0})]:[f({},n,{markerTexture:this.markerTextures[r],activation:c[r],offset:0})];var p=[],d=s.range(o,{lod:!0,px:[(o[2]-o[0])/l.width,(o[3]-o[1])/l.height]});if(i){for(var m=c[r].data,g=new Uint8Array(h),v=0;v<i.length;v++){var y=i[v];g[y]=m?m[y]:1}u.subdata(g)}for(var x=d.length;x--;){var b,_=function(r){if(Array.isArray(r))return r}(b=d[x])||function(r,n){var i=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=i){var a,o,s=[],l=!0,c=!1;try{for(i=i.call(r);!(l=(a=i.next()).done)&&(s.push(a.value),!n||s.length!==n);l=!0);}catch(r){c=!0,o=r}finally{try{l||null==i.return||i.return()}finally{if(c)throw o}}return s}}(b,2)||a(b,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),w=_[0],T=_[1];p.push(f({},n,{markerTexture:this.markerTextures[r],activation:i?u:c[r],offset:w,count:T-w}))}return p},x.prototype.update=function(){for(var r=this,n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];if(i.length){1===i.length&&Array.isArray(i[0])&&(i=i[0]);var o=this.groups,s=this.gl,c=this.regl,h=this.maxSize,g=this.maxColors,b=this.palette;this.groups=o=i.map(function(n,i){var a=o[i];if(void 0===n)return a;null===n?n={positions:null}:"function"==typeof n?n={ondraw:n}:"number"==typeof n[0]&&(n={positions:n}),null===(n=p(n,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions&&(n.positions=[]),null!=n.tooManyColors&&(r.tooManyColors=n.tooManyColors),a||(o[i]=a={id:i,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:c.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:c.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:c.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:c.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:c.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},n=f({},x.defaults,n)),!n.positions||"marker"in n||(n.marker=a.marker,delete a.marker),!n.marker||"positions"in n||(n.positions=a.positions,delete a.positions);var _=0,w=0;if(d(a,n,[{snap:!0,size:function(r,n){return null==r&&(r=x.defaults.size),_+=r&&r.length?1:0,r},borderSize:function(r,n){return null==r&&(r=x.defaults.borderSize),_+=r&&r.length?1:0,r},opacity:parseFloat,color:function(n,i){return null==n&&(n=x.defaults.color),n=r.updateColor(n),w++,n},borderColor:function(n,i){return null==n&&(n=x.defaults.borderColor),n=r.updateColor(n),w++,n},bounds:function(r,n,i){return"range"in i||(i.range=null),r},positions:function(r,n,i){var a=n.snap,o=n.positionBuffer,s=n.positionFractBuffer,f=n.selectionBuffer;if(r.x||r.y)return r.x.length?n.xAttr={buffer:c.buffer(r.x),offset:0,stride:4,count:r.x.length}:n.xAttr={buffer:r.x.buffer,offset:4*r.x.offset||0,stride:4*(r.x.stride||1),count:r.x.count},r.y.length?n.yAttr={buffer:c.buffer(r.y),offset:0,stride:4,count:r.y.length}:n.yAttr={buffer:r.y.buffer,offset:4*r.y.offset||0,stride:4*(r.y.stride||1),count:r.y.count},n.count=Math.max(n.xAttr.count,n.yAttr.count),r;r=m(r,"float64");var h=n.count=Math.floor(r.length/2),p=n.bounds=h?l(r,2):null;if(i.range||n.range||(delete n.range,i.range=p),i.marker||n.marker||(delete n.marker,i.marker=null),a&&(!0===a||h>a)?n.tree=u(r,{bounds:p}):a&&a.length&&(n.tree=a),n.tree){var d={primitive:"points",usage:"static",data:n.tree,type:"uint32"};n.elements?n.elements(d):n.elements=c.elements(d)}var g=v.float32(r);return o({data:g,usage:"dynamic"}),s({data:v.fract32(r,g),usage:"dynamic"}),f({data:new Uint8Array(h),type:"uint8",usage:"stream"}),r}},{marker:function(n,i,a){var o=i.activation;if(o.forEach(function(r){return r&&r.destroy&&r.destroy()}),o.length=0,n&&"number"!=typeof n[0]){for(var s=[],l=0,u=Math.min(n.length,i.count);l<u;l++){var f=r.addMarker(n[l]);s[f]||(s[f]=new Uint8Array(i.count)),s[f][l]=1}for(var h=0;h<s.length;h++)if(s[h]){var p={data:s[h],type:"uint8",usage:"static"};o[h]?o[h](p):o[h]=c.buffer(p),o[h].data=s[h]}}else o[r.addMarker(n)]=!0;return n},range:function(r,n,i){var a=n.bounds;if(a)return r||(r=a),n.scale=[1/(r[2]-r[0]),1/(r[3]-r[1])],n.translate=[-r[0],-r[1]],n.scaleFract=v.fract(n.scale),n.translateFract=v.fract(n.translate),r},viewport:function(r){return y(r||[s.drawingBufferWidth,s.drawingBufferHeight])}}]),_){var T=a,k=T.count,A=T.size,M=T.borderSize,S=T.sizeBuffer,E=new Uint8Array(2*k);if(A.length||M.length)for(var L=0;L<k;L++)E[2*L]=Math.round(255*(null==A[L]?A:A[L])/h),E[2*L+1]=Math.round(255*(null==M[L]?M:M[L])/h);S({data:E,usage:"dynamic"})}if(w){var C,P=a,I=P.count,O=P.color,z=P.borderColor,D=P.colorBuffer;if(r.tooManyColors){if(O.length||z.length){C=new Uint8Array(8*I);for(var R=0;R<I;R++){var F=O[R];C[8*R]=b[4*F],C[8*R+1]=b[4*F+1],C[8*R+2]=b[4*F+2],C[8*R+3]=b[4*F+3];var B=z[R];C[8*R+4]=b[4*B],C[8*R+5]=b[4*B+1],C[8*R+6]=b[4*B+2],C[8*R+7]=b[4*B+3]}}}else if(O.length||z.length){C=new Uint8Array(4*I+2);for(var N=0;N<I;N++)null!=O[N]&&(C[4*N]=O[N]%g,C[4*N+1]=Math.floor(O[N]/g)),null!=z[N]&&(C[4*N+2]=z[N]%g,C[4*N+3]=Math.floor(z[N]/g))}D({data:C||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return a})}},x.prototype.addMarker=function(r){var n,i=this.markerTextures,a=this.regl,o=this.markerCache,s=null==r?0:o.indexOf(r);if(s>=0)return s;if(r instanceof Uint8Array||r instanceof Uint8ClampedArray)n=r;else{n=new Uint8Array(r.length);for(var l=0,c=r.length;l<c;l++)n[l]=255*r[l]}var u=Math.floor(Math.sqrt(n.length));return s=i.length,o.push(r),i.push(a.texture({channels:1,data:n,radius:u,mag:"linear",min:"linear"})),s},x.prototype.updateColor=function(r){var n=this.paletteIds,i=this.palette,a=this.maxColors;Array.isArray(r)||(r=[r]);var o=[];if("number"==typeof r[0]){var l=[];if(Array.isArray(r))for(var u=0;u<r.length;u+=4)l.push(r.slice(u,u+4));else for(var f=0;f<r.length;f+=4)l.push(r.subarray(f,f+4));r=l}for(var h=0;h<r.length;h++){var p=r[h],d=c(p=s(p,"uint8"),!1);if(null==n[d]){var m=i.length;n[d]=Math.floor(m/4),i[m]=p[0],i[m+1]=p[1],i[m+2]=p[2],i[m+3]=p[3]}o[h]=n[d]}return!this.tooManyColors&&i.length>4*a&&(this.tooManyColors=!0),this.updatePalette(i),1===o.length?o[0]:o},x.prototype.updatePalette=function(r){if(!this.tooManyColors){var n=this.maxColors,i=this.paletteTexture,a=Math.ceil(.25*r.length/n);if(a>1)for(var o=.25*(r=r.slice()).length%n;o<a*n;o++)r.push(0,0,0,0);i.height<a&&i.resize(n,a),i.subimage({width:Math.min(.25*r.length,n),height:a,data:r},0,0)}},x.prototype.destroy=function(){return this.groups.forEach(function(r){r.sizeBuffer.destroy(),r.positionBuffer.destroy(),r.positionFractBuffer.destroy(),r.colorBuffer.destroy(),r.activation.forEach(function(r){return r&&r.destroy&&r.destroy()}),r.selectionBuffer.destroy(),r.elements&&r.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(r){return r&&r.destroy&&r.destroy()}),this};var b=r("object-assign");n.exports=function(r,n){var i=new x(r,n),a=i.render.bind(i);return b(a,{render:a,update:i.update.bind(i),draw:i.draw.bind(i),destroy:i.destroy.bind(i),regl:i.regl,gl:i.gl,canvas:i.gl.canvas,groups:i.groups,markers:i.markerCache,palette:i.palette}),a}},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":313,"update-diff":329}],282:[function(r,n,i){"use strict";var a=r("regl-scatter2d"),o=r("pick-by-alias"),s=r("array-bounds"),l=r("raf"),c=r("array-range"),u=r("parse-rect"),f=r("flatten-vertex-data");function h(r,n){if(!(this instanceof h))return new h(r,n);this.traces=[],this.passes={},this.regl=r,this.scatter=a(r),this.canvas=this.scatter.canvas}function p(r,n,i){var a,o,s,l,c=r[n],u=r[i];return c.length>2?(c[0],c[2],a=c[1],o=c[3]):c.length?(a=c[0],o=c[1]):(c.x,a=c.y,c.x,c.width,o=c.y+c.height),u.length>2?(s=u[0],l=u[2],u[1],u[3]):u.length?(s=u[0],l=u[1]):(s=u.x,u.y,l=u.x+u.width,u.y,u.height),[s,a,l,o]}function d(r){if("number"==typeof r)return[r,r,r,r];if(2===r.length)return[r[0],r[1],r[0],r[1]];var n=u(r);return[n.x,n.y,n.x+n.width,n.y+n.height]}n.exports=h,h.prototype.render=function(){for(var r=this,n=[],i=arguments.length;i--;)n[i]=arguments[i];return n.length&&this.update.apply(this,n),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?null==this.planned&&(this.planned=l(function(){r.draw(),r.dirty=!0,r.planned=null})):(this.draw(),this.dirty=!0,l(function(){r.dirty=!1})),this)},h.prototype.update=function(){for(var r,n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length){for(var a=0;a<n.length;a++)this.updateItem(a,n[a]);this.traces=this.traces.filter(Boolean);for(var o=[],s=0,l=0;l<this.traces.length;l++){for(var c=this.traces[l],u=this.traces[l].passes,f=0;f<u.length;f++)o.push(this.passes[u[f]]);c.passOffset=s,s+=c.passes.length}return(r=this.scatter).update.apply(r,o),this}},h.prototype.updateItem=function(r,n){var i=this.regl;if(null===n)return this.traces[r]=null,this;if(!n)return this;var a,l=o(n,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),c=this.traces[r]||(this.traces[r]={id:r,buffer:i.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:u([i._gl.drawingBufferWidth,i._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=l.color&&(c.color=l.color),null!=l.size&&(c.size=l.size),null!=l.marker&&(c.marker=l.marker),null!=l.borderColor&&(c.borderColor=l.borderColor),null!=l.borderSize&&(c.borderSize=l.borderSize),null!=l.opacity&&(c.opacity=l.opacity),l.viewport&&(c.viewport=u(l.viewport)),null!=l.diagonal&&(c.diagonal=l.diagonal),null!=l.upper&&(c.upper=l.upper),null!=l.lower&&(c.lower=l.lower),l.data){c.buffer(f(l.data)),c.columns=l.data.length,c.count=l.data[0].length,c.bounds=[];for(var h=0;h<c.columns;h++)c.bounds[h]=s(l.data[h],1)}l.range&&(c.range=l.range,a=c.range&&"number"!=typeof c.range[0]),l.domain&&(c.domain=l.domain);var m=!1;null!=l.padding&&(Array.isArray(l.padding)&&l.padding.length===c.columns&&"number"==typeof l.padding[l.padding.length-1]?(c.padding=l.padding.map(d),m=!0):c.padding=d(l.padding));var g=c.columns,v=c.count,y=c.viewport.width,x=c.viewport.height,b=c.viewport.x,_=c.viewport.y,w=y/g,T=x/g;c.passes=[];for(var k=0;k<g;k++)for(var A=0;A<g;A++)if((c.diagonal||A!==k)&&(c.upper||!(k>A))&&(c.lower||!(k<A))){var M,S,E,L=(M=c.id,S=k,E=A,(null!=M.id?M.id:M)<<16|(255&S)<<8|255&E),C=this.passes[L]||(this.passes[L]={});if(l.data&&(l.transpose?C.positions={x:{buffer:c.buffer,offset:A,count:v,stride:g},y:{buffer:c.buffer,offset:k,count:v,stride:g}}:C.positions={x:{buffer:c.buffer,offset:A*v,count:v},y:{buffer:c.buffer,offset:k*v,count:v}},C.bounds=p(c.bounds,k,A)),l.domain||l.viewport||l.data){var P=m?p(c.padding,k,A):c.padding;if(c.domain){var I=p(c.domain,k,A),O=I[0],z=I[1],D=I[2],R=I[3];C.viewport=[b+O*y+P[0],_+z*x+P[1],b+D*y-P[2],_+R*x-P[3]]}else C.viewport=[b+A*w+w*P[0],_+k*T+T*P[1],b+(A+1)*w-w*P[2],_+(k+1)*T-T*P[3]]}l.color&&(C.color=c.color),l.size&&(C.size=c.size),l.marker&&(C.marker=c.marker),l.borderSize&&(C.borderSize=c.borderSize),l.borderColor&&(C.borderColor=c.borderColor),l.opacity&&(C.opacity=c.opacity),l.range&&(C.range=a?p(c.range,k,A):c.range||C.bounds),c.passes.push(L)}return this},h.prototype.draw=function(){for(var r,n=[],i=arguments.length;i--;)n[i]=arguments[i];if(n.length){for(var a=[],o=0;o<n.length;o++)if("number"==typeof n[o]){var s=this.traces[n[o]],l=s.passes,u=s.passOffset;a.push.apply(a,c(u,u+l.length))}else if(n[o].length){var f=n[o],h=this.traces[o],p=h.passes,d=h.passOffset;p=p.map(function(r,n){a[d+n]=f})}(r=this.scatter).draw.apply(r,a)}else this.scatter.draw();return this},h.prototype.destroy=function(){return this.traces.forEach(function(r){r.buffer&&r.buffer.destroy&&r.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:278,"regl-scatter2d":281}],283:[function(r,n,i){var a;a=function(){function r(r,n){this.id=z++,this.type=r,this.data=n}function n(r){return"["+(function r(n){if(0===n.length)return[];var i=n.charAt(0),a=n.charAt(n.length-1);if(1<n.length&&i===a&&('"'===i||"'"===i))return['"'+n.substr(1,n.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(i=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(n))return r(n.substr(0,i.index)).concat(r(i[1])).concat(r(n.substr(i.index+i[0].length)));if(1===(i=n.split(".")).length)return['"'+n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(n=[],a=0;a<i.length;++a)n=n.concat(r(i[a]));return n})(r).join("][")+"]"}function i(r){return"string"==typeof r?r.split():r}function a(r){return"string"==typeof r?document.querySelector(r):r}function o(r,n){for(var i=Array(r),a=0;a<r;++a)i[a]=n(a);return i}function s(r){var n,i;return n=(65535<r)<<4,n|=i=(255<(r>>>=n))<<3,(n|=i=(15<(r>>>=i))<<2)|(i=(3<(r>>>=i))<<1)|r>>>i>>1}function l(){function r(r){t:{for(var n=16;268435456>=n;n*=16)if(r<=n){r=n;break t}r=0}return 0<(n=i[s(r)>>2]).length?n.pop():new ArrayBuffer(r)}function n(r){i[s(r.byteLength)>>2].push(r)}var i=o(8,function(){return[]});return{alloc:r,free:n,allocType:function(n,i){var a=null;switch(n){case 5120:a=new Int8Array(r(i),0,i);break;case 5121:a=new Uint8Array(r(i),0,i);break;case 5122:a=new Int16Array(r(2*i),0,i);break;case 5123:a=new Uint16Array(r(2*i),0,i);break;case 5124:a=new Int32Array(r(4*i),0,i);break;case 5125:a=new Uint32Array(r(4*i),0,i);break;case 5126:a=new Float32Array(r(4*i),0,i);break;default:return null}return a.length!==i?a.subarray(0,i):a},freeType:function(r){n(r.buffer)}}}function c(r){return!!r&&"object"==typeof r&&Array.isArray(r.shape)&&Array.isArray(r.stride)&&"number"==typeof r.offset&&r.shape.length===r.stride.length&&(Array.isArray(r.data)||j(r.data))}function u(r,n,i,a,o,s){for(var l=0;l<n;++l)for(var c=r[l],u=0;u<i;++u)for(var f=c[u],h=0;h<a;++h)o[s++]=f[h]}function f(r){return 0|H[Object.prototype.toString.call(r)]}function h(r,n){for(var i=0;i<n.length;++i)r[i]=n[i]}function p(r,n,i,a,o,s,l){for(var c=0,u=0;u<i;++u)for(var f=0;f<a;++f)r[c++]=n[o*u+s*f+l]}function d(r){for(var n=B.allocType(5123,r.length),i=0;i<r.length;++i)if(isNaN(r[i]))n[i]=65535;else if(1/0===r[i])n[i]=31744;else if(-1/0===r[i])n[i]=64512;else{J[0]=r[i];var a=(s=K[0])>>>31<<15,o=(s<<1>>>24)-127,s=s>>13&1023;n[i]=-24>o?a:-14>o?a+(s+1024>>-14-o):15<o?a+31744:a+(o+15<<10)+s}return n}function m(r){return Array.isArray(r)||j(r)}function g(r){return"[object "+r+"]"}function v(r){return Array.isArray(r)&&(0===r.length||"number"==typeof r[0])}function y(r){return!(!Array.isArray(r)||0===r.length||!m(r[0]))}function x(r){return Object.prototype.toString.call(r)}function b(r){if(!r)return!1;var n=x(r);return 0<=ts.indexOf(n)||v(r)||y(r)||c(r)}function _(r,n){36193===r.type?(r.data=d(n),B.freeType(n)):r.data=n}function w(r,n,i,a,o,s){if(r=void 0!==tc[r]?tc[r]:tt[r]*tl[n],s&&(r*=6),o){for(a=0;1<=i;)a+=r*i*i,i/=2;return a}return r*i*a}function T(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function k(r){return Array.prototype.slice.call(r)}function A(r){return k(r).join("")}function M(r){return Array.isArray(r)||j(r)||c(r)}function S(r){return r.sort(function(r,n){return"viewport"===r?-1:"viewport"===n?1:r<n?-1:1})}function E(r,n,i,a){this.thisDep=r,this.contextDep=n,this.propDep=i,this.append=a}function L(r){return r&&!(r.thisDep||r.contextDep||r.propDep)}function C(r){return new E(!1,!1,!1,r)}function P(r,n){var i=r.type;if(0===i)return new E(!0,1<=(i=r.data.length),2<=i,n);if(4===i)return new E((i=r.data).thisDep,i.contextDep,i.propDep,n);if(5===i)return new E(!1,!1,!1,n);if(6===i){for(var a=i=!1,o=!1,s=0;s<r.data.length;++s){var l=r.data[s];1===l.type?o=!0:2===l.type?a=!0:3===l.type?i=!0:0===l.type?(i=!0,1<=(l=l.data)&&(a=!0),2<=l&&(o=!0)):4===l.type&&(i=i||l.data.thisDep,a=a||l.data.contextDep,o=o||l.data.propDep)}return new E(i,a,o,n)}return new E(3===i,2===i,1===i,n)}function I(r,n){for(var i=0;i<r.length;++i)if(r[i]===n)return i;return -1}var O=function(r,n){for(var i=Object.keys(n),a=0;a<i.length;++a)r[i[a]]=n[i[a]];return r},z=0,D={DynamicVariable:r,define:function(i,a){return new r(i,n(a+""))},isDynamic:function(n){return"function"==typeof n&&!n._reglType||n instanceof r},unbox:function n(i,a){return"function"==typeof i?new r(0,i):"number"==typeof i||"boolean"==typeof i?new r(5,i):Array.isArray(i)?new r(6,i.map(function(r,i){return n(r,a+"["+i+"]")})):i instanceof r?i:void 0},accessor:n},R={next:"function"==typeof requestAnimationFrame?function(r){return requestAnimationFrame(r)}:function(r){return setTimeout(r,16)},cancel:"function"==typeof cancelAnimationFrame?function(r){return cancelAnimationFrame(r)}:clearTimeout},F="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},B=l();B.zero=l();var N=function(r,n){var i=1;n.ext_texture_filter_anisotropic&&(i=r.getParameter(34047));var a=1,o=1;n.webgl_draw_buffers&&(a=r.getParameter(34852),o=r.getParameter(36063));var s=!!n.oes_texture_float;if(s){s=r.createTexture(),r.bindTexture(3553,s),r.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var l=r.createFramebuffer();if(r.bindFramebuffer(36160,l),r.framebufferTexture2D(36160,36064,3553,s,0),r.bindTexture(3553,null),36053!==r.checkFramebufferStatus(36160))s=!1;else{r.viewport(0,0,1,1),r.clearColor(1,0,0,1),r.clear(16384);var c=B.allocType(5126,4);r.readPixels(0,0,1,1,6408,5126,c),r.getError()?s=!1:(r.deleteFramebuffer(l),r.deleteTexture(s),s=1===c[0]),B.freeType(c)}}return c=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(c=r.createTexture(),l=B.allocType(5121,36),r.activeTexture(33984),r.bindTexture(34067,c),r.texImage2D(34069,0,6408,3,3,0,6408,5121,l),B.freeType(l),r.bindTexture(34067,null),r.deleteTexture(c),c=!r.getError()),{colorBits:[r.getParameter(3410),r.getParameter(3411),r.getParameter(3412),r.getParameter(3413)],depthBits:r.getParameter(3414),stencilBits:r.getParameter(3415),subpixelBits:r.getParameter(3408),extensions:Object.keys(n).filter(function(r){return!!n[r]}),maxAnisotropic:i,maxDrawbuffers:a,maxColorAttachments:o,pointSizeDims:r.getParameter(33901),lineWidthDims:r.getParameter(33902),maxViewportDims:r.getParameter(3386),maxCombinedTextureUnits:r.getParameter(35661),maxCubeMapSize:r.getParameter(34076),maxRenderbufferSize:r.getParameter(34024),maxTextureUnits:r.getParameter(34930),maxTextureSize:r.getParameter(3379),maxAttributes:r.getParameter(34921),maxVertexUniforms:r.getParameter(36347),maxVertexTextureUnits:r.getParameter(35660),maxVaryingVectors:r.getParameter(36348),maxFragmentUniforms:r.getParameter(36349),glsl:r.getParameter(35724),renderer:r.getParameter(7937),vendor:r.getParameter(7936),version:r.getParameter(7938),readFloat:s,npotTextureCube:c}},j=function(r){return r instanceof Uint8Array||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array||r instanceof Float32Array||r instanceof Float64Array||r instanceof Uint8ClampedArray},U=function(r){return Object.keys(r).map(function(n){return r[n]})},V={shape:function(r){for(var n=[];r.length;r=r[0])n.push(r.length);return n},flatten:function(r,n,i,a){var o=1;if(n.length)for(var s=0;s<n.length;++s)o*=n[s];else o=0;switch(i=a||B.allocType(i,o),n.length){case 0:break;case 1:for(a=n[0],n=0;n<a;++n)i[n]=r[n];break;case 2:for(a=n[0],n=n[1],s=o=0;s<a;++s)for(var l=r[s],c=0;c<n;++c)i[o++]=l[c];break;case 3:u(r,n[0],n[1],n[2],i,0);break;default:!function r(n,i,a,o,s){for(var l=1,c=a+1;c<i.length;++c)l*=i[c];var f=i[a];if(4==i.length-a){var h=i[a+1],p=i[a+2];for(i=i[a+3],c=0;c<f;++c)u(n[c],h,p,i,o,s),s+=l}else for(c=0;c<f;++c)r(n[c],i,a+1,o,s),s+=l}(r,n,0,i,0)}return i}},H={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},q={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},G={dynamic:35048,stream:35040,static:35044},Y=V.flatten,W=V.shape,X=[];X[5120]=1,X[5122]=2,X[5124]=4,X[5121]=1,X[5123]=2,X[5125]=4,X[5126]=4;var Z={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},J=new Float32Array(1),K=new Uint32Array(J.buffer),Q=[9984,9986,9985,9987],$=[0,6409,6410,6407,6408],tt={};tt[6409]=tt[6406]=tt[6402]=1,tt[34041]=tt[6410]=2,tt[6407]=tt[35904]=3,tt[6408]=tt[35906]=4;var te=g("HTMLCanvasElement"),tr=g("OffscreenCanvas"),tn=g("CanvasRenderingContext2D"),ti=g("ImageBitmap"),ta=g("HTMLImageElement"),to=g("HTMLVideoElement"),ts=Object.keys(H).concat([te,tr,tn,ti,ta,to]),tl=[];tl[5121]=1,tl[5126]=4,tl[36193]=2,tl[5123]=2,tl[5125]=4;var tc=[];tc[32854]=2,tc[32855]=2,tc[36194]=2,tc[34041]=4,tc[33776]=.5,tc[33777]=.5,tc[33778]=1,tc[33779]=1,tc[35986]=.5,tc[35987]=1,tc[34798]=1,tc[35840]=.5,tc[35841]=.25,tc[35842]=.5,tc[35843]=.25,tc[36196]=.5;var tu=[];tu[32854]=2,tu[32855]=2,tu[36194]=2,tu[33189]=2,tu[36168]=1,tu[34041]=4,tu[35907]=4,tu[34836]=16,tu[34842]=8,tu[34843]=6;var tf=function(r,n,i,a,o){function s(r){this.id=f++,this.refCount=1,this.renderbuffer=r,this.format=32854,this.height=this.width=0,o.profile&&(this.stats={size:0})}function l(n){var i=n.renderbuffer;r.bindRenderbuffer(36161,null),r.deleteRenderbuffer(i),n.renderbuffer=null,n.refCount=0,delete h[n.id],a.renderbufferCount--}var c={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};n.ext_srgb&&(c.srgba=35907),n.ext_color_buffer_half_float&&(c.rgba16f=34842,c.rgb16f=34843),n.webgl_color_buffer_float&&(c.rgba32f=34836);var u=[];Object.keys(c).forEach(function(r){u[c[r]]=r});var f=0,h={};return s.prototype.decRef=function(){0>=--this.refCount&&l(this)},o.profile&&(a.getTotalRenderbufferSize=function(){var r=0;return Object.keys(h).forEach(function(n){r+=h[n].stats.size}),r}),{create:function(n,i){function l(n,i){var a=0,s=0,h=32854;if("object"==typeof n&&n?("shape"in n?(a=0|(s=n.shape)[0],s=0|s[1]):("radius"in n&&(a=s=0|n.radius),"width"in n&&(a=0|n.width),"height"in n&&(s=0|n.height)),"format"in n&&(h=c[n.format])):"number"==typeof n?(a=0|n,s="number"==typeof i?0|i:a):n||(a=s=1),a!==f.width||s!==f.height||h!==f.format)return l.width=f.width=a,l.height=f.height=s,f.format=h,r.bindRenderbuffer(36161,f.renderbuffer),r.renderbufferStorage(36161,h,a,s),o.profile&&(f.stats.size=tu[f.format]*f.width*f.height),l.format=u[f.format],l}var f=new s(r.createRenderbuffer());return h[f.id]=f,a.renderbufferCount++,l(n,i),l.resize=function(n,i){var a=0|n,s=0|i||a;return a===f.width&&s===f.height||(l.width=f.width=a,l.height=f.height=s,r.bindRenderbuffer(36161,f.renderbuffer),r.renderbufferStorage(36161,f.format,a,s),o.profile&&(f.stats.size=tu[f.format]*f.width*f.height)),l},l._reglType="renderbuffer",l._renderbuffer=f,o.profile&&(l.stats=f.stats),l.destroy=function(){f.decRef()},l},clear:function(){U(h).forEach(l)},restore:function(){U(h).forEach(function(n){n.renderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(36161,n.renderbuffer),r.renderbufferStorage(36161,n.format,n.width,n.height)}),r.bindRenderbuffer(36161,null)}}},th=[];th[6408]=4,th[6407]=3;var tp=[];tp[5121]=1,tp[5126]=4,tp[36193]=2;var td=["x","y","z","w"],tm="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),tg={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},tv={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ty={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},tx={cw:2304,ccw:2305},tb=new E(!1,!1,!1,function(){});return function(r){function n(){if(0===tG.length)tL&&tL.update(),tZ=null;else{tZ=R.next(n),tl();for(var r=tG.length-1;0<=r;--r){var i=tG[r];i&&i(tO,null,0)}tT.flush(),tL&&tL.update()}}function s(){!tZ&&0<tG.length&&(tZ=R.next(n))}function l(){tZ&&(R.cancel(n),tZ=null)}function u(r){r.preventDefault(),l(),tY.forEach(function(r){r()})}function g(r){tT.getError(),tA.restore(),tB.restore(),tD.restore(),tN.restore(),tj.restore(),tU.restore(),tF.restore(),tL&&tL.restore(),tV.procs.refresh(),s(),tW.forEach(function(r){r()})}function z(r){function n(r,n){var i={},a={};return Object.keys(r).forEach(function(o){var s=r[o];if(D.isDynamic(s))a[o]=D.unbox(s,o);else{if(n&&Array.isArray(s)){for(var l=0;l<s.length;++l)if(D.isDynamic(s[l]))return void(a[o]=D.unbox(s,o))}i[o]=s}}),{dynamic:a,static:i}}var i=n(r.context||{},!0),a=n(r.uniforms||{},!0),o=n(r.attributes||{},!1);r=n(function(r){function n(r){if(r in i){var n=i[r];delete i[r],Object.keys(n).forEach(function(a){i[r+"."+a]=n[a]})}}var i=O({},r);return delete i.uniforms,delete i.attributes,delete i.context,delete i.vao,"stencil"in i&&i.stencil.op&&(i.stencil.opBack=i.stencil.opFront=i.stencil.op,delete i.stencil.op),n("blend"),n("depth"),n("cull"),n("stencil"),n("polygonOffset"),n("scissor"),n("sample"),"vao"in r&&(i.vao=r.vao),i}(r),!1);var s={gpuTime:0,cpuTime:0,count:0},l=tV.compile(r,o,a,i,s),c=l.draw,u=l.batch,f=l.scope,h=[];return O(function(r,n){var i;if("function"==typeof r)return f.call(this,null,r,0);if("function"==typeof n){if("number"==typeof r)for(i=0;i<r;++i)f.call(this,null,n,i);else{if(!Array.isArray(r))return f.call(this,r,n,0);for(i=0;i<r.length;++i)f.call(this,r[i],n,i)}}else if("number"==typeof r){if(0<r)return u.call(this,function(r){for(;h.length<r;)h.push(null);return h}(0|r),0|r)}else{if(!Array.isArray(r))return c.call(this,r);if(r.length)return u.call(this,r,r.length)}},{stats:s,destroy:function(){l.destroy()}})}function J(r,n){var i=0;tV.procs.poll();var a=n.color;a&&(tT.clearColor(+a[0]||0,+a[1]||0,+a[2]||0,+a[3]||0),i|=16384),"depth"in n&&(tT.clearDepth(+n.depth),i|=256),"stencil"in n&&(tT.clearStencil(0|n.stencil),i|=1024),tT.clear(i)}function K(r){return tG.push(r),s(),{cancel:function(){var n=I(tG,r);tG[n]=function r(){var n=I(tG,r);tG[n]=tG[tG.length-1],--tG.length,0>=tG.length&&l()}}}}function ts(){var r=tH.viewport,n=tH.scissor_box;r[0]=r[1]=n[0]=n[1]=0,tO.viewportWidth=tO.framebufferWidth=tO.drawingBufferWidth=r[2]=n[2]=tT.drawingBufferWidth,tO.viewportHeight=tO.framebufferHeight=tO.drawingBufferHeight=r[3]=n[3]=tT.drawingBufferHeight}function tl(){tO.tick+=1,tO.time=tu(),ts(),tV.procs.poll()}function tc(){tN.refresh(),ts(),tV.procs.refresh(),tL&&tL.update()}function tu(){return(F()-tC)/1e3}if(!(r=function(r){var n,o,s,l,c=r||{};r={};var u=[],f=[],h="undefined"==typeof window?1:window.devicePixelRatio,p=!1,d=function(r){},m=function(){};if("string"==typeof c?n=document.querySelector(c):"object"==typeof c&&("string"==typeof c.nodeName&&"function"==typeof c.appendChild&&"function"==typeof c.getBoundingClientRect?n=c:"function"==typeof c.drawArrays||"function"==typeof c.drawElements?s=(l=c).canvas:("gl"in c?l=c.gl:"canvas"in c?s=a(c.canvas):"container"in c&&(o=a(c.container)),"attributes"in c&&(r=c.attributes),"extensions"in c&&(u=i(c.extensions)),"optionalExtensions"in c&&(f=i(c.optionalExtensions)),"onDone"in c&&(d=c.onDone),"profile"in c&&(p=!!c.profile),"pixelRatio"in c&&(h=+c.pixelRatio))),n&&("canvas"===n.nodeName.toLowerCase()?s=n:o=n),!l){if(!s){if(!(n=function(r,n,i){function a(){var n=window.innerWidth,a=window.innerHeight;r!==document.body&&(n=(a=s.getBoundingClientRect()).right-a.left,a=a.bottom-a.top),s.width=i*n,s.height=i*a}var o,s=document.createElement("canvas");return O(s.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),r.appendChild(s),r===document.body&&(s.style.position="absolute",O(r.style,{margin:0,padding:0})),r!==document.body&&"function"==typeof ResizeObserver?(o=new ResizeObserver(function(){setTimeout(a)})).observe(r):window.addEventListener("resize",a,!1),a(),{canvas:s,onDestroy:function(){o?o.disconnect():window.removeEventListener("resize",a),r.removeChild(s)}}}(o||document.body,0,h)))return null;s=n.canvas,m=n.onDestroy}void 0===r.premultipliedAlpha&&(r.premultipliedAlpha=!0),l=function(r,n){function i(i){try{return r.getContext(i,n)}catch(r){return null}}return i("webgl")||i("experimental-webgl")||i("webgl-experimental")}(s,r)}return l?{gl:l,canvas:s,container:o,extensions:u,optionalExtensions:f,pixelRatio:h,profile:p,onDone:d,onDestroy:m}:(m(),d("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(r)))return null;var t_,tw,tT=r.gl,tk=tT.getContextAttributes();tT.isContextLost();var tA=function(r,n){function i(n){var i;n=n.toLowerCase();try{i=a[n]=r.getExtension(n)}catch(r){}return!!i}for(var a={},o=0;o<n.extensions.length;++o){var s=n.extensions[o];if(!i(s))return n.onDestroy(),n.onDone('"'+s+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return n.optionalExtensions.forEach(i),{extensions:a,restore:function(){Object.keys(a).forEach(function(r){if(a[r]&&!i(r))throw Error("(regl): error restoring extension "+r)})}}}(tT,r);if(!tA)return null;var tM=(t_={"":0},tw=[""],{id:function(r){var n=t_[r];return n||(n=t_[r]=tw.length,tw.push(r),n)},str:function(r){return tw[r]}}),tS={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},tE=tA.extensions,tL=function(r,n){function i(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function a(r,n,a){var o=l.pop()||new i;o.startQueryIndex=r,o.endQueryIndex=n,o.sum=0,o.stats=a,c.push(o)}if(!n.ext_disjoint_timer_query)return null;var o=[],s=[],l=[],c=[],u=[],f=[];return{beginQuery:function(r){var i=o.pop()||n.ext_disjoint_timer_query.createQueryEXT();n.ext_disjoint_timer_query.beginQueryEXT(35007,i),s.push(i),a(s.length-1,s.length,r)},endQuery:function(){n.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:a,update:function(){var r,i;if(0!==(r=s.length)){f.length=Math.max(f.length,r+1),u.length=Math.max(u.length,r+1),u[0]=0;var a=f[0]=0;for(i=r=0;i<s.length;++i){var h=s[i];n.ext_disjoint_timer_query.getQueryObjectEXT(h,34919)?(a+=n.ext_disjoint_timer_query.getQueryObjectEXT(h,34918),o.push(h)):s[r++]=h,u[i+1]=a,f[i+1]=r}for(s.length=r,i=r=0;i<c.length;++i){var p=(a=c[i]).startQueryIndex;h=a.endQueryIndex,a.sum+=u[h]-u[p],p=f[p],(h=f[h])===p?(a.stats.gpuTime+=a.sum/1e6,l.push(a)):(a.startQueryIndex=p,a.endQueryIndex=h,c[r++]=a)}c.length=r}},getNumPendingQueries:function(){return s.length},clear:function(){o.push.apply(o,s);for(var r=0;r<o.length;r++)n.ext_disjoint_timer_query.deleteQueryEXT(o[r]);s.length=0,o.length=0},restore:function(){s.length=0,o.length=0}}}(0,tE),tC=F(),tP=tT.drawingBufferWidth,tI=tT.drawingBufferHeight,tO={tick:0,time:0,viewportWidth:tP,viewportHeight:tI,framebufferWidth:tP,framebufferHeight:tI,drawingBufferWidth:tP,drawingBufferHeight:tI,pixelRatio:r.pixelRatio},tz=(tP={elements:null,primitive:4,count:-1,offset:0,instances:-1},N(tT,tE)),tD=function(r,n,i,a){function o(n){this.id=d++,this.buffer=r.createBuffer(),this.type=n,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,i.profile&&(this.stats={size:0})}function s(n,i,a){n.byteLength=i.byteLength,r.bufferData(n.type,i,a)}function l(r,n,i,a,o,l){if(r.usage=i,Array.isArray(n)){if(r.dtype=a||5126,0<n.length){if(Array.isArray(n[0])){o=W(n);for(var u=a=1;u<o.length;++u)a*=o[u];r.dimension=a,s(r,n=Y(n,o,r.dtype),i),l?r.persistentData=n:B.freeType(n)}else"number"==typeof n[0]?(r.dimension=o,h(o=B.allocType(r.dtype,n.length),n),s(r,o,i),l?r.persistentData=o:B.freeType(o)):j(n[0])&&(r.dimension=n[0].length,r.dtype=a||f(n[0])||5126,s(r,n=Y(n,[n.length,n[0].length],r.dtype),i),l?r.persistentData=n:B.freeType(n))}}else if(j(n))r.dtype=a||f(n),r.dimension=o,s(r,n,i),l&&(r.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(c(n)){o=n.shape;var d=n.stride,m=(u=n.offset,0),g=0,v=0,y=0;1===o.length?(m=o[0],g=1,v=d[0],y=0):2===o.length&&(m=o[0],g=o[1],v=d[0],y=d[1]),r.dtype=a||f(n.data)||5126,r.dimension=g,p(o=B.allocType(r.dtype,m*g),n.data,m,g,v,y,u),s(r,o,i),l?r.persistentData=o:B.freeType(o)}else n instanceof ArrayBuffer&&(r.dtype=5121,r.dimension=o,s(r,n,i),l&&(r.persistentData=new Uint8Array(new Uint8Array(n))))}function u(i){n.bufferCount--,a(i),r.deleteBuffer(i.buffer),i.buffer=null,delete m[i.id]}var d=0,m={};o.prototype.bind=function(){r.bindBuffer(this.type,this.buffer)},o.prototype.destroy=function(){u(this)};var g=[];return i.profile&&(n.getTotalBufferSize=function(){var r=0;return Object.keys(m).forEach(function(n){r+=m[n].stats.size}),r}),{create:function(a,s,d,g){function v(n){var a=35044,o=null,s=0,u=0,f=1;return Array.isArray(n)||j(n)||c(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?s=0|n:n&&("data"in n&&(o=n.data),"usage"in n&&(a=G[n.usage]),"type"in n&&(u=q[n.type]),"dimension"in n&&(f=0|n.dimension),"length"in n&&(s=0|n.length)),y.bind(),o?l(y,o,a,u,f,g):(s&&r.bufferData(y.type,s,a),y.dtype=u||5121,y.usage=a,y.dimension=f,y.byteLength=s),i.profile&&(y.stats.size=y.byteLength*X[y.dtype]),v}n.bufferCount++;var y=new o(s);return m[y.id]=y,d||v(a),v._reglType="buffer",v._buffer=y,v.subdata=function(n,i){var a,o=0|(i||0);if(y.bind(),j(n)||n instanceof ArrayBuffer)r.bufferSubData(y.type,o,n);else if(Array.isArray(n)){if(0<n.length){if("number"==typeof n[0]){var s=B.allocType(y.dtype,n.length);h(s,n),r.bufferSubData(y.type,o,s),B.freeType(s)}else(Array.isArray(n[0])||j(n[0]))&&(a=W(n),s=Y(n,a,y.dtype),r.bufferSubData(y.type,o,s),B.freeType(s))}}else if(c(n)){a=n.shape;var l=n.stride,u=s=0,d=0,m=0;1===a.length?(s=a[0],u=1,d=l[0],m=0):2===a.length&&(s=a[0],u=a[1],d=l[0],m=l[1]),a=Array.isArray(n.data)?y.dtype:f(n.data),p(a=B.allocType(a,s*u),n.data,s,u,d,m,n.offset),r.bufferSubData(y.type,o,a),B.freeType(a)}return v},i.profile&&(v.stats=y.stats),v.destroy=function(){u(y)},v},createStream:function(r,n){var i=g.pop();return i||(i=new o(r)),i.bind(),l(i,n,35040,0,1,!1),i},destroyStream:function(r){g.push(r)},clear:function(){U(m).forEach(u),g.forEach(u)},getBuffer:function(r){return r&&r._buffer instanceof o?r._buffer:null},restore:function(){U(m).forEach(function(n){n.buffer=r.createBuffer(),r.bindBuffer(n.type,n.buffer),r.bufferData(n.type,n.persistentData||n.byteLength,n.usage)})},_initBuffer:l}}(tT,tS,r,function(r){return tF.destroyBuffer(r)}),tR=function(r,n,i,a){function o(r){this.id=f++,u[this.id]=this,this.buffer=r,this.primType=4,this.type=this.vertCount=0}function s(a,o,s,l,u,f,h){var p;if(a.buffer.bind(),o?((p=h)||j(o)&&(!c(o)||j(o.data))||(p=n.oes_element_index_uint?5125:5123),i._initBuffer(a.buffer,o,s,p,3)):(r.bufferData(34963,f,s),a.buffer.dtype=p||5121,a.buffer.usage=s,a.buffer.dimension=3,a.buffer.byteLength=f),p=h,!h){switch(a.buffer.dtype){case 5121:case 5120:p=5121;break;case 5123:case 5122:p=5123;break;case 5125:case 5124:p=5125}a.buffer.dtype=p}a.type=p,0>(o=u)&&(o=a.buffer.byteLength,5123===p?o>>=1:5125===p&&(o>>=2)),a.vertCount=o,o=l,0>l&&(o=4,1===(l=a.buffer.dimension)&&(o=0),2===l&&(o=1),3===l&&(o=4)),a.primType=o}function l(r){a.elementsCount--,delete u[r.id],r.buffer.destroy(),r.buffer=null}var u={},f=0,h={uint8:5121,uint16:5123};n.oes_element_index_uint&&(h.uint32=5125),o.prototype.bind=function(){this.buffer.bind()};var p=[];return{create:function(r,n){function u(r){if(r){if("number"==typeof r)f(r),p.primType=4,p.vertCount=0|r,p.type=5121;else{var n=null,i=35044,a=-1,o=-1,l=0,d=0;Array.isArray(r)||j(r)||c(r)?n=r:("data"in r&&(n=r.data),"usage"in r&&(i=G[r.usage]),"primitive"in r&&(a=Z[r.primitive]),"count"in r&&(o=0|r.count),"type"in r&&(d=h[r.type]),"length"in r?l=0|r.length:(l=o,5123===d||5122===d?l*=2:5125!==d&&5124!==d||(l*=4))),s(p,n,i,a,o,l,d)}}else f(),p.primType=4,p.vertCount=0,p.type=5121;return u}var f=i.create(null,34963,!0),p=new o(f._buffer);return a.elementsCount++,u(r),u._reglType="elements",u._elements=p,u.subdata=function(r,n){return f.subdata(r,n),u},u.destroy=function(){l(p)},u},createStream:function(r){var n=p.pop();return n||(n=new o(i.create(null,34963,!0,!1)._buffer)),s(n,r,35040,-1,-1,0,0),n},destroyStream:function(r){p.push(r)},getElements:function(r){return"function"==typeof r&&r._elements instanceof o?r._elements:null},clear:function(){U(u).forEach(l)}}}(tT,tE,tD,tS),tF=function(r,n,i,a,o,s,l){function u(){this.id=++p,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var r=n.oes_vertex_array_object;this.vao=r?r.createVertexArrayOES():null,d[this.id]=this,this.buffers=[]}var f=i.maxAttributes,h=Array(f);for(i=0;i<f;++i)h[i]=new T;var p=0,d={},m={Record:T,scope:{},state:h,currentVAO:null,targetVAO:null,restore:n.oes_vertex_array_object?function(){n.oes_vertex_array_object&&U(d).forEach(function(r){r.refresh()})}:function(){},createVAO:function(r){function n(r){Array.isArray(r)?(u=r,i.elements&&i.ownsElements&&i.elements.destroy(),i.elements=null,i.ownsElements=!1,i.offset=0,i.count=0,i.instances=-1,i.primitive=4):(r.elements?(u=r.elements,i.ownsElements?("function"==typeof u&&"elements"===u._reglType?i.elements.destroy():i.elements(u),i.ownsElements=!1):s.getElements(r.elements)?(i.elements=r.elements,i.ownsElements=!1):(i.elements=s.create(r.elements),i.ownsElements=!0)):(i.elements=null,i.ownsElements=!1),u=r.attributes,i.offset=0,i.count=-1,i.instances=-1,i.primitive=4,i.elements&&(i.count=i.elements._elements.vertCount,i.primitive=i.elements._elements.primType),"offset"in r&&(i.offset=0|r.offset),"count"in r&&(i.count=0|r.count),"instances"in r&&(i.instances=0|r.instances),"primitive"in r&&(i.primitive=Z[r.primitive])),r={};var a=i.attributes;a.length=u.length;for(var l=0;l<u.length;++l){var u,f,h=u[l],p=a[l]=new T,d=h.data||h;Array.isArray(d)||j(d)||c(d)?(i.buffers[l]&&(f=i.buffers[l],j(d)&&f._buffer.byteLength>=d.byteLength?f.subdata(d):(f.destroy(),i.buffers[l]=null)),i.buffers[l]||(f=i.buffers[l]=o.create(h,34962,!1,!0)),p.buffer=o.getBuffer(f),p.size=0|p.buffer.dimension,p.normalized=!1,p.type=p.buffer.dtype,p.offset=0,p.stride=0,p.divisor=0,p.state=1,r[l]=1):o.getBuffer(h)?(p.buffer=o.getBuffer(h),p.size=0|p.buffer.dimension,p.normalized=!1,p.type=p.buffer.dtype,p.offset=0,p.stride=0,p.divisor=0,p.state=1):o.getBuffer(h.buffer)?(p.buffer=o.getBuffer(h.buffer),p.size=0|(+h.size||p.buffer.dimension),p.normalized=!!h.normalized,p.type="type"in h?q[h.type]:p.buffer.dtype,p.offset=0|(h.offset||0),p.stride=0|(h.stride||0),p.divisor=0|(h.divisor||0),p.state=1):"x"in h&&(p.x=+h.x||0,p.y=+h.y||0,p.z=+h.z||0,p.w=+h.w||0,p.state=2)}for(f=0;f<i.buffers.length;++f)!r[f]&&i.buffers[f]&&(i.buffers[f].destroy(),i.buffers[f]=null);return i.refresh(),n}var i=new u;return a.vaoCount+=1,n.destroy=function(){for(var r=0;r<i.buffers.length;++r)i.buffers[r]&&i.buffers[r].destroy();i.buffers.length=0,i.ownsElements&&(i.elements.destroy(),i.elements=null,i.ownsElements=!1),i.destroy()},n._vao=i,n._reglType="vao",n(r)},getVAO:function(r){return"function"==typeof r&&r._vao?r._vao:null},destroyBuffer:function(n){for(var i=0;i<h.length;++i){var a=h[i];a.buffer===n&&(r.disableVertexAttribArray(i),a.buffer=null)}},setVAO:n.oes_vertex_array_object?function(r){if(r!==m.currentVAO){var i=n.oes_vertex_array_object;r?i.bindVertexArrayOES(r.vao):i.bindVertexArrayOES(null),m.currentVAO=r}}:function(i){if(i!==m.currentVAO){if(i)i.bindAttrs();else{for(var a=n.angle_instanced_arrays,o=0;o<h.length;++o){var s=h[o];s.buffer?(r.enableVertexAttribArray(o),s.buffer.bind(),r.vertexAttribPointer(o,s.size,s.type,s.normalized,s.stride,s.offfset),a&&s.divisor&&a.vertexAttribDivisorANGLE(o,s.divisor)):(r.disableVertexAttribArray(o),r.vertexAttrib4f(o,s.x,s.y,s.z,s.w))}l.elements?r.bindBuffer(34963,l.elements.buffer.buffer):r.bindBuffer(34963,null)}m.currentVAO=i}},clear:n.oes_vertex_array_object?function(){U(d).forEach(function(r){r.destroy()})}:function(){}};return u.prototype.bindAttrs=function(){for(var i=n.angle_instanced_arrays,a=this.attributes,o=0;o<a.length;++o){var l=a[o];l.buffer?(r.enableVertexAttribArray(o),r.bindBuffer(34962,l.buffer.buffer),r.vertexAttribPointer(o,l.size,l.type,l.normalized,l.stride,l.offset),i&&l.divisor&&i.vertexAttribDivisorANGLE(o,l.divisor)):(r.disableVertexAttribArray(o),r.vertexAttrib4f(o,l.x,l.y,l.z,l.w))}for(i=a.length;i<f;++i)r.disableVertexAttribArray(i);(i=s.getElements(this.elements))?r.bindBuffer(34963,i.buffer.buffer):r.bindBuffer(34963,null)},u.prototype.refresh=function(){var r=n.oes_vertex_array_object;r&&(r.bindVertexArrayOES(this.vao),this.bindAttrs(),m.currentVAO=null,r.bindVertexArrayOES(null))},u.prototype.destroy=function(){if(this.vao){var r=n.oes_vertex_array_object;this===m.currentVAO&&(m.currentVAO=null,r.bindVertexArrayOES(null)),r.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),d[this.id]&&(delete d[this.id],--a.vaoCount)},m}(tT,tE,tz,tS,tD,tR,tP),tB=function(r,n,i,a){function o(r,n,i,a){this.name=r,this.id=n,this.location=i,this.info=a}function s(r,n){for(var i=0;i<r.length;++i)if(r[i].id===n.id)return void(r[i].location=n.location);r.push(n)}function l(i,a,o){if(!(l=(o=35632===i?f:h)[a])){var s=n.str(a),l=r.createShader(i);r.shaderSource(l,s),r.compileShader(l),o[a]=l}return l}function c(r,n){this.id=m++,this.fragId=r,this.vertId=n,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,a.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function u(i,c,u){f=l(35632,i.fragId);var f,h=l(35633,i.vertId);if(c=i.program=r.createProgram(),r.attachShader(c,f),r.attachShader(c,h),u)for(f=0;f<u.length;++f)h=u[f],r.bindAttribLocation(c,h[0],h[1]);r.linkProgram(c),h=r.getProgramParameter(c,35718),a.profile&&(i.stats.uniformsCount=h);var p=i.uniforms;for(f=0;f<h;++f)if(u=r.getActiveUniform(c,f)){if(1<u.size)for(var d=0;d<u.size;++d){var m=u.name.replace("[0]","["+d+"]");s(p,new o(m,n.id(m),r.getUniformLocation(c,m),u))}d=u.name,1<u.size&&(d=d.replace("[0]","")),s(p,new o(d,n.id(d),r.getUniformLocation(c,d),u))}for(h=r.getProgramParameter(c,35721),a.profile&&(i.stats.attributesCount=h),i=i.attributes,f=0;f<h;++f)(u=r.getActiveAttrib(c,f))&&s(i,new o(u.name,n.id(u.name),r.getAttribLocation(c,u.name),u))}var f={},h={},p={},d=[],m=0;return a.profile&&(i.getMaxUniformsCount=function(){var r=0;return d.forEach(function(n){n.stats.uniformsCount>r&&(r=n.stats.uniformsCount)}),r},i.getMaxAttributesCount=function(){var r=0;return d.forEach(function(n){n.stats.attributesCount>r&&(r=n.stats.attributesCount)}),r}),{clear:function(){var n=r.deleteShader.bind(r);U(f).forEach(n),f={},U(h).forEach(n),h={},d.forEach(function(n){r.deleteProgram(n.program)}),d.length=0,p={},i.shaderCount=0},program:function(n,a,o,s){var l=p[a];l||(l=p[a]={});var m=l[n];if(m&&(m.refCount++,!s))return m;var g=new c(a,n);return i.shaderCount++,u(g,o,s),m||(l[n]=g),d.push(g),O(g,{destroy:function(){if(g.refCount--,0>=g.refCount){r.deleteProgram(g.program);var n=d.indexOf(g);d.splice(n,1),i.shaderCount--}0>=l[g.vertId].refCount&&(r.deleteShader(h[g.vertId]),delete h[g.vertId],delete p[g.fragId][g.vertId]),Object.keys(p[g.fragId]).length||(r.deleteShader(f[g.fragId]),delete f[g.fragId],delete p[g.fragId])}})},restore:function(){f={},h={};for(var r=0;r<d.length;++r)u(d[r],null,d[r].attributes.map(function(r){return[r.location,r.name]}))},shader:l,frag:-1,vert:-1}}(tT,tM,tS,r),tN=function(r,n,i,a,o,s,l){function u(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function f(r,n){r.internalformat=n.internalformat,r.format=n.format,r.type=n.type,r.compressed=n.compressed,r.premultiplyAlpha=n.premultiplyAlpha,r.flipY=n.flipY,r.unpackAlignment=n.unpackAlignment,r.colorSpace=n.colorSpace,r.width=n.width,r.height=n.height,r.channels=n.channels}function h(r,n){if("object"==typeof n&&n){"premultiplyAlpha"in n&&(r.premultiplyAlpha=n.premultiplyAlpha),"flipY"in n&&(r.flipY=n.flipY),"alignment"in n&&(r.unpackAlignment=n.alignment),"colorSpace"in n&&(r.colorSpace=J[n.colorSpace]),"type"in n&&(r.type=K[n.type]);var i=r.width,a=r.height,o=r.channels,s=!1;"shape"in n?(i=n.shape[0],a=n.shape[1],3===n.shape.length&&(o=n.shape[2],s=!0)):("radius"in n&&(i=a=n.radius),"width"in n&&(i=n.width),"height"in n&&(a=n.height),"channels"in n&&(o=n.channels,s=!0)),r.width=0|i,r.height=0|a,r.channels=0|o,i=!1,"format"in n&&(i=n.format,a=r.internalformat=ts[i],r.format=tg[a],i in K&&!("type"in n)&&(r.type=K[i]),i in tl&&(r.compressed=!0),i=!0),!s&&i?r.channels=tt[r.format]:s&&!i&&r.channels!==$[r.format]&&(r.format=r.internalformat=$[r.channels])}}function p(n){r.pixelStorei(37440,n.flipY),r.pixelStorei(37441,n.premultiplyAlpha),r.pixelStorei(37443,n.colorSpace),r.pixelStorei(3317,n.unpackAlignment)}function g(){u.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function T(r,n){var i=null;if(b(n)?i=n:n&&(h(r,n),"x"in n&&(r.xOffset=0|n.x),"y"in n&&(r.yOffset=0|n.y),b(n.data)&&(i=n.data)),n.copy){var a=o.viewportWidth,s=o.viewportHeight;r.width=r.width||a-r.xOffset,r.height=r.height||s-r.yOffset,r.needsCopy=!0}else if(i){if(j(i))r.channels=r.channels||4,r.data=i,"type"in n||5121!==r.type||(r.type=0|H[Object.prototype.toString.call(i)]);else if(v(i)){switch(r.channels=r.channels||4,s=(a=i).length,r.type){case 5121:case 5123:case 5125:case 5126:(s=B.allocType(r.type,s)).set(a),r.data=s;break;case 36193:r.data=d(a)}r.alignment=1,r.needsFree=!0}else if(c(i)){Array.isArray(a=i.data)||5121!==r.type||(r.type=0|H[Object.prototype.toString.call(a)]),s=i.shape;var l,u,f,p,g=i.stride;3===s.length?(f=s[2],p=g[2]):p=f=1,l=s[0],u=s[1],s=g[0],g=g[1],r.alignment=1,r.width=l,r.height=u,r.channels=f,r.format=r.internalformat=$[f],r.needsFree=!0,l=p,i=i.offset,f=r.width,p=r.height,u=r.channels;for(var w=B.allocType(36193===r.type?5126:r.type,f*p*u),T=0,k=0;k<p;++k)for(var A=0;A<f;++A)for(var M=0;M<u;++M)w[T++]=a[s*A+g*k+l*M+i];_(r,w)}else if(x(i)===te||x(i)===tr||x(i)===tn)x(i)===te||x(i)===tr?r.element=i:r.element=i.canvas,r.width=r.element.width,r.height=r.element.height,r.channels=4;else if(x(i)===ti)r.element=i,r.width=i.width,r.height=i.height,r.channels=4;else if(x(i)===ta)r.element=i,r.width=i.naturalWidth,r.height=i.naturalHeight,r.channels=4;else if(x(i)===to)r.element=i,r.width=i.videoWidth,r.height=i.videoHeight,r.channels=4;else if(y(i)){for(a=r.width||i[0].length,s=r.height||i.length,g=r.channels,g=m(i[0][0])?g||i[0][0].length:g||1,l=V.shape(i),f=1,p=0;p<l.length;++p)f*=l[p];f=B.allocType(36193===r.type?5126:r.type,f),V.flatten(i,l,"",f),_(r,f),r.alignment=1,r.width=a,r.height=s,r.channels=g,r.format=r.internalformat=$[g],r.needsFree=!0}}else r.width=r.width||1,r.height=r.height||1,r.channels=r.channels||4}function k(n,i,o,s,l){var c=n.element,u=n.data,f=n.internalformat,h=n.format,d=n.type,m=n.width,g=n.height;p(n),c?r.texSubImage2D(i,l,o,s,h,d,c):n.compressed?r.compressedTexSubImage2D(i,l,o,s,f,m,g,u):n.needsCopy?(a(),r.copyTexSubImage2D(i,l,o,s,n.xOffset,n.yOffset,m,g)):r.texSubImage2D(i,l,o,s,m,g,h,d,u)}function A(){return tv.pop()||new g}function M(r){r.needsFree&&B.freeType(r.data),g.call(r),tv.push(r)}function S(){u.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function E(r,n,i){var a=r.images[0]=A();r.mipmask=1,a.width=r.width=n,a.height=r.height=i,a.channels=r.channels=4}function L(r,n){var i=null;if(b(n))f(i=r.images[0]=A(),r),T(i,n),r.mipmask=1;else if(h(r,n),Array.isArray(n.mipmap))for(var a=n.mipmap,o=0;o<a.length;++o)f(i=r.images[o]=A(),r),i.width>>=o,i.height>>=o,T(i,a[o]),r.mipmask|=1<<o;else f(i=r.images[0]=A(),r),T(i,n),r.mipmask=1;f(r,r.images[0])}function C(n,i){for(var o=n.images,s=0;s<o.length&&o[s];++s){var l=o[s],c=s,u=l.element,f=l.data,h=l.internalformat,d=l.format,m=l.type,g=l.width,v=l.height;p(l),u?r.texImage2D(i,c,d,d,m,u):l.compressed?r.compressedTexImage2D(i,c,h,g,v,0,f):l.needsCopy?(a(),r.copyTexImage2D(i,c,d,l.xOffset,l.yOffset,g,v,0)):r.texImage2D(i,c,d,g,v,0,d,m,f||null)}}function P(){var r=ty.pop()||new S;u.call(r);for(var n=r.mipmask=0;16>n;++n)r.images[n]=null;return r}function I(r){for(var n=r.images,i=0;i<n.length;++i)n[i]&&M(n[i]),n[i]=null;ty.push(r)}function z(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function D(r,n){"min"in n&&(r.minFilter=Z[n.min],!(0<=Q.indexOf(r.minFilter))||"faces"in n||(r.genMipmaps=!0)),"mag"in n&&(r.magFilter=X[n.mag]);var i=r.wrapS,a=r.wrapT;if("wrap"in n){var o=n.wrap;"string"==typeof o?i=a=W[o]:Array.isArray(o)&&(i=W[o[0]],a=W[o[1]])}else"wrapS"in n&&(i=W[n.wrapS]),"wrapT"in n&&(a=W[n.wrapT]);if(r.wrapS=i,r.wrapT=a,"anisotropic"in n&&(r.anisotropic=n.anisotropic),"mipmap"in n){switch(i=!1,typeof n.mipmap){case"string":r.mipmapHint=Y[n.mipmap],i=r.genMipmaps=!0;break;case"boolean":i=r.genMipmaps=n.mipmap;break;case"object":r.genMipmaps=!1,i=!0}!i||"min"in n||(r.minFilter=9984)}}function R(i,a){r.texParameteri(a,10241,i.minFilter),r.texParameteri(a,10240,i.magFilter),r.texParameteri(a,10242,i.wrapS),r.texParameteri(a,10243,i.wrapT),n.ext_texture_filter_anisotropic&&r.texParameteri(a,34046,i.anisotropic),i.genMipmaps&&(r.hint(33170,i.mipmapHint),r.generateMipmap(a))}function F(n){u.call(this),this.mipmask=0,this.internalformat=6408,this.id=tx++,this.refCount=1,this.target=n,this.texture=r.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new z,l.profile&&(this.stats={size:0})}function N(n){r.activeTexture(33984),r.bindTexture(n.target,n.texture)}function q(){var n=tw[0];n?r.bindTexture(n.target,n.texture):r.bindTexture(3553,null)}function G(n){var i=n.texture,a=n.unit,o=n.target;0<=a&&(r.activeTexture(33984+a),r.bindTexture(o,null),tw[a]=null),r.deleteTexture(i),n.texture=null,n.params=null,n.pixels=null,n.refCount=0,delete tb[n.id],s.textureCount--}var Y={"don't care":4352,"dont care":4352,nice:4354,fast:4353},W={repeat:10497,clamp:33071,mirror:33648},X={nearest:9728,linear:9729},Z=O({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},X),J={none:0,browser:37444},K={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},ts={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},tl={};n.ext_srgb&&(ts.srgb=35904,ts.srgba=35906),n.oes_texture_float&&(K.float32=K.float=5126),n.oes_texture_half_float&&(K.float16=K["half float"]=36193),n.webgl_depth_texture&&(O(ts,{depth:6402,"depth stencil":34041}),O(K,{uint16:5123,uint32:5125,"depth stencil":34042})),n.webgl_compressed_texture_s3tc&&O(tl,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),n.webgl_compressed_texture_atc&&O(tl,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),n.webgl_compressed_texture_pvrtc&&O(tl,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),n.webgl_compressed_texture_etc1&&(tl["rgb etc1"]=36196);var tc=Array.prototype.slice.call(r.getParameter(34467));Object.keys(tl).forEach(function(r){var n=tl[r];0<=tc.indexOf(n)&&(ts[r]=n)});var tu=Object.keys(ts);i.textureFormats=tu;var tf=[];Object.keys(ts).forEach(function(r){tf[ts[r]]=r});var th=[];Object.keys(K).forEach(function(r){th[K[r]]=r});var tp=[];Object.keys(X).forEach(function(r){tp[X[r]]=r});var td=[];Object.keys(Z).forEach(function(r){td[Z[r]]=r});var tm=[];Object.keys(W).forEach(function(r){tm[W[r]]=r});var tg=tu.reduce(function(r,i){var a=ts[i];return 6409===a||6406===a||6409===a||6410===a||6402===a||34041===a||n.ext_srgb&&(35904===a||35906===a)?r[a]=a:32855===a||0<=i.indexOf("rgba")?r[a]=6408:r[a]=6407,r},{}),tv=[],ty=[],tx=0,tb={},t_=i.maxTextureUnits,tw=Array(t_).map(function(){return null});return O(F.prototype,{bind:function(){this.bindCount+=1;var n=this.unit;if(0>n){for(var i=0;i<t_;++i){var a=tw[i];if(a){if(0<a.bindCount)continue;a.unit=-1}tw[i]=this,n=i;break}l.profile&&s.maxTextureUnits<n+1&&(s.maxTextureUnits=n+1),this.unit=n,r.activeTexture(33984+n),r.bindTexture(this.target,this.texture)}return n},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&G(this)}}),l.profile&&(s.getTotalTextureSize=function(){var r=0;return Object.keys(tb).forEach(function(n){r+=tb[n].stats.size}),r}),{create2D:function(n,i){function a(r,n){var i=o.texInfo;z.call(i);var s=P();return"number"==typeof r?E(s,0|r,"number"==typeof n?0|n:0|r):r?(D(i,r),L(s,r)):E(s,1,1),i.genMipmaps&&(s.mipmask=(s.width<<1)-1),o.mipmask=s.mipmask,f(o,s),o.internalformat=s.internalformat,a.width=s.width,a.height=s.height,N(o),C(s,3553),R(i,3553),q(),I(s),l.profile&&(o.stats.size=w(o.internalformat,o.type,s.width,s.height,i.genMipmaps,!1)),a.format=tf[o.internalformat],a.type=th[o.type],a.mag=tp[i.magFilter],a.min=td[i.minFilter],a.wrapS=tm[i.wrapS],a.wrapT=tm[i.wrapT],a}var o=new F(3553);return tb[o.id]=o,s.textureCount++,a(n,i),a.subimage=function(r,n,i,s){n|=0,i|=0,s|=0;var l=A();return f(l,o),l.width=0,l.height=0,T(l,r),l.width=l.width||(o.width>>s)-n,l.height=l.height||(o.height>>s)-i,N(o),k(l,3553,n,i,s),q(),M(l),a},a.resize=function(n,i){var s=0|n,c=0|i||s;if(s===o.width&&c===o.height)return a;a.width=o.width=s,a.height=o.height=c,N(o);for(var u=0;o.mipmask>>u;++u){var f=s>>u,h=c>>u;if(!f||!h)break;r.texImage2D(3553,u,o.format,f,h,0,o.format,o.type,null)}return q(),l.profile&&(o.stats.size=w(o.internalformat,o.type,s,c,!1,!1)),a},a._reglType="texture2d",a._texture=o,l.profile&&(a.stats=o.stats),a.destroy=function(){o.decRef()},a},createCube:function(n,i,a,o,c,u){function p(r,n,i,a,o,s){var c,u=d.texInfo;for(z.call(u),c=0;6>c;++c)m[c]=P();if("number"!=typeof r&&r){if("object"==typeof r){if(n)L(m[0],r),L(m[1],n),L(m[2],i),L(m[3],a),L(m[4],o),L(m[5],s);else if(D(u,r),h(d,r),"faces"in r)for(r=r.faces,c=0;6>c;++c)f(m[c],d),L(m[c],r[c]);else for(c=0;6>c;++c)L(m[c],r)}}else for(r=0|r||1,c=0;6>c;++c)E(m[c],r,r);for(f(d,m[0]),d.mipmask=u.genMipmaps?(m[0].width<<1)-1:m[0].mipmask,d.internalformat=m[0].internalformat,p.width=m[0].width,p.height=m[0].height,N(d),c=0;6>c;++c)C(m[c],34069+c);for(R(u,34067),q(),l.profile&&(d.stats.size=w(d.internalformat,d.type,p.width,p.height,u.genMipmaps,!0)),p.format=tf[d.internalformat],p.type=th[d.type],p.mag=tp[u.magFilter],p.min=td[u.minFilter],p.wrapS=tm[u.wrapS],p.wrapT=tm[u.wrapT],c=0;6>c;++c)I(m[c]);return p}var d=new F(34067);tb[d.id]=d,s.cubeCount++;var m=Array(6);return p(n,i,a,o,c,u),p.subimage=function(r,n,i,a,o){i|=0,a|=0,o|=0;var s=A();return f(s,d),s.width=0,s.height=0,T(s,n),s.width=s.width||(d.width>>o)-i,s.height=s.height||(d.height>>o)-a,N(d),k(s,34069+r,i,a,o),q(),M(s),p},p.resize=function(n){if((n|=0)!==d.width){p.width=d.width=n,p.height=d.height=n,N(d);for(var i=0;6>i;++i)for(var a=0;d.mipmask>>a;++a)r.texImage2D(34069+i,a,d.format,n>>a,n>>a,0,d.format,d.type,null);return q(),l.profile&&(d.stats.size=w(d.internalformat,d.type,p.width,p.height,!1,!0)),p}},p._reglType="textureCube",p._texture=d,l.profile&&(p.stats=d.stats),p.destroy=function(){d.decRef()},p},clear:function(){for(var n=0;n<t_;++n)r.activeTexture(33984+n),r.bindTexture(3553,null),tw[n]=null;U(tb).forEach(G),s.cubeCount=0,s.textureCount=0},getTexture:function(r){return null},restore:function(){for(var n=0;n<t_;++n){var i=tw[n];i&&(i.bindCount=0,i.unit=-1,tw[n]=null)}U(tb).forEach(function(n){n.texture=r.createTexture(),r.bindTexture(n.target,n.texture);for(var i=0;32>i;++i)if(0!=(n.mipmask&1<<i)){if(3553===n.target)r.texImage2D(3553,i,n.internalformat,n.width>>i,n.height>>i,0,n.internalformat,n.type,null);else for(var a=0;6>a;++a)r.texImage2D(34069+a,i,n.internalformat,n.width>>i,n.height>>i,0,n.internalformat,n.type,null)}R(n.texInfo,n.target)})},refresh:function(){for(var n=0;n<t_;++n){var i=tw[n];i&&(i.bindCount=0,i.unit=-1,tw[n]=null),r.activeTexture(33984+n),r.bindTexture(3553,null),r.bindTexture(34067,null)}}}}(tT,tE,tz,function(){tV.procs.poll()},tO,tS,r),tj=tf(tT,tE,0,tS,r),tU=function(r,n,i,a,o,s){function l(r,n,i){this.target=r,this.texture=n,this.renderbuffer=i;var a=r=0;n?(r=n.width,a=n.height):i&&(r=i.width,a=i.height),this.width=r,this.height=a}function c(r){r&&(r.texture&&r.texture._texture.decRef(),r.renderbuffer&&r.renderbuffer._renderbuffer.decRef())}function u(r,n,i){r&&(r.texture?r.texture._texture.refCount+=1:r.renderbuffer._renderbuffer.refCount+=1)}function f(n,i){i&&(i.texture?r.framebufferTexture2D(36160,n,i.target,i.texture._texture.texture,0):r.framebufferRenderbuffer(36160,n,36161,i.renderbuffer._renderbuffer.renderbuffer))}function h(r){var n=3553,i=null,a=null,o=r;return"object"==typeof r&&(o=r.data,"target"in r&&(n=0|r.target)),"texture2d"===(r=o._reglType)||"textureCube"===r?i=o:"renderbuffer"===r&&(a=o,n=36161),new l(n,i,a)}function p(r,n,i,s,c){return i?((r=a.create2D({width:r,height:n,format:s,type:c}))._texture.refCount=0,new l(3553,r,null)):((r=o.create({width:r,height:n,format:s}))._renderbuffer.refCount=0,new l(36161,null,r))}function d(r){return r&&(r.texture||r.renderbuffer)}function m(r,n,i){r&&(r.texture?r.texture.resize(n,i):r.renderbuffer&&r.renderbuffer.resize(n,i),r.width=n,r.height=i)}function g(){this.id=A++,M[this.id]=this,this.framebuffer=r.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function v(r){r.colorAttachments.forEach(c),c(r.depthAttachment),c(r.stencilAttachment),c(r.depthStencilAttachment)}function y(n){r.deleteFramebuffer(n.framebuffer),n.framebuffer=null,s.framebufferCount--,delete M[n.id]}function x(n){r.bindFramebuffer(36160,n.framebuffer);var a,o=n.colorAttachments;for(a=0;a<o.length;++a)f(36064+a,o[a]);for(a=o.length;a<i.maxColorAttachments;++a)r.framebufferTexture2D(36160,36064+a,3553,null,0);r.framebufferTexture2D(36160,33306,3553,null,0),r.framebufferTexture2D(36160,36096,3553,null,0),r.framebufferTexture2D(36160,36128,3553,null,0),f(36096,n.depthAttachment),f(36128,n.stencilAttachment),f(33306,n.depthStencilAttachment),r.checkFramebufferStatus(36160),r.isContextLost(),r.bindFramebuffer(36160,_.next?_.next.framebuffer:null),_.cur=_.next,r.getError()}function b(r,n){function i(r,n){var o,s=0,l=0,c=!0,f=!0;o=null;var m=!0,g="rgba",y="uint8",b=1,_=null,k=null,A=null,M=!1;"number"==typeof r?(s=0|r,l=0|n||s):r?("shape"in r?(s=(l=r.shape)[0],l=l[1]):("radius"in r&&(s=l=r.radius),"width"in r&&(s=r.width),"height"in r&&(l=r.height)),("color"in r||"colors"in r)&&Array.isArray(o=r.color||r.colors),o||("colorCount"in r&&(b=0|r.colorCount),"colorTexture"in r&&(m=!!r.colorTexture,g="rgba4"),"colorType"in r&&(y=r.colorType,!m)&&("half float"===y||"float16"===y?g="rgba16f":"float"!==y&&"float32"!==y||(g="rgba32f")),"colorFormat"in r&&(0<=w.indexOf(g=r.colorFormat)?m=!0:0<=T.indexOf(g)&&(m=!1))),("depthTexture"in r||"depthStencilTexture"in r)&&(M=!(!r.depthTexture&&!r.depthStencilTexture)),"depth"in r&&("boolean"==typeof r.depth?c=r.depth:(_=r.depth,f=!1)),"stencil"in r&&("boolean"==typeof r.stencil?f=r.stencil:(k=r.stencil,c=!1)),"depthStencil"in r&&("boolean"==typeof r.depthStencil?c=f=r.depthStencil:(A=r.depthStencil,f=c=!1))):s=l=1;var S=null,E=null,L=null,C=null;if(Array.isArray(o))S=o.map(h);else if(o)S=[h(o)];else for(S=Array(b),o=0;o<b;++o)S[o]=p(s,l,m,g,y);for(s=s||S[0].width,l=l||S[0].height,_?E=h(_):c&&!f&&(E=p(s,l,M,"depth","uint32")),k?L=h(k):f&&!c&&(L=p(s,l,!1,"stencil","uint8")),A?C=h(A):!_&&!k&&f&&c&&(C=p(s,l,M,"depth stencil","depth stencil")),c=null,o=0;o<S.length;++o)u(S[o]),S[o]&&S[o].texture&&(f=th[S[o].texture._texture.format]*tp[S[o].texture._texture.type],null===c&&(c=f));return u(E),u(L),u(C),v(a),a.width=s,a.height=l,a.colorAttachments=S,a.depthAttachment=E,a.stencilAttachment=L,a.depthStencilAttachment=C,i.color=S.map(d),i.depth=d(E),i.stencil=d(L),i.depthStencil=d(C),i.width=a.width,i.height=a.height,x(a),i}var a=new g;return s.framebufferCount++,i(r,n),O(i,{resize:function(r,n){var o=Math.max(0|r,1),s=Math.max(0|n||o,1);if(o===a.width&&s===a.height)return i;for(var l=a.colorAttachments,c=0;c<l.length;++c)m(l[c],o,s);return m(a.depthAttachment,o,s),m(a.stencilAttachment,o,s),m(a.depthStencilAttachment,o,s),a.width=i.width=o,a.height=i.height=s,x(a),i},_reglType:"framebuffer",_framebuffer:a,destroy:function(){y(a),v(a)},use:function(r){_.setFBO({framebuffer:i},r)}})}var _={cur:null,next:null,dirty:!1,setFBO:null},w=["rgba"],T=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&T.push("srgba"),n.ext_color_buffer_half_float&&T.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&T.push("rgba32f");var k=["uint8"];n.oes_texture_half_float&&k.push("half float","float16"),n.oes_texture_float&&k.push("float","float32");var A=0,M={};return O(_,{getFramebuffer:function(r){return"function"==typeof r&&"framebuffer"===r._reglType&&(r=r._framebuffer)instanceof g?r:null},create:b,createCube:function(r){function n(r){var o,s={color:null},l=0,c=null;o="rgba";var u="uint8",f=1;if("number"==typeof r?l=0|r:r?("shape"in r?l=r.shape[0]:("radius"in r&&(l=0|r.radius),"width"in r?l=0|r.width:"height"in r&&(l=0|r.height)),("color"in r||"colors"in r)&&Array.isArray(c=r.color||r.colors),c||("colorCount"in r&&(f=0|r.colorCount),"colorType"in r&&(u=r.colorType),"colorFormat"in r&&(o=r.colorFormat)),"depth"in r&&(s.depth=r.depth),"stencil"in r&&(s.stencil=r.stencil),"depthStencil"in r&&(s.depthStencil=r.depthStencil)):l=1,c){if(Array.isArray(c))for(r=[],o=0;o<c.length;++o)r[o]=c[o];else r=[c]}else for(r=Array(f),c={radius:l,format:o,type:u},o=0;o<f;++o)r[o]=a.createCube(c);for(s.color=Array(r.length),o=0;o<r.length;++o)f=r[o],l=l||f.width,s.color[o]={target:34069,data:r[o]};for(o=0;6>o;++o){for(f=0;f<r.length;++f)s.color[f].target=34069+o;0<o&&(s.depth=i[0].depth,s.stencil=i[0].stencil,s.depthStencil=i[0].depthStencil),i[o]?i[o](s):i[o]=b(s)}return O(n,{width:l,height:l,color:r})}var i=Array(6);return n(r),O(n,{faces:i,resize:function(r){var a=0|r;if(a===n.width)return n;var o=n.color;for(r=0;r<o.length;++r)o[r].resize(a);for(r=0;6>r;++r)i[r].resize(a);return n.width=n.height=a,n},_reglType:"framebufferCube",destroy:function(){i.forEach(function(r){r.destroy()})}})},clear:function(){U(M).forEach(y)},restore:function(){_.cur=null,_.next=null,_.dirty=!0,U(M).forEach(function(n){n.framebuffer=r.createFramebuffer(),x(n)})}})}(tT,tE,tz,tN,tj,tS),tV=function(r,n,i,a,s,l,c,u,f,h,p,d,g,v,y){function x(r){return r.replace(".","_")}function b(r,n,i){var a=x(r);tr.push(r),te[a]=tt[a]=!!i,tn[a]=n}function _(r,n,i){var a=x(r);tr.push(r),Array.isArray(i)?(tt[a]=i.slice(),te[a]=i.slice()):tt[a]=te[a]=i,ti[a]=n}function w(){var r=function(){function r(){var r=[],n=[];return O(function(){r.push.apply(r,k(arguments))},{def:function(){var a="v"+i++;return n.push(a),0<arguments.length&&(r.push(a,"="),r.push.apply(r,k(arguments)),r.push(";")),a},toString:function(){return A([0<n.length?"var "+n.join(",")+";":"",A(r)])}})}function n(){function n(r,n){a(r,n,"=",i.def(r,n),";")}var i=r(),a=r(),o=i.toString,s=a.toString;return O(function(){i.apply(i,k(arguments))},{def:i.def,entry:i,exit:a,save:n,set:function(r,a,o){n(r,a),i(r,a,"=",o,";")},toString:function(){return o()+s()}})}var i=0,a=[],o=[],s=r(),l={};return{global:s,link:function(r){for(var n=0;n<o.length;++n)if(o[n]===r)return a[n];return n="g"+i++,a.push(n),o.push(r),n},block:r,proc:function(r,i){function a(){var r="a"+o.length;return o.push(r),r}var o=[];i=i||0;for(var s=0;s<i;++s)a();var c=(s=n()).toString;return l[r]=O(s,{arg:a,toString:function(){return A(["function(",o.join(),"){",c(),"}"])}})},scope:n,cond:function(){var r=A(arguments),i=n(),a=n(),o=i.toString,s=a.toString;return O(i,{then:function(){return i.apply(i,k(arguments)),this},else:function(){return a.apply(a,k(arguments)),this},toString:function(){var n=s();return n&&(n="else{"+n+"}"),A(["if(",r,"){",o(),"}",n])}})},compile:function(){var r=['"use strict";',s,"return {"];Object.keys(l).forEach(function(n){r.push('"',n,'":',l[n].toString(),",")}),r.push("}");var n=A(r).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,a.concat(n)).apply(null,o)}}}(),i=r.link,a=r.global;r.id=ts++,r.batchId="0";var o=i(ta),s=r.shared={props:"a0"};Object.keys(ta).forEach(function(r){s[r]=a.def(o,".",r)});var l=r.next={},c=r.current={};Object.keys(ti).forEach(function(r){Array.isArray(tt[r])&&(l[r]=a.def(s.next,".",r),c[r]=a.def(s.current,".",r))});var u=r.constants={};Object.keys(to).forEach(function(r){u[r]=a.def(JSON.stringify(to[r]))}),r.invoke=function(n,a){switch(a.type){case 0:var o=["this",s.context,s.props,r.batchId];return n.def(i(a.data),".call(",o.slice(0,Math.max(a.data.length+1,4)),")");case 1:return n.def(s.props,a.data);case 2:return n.def(s.context,a.data);case 3:return n.def("this",a.data);case 4:return a.data.append(r,n),a.data.ref;case 5:return a.data.toString();case 6:return a.data.map(function(i){return r.invoke(n,i)})}},r.attribCache={};var f={};return r.scopeAttrib=function(r){if((r=n.id(r))in f)return f[r];var a=h.scope[r];return a||(a=h.scope[r]=new X),f[r]=i(a)},r}function T(r,n,i){var a=r.shared.context,o=r.scope();Object.keys(i).forEach(function(s){n.save(a,"."+s);var l=i[s].append(r,n);Array.isArray(l)?o(a,".",s,"=[",l.join(),"];"):o(a,".",s,"=",l,";")}),n(o)}function I(r,n,i,a){var o,s=(c=r.shared).gl,l=c.framebuffer;Q&&(o=n.def(c.extensions,".webgl_draw_buffers"));var c=(u=r.constants).drawBuffer,u=u.backBuffer;r=i?i.append(r,n):n.def(l,".next"),a||n("if(",r,"!==",l,".cur){"),n("if(",r,"){",s,".bindFramebuffer(",36160,",",r,".framebuffer);"),Q&&n(o,".drawBuffersWEBGL(",c,"[",r,".colorAttachments.length]);"),n("}else{",s,".bindFramebuffer(",36160,",null);"),Q&&n(o,".drawBuffersWEBGL(",u,");"),n("}",l,".cur=",r,";"),a||n("}")}function z(r,n,i){var a=r.shared,s=a.gl,l=r.current,c=r.next,u=a.current,f=a.next,h=r.cond(u,".dirty");tr.forEach(function(n){var a,p;if(!((n=x(n))in i.state)){if(n in c){a=c[n],p=l[n];var d=o(tt[n].length,function(r){return h.def(a,"[",r,"]")});h(r.cond(d.map(function(r,n){return r+"!=="+p+"["+n+"]"}).join("||")).then(s,".",ti[n],"(",d,");",d.map(function(r,n){return p+"["+n+"]="+r}).join(";"),";"))}else a=h.def(f,".",n),h(d=r.cond(a,"!==",u,".",n)),n in tn?d(r.cond(a).then(s,".enable(",tn[n],");").else(s,".disable(",tn[n],");"),u,".",n,"=",a,";"):d(s,".",ti[n],"(",a,");",u,".",n,"=",a,";")}}),0===Object.keys(i.state).length&&h(u,".dirty=false;"),n(h)}function R(r,n,i,a){var o=r.shared,s=r.current,l=o.current,c=o.gl;S(Object.keys(i)).forEach(function(o){var u=i[o];if(!a||a(u)){var f=u.append(r,n);if(tn[o]){var h=tn[o];L(u)?n(c,f?".enable(":".disable(",h,");"):n(r.cond(f).then(c,".enable(",h,");").else(c,".disable(",h,");")),n(l,".",o,"=",f,";")}else if(m(f)){var p=s[o];n(c,".",ti[o],"(",f,");",f.map(function(r,n){return p+"["+n+"]="+r}).join(";"),";")}else n(c,".",ti[o],"(",f,");",l,".",o,"=",f,";")}})}function F(r,n){K&&(r.instancing=n.def(r.shared.extensions,".angle_instanced_arrays"))}function B(r,n,i,a,o){function s(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function l(r){r(f=n.def(),"=",s(),";"),"string"==typeof o?r(d,".count+=",o,";"):r(d,".count++;"),v&&(a?r(h=n.def(),"=",g,".getNumPendingQueries();"):r(g,".beginQuery(",d,");"))}function c(r){r(d,".cpuTime+=",s(),"-",f,";"),v&&(a?r(g,".pushScopeStats(",h,",",g,".getNumPendingQueries(),",d,");"):r(g,".endQuery();"))}function u(r){var i=n.def(m,".profile");n(m,".profile=",r,";"),n.exit(m,".profile=",i,";")}var f,h,p=r.shared,d=r.stats,m=p.current,g=p.timer;if(i=i.profile){if(L(i))return void(i.enable?(l(n),c(n.exit),u("true")):u("false"));u(i=i.append(r,n))}else i=n.def(m,".profile");l(p=r.block()),n("if(",i,"){",p,"}"),c(r=r.block()),n.exit("if(",i,"){",r,"}")}function N(r,n,i,a,o){var s=r.shared;a.forEach(function(a){var l,c=a.name,u=i.attributes[c];if(u){if(!o(u))return;l=u.append(r,n)}else{if(!o(tb))return;var f=r.scopeAttrib(c);l={},Object.keys(new X).forEach(function(r){l[r]=n.def(f,".",r)})}!function(i,a,o){function l(){n("if(!",h,".buffer){",u,".enableVertexAttribArray(",f,");}");var i,s=o.type;i=o.size?n.def(o.size,"||",a):a,n("if(",h,".type!==",s,"||",h,".size!==",i,"||",m.map(function(r){return h+"."+r+"!=="+o[r]}).join("||"),"){",u,".bindBuffer(",34962,",",p,".buffer);",u,".vertexAttribPointer(",[f,i,s,o.normalized,o.stride,o.offset],");",h,".type=",s,";",h,".size=",i,";",m.map(function(r){return h+"."+r+"="+o[r]+";"}).join(""),"}"),K&&n("if(",h,".divisor!==",s=o.divisor,"){",r.instancing,".vertexAttribDivisorANGLE(",[f,s],");",h,".divisor=",s,";}")}function c(){n("if(",h,".buffer){",u,".disableVertexAttribArray(",f,");",h,".buffer=null;","}if(",td.map(function(r,n){return h+"."+r+"!=="+d[n]}).join("||"),"){",u,".vertexAttrib4f(",f,",",d,");",td.map(function(r,n){return h+"."+r+"="+d[n]+";"}).join(""),"}")}var u=s.gl,f=n.def(i,".location"),h=n.def(s.attributes,"[",f,"]");i=o.state;var p=o.buffer,d=[o.x,o.y,o.z,o.w],m=["buffer","normalized","offset","stride"];1===i?l():2===i?c():(n("if(",i,"===",1,"){"),l(),n("}else{"),c(),n("}"))}(r.link(a),function(r){switch(r){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(a.info.type),l)})}function j(r,i,a,s,l,c){for(var u,f=r.shared,h=f.gl,p={},d=0;d<s.length;++d){var g=(w=s[d]).name,v=w.info.type,y=w.info.size,x=a.uniforms[g];if(1<y){if(!x)continue;var b=g.replace("[0]","");if(p[b])continue;p[b]=1}var _,w=r.link(w)+".location";if(x){if(!l(x))continue;if(L(x)){if(g=x.value,35678===v||35680===v)i(h,".uniform1i(",w,",",(v=r.link(g._texture||g.color[0]._texture))+".bind());"),i.exit(v,".unbind();");else if(35674===v||35675===v||35676===v)y=r.global.def("new Float32Array(["+Array.prototype.slice.call(g)+"])"),g=2,35675===v?g=3:35676===v&&(g=4),i(h,".uniformMatrix",g,"fv(",w,",false,",y,");");else{switch(v){case 5126:u="1f";break;case 35664:u="2f";break;case 35665:u="3f";break;case 35666:u="4f";break;case 35670:case 5124:u="1i";break;case 35671:case 35667:u="2i";break;case 35672:case 35668:u="3i";break;case 35673:case 35669:u="4i"}1<y?(u+="v",g=r.global.def("["+Array.prototype.slice.call(g)+"]")):g=m(g)?Array.prototype.slice.call(g):g,i(h,".uniform",u,"(",w,",",g,");")}continue}_=x.append(r,i)}else{if(!l(tb))continue;_=i.def(f.uniforms,"[",n.id(g),"]")}switch(35678===v?i("if(",_,"&&",_,'._reglType==="framebuffer"){',_,"=",_,".color[0];","}"):35680===v&&i("if(",_,"&&",_,'._reglType==="framebufferCube"){',_,"=",_,".color[0];","}"),g=1,v){case 35678:case 35680:v=i.def(_,"._texture"),i(h,".uniform1i(",w,",",v,".bind());"),i.exit(v,".unbind();");continue;case 5124:case 35670:u="1i";break;case 35667:case 35671:u="2i",g=2;break;case 35668:case 35672:u="3i",g=3;break;case 35669:case 35673:u="4i",g=4;break;case 5126:u="1f";break;case 35664:u="2f",g=2;break;case 35665:u="3f",g=3;break;case 35666:u="4f",g=4;break;case 35674:u="Matrix2fv";break;case 35675:u="Matrix3fv";break;case 35676:u="Matrix4fv"}if(-1===u.indexOf("Matrix")&&1<y&&(u+="v",g=1),"M"===u.charAt(0)){i(h,".uniform",u,"(",w,","),w=Math.pow(v-35674+2,2);var T=r.global.def("new Float32Array(",w,")");Array.isArray(_)?i("false,(",o(w,function(r){return T+"["+r+"]="+_[r]}),",",T,")"):i("false,(Array.isArray(",_,")||",_," instanceof Float32Array)?",_,":(",o(w,function(r){return T+"["+r+"]="+_+"["+r+"]"}),",",T,")"),i(");")}else{if(1<g){v=[];var k=[];for(y=0;y<g;++y)Array.isArray(_)?k.push(_[y]):k.push(i.def(_+"["+y+"]")),c&&v.push(i.def());c&&i("if(!",r.batchId,"||",v.map(function(r,n){return r+"!=="+k[n]}).join("||"),"){",v.map(function(r,n){return r+"="+k[n]+";"}).join("")),i(h,".uniform",u,"(",w,",",k.join(","),");")}else c&&(v=i.def(),i("if(!",r.batchId,"||",v,"!==",_,"){",v,"=",_,";")),i(h,".uniform",u,"(",w,",",_,");");c&&i("}")}}}function U(r,n,i,a){function o(o){var s=y[o];return s?s.contextDep&&a.contextDynamic||s.propDep?s.append(r,i):s.append(r,n):n.def(v,".",o)}function s(){function r(){i(d,".drawElementsInstancedANGLE(",[b,w,T,_+"<<(("+T+"-5121)>>1)",p],");")}function n(){i(d,".drawArraysInstancedANGLE(",[b,_,w,p],");")}x&&"null"!==x?k?r():(i("if(",x,"){"),r(),i("}else{"),n(),i("}")):n()}function l(){function r(){i(g+".drawElements("+[b,w,T,_+"<<(("+T+"-5121)>>1)"]+");")}function n(){i(g+".drawArrays("+[b,_,w]+");")}x&&"null"!==x?k?r():(i("if(",x,"){"),r(),i("}else{"),n(),i("}")):n()}var c,u,f,h,p,d,m=r.shared,g=m.gl,v=m.draw,y=a.draw,x=(c=y.elements,u=n,c?((c.contextDep&&a.contextDynamic||c.propDep)&&(u=i),c=c.append(r,u),y.elementsActive&&u("if("+c+")"+g+".bindBuffer(34963,"+c+".buffer.buffer);")):(c=u.def(),u(c,"=",v,".","elements",";","if(",c,"){",g,".bindBuffer(",34963,",",c,".buffer.buffer);}","else if(",m.vao,".currentVAO){",c,"=",r.shared.elements+".getElements("+m.vao,".currentVAO.elements);",$?"":"if("+c+")"+g+".bindBuffer(34963,"+c+".buffer.buffer);","}")),c),b=o("primitive"),_=o("offset"),w=(f=y.count,h=n,f?((f.contextDep&&a.contextDynamic||f.propDep)&&(h=i),f=f.append(r,h)):f=h.def(v,".","count"),f);if("number"==typeof w){if(0===w)return}else i("if(",w,"){"),i.exit("}");K&&(p=o("instances"),d=r.instancing);var T=x+".type",k=y.elements&&L(y.elements)&&!y.vaoActive;K&&("number"!=typeof p||0<=p)?"string"==typeof p?(i("if(",p,">0){"),s(),i("}else if(",p,"<0){"),l(),i("}")):s():l()}function V(r,n,i,a,o){return o=(n=w()).proc("body",o),K&&(n.instancing=o.def(n.shared.extensions,".angle_instanced_arrays")),r(n,o,i,a),n.compile().body}function H(r,n,i,a){F(r,n),i.useVAO?i.drawVAO?n(r.shared.vao,".setVAO(",i.drawVAO.append(r,n),");"):n(r.shared.vao,".setVAO(",r.shared.vao,".targetVAO);"):(n(r.shared.vao,".setVAO(null);"),N(r,n,i,a.attributes,function(){return!0})),j(r,n,i,a.uniforms,function(){return!0},!1),U(r,n,n,i)}function G(r,n,i,a){function o(){return!0}r.batchId="a1",F(r,n),N(r,n,i,a.attributes,o),j(r,n,i,a.uniforms,o,!1),U(r,n,n,i)}function Y(r,n,i,a){function o(r){return r.contextDep&&l||r.propDep}function s(r){return!o(r)}F(r,n);var l=i.contextDep,c=n.def(),u=n.def();r.shared.props=u,r.batchId=c;var f=r.scope(),h=r.scope();n(f.entry,"for(",c,"=0;",c,"<","a1",";++",c,"){",u,"=","a0","[",c,"];",h,"}",f.exit),i.needsContext&&T(r,h,i.context),i.needsFramebuffer&&I(r,h,i.framebuffer),R(r,h,i.state,o),i.profile&&o(i.profile)&&B(r,h,i,!1,!0),a?(i.useVAO?i.drawVAO?o(i.drawVAO)?h(r.shared.vao,".setVAO(",i.drawVAO.append(r,h),");"):f(r.shared.vao,".setVAO(",i.drawVAO.append(r,f),");"):f(r.shared.vao,".setVAO(",r.shared.vao,".targetVAO);"):(f(r.shared.vao,".setVAO(null);"),N(r,f,i,a.attributes,s),N(r,h,i,a.attributes,o)),j(r,f,i,a.uniforms,s,!1),j(r,h,i,a.uniforms,o,!0),U(r,f,h,i)):(n=r.global.def("{}"),a=i.shader.progVar.append(r,h),u=h.def(a,".id"),f=h.def(n,"[",u,"]"),h(r.shared.gl,".useProgram(",a,".program);","if(!",f,"){",f,"=",n,"[",u,"]=",r.link(function(n){return V(G,r,i,n,2)}),"(",a,");}",f,".call(this,a0[",c,"],",c,");"))}function W(r,n,i){var a=n.static[i];if(a&&function(r){if("object"==typeof r&&!m(r)){for(var n=Object.keys(r),i=0;i<n.length;++i)if(D.isDynamic(r[n[i]]))return!0;return!1}}(a)){var o=r.global,s=Object.keys(a),l=!1,c=!1,u=!1,f=r.global.def("{}");s.forEach(function(n){var i=a[n];if(D.isDynamic(i))"function"==typeof i&&(i=a[n]=D.unbox(i)),n=P(i,null),l=l||n.thisDep,u=u||n.propDep,c=c||n.contextDep;else{switch(o(f,".",n,"="),typeof i){case"number":o(i);break;case"string":o('"',i,'"');break;case"object":Array.isArray(i)&&o("[",i.join(),"]");break;default:o(r.link(i))}o(";")}}),n.dynamic[i]=new D.DynamicVariable(4,{thisDep:l,contextDep:c,propDep:u,ref:f,append:function(r,n){s.forEach(function(i){var o=a[i];D.isDynamic(o)&&(o=r.invoke(n,o),n(f,".",i,"=",o,";"))})}}),delete n.static[i]}}var X=h.Record,J={add:32774,subtract:32778,"reverse subtract":32779};i.ext_blend_minmax&&(J.min=32775,J.max=32776);var K=i.angle_instanced_arrays,Q=i.webgl_draw_buffers,$=i.oes_vertex_array_object,tt={dirty:!0,profile:y.profile},te={},tr=[],tn={},ti={};b("dither",3024),b("blend.enable",3042),_("blend.color","blendColor",[0,0,0,0]),_("blend.equation","blendEquationSeparate",[32774,32774]),_("blend.func","blendFuncSeparate",[1,0,1,0]),b("depth.enable",2929,!0),_("depth.func","depthFunc",513),_("depth.range","depthRange",[0,1]),_("depth.mask","depthMask",!0),_("colorMask","colorMask",[!0,!0,!0,!0]),b("cull.enable",2884),_("cull.face","cullFace",1029),_("frontFace","frontFace",2305),_("lineWidth","lineWidth",1),b("polygonOffset.enable",32823),_("polygonOffset.offset","polygonOffset",[0,0]),b("sample.alpha",32926),b("sample.enable",32928),_("sample.coverage","sampleCoverage",[1,!1]),b("stencil.enable",2960),_("stencil.mask","stencilMask",-1),_("stencil.func","stencilFunc",[519,0,-1]),_("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),_("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),b("scissor.enable",3089),_("scissor.box","scissor",[0,0,r.drawingBufferWidth,r.drawingBufferHeight]),_("viewport","viewport",[0,0,r.drawingBufferWidth,r.drawingBufferHeight]);var ta={gl:r,context:g,strings:n,next:te,current:tt,draw:d,elements:l,buffer:s,shader:p,attributes:h.state,vao:h,uniforms:f,framebuffer:u,extensions:i,timer:v,isBufferArgs:M},to={primTypes:Z,compareFuncs:tv,blendFuncs:tg,blendEquations:J,stencilOps:ty,glTypes:q,orientationType:tx};Q&&(to.backBuffer=[1029],to.drawBuffer=o(a.maxDrawbuffers,function(r){return 0===r?[0]:o(r,function(r){return 36064+r})}));var ts=0;return{next:te,current:tt,procs:function(){var r=w(),n=r.proc("poll"),s=r.proc("refresh"),l=r.block();n(l),s(l);var c,u=r.shared,f=u.gl,h=u.next,p=u.current;l(p,".dirty=false;"),I(r,n),I(r,s,null,!0),K&&(c=r.link(K)),i.oes_vertex_array_object&&s(r.link(i.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var d=0;d<a.maxAttributes;++d){var g=s.def(u.attributes,"[",d,"]"),v=r.cond(g,".buffer");v.then(f,".enableVertexAttribArray(",d,");",f,".bindBuffer(",34962,",",g,".buffer.buffer);",f,".vertexAttribPointer(",d,",",g,".size,",g,".type,",g,".normalized,",g,".stride,",g,".offset);").else(f,".disableVertexAttribArray(",d,");",f,".vertexAttrib4f(",d,",",g,".x,",g,".y,",g,".z,",g,".w);",g,".buffer=null;"),s(v),K&&s(c,".vertexAttribDivisorANGLE(",d,",",g,".divisor);")}return s(r.shared.vao,".currentVAO=null;",r.shared.vao,".setVAO(",r.shared.vao,".targetVAO);"),Object.keys(tn).forEach(function(i){var a=tn[i],o=l.def(h,".",i),c=r.block();c("if(",o,"){",f,".enable(",a,")}else{",f,".disable(",a,")}",p,".",i,"=",o,";"),s(c),n("if(",o,"!==",p,".",i,"){",c,"}")}),Object.keys(ti).forEach(function(i){var a,c,u=ti[i],d=tt[i],g=r.block();g(f,".",u,"("),m(d)?(u=d.length,a=r.global.def(h,".",i),c=r.global.def(p,".",i),g(o(u,function(r){return a+"["+r+"]"}),");",o(u,function(r){return c+"["+r+"]="+a+"["+r+"];"}).join("")),n("if(",o(u,function(r){return a+"["+r+"]!=="+c+"["+r+"]"}).join("||"),"){",g,"}")):(a=l.def(h,".",i),c=l.def(p,".",i),g(a,");",p,".",i,"=",a,";"),n("if(",a,"!==",c,"){",g,"}")),s(g)}),r.compile()}(),compile:function(r,a,c,f,d){var g=w();g.stats=g.link(d),Object.keys(a.static).forEach(function(r){W(g,a,r)}),tm.forEach(function(n){W(g,r,n)});var v=function(r,a,c,f,d){function g(r){var n=O[r];n&&(D[r]=n)}var v,y,b,_,w,T,k,A,S,I=function(r,n){if("string"==typeof(i=r.static).frag&&"string"==typeof i.vert){if(0<Object.keys(n.dynamic).length)return null;var i=n.static,a=Object.keys(i);if(0<a.length&&"number"==typeof i[a[0]]){for(var o=[],s=0;s<a.length;++s)o.push([0|i[a[s]],a[s]]);return o}}return null}(r,a),O=function(r,n,i){function a(r){if(r in o){var i=o[r];r=!0;var a,l,c=0|i.x,u=0|i.y;return"width"in i?a=0|i.width:r=!1,"height"in i?l=0|i.height:r=!1,new E(!r&&n&&n.thisDep,!r&&n&&n.contextDep,!r&&n&&n.propDep,function(r,n){var o=r.shared.context,s=a;"width"in i||(s=n.def(o,".","framebufferWidth","-",c));var f=l;return"height"in i||(f=n.def(o,".","framebufferHeight","-",u)),[c,u,s,f]})}if(r in s){var f=s[r];return r=P(f,function(r,n){var i=r.invoke(n,f),a=r.shared.context,o=n.def(i,".x|0"),s=n.def(i,".y|0");return[o,s,n.def('"width" in ',i,"?",i,".width|0:","(",a,".","framebufferWidth","-",o,")"),i=n.def('"height" in ',i,"?",i,".height|0:","(",a,".","framebufferHeight","-",s,")")]}),n&&(r.thisDep=r.thisDep||n.thisDep,r.contextDep=r.contextDep||n.contextDep,r.propDep=r.propDep||n.propDep),r}return n?new E(n.thisDep,n.contextDep,n.propDep,function(r,n){var i=r.shared.context;return[0,0,n.def(i,".","framebufferWidth"),n.def(i,".","framebufferHeight")]}):null}var o=r.static,s=r.dynamic;if(r=a("viewport")){var l=r;r=new E(r.thisDep,r.contextDep,r.propDep,function(r,n){var i=l.append(r,n),a=r.shared.context;return n.set(a,".viewportWidth",i[2]),n.set(a,".viewportHeight",i[3]),i})}return{viewport:r,scissor_box:a("scissor.box")}}(r,U=function(r,n){var i=r.static,a=r.dynamic;if("framebuffer"in i){var o=i.framebuffer;return o?(o=u.getFramebuffer(o),C(function(r,n){var i=r.link(o),a=r.shared;return n.set(a.framebuffer,".next",i),a=a.context,n.set(a,".framebufferWidth",i+".width"),n.set(a,".framebufferHeight",i+".height"),i})):C(function(r,n){var i=r.shared;return n.set(i.framebuffer,".next","null"),i=i.context,n.set(i,".framebufferWidth",i+".drawingBufferWidth"),n.set(i,".framebufferHeight",i+".drawingBufferHeight"),"null"})}if("framebuffer"in a){var s=a.framebuffer;return P(s,function(r,n){var i=r.invoke(n,s),a=r.shared,o=a.framebuffer;return i=n.def(o,".getFramebuffer(",i,")"),n.set(o,".next",i),a=a.context,n.set(a,".framebufferWidth",i+"?"+i+".width:"+a+".drawingBufferWidth"),n.set(a,".framebufferHeight",i+"?"+i+".height:"+a+".drawingBufferHeight"),i})}return null}(r)),z=function(r,n){function i(r,n){if(r in a){var i=0|a[r];return n?s.offset=i:s.instances=i,C(function(r,a){return n&&(r.OFFSET=i),i})}if(r in o){var l=o[r];return P(l,function(r,i){var a=r.invoke(i,l);return n&&(r.OFFSET=a),a})}if(n){if(f)return C(function(r,n){return r.OFFSET=0});if(c)return new E(u.thisDep,u.contextDep,u.propDep,function(r,n){return n.def(r.shared.vao+".currentVAO?"+r.shared.vao+".currentVAO.offset:0")})}else if(c)return new E(u.thisDep,u.contextDep,u.propDep,function(r,n){return n.def(r.shared.vao+".currentVAO?"+r.shared.vao+".currentVAO.instances:-1")});return null}var a=r.static,o=r.dynamic,s={},c=!1,u=function(){if("vao"in a){var r=a.vao;return null!==r&&null===h.getVAO(r)&&(r=h.createVAO(r)),c=!0,s.vao=r,C(function(n){var i=h.getVAO(r);return i?n.link(i):"null"})}if("vao"in o){c=!0;var n=o.vao;return P(n,function(r,i){var a=r.invoke(i,n);return i.def(r.shared.vao+".getVAO("+a+")")})}return null}(),f=!1,p=function(){if("elements"in a){var r=a.elements;if(s.elements=r,M(r)){var n=s.elements=l.create(r,!0);r=l.getElements(n),f=!0}else r&&(r=l.getElements(r),f=!0);return(n=C(function(n,i){if(r){var a=n.link(r);return n.ELEMENTS=a}return n.ELEMENTS=null})).value=r,n}if("elements"in o){f=!0;var i=o.elements;return P(i,function(r,n){var a=(o=r.shared).isBufferArgs,o=o.elements,s=r.invoke(n,i),l=n.def("null");return a=n.def(a,"(",s,")"),s=r.cond(a).then(l,"=",o,".createStream(",s,");").else(l,"=",o,".getElements(",s,");"),n.entry(s),n.exit(r.cond(a).then(o,".destroyStream(",l,");")),r.ELEMENTS=l})}return c?new E(u.thisDep,u.contextDep,u.propDep,function(r,n){return n.def(r.shared.vao+".currentVAO?"+r.shared.elements+".getElements("+r.shared.vao+".currentVAO.elements):null")}):null}(),d=i("offset",!0),m=function(){if("primitive"in a){var r=a.primitive;return s.primitive=r,C(function(n,i){return Z[r]})}if("primitive"in o){var n=o.primitive;return P(n,function(r,i){var a=r.constants.primTypes,o=r.invoke(i,n);return i.def(a,"[",o,"]")})}return f?L(p)?p.value?C(function(r,n){return n.def(r.ELEMENTS,".primType")}):C(function(){return 4}):new E(p.thisDep,p.contextDep,p.propDep,function(r,n){var i=r.ELEMENTS;return n.def(i,"?",i,".primType:",4)}):c?new E(u.thisDep,u.contextDep,u.propDep,function(r,n){return n.def(r.shared.vao+".currentVAO?"+r.shared.vao+".currentVAO.primitive:4")}):null}(),g=function(){if("count"in a){var r=0|a.count;return s.count=r,C(function(){return r})}if("count"in o){var n=o.count;return P(n,function(r,i){return r.invoke(i,n)})}return f?L(p)?p?d?new E(d.thisDep,d.contextDep,d.propDep,function(r,n){return n.def(r.ELEMENTS,".vertCount-",r.OFFSET)}):C(function(r,n){return n.def(r.ELEMENTS,".vertCount")}):C(function(){return -1}):new E(p.thisDep||d.thisDep,p.contextDep||d.contextDep,p.propDep||d.propDep,function(r,n){var i=r.ELEMENTS;return r.OFFSET?n.def(i,"?",i,".vertCount-",r.OFFSET,":-1"):n.def(i,"?",i,".vertCount:-1")}):c?new E(u.thisDep,u.contextDep,u.propDep,function(r,n){return n.def(r.shared.vao,".currentVAO?",r.shared.vao,".currentVAO.count:-1")}):null}();return{elements:p,primitive:m,count:g,instances:i("instances",!1),offset:d,vao:u,vaoActive:c,elementsActive:f,static:s}}(r),D=(B=(F=r).static,N=F.dynamic,j={},tr.forEach(function(r){function n(n,a){if(r in B){var o=n(B[r]);j[i]=C(function(){return o})}else if(r in N){var s=N[r];j[i]=P(s,function(r,n){return a(r,n,r.invoke(n,s))})}}var i=x(r);switch(r){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return n(function(r){return r},function(r,n,i){return i});case"depth.func":return n(function(r){return tv[r]},function(r,n,i){return n.def(r.constants.compareFuncs,"[",i,"]")});case"depth.range":return n(function(r){return r},function(r,n,i){return[n.def("+",i,"[0]"),n=n.def("+",i,"[1]")]});case"blend.func":return n(function(r){return[tg["srcRGB"in r?r.srcRGB:r.src],tg["dstRGB"in r?r.dstRGB:r.dst],tg["srcAlpha"in r?r.srcAlpha:r.src],tg["dstAlpha"in r?r.dstAlpha:r.dst]]},function(r,n,i){function a(r,a){return n.def('"',r,a,'" in ',i,"?",i,".",r,a,":",i,".",r)}r=r.constants.blendFuncs;var o=a("src","RGB"),s=a("dst","RGB"),l=(o=n.def(r,"[",o,"]"),n.def(r,"[",a("src","Alpha"),"]"));return[o,s=n.def(r,"[",s,"]"),l,r=n.def(r,"[",a("dst","Alpha"),"]")]});case"blend.equation":return n(function(r){return"string"==typeof r?[J[r],J[r]]:"object"==typeof r?[J[r.rgb],J[r.alpha]]:void 0},function(r,n,i){var a=r.constants.blendEquations,o=n.def(),s=n.def();return(r=r.cond("typeof ",i,'==="string"')).then(o,"=",s,"=",a,"[",i,"];"),r.else(o,"=",a,"[",i,".rgb];",s,"=",a,"[",i,".alpha];"),n(r),[o,s]});case"blend.color":return n(function(r){return o(4,function(n){return+r[n]})},function(r,n,i){return o(4,function(r){return n.def("+",i,"[",r,"]")})});case"stencil.mask":return n(function(r){return 0|r},function(r,n,i){return n.def(i,"|0")});case"stencil.func":return n(function(r){return[tv[r.cmp||"keep"],r.ref||0,"mask"in r?r.mask:-1]},function(r,n,i){return[r=n.def('"cmp" in ',i,"?",r.constants.compareFuncs,"[",i,".cmp]",":",7680),n.def(i,".ref|0"),n=n.def('"mask" in ',i,"?",i,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return n(function(n){return["stencil.opBack"===r?1029:1028,ty[n.fail||"keep"],ty[n.zfail||"keep"],ty[n.zpass||"keep"]]},function(n,i,a){function o(r){return i.def('"',r,'" in ',a,"?",s,"[",a,".",r,"]:",7680)}var s=n.constants.stencilOps;return["stencil.opBack"===r?1029:1028,o("fail"),o("zfail"),o("zpass")]});case"polygonOffset.offset":return n(function(r){return[0|r.factor,0|r.units]},function(r,n,i){return[n.def(i,".factor|0"),n=n.def(i,".units|0")]});case"cull.face":return n(function(r){var n=0;return"front"===r?n=1028:"back"===r&&(n=1029),n},function(r,n,i){return n.def(i,'==="front"?',1028,":",1029)});case"lineWidth":return n(function(r){return r},function(r,n,i){return i});case"frontFace":return n(function(r){return tx[r]},function(r,n,i){return n.def(i+'==="cw"?2304:2305')});case"colorMask":return n(function(r){return r.map(function(r){return!!r})},function(r,n,i){return o(4,function(r){return"!!"+i+"["+r+"]"})});case"sample.coverage":return n(function(r){return["value"in r?r.value:1,!!r.invert]},function(r,n,i){return[n.def('"value" in ',i,"?+",i,".value:1"),n=n.def("!!",i,".invert")]})}}),j),R=function(r,i,a){function o(r){if(r in s){var i=n.id(s[r]);return(r=C(function(){return i})).id=i,r}if(r in l){var a=l[r];return P(a,function(r,n){var i=r.invoke(n,a);return n.def(r.shared.strings,".id(",i,")")})}return null}var s=r.static,l=r.dynamic,c=o("frag"),u=o("vert"),f=null;return L(c)&&L(u)?(f=p.program(u.id,c.id,null,a),r=C(function(r,n){return r.link(f)})):r=new E(c&&c.thisDep||u&&u.thisDep,c&&c.contextDep||u&&u.contextDep,c&&c.propDep||u&&u.propDep,function(r,n){var i,a,o=r.shared.shader;return i=c?c.append(r,n):n.def(o,".","frag"),a=u?u.append(r,n):n.def(o,".","vert"),n.def(o+".program("+a+","+i+")")}),{frag:c,vert:u,progVar:r,program:f}}(r,0,I);g("viewport"),g(x("scissor.box"));var F,B,N,j,U,V=0<Object.keys(D).length;if((U={framebuffer:U,draw:z,shader:R,state:D,dirty:V,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(r){var n,i=r.static;if(r=r.dynamic,"profile"in i){var a=!!i.profile;(n=C(function(r,n){return a})).enable=a}else if("profile"in r){var o=r.profile;n=P(o,function(r,n){return r.invoke(n,o)})}return n}(r),U.uniforms=(v=c.static,y=c.dynamic,b={},Object.keys(v).forEach(function(r){var n,i=v[r];if("number"==typeof i||"boolean"==typeof i)n=C(function(){return i});else if("function"==typeof i){var a=i._reglType;"texture2d"===a||"textureCube"===a?n=C(function(r){return r.link(i)}):"framebuffer"!==a&&"framebufferCube"!==a||(n=C(function(r){return r.link(i.color[0])}))}else m(i)&&(n=C(function(r){return r.global.def("[",o(i.length,function(r){return i[r]}),"]")}));n.value=i,b[r]=n}),Object.keys(y).forEach(function(r){var n=y[r];b[r]=P(n,function(r,i){return r.invoke(i,n)})}),b),U.drawVAO=U.scopeVAO=z.vao,!U.drawVAO&&R.program&&!I&&i.angle_instanced_arrays&&z.static.elements){var H=!0;if(r=R.program.attributes.map(function(r){return r=a.static[r],H=H&&!!r,r}),H&&0<r.length){var G=h.getVAO(h.createVAO({attributes:r,elements:z.static.elements}));U.drawVAO=new E(null,null,null,function(r,n){return r.link(G)}),U.useVAO=!0}}return I?U.useVAO=!0:U.attributes=(_=a.static,w=a.dynamic,T={},Object.keys(_).forEach(function(r){var i=_[r],a=n.id(r),o=new X;if(M(i))o.state=1,o.buffer=s.getBuffer(s.create(i,34962,!1,!0)),o.type=0;else if(c=s.getBuffer(i))o.state=1,o.buffer=c,o.type=0;else if("constant"in i){var l=i.constant;o.buffer="null",o.state=2,"number"==typeof l?o.x=l:td.forEach(function(r,n){n<l.length&&(o[r]=l[n])})}else{var c=M(i.buffer)?s.getBuffer(s.create(i.buffer,34962,!1,!0)):s.getBuffer(i.buffer),u=0|i.offset,f=0|i.stride,h=0|i.size,p=!!i.normalized,d=0;"type"in i&&(d=q[i.type]),i=0|i.divisor,o.buffer=c,o.state=1,o.size=h,o.normalized=p,o.type=d||c.dtype,o.offset=u,o.stride=f,o.divisor=i}T[r]=C(function(r,n){var i=r.attribCache;if(a in i)return i[a];var s={isStream:!1};return Object.keys(o).forEach(function(r){s[r]=o[r]}),o.buffer&&(s.buffer=r.link(o.buffer),s.type=s.type||s.buffer+".dtype"),i[a]=s})}),Object.keys(w).forEach(function(r){var n=w[r];T[r]=P(n,function(r,i){function a(r){i(u[r],"=",o,".",r,"|0;")}var o=r.invoke(i,n),s=r.shared,l=r.constants,c=s.isBufferArgs,u=(s=s.buffer,{isStream:i.def(!1)}),f=new X;f.state=1,Object.keys(f).forEach(function(r){u[r]=i.def(""+f[r])});var h=u.buffer,p=u.type;return i("if(",c,"(",o,")){",u.isStream,"=true;",h,"=",s,".createStream(",34962,",",o,");",p,"=",h,".dtype;","}else{",h,"=",s,".getBuffer(",o,");","if(",h,"){",p,"=",h,".dtype;",'}else if("constant" in ',o,"){",u.state,"=",2,";","if(typeof "+o+'.constant === "number"){',u[td[0]],"=",o,".constant;",td.slice(1).map(function(r){return u[r]}).join("="),"=0;","}else{",td.map(function(r,n){return u[r]+"="+o+".constant.length>"+n+"?"+o+".constant["+n+"]:0;"}).join(""),"}}else{","if(",c,"(",o,".buffer)){",h,"=",s,".createStream(",34962,",",o,".buffer);","}else{",h,"=",s,".getBuffer(",o,".buffer);","}",p,'="type" in ',o,"?",l.glTypes,"[",o,".type]:",h,".dtype;",u.normalized,"=!!",o,".normalized;"),a("size"),a("offset"),a("stride"),a("divisor"),i("}}"),i.exit("if(",u.isStream,"){",s,".destroyStream(",h,");","}"),u})}),T),U.context=(k=f.static,A=f.dynamic,S={},Object.keys(k).forEach(function(r){var n=k[r];S[r]=C(function(r,i){return"number"==typeof n||"boolean"==typeof n?""+n:r.link(n)})}),Object.keys(A).forEach(function(r){var n=A[r];S[r]=P(n,function(r,i){return r.invoke(i,n)})}),S),U}(r,a,c,f);return function(r,n){var i=r.proc("draw",1);F(r,i),T(r,i,n.context),I(r,i,n.framebuffer),z(r,i,n),R(r,i,n.state),B(r,i,n,!1,!0);var a=n.shader.progVar.append(r,i);if(i(r.shared.gl,".useProgram(",a,".program);"),n.shader.program)H(r,i,n,n.shader.program);else{i(r.shared.vao,".setVAO(null);");var o=r.global.def("{}"),s=i.def(a,".id"),l=i.def(o,"[",s,"]");i(r.cond(l).then(l,".call(this,a0);").else(l,"=",o,"[",s,"]=",r.link(function(i){return V(H,r,n,i,1)}),"(",a,");",l,".call(this,a0);"))}0<Object.keys(n.state).length&&i(r.shared.current,".dirty=true;"),r.shared.vao&&i(r.shared.vao,".setVAO(null);")}(g,v),function(r,i){function a(n){var a=i.shader[n];a&&o.set(s.shader,"."+n,a.append(r,o))}var o=r.proc("scope",3);r.batchId="a2";var s=r.shared,l=s.current;T(r,o,i.context),i.framebuffer&&i.framebuffer.append(r,o),S(Object.keys(i.state)).forEach(function(n){var a=i.state[n].append(r,o);m(a)?a.forEach(function(i,a){o.set(r.next[n],"["+a+"]",i)}):o.set(s.next,"."+n,a)}),B(r,o,i,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(n){var a=i.draw[n];a&&o.set(s.draw,"."+n,""+a.append(r,o))}),Object.keys(i.uniforms).forEach(function(a){var l=i.uniforms[a].append(r,o);Array.isArray(l)&&(l="["+l.join()+"]"),o.set(s.uniforms,"["+n.id(a)+"]",l)}),Object.keys(i.attributes).forEach(function(n){var a=i.attributes[n].append(r,o),s=r.scopeAttrib(n);Object.keys(new X).forEach(function(r){o.set(s,"."+r,a[r])})}),i.scopeVAO&&o.set(s.vao,".targetVAO",i.scopeVAO.append(r,o)),a("vert"),a("frag"),0<Object.keys(i.state).length&&(o(l,".dirty=true;"),o.exit(l,".dirty=true;")),o("a1(",r.shared.context,",a0,",r.batchId,");")}(g,v),function(r,n){function i(r){return r.contextDep&&o||r.propDep}var a=r.proc("batch",2);r.batchId="0",F(r,a);var o=!1,s=!0;Object.keys(n.context).forEach(function(r){o=o||n.context[r].propDep}),o||(T(r,a,n.context),s=!1);var l=!1;if((c=n.framebuffer)?(c.propDep?o=l=!0:c.contextDep&&o&&(l=!0),l||I(r,a,c)):I(r,a,null),n.state.viewport&&n.state.viewport.propDep&&(o=!0),z(r,a,n),R(r,a,n.state,function(r){return!i(r)}),n.profile&&i(n.profile)||B(r,a,n,!1,"a1"),n.contextDep=o,n.needsContext=s,n.needsFramebuffer=l,(s=n.shader.progVar).contextDep&&o||s.propDep)Y(r,a,n,null);else if(s=s.append(r,a),a(r.shared.gl,".useProgram(",s,".program);"),n.shader.program)Y(r,a,n,n.shader.program);else{a(r.shared.vao,".setVAO(null);");var c=r.global.def("{}"),u=(l=a.def(s,".id"),a.def(c,"[",l,"]"));a(r.cond(u).then(u,".call(this,a0,a1);").else(u,"=",c,"[",l,"]=",r.link(function(i){return V(Y,r,n,i,2)}),"(",s,");",u,".call(this,a0,a1);"))}0<Object.keys(n.state).length&&a(r.shared.current,".dirty=true;"),r.shared.vao&&a(r.shared.vao,".setVAO(null);")}(g,v),O(g.compile(),{destroy:function(){v.shader.program.destroy()}})}}}(tT,tM,tE,tz,tD,tR,0,tU,{},tF,tB,tP,tO,tL,r),tH=(tM=function(r,n,i,a,o,s,l){function c(o){s=null===n.next?5121:n.next.colorAttachments[0].texture._texture.type;var s,l=0,c=0,u=a.framebufferWidth,f=a.framebufferHeight,h=null;return j(o)?h=o:o&&(l=0|o.x,c=0|o.y,u=0|(o.width||a.framebufferWidth-l),f=0|(o.height||a.framebufferHeight-c),h=o.data||null),i(),o=u*f*4,h||(5121===s?h=new Uint8Array(o):5126===s&&(h=h||new Float32Array(o))),r.pixelStorei(3333,4),r.readPixels(l,c,u,f,6408,s,h),h}return function(r){var i;return r&&"framebuffer"in r?(n.setFBO({framebuffer:r.framebuffer},function(){i=c(r)}),i):c(r)}}(tT,tU,tV.procs.poll,tO),tV.next),tq=tT.canvas,tG=[],tY=[],tW=[],tX=[r.onDestroy],tZ=null;tq&&(tq.addEventListener("webglcontextlost",u,!1),tq.addEventListener("webglcontextrestored",g,!1));var tJ=tU.setFBO=z({framebuffer:D.define.call(null,1,"framebuffer")});return tc(),tk=O(z,{clear:function(r){if("framebuffer"in r){if(r.framebuffer&&"framebufferCube"===r.framebuffer_reglType)for(var n=0;6>n;++n)tJ(O({framebuffer:r.framebuffer.faces[n]},r),J);else tJ(r,J)}else J(0,r)},prop:D.define.bind(null,1),context:D.define.bind(null,2),this:D.define.bind(null,3),draw:z({}),buffer:function(r){return tD.create(r,34962,!1,!1)},elements:function(r){return tR.create(r,!1)},texture:tN.create2D,cube:tN.createCube,renderbuffer:tj.create,framebuffer:tU.create,framebufferCube:tU.createCube,vao:tF.createVAO,attributes:tk,frame:K,on:function(r,n){var i;switch(r){case"frame":return K(n);case"lost":i=tY;break;case"restore":i=tW;break;case"destroy":i=tX}return i.push(n),{cancel:function(){for(var r=0;r<i.length;++r)if(i[r]===n){i[r]=i[i.length-1],i.pop();break}}}},limits:tz,hasExtension:function(r){return 0<=tz.extensions.indexOf(r.toLowerCase())},read:tM,destroy:function(){tG.length=0,l(),tq&&(tq.removeEventListener("webglcontextlost",u),tq.removeEventListener("webglcontextrestored",g)),tB.clear(),tU.clear(),tj.clear(),tF.clear(),tN.clear(),tR.clear(),tD.clear(),tL&&tL.clear(),tX.forEach(function(r){r()})},_gl:tT,_refresh:tc,poll:function(){tl(),tL&&tL.update()},now:tu,stats:tS}),r.onDone(null,tk),tk}},"object"==typeof i&&void 0!==n?n.exports=a():this.createREGL=a()},{}],284:[function(r,n,i){var a=r("buffer"),o=a.Buffer;function s(r,n){for(var i in r)n[i]=r[i]}function l(r,n,i){return o(r,n,i)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?n.exports=a:(s(a,i),i.Buffer=l),l.prototype=Object.create(o.prototype),s(o,l),l.from=function(r,n,i){if("number"==typeof r)throw TypeError("Argument must not be a number");return o(r,n,i)},l.alloc=function(r,n,i){if("number"!=typeof r)throw TypeError("Argument must be a number");var a=o(r);return void 0!==n?"string"==typeof i?a.fill(n,i):a.fill(n):a.fill(0),a},l.allocUnsafe=function(r){if("number"!=typeof r)throw TypeError("Argument must be a number");return o(r)},l.allocUnsafeSlow=function(r){if("number"!=typeof r)throw TypeError("Argument must be a number");return a.SlowBuffer(r)}},{buffer:85}],285:[function(r,n,i){n.exports=o;var a=r("events").EventEmitter;function o(){a.call(this)}r("inherits")(o,a),o.Readable=r("readable-stream/lib/_stream_readable.js"),o.Writable=r("readable-stream/lib/_stream_writable.js"),o.Duplex=r("readable-stream/lib/_stream_duplex.js"),o.Transform=r("readable-stream/lib/_stream_transform.js"),o.PassThrough=r("readable-stream/lib/_stream_passthrough.js"),o.finished=r("readable-stream/lib/internal/streams/end-of-stream.js"),o.pipeline=r("readable-stream/lib/internal/streams/pipeline.js"),o.Stream=o,o.prototype.pipe=function(r,n){var i=this;function o(n){r.writable&&!1===r.write(n)&&i.pause&&i.pause()}function s(){i.readable&&i.resume&&i.resume()}i.on("data",o),r.on("drain",s),r._isStdio||n&&!1===n.end||(i.on("end",c),i.on("close",u));var l=!1;function c(){l||(l=!0,r.end())}function u(){l||(l=!0,"function"==typeof r.destroy&&r.destroy())}function f(r){if(h(),0===a.listenerCount(this,"error"))throw r}function h(){i.removeListener("data",o),r.removeListener("drain",s),i.removeListener("end",c),i.removeListener("close",u),i.removeListener("error",f),r.removeListener("error",f),i.removeListener("end",h),i.removeListener("close",h),r.removeListener("close",h)}return i.on("error",f),r.on("error",f),i.on("end",h),i.on("close",h),r.on("close",h),r.emit("pipe",i),r}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":287,"readable-stream/lib/_stream_passthrough.js":288,"readable-stream/lib/_stream_readable.js":289,"readable-stream/lib/_stream_transform.js":290,"readable-stream/lib/_stream_writable.js":291,"readable-stream/lib/internal/streams/end-of-stream.js":295,"readable-stream/lib/internal/streams/pipeline.js":297}],286:[function(r,n,i){"use strict";var a={};function o(r,n,i){i||(i=Error);var o=function(r){function i(i,a,o){return r.call(this,"string"==typeof n?n:n(i,a,o))||this}return i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.__proto__=r,i}(i);o.prototype.name=i.name,o.prototype.code=r,a[r]=o}function s(r,n){if(Array.isArray(r)){var i=r.length;return r=r.map(function(r){return String(r)}),i>2?"one of ".concat(n," ").concat(r.slice(0,i-1).join(", "),", or ")+r[i-1]:2===i?"one of ".concat(n," ").concat(r[0]," or ").concat(r[1]):"of ".concat(n," ").concat(r[0])}return"of ".concat(n," ").concat(String(r))}o("ERR_INVALID_OPT_VALUE",function(r,n){return'The value "'+n+'" is invalid for option "'+r+'"'},TypeError),o("ERR_INVALID_ARG_TYPE",function(r,n,i){if("string"==typeof n&&(o="not ",n.substr(!l||l<0?0:+l,o.length)===o)?(a="must not be",n=n.replace(/^not /,"")):a="must be",u=" argument",(void 0===f||f>r.length)&&(f=r.length),r.substring(f-u.length,f)===u)c="The ".concat(r," ").concat(a," ").concat(s(n,"type"));else{var a,o,l,c,u,f,h,p=("number"!=typeof h&&(h=0),h+1>r.length||-1===r.indexOf(".",h))?"argument":"property";c='The "'.concat(r,'" ').concat(p," ").concat(a," ").concat(s(n,"type"))}return c+". Received type ".concat(typeof i)},TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"}),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"}),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=a},{}],287:[function(r,n,i){(function(i){(function(){"use strict";var a=Object.keys||function(r){var n=[];for(var i in r)n.push(i);return n};n.exports=f;var o=r("./_stream_readable"),s=r("./_stream_writable");r("inherits")(f,o);for(var l=a(s.prototype),c=0;c<l.length;c++){var u=l[c];f.prototype[u]||(f.prototype[u]=s.prototype[u])}function f(r){if(!(this instanceof f))return new f(r);o.call(this,r),s.call(this,r),this.allowHalfOpen=!0,r&&(!1===r.readable&&(this.readable=!1),!1===r.writable&&(this.writable=!1),!1===r.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||i.nextTick(p,this)}function p(r){r.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(r){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=r,this._writableState.destroyed=r)}})}).call(this)}).call(this,r("_process"))},{"./_stream_readable":289,"./_stream_writable":291,_process:277,inherits:231}],288:[function(r,n,i){"use strict";n.exports=o;var a=r("./_stream_transform");function o(r){if(!(this instanceof o))return new o(r);a.call(this,r)}r("inherits")(o,a),o.prototype._transform=function(r,n,i){i(null,r)}},{"./_stream_transform":290,inherits:231}],289:[function(r,n,a){(function(i,a){(function(){"use strict";n.exports=S,S.ReadableState=M,r("events").EventEmitter;var o,s,l=function(r,n){return r.listeners(n).length},c=r("./internal/streams/stream"),u=r("buffer").Buffer,f=a.Uint8Array||function(){},h=r("util");s=h&&h.debuglog?h.debuglog("stream"):function(){};var p,d,m,g=r("./internal/streams/buffer_list"),v=r("./internal/streams/destroy"),y=r("./internal/streams/state").getHighWaterMark,x=r("../errors").codes,b=x.ERR_INVALID_ARG_TYPE,_=x.ERR_STREAM_PUSH_AFTER_EOF,w=x.ERR_METHOD_NOT_IMPLEMENTED,T=x.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r("inherits")(S,c);var k=v.errorOrDestroy,A=["error","close","destroy","pause","resume"];function M(n,i,a){o=o||r("./_stream_duplex"),n=n||{},"boolean"!=typeof a&&(a=i instanceof o),this.objectMode=!!n.objectMode,a&&(this.objectMode=this.objectMode||!!n.readableObjectMode),this.highWaterMark=y(this,n,"readableHighWaterMark",a),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==n.emitClose,this.autoDestroy=!!n.autoDestroy,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(p||(p=r("string_decoder/").StringDecoder),this.decoder=new p(n.encoding),this.encoding=n.encoding)}function S(n){if(o=o||r("./_stream_duplex"),!(this instanceof S))return new S(n);var i=this instanceof o;this._readableState=new M(n,this,i),this.readable=!0,n&&("function"==typeof n.read&&(this._read=n.read),"function"==typeof n.destroy&&(this._destroy=n.destroy)),c.call(this)}function E(r,n,i,a,o){s("readableAddChunk",n);var l,c,h,p,d=r._readableState;if(null===n)d.reading=!1,function(r,n){if(s("onEofChunk"),!n.ended){if(n.decoder){var i=n.decoder.end();i&&i.length&&(n.buffer.push(i),n.length+=n.objectMode?1:i.length)}n.ended=!0,n.sync?P(r):(n.needReadable=!1,n.emittedReadable||(n.emittedReadable=!0,I(r)))}}(r,d);else if(o||(l=n,u.isBuffer(l)||l instanceof f||"string"==typeof l||void 0===l||d.objectMode||(c=new b("chunk",["string","Buffer","Uint8Array"],l)),p=c),p)k(r,p);else if(d.objectMode||n&&n.length>0){if("string"==typeof n||d.objectMode||Object.getPrototypeOf(n)===u.prototype||(h=n,n=u.from(h)),a)d.endEmitted?k(r,new T):L(r,d,n,!0);else if(d.ended)k(r,new _);else{if(d.destroyed)return!1;d.reading=!1,d.decoder&&!i?(n=d.decoder.write(n),d.objectMode||0!==n.length?L(r,d,n,!1):O(r,d)):L(r,d,n,!1)}}else a||(d.reading=!1,O(r,d));return!d.ended&&(d.length<d.highWaterMark||0===d.length)}function L(r,n,i,a){n.flowing&&0===n.length&&!n.sync?(n.awaitDrain=0,r.emit("data",i)):(n.length+=n.objectMode?1:i.length,a?n.buffer.unshift(i):n.buffer.push(i),n.needReadable&&P(r)),O(r,n)}function C(r,n){var i;return r<=0||0===n.length&&n.ended?0:n.objectMode?1:r!=r?n.flowing&&n.length?n.buffer.head.data.length:n.length:(r>n.highWaterMark&&(n.highWaterMark=((i=r)>=1073741824?i=1073741824:(i--,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i++),i)),r<=n.length?r:n.ended?n.length:(n.needReadable=!0,0))}function P(r){var n=r._readableState;s("emitReadable",n.needReadable,n.emittedReadable),n.needReadable=!1,n.emittedReadable||(s("emitReadable",n.flowing),n.emittedReadable=!0,i.nextTick(I,r))}function I(r){var n=r._readableState;s("emitReadable_",n.destroyed,n.length,n.ended),!n.destroyed&&(n.length||n.ended)&&(r.emit("readable"),n.emittedReadable=!1),n.needReadable=!n.flowing&&!n.ended&&n.length<=n.highWaterMark,B(r)}function O(r,n){n.readingMore||(n.readingMore=!0,i.nextTick(z,r,n))}function z(r,n){for(;!n.reading&&!n.ended&&(n.length<n.highWaterMark||n.flowing&&0===n.length);){var i=n.length;if(s("maybeReadMore read 0"),r.read(0),i===n.length)break}n.readingMore=!1}function D(r){var n=r._readableState;n.readableListening=r.listenerCount("readable")>0,n.resumeScheduled&&!n.paused?n.flowing=!0:r.listenerCount("data")>0&&r.resume()}function R(r){s("readable nexttick read 0"),r.read(0)}function F(r,n){s("resume",n.reading),n.reading||r.read(0),n.resumeScheduled=!1,r.emit("resume"),B(r),n.flowing&&!n.reading&&r.read(0)}function B(r){var n=r._readableState;for(s("flow",n.flowing);n.flowing&&null!==r.read(););}function N(r,n){var i;return 0===n.length?null:(n.objectMode?i=n.buffer.shift():!r||r>=n.length?(i=n.decoder?n.buffer.join(""):1===n.buffer.length?n.buffer.first():n.buffer.concat(n.length),n.buffer.clear()):i=n.buffer.consume(r,n.decoder),i)}function j(r){var n=r._readableState;s("endReadable",n.endEmitted),n.endEmitted||(n.ended=!0,i.nextTick(U,n,r))}function U(r,n){if(s("endReadableNT",r.endEmitted,r.length),!r.endEmitted&&0===r.length&&(r.endEmitted=!0,n.readable=!1,n.emit("end"),r.autoDestroy)){var i=n._writableState;(!i||i.autoDestroy&&i.finished)&&n.destroy()}}function V(r,n){for(var i=0,a=r.length;i<a;i++)if(r[i]===n)return i;return -1}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(r){this._readableState&&(this._readableState.destroyed=r)}}),S.prototype.destroy=v.destroy,S.prototype._undestroy=v.undestroy,S.prototype._destroy=function(r,n){n(r)},S.prototype.push=function(r,n){var i,a=this._readableState;return a.objectMode?i=!0:"string"==typeof r&&((n=n||a.defaultEncoding)!==a.encoding&&(r=u.from(r,n),n=""),i=!0),E(this,r,n,!1,i)},S.prototype.unshift=function(r){return E(this,r,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(n){p||(p=r("string_decoder/").StringDecoder);var i=new p(n);this._readableState.decoder=i,this._readableState.encoding=this._readableState.decoder.encoding;for(var a=this._readableState.buffer.head,o="";null!==a;)o+=i.write(a.data),a=a.next;return this._readableState.buffer.clear(),""!==o&&this._readableState.buffer.push(o),this._readableState.length=o.length,this},S.prototype.read=function(r){s("read",r),r=parseInt(r,10);var n=this._readableState,i=r;if(0!==r&&(n.emittedReadable=!1),0===r&&n.needReadable&&((0!==n.highWaterMark?n.length>=n.highWaterMark:n.length>0)||n.ended))return s("read: emitReadable",n.length,n.ended),0===n.length&&n.ended?j(this):P(this),null;if(0===(r=C(r,n))&&n.ended)return 0===n.length&&j(this),null;var a,o=n.needReadable;return s("need readable",o),(0===n.length||n.length-r<n.highWaterMark)&&s("length less than watermark",o=!0),n.ended||n.reading?s("reading or ended",o=!1):o&&(s("do read"),n.reading=!0,n.sync=!0,0===n.length&&(n.needReadable=!0),this._read(n.highWaterMark),n.sync=!1,n.reading||(r=C(i,n))),null===(a=r>0?N(r,n):null)?(n.needReadable=n.length<=n.highWaterMark,r=0):(n.length-=r,n.awaitDrain=0),0===n.length&&(n.ended||(n.needReadable=!0),i!==r&&n.ended&&j(this)),null!==a&&this.emit("data",a),a},S.prototype._read=function(r){k(this,new w("_read()"))},S.prototype.pipe=function(r,n){var a=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=r;break;case 1:o.pipes=[o.pipes,r];break;default:o.pipes.push(r)}o.pipesCount+=1,s("pipe count=%d opts=%j",o.pipesCount,n);var c=n&&!1===n.end||r===i.stdout||r===i.stderr?v:u;function u(){s("onend"),r.end()}o.endEmitted?i.nextTick(c):a.once("end",c),r.on("unpipe",function n(i,l){s("onunpipe"),i===a&&l&&!1===l.hasUnpiped&&(l.hasUnpiped=!0,s("cleanup"),r.removeListener("close",m),r.removeListener("finish",g),r.removeListener("drain",f),r.removeListener("error",d),r.removeListener("unpipe",n),a.removeListener("end",u),a.removeListener("end",v),a.removeListener("data",p),h=!0,o.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&f())});var f=function(){var r=a._readableState;s("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,0===r.awaitDrain&&l(a,"data")&&(r.flowing=!0,B(a))};r.on("drain",f);var h=!1;function p(n){s("ondata");var i=r.write(n);s("dest.write",i),!1===i&&((1===o.pipesCount&&o.pipes===r||o.pipesCount>1&&-1!==V(o.pipes,r))&&!h&&(s("false write response, pause",o.awaitDrain),o.awaitDrain++),a.pause())}function d(n){s("onerror",n),v(),r.removeListener("error",d),0===l(r,"error")&&k(r,n)}function m(){r.removeListener("finish",g),v()}function g(){s("onfinish"),r.removeListener("close",m),v()}function v(){s("unpipe"),a.unpipe(r)}return a.on("data",p),function(r,n,i){if("function"==typeof r.prependListener)return r.prependListener(n,i);r._events&&r._events[n]?Array.isArray(r._events[n])?r._events[n].unshift(i):r._events[n]=[i,r._events[n]]:r.on(n,i)}(r,"error",d),r.once("close",m),r.once("finish",g),r.emit("pipe",a),o.flowing||(s("pipe resume"),a.resume()),r},S.prototype.unpipe=function(r){var n=this._readableState,i={hasUnpiped:!1};if(0===n.pipesCount)return this;if(1===n.pipesCount)return r&&r!==n.pipes||(r||(r=n.pipes),n.pipes=null,n.pipesCount=0,n.flowing=!1,r&&r.emit("unpipe",this,i)),this;if(!r){var a=n.pipes,o=n.pipesCount;n.pipes=null,n.pipesCount=0,n.flowing=!1;for(var s=0;s<o;s++)a[s].emit("unpipe",this,{hasUnpiped:!1});return this}var l=V(n.pipes,r);return -1===l||(n.pipes.splice(l,1),n.pipesCount-=1,1===n.pipesCount&&(n.pipes=n.pipes[0]),r.emit("unpipe",this,i)),this},S.prototype.on=function(r,n){var a=c.prototype.on.call(this,r,n),o=this._readableState;return"data"===r?(o.readableListening=this.listenerCount("readable")>0,!1!==o.flowing&&this.resume()):"readable"===r&&(o.endEmitted||o.readableListening||(o.readableListening=o.needReadable=!0,o.flowing=!1,o.emittedReadable=!1,s("on readable",o.length,o.reading),o.length?P(this):o.reading||i.nextTick(R,this))),a},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(r,n){var a=c.prototype.removeListener.call(this,r,n);return"readable"===r&&i.nextTick(D,this),a},S.prototype.removeAllListeners=function(r){var n=c.prototype.removeAllListeners.apply(this,arguments);return"readable"!==r&&void 0!==r||i.nextTick(D,this),n},S.prototype.resume=function(){var r=this._readableState;return r.flowing||(s("resume"),r.flowing=!r.readableListening,r.resumeScheduled||(r.resumeScheduled=!0,i.nextTick(F,this,r))),r.paused=!1,this},S.prototype.pause=function(){return s("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(s("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(r){var n=this,i=this._readableState,a=!1;for(var o in r.on("end",function(){if(s("wrapped end"),i.decoder&&!i.ended){var r=i.decoder.end();r&&r.length&&n.push(r)}n.push(null)}),r.on("data",function(o){s("wrapped data"),i.decoder&&(o=i.decoder.write(o)),i.objectMode&&null==o||(i.objectMode||o&&o.length)&&(n.push(o)||(a=!0,r.pause()))}),r)void 0===this[o]&&"function"==typeof r[o]&&(this[o]=function(n){return function(){return r[n].apply(r,arguments)}}(o));for(var l=0;l<A.length;l++)r.on(A[l],this.emit.bind(this,A[l]));return this._read=function(n){s("wrapped _read",n),a&&(a=!1,r.resume())},this},"function"==typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=r("./internal/streams/async_iterator")),d(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(r){this._readableState&&(this._readableState.flowing=r)}}),S._fromList=N,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(S.from=function(n,i){return void 0===m&&(m=r("./internal/streams/from")),m(S,n,i)})}).call(this)}).call(this,r("_process"),void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":286,"./_stream_duplex":287,"./internal/streams/async_iterator":292,"./internal/streams/buffer_list":293,"./internal/streams/destroy":294,"./internal/streams/from":296,"./internal/streams/state":298,"./internal/streams/stream":299,_process:277,buffer:85,events:84,inherits:231,"string_decoder/":300,util:83}],290:[function(r,n,i){"use strict";n.exports=h;var a=r("../errors").codes,o=a.ERR_METHOD_NOT_IMPLEMENTED,s=a.ERR_MULTIPLE_CALLBACK,l=a.ERR_TRANSFORM_ALREADY_TRANSFORMING,c=a.ERR_TRANSFORM_WITH_LENGTH_0,u=r("./_stream_duplex");function f(r,n){var i=this._transformState;i.transforming=!1;var a=i.writecb;if(null===a)return this.emit("error",new s);i.writechunk=null,i.writecb=null,null!=n&&this.push(n),a(r);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function h(r){if(!(this instanceof h))return new h(r);u.call(this,r),this._transformState={afterTransform:f.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",p)}function p(){var r=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush(function(n,i){d(r,n,i)})}function d(r,n,i){if(n)return r.emit("error",n);if(null!=i&&r.push(i),r._writableState.length)throw new c;if(r._transformState.transforming)throw new l;return r.push(null)}r("inherits")(h,u),h.prototype.push=function(r,n){return this._transformState.needTransform=!1,u.prototype.push.call(this,r,n)},h.prototype._transform=function(r,n,i){i(new o("_transform()"))},h.prototype._write=function(r,n,i){var a=this._transformState;if(a.writecb=i,a.writechunk=r,a.writeencoding=n,!a.transforming){var o=this._readableState;(a.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},h.prototype._read=function(r){var n=this._transformState;null===n.writechunk||n.transforming?n.needTransform=!0:(n.transforming=!0,this._transform(n.writechunk,n.writeencoding,n.afterTransform))},h.prototype._destroy=function(r,n){u.prototype._destroy.call(this,r,function(r){n(r)})}},{"../errors":286,"./_stream_duplex":287,inherits:231}],291:[function(r,n,a){(function(i,a){(function(){"use strict";function o(r){var n=this;this.next=null,this.entry=null,this.finish=function(){!function(r,n,i){var a=r.entry;for(r.entry=null;a;){var o=a.callback;n.pendingcb--,o(void 0),a=a.next}n.corkedRequestsFree.next=r}(n,r)}}n.exports=S,S.WritableState=M;var s,l,c={deprecate:r("util-deprecate")},u=r("./internal/streams/stream"),f=r("buffer").Buffer,h=a.Uint8Array||function(){},p=r("./internal/streams/destroy"),d=r("./internal/streams/state").getHighWaterMark,m=r("../errors").codes,g=m.ERR_INVALID_ARG_TYPE,v=m.ERR_METHOD_NOT_IMPLEMENTED,y=m.ERR_MULTIPLE_CALLBACK,x=m.ERR_STREAM_CANNOT_PIPE,b=m.ERR_STREAM_DESTROYED,_=m.ERR_STREAM_NULL_VALUES,w=m.ERR_STREAM_WRITE_AFTER_END,T=m.ERR_UNKNOWN_ENCODING,k=p.errorOrDestroy;function A(){}function M(n,a,l){s=s||r("./_stream_duplex"),n=n||{},"boolean"!=typeof l&&(l=a instanceof s),this.objectMode=!!n.objectMode,l&&(this.objectMode=this.objectMode||!!n.writableObjectMode),this.highWaterMark=d(this,n,"writableHighWaterMark",l),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===n.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=n.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(r){!function(r,n){var a=r._writableState,o=a.sync,s=a.writecb;if("function"!=typeof s)throw new y;if(a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0,n)--a.pendingcb,o?(i.nextTick(s,n),i.nextTick(O,r,a),r._writableState.errorEmitted=!0,k(r,n)):(s(n),r._writableState.errorEmitted=!0,k(r,n),O(r,a));else{var l=P(a)||r.destroyed;l||a.corked||a.bufferProcessing||!a.bufferedRequest||C(r,a),o?i.nextTick(L,r,a,l,s):L(r,a,l,s)}}(a,r)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==n.emitClose,this.autoDestroy=!!n.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function S(n){var i=this instanceof(s=s||r("./_stream_duplex"));if(!i&&!l.call(S,this))return new S(n);this._writableState=new M(n,this,i),this.writable=!0,n&&("function"==typeof n.write&&(this._write=n.write),"function"==typeof n.writev&&(this._writev=n.writev),"function"==typeof n.destroy&&(this._destroy=n.destroy),"function"==typeof n.final&&(this._final=n.final)),u.call(this)}function E(r,n,i,a,o,s,l){n.writelen=a,n.writecb=l,n.writing=!0,n.sync=!0,n.destroyed?n.onwrite(new b("write")):i?r._writev(o,n.onwrite):r._write(o,s,n.onwrite),n.sync=!1}function L(r,n,i,a){i||0===n.length&&n.needDrain&&(n.needDrain=!1,r.emit("drain")),n.pendingcb--,a(),O(r,n)}function C(r,n){n.bufferProcessing=!0;var i=n.bufferedRequest;if(r._writev&&i&&i.next){var a=Array(n.bufferedRequestCount),s=n.corkedRequestsFree;s.entry=i;for(var l=0,c=!0;i;)a[l]=i,i.isBuf||(c=!1),i=i.next,l+=1;a.allBuffers=c,E(r,n,!0,n.length,a,"",s.finish),n.pendingcb++,n.lastBufferedRequest=null,s.next?(n.corkedRequestsFree=s.next,s.next=null):n.corkedRequestsFree=new o(n),n.bufferedRequestCount=0}else{for(;i;){var u=i.chunk,f=i.encoding,h=i.callback;if(E(r,n,!1,n.objectMode?1:u.length,u,f,h),i=i.next,n.bufferedRequestCount--,n.writing)break}null===i&&(n.lastBufferedRequest=null)}n.bufferedRequest=i,n.bufferProcessing=!1}function P(r){return r.ending&&0===r.length&&null===r.bufferedRequest&&!r.finished&&!r.writing}function I(r,n){r._final(function(i){n.pendingcb--,i&&k(r,i),n.prefinished=!0,r.emit("prefinish"),O(r,n)})}function O(r,n){var a=P(n);if(a&&(n.prefinished||n.finalCalled||("function"!=typeof r._final||n.destroyed?(n.prefinished=!0,r.emit("prefinish")):(n.pendingcb++,n.finalCalled=!0,i.nextTick(I,r,n))),0===n.pendingcb&&(n.finished=!0,r.emit("finish"),n.autoDestroy))){var o=r._readableState;(!o||o.autoDestroy&&o.endEmitted)&&r.destroy()}return a}r("inherits")(S,u),M.prototype.getBuffer=function(){for(var r=this.bufferedRequest,n=[];r;)n.push(r),r=r.next;return n},function(){try{Object.defineProperty(M.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(r){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(r){return!!l.call(this,r)||this===S&&r&&r._writableState instanceof M}})):l=function(r){return r instanceof this},S.prototype.pipe=function(){k(this,new x)},S.prototype.write=function(r,n,a){var o,s,l,c,u,p,d,m=this._writableState,v=!1,y=!m.objectMode&&(d=r,f.isBuffer(d)||d instanceof h);return y&&!f.isBuffer(r)&&(o=r,r=f.from(o)),"function"==typeof n&&(a=n,n=null),y?n="buffer":n||(n=m.defaultEncoding),"function"!=typeof a&&(a=A),m.ending?(s=a,k(this,l=new w),i.nextTick(s,l)):!y&&(c=r,u=a,null===c?p=new _:"string"==typeof c||m.objectMode||(p=new g("chunk",["string","Buffer"],c)),p&&(k(this,p),i.nextTick(u,p),1))||(m.pendingcb++,v=function(r,n,i,a,o,s){if(!i){var l,c,u=(l=a,c=o,n.objectMode||!1===n.decodeStrings||"string"!=typeof l||(l=f.from(l,c)),l);a!==u&&(i=!0,o="buffer",a=u)}var h=n.objectMode?1:a.length;n.length+=h;var p=n.length<n.highWaterMark;if(p||(n.needDrain=!0),n.writing||n.corked){var d=n.lastBufferedRequest;n.lastBufferedRequest={chunk:a,encoding:o,isBuf:i,callback:s,next:null},d?d.next=n.lastBufferedRequest:n.bufferedRequest=n.lastBufferedRequest,n.bufferedRequestCount+=1}else E(r,n,!1,h,a,o,s);return p}(this,m,y,r,n,a)),v},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,r.writing||r.corked||r.bufferProcessing||!r.bufferedRequest||C(this,r))},S.prototype.setDefaultEncoding=function(r){if("string"==typeof r&&(r=r.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((r+"").toLowerCase())>-1))throw new T(r);return this._writableState.defaultEncoding=r,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(r,n,i){i(new v("_write()"))},S.prototype._writev=null,S.prototype.end=function(r,n,a){var o,s=this._writableState;return"function"==typeof r?(a=r,r=null,n=null):"function"==typeof n&&(a=n,n=null),null!=r&&this.write(r,n),s.corked&&(s.corked=1,this.uncork()),s.ending||(o=a,s.ending=!0,O(this,s),o&&(s.finished?i.nextTick(o):this.once("finish",o)),s.ended=!0,this.writable=!1),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(r){this._writableState&&(this._writableState.destroyed=r)}}),S.prototype.destroy=p.destroy,S.prototype._undestroy=p.undestroy,S.prototype._destroy=function(r,n){n(r)}}).call(this)}).call(this,r("_process"),void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":286,"./_stream_duplex":287,"./internal/streams/destroy":294,"./internal/streams/state":298,"./internal/streams/stream":299,_process:277,buffer:85,inherits:231,"util-deprecate":330}],292:[function(r,n,i){(function(i){(function(){"use strict";function a(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}var o,s=r("./end-of-stream"),l=Symbol("lastResolve"),c=Symbol("lastReject"),u=Symbol("error"),f=Symbol("ended"),h=Symbol("lastPromise"),p=Symbol("handlePromise"),d=Symbol("stream");function m(r,n){return{value:r,done:n}}function g(r){var n=r[l];if(null!==n){var i=r[d].read();null!==i&&(r[h]=null,r[l]=null,r[c]=null,n(m(i,!1)))}}function v(r){i.nextTick(g,r)}var y=Object.getPrototypeOf(function(){}),x=Object.setPrototypeOf((a(o={get stream(){return this[d]},next:function(){var r,n=this,a=this[u];if(null!==a)return Promise.reject(a);if(this[f])return Promise.resolve(m(void 0,!0));if(this[d].destroyed)return new Promise(function(r,a){i.nextTick(function(){n[u]?a(n[u]):r(m(void 0,!0))})});var o,s=this[h];if(s)o=new Promise((r=this,function(n,i){s.then(function(){r[f]?n(m(void 0,!0)):r[p](n,i)},i)}));else{var l=this[d].read();if(null!==l)return Promise.resolve(m(l,!1));o=new Promise(this[p])}return this[h]=o,o}},Symbol.asyncIterator,function(){return this}),a(o,"return",function(){var r=this;return new Promise(function(n,i){r[d].destroy(null,function(r){r?i(r):n(m(void 0,!0))})})}),o),y);n.exports=function(r){var n,i=Object.create(x,(a(n={},d,{value:r,writable:!0}),a(n,l,{value:null,writable:!0}),a(n,c,{value:null,writable:!0}),a(n,u,{value:null,writable:!0}),a(n,f,{value:r._readableState.endEmitted,writable:!0}),a(n,p,{value:function(r,n){var a=i[d].read();a?(i[h]=null,i[l]=null,i[c]=null,r(m(a,!1))):(i[l]=r,i[c]=n)},writable:!0}),n));return i[h]=null,s(r,function(r){if(r&&"ERR_STREAM_PREMATURE_CLOSE"!==r.code){var n=i[c];return null!==n&&(i[h]=null,i[l]=null,i[c]=null,n(r)),void(i[u]=r)}var a=i[l];null!==a&&(i[h]=null,i[l]=null,i[c]=null,a(m(void 0,!0))),i[f]=!0}),r.on("readable",v.bind(null,i)),i}}).call(this)}).call(this,r("_process"))},{"./end-of-stream":295,_process:277}],293:[function(r,n,i){"use strict";function a(r,n){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),i.push.apply(i,a)}return i}function o(r,n){for(var i=0;i<n.length;i++){var a=n[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,a.key,a)}}var s=r("buffer").Buffer,l=r("util").inspect,c=l&&l.custom||"inspect";n.exports=function(){var r,n;function i(){(function(r,n){if(!(r instanceof n))throw TypeError("Cannot call a class as a function")})(this,i),this.head=null,this.tail=null,this.length=0}return r=[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};0===this.length&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(0!==this.length){var r=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(0===this.length)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(0===this.length)return s.alloc(0);for(var n,i,a=s.allocUnsafe(r>>>0),o=this.head,l=0;o;)n=o.data,i=l,s.prototype.copy.call(n,a,i),l+=o.data.length,o=o.next;return a}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):i=r===this.head.data.length?this.shift():n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,a=n.data;for(r-=a.length;n=n.next;){var o=n.data,s=r>o.length?o.length:r;if(s===o.length?a+=o:a+=o.slice(0,r),0==(r-=s)){s===o.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(s));break}++i}return this.length-=i,a}},{key:"_getBuffer",value:function(r){var n=s.allocUnsafe(r),i=this.head,a=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var o=i.data,l=r>o.length?o.length:r;if(o.copy(n,n.length-r,0,l),0==(r-=l)){l===o.length?(++a,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(l));break}++a}return this.length-=a,n}},{key:c,value:function(r,n){return l(this,function(r){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?a(Object(i),!0).forEach(function(n){var a;a=i[n],n in r?Object.defineProperty(r,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[n]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(i,n))})}return r}({},n,{depth:0,customInspect:!1}))}}],o(i.prototype,r),n&&o(i,n),i}()},{buffer:85,util:83}],294:[function(r,n,i){(function(r){(function(){"use strict";function i(r,n){o(r,n),a(r)}function a(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function o(r,n){r.emit("error",n)}n.exports={destroy:function(n,s){var l=this,c=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return c||u?s?s(n):n&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(o,this,n)):r.nextTick(o,this,n)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(n||null,function(n){!s&&n?l._writableState?l._writableState.errorEmitted?r.nextTick(a,l):(l._writableState.errorEmitted=!0,r.nextTick(i,l,n)):r.nextTick(i,l,n):s?(r.nextTick(a,l),s(n)):r.nextTick(a,l)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(r,n){var i=r._readableState,a=r._writableState;i&&i.autoDestroy||a&&a.autoDestroy?r.destroy(n):r.emit("error",n)}}}).call(this)}).call(this,r("_process"))},{_process:277}],295:[function(r,n,i){"use strict";var a=r("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function o(){}n.exports=function r(n,i,s){if("function"==typeof i)return r(n,null,i);i||(i={}),l=s||o,c=!1,s=function(){if(!c){c=!0;for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];l.apply(this,n)}};var l,c,u=i.readable||!1!==i.readable&&n.readable,f=i.writable||!1!==i.writable&&n.writable,h=function(){n.writable||d()},p=n._writableState&&n._writableState.finished,d=function(){f=!1,p=!0,u||s.call(n)},m=n._readableState&&n._readableState.endEmitted,g=function(){u=!1,m=!0,f||s.call(n)},v=function(r){s.call(n,r)},y=function(){var r;return u&&!m?(n._readableState&&n._readableState.ended||(r=new a),s.call(n,r)):f&&!p?(n._writableState&&n._writableState.ended||(r=new a),s.call(n,r)):void 0},x=function(){n.req.on("finish",d)};return n.setHeader&&"function"==typeof n.abort?(n.on("complete",d),n.on("abort",y),n.req?x():n.on("request",x)):f&&!n._writableState&&(n.on("end",h),n.on("close",h)),n.on("end",g),n.on("finish",d),!1!==i.error&&n.on("error",v),n.on("close",y),function(){n.removeListener("complete",d),n.removeListener("abort",y),n.removeListener("request",x),n.req&&n.req.removeListener("finish",d),n.removeListener("end",h),n.removeListener("close",h),n.removeListener("finish",d),n.removeListener("end",g),n.removeListener("error",v),n.removeListener("close",y)}}},{"../../../errors":286}],296:[function(r,n,i){n.exports=function(){throw Error("Readable.from is not available in the browser")}},{}],297:[function(r,n,i){"use strict";var a,o=r("../../../errors").codes,s=o.ERR_MISSING_ARGS,l=o.ERR_STREAM_DESTROYED;function c(r){if(r)throw r}function u(r){r()}function f(r,n){return r.pipe(n)}n.exports=function(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];var h,p,d=(h=i).length?"function"!=typeof h[h.length-1]?c:h.pop():c;if(Array.isArray(i[0])&&(i=i[0]),i.length<2)throw new s("streams");var m=i.map(function(n,o){var s,c,f,h,g,v=o<i.length-1;return c=s=function(r){p||(p=r),r&&m.forEach(u),v||(m.forEach(u),d(p))},f=!1,s=function(){f||(f=!0,c.apply(void 0,arguments))},h=!1,n.on("close",function(){h=!0}),void 0===a&&(a=r("./end-of-stream")),a(n,{readable:v,writable:o>0},function(r){if(r)return s(r);h=!0,s()}),g=!1,function(r){if(!h&&!g)return g=!0,n.setHeader&&"function"==typeof n.abort?n.abort():"function"==typeof n.destroy?n.destroy():void s(r||new l("pipe"))}});return i.reduce(f)}},{"../../../errors":286,"./end-of-stream":295}],298:[function(r,n,i){"use strict";var a=r("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(r,n,i,o){var s=null!=n.highWaterMark?n.highWaterMark:o?n[i]:null;if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new a(o?i:"highWaterMark",s);return Math.floor(s)}return r.objectMode?16:16384}}},{"../../../errors":286}],299:[function(r,n,i){n.exports=r("events").EventEmitter},{events:84}],300:[function(r,n,i){"use strict";var a=r("safe-buffer").Buffer,o=a.isEncoding||function(r){switch((r=""+r)&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(r){var n;switch(this.encoding=function(r){var n=function(r){if(!r)return"utf8";for(var n;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(n)return;r=(""+r).toLowerCase(),n=!0}}(r);if("string"!=typeof n&&(a.isEncoding===o||!o(r)))throw Error("Unknown encoding: "+r);return n||r}(r),this.encoding){case"utf16le":this.text=u,this.end=f,n=4;break;case"utf8":this.fillLast=c,n=4;break;case"base64":this.text=h,this.end=p,n=3;break;default:return this.write=d,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=a.allocUnsafe(n)}function l(r){return r<=127?0:r>>5==6?2:r>>4==14?3:r>>3==30?4:r>>6==2?-1:-2}function c(r){var n=this.lastTotal-this.lastNeed,i=function(r,n,i){if(128!=(192&n[0]))return r.lastNeed=0,"";if(r.lastNeed>1&&n.length>1){if(128!=(192&n[1]))return r.lastNeed=1,"";if(r.lastNeed>2&&n.length>2&&128!=(192&n[2]))return r.lastNeed=2,""}}(this,r);return void 0!==i?i:this.lastNeed<=r.length?(r.copy(this.lastChar,n,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(r.copy(this.lastChar,n,0,r.length),void(this.lastNeed-=r.length))}function u(r,n){if((r.length-n)%2==0){var i=r.toString("utf16le",n);if(i){var a=i.charCodeAt(i.length-1);if(a>=55296&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",n,r.length-1)}function f(r){var n=r&&r.length?this.write(r):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return n+this.lastChar.toString("utf16le",0,i)}return n}function h(r,n){var i=(r.length-n)%3;return 0===i?r.toString("base64",n):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",n,r.length-i))}function p(r){var n=r&&r.length?this.write(r):"";return this.lastNeed?n+this.lastChar.toString("base64",0,3-this.lastNeed):n}function d(r){return r.toString(this.encoding)}function m(r){return r&&r.length?this.write(r):""}i.StringDecoder=s,s.prototype.write=function(r){var n,i;if(0===r.length)return"";if(this.lastNeed){if(void 0===(n=this.fillLast(r)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<r.length?n?n+this.text(r,i):this.text(r,i):n||""},s.prototype.end=function(r){var n=r&&r.length?this.write(r):"";return this.lastNeed?n+"":n},s.prototype.text=function(r,n){var i=function(r,n,i){var a=n.length-1;if(a<i)return 0;var o=l(n[a]);return o>=0?(o>0&&(r.lastNeed=o-1),o):--a<i||-2===o?0:(o=l(n[a]))>=0?(o>0&&(r.lastNeed=o-2),o):--a<i||-2===o?0:(o=l(n[a]))>=0?(o>0&&(2===o?o=0:r.lastNeed=o-3),o):0}(this,r,n);if(!this.lastNeed)return r.toString("utf8",n);this.lastTotal=i;var a=r.length-(i-this.lastNeed);return r.copy(this.lastChar,0,a),r.toString("utf8",n,a)},s.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length}},{"safe-buffer":284}],301:[function(r,n,i){(function(i,a){(function(){var i=r("assert"),o=r("debug")("stream-parser");function s(r){o("initializing parser stream"),r._parserBytesLeft=0,r._parserBuffers=[],r._parserBuffered=0,r._parserState=-1,r._parserCallback=null,"function"==typeof r.push&&(r._parserOutput=r.push.bind(r)),r._parserInit=!0}function l(r,n){i(!this._parserCallback,'there is already a "callback" set!'),i(isFinite(r)&&r>0,'can only buffer a finite number of bytes > 0, got "'+r+'"'),this._parserInit||s(this),o("buffering %o bytes",r),this._parserBytesLeft=r,this._parserCallback=n,this._parserState=0}function c(r,n){i(!this._parserCallback,'there is already a "callback" set!'),i(r>0,'can only skip > 0 bytes, got "'+r+'"'),this._parserInit||s(this),o("skipping %o bytes",r),this._parserBytesLeft=r,this._parserCallback=n,this._parserState=1}function u(r,n){i(!this._parserCallback,'There is already a "callback" set!'),i(r>0,'can only pass through > 0 bytes, got "'+r+'"'),this._parserInit||s(this),o("passing through %o bytes",r),this._parserBytesLeft=r,this._parserCallback=n,this._parserState=2}function f(r,n,i){this._parserInit||s(this),o("write(%o bytes)",r.length),"function"==typeof n&&(i=n),d(this,r,null,i)}function h(r,n,i){this._parserInit||s(this),o("transform(%o bytes)",r.length),"function"!=typeof n&&(n=this._parserOutput),d(this,r,n,i)}function p(r,n,i,s){if(r._parserBytesLeft-=n.length,o("%o bytes left for stream piece",r._parserBytesLeft),0===r._parserState?(r._parserBuffers.push(n),r._parserBuffered+=n.length):2===r._parserState&&i(n),0!==r._parserBytesLeft)return s;var l=r._parserCallback;if(l&&0===r._parserState&&r._parserBuffers.length>1&&(n=a.concat(r._parserBuffers,r._parserBuffered)),0!==r._parserState&&(n=null),r._parserCallback=null,r._parserBuffered=0,r._parserState=-1,r._parserBuffers.splice(0),l){var c=[];n&&c.push(n),i&&c.push(i);var u=l.length>c.length;u&&c.push(m(s));var f=l.apply(r,c);if(!u||s===f)return s}}n.exports=function(r){var n=r&&"function"==typeof r._transform,i=r&&"function"==typeof r._write;if(!n&&!i)throw Error("must pass a Writable or Transform stream in");o("extending Parser into stream"),r._bytes=l,r._skipBytes=c,n&&(r._passthrough=u),n?r._transform=h:r._write=f};var d=m(function r(n,i,a,o){return n._parserBytesLeft<=0?o(Error("got data but not currently parsing anything")):i.length<=n._parserBytesLeft?function(){return p(n,i,a,o)}:function(){var s=i.slice(0,n._parserBytesLeft);return p(n,s,a,function(l){return l?o(l):i.length>s.length?function(){return r(n,i.slice(s.length),a,o)}:void 0})}});function m(r){return function(){for(var n=r.apply(this,arguments);"function"==typeof n;)n=n();return n}}}).call(this)}).call(this,r("_process"),r("buffer").Buffer)},{_process:277,assert:75,buffer:85,debug:302}],302:[function(r,n,i){(function(a){(function(){function o(){var r;try{r=i.storage.debug}catch(r){}return!r&&void 0!==a&&"env"in a&&(r=a.env.DEBUG),r}(i=n.exports=r("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},i.formatArgs=function(r){var n=this.useColors;if(r[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+r[0]+(n?"%c ":" ")+"+"+i.humanize(this.diff),n){var a="color: "+this.color;r.splice(1,0,a,"color: inherit");var o=0,s=0;r[0].replace(/%[a-zA-Z%]/g,function(r){"%%"!==r&&(o++,"%c"===r&&(s=o))}),r.splice(s,0,a)}},i.save=function(r){try{null==r?i.storage.removeItem("debug"):i.storage.debug=r}catch(r){}},i.load=o,i.useColors=function(){return"undefined"!=typeof window&&!!window.process&&"renderer"===window.process.type||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},i.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(r){}}(),i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],i.formatters.j=function(r){try{return JSON.stringify(r)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}},i.enable(o())}).call(this)}).call(this,r("_process"))},{"./debug":303,_process:277}],303:[function(r,n,i){var a;function o(r){function n(){if(n.enabled){var r=+new Date,o=r-(a||r);n.diff=o,n.prev=a,n.curr=r,a=r;for(var s=Array(arguments.length),l=0;l<s.length;l++)s[l]=arguments[l];s[0]=i.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(r,a){if("%%"===r)return r;c++;var o=i.formatters[a];if("function"==typeof o){var l=s[c];r=o.call(n,l),s.splice(c,1),c--}return r}),i.formatArgs.call(n,s),(n.log||i.log||console.log.bind(console)).apply(n,s)}}return n.namespace=r,n.enabled=i.enabled(r),n.useColors=i.useColors(),n.color=function(r){var n,a=0;for(n in r)a=(a<<5)-a+r.charCodeAt(n)|0;return i.colors[Math.abs(a)%i.colors.length]}(r),"function"==typeof i.init&&i.init(n),n}(i=n.exports=o.debug=o.default=o).coerce=function(r){return r instanceof Error?r.stack||r.message:r},i.disable=function(){i.enable("")},i.enable=function(r){i.save(r),i.names=[],i.skips=[];for(var n=("string"==typeof r?r:"").split(/[\s,]+/),a=n.length,o=0;o<a;o++)n[o]&&("-"===(r=n[o].replace(/\*/g,".*?"))[0]?i.skips.push(RegExp("^"+r.substr(1)+"$")):i.names.push(RegExp("^"+r+"$")))},i.enabled=function(r){var n,a;for(n=0,a=i.skips.length;n<a;n++)if(i.skips[n].test(r))return!1;for(n=0,a=i.names.length;n<a;n++)if(i.names[n].test(r))return!0;return!1},i.humanize=r("ms"),i.names=[],i.skips=[],i.formatters={}},{ms:304}],304:[function(r,n,i){function a(r,n,i){if(!(r<n))return r<1.5*n?Math.floor(r/n)+" "+i:Math.ceil(r/n)+" "+i+"s"}n.exports=function(r,n){n=n||{};var i=typeof r;if("string"===i&&r.length>0)return function(r){if(!((r=String(r)).length>100)){var n=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(r);if(n){var i=parseFloat(n[1]);switch((n[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*i;case"days":case"day":case"d":return 864e5*i;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*i;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*i;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(r);if("number"===i&&!1===isNaN(r))return n.long?a(r,864e5,"day")||a(r,36e5,"hour")||a(r,6e4,"minute")||a(r,1e3,"second")||r+" ms":r>=864e5?Math.round(r/864e5)+"d":r>=36e5?Math.round(r/36e5)+"h":r>=6e4?Math.round(r/6e4)+"m":r>=1e3?Math.round(r/1e3)+"s":r+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))}},{}],305:[function(r,n,i){"use strict";var a=r("parenthesis");n.exports=function(r,n,i){if(null==r)throw Error("First argument should be a string");if(null==n)throw Error("Separator should be a string or a RegExp");i?("string"==typeof i||Array.isArray(i))&&(i={ignore:i}):i={},null==i.escape&&(i.escape=!0),null==i.ignore?i.ignore=["[]","()","{}","<>",'""',"''","``","","\xab\xbb"]:("string"==typeof i.ignore&&(i.ignore=[i.ignore]),i.ignore=i.ignore.map(function(r){return 1===r.length&&(r+=r),r}));var o=a.parse(r,{flat:!0,brackets:i.ignore}),s=o[0].split(n);if(i.escape){for(var l=[],c=0;c<s.length;c++){var u=s[c],f=s[c+1];"\\"===u[u.length-1]&&"\\"!==u[u.length-2]?(l.push(u+n+f),c++):l.push(u)}s=l}for(c=0;c<s.length;c++)o[0]=s[c],s[c]=a.stringify(o,{flat:!0});return s}},{parenthesis:248}],306:[function(r,n,i){"use strict";n.exports=function(r){for(var n=r.length,i=Array(n),a=Array(n),o=Array(n),s=Array(n),l=Array(n),c=Array(n),u=0;u<n;++u)i[u]=-1,a[u]=0,o[u]=!1,s[u]=0,l[u]=-1,c[u]=[];var f,h=0,p=[],d=[];for(u=0;u<n;++u)i[u]<0&&function(n){var u=[n],f=[n];for(i[n]=a[n]=h,o[n]=!0,h+=1;f.length>0;){var m=r[n=f[f.length-1]];if(s[n]<m.length){for(var g=s[n];g<m.length;++g){var v=m[g];if(i[v]<0){i[v]=a[v]=h,o[v]=!0,h+=1,u.push(v),f.push(v);break}o[v]&&(a[n]=0|Math.min(a[n],a[v])),l[v]>=0&&c[n].push(l[v])}s[n]=g}else{if(a[n]===i[n]){var y=[],x=[],b=0;for(g=u.length-1;g>=0;--g){var _=u[g];if(o[_]=!1,y.push(_),x.push(c[_]),b+=c[_].length,l[_]=p.length,_===n){u.length=g;break}}p.push(y);var w=Array(b);for(g=0;g<x.length;g++)for(var T=0;T<x[g].length;T++)w[--b]=x[g][T];d.push(w)}f.pop()}}}(u);for(u=0;u<d.length;u++){var m=d[u];if(0!==m.length){m.sort(function(r,n){return r-n}),f=[m[0]];for(var g=1;g<m.length;g++)m[g]!==m[g-1]&&f.push(m[g]);d[u]=f}}return{components:p,adjacencyList:d}}},{}],307:[function(r,n,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=function(r,n){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,n){var i=[],a=!0,o=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(a=(l=c.next()).done)&&(i.push(l.value),!n||i.length!==n);a=!0);}catch(r){o=!0,s=r}finally{try{!a&&c.return&&c.return()}finally{if(o)throw s}}return i}(r,n);throw TypeError("Invalid attempt to destructure non-iterable instance")},o=2*Math.PI,s=function(r,n,i,a,o,s,l){var c=r.x,u=r.y;return{x:a*(c*=n)-o*(u*=i)+s,y:o*c+a*u+l}},l=function(r,n){var i=1.5707963267948966===n?.551915024494:-1.5707963267948966===n?-.551915024494:4/3*Math.tan(n/4),a=Math.cos(r),o=Math.sin(r),s=Math.cos(r+n),l=Math.sin(r+n);return[{x:a-o*i,y:o+a*i},{x:s+l*i,y:l-s*i},{x:s,y:l}]},c=function(r,n,i,a){var o=r*i+n*a;return o>1&&(o=1),o<-1&&(o=-1),(r*a-n*i<0?-1:1)*Math.acos(o)};i.default=function(r){var n,i,u,f,h,p,d,m,g,v,y,x,b,_,w=r.px,T=r.py,k=r.cx,A=r.cy,M=r.rx,S=r.ry,E=r.xAxisRotation,L=void 0===E?0:E,C=r.largeArcFlag,P=r.sweepFlag,I=[];if(0===M||0===S)return[];var O=Math.sin(L*o/360),z=Math.cos(L*o/360),D=z*(w-k)/2+O*(T-A)/2,R=-O*(w-k)/2+z*(T-A)/2;if(0===D&&0===R)return[];var F=Math.pow(D,2)/Math.pow(M=Math.abs(M),2)+Math.pow(R,2)/Math.pow(S=Math.abs(S),2);F>1&&(M*=Math.sqrt(F),S*=Math.sqrt(F));var B=a((n=M,i=S,u=void 0===P?0:P,f=Math.pow(n,2),h=Math.pow(i,2),p=Math.pow(D,2),(m=f*h-f*(d=Math.pow(R,2))-h*p)<0&&(m=0),m/=f*d+h*p,g=(m=Math.sqrt(m)*((void 0===C?0:C)===u?-1:1))*n/i*R,v=-(m*i)/n*D,b=c(1,0,y=(D-g)/n,x=(R-v)/i),_=c(y,x,(-D-g)/n,(-R-v)/i),0===u&&_>0&&(_-=o),1===u&&_<0&&(_+=o),[z*g-O*v+(w+k)/2,O*g+z*v+(T+A)/2,b,_]),4),N=B[0],j=B[1],U=B[2],V=B[3],H=Math.abs(V)/(o/4);1e-7>Math.abs(1-H)&&(H=1);var q=Math.max(Math.ceil(H),1);V/=q;for(var G=0;G<q;G++)I.push(l(U,V)),U+=V;return I.map(function(r){var n=s(r[0],M,S,z,O,N,j),i=n.x,a=n.y,o=s(r[1],M,S,z,O,N,j),l=o.x,c=o.y,u=s(r[2],M,S,z,O,N,j);return{x1:i,y1:a,x2:l,y2:c,x:u.x,y:u.y}})},n.exports=i.default},{}],308:[function(r,n,i){"use strict";var a=r("parse-svg-path"),o=r("abs-svg-path"),s=r("normalize-svg-path"),l=r("is-svg-path"),c=r("assert");n.exports=function(r){if(Array.isArray(r)&&1===r.length&&"string"==typeof r[0]&&(r=r[0]),"string"==typeof r&&(c(l(r),"String is not an SVG path."),r=a(r)),c(Array.isArray(r),"Argument should be a string or an array of path segments."),!(r=s(r=o(r))).length)return[0,0,0,0];for(var n=[1/0,1/0,-1/0,-1/0],i=0,u=r.length;i<u;i++)for(var f=r[i].slice(1),h=0;h<f.length;h+=2)f[h+0]<n[0]&&(n[0]=f[h+0]),f[h+1]<n[1]&&(n[1]=f[h+1]),f[h+0]>n[2]&&(n[2]=f[h+0]),f[h+1]>n[3]&&(n[3]=f[h+1]);return n}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":309,"parse-svg-path":250}],309:[function(r,n,i){"use strict";n.exports=function(r){for(var n,i=[],l=0,c=0,u=0,f=0,h=null,p=null,d=0,m=0,g=0,v=r.length;g<v;g++){var y=r[g],x=y[0];switch(x){case"M":u=y[1],f=y[2];break;case"A":var b=a({px:d,py:m,cx:y[6],cy:y[7],rx:y[1],ry:y[2],xAxisRotation:y[3],largeArcFlag:y[4],sweepFlag:y[5]});if(!b.length)continue;for(var _,w=0;w<b.length;w++)y=["C",(_=b[w]).x1,_.y1,_.x2,_.y2,_.x,_.y],w<b.length-1&&i.push(y);break;case"S":var T=d,k=m;"C"!=n&&"S"!=n||(T+=T-l,k+=k-c),y=["C",T,k,y[1],y[2],y[3],y[4]];break;case"T":"Q"==n||"T"==n?(h=2*d-h,p=2*m-p):(h=d,p=m),y=s(d,m,h,p,y[1],y[2]);break;case"Q":h=y[1],p=y[2],y=s(d,m,y[1],y[2],y[3],y[4]);break;case"L":y=o(d,m,y[1],y[2]);break;case"H":y=o(d,m,y[1],m);break;case"V":y=o(d,m,d,y[1]);break;case"Z":y=o(d,m,u,f)}n=x,d=y[y.length-2],m=y[y.length-1],y.length>4?(l=y[y.length-4],c=y[y.length-3]):(l=d,c=m),i.push(y)}return i};var a=r("svg-arc-to-cubic-bezier");function o(r,n,i,a){return["C",r,n,i,a,i,a]}function s(r,n,i,a,o,s){return["C",r/3+2/3*i,n/3+2/3*a,o/3+2/3*i,s/3+2/3*a,o,s]}},{"svg-arc-to-cubic-bezier":307}],310:[function(r,n,i){"use strict";var a,o=r("svg-path-bounds"),s=r("parse-svg-path"),l=r("draw-svg-path"),c=r("is-svg-path"),u=r("bitmap-sdf"),f=document.createElement("canvas"),h=f.getContext("2d");n.exports=function(r,n){if(!c(r))throw Error("Argument should be valid svg path string");n||(n={}),n.shape?(i=n.shape[0],p=n.shape[1]):(i=f.width=n.w||n.width||200,p=f.height=n.h||n.height||200);var i,p,d=Math.min(i,p),m=n.stroke||0,g=n.viewbox||n.viewBox||o(r),v=[i/(g[2]-g[0]),p/(g[3]-g[1])],y=Math.min(v[0]||0,v[1]||0)/2;if(h.fillStyle="black",h.fillRect(0,0,i,p),h.fillStyle="white",m&&("number"!=typeof m&&(m=1),h.strokeStyle=m>0?"white":"black",h.lineWidth=Math.abs(m)),h.translate(.5*i,.5*p),h.scale(y,y),function(){if(null!=a)return a;var r=document.createElement("canvas").getContext("2d");if(r.canvas.width=r.canvas.height=1,!window.Path2D)return a=!1;var n=new Path2D("M0,0h1v1h-1v-1Z");r.fillStyle="black",r.fill(n);var i=r.getImageData(0,0,1,1);return a=i&&i.data&&255===i.data[3]}()){var x=new Path2D(r);h.fill(x),m&&h.stroke(x)}else l(h,s(r)),h.fill(),m&&h.stroke();return h.setTransform(1,0,0,1,0,0),u(h,{cutoff:null!=n.cutoff?n.cutoff:.5,radius:null!=n.radius?n.radius:.5*d})}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":308}],311:[function(r,n,i){(function(n,a){(function(){var o=r("process/browser.js").nextTick,s=Function.prototype.apply,l=Array.prototype.slice,c={},u=0;function f(r,n){this._id=r,this._clearFn=n}i.setTimeout=function(){return new f(s.call(setTimeout,window,arguments),clearTimeout)},i.setInterval=function(){return new f(s.call(setInterval,window,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(r){r.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},i.enroll=function(r,n){clearTimeout(r._idleTimeoutId),r._idleTimeout=n},i.unenroll=function(r){clearTimeout(r._idleTimeoutId),r._idleTimeout=-1},i._unrefActive=i.active=function(r){clearTimeout(r._idleTimeoutId);var n=r._idleTimeout;n>=0&&(r._idleTimeoutId=setTimeout(function(){r._onTimeout&&r._onTimeout()},n))},i.setImmediate="function"==typeof n?n:function(r){var n=u++,a=!(arguments.length<2)&&l.call(arguments,1);return c[n]=!0,o(function(){c[n]&&(a?r.apply(null,a):r.call(null),i.clearImmediate(n))}),n},i.clearImmediate="function"==typeof a?a:function(r){delete c[r]}}).call(this)}).call(this,r("timers").setImmediate,r("timers").clearImmediate)},{"process/browser.js":277,timers:311}],312:[function(r,n,i){!function(r){var i=/^\s+/,a=/\s+$/,o=0,s=r.round,l=r.min,c=r.max,u=r.random;function f(n,u){if(u=u||{},(n=n||"")instanceof f)return n;if(!(this instanceof f))return new f(n,u);var h,p,d,m,g,v,y,x,b,_,w,T,k,A,M,S,E,C,O,D,F=(g={r:0,g:0,b:0},v=1,y=null,x=null,b=null,_=!1,w=!1,"string"==typeof(h=n)&&(h=function(r){r=r.replace(i,"").replace(a,"").toLowerCase();var n,o=!1;if(L[r])r=L[r],o=!0;else if("transparent"==r)return{r:0,g:0,b:0,a:0,format:"name"};return(n=U.rgb.exec(r))?{r:n[1],g:n[2],b:n[3]}:(n=U.rgba.exec(r))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=U.hsl.exec(r))?{h:n[1],s:n[2],l:n[3]}:(n=U.hsla.exec(r))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=U.hsv.exec(r))?{h:n[1],s:n[2],v:n[3]}:(n=U.hsva.exec(r))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=U.hex8.exec(r))?{r:z(n[1]),g:z(n[2]),b:z(n[3]),a:z(n[4])/255,format:o?"name":"hex8"}:(n=U.hex6.exec(r))?{r:z(n[1]),g:z(n[2]),b:z(n[3]),format:o?"name":"hex"}:(n=U.hex4.exec(r))?{r:z(n[1]+""+n[1]),g:z(n[2]+""+n[2]),b:z(n[3]+""+n[3]),a:z(n[4]+""+n[4])/255,format:o?"name":"hex8"}:!!(n=U.hex3.exec(r))&&{r:z(n[1]+""+n[1]),g:z(n[2]+""+n[2]),b:z(n[3]+""+n[3]),format:o?"name":"hex"}}(h)),"object"==typeof h&&(V(h.r)&&V(h.g)&&V(h.b)?(p=h.r,d=h.g,m=h.b,g={r:255*I(p,255),g:255*I(d,255),b:255*I(m,255)},_=!0,w="%"===String(h.r).substr(-1)?"prgb":"rgb"):V(h.h)&&V(h.s)&&V(h.v)?(y=R(h.s),x=R(h.v),T=h.h,k=y,A=x,T=6*I(T,360),k=I(k,100),A=I(A,100),M=r.floor(T),S=T-M,E=A*(1-k),C=A*(1-S*k),O=A*(1-(1-S)*k),g={r:255*[A,C,E,E,O,A][D=M%6],g:255*[O,A,A,C,E,E][D],b:255*[E,E,O,A,A,C][D]},_=!0,w="hsv"):V(h.h)&&V(h.s)&&V(h.l)&&(y=R(h.s),b=R(h.l),g=function(r,n,i){var a,o,s;function l(r,n,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?r+6*(n-r)*i:i<.5?n:i<2/3?r+(n-r)*(2/3-i)*6:r}if(r=I(r,360),n=I(n,100),i=I(i,100),0===n)a=o=s=i;else{var c=i<.5?i*(1+n):i+n-i*n,u=2*i-c;a=l(u,c,r+1/3),o=l(u,c,r),s=l(u,c,r-1/3)}return{r:255*a,g:255*o,b:255*s}}(h.h,y,b),_=!0,w="hsl"),h.hasOwnProperty("a")&&(v=h.a)),v=P(v),{ok:_,format:h.format||w,r:l(255,c(g.r,0)),g:l(255,c(g.g,0)),b:l(255,c(g.b,0)),a:v});this._originalInput=n,this._r=F.r,this._g=F.g,this._b=F.b,this._a=F.a,this._roundA=s(100*this._a)/100,this._format=u.format||F.format,this._gradientType=u.gradientType,this._r<1&&(this._r=s(this._r)),this._g<1&&(this._g=s(this._g)),this._b<1&&(this._b=s(this._b)),this._ok=F.ok,this._tc_id=o++}function h(r,n,i){var a,o,s=c(r=I(r,255),n=I(n,255),i=I(i,255)),u=l(r,n,i),f=(s+u)/2;if(s==u)a=o=0;else{var h=s-u;switch(o=f>.5?h/(2-s-u):h/(s+u),s){case r:a=(n-i)/h+(n<i?6:0);break;case n:a=(i-r)/h+2;break;case i:a=(r-n)/h+4}a/=6}return{h:a,s:o,l:f}}function p(r,n,i){var a,o=c(r=I(r,255),n=I(n,255),i=I(i,255)),s=l(r,n,i),u=o-s;if(o==s)a=0;else{switch(o){case r:a=(n-i)/u+(n<i?6:0);break;case n:a=(i-r)/u+2;break;case i:a=(r-n)/u+4}a/=6}return{h:a,s:0===o?0:u/o,v:o}}function d(r,n,i,a){var o=[D(s(r).toString(16)),D(s(n).toString(16)),D(s(i).toString(16))];return a&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function m(r,n,i,a){return[D(F(a)),D(s(r).toString(16)),D(s(n).toString(16)),D(s(i).toString(16))].join("")}function g(r,n){n=0===n?0:n||10;var i=f(r).toHsl();return i.s-=n/100,i.s=O(i.s),f(i)}function v(r,n){n=0===n?0:n||10;var i=f(r).toHsl();return i.s+=n/100,i.s=O(i.s),f(i)}function y(r){return f(r).desaturate(100)}function x(r,n){n=0===n?0:n||10;var i=f(r).toHsl();return i.l+=n/100,i.l=O(i.l),f(i)}function b(r,n){n=0===n?0:n||10;var i=f(r).toRgb();return i.r=c(0,l(255,i.r-s(-n/100*255))),i.g=c(0,l(255,i.g-s(-n/100*255))),i.b=c(0,l(255,i.b-s(-n/100*255))),f(i)}function _(r,n){n=0===n?0:n||10;var i=f(r).toHsl();return i.l-=n/100,i.l=O(i.l),f(i)}function w(r,n){var i=f(r).toHsl(),a=(i.h+n)%360;return i.h=a<0?360+a:a,f(i)}function T(r){var n=f(r).toHsl();return n.h=(n.h+180)%360,f(n)}function k(r){var n=f(r).toHsl(),i=n.h;return[f(r),f({h:(i+120)%360,s:n.s,l:n.l}),f({h:(i+240)%360,s:n.s,l:n.l})]}function A(r){var n=f(r).toHsl(),i=n.h;return[f(r),f({h:(i+90)%360,s:n.s,l:n.l}),f({h:(i+180)%360,s:n.s,l:n.l}),f({h:(i+270)%360,s:n.s,l:n.l})]}function M(r){var n=f(r).toHsl(),i=n.h;return[f(r),f({h:(i+72)%360,s:n.s,l:n.l}),f({h:(i+216)%360,s:n.s,l:n.l})]}function S(r,n,i){n=n||6,i=i||30;var a=f(r).toHsl(),o=360/i,s=[f(r)];for(a.h=(a.h-(o*n>>1)+720)%360;--n;)a.h=(a.h+o)%360,s.push(f(a));return s}function E(r,n){n=n||6;for(var i=f(r).toHsv(),a=i.h,o=i.s,s=i.v,l=[],c=1/n;n--;)l.push(f({h:a,s:o,v:s})),s=(s+c)%1;return l}f.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var r=this.toRgb();return(299*r.r+587*r.g+114*r.b)/1e3},getLuminance:function(){var n,i,a,o=this.toRgb();return n=o.r/255,i=o.g/255,a=o.b/255,.2126*(n<=.03928?n/12.92:r.pow((n+.055)/1.055,2.4))+.7152*(i<=.03928?i/12.92:r.pow((i+.055)/1.055,2.4))+.0722*(a<=.03928?a/12.92:r.pow((a+.055)/1.055,2.4))},setAlpha:function(r){return this._a=P(r),this._roundA=s(100*this._a)/100,this},toHsv:function(){var r=p(this._r,this._g,this._b);return{h:360*r.h,s:r.s,v:r.v,a:this._a}},toHsvString:function(){var r=p(this._r,this._g,this._b),n=s(360*r.h),i=s(100*r.s),a=s(100*r.v);return 1==this._a?"hsv("+n+", "+i+"%, "+a+"%)":"hsva("+n+", "+i+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var r=h(this._r,this._g,this._b);return{h:360*r.h,s:r.s,l:r.l,a:this._a}},toHslString:function(){var r=h(this._r,this._g,this._b),n=s(360*r.h),i=s(100*r.s),a=s(100*r.l);return 1==this._a?"hsl("+n+", "+i+"%, "+a+"%)":"hsla("+n+", "+i+"%, "+a+"%, "+this._roundA+")"},toHex:function(r){return d(this._r,this._g,this._b,r)},toHexString:function(r){return"#"+this.toHex(r)},toHex8:function(r){var n,i,a,o,l;return n=this._r,i=this._g,a=this._b,o=this._a,l=[D(s(n).toString(16)),D(s(i).toString(16)),D(s(a).toString(16)),D(F(o))],r&&l[0].charAt(0)==l[0].charAt(1)&&l[1].charAt(0)==l[1].charAt(1)&&l[2].charAt(0)==l[2].charAt(1)&&l[3].charAt(0)==l[3].charAt(1)?l[0].charAt(0)+l[1].charAt(0)+l[2].charAt(0)+l[3].charAt(0):l.join("")},toHex8String:function(r){return"#"+this.toHex8(r)},toRgb:function(){return{r:s(this._r),g:s(this._g),b:s(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+s(this._r)+", "+s(this._g)+", "+s(this._b)+")":"rgba("+s(this._r)+", "+s(this._g)+", "+s(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:s(100*I(this._r,255))+"%",g:s(100*I(this._g,255))+"%",b:s(100*I(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+s(100*I(this._r,255))+"%, "+s(100*I(this._g,255))+"%, "+s(100*I(this._b,255))+"%)":"rgba("+s(100*I(this._r,255))+"%, "+s(100*I(this._g,255))+"%, "+s(100*I(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(C[d(this._r,this._g,this._b,!0)]||!1)},toFilter:function(r){var n="#"+m(this._r,this._g,this._b,this._a),i=n,a=this._gradientType?"GradientType = 1, ":"";if(r){var o=f(r);i="#"+m(o._r,o._g,o._b,o._a)}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+n+",endColorstr="+i+")"},toString:function(r){var n=!!r;r=r||this._format;var i=!1,a=this._a<1&&this._a>=0;return n||!a||"hex"!==r&&"hex6"!==r&&"hex3"!==r&&"hex4"!==r&&"hex8"!==r&&"name"!==r?("rgb"===r&&(i=this.toRgbString()),"prgb"===r&&(i=this.toPercentageRgbString()),"hex"!==r&&"hex6"!==r||(i=this.toHexString()),"hex3"===r&&(i=this.toHexString(!0)),"hex4"===r&&(i=this.toHex8String(!0)),"hex8"===r&&(i=this.toHex8String()),"name"===r&&(i=this.toName()),"hsl"===r&&(i=this.toHslString()),"hsv"===r&&(i=this.toHsvString()),i||this.toHexString()):"name"===r&&0===this._a?this.toName():this.toRgbString()},clone:function(){return f(this.toString())},_applyModification:function(r,n){var i=r.apply(null,[this].concat([].slice.call(n)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(x,arguments)},brighten:function(){return this._applyModification(b,arguments)},darken:function(){return this._applyModification(_,arguments)},desaturate:function(){return this._applyModification(g,arguments)},saturate:function(){return this._applyModification(v,arguments)},greyscale:function(){return this._applyModification(y,arguments)},spin:function(){return this._applyModification(w,arguments)},_applyCombination:function(r,n){return r.apply(null,[this].concat([].slice.call(n)))},analogous:function(){return this._applyCombination(S,arguments)},complement:function(){return this._applyCombination(T,arguments)},monochromatic:function(){return this._applyCombination(E,arguments)},splitcomplement:function(){return this._applyCombination(M,arguments)},triad:function(){return this._applyCombination(k,arguments)},tetrad:function(){return this._applyCombination(A,arguments)}},f.fromRatio=function(r,n){if("object"==typeof r){var i={};for(var a in r)r.hasOwnProperty(a)&&(i[a]="a"===a?r[a]:R(r[a]));r=i}return f(r,n)},f.equals=function(r,n){return!(!r||!n)&&f(r).toRgbString()==f(n).toRgbString()},f.random=function(){return f.fromRatio({r:u(),g:u(),b:u()})},f.mix=function(r,n,i){i=0===i?0:i||50;var a=f(r).toRgb(),o=f(n).toRgb(),s=i/100;return f({r:(o.r-a.r)*s+a.r,g:(o.g-a.g)*s+a.g,b:(o.b-a.b)*s+a.b,a:(o.a-a.a)*s+a.a})},f.readability=function(n,i){var a=f(n),o=f(i);return(r.max(a.getLuminance(),o.getLuminance())+.05)/(r.min(a.getLuminance(),o.getLuminance())+.05)},f.isReadable=function(r,n,i){var a,o,s,l,c,u=f.readability(r,n);switch(c=!1,(o=((a=(a=i)||{level:"AA",size:"small"}).level||"AA").toUpperCase(),s=(a.size||"small").toLowerCase(),"AA"!==o&&"AAA"!==o&&(o="AA"),"small"!==s&&"large"!==s&&(s="small"),l={level:o,size:s}).level+l.size){case"AAsmall":case"AAAlarge":c=u>=4.5;break;case"AAlarge":c=u>=3;break;case"AAAsmall":c=u>=7}return c},f.mostReadable=function(r,n,i){var a,o,s,l,c=null,u=0;o=(i=i||{}).includeFallbackColors,s=i.level,l=i.size;for(var h=0;h<n.length;h++)(a=f.readability(r,n[h]))>u&&(u=a,c=f(n[h]));return f.isReadable(r,c,{level:s,size:l})||!o?c:(i.includeFallbackColors=!1,f.mostReadable(r,["#fff","#000"],i))};var L=f.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},C=f.hexNames=function(r){var n={};for(var i in r)r.hasOwnProperty(i)&&(n[r[i]]=i);return n}(L);function P(r){return(isNaN(r=parseFloat(r))||r<0||r>1)&&(r=1),r}function I(n,i){"string"==typeof(a=n)&&-1!=a.indexOf(".")&&1===parseFloat(a)&&(n="100%");var a,o,s="string"==typeof(o=n)&&-1!=o.indexOf("%");return n=l(i,c(0,parseFloat(n))),s&&(n=parseInt(n*i,10)/100),1e-6>r.abs(n-i)?1:n%i/parseFloat(i)}function O(r){return l(1,c(0,r))}function z(r){return parseInt(r,16)}function D(r){return 1==r.length?"0"+r:""+r}function R(r){return r<=1&&(r=100*r+"%"),r}function F(n){return r.round(255*parseFloat(n)).toString(16)}var B,N,j,U=(N="[\\s|\\(]+("+(B="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+B+")[,|\\s]+("+B+")\\s*\\)?",j="[\\s|\\(]+("+B+")[,|\\s]+("+B+")[,|\\s]+("+B+")[,|\\s]+("+B+")\\s*\\)?",{CSS_UNIT:new RegExp(B),rgb:RegExp("rgb"+N),rgba:RegExp("rgba"+j),hsl:RegExp("hsl"+N),hsla:RegExp("hsla"+j),hsv:RegExp("hsv"+N),hsva:RegExp("hsva"+j),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function V(r){return!!U.CSS_UNIT.exec(r)}void 0!==n&&n.exports?n.exports=f:window.tinycolor=f}(Math)},{}],313:[function(r,n,i){"use strict";n.exports=o,n.exports.float32=n.exports.float=o,n.exports.fract32=n.exports.fract=function(r,n){if(r.length){if(r instanceof Float32Array)return new Float32Array(r.length);n instanceof Float32Array||(n=o(r));for(var i=0,a=n.length;i<a;i++)n[i]=r[i]-n[i];return n}return o(r-o(r))};var a=new Float32Array(1);function o(r){return r.length?r instanceof Float32Array?r:new Float32Array(r):(a[0]=r,a[0])}},{}],314:[function(r,n,i){"use strict";var a=r("parse-unit");function o(r,n){var i=a(getComputedStyle(r).getPropertyValue(n));return i[0]*s(i[1],r)}function s(r,n){switch(n=n||document.body,r=(r||"px").trim().toLowerCase(),n!==window&&n!==document||(n=document.body),r){case"%":return n.clientHeight/100;case"ch":case"ex":var i,a,s,l;return i=r,a=n,(s=document.createElement("div")).style["font-size"]="128"+i,a.appendChild(s),l=o(s,"font-size")/128,a.removeChild(s),l;case"em":return o(n,"font-size");case"rem":return o(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}n.exports=s},{"parse-unit":251}],315:[function(r,n,i){var a;a=this,function(r){"use strict";function n(r){return r}function i(r){if(null==r)return n;var i,a,o=r.scale[0],s=r.scale[1],l=r.translate[0],c=r.translate[1];return function(r,n){n||(i=a=0);var u=2,f=r.length,h=Array(f);for(h[0]=(i+=r[0])*o+l,h[1]=(a+=r[1])*s+c;u<f;)h[u]=r[u],++u;return h}}function a(r){var n,a=i(r.transform),o=1/0,s=1/0,l=-1/0,c=-1/0;function u(r){(r=a(r))[0]<o&&(o=r[0]),r[0]>l&&(l=r[0]),r[1]<s&&(s=r[1]),r[1]>c&&(c=r[1])}for(n in r.arcs.forEach(function(r){for(var n,i=-1,u=r.length;++i<u;)(n=a(r[i],i))[0]<o&&(o=n[0]),n[0]>l&&(l=n[0]),n[1]<s&&(s=n[1]),n[1]>c&&(c=n[1])}),r.objects)!function r(n){switch(n.type){case"GeometryCollection":n.geometries.forEach(r);break;case"Point":u(n.coordinates);break;case"MultiPoint":n.coordinates.forEach(u)}}(r.objects[n]);return[o,s,l,c]}function o(r,n){var i=n.id,a=n.bbox,o=null==n.properties?{}:n.properties,l=s(r,n);return null==i&&null==a?{type:"Feature",properties:o,geometry:l}:null==a?{type:"Feature",id:i,properties:o,geometry:l}:{type:"Feature",id:i,bbox:a,properties:o,geometry:l}}function s(r,n){var a=i(r.transform),o=r.arcs;function s(r){return a(r)}function l(r){for(var n=[],i=0,s=r.length;i<s;++i)!function(r,n){n.length&&n.pop();for(var i=o[r<0?~r:r],s=0,l=i.length;s<l;++s)n.push(a(i[s],s));r<0&&function(r,n){for(var i,a=r.length,o=a-n;o<--a;)i=r[o],r[o++]=r[a],r[a]=i}(n,l)}(r[i],n);return n.length<2&&n.push(n[0]),n}function c(r){for(var n=l(r);n.length<4;)n.push(n[0]);return n}function u(r){return r.map(c)}return function r(n){var i,a=n.type;switch(a){case"GeometryCollection":return{type:a,geometries:n.geometries.map(r)};case"Point":i=s(n.coordinates);break;case"MultiPoint":i=n.coordinates.map(s);break;case"LineString":i=l(n.arcs);break;case"MultiLineString":i=n.arcs.map(l);break;case"Polygon":i=u(n.arcs);break;case"MultiPolygon":i=n.arcs.map(u);break;default:return null}return{type:a,coordinates:i}}(n)}function l(r,n){var i={},a={},o={},s=[],l=-1;function c(r,n){for(var a in r){var o=r[a];delete n[o.start],delete o.start,delete o.end,o.forEach(function(r){i[r<0?~r:r]=1}),s.push(o)}}return n.forEach(function(i,a){var o,s=r.arcs[i<0?~i:i];!(s.length<3)||s[1][0]||s[1][1]||(o=n[++l],n[l]=i,n[a]=o)}),n.forEach(function(n){var i,s,l,c,u,f=(l=(s=r.arcs[n<0?~n:n])[0],r.transform?(i=[0,0],s.forEach(function(r){i[0]+=r[0],i[1]+=r[1]})):i=s[s.length-1],n<0?[i,l]:[l,i]),h=f[0],p=f[1];if(c=o[h]){if(delete o[c.end],c.push(n),c.end=p,u=a[p]){delete a[u.start];var d=u===c?c:c.concat(u);a[d.start=c.start]=o[d.end=u.end]=d}else a[c.start]=o[c.end]=c}else if(c=a[p]){if(delete a[c.start],c.unshift(n),c.start=h,u=o[h]){delete o[u.end];var m=u===c?c:u.concat(c);a[m.start=u.start]=o[m.end=c.end]=m}else a[c.start]=o[c.end]=c}else a[(c=[n]).start=h]=o[c.end=p]=c}),c(o,a),c(a,o),n.forEach(function(r){i[r<0?~r:r]||s.push([r])}),s}function c(r,n,i){var a,o,s;if(arguments.length>1)a=function(r,n,i){var a,o=[],s=[];function l(r){var n=r<0?~r:r;(s[n]||(s[n]=[])).push({i:r,g:a})}function c(r){r.forEach(l)}function u(r){r.forEach(c)}return function r(n){switch(a=n,n.type){case"GeometryCollection":n.geometries.forEach(r);break;case"LineString":c(n.arcs);break;case"MultiLineString":case"Polygon":u(n.arcs);break;case"MultiPolygon":!function(r){r.forEach(u)}(n.arcs)}}(n),s.forEach(null==i?function(r){o.push(r[0].i)}:function(r){i(r[0].g,r[r.length-1].g)&&o.push(r[0].i)}),o}(0,n,i);else for(o=0,a=Array(s=r.arcs.length);o<s;++o)a[o]=o;return{type:"MultiLineString",arcs:l(r,a)}}function u(r,n){var i={},a=[],o=[];function c(r){r.forEach(function(n){n.forEach(function(n){(i[n=n<0?~n:n]||(i[n]=[])).push(r)})}),a.push(r)}function u(n){return function(r){for(var n,i=-1,a=r.length,o=r[a-1],s=0;++i<a;)n=o,o=r[i],s+=n[0]*o[1]-n[1]*o[0];return Math.abs(s)}(s(r,{type:"Polygon",arcs:[n]}).coordinates[0])}return n.forEach(function r(n){switch(n.type){case"GeometryCollection":n.geometries.forEach(r);break;case"Polygon":c(n.arcs);break;case"MultiPolygon":n.arcs.forEach(c)}}),a.forEach(function(r){if(!r._){var n=[],a=[r];for(r._=1,o.push(n);r=a.pop();)n.push(r),r.forEach(function(r){r.forEach(function(r){i[r<0?~r:r].forEach(function(r){r._||(r._=1,a.push(r))})})})}}),a.forEach(function(r){delete r._}),{type:"MultiPolygon",arcs:o.map(function(n){var a,o=[];if(n.forEach(function(r){r.forEach(function(r){r.forEach(function(r){i[r<0?~r:r].length<2&&o.push(r)})})}),(a=(o=l(r,o)).length)>1)for(var s,c,f=1,h=u(o[0]);f<a;++f)(s=u(o[f]))>h&&(c=o[0],o[0]=o[f],o[f]=c,h=s);return o}).filter(function(r){return r.length>0})}}function f(r,n){for(var i=0,a=r.length;i<a;){var o=i+a>>>1;r[o]<n?i=o+1:a=o}return i}function h(r){if(null==r)return n;var i,a,o=r.scale[0],s=r.scale[1],l=r.translate[0],c=r.translate[1];return function(r,n){n||(i=a=0);var u=2,f=r.length,h=Array(f),p=Math.round((r[0]-l)/o),d=Math.round((r[1]-c)/s);for(h[0]=p-i,i=p,h[1]=d-a,a=d;u<f;)h[u]=r[u],++u;return h}}r.bbox=a,r.feature=function(r,n){return"string"==typeof n&&(n=r.objects[n]),"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(n){return o(r,n)})}:o(r,n)},r.merge=function(r){return s(r,u.apply(this,arguments))},r.mergeArcs=u,r.mesh=function(r){return s(r,c.apply(this,arguments))},r.meshArcs=c,r.neighbors=function(r){var n={},i=r.map(function(){return[]});function a(r,i){r.forEach(function(r){r<0&&(r=~r);var a=n[r];a?a.push(i):n[r]=[i]})}function o(r,n){r.forEach(function(r){a(r,n)})}var s={LineString:a,MultiLineString:o,Polygon:o,MultiPolygon:function(r,n){r.forEach(function(r){o(r,n)})}};for(var l in r.forEach(function r(n,i){"GeometryCollection"===n.type?n.geometries.forEach(function(n){r(n,i)}):n.type in s&&s[n.type](n.arcs,i)}),n)for(var c=n[l],u=c.length,h=0;h<u;++h)for(var p=h+1;p<u;++p){var d,m=c[h],g=c[p];(d=i[m])[l=f(d,g)]!==g&&d.splice(l,0,g),(d=i[g])[l=f(d,m)]!==m&&d.splice(l,0,m)}return i},r.quantize=function(r,n){if(r.transform)throw Error("already quantized");if(n&&n.scale)u=r.bbox;else{if(!((i=Math.floor(n))>=2))throw Error("n must be 2");var i,o=(u=r.bbox||a(r))[0],s=u[1],l=u[2],c=u[3];n={scale:[l-o?(l-o)/(i-1):1,c-s?(c-s)/(i-1):1],translate:[o,s]}}var u,f,p=h(n),d=r.objects,m={};function g(r){return p(r)}for(f in d)m[f]=function r(n){var i;switch(n.type){case"GeometryCollection":i={type:"GeometryCollection",geometries:n.geometries.map(r)};break;case"Point":i={type:"Point",coordinates:g(n.coordinates)};break;case"MultiPoint":i={type:"MultiPoint",coordinates:n.coordinates.map(g)};break;default:return n}return null!=n.id&&(i.id=n.id),null!=n.bbox&&(i.bbox=n.bbox),null!=n.properties&&(i.properties=n.properties),i}(d[f]);return{type:"Topology",bbox:u,transform:n,objects:m,arcs:r.arcs.map(function(r){var n,i=0,a=1,o=r.length,s=Array(o);for(s[0]=p(r[0],0);++i<o;)((n=p(r[i],i))[0]||n[1])&&(s[a++]=n);return 1===a&&(s[a++]=[0,0]),s.length=a,s})}},r.transform=i,r.untransform=h,Object.defineProperty(r,"__esModule",{value:!0})}("object"==typeof i&&void 0!==n?i:(a=a||self).topojson=a.topojson||{})},{}],316:[function(r,n,i){"use strict";var a=r("../prototype/is");n.exports=function(r){if("function"!=typeof r||!hasOwnProperty.call(r,"length"))return!1;try{if("number"!=typeof r.length||"function"!=typeof r.call||"function"!=typeof r.apply)return!1}catch(r){return!1}return!a(r)}},{"../prototype/is":323}],317:[function(r,n,i){"use strict";var a=r("../value/is"),o=r("../object/is"),s=r("../string/coerce"),l=r("./to-short-string"),c=function(r,n){return r.replace("%v",l(n))};n.exports=function(r,n,i){if(!o(i))throw TypeError(c(n,r));if(!a(r)){if("default"in i)return i.default;if(i.isOptional)return null}var l=s(i.errorMessage);throw a(l)||(l=n),TypeError(c(l,r))}},{"../object/is":320,"../string/coerce":324,"../value/is":326,"./to-short-string":319}],318:[function(r,n,i){"use strict";n.exports=function(r){try{return r.toString()}catch(n){try{return String(r)}catch(r){return null}}}},{}],319:[function(r,n,i){"use strict";var a=r("./safe-to-string"),o=/[\n\r\u2028\u2029]/g;n.exports=function(r){var n=a(r);return null===n?"<Non-coercible to string value>":(n.length>100&&(n=n.slice(0,99)+""),n=n.replace(o,function(r){switch(r){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("Unexpected character")}}))}},{"./safe-to-string":318}],320:[function(r,n,i){"use strict";var a=r("../value/is"),o={object:!0,function:!0,undefined:!0};n.exports=function(r){return!!a(r)&&hasOwnProperty.call(o,typeof r)}},{"../value/is":326}],321:[function(r,n,i){"use strict";var a=r("../lib/resolve-exception"),o=r("./is");n.exports=function(r){return o(r)?r:a(r,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":317,"./is":322}],322:[function(r,n,i){"use strict";var a=r("../function/is"),o=/^\s*class[\s{/}]/,s=Function.prototype.toString;n.exports=function(r){return!!a(r)&&!o.test(s.call(r))}},{"../function/is":316}],323:[function(r,n,i){"use strict";var a=r("../object/is");n.exports=function(r){if(!a(r))return!1;try{return!!r.constructor&&r.constructor.prototype===r}catch(r){return!1}}},{"../object/is":320}],324:[function(r,n,i){"use strict";var a=r("../value/is"),o=r("../object/is"),s=Object.prototype.toString;n.exports=function(r){if(!a(r))return null;if(o(r)){var n=r.toString;if("function"!=typeof n||n===s)return null}try{return""+r}catch(r){return null}}},{"../object/is":320,"../value/is":326}],325:[function(r,n,i){"use strict";var a=r("../lib/resolve-exception"),o=r("./is");n.exports=function(r){return o(r)?r:a(r,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":317,"./is":326}],326:[function(r,n,i){"use strict";n.exports=function(r){return null!=r}},{}],327:[function(r,n,a){(function(n){(function(){"use strict";var i=r("bit-twiddle"),o=r("dup"),s=r("buffer").Buffer;n.__TYPEDARRAY_POOL||(n.__TYPEDARRAY_POOL={UINT8:o([32,0]),UINT16:o([32,0]),UINT32:o([32,0]),BIGUINT64:o([32,0]),INT8:o([32,0]),INT16:o([32,0]),INT32:o([32,0]),BIGINT64:o([32,0]),FLOAT:o([32,0]),DOUBLE:o([32,0]),DATA:o([32,0]),UINT8C:o([32,0]),BUFFER:o([32,0])});var l="undefined"!=typeof Uint8ClampedArray,c="undefined"!=typeof BigUint64Array,u="undefined"!=typeof BigInt64Array,f=n.__TYPEDARRAY_POOL;f.UINT8C||(f.UINT8C=o([32,0])),f.BIGUINT64||(f.BIGUINT64=o([32,0])),f.BIGINT64||(f.BIGINT64=o([32,0])),f.BUFFER||(f.BUFFER=o([32,0]));var h=f.DATA,p=f.BUFFER;function d(r){if(r){var n=r.length||r.byteLength;h[i.log2(n)].push(r)}}function m(r){r=i.nextPow2(r);var n=h[i.log2(r)];return n.length>0?n.pop():new ArrayBuffer(r)}function g(r){return new Uint8Array(m(r),0,r)}function v(r){return new Uint16Array(m(2*r),0,r)}function y(r){return new Uint32Array(m(4*r),0,r)}function x(r){return new Int8Array(m(r),0,r)}function b(r){return new Int16Array(m(2*r),0,r)}function _(r){return new Int32Array(m(4*r),0,r)}function w(r){return new Float32Array(m(4*r),0,r)}function T(r){return new Float64Array(m(8*r),0,r)}function k(r){return l?new Uint8ClampedArray(m(r),0,r):g(r)}function A(r){return c?new BigUint64Array(m(8*r),0,r):null}function M(r){return u?new BigInt64Array(m(8*r),0,r):null}function S(r){return new DataView(m(r),0,r)}function E(r){r=i.nextPow2(r);var n=p[i.log2(r)];return n.length>0?n.pop():new s(r)}a.free=function(r){if(s.isBuffer(r))p[i.log2(r.length)].push(r);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(r)&&(r=r.buffer),!r)return;var n=r.length||r.byteLength;h[0|i.log2(n)].push(r)}},a.freeUint8=a.freeUint16=a.freeUint32=a.freeBigUint64=a.freeInt8=a.freeInt16=a.freeInt32=a.freeBigInt64=a.freeFloat32=a.freeFloat=a.freeFloat64=a.freeDouble=a.freeUint8Clamped=a.freeDataView=function(r){d(r.buffer)},a.freeArrayBuffer=d,a.freeBuffer=function(r){p[i.log2(r.length)].push(r)},a.malloc=function(r,n){if(void 0===n||"arraybuffer"===n)return m(r);switch(n){case"uint8":return g(r);case"uint16":return v(r);case"uint32":return y(r);case"int8":return x(r);case"int16":return b(r);case"int32":return _(r);case"float":case"float32":return w(r);case"double":case"float64":return T(r);case"uint8_clamped":return k(r);case"bigint64":return M(r);case"biguint64":return A(r);case"buffer":return E(r);case"data":case"dataview":return S(r)}return null},a.mallocArrayBuffer=m,a.mallocUint8=g,a.mallocUint16=v,a.mallocUint32=y,a.mallocInt8=x,a.mallocInt16=b,a.mallocInt32=_,a.mallocFloat32=a.mallocFloat=w,a.mallocFloat64=a.mallocDouble=T,a.mallocUint8Clamped=k,a.mallocBigUint64=A,a.mallocBigInt64=M,a.mallocDataView=S,a.mallocBuffer=E,a.clearCache=function(){for(var r=0;r<32;++r)f.UINT8[r].length=0,f.UINT16[r].length=0,f.UINT32[r].length=0,f.INT8[r].length=0,f.INT16[r].length=0,f.INT32[r].length=0,f.FLOAT[r].length=0,f.DOUBLE[r].length=0,f.BIGUINT64[r].length=0,f.BIGINT64[r].length=0,f.UINT8C[r].length=0,h[r].length=0,p[r].length=0}}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],328:[function(r,n,i){var a=/[\'\"]/;n.exports=function(r){return r?(a.test(r.charAt(0))&&(r=r.substr(1)),a.test(r.charAt(r.length-1))&&(r=r.substr(0,r.length-1)),r):""}},{}],329:[function(r,n,i){"use strict";n.exports=function(r,n,i){Array.isArray(i)||(i=[].slice.call(arguments,2));for(var a=0,o=i.length;a<o;a++){var s,l=i[a];for(var c in l)if((void 0===n[c]||Array.isArray(n[c])||r[c]!==n[c])&&c in n){if(!0===l[c])s=n[c];else if(!1===l[c]||"function"==typeof l[c]&&void 0===(s=l[c](n[c],r,n)))continue;r[c]=s}}return r}},{}],330:[function(r,n,a){(function(r){(function(){function i(n){try{if(!r.localStorage)return!1}catch(r){return!1}var i=r.localStorage[n];return null!=i&&"true"===String(i).toLowerCase()}n.exports=function(r,n){if(i("noDeprecation"))return r;var a=!1;return function(){if(!a){if(i("throwDeprecation"))throw Error(n);i("traceDeprecation")?console.trace(n):console.warn(n),a=!0}return r.apply(this,arguments)}}}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],331:[function(r,n,i){var a=r("get-canvas-context");n.exports=function(r){return a("webgl",r)}},{"get-canvas-context":194}],332:[function(r,n,i){var a=r("../main"),o=r("object-assign"),s=a.instance();function l(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}l.prototype=new a.baseCalendar,o(l.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(r,n){if("string"==typeof r){var i=r.match(u);return i?i[0]:""}var a=this._validateYear(r),o=r.month(),s=""+this.toChineseMonth(a,o);return n&&s.length<2&&(s="0"+s),this.isIntercalaryMonth(a,o)&&(s+="i"),s},monthNames:function(r){if("string"==typeof r){var n=r.match(f);return n?n[0]:""}var i=this._validateYear(r),a=r.month(),o=["","","","","","","","","","","",""][this.toChineseMonth(i,a)-1];return this.isIntercalaryMonth(i,a)&&(o=""+o),o},monthNamesShort:function(r){if("string"==typeof r){var n=r.match(h);return n?n[0]:""}var i=this._validateYear(r),a=r.month(),o=["","","","","","","","","","","",""][this.toChineseMonth(i,a)-1];return this.isIntercalaryMonth(i,a)&&(o=""+o),o},parseMonth:function(r,n){r=this._validateYear(r);var i,a=parseInt(n);if(isNaN(a))""===n[0]&&(i=!0,n=n.substring(1)),""===n[n.length-1]&&(n=n.substring(0,n.length-1)),a=1+["","","","","","","","","","","",""].indexOf(n);else{var o=n[n.length-1];i="i"===o||"I"===o}return this.toMonthIndex(r,a,i)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(r,n){if(r.year&&(r=r.year()),"number"!=typeof r||r<1888||r>2111)throw n.replace(/\{0\}/,this.local.name);return r},toMonthIndex:function(r,n,i){var o=this.intercalaryMonth(r);if(i&&n!==o||n<1||n>12)throw a.local.invalidMonth.replace(/\{0\}/,this.local.name);return o?!i&&n<=o?n-1:n:n-1},toChineseMonth:function(r,n){r.year&&(n=(r=r.year()).month());var i=this.intercalaryMonth(r);if(n<0||n>(i?12:11))throw a.local.invalidMonth.replace(/\{0\}/,this.local.name);return i?n<i?n+1:n:n+1},intercalaryMonth:function(r){return p[(r=this._validateYear(r))-p[0]]>>13},isIntercalaryMonth:function(r,n){r.year&&(n=(r=r.year()).month());var i=this.intercalaryMonth(r);return!!i&&i===n},leapYear:function(r){return 0!==this.intercalaryMonth(r)},weekOfYear:function(r,n,i){var o,l=d[this._validateYear(r,a.local.invalidyear)-d[0]];return(o=s.newDate(l>>9&4095,l>>5&15,31&l)).add(4-(o.dayOfWeek()||7),"d"),1+Math.floor((this.toJD(r,n,i)-o.toJD())/7)},monthsInYear:function(r){return this.leapYear(r)?13:12},daysInMonth:function(r,n){r.year&&(n=r.month(),r=r.year());var i=p[(r=this._validateYear(r))-p[0]];if(n>(i>>13?12:11))throw a.local.invalidMonth.replace(/\{0\}/,this.local.name);return i&1<<12-n?30:29},weekDay:function(r,n,i){return 6>(this.dayOfWeek(r,n,i)||7)},toJD:function(r,n,i){var o=this._validate(r,c,i,a.local.invalidDate);r=this._validateYear(o.year()),n=o.month(),i=o.day();var l=this.isIntercalaryMonth(r,n),c=this.toChineseMonth(r,n),u=function(r,n,i,a,o){if("object"==typeof r)l=r,s=n||{};else{if(!("number"==typeof r&&r>=1888&&r<=2111))throw Error("Lunar year outside range 1888-2111");if(!("number"==typeof n&&n>=1&&n<=12))throw Error("Lunar month outside range 1 - 12");if(!("number"==typeof i&&i>=1&&i<=30))throw Error("Lunar day outside range 1 - 30");"object"==typeof a?(u=!1,s=a):(u=!!a,s={}),l={year:r,month:n,day:i,isIntercalary:u}}c=l.day-1;var s,l,c,u,f,h=p[l.year-p[0]],m=h>>13;f=m&&(l.month>m||l.isIntercalary)?l.month:l.month-1;for(var g=0;g<f;g++)c+=h&1<<12-g?30:29;var v=d[l.year-d[0]],y=new Date(v>>9&4095,(v>>5&15)-1,(31&v)+c);return s.year=y.getFullYear(),s.month=1+y.getMonth(),s.day=y.getDate(),s}(r,c,i,l);return s.toJD(u.year,u.month,u.day)},fromJD:function(r){var n=s.fromJD(r),i=function(r,n,i,a){if("object"==typeof r)l=r,c=n||{};else{if(!("number"==typeof r&&r>=1888&&r<=2111))throw Error("Solar year outside range 1888-2111");if(!("number"==typeof n&&n>=1&&n<=12))throw Error("Solar month outside range 1 - 12");if(!("number"==typeof i&&i>=1&&i<=31))throw Error("Solar day outside range 1 - 31");l={year:r,month:n,day:i},c={}}var o=d[l.year-d[0]],s=l.year<<9|l.month<<5|l.day;c.year=s>=o?l.year:l.year-1;var l,c,u,f=new Date((o=d[c.year-d[0]])>>9&4095,(o>>5&15)-1,31&o);u=Math.round((new Date(l.year,l.month-1,l.day)-f)/864e5);var h,m=p[c.year-p[0]];for(h=0;h<13;h++){var g=m&1<<12-h?30:29;if(u<g)break;u-=g}var v=m>>13;return!v||h<v?(c.isIntercalary=!1,c.month=1+h):(h===v?c.isIntercalary=!0:c.isIntercalary=!1,c.month=h),c.day=1+u,c}(n.year(),n.month(),n.day()),a=this.toMonthIndex(i.year,i.month,i.isIntercalary);return this.newDate(i.year,a,i.day)},fromString:function(r){var n=r.match(c),i=this._validateYear(+n[1]),a=+n[2],o=!!n[3],s=this.toMonthIndex(i,a,o),l=+n[4];return this.newDate(i,s,l)},add:function(r,n,i){var a=r.year(),o=r.month(),s=this.isIntercalaryMonth(a,o),c=this.toChineseMonth(a,o),u=Object.getPrototypeOf(l.prototype).add.call(this,r,n,i);if("y"===i){var f=u.year(),h=u.month(),p=this.isIntercalaryMonth(f,c),d=s&&p?this.toMonthIndex(f,c,!0):this.toMonthIndex(f,c,!1);d!==h&&u.month(d)}return u}});var c=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,u=/^\d?\d[iI]?/m,f=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,h=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;a.calendars.chinese=l;var p=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],d=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":346,"object-assign":247}],333:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}s.prototype=new a.baseCalendar,o(s.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return(r=n.year()+(0>n.year()?1:0))%4==3||r%4==-1},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear),13},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,a.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(13===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(r,n,i){return 6>(this.dayOfWeek(r,n,i)||7)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);return(r=o.year())<0&&r++,o.day()+30*(o.month()-1)+365*(r-1)+Math.floor(r/4)+this.jdEpoch-1},fromJD:function(r){var n=Math.floor(r)+.5-this.jdEpoch,i=Math.floor((n-Math.floor((n+366)/1461))/365)+1;i<=0&&i--;var a=Math.floor((n=Math.floor(r)+.5-this.newDate(i,1,1).toJD())/30)+1,o=n-30*(a-1)+1;return this.newDate(i,a,o)}}),a.calendars.coptic=s},{"../main":346,"object-assign":247}],334:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}s.prototype=new a.baseCalendar,o(s.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(r){return this._validate(r,this.minMonth,this.minDay,a.local.invalidYear),!1},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,a.local.invalidYear),13},daysInYear:function(r){return this._validate(r,this.minMonth,this.minDay,a.local.invalidYear),400},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/8)+1},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,a.local.invalidMonth);return this.daysPerMonth[i.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(r,n,i){return(this._validate(r,n,i,a.local.invalidDate).day()+1)%8},weekDay:function(r,n,i){var a=this.dayOfWeek(r,n,i);return a>=2&&a<=6},extraInfo:function(r,n,i){return{century:l[Math.floor((this._validate(r,n,i,a.local.invalidDate).year()-1)/100)+1]||""}},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);return r=o.year()+(0>o.year()?1:0),n=o.month(),(i=o.day())+(n>1?16:0)+(n>2?32*(n-2):0)+400*(r-1)+this.jdEpoch-1},fromJD:function(r){var n=Math.floor((r=Math.floor(r+.5)-Math.floor(this.jdEpoch)-1)/400)+1;r-=400*(n-1);var i=Math.floor((r+=r>15?16:0)/32)+1,a=r-32*(i-1)+1;return this.newDate(n<=0?n-1:n,i,a)}});var l={20:"Fruitbat",21:"Anchovy"};a.calendars.discworld=s},{"../main":346,"object-assign":247}],335:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}s.prototype=new a.baseCalendar,o(s.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return(r=n.year()+(0>n.year()?1:0))%4==3||r%4==-1},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear),13},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,a.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(13===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(r,n,i){return 6>(this.dayOfWeek(r,n,i)||7)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);return(r=o.year())<0&&r++,o.day()+30*(o.month()-1)+365*(r-1)+Math.floor(r/4)+this.jdEpoch-1},fromJD:function(r){var n=Math.floor(r)+.5-this.jdEpoch,i=Math.floor((n-Math.floor((n+366)/1461))/365)+1;i<=0&&i--;var a=Math.floor((n=Math.floor(r)+.5-this.newDate(i,1,1).toJD())/30)+1,o=n-30*(a-1)+1;return this.newDate(i,a,o)}}),a.calendars.ethiopian=s},{"../main":346,"object-assign":247}],336:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}function l(r,n){return r-n*Math.floor(r/n)}s.prototype=new a.baseCalendar,o(s.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return this._leapYear(n.year())},_leapYear:function(r){return 7>l(7*(r=r<0?r+1:r)+1,19)},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,a.local.invalidYear),this._leapYear(r.year?r.year():r)?13:12},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(r){return r=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear).year(),this.toJD(-1===r?1:r+1,7,1)-this.toJD(r,7,1)},daysInMonth:function(r,n){return r.year&&(n=r.month(),r=r.year()),this._validate(r,n,this.minDay,a.local.invalidMonth),12===n&&this.leapYear(r)||8===n&&5===l(this.daysInYear(r),10)?30:9===n&&3===l(this.daysInYear(r),10)?29:this.daysPerMonth[n-1]},weekDay:function(r,n,i){return 6!==this.dayOfWeek(r,n,i)},extraInfo:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);return{yearType:(this.leapYear(o)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(o)%10-3]}},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);r=o.year(),n=o.month(),i=o.day();var s=r<=0?r+1:r,l=this.jdEpoch+this._delay1(s)+this._delay2(s)+i+1;if(n<7){for(var c=7;c<=this.monthsInYear(r);c++)l+=this.daysInMonth(r,c);for(c=1;c<n;c++)l+=this.daysInMonth(r,c)}else for(c=7;c<n;c++)l+=this.daysInMonth(r,c);return l},_delay1:function(r){var n=Math.floor((235*r-234)/19),i=29*n+Math.floor((12084+13753*n)/25920);return 3>l(3*(i+1),7)&&i++,i},_delay2:function(r){var n=this._delay1(r-1),i=this._delay1(r);return this._delay1(r+1)-i==356?2:i-n==382?1:0},fromJD:function(r){r=Math.floor(r)+.5;for(var n=Math.floor(98496*(r-this.jdEpoch)/35975351)-1;r>=this.toJD(-1===n?1:n+1,7,1);)n++;for(var i=r<this.toJD(n,1,1)?7:1;r>this.toJD(n,i,this.daysInMonth(n,i));)i++;var a=r-this.toJD(n,i,1)+1;return this.newDate(n,i,a)}}),a.calendars.hebrew=s},{"../main":346,"object-assign":247}],337:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}s.prototype=new a.baseCalendar,o(s.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-khams","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(r){return(11*this._validate(r,this.minMonth,this.minDay,a.local.invalidYear).year()+14)%30<11},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(r){return this.leapYear(r)?355:354},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,a.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(12===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(r,n,i){return 5!==this.dayOfWeek(r,n,i)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);return r=o.year(),n=o.month(),r=r<=0?r+1:r,(i=o.day())+Math.ceil(29.5*(n-1))+354*(r-1)+Math.floor((3+11*r)/30)+this.jdEpoch-1},fromJD:function(r){var n=Math.floor((30*((r=Math.floor(r)+.5)-this.jdEpoch)+10646)/10631);n=n<=0?n-1:n;var i=Math.min(12,Math.ceil((r-29-this.toJD(n,1,1))/29.5)+1),a=r-this.toJD(n,i,1)+1;return this.newDate(n,i,a)}}),a.calendars.islamic=s},{"../main":346,"object-assign":247}],338:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}s.prototype=new a.baseCalendar,o(s.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return(r=0>n.year()?n.year()+1:n.year())%4==0},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(4-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,a.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(2===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(r,n,i){return 6>(this.dayOfWeek(r,n,i)||7)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);return r=o.year(),n=o.month(),i=o.day(),r<0&&r++,n<=2&&(r--,n+=12),Math.floor(365.25*(r+4716))+Math.floor(30.6001*(n+1))+i-1524.5},fromJD:function(r){var n=Math.floor(r+.5)+1524,i=Math.floor((n-122.1)/365.25),a=Math.floor(365.25*i),o=Math.floor((n-a)/30.6001),s=o-Math.floor(o<14?1:13),l=i-Math.floor(s>2?4716:4715),c=n-a-Math.floor(30.6001*o);return l<=0&&l--,this.newDate(l,s,c)}}),a.calendars.julian=s},{"../main":346,"object-assign":247}],339:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}function l(r,n){return r-n*Math.floor(r/n)}s.prototype=new a.baseCalendar,o(s.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(r){return this._validate(r,this.minMonth,this.minDay,a.local.invalidYear),!1},formatYear:function(r){var n=Math.floor((r=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear).year())/400);return r%=400,n+"."+Math.floor((r+=r<0?400:0)/20)+"."+r%20},forYear:function(r){if((r=r.split(".")).length<3)throw"Invalid Mayan year";for(var n=0,i=0;i<r.length;i++){var a=parseInt(r[i],10);if(Math.abs(a)>19||i>0&&a<0)throw"Invalid Mayan year";n=20*n+a}return n},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,a.local.invalidYear),18},weekOfYear:function(r,n,i){return this._validate(r,n,i,a.local.invalidDate),0},daysInYear:function(r){return this._validate(r,this.minMonth,this.minDay,a.local.invalidYear),360},daysInMonth:function(r,n){return this._validate(r,n,this.minDay,a.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(r,n,i){return this._validate(r,n,i,a.local.invalidDate).day()},weekDay:function(r,n,i){return this._validate(r,n,i,a.local.invalidDate),!0},extraInfo:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate).toJD(),s=this._toHaab(o),l=this._toTzolkin(o);return{haabMonthName:this.local.haabMonths[s[0]-1],haabMonth:s[0],haabDay:s[1],tzolkinDayName:this.local.tzolkinMonths[l[0]-1],tzolkinDay:l[0],tzolkinTrecena:l[1]}},_toHaab:function(r){var n=l((r-=this.jdEpoch)+8+340,365);return[Math.floor(n/20)+1,l(n,20)]},_toTzolkin:function(r){return[l((r-=this.jdEpoch)+20-1,20)+1,l(r+4-1,13)+1]},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);return o.day()+20*o.month()+360*o.year()+this.jdEpoch},fromJD:function(r){var n=Math.floor((r=Math.floor(r)+.5-this.jdEpoch)/360);r%=360;var i=Math.floor((r+=r<0?360:0)/20),a=r%20;return this.newDate(n,i,a)}}),a.calendars.mayan=s},{"../main":346,"object-assign":247}],340:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}s.prototype=new a.baseCalendar;var l=a.instance("gregorian");o(s.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear||a.regionalOptions[""].invalidYear);return l.leapYear(n.year()+(1>n.year()?1:0)+1469)},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(1-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,a.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(12===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(r,n,i){return 6>(this.dayOfWeek(r,n,i)||7)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidMonth);(r=o.year())<0&&r++;for(var s=o.day(),c=1;c<o.month();c++)s+=this.daysPerMonth[c-1];return s+l.toJD(r+1468,3,13)},fromJD:function(r){r=Math.floor(r+.5);for(var n=Math.floor((r-(this.jdEpoch-1))/366);r>=this.toJD(n+1,1,1);)n++;for(var i=r-Math.floor(this.toJD(n,1,1)+.5)+1,a=1;i>this.daysInMonth(n,a);)i-=this.daysInMonth(n,a),a++;return this.newDate(n,a,i)}}),a.calendars.nanakshahi=s},{"../main":346,"object-assign":247}],341:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}s.prototype=new a.baseCalendar,o(s.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(r){return this.daysInYear(r)!==this.daysPerYear},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(r){if(r=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear).year(),void 0===this.NEPALI_CALENDAR_DATA[r])return this.daysPerYear;for(var n=0,i=this.minMonth;i<=12;i++)n+=this.NEPALI_CALENDAR_DATA[r][i];return n},daysInMonth:function(r,n){return r.year&&(n=r.month(),r=r.year()),this._validate(r,n,this.minDay,a.local.invalidMonth),void 0===this.NEPALI_CALENDAR_DATA[r]?this.daysPerMonth[n-1]:this.NEPALI_CALENDAR_DATA[r][n]},weekDay:function(r,n,i){return 6!==this.dayOfWeek(r,n,i)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);r=o.year(),n=o.month(),i=o.day();var s=a.instance(),l=0,c=n,u=r;this._createMissingCalendarData(r);var f=r-(c>9||9===c&&i>=this.NEPALI_CALENDAR_DATA[u][0]?56:57);for(9!==n&&(l=i,c--);9!==c;)c<=0&&(c=12,u--),l+=this.NEPALI_CALENDAR_DATA[u][c],c--;return 9===n?(l+=i-this.NEPALI_CALENDAR_DATA[u][0])<0&&(l+=s.daysInYear(f)):l+=this.NEPALI_CALENDAR_DATA[u][9]-this.NEPALI_CALENDAR_DATA[u][0],s.newDate(f,1,1).add(l,"d").toJD()},fromJD:function(r){var n=a.instance().fromJD(r),i=n.year(),o=n.dayOfYear(),s=i+56;this._createMissingCalendarData(s);for(var l=9,c=this.NEPALI_CALENDAR_DATA[s][0],u=this.NEPALI_CALENDAR_DATA[s][l]-c+1;o>u;)++l>12&&(l=1,s++),u+=this.NEPALI_CALENDAR_DATA[s][l];var f=this.NEPALI_CALENDAR_DATA[s][l]-(u-o);return this.newDate(s,l,f)},_createMissingCalendarData:function(r){var n=this.daysPerMonth.slice(0);n.unshift(17);for(var i=r-1;i<r+2;i++)void 0===this.NEPALI_CALENDAR_DATA[i]&&(this.NEPALI_CALENDAR_DATA[i]=n)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),a.calendars.nepali=s},{"../main":346,"object-assign":247}],342:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}function l(r,n){return r-n*Math.floor(r/n)}s.prototype=new a.baseCalendar,o(s.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xe6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xe6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return 682*((n.year()-(n.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(-(a.dayOfWeek()+1)%7,"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,a.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(12===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(r,n,i){return 5!==this.dayOfWeek(r,n,i)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);r=o.year(),n=o.month(),i=o.day();var s=r-(r>=0?474:473),c=474+l(s,2820);return i+(n<=7?31*(n-1):30*(n-1)+6)+Math.floor((682*c-110)/2816)+365*(c-1)+1029983*Math.floor(s/2820)+this.jdEpoch-1},fromJD:function(r){var n=(r=Math.floor(r)+.5)-this.toJD(475,1,1),i=Math.floor(n/1029983),a=l(n,1029983),o=2820;if(1029982!==a){var s=Math.floor(a/366);o=Math.floor((2134*s+2816*l(a,366)+2815)/1028522)+s+1}var c=o+2820*i+474;c=c<=0?c-1:c;var u=r-this.toJD(c,1,1)+1,f=u<=186?Math.ceil(u/31):Math.ceil((u-6)/30),h=r-this.toJD(c,f,1)+1;return this.newDate(c,f,h)}}),a.calendars.persian=s,a.calendars.jalali=s},{"../main":346,"object-assign":247}],343:[function(r,n,i){var a=r("../main"),o=r("object-assign"),s=a.instance();function l(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}l.prototype=new a.baseCalendar,o(l.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return r=this._t2gYear(n.year()),s.leapYear(r)},weekOfYear:function(r,n,i){var o=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return r=this._t2gYear(o.year()),s.weekOfYear(r,o.month(),o.day())},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,a.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(2===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(r,n,i){return 6>(this.dayOfWeek(r,n,i)||7)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);return r=this._t2gYear(o.year()),s.toJD(r,o.month(),o.day())},fromJD:function(r){var n=s.fromJD(r),i=this._g2tYear(n.year());return this.newDate(i,n.month(),n.day())},_t2gYear:function(r){return r+this.yearsOffset+(r>=-this.yearsOffset&&r<=-1?1:0)},_g2tYear:function(r){return r-this.yearsOffset-(r>=1&&r<=this.yearsOffset?1:0)}}),a.calendars.taiwan=l},{"../main":346,"object-assign":247}],344:[function(r,n,i){var a=r("../main"),o=r("object-assign"),s=a.instance();function l(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}l.prototype=new a.baseCalendar,o(l.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return r=this._t2gYear(n.year()),s.leapYear(r)},weekOfYear:function(r,n,i){var o=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return r=this._t2gYear(o.year()),s.weekOfYear(r,o.month(),o.day())},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,a.local.invalidMonth);return this.daysPerMonth[i.month()-1]+(2===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(r,n,i){return 6>(this.dayOfWeek(r,n,i)||7)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate);return r=this._t2gYear(o.year()),s.toJD(r,o.month(),o.day())},fromJD:function(r){var n=s.fromJD(r),i=this._g2tYear(n.year());return this.newDate(i,n.month(),n.day())},_t2gYear:function(r){return r-this.yearsOffset-(r>=1&&r<=this.yearsOffset?1:0)},_g2tYear:function(r){return r+this.yearsOffset+(r>=-this.yearsOffset&&r<=-1?1:0)}}),a.calendars.thai=l},{"../main":346,"object-assign":247}],345:[function(r,n,i){var a=r("../main"),o=r("object-assign");function s(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}s.prototype=new a.baseCalendar,o(s.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thalth","Yawm al-Arba","Yawm al-Khams","Yawm al-Juma","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,a.local.invalidYear);return 355===this.daysInYear(n.year())},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(r){for(var n=0,i=1;i<=12;i++)n+=this.daysInMonth(r,i);return n},daysInMonth:function(r,n){for(var i=this._validate(r,n,this.minDay,a.local.invalidMonth).toJD()-24e5+.5,o=0,s=0;s<l.length;s++){if(l[s]>i)return l[o]-l[o-1];o++}return 30},weekDay:function(r,n,i){return 5!==this.dayOfWeek(r,n,i)},toJD:function(r,n,i){var o=this._validate(r,n,i,a.local.invalidDate),s=12*(o.year()-1)+o.month()-15292;return o.day()+l[s-1]-1+24e5-.5},fromJD:function(r){for(var n=r-24e5+.5,i=0,a=0;a<l.length&&!(l[a]>n);a++)i++;var o=i+15292,s=Math.floor((o-1)/12),c=n-l[i-1]+1;return this.newDate(s+1,o-12*s,c)},isValid:function(r,n,i){var o=a.baseCalendar.prototype.isValid.apply(this,arguments);return o&&(o=(r=null!=r.year?r.year:r)>=1276&&r<=1500),o},_validate:function(r,n,i,o){var s=a.baseCalendar.prototype._validate.apply(this,arguments);if(s.year<1276||s.year>1500)throw o.replace(/\{0\}/,this.local.name);return s}}),a.calendars.ummalqura=s;var l=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":346,"object-assign":247}],346:[function(r,n,i){var a=r("object-assign");function o(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function s(r,n,i,a){if(this._calendar=r,this._year=n,this._month=i,this._day=a,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(f.local.invalidDate||f.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function l(r,n){return"000000".substring(0,n-(r=""+r).length)+r}function c(){this.shortYearCutoff="+10"}function u(r){this.local=this.regionalOptions[r]||this.regionalOptions[""]}a(o.prototype,{instance:function(r,n){r=(r||"gregorian").toLowerCase(),n=n||"";var i=this._localCals[r+"-"+n];if(!i&&this.calendars[r]&&(i=new this.calendars[r](n),this._localCals[r+"-"+n]=i),!i)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,r);return i},newDate:function(r,n,i,a,o){return(a=(null!=r&&r.year?r.calendar():"string"==typeof a?this.instance(a,o):a)||this.instance()).newDate(r,n,i)},substituteDigits:function(r){return function(n){return(n+"").replace(/[0-9]/g,function(n){return r[n]})}},substituteChineseDigits:function(r,n){return function(i){for(var a="",o=0;i>0;){var s=i%10;a=(0===s?"":r[s]+n[o])+a,o++,i=Math.floor(i/10)}return 0===a.indexOf(r[1]+n[1])&&(a=a.substr(1)),a||r[0]}}}),a(s.prototype,{newDate:function(r,n,i){return this._calendar.newDate(null==r?this:r,n,i)},year:function(r){return 0==arguments.length?this._year:this.set(r,"y")},month:function(r){return 0==arguments.length?this._month:this.set(r,"m")},day:function(r){return 0==arguments.length?this._day:this.set(r,"d")},date:function(r,n,i){if(!this._calendar.isValid(r,n,i))throw(f.local.invalidDate||f.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=r,this._month=n,this._day=i,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(r,n){return this._calendar.add(this,r,n)},set:function(r,n){return this._calendar.set(this,r,n)},compareTo:function(r){if(this._calendar.name!==r._calendar.name)throw(f.local.differentCalendars||f.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,r._calendar.local.name);var n=this._year!==r._year?this._year-r._year:this._month!==r._month?this.monthOfYear()-r.monthOfYear():this._day-r._day;return 0===n?0:n<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(r){return this._calendar.fromJD(r)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(r){return this._calendar.fromJSDate(r)},toString:function(){return(0>this.year()?"-":"")+l(Math.abs(this.year()),4)+"-"+l(this.month(),2)+"-"+l(this.day(),2)}}),a(c.prototype,{_validateLevel:0,newDate:function(r,n,i){return null==r?this.today():(r.year&&(this._validate(r,n,i,f.local.invalidDate||f.regionalOptions[""].invalidDate),i=r.day(),n=r.month(),r=r.year()),new s(this,r,n,i))},today:function(){return this.fromJSDate(new Date)},epoch:function(r){return 0>this._validate(r,this.minMonth,this.minDay,f.local.invalidYear||f.regionalOptions[""].invalidYear).year()?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,f.local.invalidYear||f.regionalOptions[""].invalidYear);return(0>n.year()?"-":"")+l(Math.abs(n.year()),4)},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,f.local.invalidYear||f.regionalOptions[""].invalidYear),12},monthOfYear:function(r,n){var i=this._validate(r,n,this.minDay,f.local.invalidMonth||f.regionalOptions[""].invalidMonth);return(i.month()+this.monthsInYear(i)-this.firstMonth)%this.monthsInYear(i)+this.minMonth},fromMonthOfYear:function(r,n){var i=(n+this.firstMonth-2*this.minMonth)%this.monthsInYear(r)+this.minMonth;return this._validate(r,i,this.minDay,f.local.invalidMonth||f.regionalOptions[""].invalidMonth),i},daysInYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,f.local.invalidYear||f.regionalOptions[""].invalidYear);return this.leapYear(n)?366:365},dayOfYear:function(r,n,i){var a=this._validate(r,n,i,f.local.invalidDate||f.regionalOptions[""].invalidDate);return a.toJD()-this.newDate(a.year(),this.fromMonthOfYear(a.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(r,n,i){var a=this._validate(r,n,i,f.local.invalidDate||f.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(a))+2)%this.daysInWeek()},extraInfo:function(r,n,i){return this._validate(r,n,i,f.local.invalidDate||f.regionalOptions[""].invalidDate),{}},add:function(r,n,i){return this._validate(r,this.minMonth,this.minDay,f.local.invalidDate||f.regionalOptions[""].invalidDate),this._correctAdd(r,this._add(r,n,i),n,i)},_add:function(r,n,i){if(this._validateLevel++,"d"===i||"w"===i){var a=r.toJD()+n*("w"===i?this.daysInWeek():1),o=r.calendar().fromJD(a);return this._validateLevel--,[o.year(),o.month(),o.day()]}try{var s=r.year()+("y"===i?n:0),l=r.monthOfYear()+("m"===i?n:0);o=r.day(),"y"===i?(r.month()!==this.fromMonthOfYear(s,l)&&(l=this.newDate(s,r.month(),this.minDay).monthOfYear()),l=Math.min(l,this.monthsInYear(s)),o=Math.min(o,this.daysInMonth(s,this.fromMonthOfYear(s,l)))):"m"===i&&(function(r){for(;l<r.minMonth;)s--,l+=r.monthsInYear(s);for(var n=r.monthsInYear(s);l>n-1+r.minMonth;)s++,l-=n,n=r.monthsInYear(s)}(this),o=Math.min(o,this.daysInMonth(s,this.fromMonthOfYear(s,l))));var c=[s,this.fromMonthOfYear(s,l),o];return this._validateLevel--,c}catch(r){throw this._validateLevel--,r}},_correctAdd:function(r,n,i,a){if(!(this.hasYearZero||"y"!==a&&"m"!==a||0!==n[0]&&r.year()>0==n[0]>0)){var o={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[a];n=this._add(r,i*o[0]+(i<0?-1:1)*o[1],o[2])}return r.date(n[0],n[1],n[2])},set:function(r,n,i){this._validate(r,this.minMonth,this.minDay,f.local.invalidDate||f.regionalOptions[""].invalidDate);var a="y"===i?n:r.year(),o="m"===i?n:r.month(),s="d"===i?n:r.day();return"y"!==i&&"m"!==i||(s=Math.min(s,this.daysInMonth(a,o))),r.date(a,o,s)},isValid:function(r,n,i){this._validateLevel++;var a=this.hasYearZero||0!==r;if(a){var o=this.newDate(r,n,this.minDay);a=n>=this.minMonth&&n-this.minMonth<this.monthsInYear(o)&&i>=this.minDay&&i-this.minDay<this.daysInMonth(o)}return this._validateLevel--,a},toJSDate:function(r,n,i){var a=this._validate(r,n,i,f.local.invalidDate||f.regionalOptions[""].invalidDate);return f.instance().fromJD(this.toJD(a)).toJSDate()},fromJSDate:function(r){return this.fromJD(f.instance().fromJSDate(r).toJD())},_validate:function(r,n,i,a){if(r.year){if(0===this._validateLevel&&this.name!==r.calendar().name)throw(f.local.differentCalendars||f.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,r.calendar().local.name);return r}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(r,n,i))throw a.replace(/\{0\}/,this.local.name);var o=this.newDate(r,n,i);return this._validateLevel--,o}catch(r){throw this._validateLevel--,r}}}),u.prototype=new c,a(u.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(r){var n=this._validate(r,this.minMonth,this.minDay,f.local.invalidYear||f.regionalOptions[""].invalidYear);return(r=n.year()+(0>n.year()?1:0))%4==0&&(r%100!=0||r%400==0)},weekOfYear:function(r,n,i){var a=this.newDate(r,n,i);return a.add(4-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(r,n){var i=this._validate(r,n,this.minDay,f.local.invalidMonth||f.regionalOptions[""].invalidMonth);return this.daysPerMonth[i.month()-1]+(2===i.month()&&this.leapYear(i.year())?1:0)},weekDay:function(r,n,i){return 6>(this.dayOfWeek(r,n,i)||7)},toJD:function(r,n,i){var a=this._validate(r,n,i,f.local.invalidDate||f.regionalOptions[""].invalidDate);r=a.year(),n=a.month(),i=a.day(),r<0&&r++,n<3&&(n+=12,r--);var o=Math.floor(r/100);return Math.floor(365.25*(r+4716))+Math.floor(30.6001*(n+1))+i+(2-o+Math.floor(o/4))-1524.5},fromJD:function(r){var n=Math.floor(r+.5),i=Math.floor((n-1867216.25)/36524.25),a=(i=n+1+i-Math.floor(i/4))+1524,o=Math.floor((a-122.1)/365.25),s=Math.floor(365.25*o),l=Math.floor((a-s)/30.6001),c=a-s-Math.floor(30.6001*l),u=l-(l>13.5?13:1),f=o-(u>2.5?4716:4715);return f<=0&&f--,this.newDate(f,u,c)},toJSDate:function(r,n,i){var a=this._validate(r,n,i,f.local.invalidDate||f.regionalOptions[""].invalidDate),o=new Date(a.year(),a.month()-1,a.day());return o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0),o.setHours(o.getHours()>12?o.getHours()+2:0),o},fromJSDate:function(r){return this.newDate(r.getFullYear(),r.getMonth()+1,r.getDate())}});var f=n.exports=new o;f.cdate=s,f.baseCalendar=c,f.calendars.gregorian=u},{"object-assign":247}],347:[function(r,n,i){var a=r("object-assign"),o=r("./main");a(o.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),o.local=o.regionalOptions[""],a(o.cdate.prototype,{formatDate:function(r,n){return"string"!=typeof r&&(n=r,r=""),this._calendar.formatDate(r||"",this,n)}}),a(o.baseCalendar.prototype,{UNIX_EPOCH:o.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:o.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(r,n,i){if("string"!=typeof r&&(i=n,n=r,r=""),!n)return"";if(n.calendar()!==this)throw o.local.invalidFormat||o.regionalOptions[""].invalidFormat;r=r||this.local.dateFormat;for(var a,s,l,c=(i=i||{}).dayNamesShort||this.local.dayNamesShort,u=i.dayNames||this.local.dayNames,f=i.monthNumbers||this.local.monthNumbers,h=i.monthNamesShort||this.local.monthNamesShort,p=i.monthNames||this.local.monthNames,d=(i.calculateWeek||this.local.calculateWeek,function(n,i){for(var a=1;b+a<r.length&&r.charAt(b+a)===n;)a++;return b+=a-1,Math.floor(a/(i||1))>1}),m=function(r,n,i,a){var o=""+n;if(d(r,a))for(;o.length<i;)o="0"+o;return o},g=this.local.digits,v=function(r){return i.localNumbers&&g?g(r):r},y="",x=!1,b=0;b<r.length;b++)if(x)"'"!==r.charAt(b)||d("'")?y+=r.charAt(b):x=!1;else switch(r.charAt(b)){case"d":y+=v(m("d",n.day(),2));break;case"D":y+=(l=n.dayOfWeek(),d("D")?u[l]:c[l]);break;case"o":y+=m("o",n.dayOfYear(),3);break;case"w":y+=m("w",n.weekOfYear(),2);break;case"m":y+=(a=n,"function"==typeof f?f.call(this,a,d("m")):v(m("m",a.month(),2)));break;case"M":y+=(s=n,d("M")?"function"==typeof p?p.call(this,s):p[s.month()-this.minMonth]:"function"==typeof h?h.call(this,s):h[s.month()-this.minMonth]);break;case"y":y+=d("y",2)?n.year():(n.year()%100<10?"0":"")+n.year()%100;break;case"Y":d("Y",2),y+=n.formatYear();break;case"J":y+=n.toJD();break;case"@":y+=(n.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":y+=(n.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":d("'")?y+="'":x=!0;break;default:y+=r.charAt(b)}return y},parseDate:function(r,n,i){if(null==n)throw o.local.invalidArguments||o.regionalOptions[""].invalidArguments;if(""===(n="object"==typeof n?n.toString():n+""))return null;r=r||this.local.dateFormat;var a=(i=i||{}).shortYearCutoff||this.shortYearCutoff;a="string"!=typeof a?a:this.today().year()%100+parseInt(a,10);for(var s=i.dayNamesShort||this.local.dayNamesShort,l=i.dayNames||this.local.dayNames,c=i.parseMonth||this.local.parseMonth,u=i.monthNumbers||this.local.monthNumbers,f=i.monthNamesShort||this.local.monthNamesShort,h=i.monthNames||this.local.monthNames,p=-1,d=-1,m=-1,g=-1,v=-1,y=!1,x=!1,b=function(n,i){for(var a=1;M+a<r.length&&r.charAt(M+a)===n;)a++;return M+=a-1,Math.floor(a/(i||1))>1},_=function(r,i){var a=b(r,i),s=RegExp("^-?\\d{1,"+[2,3,a?4:2,a?4:2,10,11,20]["oyYJ@!".indexOf(r)+1]+"}"),l=n.substring(A).match(s);if(!l)throw(o.local.missingNumberAt||o.regionalOptions[""].missingNumberAt).replace(/\{0\}/,A);return A+=l[0].length,parseInt(l[0],10)},w=this,T=function(r,i,a,s){for(var l=b(r,s)?a:i,c=0;c<l.length;c++)if(n.substr(A,l[c].length).toLowerCase()===l[c].toLowerCase())return A+=l[c].length,c+w.minMonth;throw(o.local.unknownNameAt||o.regionalOptions[""].unknownNameAt).replace(/\{0\}/,A)},k=function(){if(n.charAt(A)!==r.charAt(M))throw(o.local.unexpectedLiteralAt||o.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,A);A++},A=0,M=0;M<r.length;M++)if(x)"'"!==r.charAt(M)||b("'")?k():x=!1;else switch(r.charAt(M)){case"d":g=_("d");break;case"D":T("D",s,l);break;case"o":v=_("o");break;case"w":_("w");break;case"m":m=function(){if("function"==typeof u){b("m");var r=u.call(w,n.substring(A));return A+=r.length,r}return _("m")}();break;case"M":m=function(){if("function"==typeof h){var r=b("M")?h.call(w,n.substring(A)):f.call(w,n.substring(A));return A+=r.length,r}return T("M",f,h)}();break;case"y":var S=M;y=!b("y",2),M=S,d=_("y",2);break;case"Y":d=_("Y",2);break;case"J":p=_("J")+.5,"."===n.charAt(A)&&(A++,_("J"));break;case"@":p=_("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":p=_("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":A=n.length;break;case"'":b("'")?k():x=!0;break;default:k()}if(A<n.length)throw o.local.unexpectedText||o.regionalOptions[""].unexpectedText;if(-1===d?d=this.today().year():d<100&&y&&(d+=-1===a?1900:this.today().year()-this.today().year()%100-(d<=a?0:100)),"string"==typeof m&&(m=c.call(this,d,m)),v>-1){m=1,g=v;for(var E=this.daysInMonth(d,m);g>E;E=this.daysInMonth(d,m))m++,g-=E}return p>-1?this.fromJD(p):this.newDate(d,m,g)},determineDate:function(r,n,i,a,o){i&&"object"!=typeof i&&(o=a,a=i,i=null),"string"!=typeof a&&(o=a,a="");var s=this;return n=n?n.newDate():null,r=null==r?n:"string"==typeof r?function(r){try{return s.parseDate(a,r,o)}catch(r){}for(var n=((r=r.toLowerCase()).match(/^c/)&&i?i.newDate():null)||s.today(),l=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,c=l.exec(r);c;)n.add(parseInt(c[1],10),c[2]||"d"),c=l.exec(r);return n}(r):"number"==typeof r?isNaN(r)||r===1/0||r===-1/0?n:s.today().add(r,"d"):s.newDate(r)}})},{"./main":346,"object-assign":247}],348:[function(r,n,i){"use strict";n.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],349:[function(r,n,i){"use strict";var a=r("./arrow_paths"),o=r("../../plots/font_attributes"),s=r("../../plots/cartesian/constants"),l=r("../../plot_api/plot_template").templatedArray;r("../../constants/axis_placeable_objects"),n.exports=l("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:o({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:a.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",s.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",s.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",s.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",s.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:o({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":472,"../../plot_api/plot_template":543,"../../plots/cartesian/constants":561,"../../plots/font_attributes":585,"./arrow_paths":348}],350:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("./draw").draw;function l(r){var n=r._fullLayout;a.filterVisible(n.annotations).forEach(function(n){var i=o.getFromId(r,n.xref),a=o.getFromId(r,n.yref),s=o.getRefType(n.xref),l=o.getRefType(n.yref);n._extremes={},"range"===s&&c(n,i),"range"===l&&c(n,a)})}function c(r,n){var i,a=n._id,s=a.charAt(0),l=r[s],c=r["a"+s],u=r[s+"ref"],f=r["a"+s+"ref"],h=r["_"+s+"padplus"],p=r["_"+s+"padminus"],d={x:1,y:-1}[s]*r[s+"shift"],m=3*r.arrowsize*r.arrowwidth||0,g=m+d,v=m-d,y=3*r.startarrowsize*r.arrowwidth||0,x=y+d,b=y-d;if(f===u){var _=o.findExtremes(n,[n.r2c(l)],{ppadplus:g,ppadminus:v}),w=o.findExtremes(n,[n.r2c(c)],{ppadplus:Math.max(h,x),ppadminus:Math.max(p,b)});i={min:[_.min[0],w.min[0]],max:[_.max[0],w.max[0]]}}else x=c?x+c:x,b=c?b-c:b,i=o.findExtremes(n,[n.r2c(l)],{ppadplus:Math.max(h,g,x),ppadminus:Math.max(p,v,b)});r._extremes[a]=i}n.exports=function(r){var n=r._fullLayout;if(a.filterVisible(n.annotations).length&&r._fullData.length)return a.syncOrAsync([s,l],r)}},{"../../lib":503,"../../plots/cartesian/axes":554,"./draw":355}],351:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../registry"),s=r("../../plot_api/plot_template").arrayEditor;function l(r,n){var i,a,o,s,l,u,f,h=r._fullLayout.annotations,p=[],d=[],m=[],g=(n||[]).length;for(i=0;i<h.length;i++)if(s=(o=h[i]).clicktoshow){for(a=0;a<g;a++)if(u=(l=n[a]).xaxis,f=l.yaxis,u._id===o.xref&&f._id===o.yref&&u.d2r(l.x)===c(o._xclick,u)&&f.d2r(l.y)===c(o._yclick,f)){(o.visible?"onout"===s?d:m:p).push(i);break}a===g&&o.visible&&"onout"===s&&d.push(i)}return{on:p,off:d,explicitOff:m}}function c(r,n){return"log"===n.type?n.l2r(r):n.d2r(r)}n.exports={hasClickToShow:function(r,n){var i=l(r,n);return i.on.length>0||i.explicitOff.length>0},onClick:function(r,n){var i,c,u=l(r,n),f=u.on,h=u.off.concat(u.explicitOff),p={},d=r._fullLayout.annotations;if(f.length||h.length){for(i=0;i<f.length;i++)(c=s(r.layout,"annotations",d[f[i]])).modifyItem("visible",!0),a.extendFlat(p,c.getUpdateObj());for(i=0;i<h.length;i++)(c=s(r.layout,"annotations",d[h[i]])).modifyItem("visible",!1),a.extendFlat(p,c.getUpdateObj());return o.call("update",r,{},p)}}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../registry":638}],352:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../color");n.exports=function(r,n,i,s){s("opacity");var l=s("bgcolor"),c=s("bordercolor"),u=o.opacity(c);s("borderpad");var f=s("borderwidth"),h=s("showarrow");if(s("text",h?" ":i._dfltTitle.annotation),s("textangle"),a.coerceFont(s,"font",i.font),s("width"),s("align"),s("height")&&s("valign"),h){var p,d,m=s("arrowside");-1!==m.indexOf("end")&&(p=s("arrowhead"),d=s("arrowsize")),-1!==m.indexOf("start")&&(s("startarrowhead",p),s("startarrowsize",d)),s("arrowcolor",u?n.bordercolor:o.defaultLine),s("arrowwidth",2*(u&&f||1)),s("standoff"),s("startstandoff")}var g=s("hovertext"),v=i.hoverlabel||{};if(g){var y=s("hoverlabel.bgcolor",v.bgcolor||(o.opacity(l)?o.rgb(l):o.defaultLine)),x=s("hoverlabel.bordercolor",v.bordercolor||o.contrast(y));a.coerceFont(s,"hoverlabel.font",{family:v.font.family,size:v.font.size,color:v.font.color||x})}s("captureevents",!!g)}},{"../../lib":503,"../color":366}],353:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib/to_log_range");n.exports=function(r,n,i,s){n=n||{};var l="log"===i&&"linear"===n.type,c="linear"===i&&"log"===n.type;if(l||c)for(var u,f,h=r._fullLayout.annotations,p=n._id.charAt(0),d=0;d<h.length;d++)u=h[d],f="annotations["+d+"].",u[p+"ref"]===n._id&&m(p),u["a"+p+"ref"]===n._id&&m("a"+p);function m(r){var i=u[r],c=null;a(c=l?o(i,n.range):Math.pow(10,i))||(c=null),s(f+r,c)}}},{"../../lib/to_log_range":531,"fast-isnumeric":190}],354:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("../../plots/array_container_defaults"),l=r("./common_defaults"),c=r("./attributes");function u(r,n,i){function s(i,o){return a.coerce(r,n,c,i,o)}var u=s("visible"),f=s("clicktoshow");if(u||f){l(r,n,i,s);for(var h=n.showarrow,p=["x","y"],d=[-10,-30],m={_fullLayout:i},g=0;g<2;g++){var v=p[g],y=o.coerceRef(r,n,m,v,"","paper");if("paper"!==y&&o.getFromId(m,y)._annIndices.push(n._index),o.coercePosition(n,m,s,y,v,.5),h){var x="a"+v,b=o.coerceRef(r,n,m,x,"pixel",["pixel","paper"]);"pixel"!==b&&b!==y&&(b=n[x]="pixel");var _="pixel"===b?d[g]:.4;o.coercePosition(n,m,s,b,x,_)}s(v+"anchor"),s(v+"shift")}if(a.noneOrAll(r,n,["x","y"]),h&&a.noneOrAll(r,n,["ax","ay"]),f){var w=s("xclick"),T=s("yclick");n._xclick=void 0===w?n.x:o.cleanPosition(w,m,n.xref),n._yclick=void 0===T?n.y:o.cleanPosition(T,m,n.yref)}}}n.exports=function(r,n){s(r,n,{name:"annotations",handleItemDefaults:u})}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"./attributes":349,"./common_defaults":352}],355:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../registry"),s=r("../../plots/plots"),l=r("../../lib"),c=l.strTranslate,u=r("../../plots/cartesian/axes"),f=r("../color"),h=r("../drawing"),p=r("../fx"),d=r("../../lib/svg_text_utils"),m=r("../../lib/setcursor"),g=r("../dragelement"),v=r("../../plot_api/plot_template").arrayEditor,y=r("./draw_arrow_head");function x(r,n){var i=r._fullLayout.annotations[n]||{},a=u.getFromId(r,i.xref),o=u.getFromId(r,i.yref);a&&a.setScale(),o&&o.setScale(),_(r,i,n,!1,a,o)}function b(r,n,i,a,o){var s=o[i],l=o[i+"ref"],c=-1!==i.indexOf("y"),f="domain"===u.getRefType(l),h=c?a.h:a.w;return r?f?s+(c?-n:n)/r._length:r.p2r(r.r2p(s)+n):s+(c?-n:n)/h}function _(r,n,i,s,x,_){var w,T,k=r._fullLayout,A=r._fullLayout._size,M=r._context.edits;s?(w="annotation-"+s,T=s+".annotations"):(w="annotation",T="annotations");var S=v(r.layout,T,n),E=S.modifyBase,L=S.modifyItem,C=S.getUpdateObj;k._infolayer.selectAll("."+w+'[data-index="'+i+'"]').remove();var P="clip"+k._uid+"_ann"+i;if(n._input&&!1!==n.visible){var I={x:{},y:{}},O=+n.textangle||0,z=k._infolayer.append("g").classed(w,!0).attr("data-index",String(i)).style("opacity",n.opacity),D=z.append("g").classed("annotation-text-g",!0),R=M[n.showarrow?"annotationTail":"annotationPosition"],F=n.captureevents||M.annotationText||R,B=D.append("g").style("pointer-events",F?"all":null).call(m,"pointer").on("click",function(){r._dragging=!1,r.emit("plotly_clickannotation",X(a.event))});n.hovertext&&B.on("mouseover",function(){var i=n.hoverlabel,a=i.font,o=this.getBoundingClientRect(),s=r.getBoundingClientRect();p.loneHover({x0:o.left-s.left,x1:o.right-s.left,y:(o.top+o.bottom)/2-s.top,text:n.hovertext,color:i.bgcolor,borderColor:i.bordercolor,fontFamily:a.family,fontSize:a.size,fontColor:a.color},{container:k._hoverlayer.node(),outerContainer:k._paper.node(),gd:r})}).on("mouseout",function(){p.loneUnhover(k._hoverlayer.node())});var N=n.borderwidth,j=n.borderpad,U=N+j,V=B.append("rect").attr("class","bg").style("stroke-width",N+"px").call(f.stroke,n.bordercolor).call(f.fill,n.bgcolor),H=n.width||n.height,q=k._topclips.selectAll("#"+P).data(H?[0]:[]);q.enter().append("clipPath").classed("annclip",!0).attr("id",P).append("rect"),q.exit().remove();var G=n.font,Y=k._meta?l.templateString(n.text,k._meta):n.text,W=B.append("text").classed("annotation-text",!0).text(Y);M.annotationText?W.call(d.makeEditable,{delegate:B,gd:r}).call(Z).on("edit",function(i){n.text=i,this.call(Z),L("text",i),x&&x.autorange&&E(x._name+".autorange",!0),_&&_.autorange&&E(_._name+".autorange",!0),o.call("_guiRelayout",r,C())}):W.call(Z)}else a.selectAll("#"+P).remove();function X(r){var a={index:i,annotation:n._input,fullAnnotation:n,event:r};return s&&(a.subplotId=s),a}function Z(i){return i.call(h.font,G).attr({"text-anchor":{left:"start",right:"end"}[n.align]||"middle"}),d.convertToTspans(i,r,J),i}function J(){var i=W.selectAll("a");1===i.size()&&i.text()===W.text()&&B.insert("a",":first-child").attr({"xlink:xlink:href":i.attr("xlink:href"),"xlink:xlink:show":i.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(V.node());var a=B.select(".annotation-text-math-group"),p=!a.empty(),v=h.bBox((p?a:W).node()),w=v.width,T=v.height,S=n.width||w,F=n.height||T,j=Math.round(S+2*U),G=Math.round(F+2*U);function Y(r,n){return"auto"===n&&(n=r<1/3?"left":r>2/3?"right":"center"),({center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5})[n]}for(var Z=!1,J=["x","y"],K=0;K<J.length;K++){var Q,$,tt,te,tr,tn=J[K],ti=n[tn+"ref"]||tn,ta=n["a"+tn+"ref"],to={x:x,y:_}[tn],ts=(O+("x"===tn?0:-90))*Math.PI/180,tl=j*Math.cos(ts),tc=G*Math.sin(ts),tu=Math.abs(tl)+Math.abs(tc),tf=n[tn+"anchor"],th=n[tn+"shift"]*("x"===tn?1:-1),tp=I[tn],td=u.getRefType(ti);if(to&&"domain"!==td){var tm=to.r2fraction(n[tn]);(tm<0||tm>1)&&(ta===ti?((tm=to.r2fraction(n["a"+tn]))<0||tm>1)&&(Z=!0):Z=!0),Q=to._offset+to.r2p(n[tn]),te=.5}else{var tg="domain"===td;"x"===tn?(tt=n[tn],Q=tg?to._offset+to._length*tt:Q=A.l+A.w*tt):(tt=1-n[tn],Q=tg?to._offset+to._length*tt:Q=A.t+A.h*tt),te=n.showarrow?.5:tt}if(n.showarrow){tp.head=Q;var tv=n["a"+tn];if(tr=tl*Y(.5,n.xanchor)-tc*Y(.5,n.yanchor),ta===ti){var ty=u.getRefType(ta);"domain"===ty?("y"===tn&&(tv=1-tv),tp.tail=to._offset+to._length*tv):"paper"===ty?"y"===tn?(tv=1-tv,tp.tail=A.t+A.h*tv):tp.tail=A.l+A.w*tv:tp.tail=to._offset+to.r2p(tv),$=tr}else tp.tail=Q+tv,$=tr+tv;tp.text=tp.tail+tr;var tx=k["x"===tn?"width":"height"];if("paper"===ti&&(tp.head=l.constrain(tp.head,1,tx-1)),"pixel"===ta){var tb=-Math.max(tp.tail-3,tp.text),t_=Math.min(tp.tail+3,tp.text)-tx;tb>0?(tp.tail+=tb,tp.text+=tb):t_>0&&(tp.tail-=t_,tp.text-=t_)}tp.tail+=th,tp.head+=th}else $=tr=tu*Y(te,tf),tp.text=Q+tr;tp.text+=th,tr+=th,$+=th,n["_"+tn+"padplus"]=tu/2+$,n["_"+tn+"padminus"]=tu/2-$,n["_"+tn+"size"]=tu,n["_"+tn+"shift"]=tr}if(Z)B.remove();else{var tw=0,tT=0;if("left"!==n.align&&(tw=(S-w)*("center"===n.align?.5:1)),"top"!==n.valign&&(tT=(F-T)*("middle"===n.valign?.5:1)),p)a.select("svg").attr({x:U+tw-1,y:U+tT}).call(h.setClipUrl,H?P:null,r);else{var tk=U+tT-v.top,tA=U+tw-v.left;W.call(d.positionText,tA,tk).call(h.setClipUrl,H?P:null,r)}q.select("rect").call(h.setRect,U,U,S,F),V.call(h.setRect,N/2,N/2,j-N,G-N),B.call(h.setTranslate,Math.round(I.x.text-j/2),Math.round(I.y.text-G/2)),D.attr({transform:"rotate("+O+","+I.x.text+","+I.y.text+")"});var tM,tS=function(i,a){z.selectAll(".annotation-arrow-g").remove();var u=I.x.head,p=I.y.head,d=I.x.tail+i,m=I.y.tail+a,v=I.x.text+i,w=I.y.text+a,T=l.rotationXYMatrix(O,v,w),k=l.apply2DTransform(T),S=l.apply2DTransform2(T),P=+V.attr("width"),R=+V.attr("height"),F=v-.5*P,N=F+P,j=w-.5*R,U=j+R,H=[[F,j,F,U],[F,U,N,U],[N,U,N,j],[N,j,F,j]].map(S);if(!H.reduce(function(r,n){return!!l.segmentsIntersect(u,p,u+1e6,p+1e6,n[0],n[1],n[2],n[3])^r},!1)){H.forEach(function(r){var n=l.segmentsIntersect(d,m,u,p,r[0],r[1],r[2],r[3]);n&&(d=n.x,m=n.y)});var q=n.arrowwidth,G=n.arrowcolor,Y=n.arrowside,W=z.append("g").style({opacity:f.opacity(G)}).classed("annotation-arrow-g",!0),X=W.append("path").attr("d","M"+d+","+m+"L"+u+","+p).style("stroke-width",q+"px").call(f.stroke,f.rgb(G));if(y(X,Y,n),M.annotationPosition&&X.node().parentNode&&!s){var Z=u,J=p;if(n.standoff){var K=Math.sqrt(Math.pow(u-d,2)+Math.pow(p-m,2));Z+=n.standoff*(d-u)/K,J+=n.standoff*(m-p)/K}var Q,$,tt=W.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(d-Z)+","+(m-J),transform:c(Z,J)}).style("stroke-width",q+6+"px").call(f.stroke,"rgba(0,0,0,0)").call(f.fill,"rgba(0,0,0,0)");g.init({element:tt.node(),gd:r,prepFn:function(){var r=h.getTranslate(B);Q=r.x,$=r.y,x&&x.autorange&&E(x._name+".autorange",!0),_&&_.autorange&&E(_._name+".autorange",!0)},moveFn:function(r,i){var a=k(Q,$),o=a[0]+r,s=a[1]+i;B.call(h.setTranslate,o,s),L("x",b(x,r,"x",A,n)),L("y",b(_,i,"y",A,n)),n.axref===n.xref&&L("ax",b(x,r,"ax",A,n)),n.ayref===n.yref&&L("ay",b(_,i,"ay",A,n)),W.attr("transform",c(r,i)),D.attr({transform:"rotate("+O+","+o+","+s+")"})},doneFn:function(){o.call("_guiRelayout",r,C());var n=document.querySelector(".js-notes-box-panel");n&&n.redraw(n.selectedObj)}})}}};n.showarrow&&tS(0,0),R&&g.init({element:B.node(),gd:r,prepFn:function(){tM=D.attr("transform")},moveFn:function(r,i){var a="pointer";if(n.showarrow)n.axref===n.xref?L("ax",b(x,r,"ax",A,n)):L("ax",n.ax+r),n.ayref===n.yref?L("ay",b(_,i,"ay",A.w,n)):L("ay",n.ay+i),tS(r,i);else{if(s)return;if(x)o=b(x,r,"x",A,n);else{var o,l,u=n._xsize/A.w,f=n.x+(n._xshift-n.xshift)/A.w-u/2;o=g.align(f+r/A.w,u,0,1,n.xanchor)}if(_)l=b(_,i,"y",A,n);else{var h=n._ysize/A.h,p=n.y-(n._yshift+n.yshift)/A.h-h/2;l=g.align(p-i/A.h,h,0,1,n.yanchor)}L("x",o),L("y",l),x&&_||(a=g.getCursor(x?.5:o,_?.5:l,n.xanchor,n.yanchor))}D.attr({transform:c(r,i)+tM}),m(B,a)},clickFn:function(i,a){n.captureevents&&r.emit("plotly_clickannotation",X(a))},doneFn:function(){m(B),o.call("_guiRelayout",r,C());var n=document.querySelector(".js-notes-box-panel");n&&n.redraw(n.selectedObj)}})}}}n.exports={draw:function(r){var n=r._fullLayout;n._infolayer.selectAll(".annotation").remove();for(var i=0;i<n.annotations.length;i++)n.annotations[i].visible&&x(r,i);return s.previousPromises(r)},drawOne:x,drawRaw:_}},{"../../lib":503,"../../lib/setcursor":524,"../../lib/svg_text_utils":529,"../../plot_api/plot_template":543,"../../plots/cartesian/axes":554,"../../plots/plots":619,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"../fx":406,"./draw_arrow_head":356,"@plotly/d3":58}],356:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../color"),s=r("./arrow_paths"),l=r("../../lib"),c=l.strScale,u=l.strRotate,f=l.strTranslate;n.exports=function(r,n,i){var l,h,p,d,m=r.node(),g=s[i.arrowhead||0],v=s[i.startarrowhead||0],y=(i.arrowwidth||1)*(i.arrowsize||1),x=(i.arrowwidth||1)*(i.startarrowsize||1),b=n.indexOf("start")>=0,_=n.indexOf("end")>=0,w=g.backoff*y+i.standoff,T=v.backoff*x+i.startstandoff;if("line"===m.nodeName){l={x:+r.attr("x1"),y:+r.attr("y1")},h={x:+r.attr("x2"),y:+r.attr("y2")};var k=l.x-h.x,A=l.y-h.y;if(d=(p=Math.atan2(A,k))+Math.PI,w&&T&&w+T>Math.sqrt(k*k+A*A))return void R();if(w){if(w*w>k*k+A*A)return void R();var M=w*Math.cos(p),S=w*Math.sin(p);h.x+=M,h.y+=S,r.attr({x2:h.x,y2:h.y})}if(T){if(T*T>k*k+A*A)return void R();var E=T*Math.cos(p),L=T*Math.sin(p);l.x-=E,l.y-=L,r.attr({x1:l.x,y1:l.y})}}else if("path"===m.nodeName){var C=m.getTotalLength(),P="";if(C<w+T)return void R();var I=m.getPointAtLength(0),O=m.getPointAtLength(.1);p=Math.atan2(I.y-O.y,I.x-O.x),l=m.getPointAtLength(Math.min(T,C)),P="0px,"+T+"px,";var z=m.getPointAtLength(C),D=m.getPointAtLength(C-.1);d=Math.atan2(z.y-D.y,z.x-D.x),h=m.getPointAtLength(Math.max(0,C-w)),P+=C-(P?T+w:w)+"px,"+C+"px",r.style("stroke-dasharray",P)}function R(){r.style("stroke-dasharray","0px,100px")}function F(n,s,l,h){n.path&&(n.noRotate&&(l=0),a.select(m.parentNode).append("path").attr({class:r.attr("class"),d:n.path,transform:f(s.x,s.y)+u(180*l/Math.PI)+c(h)}).style({fill:o.rgb(i.arrowcolor),"stroke-width":0}))}b&&F(v,l,p,x),_&&F(g,h,d,y)}},{"../../lib":503,"../color":366,"./arrow_paths":348,"@plotly/d3":58}],357:[function(r,n,i){"use strict";var a=r("./draw"),o=r("./click");n.exports={moduleType:"component",name:"annotations",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),includeBasePlot:r("../../plots/cartesian/include_components")("annotations"),calcAutorange:r("./calc_autorange"),draw:a.draw,drawOne:a.drawOne,drawRaw:a.drawRaw,hasClickToShow:o.hasClickToShow,onClick:o.onClick,convertCoords:r("./convert_coords")}},{"../../plots/cartesian/include_components":567,"./attributes":349,"./calc_autorange":350,"./click":351,"./convert_coords":353,"./defaults":354,"./draw":355}],358:[function(r,n,i){"use strict";var a=r("../annotations/attributes"),o=r("../../plot_api/edit_types").overrideAll,s=r("../../plot_api/plot_template").templatedArray;n.exports=o(s("annotation",{visible:a.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:a.xanchor,xshift:a.xshift,yanchor:a.yanchor,yshift:a.yshift,text:a.text,textangle:a.textangle,font:a.font,width:a.width,height:a.height,opacity:a.opacity,align:a.align,valign:a.valign,bgcolor:a.bgcolor,bordercolor:a.bordercolor,borderpad:a.borderpad,borderwidth:a.borderwidth,showarrow:a.showarrow,arrowcolor:a.arrowcolor,arrowhead:a.arrowhead,startarrowhead:a.startarrowhead,arrowside:a.arrowside,arrowsize:a.arrowsize,startarrowsize:a.startarrowsize,arrowwidth:a.arrowwidth,standoff:a.standoff,startstandoff:a.startstandoff,hovertext:a.hovertext,hoverlabel:a.hoverlabel,captureevents:a.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../annotations/attributes":349}],359:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes");n.exports=function(r){for(var n=r.fullSceneLayout.annotations,i=0;i<n.length;i++)!function(r,n){var i=n.fullSceneLayout.domain,s=n.fullLayout._size,l={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};r._xa={},a.extendFlat(r._xa,l),o.setConvert(r._xa),r._xa._offset=s.l+i.x[0]*s.w,r._xa.l2p=function(){return .5*(1+r._pdata[0]/r._pdata[3])*s.w*(i.x[1]-i.x[0])},r._ya={},a.extendFlat(r._ya,l),o.setConvert(r._ya),r._ya._offset=s.t+(1-i.y[1])*s.h,r._ya.l2p=function(){return .5*(1-r._pdata[1]/r._pdata[3])*s.h*(i.y[1]-i.y[0])}}(n[i],r);r.fullLayout._infolayer.selectAll(".annotation-"+r.id).remove()}},{"../../lib":503,"../../plots/cartesian/axes":554}],360:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("../../plots/array_container_defaults"),l=r("../annotations/common_defaults"),c=r("./attributes");function u(r,n,i,s){function u(i,o){return a.coerce(r,n,c,i,o)}function f(r){var a=r+"axis",s={_fullLayout:{}};return s._fullLayout[a]=i[a],o.coercePosition(n,s,u,r,r,.5)}u("visible")&&(l(r,n,s.fullLayout,u),f("x"),f("y"),f("z"),a.noneOrAll(r,n,["x","y","z"]),n.xref="x",n.yref="y",n.zref="z",u("xanchor"),u("yanchor"),u("xshift"),u("yshift"),n.showarrow&&(n.axref="pixel",n.ayref="pixel",u("ax",-10),u("ay",-30),a.noneOrAll(r,n,["ax","ay"])))}n.exports=function(r,n,i){s(r,n,{name:"annotations",handleItemDefaults:u,fullLayout:i.fullLayout})}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"../annotations/common_defaults":352,"./attributes":358}],361:[function(r,n,i){"use strict";var a=r("../annotations/draw").drawRaw,o=r("../../plots/gl3d/project"),s=["x","y","z"];n.exports=function(r){for(var n=r.fullSceneLayout,i=r.dataScale,l=n.annotations,c=0;c<l.length;c++){for(var u=l[c],f=!1,h=0;h<3;h++){var p=s[h],d=u[p],m=n[p+"axis"].r2fraction(d);if(m<0||m>1){f=!0;break}}f?r.fullLayout._infolayer.select(".annotation-"+r.id+'[data-index="'+c+'"]').remove():(u._pdata=o(r.glplot.cameraParams,[n.xaxis.r2l(u.x)*i[0],n.yaxis.r2l(u.y)*i[1],n.zaxis.r2l(u.z)*i[2]]),a(r.graphDiv,u,c,r.id,u._xa,u._ya))}}},{"../../plots/gl3d/project":607,"../annotations/draw":355}],362:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib");n.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:r("./attributes")}}},layoutAttributes:r("./attributes"),handleDefaults:r("./defaults"),includeBasePlot:function(r,n){var i=a.subplotsRegistry.gl3d;if(i)for(var s=i.attrRegex,l=Object.keys(r),c=0;c<l.length;c++){var u=l[c];s.test(u)&&(r[u].annotations||[]).length&&(o.pushUnique(n._basePlotModules,i),o.pushUnique(n._subplots.gl3d,u))}},convert:r("./convert"),draw:r("./draw")}},{"../../lib":503,"../../registry":638,"./attributes":358,"./convert":359,"./defaults":360,"./draw":361}],363:[function(r,n,i){"use strict";n.exports=r("world-calendars/dist/main"),r("world-calendars/dist/plus"),r("world-calendars/dist/calendars/chinese"),r("world-calendars/dist/calendars/coptic"),r("world-calendars/dist/calendars/discworld"),r("world-calendars/dist/calendars/ethiopian"),r("world-calendars/dist/calendars/hebrew"),r("world-calendars/dist/calendars/islamic"),r("world-calendars/dist/calendars/julian"),r("world-calendars/dist/calendars/mayan"),r("world-calendars/dist/calendars/nanakshahi"),r("world-calendars/dist/calendars/nepali"),r("world-calendars/dist/calendars/persian"),r("world-calendars/dist/calendars/taiwan"),r("world-calendars/dist/calendars/thai"),r("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":332,"world-calendars/dist/calendars/coptic":333,"world-calendars/dist/calendars/discworld":334,"world-calendars/dist/calendars/ethiopian":335,"world-calendars/dist/calendars/hebrew":336,"world-calendars/dist/calendars/islamic":337,"world-calendars/dist/calendars/julian":338,"world-calendars/dist/calendars/mayan":339,"world-calendars/dist/calendars/nanakshahi":340,"world-calendars/dist/calendars/nepali":341,"world-calendars/dist/calendars/persian":342,"world-calendars/dist/calendars/taiwan":343,"world-calendars/dist/calendars/thai":344,"world-calendars/dist/calendars/ummalqura":345,"world-calendars/dist/main":346,"world-calendars/dist/plus":347}],364:[function(r,n,i){"use strict";var a=r("./calendars"),o=r("../../lib"),s=r("../../constants/numerical"),l=s.EPOCHJD,c=s.ONEDAY,u={valType:"enumerated",values:o.sortObjectKeys(a.calendars),editType:"calc",dflt:"gregorian"},f=function(r,n,i,a){var s={};return s[i]=u,o.coerce(r,n,s,i,a)},h={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},p={};function d(r){var n=p[r];return n||(n=p[r]=a.instance(r))}function m(r){return o.extendFlat({},u,{description:r})}function g(r){return"Sets the calendar system to use with `"+r+"` date data."}var v={xcalendar:m(g("x"))},y=o.extendFlat({},v,{ycalendar:m(g("y"))}),x=o.extendFlat({},y,{zcalendar:m(g("z"))}),b=m("Sets the calendar system to use for `range` and `tick0` if this is a date axis. This does not set the calendar for interpreting data on this axis, that's specified in the trace or via the global `layout.calendar`");n.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:y,bar:y,box:y,heatmap:y,contour:y,histogram:y,histogram2d:y,histogram2dcontour:y,scatter3d:x,surface:x,mesh3d:x,scattergl:y,ohlc:v,candlestick:v},layout:{calendar:m("Sets the default calendar system to use for interpreting and displaying dates throughout the plot.")},subplots:{xaxis:{calendar:b},yaxis:{calendar:b},scene:{xaxis:{calendar:b},yaxis:{calendar:b},zaxis:{calendar:b}},polar:{radialaxis:{calendar:b}}},transforms:{filter:{valuecalendar:m("WARNING: All transforms are deprecated and may be removed from the API in next major version. Sets the calendar system to use for `value`, if it is a date."),targetcalendar:m("WARNING: All transforms are deprecated and may be removed from the API in next major version. Sets the calendar system to use for `target`, if it is an array of dates. If `target` is a string (eg *x*) we use the corresponding trace attribute (eg `xcalendar`) if it exists, even if `targetcalendar` is provided.")}}},layoutAttributes:u,handleDefaults:f,handleTraceDefaults:function(r,n,i,a){for(var o=0;o<i.length;o++)f(r,n,i[o]+"calendar",a.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:d,worldCalFmt:function(r,n,i){for(var a,o,s,u,f,p=Math.floor((n+.05)/c)+l,m=d(i).fromJD(p),g=0;-1!==(g=r.indexOf("%",g));)"0"===(a=r.charAt(g+1))||"-"===a||"_"===a?(s=3,o=r.charAt(g+2),"_"===a&&(a="-")):(o=a,a="0",s=2),(u=h[o])?(f="##"===u?"##":m.formatDate(u[a]),r=r.substr(0,g)+f+r.substr(g+s),g+=f.length):g+=s;return r}}},{"../../constants/numerical":479,"../../lib":503,"./calendars":363}],365:[function(r,n,i){"use strict";i.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],i.defaultLine="#444",i.lightLine="#eee",i.background="#fff",i.borderLine="#BEC8D9",i.lightFraction=1e3/11},{}],366:[function(r,n,i){"use strict";var a=r("tinycolor2"),o=r("fast-isnumeric"),s=r("../../lib/array").isTypedArray,l=n.exports={},c=r("./attributes");l.defaults=c.defaults;var u=l.defaultLine=c.defaultLine;l.lightLine=c.lightLine;var f=l.background=c.background;function h(r){if(o(r)||"string"!=typeof r)return r;var n=r.trim();if("rgb"!==n.substr(0,3))return r;var i=n.match(/^rgba?\s*\(([^()]*)\)$/);if(!i)return r;var a=i[1].trim().split(/\s*[\s,]\s*/),s="a"===n.charAt(3)&&4===a.length;if(!s&&3!==a.length)return r;for(var l=0;l<a.length;l++){if(!a[l].length||(a[l]=Number(a[l]),!(a[l]>=0)))return r;if(3===l)a[l]>1&&(a[l]=1);else if(a[l]>=1)return r}var c=Math.round(255*a[0])+", "+Math.round(255*a[1])+", "+Math.round(255*a[2]);return s?"rgba("+c+", "+a[3]+")":"rgb("+c+")"}l.tinyRGB=function(r){var n=r.toRgb();return"rgb("+Math.round(n.r)+", "+Math.round(n.g)+", "+Math.round(n.b)+")"},l.rgb=function(r){return l.tinyRGB(a(r))},l.opacity=function(r){return r?a(r).getAlpha():0},l.addOpacity=function(r,n){var i=a(r).toRgb();return"rgba("+Math.round(i.r)+", "+Math.round(i.g)+", "+Math.round(i.b)+", "+n+")"},l.combine=function(r,n){var i=a(r).toRgb();if(1===i.a)return a(r).toRgbString();var o=a(n||f).toRgb(),s=1===o.a?o:{r:255*(1-o.a)+o.r*o.a,g:255*(1-o.a)+o.g*o.a,b:255*(1-o.a)+o.b*o.a};return a({r:s.r*(1-i.a)+i.r*i.a,g:s.g*(1-i.a)+i.g*i.a,b:s.b*(1-i.a)+i.b*i.a}).toRgbString()},l.contrast=function(r,n,i){var o=a(r);return 1!==o.getAlpha()&&(o=a(l.combine(r,f))),(o.isDark()?n?o.lighten(n):f:i?o.darken(i):u).toString()},l.stroke=function(r,n){var i=a(n);r.style({stroke:l.tinyRGB(i),"stroke-opacity":i.getAlpha()})},l.fill=function(r,n){var i=a(n);r.style({fill:l.tinyRGB(i),"fill-opacity":i.getAlpha()})},l.clean=function(r){if(r&&"object"==typeof r){var n,i,a,o,c=Object.keys(r);for(n=0;n<c.length;n++)if(o=r[a=c[n]],"color"===a.substr(a.length-5)){if(Array.isArray(o))for(i=0;i<o.length;i++)o[i]=h(o[i]);else r[a]=h(o)}else if("colorscale"===a.substr(a.length-10)&&Array.isArray(o))for(i=0;i<o.length;i++)Array.isArray(o[i])&&(o[i][1]=h(o[i][1]));else if(Array.isArray(o)){var u=o[0];if(!Array.isArray(u)&&u&&"object"==typeof u)for(i=0;i<o.length;i++)l.clean(o[i])}else o&&"object"==typeof o&&!s(o)&&l.clean(o)}}},{"../../lib/array":485,"./attributes":365,"fast-isnumeric":190,tinycolor2:312}],367:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/layout_attributes"),o=r("../../plots/font_attributes"),s=r("../../lib/extend").extendFlat,l=r("../../plot_api/edit_types").overrideAll;n.exports=l({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:a.linecolor,outlinewidth:a.linewidth,bordercolor:a.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:a.tickmode,nticks:a.nticks,tick0:a.tick0,dtick:a.dtick,tickvals:a.tickvals,ticktext:a.ticktext,ticks:s({},a.ticks,{dflt:""}),ticklabeloverflow:s({},a.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:a.ticklen,tickwidth:a.tickwidth,tickcolor:a.tickcolor,showticklabels:a.showticklabels,tickfont:o({}),tickangle:a.tickangle,tickformat:a.tickformat,tickformatstops:a.tickformatstops,tickprefix:a.tickprefix,showtickprefix:a.showtickprefix,ticksuffix:a.ticksuffix,showticksuffix:a.showticksuffix,separatethousands:a.separatethousands,exponentformat:a.exponentformat,minexponent:a.minexponent,showexponent:a.showexponent,title:{text:{valType:"string"},font:o({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:o({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/cartesian/layout_attributes":569,"../../plots/font_attributes":585}],368:[function(r,n,i){"use strict";n.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],369:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plot_api/plot_template"),s=r("../../plots/cartesian/tick_value_defaults"),l=r("../../plots/cartesian/tick_mark_defaults"),c=r("../../plots/cartesian/tick_label_defaults"),u=r("../../plots/cartesian/prefix_suffix_defaults"),f=r("./attributes");n.exports=function(r,n,i){var h=o.newContainer(n,"colorbar"),p=r.colorbar||{};function d(r,n){return a.coerce(p,h,f,r,n)}var m=i.margin||{t:0,b:0,l:0,r:0},g=i.width-m.l-m.r,v=i.height-m.t-m.b,y="v"===d("orientation"),x=d("thicknessmode");d("thickness","fraction"===x?30/(y?g:v):30);var b=d("lenmode");d("len","fraction"===b?1:y?v:g),d("x",y?1.02:.5),d("xanchor",y?"left":"center"),d("xpad"),d("y",y?.5:1.02),d("yanchor",y?"middle":"bottom"),d("ypad"),a.noneOrAll(p,h,["x","y"]),d("outlinecolor"),d("outlinewidth"),d("bordercolor"),d("borderwidth"),d("bgcolor");var _=a.coerce(p,h,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:y?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");d("ticklabeloverflow",-1!==_.indexOf("inside")?"hide past domain":"hide past div"),s(p,h,d,"linear");var w=i.font,T={outerTicks:!1,font:w};-1!==_.indexOf("inside")&&(T.bgColor="black"),u(p,h,d,"linear",T),c(p,h,d,"linear",T),l(p,h,d,"linear",T),d("title.text",i._dfltTitle.colorbar);var k=h.tickfont,A=a.extendFlat({},k,{color:w.color,size:a.bigFont(k.size)});a.coerceFont(d,"title.font",A),d("title.side",y?"top":"right")}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/cartesian/prefix_suffix_defaults":573,"../../plots/cartesian/tick_label_defaults":578,"../../plots/cartesian/tick_mark_defaults":579,"../../plots/cartesian/tick_value_defaults":580,"./attributes":367}],370:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("tinycolor2"),s=r("../../plots/plots"),l=r("../../registry"),c=r("../../plots/cartesian/axes"),u=r("../dragelement"),f=r("../../lib"),h=f.strTranslate,p=r("../../lib/extend").extendFlat,d=r("../../lib/setcursor"),m=r("../drawing"),g=r("../color"),v=r("../titles"),y=r("../../lib/svg_text_utils"),x=r("../colorscale/helpers").flipScale,b=r("../../plots/cartesian/axis_defaults"),_=r("../../plots/cartesian/position_defaults"),w=r("../../plots/cartesian/layout_attributes"),T=r("../../constants/alignment"),k=T.LINE_SPACING,A=T.FROM_TL,M=T.FROM_BR,S=r("./constants").cn;n.exports={draw:function(r){var n=r._fullLayout._infolayer.selectAll("g."+S.colorbar).data(function(r){var n,i,a,o,s=r._fullLayout,l=r.calcdata,c=[];function u(r){return p(r,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function f(){"function"==typeof o.calc?o.calc(r,a,n):(n._fillgradient=i.reversescale?x(i.colorscale):i.colorscale,n._zrange=[i[o.min],i[o.max]])}for(var h=0;h<l.length;h++){var d=(a=l[h][0].trace)._module.colorbar;if(!0===a.visible&&d)for(var m=Array.isArray(d),g=m?d:[d],v=0;v<g.length;v++){var y=(o=g[v]).container;(i=y?a[y]:a)&&i.showscale&&((n=u(i.colorbar))._id="cb"+a.uid+(m&&y?"-"+y:""),n._traceIndex=a.index,n._propPrefix=(y?y+".":"")+"colorbar.",n._meta=a._meta,f(),c.push(n))}}for(var b in s._colorAxes)if((i=s[b]).showscale){var _=s._colorAxes[b];(n=u(i.colorbar))._id="cb"+b,n._propPrefix=b+".colorbar.",n._meta=s._meta,o={min:"cmin",max:"cmax"},"heatmap"!==_[0]&&(a=_[1],o.calc=a._module.colorbar.calc),f(),c.push(n)}return c}(r),function(r){return r._id});n.enter().append("g").attr("class",function(r){return r._id}).classed(S.colorbar,!0),n.each(function(n){var i,x,T,E,L,C=a.select(this);f.ensureSingle(C,"rect",S.cbbg),f.ensureSingle(C,"g",S.cbfills),f.ensureSingle(C,"g",S.cblines),f.ensureSingle(C,"g",S.cbaxis,function(r){r.classed(S.crisp,!0)}),f.ensureSingle(C,"g",S.cbtitleunshift,function(r){r.append("g").classed(S.cbtitle,!0)}),f.ensureSingle(C,"rect",S.cboutline);var P=function(r,n,i){var l="v"===n.orientation,u=n.len,d=n.lenmode,x=n.thickness,T=n.thicknessmode,E=n.outlinewidth,L=n.borderwidth,C=n.bgcolor,P=n.xanchor,I=n.yanchor,O=n.xpad,z=n.ypad,D=n.x,R=l?n.y:1-n.y,F=i._fullLayout,B=F._size,N=n._fillcolor,j=n._line,U=n.title,V=U.side,H=n._zrange||a.extent(("function"==typeof N?N:j.color).domain()),q="function"==typeof j.color?j.color:function(){return j.color},G="function"==typeof N?N:function(){return N},Y=n._levels,W=function(r,n,i){var a,o,s=n._levels,l=[],c=[],u=s.end+s.size/100,f=s.size,h=1.001*i[0]-.001*i[1],p=1.001*i[1]-.001*i[0];for(o=0;o<1e5&&(a=s.start+o*f,!(f>0?a>=u:a<=u));o++)a>h&&a<p&&l.push(a);if(n._fillgradient)c=[0];else if("function"==typeof n._fillcolor){var d=n._filllevels;if(d)for(u=d.end+d.size/100,f=d.size,o=0;o<1e5&&(a=d.start+o*f,!(f>0?a>=u:a<=u));o++)a>i[0]&&a<i[1]&&c.push(a);else(c=l.map(function(r){return r-s.size/2})).push(c[c.length-1]+s.size)}else n._fillcolor&&"string"==typeof n._fillcolor&&(c=[0]);return s.size<0&&(l.reverse(),c.reverse()),{line:l,fill:c}}(0,n,H),X=W.fill,Z=W.line,J=Math.round(x*("fraction"===T?l?B.w:B.h:1)),K=J/(l?B.w:B.h),Q=Math.round(u*("fraction"===d?l?B.h:B.w:1)),$=Q/(l?B.h:B.w),tt=Math.round(l?D*B.w+O:R*B.h+z),te={center:.5,right:1}[P]||0,tr={top:1,middle:.5}[I]||0,tn=l?D-te*K:R-tr*K,ti=l?R-tr*$:D-te*$,ta=Math.round(l?B.h*(1-ti):B.w*ti);n._lenFrac=$,n._thickFrac=K,n._uFrac=tn,n._vFrac=ti;var to=n._axis=function(r,n,i){var a=r._fullLayout,o="v"===n.orientation,s={type:"linear",range:i,tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:n.ticks,ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,showticklabels:n.showticklabels,ticklabelposition:n.ticklabelposition,ticklabeloverflow:n.ticklabeloverflow,tickfont:n.tickfont,tickangle:n.tickangle,tickformat:n.tickformat,exponentformat:n.exponentformat,minexponent:n.minexponent,separatethousands:n.separatethousands,showexponent:n.showexponent,showtickprefix:n.showtickprefix,tickprefix:n.tickprefix,showticksuffix:n.showticksuffix,ticksuffix:n.ticksuffix,title:n.title,showline:!0,anchor:"free",side:o?"right":"bottom",position:1},l=o?"y":"x",c={type:"linear",_id:l+n._id},u={letter:l,font:a.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:a.calendar};function h(r,n){return f.coerce(s,c,w,r,n)}return b(s,c,h,u,a),_(s,c,h,u),c}(i,n,H);to.position=K+(l?D+O/B.w:R+z/B.h);var ts=-1!==["top","bottom"].indexOf(V);if(l&&ts&&(to.title.side=V,to.titlex=D+O/B.w,to.titley=ti+("top"===U.side?$-z/B.h:z/B.h)),l||ts||(to.title.side=V,to.titley=R+z/B.h,to.titlex=ti+O/B.w),j.color&&"auto"===n.tickmode){to.tickmode="linear",to.tick0=Y.start;var tl=Y.size,tc=f.constrain(Q/50,4,15)+1,tu=(H[1]-H[0])/((n.nticks||tc)*tl);if(tu>1){var tf=Math.pow(10,Math.floor(Math.log(tu)/Math.LN10));tl*=tf*f.roundUp(tu/tf,[2,5,10]),(Math.abs(Y.start)/Y.size+1e-6)%1<2e-6&&(to.tick0=0)}to.dtick=tl}to.domain=l?[ti+z/B.h,ti+$-z/B.h]:[ti+O/B.w,ti+$-O/B.w],to.setScale(),r.attr("transform",h(Math.round(B.l),Math.round(B.t)));var th,tp=r.select("."+S.cbtitleunshift).attr("transform",h(-Math.round(B.l),-Math.round(B.t))),td=to.ticklabelposition,tm=to.title.font.size,tg=r.select("."+S.cbaxis),tv=0,ty=0;function tx(a,o){var s={propContainer:to,propName:n._propPrefix+"title",traceIndex:n._traceIndex,_meta:n._meta,placeholder:F._dfltTitle.colorbar,containerGroup:r.select("."+S.cbtitle)},l="h"===a.charAt(0)?a.substr(1):"h"+a;r.selectAll("."+l+",."+l+"-math-group").remove(),v.draw(i,a,p(s,o||{}))}return f.syncOrAsync([s.previousPromises,function(){var r,n;(l&&ts||!l&&!ts)&&("top"===V&&(r=O+B.l+B.w*D,n=z+B.t+B.h*(1-ti-$)+3+.75*tm),"bottom"===V&&(r=O+B.l+B.w*D,n=z+B.t+B.h*(1-ti)-3-.25*tm),"right"===V&&(n=z+B.t+B.h*R+3+.75*tm,r=O+B.l+B.w*ti),tx(to._id+"title",{attributes:{x:r,y:n,"text-anchor":l?"start":"middle"}}))},function(){if(!l&&!ts||l&&ts){var s,u=r.select("."+S.cbtitle),p=u.select("text"),d=[-E/2,E/2],g=u.select(".h"+to._id+"title-math-group").node(),v=15.6;if(p.node()&&(v=parseInt(p.node().style.fontSize,10)*k),g?(ty=(s=m.bBox(g)).width,(tv=s.height)>v&&(d[1]-=(tv-v)/2)):p.node()&&!p.classed(S.jsPlaceholder)&&(ty=(s=m.bBox(p.node())).width,tv=s.height),l){if(tv){if(tv+=5,"top"===V)to.domain[1]-=tv/B.h,d[1]*=-1;else{to.domain[0]+=tv/B.h;var x=y.lineCount(p);d[1]+=(1-x)*v}u.attr("transform",h(d[0],d[1])),to.setScale()}}else ty&&("right"===V&&(to.domain[0]+=(ty+tm/2)/B.w),u.attr("transform",h(d[0],d[1])),to.setScale())}r.selectAll("."+S.cbfills+",."+S.cblines).attr("transform",l?h(0,Math.round(B.h*(1-to.domain[1]))):h(Math.round(B.w*to.domain[0]),0)),tg.attr("transform",l?h(0,Math.round(-B.t)):h(Math.round(-B.l),0));var b=r.select("."+S.cbfills).selectAll("rect."+S.cbfill).attr("style","").data(X);b.enter().append("rect").classed(S.cbfill,!0).style("stroke","none"),b.exit().remove();var _=H.map(to.c2p).map(Math.round).sort(function(r,n){return r-n});b.each(function(r,s){var c=[0===s?H[0]:(X[s]+X[s-1])/2,s===X.length-1?H[1]:(X[s]+X[s+1])/2].map(to.c2p).map(Math.round);l&&(c[1]=f.constrain(c[1]+(c[1]>c[0])?1:-1,_[0],_[1]));var u=a.select(this).attr(l?"x":"y",tt).attr(l?"y":"x",a.min(c)).attr(l?"width":"height",Math.max(J,2)).attr(l?"height":"width",Math.max(a.max(c)-a.min(c),2));if(n._fillgradient)m.gradient(u,i,n._id,l?"vertical":"horizontalreversed",n._fillgradient,"fill");else{var h=G(r).replace("e-","");u.attr("fill",o(h).toHexString())}});var w=r.select("."+S.cblines).selectAll("path."+S.cbline).data(j.color&&j.width?Z:[]);w.enter().append("path").classed(S.cbline,!0),w.exit().remove(),w.each(function(r){var n=Math.round(to.c2p(r))+j.width/2%1;a.select(this).attr("d","M"+(l?tt+","+n:n+","+tt)+(l?"h":"v")+J).call(m.lineGroupStyle,j.width,q(r),j.dash)}),tg.selectAll("g."+to._id+"tick,path").remove();var T=tt+J+(E||0)/2-("outside"===n.ticks?1:0),A=c.calcTicks(to),M=c.getTickSigns(to)[2];return c.drawTicks(i,to,{vals:"inside"===to.ticks?c.clipEnds(to,A):A,layer:tg,path:c.makeTickPath(to,T,M),transFn:c.makeTransTickFn(to)}),c.drawLabels(i,to,{vals:A,layer:tg,transFn:c.makeTransTickLabelFn(to),labelFns:c.makeLabelFns(to,T)})},function(){if(l&&!ts||!l&&ts){var r,o,s=to.position||0,c=to._offset+to._length/2;if("right"===V)o=c,r=B.l+B.w*s+10+tm*(to.showticklabels?1:.5);else if(r=c,"bottom"===V&&(o=B.t+B.h*s+10+(-1===td.indexOf("inside")?to.tickfont.size:0)+("intside"!==to.ticks&&n.ticklen||0)),"top"===V){var u=U.text.split("<br>").length;o=B.t+B.h*s+10-J-k*tm*u}tx((l?"h":"v")+to._id+"title",{avoid:{selection:a.select(i).selectAll("g."+to._id+"tick"),side:V,offsetTop:l?0:B.t,offsetLeft:l?B.l:0,maxShift:l?F.width:F.height},attributes:{x:r,y:o,"text-anchor":"middle"},transform:{rotate:l?-90:0,offset:0}})}},s.previousPromises,function(){var a,c=J+E/2;-1===td.indexOf("inside")&&(a=m.bBox(tg.node()),c+=l?a.width:a.height),th=tp.select("text");var f=0,p=l&&"top"===V,v=!l&&"right"===V,y=0;if(th.node()&&!th.classed(S.jsPlaceholder)){var b,_=tp.select(".h"+to._id+"title-math-group").node();_&&(l&&ts||!l&&!ts)?(f=(a=m.bBox(_)).width,b=a.height):(f=(a=m.bBox(tp.node())).right-B.l-(l?tt:ta),b=a.bottom-B.t-(l?ta:tt),l||"top"!==V||(c+=a.height,y=a.height)),v&&(th.attr("transform",h(f/2+tm/2,0)),f*=2),c=Math.max(c,l?f:b)}var w=2*(l?O:z)+c+L+E/2,k=0;!l&&U.text&&"bottom"===I&&R<=0&&(w+=k=w/2,y+=k),F._hColorbarMoveTitle=k,F._hColorbarMoveCBTitle=y;var N=L+E;r.select("."+S.cbbg).attr("x",(l?tt:ta)-N/2-(l?O:0)).attr("y",(l?ta:tt)-(l?Q:z+y-k)).attr(l?"width":"height",Math.max(w-k,2)).attr(l?"height":"width",Math.max(Q+N,2)).call(g.fill,C).call(g.stroke,n.bordercolor).style("stroke-width",L);var j=v?Math.max(f-10,0):0;if(r.selectAll("."+S.cboutline).attr("x",(l?tt:ta+O)+j).attr("y",(l?ta+z-Q:tt)+(p?tv:0)).attr(l?"width":"height",Math.max(J,2)).attr(l?"height":"width",Math.max(Q-(l?2*z+tv:2*O+j),2)).call(g.stroke,n.outlinecolor).style({fill:"none","stroke-width":E}),r.attr("transform",h(B.l-(l?te*w:0),B.t-(l?0:(1-tr)*w-y))),!l&&(L||o(C).getAlpha()&&!o.equals(F.paper_bgcolor,C))){var H=tg.selectAll("text"),q=H[0].length,G=r.select("."+S.cbbg).node(),Y=m.bBox(G),W=m.getTranslate(r);H.each(function(r,n){var i=q-1;if(0===n||n===i){var a,o=m.bBox(this),s=m.getTranslate(this);if(n===i){var l=o.right+s.x;(a=Y.right+W.x+ta-L-2+D-l)>0&&(a=0)}else if(0===n){var c=o.left+s.x;(a=Y.left+W.x+ta+L+2-c)<0&&(a=0)}a&&(q<3?this.setAttribute("transform","translate("+a+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var X={},Z=A[P],K=M[P],$=A[I],tn=M[I],ti=w-J;l?("pixels"===d?(X.y=R,X.t=Q*$,X.b=Q*tn):(X.t=X.b=0,X.yt=R+u*$,X.yb=R-u*tn),"pixels"===T?(X.x=D,X.l=w*Z,X.r=w*K):(X.l=ti*Z,X.r=ti*K,X.xl=D-x*Z,X.xr=D+x*K)):("pixels"===d?(X.x=D,X.l=Q*Z,X.r=Q*K):(X.l=X.r=0,X.xl=D+u*Z,X.xr=D-u*K),"pixels"===T?(X.y=1-R,X.t=w*$,X.b=w*tn):(X.t=ti*$,X.b=ti*tn,X.yt=R-x*$,X.yb=R+x*tn)),s.autoMargin(i,n._id,X)}],i)}(C,n,r);P&&P.then&&(r._promises||[]).push(P),r._context.edits.colorbarPosition&&(E="v"===n.orientation,L=r._fullLayout._size,u.init({element:C.node(),gd:r,prepFn:function(){i=C.attr("transform"),d(C)},moveFn:function(r,a){C.attr("transform",i+h(r,a)),x=u.align((E?n._uFrac:n._vFrac)+r/L.w,E?n._thickFrac:n._lenFrac,0,1,n.xanchor),T=u.align((E?n._vFrac:1-n._uFrac)-a/L.h,E?n._lenFrac:n._thickFrac,0,1,n.yanchor),d(C,u.getCursor(x,T,n.xanchor,n.yanchor))},doneFn:function(){if(d(C),void 0!==x&&void 0!==T){var i={};i[n._propPrefix+"x"]=x,i[n._propPrefix+"y"]=T,void 0!==n._traceIndex?l.call("_guiRestyle",r,i,n._traceIndex):l.call("_guiRelayout",r,i)}}}))}),n.exit().each(function(n){s.autoMargin(r,n._id)}).remove(),n.order()}}},{"../../constants/alignment":471,"../../lib":503,"../../lib/extend":493,"../../lib/setcursor":524,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_defaults":556,"../../plots/cartesian/layout_attributes":569,"../../plots/cartesian/position_defaults":572,"../../plots/plots":619,"../../registry":638,"../color":366,"../colorscale/helpers":377,"../dragelement":385,"../drawing":388,"../titles":464,"./constants":368,"@plotly/d3":58,tinycolor2:312}],371:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r){return a.isPlainObject(r.colorbar)}},{"../../lib":503}],372:[function(r,n,i){"use strict";n.exports={moduleType:"component",name:"colorbar",attributes:r("./attributes"),supplyDefaults:r("./defaults"),draw:r("./draw").draw,hasColorbar:r("./has_colorbar")}},{"./attributes":367,"./defaults":369,"./draw":370,"./has_colorbar":371}],373:[function(r,n,i){"use strict";var a=r("../colorbar/attributes"),o=r("../../lib/regex").counter,s=r("../../lib/sort_object_keys"),l=r("./scales.js").scales;function c(r){return"`"+r+"`"}s(l),n.exports=function(r,n){r=r||"";var i,s=(n=n||{}).cLetter||"c",u=("onlyIfNumerical"in n&&n.onlyIfNumerical,"noScale"in n?n.noScale:"marker.line"===r),f="showScaleDflt"in n?n.showScaleDflt:"z"===s,h="string"==typeof n.colorscaleDflt?l[n.colorscaleDflt]:null,p=n.editTypeOverride||"",d=r?r+".":"";"colorAttr"in n?(i=n.colorAttr,n.colorAttr):c(d+(i=({z:"z",c:"color"})[s]));var m=s+"auto",g=s+"min",v=s+"max",y=(c(d+m),c(d+g),c(d+v),{});y[g]=y[v]=void 0;var x={};x[m]=!1;var b={};return"color"===i&&(b.color={valType:"color",arrayOk:!0,editType:p||"style"},n.anim&&(b.color.anim=!0)),b[m]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:y},b[g]={valType:"number",dflt:null,editType:p||"plot",impliedEdits:x},b[v]={valType:"number",dflt:null,editType:p||"plot",impliedEdits:x},b[s+"mid"]={valType:"number",dflt:null,editType:"calc",impliedEdits:y},b.colorscale={valType:"colorscale",editType:"calc",dflt:h,impliedEdits:{autocolorscale:!1}},b.autocolorscale={valType:"boolean",dflt:!1!==n.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},b.reversescale={valType:"boolean",dflt:!1,editType:"plot"},u||(b.showscale={valType:"boolean",dflt:f,editType:"calc"},b.colorbar=a),n.noColorAxis||(b.coloraxis={valType:"subplotid",regex:o("coloraxis"),dflt:null,editType:"calc"}),b}},{"../../lib/regex":520,"../../lib/sort_object_keys":526,"../colorbar/attributes":367,"./scales.js":381}],374:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("./helpers").extractOpts;n.exports=function(r,n,i){var l,c=r._fullLayout,u=i.vals,f=i.containerStr,h=f?o.nestedProperty(n,f).get():n,p=s(h),d=!1!==p.auto,m=p.min,g=p.max,v=p.mid,y=function(){return o.aggNums(Math.min,null,u)},x=function(){return o.aggNums(Math.max,null,u)};void 0===m?m=y():d&&(m=h._colorAx&&a(m)?Math.min(m,y()):y()),void 0===g?g=x():d&&(g=h._colorAx&&a(g)?Math.max(g,x()):x()),d&&void 0!==v&&(g-v>v-m?m=v-(g-v):g-v<v-m&&(g=v+(v-m))),m===g&&(m-=.5,g+=.5),p._sync("min",m),p._sync("max",g),p.autocolorscale&&(l=m*g<0?c.colorscale.diverging:m>=0?c.colorscale.sequential:c.colorscale.sequentialminus,p._sync("colorscale",l))}},{"../../lib":503,"./helpers":377,"fast-isnumeric":190}],375:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./helpers").hasColorscale,s=r("./helpers").extractOpts;n.exports=function(r,n){function i(r,n){var i=r["_"+n];void 0!==i&&(r[n]=i)}function l(r,o){var l=o.container?a.nestedProperty(r,o.container).get():r;if(l){if(l.coloraxis)l._colorAx=n[l.coloraxis];else{var c=s(l),u=c.auto;(u||void 0===c.min)&&i(l,o.min),(u||void 0===c.max)&&i(l,o.max),c.autocolorscale&&i(l,"colorscale")}}}for(var c=0;c<r.length;c++){var u=r[c],f=u._module.colorbar;if(f){if(Array.isArray(f))for(var h=0;h<f.length;h++)l(u,f[h]);else l(u,f)}o(u,"marker.line")&&l(u,{container:"marker.line",min:"cmin",max:"cmax"})}for(var p in n._colorAxes)l(n[p],{min:"cmin",max:"cmax"})}},{"../../lib":503,"./helpers":377}],376:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../colorbar/has_colorbar"),l=r("../colorbar/defaults"),c=r("./scales").isValid,u=r("../../registry").traceIs;function f(r,n){var i=n.slice(0,n.length-1);return n?o.nestedProperty(r,i).get()||{}:r}n.exports=function r(n,i,h,p,d){var m=d.prefix,g=d.cLetter,v="_module"in i,y=f(n,m),x=f(i,m),b=f(i._template||{},m)||{},_=function(){return delete n.coloraxis,delete i.coloraxis,r(n,i,h,p,d)};if(v){var w=h._colorAxes||{},T=p(m+"coloraxis");if(T){var k=u(i,"contour")&&o.nestedProperty(i,"contours.coloring").get()||"heatmap",A=w[T];return void(A?(A[2].push(_),A[0]!==k&&(A[0]=!1,o.warn(["Ignoring coloraxis:",T,"setting","as it is linked to incompatible colorscales."].join(" ")))):w[T]=[k,i,[_]])}}var M=y[g+"min"],S=y[g+"max"];p(m+g+"auto",!(a(M)&&a(S)&&M<S))?p(m+g+"mid"):(p(m+g+"min"),p(m+g+"max"));var E,L,C=y.colorscale,P=b.colorscale;void 0!==C&&(E=!c(C)),void 0!==P&&(E=!c(P)),p(m+"autocolorscale",E),p(m+"colorscale"),p(m+"reversescale"),"marker.line."!==m&&(m&&v&&(L=s(y)),p(m+"showscale",L)&&(m&&b&&(x._template=b),l(y,x,h)))}},{"../../lib":503,"../../registry":638,"../colorbar/defaults":369,"../colorbar/has_colorbar":371,"./scales":381,"fast-isnumeric":190}],377:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("tinycolor2"),s=r("fast-isnumeric"),l=r("../../lib"),c=r("../color"),u=r("./scales").isValid,f=["showscale","autocolorscale","colorscale","reversescale","colorbar"],h=["min","max","mid","auto"];function p(r){var n,i,a,o,s=r._colorAx,l=s||r,c={};for(a=0;a<f.length;a++)c[o=f[a]]=l[o];if(s)for(i="c",a=0;a<h.length;a++)c[o=h[a]]=l["c"+o];else{for(a=0;a<h.length;a++)((n="c"+(o=h[a]))in l||(n="z"+o)in l)&&(c[o]=l[n]);i=n.charAt(0)}return c._sync=function(r,n){var a=-1!==h.indexOf(r)?i+r:r;l[a]=l["_"+a]=n},c}function d(r){for(var n=p(r),i=n.min,a=n.max,o=n.reversescale?m(n.colorscale):n.colorscale,s=o.length,l=Array(s),c=Array(s),u=0;u<s;u++){var f=o[u];l[u]=i+f[0]*(a-i),c[u]=f[1]}return{domain:l,range:c}}function m(r){for(var n=r.length,i=Array(n),a=n-1,o=0;a>=0;a--,o++){var s=r[a];i[o]=[1-s[0],s[1]]}return i}function g(r,n){n=n||{};for(var i=r.domain,l=r.range,u=l.length,f=Array(u),h=0;h<u;h++){var p=o(l[h]).toRgb();f[h]=[p.r,p.g,p.b,p.a]}var d,m=a.scale.linear().domain(i).range(f).clamp(!0),g=n.noNumericCheck,y=n.returnArray;return(d=g&&y?m:g?function(r){return v(m(r))}:y?function(r){return s(r)?m(r):o(r).isValid()?r:c.defaultLine}:function(r){return s(r)?v(m(r)):o(r).isValid()?r:c.defaultLine}).domain=m.domain,d.range=function(){return l},d}function v(r){return o({r:r[0],g:r[1],b:r[2],a:r[3]}).toRgbString()}n.exports={hasColorscale:function(r,n,i){var a=n?l.nestedProperty(r,n).get()||{}:r,o=a[i||"color"],c=!1;if(l.isArrayOrTypedArray(o)){for(var f=0;f<o.length;f++)if(s(o[f])){c=!0;break}}return l.isPlainObject(a)&&(c||!0===a.showscale||s(a.cmin)&&s(a.cmax)||u(a.colorscale)||l.isPlainObject(a.colorbar))},extractOpts:p,extractScale:d,flipScale:m,makeColorScaleFunc:g,makeColorScaleFuncFromTrace:function(r,n){return g(d(r),n)}}},{"../../lib":503,"../color":366,"./scales":381,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:312}],378:[function(r,n,i){"use strict";var a=r("./scales"),o=r("./helpers");n.exports={moduleType:"component",name:"colorscale",attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),handleDefaults:r("./defaults"),crossTraceDefaults:r("./cross_trace_defaults"),calc:r("./calc"),scales:a.scales,defaultScale:a.defaultScale,getScale:a.get,isValidScale:a.isValid,hasColorscale:o.hasColorscale,extractOpts:o.extractOpts,extractScale:o.extractScale,flipScale:o.flipScale,makeColorScaleFunc:o.makeColorScaleFunc,makeColorScaleFuncFromTrace:o.makeColorScaleFuncFromTrace}},{"./attributes":373,"./calc":374,"./cross_trace_defaults":375,"./defaults":376,"./helpers":377,"./layout_attributes":379,"./layout_defaults":380,"./scales":381}],379:[function(r,n,i){"use strict";var a=r("../../lib/extend").extendFlat,o=r("./attributes"),s=r("./scales").scales;n.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:s.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:s.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:s.RdBu,editType:"calc"}},coloraxis:a({_isSubplotObj:!0,editType:"calc"},o("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":493,"./attributes":373,"./scales":381}],380:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plot_api/plot_template"),s=r("./layout_attributes"),l=r("./defaults");n.exports=function(r,n){function i(i,o){return a.coerce(r,n,s,i,o)}i("colorscale.sequential"),i("colorscale.sequentialminus"),i("colorscale.diverging");var c,u,f=n._colorAxes;function h(r,n){return a.coerce(c,u,s.coloraxis,r,n)}for(var p in f){var d=f[p];if(d[0])c=r[p]||{},(u=o.newContainer(n,p,"coloraxis"))._name=p,l(c,u,n,h,{prefix:"",cLetter:"c"});else{for(var m=0;m<d[2].length;m++)d[2][m]();delete n._colorAxes[p]}}}},{"../../lib":503,"../../plot_api/plot_template":543,"./defaults":376,"./layout_attributes":379}],381:[function(r,n,i){"use strict";var a=r("tinycolor2"),o={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},s=o.RdBu;function l(r){var n=0;if(!Array.isArray(r)||r.length<2||!r[0]||!r[r.length-1]||0!=+r[0][0]||1!=+r[r.length-1][0])return!1;for(var i=0;i<r.length;i++){var o=r[i];if(2!==o.length||+o[0]<n||!a(o[1]).isValid())return!1;n=+o[0]}return!0}n.exports={scales:o,defaultScale:s,get:function(r,n){if(n||(n=s),!r)return n;function i(){try{r=o[r]||JSON.parse(r)}catch(i){r=n}}return"string"==typeof r&&(i(),"string"==typeof r&&i()),l(r)?r:n},isValid:function(r){return void 0!==o[r]||l(r)}}},{tinycolor2:312}],382:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o){var s=(r-i)/(a-i),l=s+n/(a-i),c=(s+l)/2;return"left"===o||"bottom"===o?s:"center"===o||"middle"===o?c:"right"===o||"top"===o?l:s<2/3-c?s:l>4/3-c?l:c}},{}],383:[function(r,n,i){"use strict";var a=r("../../lib"),o=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];n.exports=function(r,n,i,s){return r="left"===i?0:"center"===i?1:"right"===i?2:a.constrain(Math.floor(3*r),0,2),o[n="bottom"===s?0:"middle"===s?1:"top"===s?2:a.constrain(Math.floor(3*n),0,2)][r]}},{"../../lib":503}],384:[function(r,n,i){"use strict";i.selectMode=function(r){return"lasso"===r||"select"===r},i.drawMode=function(r){return"drawclosedpath"===r||"drawopenpath"===r||"drawline"===r||"drawrect"===r||"drawcircle"===r},i.openMode=function(r){return"drawline"===r||"drawopenpath"===r},i.rectMode=function(r){return"select"===r||"drawline"===r||"drawrect"===r||"drawcircle"===r},i.freeMode=function(r){return"lasso"===r||"drawclosedpath"===r||"drawopenpath"===r},i.selectingOrDrawing=function(r){return i.freeMode(r)||i.rectMode(r)}},{}],385:[function(r,n,i){"use strict";var a=r("mouse-event-offset"),o=r("has-hover"),s=r("has-passive-events"),l=r("../../lib").removeElement,c=r("../../plots/cartesian/constants"),u=n.exports={};u.align=r("./align"),u.getCursor=r("./cursor");var f=r("./unhover");function h(){var r=document.createElement("div");r.className="dragcover";var n=r.style;return n.position="fixed",n.left=0,n.right=0,n.top=0,n.bottom=0,n.zIndex=999999999,n.background="none",document.body.appendChild(r),r}function p(r){return a(r.changedTouches?r.changedTouches[0]:r,document.body)}u.unhover=f.wrapped,u.unhoverRaw=f.raw,u.init=function(r){var n,i,a,f,d,m,g,v,y=r.gd,x=1,b=y._context.doubleClickDelay,_=r.element;y._mouseDownTime||(y._mouseDownTime=0),_.style.pointerEvents="all",_.onmousedown=T,s?(_._ontouchstart&&_.removeEventListener("touchstart",_._ontouchstart),_._ontouchstart=T,_.addEventListener("touchstart",T,{passive:!1})):_.ontouchstart=T;var w=r.clampFn||function(r,n,i){return Math.abs(r)<i&&(r=0),Math.abs(n)<i&&(n=0),[r,n]};function T(s){y._dragged=!1,y._dragging=!0;var l=p(s);n=l[0],i=l[1],g=s.target,m=s,v=2===s.buttons||s.ctrlKey,void 0===s.clientX&&void 0===s.clientY&&(s.clientX=n,s.clientY=i),(a=(new Date).getTime())-y._mouseDownTime<b?x+=1:(x=1,y._mouseDownTime=a),r.prepFn&&r.prepFn(s,n,i),o&&!v?(d=h()).style.cursor=window.getComputedStyle(_).cursor:o||(d=document,f=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(_).cursor),document.addEventListener("mouseup",A),document.addEventListener("touchend",A),!1!==r.dragmode&&(s.preventDefault(),document.addEventListener("mousemove",k),document.addEventListener("touchmove",k,{passive:!1}))}function k(a){a.preventDefault();var o=p(a),s=r.minDrag||c.MINDRAG,l=w(o[0]-n,o[1]-i,s),f=l[0],h=l[1];(f||h)&&(y._dragged=!0,u.unhover(y,a)),y._dragged&&r.moveFn&&!v&&(y._dragdata={element:_,dx:f,dy:h},r.moveFn(f,h))}function A(n){if(delete y._dragdata,!1!==r.dragmode&&(n.preventDefault(),document.removeEventListener("mousemove",k),document.removeEventListener("touchmove",k)),document.removeEventListener("mouseup",A),document.removeEventListener("touchend",A),o?l(d):f&&(d.documentElement.style.cursor=f,f=null),y._dragging){if(y._dragging=!1,(new Date).getTime()-y._mouseDownTime>b&&(x=Math.max(x-1,1)),y._dragged)r.doneFn&&r.doneFn();else if(r.clickFn&&r.clickFn(x,m),!v){var i;try{i=new MouseEvent("click",n)}catch(r){var a=p(n);(i=document.createEvent("MouseEvents")).initMouseEvent("click",n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,a[0],a[1],n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget)}g.dispatchEvent(i)}y._dragging=!1,y._dragged=!1}else y._dragged=!1}},u.coverSlip=h},{"../../lib":503,"../../plots/cartesian/constants":561,"./align":382,"./cursor":383,"./unhover":386,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],386:[function(r,n,i){"use strict";var a=r("../../lib/events"),o=r("../../lib/throttle"),s=r("../../lib/dom").getGraphDiv,l=r("../fx/constants"),c=n.exports={};c.wrapped=function(r,n,i){(r=s(r))._fullLayout&&o.clear(r._fullLayout._uid+l.HOVERID),c.raw(r,n,i)},c.raw=function(r,n){var i=r._fullLayout,o=r._hoverdata;n||(n={}),n.target&&!r._dragged&&!1===a.triggerHandler(r,"plotly_beforehover",n)||(i._hoverlayer.selectAll("g").remove(),i._hoverlayer.selectAll("line").remove(),i._hoverlayer.selectAll("circle").remove(),r._hoverdata=void 0,n.target&&o&&r.emit("plotly_unhover",{event:n,points:o}))}},{"../../lib/dom":491,"../../lib/events":492,"../../lib/throttle":530,"../fx/constants":400}],387:[function(r,n,i){"use strict";i.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},i.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],388:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=o.numberFormat,l=r("fast-isnumeric"),c=r("tinycolor2"),u=r("../../registry"),f=r("../color"),h=r("../colorscale"),p=o.strTranslate,d=r("../../lib/svg_text_utils"),m=r("../../constants/xmlns_namespaces"),g=r("../../constants/alignment").LINE_SPACING,v=r("../../constants/interactions").DESELECTDIM,y=r("../../traces/scatter/subtypes"),x=r("../../traces/scatter/make_bubble_size_func"),b=r("../../components/fx/helpers").appendArrayPointValue,_=n.exports={};_.font=function(r,n,i,a){o.isPlainObject(n)&&(a=n.color,i=n.size,n=n.family),n&&r.style("font-family",n),i+1&&r.style("font-size",i+"px"),a&&r.call(f.fill,a)},_.setPosition=function(r,n,i){r.attr("x",n).attr("y",i)},_.setSize=function(r,n,i){r.attr("width",n).attr("height",i)},_.setRect=function(r,n,i,a,o){r.call(_.setPosition,n,i).call(_.setSize,a,o)},_.translatePoint=function(r,n,i,a){var o=i.c2p(r.x),s=a.c2p(r.y);return!!(l(o)&&l(s)&&n.node())&&("text"===n.node().nodeName?n.attr("x",o).attr("y",s):n.attr("transform",p(o,s)),!0)},_.translatePoints=function(r,n,i){r.each(function(r){var o=a.select(this);_.translatePoint(r,o,n,i)})},_.hideOutsideRangePoint=function(r,n,i,a,o,s){n.attr("display",i.isPtWithinRange(r,o)&&a.isPtWithinRange(r,s)?null:"none")},_.hideOutsideRangePoints=function(r,n){if(n._hasClipOnAxisFalse){var i=n.xaxis,o=n.yaxis;r.each(function(n){var s=n[0].trace,l=s.xcalendar,c=s.ycalendar,f=u.traceIs(s,"bar-like")?".bartext":".point,.textpoint";r.selectAll(f).each(function(r){_.hideOutsideRangePoint(r,a.select(this),i,o,l,c)})})}},_.crispRound=function(r,n,i){return n&&l(n)?r._context.staticPlot?n:n<1?1:Math.round(n):i||0},_.singleLineStyle=function(r,n,i,a,o){n.style("fill","none");var s=(((r||[])[0]||{}).trace||{}).line||{},l=i||s.width||0,c=o||s.dash||"";f.stroke(n,a||s.color),_.dashLine(n,c,l)},_.lineGroupStyle=function(r,n,i,o){r.style("fill","none").each(function(r){var s=(((r||[])[0]||{}).trace||{}).line||{},l=n||s.width||0,c=o||s.dash||"";a.select(this).call(f.stroke,i||s.color).call(_.dashLine,c,l)})},_.dashLine=function(r,n,i){i=+i||0,n=_.dashStyle(n,i),r.style({"stroke-dasharray":n,"stroke-width":i+"px"})},_.dashStyle=function(r,n){var i=Math.max(n=+n||1,3);return"solid"===r?r="":"dot"===r?r=i+"px,"+i+"px":"dash"===r?r=3*i+"px,"+3*i+"px":"longdash"===r?r=5*i+"px,"+5*i+"px":"dashdot"===r?r=3*i+"px,"+i+"px,"+i+"px,"+i+"px":"longdashdot"===r&&(r=5*i+"px,"+2*i+"px,"+i+"px,"+2*i+"px"),r},_.singleFillStyle=function(r){var n=(((a.select(r.node()).data()[0]||[])[0]||{}).trace||{}).fillcolor;n&&r.call(f.fill,n)},_.fillGroupStyle=function(r){r.style("stroke-width",0).each(function(r){var n=a.select(this);r[0].trace&&n.call(f.fill,r[0].trace.fillcolor)})};var w=r("./symbol_defs");_.symbolNames=[],_.symbolFuncs=[],_.symbolNeedLines={},_.symbolNoDot={},_.symbolNoFill={},_.symbolList=[],Object.keys(w).forEach(function(r){var n=w[r],i=n.n;_.symbolList.push(i,String(i),r,i+100,String(i+100),r+"-open"),_.symbolNames[i]=r,_.symbolFuncs[i]=n.f,n.needLine&&(_.symbolNeedLines[i]=!0),n.noDot?_.symbolNoDot[i]=!0:_.symbolList.push(i+200,String(i+200),r+"-dot",i+300,String(i+300),r+"-open-dot"),n.noFill&&(_.symbolNoFill[i]=!0)});var T=_.symbolNames.length;function k(r,n){return _.symbolFuncs[r%100](n)+(r>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}_.symbolNumber=function(r){if(l(r))r=+r;else if("string"==typeof r){var n=0;r.indexOf("-open")>0&&(n=100,r=r.replace("-open","")),r.indexOf("-dot")>0&&(n+=200,r=r.replace("-dot","")),(r=_.symbolNames.indexOf(r))>=0&&(r+=n)}return r%100>=T||r>=400?0:Math.floor(Math.max(r,0))};var A={x1:1,x2:0,y1:0,y2:0},M={x1:0,x2:0,y1:1,y2:0},S=s("~f"),E={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:A},horizontalreversed:{node:"linearGradient",attrs:A,reversed:!0},vertical:{node:"linearGradient",attrs:M},verticalreversed:{node:"linearGradient",attrs:M,reversed:!0}};_.gradient=function(r,n,i,s,l,u){for(var h=l.length,p=E[s],d=Array(h),m=0;m<h;m++)p.reversed?d[h-1-m]=[S(100*(1-l[m][0])),l[m][1]]:d[m]=[S(100*l[m][0]),l[m][1]];var g=n._fullLayout,v="g"+g._uid+"-"+i,y=g._defs.select(".gradients").selectAll("#"+v).data([s+d.join(";")],o.identity);y.exit().remove(),y.enter().append(p.node).each(function(){var r=a.select(this);p.attrs&&r.attr(p.attrs),r.attr("id",v);var n=r.selectAll("stop").data(d);n.exit().remove(),n.enter().append("stop"),n.each(function(r){var n=c(r[1]);a.select(this).attr({offset:r[0]+"%","stop-color":f.tinyRGB(n),"stop-opacity":n.getAlpha()})})}),r.style(u,F(v,n)).style(u+"-opacity",null);var x=function(r){return"."+r.attr("class").replace(/\s/g,".")},b=x(a.select(r.node().parentNode))+">"+x(r);g._gradientUrlQueryParts[b]=1},_.pattern=function(r,n,i,s,l,c,u,h,p,d,m,g){var v="legend"===n;h&&("overlay"===p?(d=h,m=f.contrast(d)):(d=void 0,m=h));var y,x,b,_,w,T,k,A=i._fullLayout,M="p"+A._uid+"-"+s,S={};switch(l){case"/":w="path",S={d:b="M-"+(y=c*Math.sqrt(2))/4+","+(x=c*Math.sqrt(2))/4+"l"+y/2+",-"+x/2+"M0,"+x+"L"+y+",0M"+y/4*3+","+x/4*5+"l"+y/2+",-"+x/2,opacity:g,stroke:m,"stroke-width":u*c+"px"};break;case"\\":w="path",S={d:b="M"+(y=c*Math.sqrt(2))/4*3+",-"+(x=c*Math.sqrt(2))/4+"l"+y/2+","+x/2+"M0,0L"+y+","+x+"M-"+y/4+","+x/4*3+"l"+y/2+","+x/2,opacity:g,stroke:m,"stroke-width":u*c+"px"};break;case"x":b="M-"+(y=c*Math.sqrt(2))/4+","+(x=c*Math.sqrt(2))/4+"l"+y/2+",-"+x/2+"M0,"+x+"L"+y+",0M"+y/4*3+","+x/4*5+"l"+y/2+",-"+x/2+"M"+y/4*3+",-"+x/4+"l"+y/2+","+x/2+"M0,0L"+y+","+x+"M-"+y/4+","+x/4*3+"l"+y/2+","+x/2,w="path",S={d:b,opacity:g,stroke:m,"stroke-width":c-c*Math.sqrt(1-u)+"px"};break;case"|":w="path",w="path",S={d:b="M"+(y=c)/2+",0L"+y/2+","+(x=c),opacity:g,stroke:m,"stroke-width":u*c+"px"};break;case"-":w="path",w="path",S={d:b="M0,"+(x=c)/2+"L"+(y=c)+","+x/2,opacity:g,stroke:m,"stroke-width":u*c+"px"};break;case"+":w="path",b="M"+(y=c)/2+",0L"+y/2+","+(x=c)+"M0,"+x/2+"L"+y+","+x/2,w="path",S={d:b,opacity:g,stroke:m,"stroke-width":c-c*Math.sqrt(1-u)+"px"};break;case".":y=c,x=c,u<Math.PI/4?_=Math.sqrt(u*c*c/Math.PI):(T=Math.PI/4,_=(k=c/2)+(c/Math.sqrt(2)-k)*(u-T)/(1-T)),w="circle",S={cx:y/2,cy:x/2,r:_,opacity:g,fill:m}}var E=[l||"noSh",d||"noBg",m||"noFg",c,u].join(";"),L=A._defs.select(".patterns").selectAll("#"+M).data([E],o.identity);L.exit().remove(),L.enter().append("pattern").each(function(){var r=a.select(this);if(r.attr({id:M,width:y+"px",height:x+"px",patternUnits:"userSpaceOnUse",patternTransform:v?"scale(0.8)":""}),d){var n=r.selectAll("rect").data([0]);n.exit().remove(),n.enter().append("rect").attr({width:y+"px",height:x+"px",fill:d})}var i=r.selectAll(w).data([0]);i.exit().remove(),i.enter().append(w).attr(S)}),r.style("fill",F(M,i)).style("fill-opacity",null),r.classed("pattern_filled",!0);var C="."+a.select(r.node().parentNode).attr("class").replace(/\s/g,".")+">.pattern_filled";A._patternUrlQueryParts[C]=1},_.initGradients=function(r){var n=r._fullLayout;o.ensureSingle(n._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),n._gradientUrlQueryParts={}},_.initPatterns=function(r){var n=r._fullLayout;o.ensureSingle(n._defs,"g","patterns").selectAll("pattern").remove(),n._patternUrlQueryParts={}},_.getPatternAttr=function(r,n,i){return r&&o.isArrayOrTypedArray(r)?n<r.length?r[n]:i:r},_.pointStyle=function(r,n,i){if(r.size()){var o=_.makePointStyleFns(n);r.each(function(r){_.singlePointStyle(r,a.select(this),n,o,i)})}},_.singlePointStyle=function(r,n,i,a,s){var l=i.marker,c=l.line;if(n.style("opacity",a.selectedOpacityFn?a.selectedOpacityFn(r):void 0===r.mo?l.opacity:r.mo),a.ms2mrc){u="various"===r.ms||"various"===l.size?3:a.ms2mrc(r.ms),r.mrc=u,a.selectedSizeFn&&(u=r.mrc=a.selectedSizeFn(r));var u,h=_.symbolNumber(r.mx||l.symbol)||0;r.om=h%200>=100,n.attr("d",k(h,u))}var p,d,m,g=!1;if(r.so)m=c.outlierwidth,d=c.outliercolor,p=l.outliercolor;else{var v=(c||{}).width;m=(r.mlw+1||v+1||(r.trace?(r.trace.marker.line||{}).width:0)+1)-1||0,d="mlc"in r?r.mlcc=a.lineScale(r.mlc):o.isArrayOrTypedArray(c.color)?f.defaultLine:c.color,o.isArrayOrTypedArray(l.color)&&(p=f.defaultLine,g=!0),p="mc"in r?r.mcc=a.markerScale(r.mc):l.color||"rgba(0,0,0,0)",a.selectedColorFn&&(p=a.selectedColorFn(r))}if(r.om)n.call(f.stroke,p).style({"stroke-width":(m||1)+"px",fill:"none"});else{n.style("stroke-width",(r.isBlank?0:m)+"px");var y=l.gradient,x=r.mgt;x?g=!0:x=y&&y.type,o.isArrayOrTypedArray(x)&&(E[x=x[0]]||(x=0));var b=l.pattern,w=b&&_.getPatternAttr(b.shape,r.i,"");if(x&&"none"!==x){var T=r.mgc;T?g=!0:T=y.color;var A=i.uid;g&&(A+="-"+r.i),_.gradient(n,s,A,x,[[0,T],[1,p]],"fill")}else if(w){var M=_.getPatternAttr(b.bgcolor,r.i,null),S=_.getPatternAttr(b.fgcolor,r.i,null),L=b.fgopacity,C=_.getPatternAttr(b.size,r.i,8),P=_.getPatternAttr(b.solidity,r.i,.3),I=r.mcc||o.isArrayOrTypedArray(b.shape)||o.isArrayOrTypedArray(b.bgcolor)||o.isArrayOrTypedArray(b.size)||o.isArrayOrTypedArray(b.solidity),O=i.uid;I&&(O+="-"+r.i),_.pattern(n,"point",s,O,w,C,P,r.mcc,b.fillmode,M,S,L)}else f.fill(n,p);m&&f.stroke(n,d)}},_.makePointStyleFns=function(r){var n={},i=r.marker;return n.markerScale=_.tryColorscale(i,""),n.lineScale=_.tryColorscale(i,"line"),u.traceIs(r,"symbols")&&(n.ms2mrc=y.isBubble(r)?x(r):function(){return(i.size||6)/2}),r.selectedpoints&&o.extendFlat(n,_.makeSelectedPointStyleFns(r)),n},_.makeSelectedPointStyleFns=function(r){var n={},i=r.selected||{},a=r.unselected||{},s=r.marker||{},l=i.marker||{},c=a.marker||{},f=s.opacity,h=l.opacity,p=c.opacity,d=void 0!==h,m=void 0!==p;(o.isArrayOrTypedArray(f)||d||m)&&(n.selectedOpacityFn=function(r){var n=void 0===r.mo?s.opacity:r.mo;return r.selected?d?h:n:m?p:v*n});var g=s.color,y=l.color,x=c.color;(y||x)&&(n.selectedColorFn=function(r){var n=r.mcc||g;return r.selected?y||n:x||n});var b=s.size,_=l.size,w=c.size,T=void 0!==_,k=void 0!==w;return u.traceIs(r,"symbols")&&(T||k)&&(n.selectedSizeFn=function(r){var n=r.mrc||b/2;return r.selected?T?_/2:n:k?w/2:n}),n},_.makeSelectedTextStyleFns=function(r){var n={},i=r.selected||{},a=r.unselected||{},o=r.textfont||{},s=i.textfont||{},l=a.textfont||{},c=o.color,u=s.color,h=l.color;return n.selectedTextColorFn=function(r){var n=r.tc||c;return r.selected?u||n:h||(u?n:f.addOpacity(n,v))},n},_.selectedPointStyle=function(r,n){if(r.size()&&n.selectedpoints){var i=_.makeSelectedPointStyleFns(n),o=n.marker||{},s=[];i.selectedOpacityFn&&s.push(function(r,n){r.style("opacity",i.selectedOpacityFn(n))}),i.selectedColorFn&&s.push(function(r,n){f.fill(r,i.selectedColorFn(n))}),i.selectedSizeFn&&s.push(function(r,n){var a=n.mx||o.symbol||0,s=i.selectedSizeFn(n);r.attr("d",k(_.symbolNumber(a),s)),n.mrc2=s}),s.length&&r.each(function(r){for(var n=a.select(this),i=0;i<s.length;i++)s[i](n,r)})}},_.tryColorscale=function(r,n){var i=n?o.nestedProperty(r,n).get():r;if(i){var a=i.color;if((i.colorscale||i._colorAx)&&o.isArrayOrTypedArray(a))return h.makeColorScaleFuncFromTrace(i)}return o.identity};var L={start:1,end:-1,middle:0,bottom:1,top:-1};function C(r,n,i,o,s){var l=a.select(r.node().parentNode),c=-1!==n.indexOf("top")?"top":-1!==n.indexOf("bottom")?"bottom":"middle",u=-1!==n.indexOf("left")?"end":-1!==n.indexOf("right")?"start":"middle",f=o?o/.8+1:0,h=(d.lineCount(r)-1)*g+1,m=L[u]*f,v=.75*i+L[c]*f+(L[c]-1)*h*i/2;r.attr("text-anchor",u),s||l.attr("transform",p(m,v))}function P(r,n){var i=r.ts||n.textfont.size;return l(i)&&i>0?i:0}function I(r,n,i,o){var s=r[0]-n[0],l=r[1]-n[1],c=i[0]-n[0],u=i[1]-n[1],f=Math.pow(s*s+l*l,.25),h=Math.pow(c*c+u*u,.25),p=(h*h*s-f*f*c)*o,d=(h*h*l-f*f*u)*o,m=3*h*(f+h),g=3*f*(f+h);return[[a.round(n[0]+(m&&p/m),2),a.round(n[1]+(m&&d/m),2)],[a.round(n[0]-(g&&p/g),2),a.round(n[1]-(g&&d/g),2)]]}_.textPointStyle=function(r,n,i){if(r.size()){if(n.selectedpoints){var s;s=_.makeSelectedTextStyleFns(n).selectedTextColorFn}var l=n.texttemplate,c=i._fullLayout;r.each(function(r){var u=a.select(this),f=l?o.extractOption(r,n,"txt","texttemplate"):o.extractOption(r,n,"tx","text");if(f||0===f){if(l){var h=n._module.formatLabels,p=h?h(r,n,c):{},m={};b(m,n,r.i);var g=n._meta||{};f=o.texttemplateString(f,p,c._d3locale,m,r,g)}var v=r.tp||n.textposition,y=P(r,n),x=s?s(r):r.tc||n.textfont.color;u.call(_.font,r.tf||n.textfont.family,y,x).text(f).call(d.convertToTspans,i).call(C,v,y,r.mrc)}else u.remove()})}},_.selectedTextStyle=function(r,n){if(r.size()&&n.selectedpoints){var i=_.makeSelectedTextStyleFns(n);r.each(function(r){var o=a.select(this),s=i.selectedTextColorFn(r),l=r.tp||n.textposition,c=P(r,n);f.fill(o,s);var h=u.traceIs(n,"bar-like");C(o,l,c,r.mrc2||r.mrc,h)})}},_.smoothopen=function(r,n){if(r.length<3)return"M"+r.join("L");var i,a="M"+r[0],o=[];for(i=1;i<r.length-1;i++)o.push(I(r[i-1],r[i],r[i+1],n));for(a+="Q"+o[0][0]+" "+r[1],i=2;i<r.length-1;i++)a+="C"+o[i-2][1]+" "+o[i-1][0]+" "+r[i];return a+("Q"+o[r.length-3][1])+" "+r[r.length-1]},_.smoothclosed=function(r,n){if(r.length<3)return"M"+r.join("L")+"Z";var i,a="M"+r[0],o=r.length-1,s=[I(r[o],r[0],r[1],n)];for(i=1;i<o;i++)s.push(I(r[i-1],r[i],r[i+1],n));for(s.push(I(r[o-1],r[o],r[0],n)),i=1;i<=o;i++)a+="C"+s[i-1][1]+" "+s[i][0]+" "+r[i];return a+("C"+s[o][1]+" "+s[0][0]+" ")+r[0]+"Z"};var O={hv:function(r,n){return"H"+a.round(n[0],2)+"V"+a.round(n[1],2)},vh:function(r,n){return"V"+a.round(n[1],2)+"H"+a.round(n[0],2)},hvh:function(r,n){return"H"+a.round((r[0]+n[0])/2,2)+"V"+a.round(n[1],2)+"H"+a.round(n[0],2)},vhv:function(r,n){return"V"+a.round((r[1]+n[1])/2,2)+"H"+a.round(n[0],2)+"V"+a.round(n[1],2)}},z=function(r,n){return"L"+a.round(n[0],2)+","+a.round(n[1],2)};_.steps=function(r){var n=O[r]||z;return function(r){for(var i="M"+a.round(r[0][0],2)+","+a.round(r[0][1],2),o=1;o<r.length;o++)i+=n(r[o-1],r[o]);return i}},_.makeTester=function(){var r=o.ensureSingleById(a.select("body"),"svg","js-plotly-tester",function(r){r.attr(m.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),n=o.ensureSingle(r,"path","js-reference-point",function(r){r.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});_.tester=r,_.testref=n},_.savedBBoxes={};var D=0;function R(r){var n=r.getAttribute("data-unformatted");if(null!==n)return n+r.getAttribute("data-math")+r.getAttribute("text-anchor")+r.getAttribute("style")}function F(r,n){if(!r)return null;var i=n._context,a=i._exportedPlot?"":i._baseUrl||"";return a?"url('"+a+"#"+r+"')":"url(#"+r+")"}_.bBox=function(r,n,i){if(i||(i=R(r)),i){if(s=_.savedBBoxes[i])return o.extendFlat({},s)}else if(1===r.childNodes.length){var s,l,c,u=r.childNodes[0];if(i=R(u)){var f=+u.getAttribute("x")||0,h=+u.getAttribute("y")||0,p=u.getAttribute("transform");if(!p){var m=_.bBox(u,!1,i);return f&&(m.left+=f,m.right+=f),h&&(m.top+=h,m.bottom+=h),m}if(i+="~"+f+"~"+h+"~"+p,s=_.savedBBoxes[i])return o.extendFlat({},s)}}n?l=r:(c=_.tester.node(),l=r.cloneNode(!0),c.appendChild(l)),a.select(l).attr("transform",null).call(d.positionText,0,0);var g=l.getBoundingClientRect(),v=_.testref.node().getBoundingClientRect();n||c.removeChild(l);var y={height:g.height,width:g.width,left:g.left-v.left,top:g.top-v.top,right:g.right-v.left,bottom:g.bottom-v.top};return D>=1e4&&(_.savedBBoxes={},D=0),i&&(_.savedBBoxes[i]=y),D++,o.extendFlat({},y)},_.setClipUrl=function(r,n,i){r.attr("clip-path",F(n,i))},_.getTranslate=function(r){var n=(r[r.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(r,n,i){return[n,i].join(" ")}).split(" ");return{x:+n[0]||0,y:+n[1]||0}},_.setTranslate=function(r,n,i){var a=r.attr?"attr":"getAttribute",o=r.attr?"attr":"setAttribute",s=r[a]("transform")||"";return n=n||0,i=i||0,s=(s=s.replace(/(\btranslate\(.*?\);?)/,"").trim()+p(n,i)).trim(),r[o]("transform",s),s},_.getScale=function(r){var n=(r[r.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(r,n,i){return[n,i].join(" ")}).split(" ");return{x:+n[0]||1,y:+n[1]||1}},_.setScale=function(r,n,i){var a=r.attr?"attr":"getAttribute",o=r.attr?"attr":"setAttribute",s=r[a]("transform")||"";return n=n||1,i=i||1,s=(s=s.replace(/(\bscale\(.*?\);?)/,"").trim()+("scale("+n+",")+i+")").trim(),r[o]("transform",s),s};var B=/\s*sc.*/;_.setPointGroupScale=function(r,n,i){if(n=n||1,i=i||1,r){var a=1===n&&1===i?"":"scale("+n+","+i+")";r.each(function(){var r=(this.getAttribute("transform")||"").replace(B,"");r=(r+=a).trim(),this.setAttribute("transform",r)})}};var N=/translate\([^)]*\)\s*$/;_.setTextPointsScale=function(r,n,i){r&&r.each(function(){var r,o=a.select(this),s=o.select("text");if(s.node()){var l=parseFloat(s.attr("x")||0),c=parseFloat(s.attr("y")||0),u=(o.attr("transform")||"").match(N);r=1===n&&1===i?[]:[p(l,c),"scale("+n+","+i+")",p(-l,-c)],u&&r.push(u),o.attr("transform",r.join(""))}})}},{"../../components/fx/helpers":402,"../../constants/alignment":471,"../../constants/interactions":478,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../lib/svg_text_utils":529,"../../registry":638,"../../traces/scatter/make_bubble_size_func":943,"../../traces/scatter/subtypes":951,"../color":366,"../colorscale":378,"./symbol_defs":389,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:312}],389:[function(r,n,i){"use strict";var a=r("@plotly/d3");n.exports={circle:{n:0,f:function(r){var n=a.round(r,2);return"M"+n+",0A"+n+","+n+" 0 1,1 0,-"+n+"A"+n+","+n+" 0 0,1 "+n+",0Z"}},square:{n:1,f:function(r){var n=a.round(r,2);return"M"+n+","+n+"H-"+n+"V-"+n+"H"+n+"Z"}},diamond:{n:2,f:function(r){var n=a.round(1.3*r,2);return"M"+n+",0L0,"+n+"L-"+n+",0L0,-"+n+"Z"}},cross:{n:3,f:function(r){var n=a.round(.4*r,2),i=a.round(1.2*r,2);return"M"+i+","+n+"H"+n+"V"+i+"H-"+n+"V"+n+"H-"+i+"V-"+n+"H-"+n+"V-"+i+"H"+n+"V-"+n+"H"+i+"Z"}},x:{n:4,f:function(r){var n=a.round(.8*r/Math.sqrt(2),2),i="l"+n+","+n,o="l"+n+",-"+n,s="l-"+n+",-"+n,l="l-"+n+","+n;return"M0,"+n+i+o+s+o+s+l+s+l+i+l+i+"Z"}},"triangle-up":{n:5,f:function(r){var n=a.round(2*r/Math.sqrt(3),2);return"M-"+n+","+a.round(r/2,2)+"H"+n+"L0,-"+a.round(r,2)+"Z"}},"triangle-down":{n:6,f:function(r){var n=a.round(2*r/Math.sqrt(3),2);return"M-"+n+",-"+a.round(r/2,2)+"H"+n+"L0,"+a.round(r,2)+"Z"}},"triangle-left":{n:7,f:function(r){var n=a.round(2*r/Math.sqrt(3),2);return"M"+a.round(r/2,2)+",-"+n+"V"+n+"L-"+a.round(r,2)+",0Z"}},"triangle-right":{n:8,f:function(r){var n=a.round(2*r/Math.sqrt(3),2);return"M-"+a.round(r/2,2)+",-"+n+"V"+n+"L"+a.round(r,2)+",0Z"}},"triangle-ne":{n:9,f:function(r){var n=a.round(.6*r,2),i=a.round(1.2*r,2);return"M-"+i+",-"+n+"H"+n+"V"+i+"Z"}},"triangle-se":{n:10,f:function(r){var n=a.round(.6*r,2),i=a.round(1.2*r,2);return"M"+n+",-"+i+"V"+n+"H-"+i+"Z"}},"triangle-sw":{n:11,f:function(r){var n=a.round(.6*r,2),i=a.round(1.2*r,2);return"M"+i+","+n+"H-"+n+"V-"+i+"Z"}},"triangle-nw":{n:12,f:function(r){var n=a.round(.6*r,2),i=a.round(1.2*r,2);return"M-"+n+","+i+"V-"+n+"H"+i+"Z"}},pentagon:{n:13,f:function(r){var n=a.round(.951*r,2),i=a.round(.588*r,2),o=a.round(-r,2),s=a.round(-.309*r,2);return"M"+n+","+s+"L"+i+","+a.round(.809*r,2)+"H-"+i+"L-"+n+","+s+"L0,"+o+"Z"}},hexagon:{n:14,f:function(r){var n=a.round(r,2),i=a.round(r/2,2),o=a.round(r*Math.sqrt(3)/2,2);return"M"+o+",-"+i+"V"+i+"L0,"+n+"L-"+o+","+i+"V-"+i+"L0,-"+n+"Z"}},hexagon2:{n:15,f:function(r){var n=a.round(r,2),i=a.round(r/2,2),o=a.round(r*Math.sqrt(3)/2,2);return"M-"+i+","+o+"H"+i+"L"+n+",0L"+i+",-"+o+"H-"+i+"L-"+n+",0Z"}},octagon:{n:16,f:function(r){var n=a.round(.924*r,2),i=a.round(.383*r,2);return"M-"+i+",-"+n+"H"+i+"L"+n+",-"+i+"V"+i+"L"+i+","+n+"H-"+i+"L-"+n+","+i+"V-"+i+"Z"}},star:{n:17,f:function(r){var n=1.4*r,i=a.round(.225*n,2),o=a.round(.951*n,2),s=a.round(.363*n,2),l=a.round(.588*n,2),c=a.round(-n,2),u=a.round(-.309*n,2),f=a.round(.118*n,2),h=a.round(.809*n,2);return"M"+i+","+u+"H"+o+"L"+s+","+f+"L"+l+","+h+"L0,"+a.round(.382*n,2)+"L-"+l+","+h+"L-"+s+","+f+"L-"+o+","+u+"H-"+i+"L0,"+c+"Z"}},hexagram:{n:18,f:function(r){var n=a.round(.66*r,2),i=a.round(.38*r,2),o=a.round(.76*r,2);return"M-"+o+",0l-"+i+",-"+n+"h"+o+"l"+i+",-"+n+"l"+i+","+n+"h"+o+"l-"+i+","+n+"l"+i+","+n+"h-"+o+"l-"+i+","+n+"l-"+i+",-"+n+"h-"+o+"Z"}},"star-triangle-up":{n:19,f:function(r){var n=a.round(r*Math.sqrt(3)*.8,2),i=a.round(.8*r,2),o=a.round(1.6*r,2),s=a.round(4*r,2),l="A "+s+","+s+" 0 0 1 ";return"M-"+n+","+i+l+n+","+i+l+"0,-"+o+l+"-"+n+","+i+"Z"}},"star-triangle-down":{n:20,f:function(r){var n=a.round(r*Math.sqrt(3)*.8,2),i=a.round(.8*r,2),o=a.round(1.6*r,2),s=a.round(4*r,2),l="A "+s+","+s+" 0 0 1 ";return"M"+n+",-"+i+l+"-"+n+",-"+i+l+"0,"+o+l+n+",-"+i+"Z"}},"star-square":{n:21,f:function(r){var n=a.round(1.1*r,2),i=a.round(2*r,2),o="A "+i+","+i+" 0 0 1 ";return"M-"+n+",-"+n+o+"-"+n+","+n+o+n+","+n+o+n+",-"+n+o+"-"+n+",-"+n+"Z"}},"star-diamond":{n:22,f:function(r){var n=a.round(1.4*r,2),i=a.round(1.9*r,2),o="A "+i+","+i+" 0 0 1 ";return"M-"+n+",0"+o+"0,"+n+o+n+",0"+o+"0,-"+n+o+"-"+n+",0Z"}},"diamond-tall":{n:23,f:function(r){var n=a.round(.7*r,2),i=a.round(1.4*r,2);return"M0,"+i+"L"+n+",0L0,-"+i+"L-"+n+",0Z"}},"diamond-wide":{n:24,f:function(r){var n=a.round(1.4*r,2),i=a.round(.7*r,2);return"M0,"+i+"L"+n+",0L0,-"+i+"L-"+n+",0Z"}},hourglass:{n:25,f:function(r){var n=a.round(r,2);return"M"+n+","+n+"H-"+n+"L"+n+",-"+n+"H-"+n+"Z"},noDot:!0},bowtie:{n:26,f:function(r){var n=a.round(r,2);return"M"+n+","+n+"V-"+n+"L-"+n+","+n+"V-"+n+"Z"},noDot:!0},"circle-cross":{n:27,f:function(r){var n=a.round(r,2);return"M0,"+n+"V-"+n+"M"+n+",0H-"+n+"M"+n+",0A"+n+","+n+" 0 1,1 0,-"+n+"A"+n+","+n+" 0 0,1 "+n+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(r){var n=a.round(r,2),i=a.round(r/Math.sqrt(2),2);return"M"+i+","+i+"L-"+i+",-"+i+"M"+i+",-"+i+"L-"+i+","+i+"M"+n+",0A"+n+","+n+" 0 1,1 0,-"+n+"A"+n+","+n+" 0 0,1 "+n+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(r){var n=a.round(r,2);return"M0,"+n+"V-"+n+"M"+n+",0H-"+n+"M"+n+","+n+"H-"+n+"V-"+n+"H"+n+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(r){var n=a.round(r,2);return"M"+n+","+n+"L-"+n+",-"+n+"M"+n+",-"+n+"L-"+n+","+n+"M"+n+","+n+"H-"+n+"V-"+n+"H"+n+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(r){var n=a.round(1.3*r,2);return"M"+n+",0L0,"+n+"L-"+n+",0L0,-"+n+"ZM0,-"+n+"V"+n+"M-"+n+",0H"+n},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(r){var n=a.round(1.3*r,2),i=a.round(.65*r,2);return"M"+n+",0L0,"+n+"L-"+n+",0L0,-"+n+"ZM-"+i+",-"+i+"L"+i+","+i+"M-"+i+","+i+"L"+i+",-"+i},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(r){var n=a.round(1.4*r,2);return"M0,"+n+"V-"+n+"M"+n+",0H-"+n},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(r){var n=a.round(r,2);return"M"+n+","+n+"L-"+n+",-"+n+"M"+n+",-"+n+"L-"+n+","+n},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(r){var n=a.round(1.2*r,2),i=a.round(.85*r,2);return"M0,"+n+"V-"+n+"M"+n+",0H-"+n+"M"+i+","+i+"L-"+i+",-"+i+"M"+i+",-"+i+"L-"+i+","+i},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(r){var n=a.round(r/2,2),i=a.round(r,2);return"M"+n+","+i+"V-"+i+"m-"+i+",0V"+i+"M"+i+","+n+"H-"+i+"m0,-"+i+"H"+i},needLine:!0,noFill:!0},"y-up":{n:37,f:function(r){var n=a.round(1.2*r,2),i=a.round(1.6*r,2),o=a.round(.8*r,2);return"M-"+n+","+o+"L0,0M"+n+","+o+"L0,0M0,-"+i+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(r){var n=a.round(1.2*r,2),i=a.round(1.6*r,2),o=a.round(.8*r,2);return"M-"+n+",-"+o+"L0,0M"+n+",-"+o+"L0,0M0,"+i+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(r){var n=a.round(1.2*r,2),i=a.round(1.6*r,2),o=a.round(.8*r,2);return"M"+o+","+n+"L0,0M"+o+",-"+n+"L0,0M-"+i+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(r){var n=a.round(1.2*r,2),i=a.round(1.6*r,2),o=a.round(.8*r,2);return"M-"+o+","+n+"L0,0M-"+o+",-"+n+"L0,0M"+i+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(r){var n=a.round(1.4*r,2);return"M"+n+",0H-"+n},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(r){var n=a.round(1.4*r,2);return"M0,"+n+"V-"+n},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(r){var n=a.round(r,2);return"M"+n+",-"+n+"L-"+n+","+n},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(r){var n=a.round(r,2);return"M"+n+","+n+"L-"+n+",-"+n},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(r){var n=a.round(r,2);return"M0,0L-"+n+","+a.round(2*r,2)+"H"+n+"Z"},noDot:!0},"arrow-down":{n:46,f:function(r){var n=a.round(r,2);return"M0,0L-"+n+",-"+a.round(2*r,2)+"H"+n+"Z"},noDot:!0},"arrow-left":{n:47,f:function(r){var n=a.round(2*r,2),i=a.round(r,2);return"M0,0L"+n+",-"+i+"V"+i+"Z"},noDot:!0},"arrow-right":{n:48,f:function(r){var n=a.round(2*r,2),i=a.round(r,2);return"M0,0L-"+n+",-"+i+"V"+i+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(r){var n=a.round(r,2);return"M-"+n+",0H"+n+"M0,0L-"+n+","+a.round(2*r,2)+"H"+n+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(r){var n=a.round(r,2);return"M-"+n+",0H"+n+"M0,0L-"+n+",-"+a.round(2*r,2)+"H"+n+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(r){var n=a.round(2*r,2),i=a.round(r,2);return"M0,-"+i+"V"+i+"M0,0L"+n+",-"+i+"V"+i+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(r){var n=a.round(2*r,2),i=a.round(r,2);return"M0,-"+i+"V"+i+"M0,0L-"+n+",-"+i+"V"+i+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],390:[function(r,n,i){"use strict";n.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],391:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../registry"),s=r("../../plots/cartesian/axes"),l=r("../../lib"),c=r("./compute_error");function u(r,n,i,o){var u=n["error_"+o]||{},f=[];if(u.visible&&-1!==["linear","log"].indexOf(i.type)){for(var h=c(u),p=0;p<r.length;p++){var d=r[p],m=d.i;if(void 0===m)m=p;else if(null===m)continue;var g=d[o];if(a(i.c2l(g))){var v=h(g,m);if(a(v[0])&&a(v[1])){var y=d[o+"s"]=g-v[0],x=d[o+"h"]=g+v[1];f.push(y,x)}}}var b=i._id,_=n._extremes[b],w=s.findExtremes(i,f,l.extendFlat({tozero:_.opts.tozero},{padded:!0}));_.min=_.min.concat(w.min),_.max=_.max.concat(w.max)}}n.exports=function(r){for(var n=r.calcdata,i=0;i<n.length;i++){var a=n[i],l=a[0].trace;if(!0===l.visible&&o.traceIs(l,"errorBarsOK")){var c=s.getFromId(r,l.xaxis),f=s.getFromId(r,l.yaxis);u(a,l,c,"x"),u(a,l,f,"y")}}}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"./compute_error":392,"fast-isnumeric":190}],392:[function(r,n,i){"use strict";function a(r,n){return"percent"===r?function(r){return Math.abs(r*n/100)}:"constant"===r?function(){return Math.abs(n)}:"sqrt"===r?function(r){return Math.sqrt(Math.abs(r))}:void 0}n.exports=function(r){var n=r.type,i=r.symmetric;if("data"===n){var o=r.array||[];if(i)return function(r,n){var i=+o[n];return[i,i]};var s=r.arrayminus||[];return function(r,n){var i=+o[n],a=+s[n];return isNaN(i)&&isNaN(a)?[NaN,NaN]:[a||0,i||0]}}var l=a(n,r.value),c=a(n,r.valueminus);return i||void 0===r.valueminus?function(r){var n=l(r);return[n,n]}:function(r){return[c(r),l(r)]}}},{}],393:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../registry"),s=r("../../lib"),l=r("../../plot_api/plot_template"),c=r("./attributes");n.exports=function(r,n,i,u){var f="error_"+u.axis,h=l.newContainer(n,f),p=r[f]||{};function d(r,n){return s.coerce(p,h,c,r,n)}if(!1!==d("visible",void 0!==p.array||void 0!==p.value||"sqrt"===p.type)){var m=d("type","array"in p?"data":"percent"),g=!0;"sqrt"!==m&&(g=d("symmetric",!(("data"===m?"arrayminus":"valueminus")in p))),"data"===m?(d("array"),d("traceref"),g||(d("arrayminus"),d("tracerefminus"))):"percent"!==m&&"constant"!==m||(d("value"),g||d("valueminus"));var v="copy_"+u.inherit+"style";u.inherit&&(n["error_"+u.inherit]||{}).visible&&d(v,!(p.color||a(p.thickness)||a(p.width))),u.inherit&&h[v]||(d("color",i),d("thickness"),d("width",o.traceIs(n,"gl3d")?0:4))}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../registry":638,"./attributes":390,"fast-isnumeric":190}],394:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plot_api/edit_types").overrideAll,s=r("./attributes"),l={error_x:a.extendFlat({},s),error_y:a.extendFlat({},s)};delete l.error_x.copy_zstyle,delete l.error_y.copy_zstyle,delete l.error_y.copy_ystyle;var c={error_x:a.extendFlat({},s),error_y:a.extendFlat({},s),error_z:a.extendFlat({},s)};delete c.error_x.copy_ystyle,delete c.error_y.copy_ystyle,delete c.error_z.copy_ystyle,delete c.error_z.copy_zstyle,n.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:l,bar:l,histogram:l,scatter3d:o(c,"calc","nested"),scattergl:o(l,"calc","nested")}},supplyDefaults:r("./defaults"),calc:r("./calc"),makeComputeError:r("./compute_error"),plot:r("./plot"),style:r("./style"),hoverInfo:function(r,n,i){(n.error_y||{}).visible&&(i.yerr=r.yh-r.y,n.error_y.symmetric||(i.yerrneg=r.y-r.ys)),(n.error_x||{}).visible&&(i.xerr=r.xh-r.x,n.error_x.symmetric||(i.xerrneg=r.x-r.xs))}}},{"../../lib":503,"../../plot_api/edit_types":536,"./attributes":390,"./calc":391,"./compute_error":392,"./defaults":393,"./plot":395,"./style":396}],395:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=r("../drawing"),l=r("../../traces/scatter/subtypes");n.exports=function(r,n,i,c){var u=i.xaxis,f=i.yaxis,h=c&&c.duration>0;n.each(function(n){var p,d=n[0].trace,m=d.error_x||{},g=d.error_y||{};d.ids&&(p=function(r){return r.id});var v=l.hasMarkers(d)&&d.marker.maxdisplayed>0;g.visible||m.visible||(n=[]);var y=a.select(this).selectAll("g.errorbar").data(n,p);if(y.exit().remove(),n.length){m.visible||y.selectAll("path.xerror").remove(),g.visible||y.selectAll("path.yerror").remove(),y.style("opacity",1);var x=y.enter().append("g").classed("errorbar",!0);h&&x.style("opacity",0).transition().duration(c.duration).style("opacity",1),s.setClipUrl(y,i.layerClipId,r),y.each(function(r){var n=a.select(this),i=(s={x:u.c2p(r.x),y:f.c2p(r.y)},void 0!==r.yh&&(s.yh=f.c2p(r.yh),s.ys=f.c2p(r.ys),o(s.ys)||(s.noYS=!0,s.ys=f.c2p(r.ys,!0))),void 0!==r.xh&&(s.xh=u.c2p(r.xh),s.xs=u.c2p(r.xs),o(s.xs)||(s.noXS=!0,s.xs=u.c2p(r.xs,!0))),s);if(!v||r.vis){var s,l,p=n.select("path.yerror");if(g.visible&&o(i.x)&&o(i.yh)&&o(i.ys)){var d=g.width;l="M"+(i.x-d)+","+i.yh+"h"+2*d+"m-"+d+",0V"+i.ys,i.noYS||(l+="m-"+d+",0h"+2*d),p.size()?h&&(p=p.transition().duration(c.duration).ease(c.easing)):p=n.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),p.attr("d",l)}else p.remove();var y=n.select("path.xerror");if(m.visible&&o(i.y)&&o(i.xh)&&o(i.xs)){var x=(m.copy_ystyle?g:m).width;l="M"+i.xh+","+(i.y-x)+"v"+2*x+"m0,-"+x+"H"+i.xs,i.noXS||(l+="m0,-"+x+"v"+2*x),y.size()?h&&(y=y.transition().duration(c.duration).ease(c.easing)):y=n.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),y.attr("d",l)}else y.remove()}})}})}},{"../../traces/scatter/subtypes":951,"../drawing":388,"@plotly/d3":58,"fast-isnumeric":190}],396:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../color");n.exports=function(r){r.each(function(r){var n=r[0].trace,i=n.error_y||{},s=n.error_x||{},l=a.select(this);l.selectAll("path.yerror").style("stroke-width",i.thickness+"px").call(o.stroke,i.color),s.copy_ystyle&&(s=i),l.selectAll("path.xerror").style("stroke-width",s.thickness+"px").call(o.stroke,s.color)})}},{"../color":366,"@plotly/d3":58}],397:[function(r,n,i){"use strict";var a=r("../../plots/font_attributes"),o=r("./layout_attributes").hoverlabel,s=r("../../lib/extend").extendFlat;n.exports={hoverlabel:{bgcolor:s({},o.bgcolor,{arrayOk:!0}),bordercolor:s({},o.bordercolor,{arrayOk:!0}),font:a({arrayOk:!0,editType:"none"}),align:s({},o.align,{arrayOk:!0}),namelength:s({},o.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":493,"../../plots/font_attributes":585,"./layout_attributes":407}],398:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../registry");function s(r,n,i,o){o=o||a.identity,Array.isArray(r)&&(n[0][i]=o(r))}n.exports=function(r){for(var n=r.calcdata,i=r._fullLayout,l=0;l<n.length;l++){var c=n[l],u=c[0].trace;if(!o.traceIs(u,"pie-like")){var f=o.traceIs(u,"2dMap")?s:a.fillArray;f(u.hoverinfo,c,"hi",function(r){return function(n){return a.coerceHoverinfo({hoverinfo:n},{_module:r._module},i)}}(u)),u.hovertemplate&&f(u.hovertemplate,c,"ht"),u.hoverlabel&&(f(u.hoverlabel.bgcolor,c,"hbg"),f(u.hoverlabel.bordercolor,c,"hbc"),f(u.hoverlabel.font.size,c,"hts"),f(u.hoverlabel.font.color,c,"htc"),f(u.hoverlabel.font.family,c,"htf"),f(u.hoverlabel.namelength,c,"hnl"),f(u.hoverlabel.align,c,"hta"))}}}},{"../../lib":503,"../../registry":638}],399:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("./hover").hover;n.exports=function(r,n,i){var s=a.getComponentMethod("annotations","onClick")(r,r._hoverdata);function l(){r.emit("plotly_click",{points:r._hoverdata,event:n})}void 0!==i&&o(r,n,i,!0),r._hoverdata&&n&&n.target&&(s&&s.then?s.then(l):l(),n.stopImmediatePropagation&&n.stopImmediatePropagation())}},{"../../registry":638,"./hover":403}],400:[function(r,n,i){"use strict";n.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],401:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("./hoverlabel_defaults");n.exports=function(r,n,i,l){var c=a.extendFlat({},l.hoverlabel);n.hovertemplate&&(c.namelength=-1),s(r,n,function(i,s){return a.coerce(r,n,o,i,s)},c)}},{"../../lib":503,"./attributes":397,"./hoverlabel_defaults":404}],402:[function(r,n,i){"use strict";var a=r("../../lib");i.getSubplot=function(r){return r.subplot||r.xaxis+r.yaxis||r.geo},i.isTraceInSubplots=function(r,n){if("splom"===r.type){for(var a=r.xaxes||[],o=r.yaxes||[],s=0;s<a.length;s++)for(var l=0;l<o.length;l++)if(-1!==n.indexOf(a[s]+o[l]))return!0;return!1}return -1!==n.indexOf(i.getSubplot(r))},i.flat=function(r,n){for(var i=Array(r.length),a=0;a<r.length;a++)i[a]=n;return i},i.p2c=function(r,n){for(var i=Array(r.length),a=0;a<r.length;a++)i[a]=r[a].p2c(n);return i},i.getDistanceFunction=function(r,n,a,o){return"closest"===r?o||i.quadrature(n,a):"x"===r.charAt(0)?n:a},i.getClosest=function(r,n,i){if(!1!==i.index)i.index>=0&&i.index<r.length?i.distance=0:i.index=!1;else for(var a=0;a<r.length;a++){var o=n(r[a]);o<=i.distance&&(i.index=a,i.distance=o)}return i},i.inbox=function(r,n,i){return r*n<0||0===r?i:1/0},i.quadrature=function(r,n){return function(i){var a=r(i),o=n(i);return Math.sqrt(a*a+o*o)}},i.makeEventData=function(r,n,a){var o="index"in r?r.index:r.pointNumber,s={data:n._input,fullData:n,curveNumber:n.index,pointNumber:o};if(n._indexToPoints){var l=n._indexToPoints[o];1===l.length?s.pointIndex=l[0]:s.pointIndices=l}else s.pointIndex=o;return n._module.eventData?s=n._module.eventData(s,r,n,a,o):("xVal"in r?s.x=r.xVal:"x"in r&&(s.x=r.x),"yVal"in r?s.y=r.yVal:"y"in r&&(s.y=r.y),r.xa&&(s.xaxis=r.xa),r.ya&&(s.yaxis=r.ya),void 0!==r.zLabelVal&&(s.z=r.zLabelVal)),i.appendArrayPointValue(s,n,o),s},i.appendArrayPointValue=function(r,n,i){var l=n._arrayAttrs;if(l)for(var c=0;c<l.length;c++){var u=l[c],f=o[u]||u;if(void 0===r[f]){var h=s(a.nestedProperty(n,u).get(),i);void 0!==h&&(r[f]=h)}}},i.appendArrayMultiPointValues=function(r,n,i){var l=n._arrayAttrs;if(l)for(var c=0;c<l.length;c++){var u=l[c],f=o[u]||u;if(void 0===r[f]){for(var h=a.nestedProperty(n,u).get(),p=Array(i.length),d=0;d<i.length;d++)p[d]=s(h,i[d]);r[f]=p}}};var o={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function s(r,n){return Array.isArray(n)?Array.isArray(r)&&Array.isArray(r[n[0]])?r[n[0]][n[1]]:void 0:r[n]}var l={x:!0,y:!0},c={"x unified":!0,"y unified":!0};i.isUnifiedHover=function(r){return"string"==typeof r&&!!c[r]},i.isXYhover=function(r){return"string"==typeof r&&!!l[r]}},{"../../lib":503}],403:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=r("tinycolor2"),l=r("../../lib"),c=l.strTranslate,u=l.strRotate,f=r("../../lib/events"),h=r("../../lib/svg_text_utils"),p=r("../../lib/override_cursor"),d=r("../drawing"),m=r("../color"),g=r("../dragelement"),v=r("../../plots/cartesian/axes"),y=r("../../registry"),x=r("./helpers"),b=r("./constants"),_=r("../legend/defaults"),w=r("../legend/draw"),T=b.YANGLE,k=Math.PI*T/180,A=1/Math.sin(k),M=Math.cos(k),S=Math.sin(k),E=b.HOVERARROWSIZE,L=b.HOVERTEXTPAD,C={box:!0,ohlc:!0,violin:!0,candlestick:!0},P={scatter:!0,scattergl:!0,splom:!0};function I(r){return[r.trace.index,r.index,r.x0,r.y0,r.name,r.attr,r.xa?r.xa._id:"",r.ya?r.ya._id:""].join(",")}i.hover=function(r,n,i,s){r=l.getGraphDiv(r);var c=n.target;l.throttle(r._fullLayout._uid+b.HOVERID,b.HOVERMINTIME,function(){!function(r,n,i,s,c){i||(i="xy");var u=Array.isArray(i)?i:[i],h=r._fullLayout,d=h._plots||[],b=d[i],_=h._has("cartesian");if(b){var w=b.overlays.map(function(r){return r.id});u=u.concat(w)}for(var T=u.length,k=Array(T),M=Array(T),S=!1,E=0;E<T;E++){var L=u[E];if(d[L])S=!0,k[E]=d[L].xaxis,M[E]=d[L].yaxis;else{if(!h[L]||!h[L]._subplot)return void l.warn("Unrecognized subplot: "+L);var O=h[L]._subplot;k[E]=O.xaxis,M[E]=O.yaxis}}var D=n.hovermode||h.hovermode;if(D&&!S&&(D="closest"),-1===["x","y","closest","x unified","y unified"].indexOf(D)||!r.calcdata||r.querySelector(".zoombox")||r._dragging)return g.unhoverRaw(r,n);var N=h.hoverdistance;-1===N&&(N=1/0);var H=h.spikedistance;-1===H&&(H=1/0);var q,G,Y,W,X,Z,J,K,Q,$,tt,te,tr,tn=[],ti=[],ta={hLinePoint:null,vLinePoint:null},to=!1;if(Array.isArray(n))for(D="array",Y=0;Y<n.length;Y++)(X=r.calcdata[n[Y].curveNumber||0])&&(Z=X[0].trace,"skip"!==X[0].trace.hoverinfo&&(ti.push(X),"h"===Z.orientation&&(to=!0)));else{for(W=0;W<r.calcdata.length;W++)"skip"!==(Z=(X=r.calcdata[W])[0].trace).hoverinfo&&x.isTraceInSubplots(Z,u)&&(ti.push(X),"h"===Z.orientation&&(to=!0));if(c){if(!1===f.triggerHandler(r,"plotly_beforehover",n))return;var ts,tl,tc=c.getBoundingClientRect();ts=n.clientX-tc.left,tl=n.clientY-tc.top,h._calcInverseTransform(r);var tu=l.apply3DTransform(h._invTransform)(ts,tl);if(ts=tu[0],tl=tu[1],ts<0||ts>k[0]._length||tl<0||tl>M[0]._length)return g.unhoverRaw(r,n)}else ts="xpx"in n?n.xpx:k[0]._length/2,tl="ypx"in n?n.ypx:M[0]._length/2;if(n.pointerX=ts+k[0]._offset,n.pointerY=tl+M[0]._offset,q="xval"in n?x.flat(u,n.xval):x.p2c(k,ts),G="yval"in n?x.flat(u,n.yval):x.p2c(M,tl),!o(q[0])||!o(G[0]))return l.warn("Fx.hover failed",n,r),g.unhoverRaw(r,n)}var tf=1/0;function th(r,i){for(W=0;W<ti.length;W++)if((X=ti[W])&&X[0]&&X[0].trace&&!0===(Z=X[0].trace).visible&&0!==Z._length&&-1===["carpet","contourcarpet"].indexOf(Z._module.name)){if("splom"===Z.type?J=u[K=0]:(J=x.getSubplot(Z),K=u.indexOf(J)),Q=D,x.isUnifiedHover(Q)&&(Q=Q.charAt(0)),te={cd:X,trace:Z,xa:k[K],ya:M[K],maxHoverDistance:N,maxSpikeDistance:H,index:!1,distance:Math.min(tf,N),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:m.defaultLine,name:Z.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},h[J]&&(te.subplot=h[J]._subplot),h._splomScenes&&h._splomScenes[Z.uid]&&(te.scene=h._splomScenes[Z.uid]),tr=tn.length,"array"===Q){var a=n[W];"pointNumber"in a?(te.index=a.pointNumber,Q="closest"):(Q="","xval"in a&&($=a.xval,Q="x"),"yval"in a&&(tt=a.yval,Q=Q?"closest":"y"))}else void 0!==r&&void 0!==i?($=r,tt=i):($=q[K],tt=G[K]);if(0!==N){if(Z._module&&Z._module.hoverPoints){var s=Z._module.hoverPoints(te,$,tt,Q,{finiteRange:!0,hoverLayer:h._hoverlayer});if(s)for(var c,f=0;f<s.length;f++)o((c=s[f]).x0)&&o(c.y0)&&tn.push(function(r,n){var i=r.index,a=r.trace||{},s=r.cd[0],c=r.cd[i]||{};function u(r){return r||o(r)&&0===r}var f=Array.isArray(i)?function(r,n){var o=l.castOption(s,i,r);return u(o)?o:l.extractOption({},a,"",n)}:function(r,n){return l.extractOption(c,a,r,n)};function h(n,i,a){var o=f(i,a);u(o)&&(r[n]=o)}if(h("hoverinfo","hi","hoverinfo"),h("bgcolor","hbg","hoverlabel.bgcolor"),h("borderColor","hbc","hoverlabel.bordercolor"),h("fontFamily","htf","hoverlabel.font.family"),h("fontSize","hts","hoverlabel.font.size"),h("fontColor","htc","hoverlabel.font.color"),h("nameLength","hnl","hoverlabel.namelength"),h("textAlign","hta","hoverlabel.align"),r.posref="y"===n||"closest"===n&&"h"===a.orientation?r.xa._offset+(r.x0+r.x1)/2:r.ya._offset+(r.y0+r.y1)/2,r.x0=l.constrain(r.x0,0,r.xa._length),r.x1=l.constrain(r.x1,0,r.xa._length),r.y0=l.constrain(r.y0,0,r.ya._length),r.y1=l.constrain(r.y1,0,r.ya._length),void 0!==r.xLabelVal&&(r.xLabel="xLabel"in r?r.xLabel:v.hoverLabelText(r.xa,r.xLabelVal,a.xhoverformat),r.xVal=r.xa.c2d(r.xLabelVal)),void 0!==r.yLabelVal&&(r.yLabel="yLabel"in r?r.yLabel:v.hoverLabelText(r.ya,r.yLabelVal,a.yhoverformat),r.yVal=r.ya.c2d(r.yLabelVal)),void 0!==r.zLabelVal&&void 0===r.zLabel&&(r.zLabel=String(r.zLabelVal)),!(isNaN(r.xerr)||"log"===r.xa.type&&r.xerr<=0)){var p=v.tickText(r.xa,r.xa.c2l(r.xerr),"hover").text;void 0!==r.xerrneg?r.xLabel+=" +"+p+" / -"+v.tickText(r.xa,r.xa.c2l(r.xerrneg),"hover").text:r.xLabel+=" \xb1 "+p,"x"===n&&(r.distance+=1)}if(!(isNaN(r.yerr)||"log"===r.ya.type&&r.yerr<=0)){var d=v.tickText(r.ya,r.ya.c2l(r.yerr),"hover").text;void 0!==r.yerrneg?r.yLabel+=" +"+d+" / -"+v.tickText(r.ya,r.ya.c2l(r.yerrneg),"hover").text:r.yLabel+=" \xb1 "+d,"y"===n&&(r.distance+=1)}var m=r.hoverinfo||r.trace.hoverinfo;return m&&"all"!==m&&(-1===(m=Array.isArray(m)?m:m.split("+")).indexOf("x")&&(r.xLabel=void 0),-1===m.indexOf("y")&&(r.yLabel=void 0),-1===m.indexOf("z")&&(r.zLabel=void 0),-1===m.indexOf("text")&&(r.text=void 0),-1===m.indexOf("name")&&(r.name=void 0)),r}(c,D))}else l.log("Unrecognized trace type in hover:",Z)}if("closest"===D&&tn.length>tr&&(tn.splice(0,tr),tf=tn[0].distance),_&&0!==H&&0===tn.length){te.distance=H,te.index=!1;var p=Z._module.hoverPoints(te,$,tt,"closest",{hoverLayer:h._hoverlayer});if(p&&(p=p.filter(function(r){return r.spikeDistance<=H})),p&&p.length){var d,g=p.filter(function(r){return r.xa.showspikes&&"hovered data"!==r.xa.spikesnap});if(g.length){var y=g[0];o(y.x0)&&o(y.y0)&&(d=td(y),(!ta.vLinePoint||ta.vLinePoint.spikeDistance>d.spikeDistance)&&(ta.vLinePoint=d))}var b=p.filter(function(r){return r.ya.showspikes&&"hovered data"!==r.ya.spikesnap});if(b.length){var w=b[0];o(w.x0)&&o(w.y0)&&(d=td(w),(!ta.hLinePoint||ta.hLinePoint.spikeDistance>d.spikeDistance)&&(ta.hLinePoint=d))}}}}}function tp(r,n,i){for(var a,o=null,s=1/0,l=0;l<r.length;l++)a=r[l].spikeDistance,i&&0===l&&(a=-1/0),a<=s&&a<=n&&(o=r[l],s=a);return o}function td(r){return r?{xa:r.xa,ya:r.ya,x:void 0!==r.xSpike?r.xSpike:(r.x0+r.x1)/2,y:void 0!==r.ySpike?r.ySpike:(r.y0+r.y1)/2,distance:r.distance,spikeDistance:r.spikeDistance,curveNumber:r.trace.index,color:r.color,pointNumber:r.index}:null}th();var tm={fullLayout:h,container:h._hoverlayer,event:n},tg=r._spikepoints,tv={vLinePoint:ta.vLinePoint,hLinePoint:ta.hLinePoint};r._spikepoints=tv;var ty=function(){tn.sort(function(r,n){return r.distance-n.distance}),tn=function(r,n){for(var i=n.charAt(0),a=[],o=[],s=[],l=0;l<r.length;l++){var c=r[l];y.traceIs(c.trace,"bar-like")||y.traceIs(c.trace,"box-violin")?s.push(c):c.trace[i+"period"]?o.push(c):a.push(c)}return a.concat(o).concat(s)}(tn,D)};ty();var tx=D.charAt(0),tb=("x"===tx||"y"===tx)&&tn[0]&&P[tn[0].trace.type];if(_&&0!==H&&0!==tn.length){var t_=tp(tn.filter(function(r){return r.ya.showspikes}),H,tb);ta.hLinePoint=td(t_);var tw=tp(tn.filter(function(r){return r.xa.showspikes}),H,tb);ta.vLinePoint=td(tw)}if(0===tn.length)return g.unhoverRaw(r,n),!_||null===ta.hLinePoint&&null===ta.vLinePoint||B(tg)&&F(r,ta,tm);if(_&&B(tg)&&F(r,ta,tm),x.isXYhover(Q)&&0!==tn[0].length&&"splom"!==tn[0].trace.type){var tT=tn[0],tk=(tn=C[tT.trace.type]?tn.filter(function(r){return r.trace.index===tT.trace.index}):[tT]).length;th(j("x",tT,h),j("y",tT,h));var tA,tM=[],tS={},tE=0,tL=function(r){var n=C[r.trace.type]?I(r):r.trace.index;if(tS[n]){var i=tS[n]-1,a=tM[i];i>0&&Math.abs(r.distance)<Math.abs(a.distance)&&(tM[i]=r)}else tE++,tS[n]=tE,tM.push(r)};for(tA=0;tA<tk;tA++)tL(tn[tA]);for(tA=tn.length-1;tA>tk-1;tA--)tL(tn[tA]);tn=tM,ty()}var tC=r._hoverdata,tP=[],tI=U(r),tO=V(r);for(Y=0;Y<tn.length;Y++){var tz=tn[Y],tD=x.makeEventData(tz,tz.trace,tz.cd);if(!1!==tz.hovertemplate){var tR=!1;tz.cd[tz.index]&&tz.cd[tz.index].ht&&(tR=tz.cd[tz.index].ht),tz.hovertemplate=tR||tz.trace.hovertemplate||!1}if(tz.xa&&tz.ya){var tF=tz.x0+tz.xa._offset,tB=tz.x1+tz.xa._offset,tN=tz.y0+tz.ya._offset,tj=tz.y1+tz.ya._offset,tU=Math.min(tF,tB),tV=Math.max(tF,tB),tH=Math.min(tN,tj),tq=Math.max(tN,tj);tD.bbox={x0:tU+tO,x1:tV+tO,y0:tH+tI,y1:tq+tI}}tz.eventData=[tD],tP.push(tD)}r._hoverdata=tP;var tG="y"===D&&(ti.length>1||tn.length>1)||"closest"===D&&to&&tn.length>1,tY=m.combine(h.plot_bgcolor||m.background,h.paper_bgcolor),tW=z(tn,{gd:r,hovermode:D,rotateLabels:tG,bgColor:tY,container:h._hoverlayer,outerContainer:h._paper.node(),commonLabelOpts:h.hoverlabel,hoverdistance:h.hoverdistance});if(x.isUnifiedHover(D)||(function(r,n,i){var a,o,s,l,c,u,f,h=0,p=1,d=r.size(),m=Array(d),g=0;function v(r){var n=r[0],i=r[r.length-1];if(o=n.pmin-n.pos-n.dp+n.size,s=i.pos+i.dp+i.size-n.pmax,o>.01){for(c=r.length-1;c>=0;c--)r[c].dp+=o;a=!1}if(!(s<.01)){if(o<-.01){for(c=r.length-1;c>=0;c--)r[c].dp-=s;a=!1}if(a){var f=0;for(l=0;l<r.length;l++)(u=r[l]).pos+u.dp+u.size>n.pmax&&f++;for(l=r.length-1;l>=0&&!(f<=0);l--)(u=r[l]).pos>n.pmax-1&&(u.del=!0,f--);for(l=0;l<r.length&&!(f<=0);l++)if((u=r[l]).pos<n.pmin+1)for(u.del=!0,f--,s=2*u.size,c=r.length-1;c>=0;c--)r[c].dp-=s;for(l=r.length-1;l>=0&&!(f<=0);l--)(u=r[l]).pos+u.dp+u.size>n.pmax&&(u.del=!0,f--)}}}for(r.each(function(r){var a=r[n],o="x"===a._id.charAt(0),s=a.range;0===g&&s&&s[0]>s[1]!==o&&(p=-1),m[g++]=[{datum:r,traceIndex:r.trace.index,dp:0,pos:r.pos,posref:r.posref,size:r.by*(o?A:1)/2,pmin:0,pmax:o?i.width:i.height}]}),m.sort(function(r,n){return r[0].posref-n[0].posref||p*(n[0].traceIndex-r[0].traceIndex)});!a&&h<=d;){for(h++,a=!0,l=0;l<m.length-1;){var y=m[l],x=m[l+1],b=y[y.length-1],_=x[0];if((o=b.pos+b.dp+b.size-_.pos-_.dp+_.size)>.01&&b.pmin===_.pmin&&b.pmax===_.pmax){for(c=x.length-1;c>=0;c--)x[c].dp+=o;for(y.push.apply(y,x),m.splice(l+1,1),f=0,c=y.length-1;c>=0;c--)f+=y[c].dp;for(s=f/y.length,c=y.length-1;c>=0;c--)y[c].dp-=s;a=!1}else l++}m.forEach(v)}for(l=m.length-1;l>=0;l--){var w=m[l];for(c=w.length-1;c>=0;c--){var T=w[c],k=T.datum;k.offset=T.dp,k.del=T.del}}}(tW,tG?"xa":"ya",h),R(tW,tG,h._invScaleX,h._invScaleY)),c&&c.tagName){var tX=y.getComponentMethod("annotations","hasClickToShow")(r,tP);p(a.select(c),tX?"pointer":"")}c&&!s&&function(r,n,i){if(!i||i.length!==r._hoverdata.length)return!0;for(var a=i.length-1;a>=0;a--){var o=i[a],s=r._hoverdata[a];if(o.curveNumber!==s.curveNumber||String(o.pointNumber)!==String(s.pointNumber)||String(o.pointNumbers)!==String(s.pointNumbers))return!0}return!1}(r,0,tC)&&(tC&&r.emit("plotly_unhover",{event:n,points:tC}),r.emit("plotly_hover",{event:n,points:r._hoverdata,xaxes:k,yaxes:M,xvals:q,yvals:G}))}(r,n,i,s,c)})},i.loneHover=function(r,n){var i=!0;Array.isArray(r)||(i=!1,r=[r]);var o=n.gd,s=U(o),l=V(o),c=z(r.map(function(r){var i=r._x0||r.x0||r.x||0,a=r._x1||r.x1||r.x||0,c=r._y0||r.y0||r.y||0,u=r._y1||r.y1||r.y||0,f=r.eventData;if(f){var h=Math.min(i,a),p=Math.max(i,a),d=Math.min(c,u),g=Math.max(c,u),v=r.trace;if(y.traceIs(v,"gl3d")){var x=o._fullLayout[v.scene]._scene.container,b=x.offsetLeft,_=x.offsetTop;h+=b,p+=b,d+=_,g+=_}f.bbox={x0:h+l,x1:p+l,y0:d+s,y1:g+s},n.inOut_bbox&&n.inOut_bbox.push(f.bbox)}else f=!1;return{color:r.color||m.defaultLine,x0:r.x0||r.x||0,x1:r.x1||r.x||0,y0:r.y0||r.y||0,y1:r.y1||r.y||0,xLabel:r.xLabel,yLabel:r.yLabel,zLabel:r.zLabel,text:r.text,name:r.name,idealAlign:r.idealAlign,borderColor:r.borderColor,fontFamily:r.fontFamily,fontSize:r.fontSize,fontColor:r.fontColor,nameLength:r.nameLength,textAlign:r.textAlign,trace:r.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:r.hovertemplate||!1,hovertemplateLabels:r.hovertemplateLabels||!1,eventData:f}}),{gd:o,hovermode:"closest",rotateLabels:!1,bgColor:n.bgColor||m.background,container:a.select(n.container),outerContainer:n.outerContainer||n.container}),u=0,f=0;return c.sort(function(r,n){return r.y0-n.y0}).each(function(r,i){var a=r.y0-r.by/2;r.offset=a-5<u?u-a+5:0,u=a+r.by+r.offset,i===n.anchorIndex&&(f=r.offset)}).each(function(r){r.offset-=f}),R(c,!1,o._fullLayout._invScaleX,o._fullLayout._invScaleY),i?c:c.node()};var O=/<extra>([\s\S]*)<\/extra>/;function z(r,n){var i=n.gd,o=i._fullLayout,s=n.hovermode,f=n.rotateLabels,p=n.bgColor,g=n.container,v=n.outerContainer,k=n.commonLabelOpts||{};if(0===r.length)return[[]];var A=n.fontFamily||b.HOVERFONT,M=n.fontSize||b.HOVERFONTSIZE,S=r[0],C=S.xa,P=S.ya,O=s.charAt(0),z=S[O+"Label"],R=H(i,v),F=R.top,B=R.width,N=R.height,j=void 0!==z&&S.distance<=n.hoverdistance&&("x"===s||"y"===s);if(j){var U,V,q=!0;for(U=0;U<r.length;U++)if(q&&void 0===r[U].zLabel&&(q=!1),V=r[U].hoverinfo||r[U].trace.hoverinfo){var G=Array.isArray(V)?V:V.split("+");if(-1===G.indexOf("all")&&-1===G.indexOf(s)){j=!1;break}}q&&(j=!1)}var Y=g.selectAll("g.axistext").data(j?[0]:[]);if(Y.enter().append("g").classed("axistext",!0),Y.exit().remove(),Y.each(function(){var r=a.select(this),n=l.ensureSingle(r,"path","",function(r){r.style({"stroke-width":"1px"})}),u=l.ensureSingle(r,"text","",function(r){r.attr("data-notex",1)}),f=k.bgcolor||m.defaultLine,p=k.bordercolor||m.contrast(f),g=m.contrast(f),v={family:k.font.family||A,size:k.font.size||M,color:k.font.color||g};n.style({fill:f,stroke:p}),u.text(z).call(d.font,v).call(h.positionText,0,0).call(h.convertToTspans,i),r.attr("transform","");var y,x,b=H(i,u.node());if("x"===s){var _="top"===C.side?"-":"";u.attr("text-anchor","middle").call(h.positionText,0,"top"===C.side?F-b.bottom-E-L:F-b.top+E+L),y=C._offset+(S.x0+S.x1)/2,x=P._offset+("top"===C.side?0:P._length);var w=b.width/2+L;y<w?(y=w,n.attr("d","M-"+(w-E)+",0L-"+(w-2*E)+","+_+E+"H"+(L+b.width/2)+"v"+_+(2*L+b.height)+"H-"+w+"V"+_+E+"Z")):y>o.width-w?(y=o.width-w,n.attr("d","M"+(w-E)+",0L"+w+","+_+E+"v"+_+(2*L+b.height)+"H-"+w+"V"+_+E+"H"+(w-2*E)+"Z")):n.attr("d","M0,0L"+E+","+_+E+"H"+(L+b.width/2)+"v"+_+(2*L+b.height)+"H-"+(L+b.width/2)+"V"+_+E+"H-"+E+"Z")}else{"right"===P.side?(T="start",I=1,O="",y=C._offset+C._length):(T="end",I=-1,O="-",y=C._offset),x=P._offset+(S.y0+S.y1)/2,u.attr("text-anchor",T),n.attr("d","M0,0L"+O+E+","+E+"V"+(L+b.height/2)+"h"+O+(2*L+b.width)+"V-"+(L+b.height/2)+"H"+O+E+"V-"+E+"Z");var T,I,O,D,R=b.height/2,B=F-b.top-R,N="clip"+o._uid+"commonlabel"+P._id;if(y<b.width+2*L+E){D="M-"+(E+L)+"-"+R+"h-"+(b.width-L)+"V"+R+"h"+(b.width-L)+"Z";var j=b.width-y+L;h.positionText(u,j,B),"end"===T&&u.selectAll("tspan").each(function(){var r=a.select(this),n=d.tester.append("text").text(r.text()).call(d.font,v),o=H(i,n.node());Math.round(o.width)<Math.round(b.width)&&r.attr("x",j-o.width),n.remove()})}else h.positionText(u,I*(L+E),B),D=null;var U=o._topclips.selectAll("#"+N).data(D?[0]:[]);U.enter().append("clipPath").attr("id",N).append("path"),U.exit().remove(),U.select("path").attr("d",D),d.setClipUrl(u,D?N:null,i)}r.attr("transform",c(y,x))}),x.isUnifiedHover(s)){g.selectAll("g.hovertext").remove();var W=r.filter(function(r){return"none"!==r.hoverinfo});if(0===W.length)return;var X=o.hoverlabel,Z=X.font,J={showlegend:!0,legend:{title:{text:z,font:Z},font:Z,bgcolor:X.bgcolor,bordercolor:X.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:o.legend?o.legend.traceorder:void 0,orientation:"v"}},K={font:Z};_(J,K,i._fullData);var Q=K.legend;Q.entries=[];for(var $=0;$<W.length;$++){var tt=W[$];if("none"!==tt.hoverinfo){var te=D(tt,!0,s,o,z),tr=te[0],tn=te[1];tt.name=tn,tt.text=""!==tn?tn+" : "+tr:tr;var ti=tt.cd[tt.index];ti&&(ti.mc&&(tt.mc=ti.mc),ti.mcc&&(tt.mc=ti.mcc),ti.mlc&&(tt.mlc=ti.mlc),ti.mlcc&&(tt.mlc=ti.mlcc),ti.mlw&&(tt.mlw=ti.mlw),ti.mrc&&(tt.mrc=ti.mrc),ti.dir&&(tt.dir=ti.dir)),tt._distinct=!0,Q.entries.push([tt])}}Q.entries.sort(function(r,n){return r[0].trace.index-n[0].trace.index}),Q.layer=g,Q._inHover=!0,Q._groupTitleFont=X.grouptitlefont,w(i,Q);var ta,to,ts,tl,tc=g.select("g.legend"),tu=H(i,tc.node()),tf=tu.width+2*L,th=tu.height+2*L,tp=W[0],td=(tp.x0+tp.x1)/2,tm=(tp.y0+tp.y1)/2,tg=!(y.traceIs(tp.trace,"bar-like")||y.traceIs(tp.trace,"box-violin"));"y"===O?tg?(to=tm-L,ta=tm+L):(to=Math.min.apply(null,W.map(function(r){return Math.min(r.y0,r.y1)})),ta=Math.max.apply(null,W.map(function(r){return Math.max(r.y0,r.y1)}))):to=ta=l.mean(W.map(function(r){return(r.y0+r.y1)/2}))-th/2,"x"===O?tg?(ts=td+L,tl=td-L):(ts=Math.max.apply(null,W.map(function(r){return Math.max(r.x0,r.x1)})),tl=Math.min.apply(null,W.map(function(r){return Math.min(r.x0,r.x1)}))):ts=tl=l.mean(W.map(function(r){return(r.x0+r.x1)/2}))-tf/2;var tv,ty,tx=C._offset,tb=P._offset;return tl+=tx-tf,to+=tb-th,tv=((ts+=tx)+tf<B&&ts>=0?ts:tl+tf<B&&tl>=0?tl:tx+tf<B?tx:ts-td<td-tl+tf?B-tf:0)+L,ty=((ta+=tb)+th<N&&ta>=0?ta:to+th<N&&to>=0?to:tb+th<N?tb:ta-tm<tm-to+th?N-th:0)+L,tc.attr("transform",c(tv-1,ty-1)),tc}var t_=g.selectAll("g.hovertext").data(r,function(r){return I(r)});return t_.enter().append("g").classed("hovertext",!0).each(function(){var r=a.select(this);r.append("rect").call(m.fill,m.addOpacity(p,.8)),r.append("text").classed("name",!0),r.append("path").style("stroke-width","1px"),r.append("text").classed("nums",!0).call(d.font,A,M)}),t_.exit().remove(),t_.each(function(r){var n=a.select(this).attr("transform",""),l=r.color;Array.isArray(l)&&(l=l[r.eventData[0].pointNumber]);var g=r.bgcolor||l,v=m.combine(m.opacity(g)?g:m.defaultLine,p),y=m.combine(m.opacity(l)?l:m.defaultLine,p),x=r.borderColor||m.contrast(v),b=D(r,j,s,o,z,n),_=b[0],w=b[1],k=n.select("text.nums").call(d.font,r.fontFamily||A,r.fontSize||M,r.fontColor||x).text(_).attr("data-notex",1).call(h.positionText,0,0).call(h.convertToTspans,i),S=n.select("text.name"),C=0,P=0;if(w&&w!==_){S.call(d.font,r.fontFamily||A,r.fontSize||M,y).text(w).attr("data-notex",1).call(h.positionText,0,0).call(h.convertToTspans,i);var I=H(i,S.node());C=I.width+2*L,P=I.height+2*L}else S.remove(),n.select("rect").remove();n.select("path").style({fill:v,stroke:x});var O=r.xa._offset+(r.x0+r.x1)/2,R=r.ya._offset+(r.y0+r.y1)/2,U=Math.abs(r.x1-r.x0),V=Math.abs(r.y1-r.y0),q=H(i,k.node()),G=q.width/o._invScaleX,Y=q.height/o._invScaleY;r.ty0=(F-q.top)/o._invScaleY,r.bx=G+2*L,r.by=Math.max(Y+2*L,P),r.anchor="start",r.txwidth=G,r.tx2width=C,r.offset=0;var W,X,Z=(G+E+L+C)*o._invScaleX;if(f)r.pos=O,W=R+V/2+Z<=N,X=R-V/2-Z>=0,"top"!==r.idealAlign&&W||!X?W?(R+=V/2,r.anchor="start"):r.anchor="middle":(R-=V/2,r.anchor="end");else if(r.pos=R,W=O+U/2+Z<=B,X=O-U/2-Z>=0,"left"!==r.idealAlign&&W||!X){if(W)O+=U/2,r.anchor="start";else{r.anchor="middle";var J=Z/2,K=O+J-B,Q=O-J;K>0&&(O-=K),Q<0&&(O+=-Q)}}else O-=U/2,r.anchor="end";k.attr("text-anchor",r.anchor),C&&S.attr("text-anchor",r.anchor),n.attr("transform",c(O,R)+(f?u(T):""))}),t_}function D(r,n,i,a,o,s){var c="",u="";void 0!==r.nameOverride&&(r.name=r.nameOverride),r.name&&(r.trace._meta&&(r.name=l.templateString(r.name,r.trace._meta)),c=N(r.name,r.nameLength));var f=i.charAt(0);void 0!==r.zLabel?(void 0!==r.xLabel&&(u+="x: "+r.xLabel+"<br>"),void 0!==r.yLabel&&(u+="y: "+r.yLabel+"<br>"),"choropleth"!==r.trace.type&&"choroplethmapbox"!==r.trace.type&&(u+=(u?"z: ":"")+r.zLabel)):n&&r[f+"Label"]===o?u=r[("x"===f?"y":"x")+"Label"]||"":void 0===r.xLabel?void 0!==r.yLabel&&"scattercarpet"!==r.trace.type&&(u=r.yLabel):u=void 0===r.yLabel?r.xLabel:"("+r.xLabel+", "+r.yLabel+")",!r.text&&0!==r.text||Array.isArray(r.text)||(u+=(u?"<br>":"")+r.text),void 0!==r.extraText&&(u+=(u?"<br>":"")+r.extraText),s&&""===u&&!r.hovertemplate&&(""===c&&s.remove(),u=c);var h=r.hovertemplate||!1;if(h){var p=r.hovertemplateLabels||r;r[f+"Label"]!==o&&(p[f+"other"]=p[f+"Val"],p[f+"otherLabel"]=p[f+"Label"]),u=(u=l.hovertemplateString(h,p,a._d3locale,r.eventData[0]||{},r.trace._meta)).replace(O,function(n,i){return c=N(i,r.nameLength),""})}return[u,c]}function R(r,n,i,o){var s=function(r){return r*i},l=function(r){return r*o};r.each(function(r){var i=a.select(this);if(r.del)return i.remove();var o=i.select("text.nums"),c=r.anchor,u="end"===c?-1:1,f={start:1,end:-1,middle:0}[c],p=f*(E+L),m=p+f*(r.txwidth+L),g=0,v=r.offset,y="middle"===c;y&&(p-=r.tx2width/2,m+=r.txwidth/2+L),n&&(v*=-S,g=r.offset*M),i.select("path").attr("d",y?"M-"+s(r.bx/2+r.tx2width/2)+","+l(v-r.by/2)+"h"+s(r.bx)+"v"+l(r.by)+"h-"+s(r.bx)+"Z":"M0,0L"+s(u*E+g)+","+l(E+v)+"v"+l(r.by/2-E)+"h"+s(u*r.bx)+"v-"+l(r.by)+"H"+s(u*E+g)+"V"+l(v-E)+"Z");var x=g+p,b=v+r.ty0-r.by/2+L,_=r.textAlign||"auto";"auto"!==_&&("left"===_&&"start"!==c?(o.attr("text-anchor","start"),x=y?-r.bx/2-r.tx2width/2+L:-r.bx-L):"right"===_&&"end"!==c&&(o.attr("text-anchor","end"),x=y?r.bx/2-r.tx2width/2-L:r.bx+L)),o.call(h.positionText,s(x),l(b)),r.tx2width&&(i.select("text.name").call(h.positionText,s(m+f*L+g),l(v+r.ty0-r.by/2+L)),i.select("rect").call(d.setRect,s(m+(f-1)*r.tx2width/2+g),l(v-r.by/2-1),s(r.tx2width),l(r.by+2)))})}function F(r,n,i){var a,o,l=i.container,c=i.fullLayout,u=c._size,f=i.event,h=!!n.hLinePoint,p=!!n.vLinePoint;if(l.selectAll(".spikeline").remove(),p||h){var g=m.combine(c.plot_bgcolor,c.paper_bgcolor);if(h){var y,x,b=n.hLinePoint;a=b&&b.xa,"cursor"===(o=b&&b.ya).spikesnap?(y=f.pointerX,x=f.pointerY):(y=a._offset+b.x,x=o._offset+b.y);var _,w,T=1.5>s.readability(b.color,g)?m.contrast(g):b.color,k=o.spikemode,A=o.spikethickness,M=o.spikecolor||T,S=v.getPxPosition(r,o);if(-1!==k.indexOf("toaxis")||-1!==k.indexOf("across")){if(-1!==k.indexOf("toaxis")&&(_=S,w=y),-1!==k.indexOf("across")){var E=o._counterDomainMin,L=o._counterDomainMax;"free"===o.anchor&&(E=Math.min(E,o.position),L=Math.max(L,o.position)),_=u.l+E*u.w,w=u.l+L*u.w}l.insert("line",":first-child").attr({x1:_,x2:w,y1:x,y2:x,"stroke-width":A,stroke:M,"stroke-dasharray":d.dashStyle(o.spikedash,A)}).classed("spikeline",!0).classed("crisp",!0),l.insert("line",":first-child").attr({x1:_,x2:w,y1:x,y2:x,"stroke-width":A+2,stroke:g}).classed("spikeline",!0).classed("crisp",!0)}-1!==k.indexOf("marker")&&l.insert("circle",":first-child").attr({cx:S+("right"!==o.side?A:-A),cy:x,r:A,fill:M}).classed("spikeline",!0)}if(p){var C,P,I=n.vLinePoint;a=I&&I.xa,o=I&&I.ya,"cursor"===a.spikesnap?(C=f.pointerX,P=f.pointerY):(C=a._offset+I.x,P=o._offset+I.y);var O,z,D=1.5>s.readability(I.color,g)?m.contrast(g):I.color,R=a.spikemode,F=a.spikethickness,B=a.spikecolor||D,N=v.getPxPosition(r,a);if(-1!==R.indexOf("toaxis")||-1!==R.indexOf("across")){if(-1!==R.indexOf("toaxis")&&(O=N,z=P),-1!==R.indexOf("across")){var j=a._counterDomainMin,U=a._counterDomainMax;"free"===a.anchor&&(j=Math.min(j,a.position),U=Math.max(U,a.position)),O=u.t+(1-U)*u.h,z=u.t+(1-j)*u.h}l.insert("line",":first-child").attr({x1:C,x2:C,y1:O,y2:z,"stroke-width":F,stroke:B,"stroke-dasharray":d.dashStyle(a.spikedash,F)}).classed("spikeline",!0).classed("crisp",!0),l.insert("line",":first-child").attr({x1:C,x2:C,y1:O,y2:z,"stroke-width":F+2,stroke:g}).classed("spikeline",!0).classed("crisp",!0)}-1!==R.indexOf("marker")&&l.insert("circle",":first-child").attr({cx:C,cy:N-("top"!==a.side?F:-F),r:F,fill:B}).classed("spikeline",!0)}}}function B(r,n){return!n||n.vLinePoint!==r._spikepoints.vLinePoint||n.hLinePoint!==r._spikepoints.hLinePoint}function N(r,n){return h.plainText(r||"",{len:n,allowedTags:["br","sub","sup","b","i","em"]})}function j(r,n,i){var a=n[r+"a"],o=n[r+"Val"],s=n.cd[0];if("category"===a.type)o=a._categoriesMap[o];else if("date"===a.type){var l=n.trace[r+"periodalignment"];if(l){var c=n.cd[n.index],u=c[r+"Start"];void 0===u&&(u=c[r]);var f=c[r+"End"];void 0===f&&(f=c[r]);var h=f-u;"end"===l?o+=h:"middle"===l&&(o+=h/2)}o=a.d2c(o)}return s&&s.t&&s.t.posLetter===a._id&&("group"!==i.boxmode&&"group"!==i.violinmode||(o+=s.t.dPos)),o}function U(r){return r.offsetTop+r.clientTop}function V(r){return r.offsetLeft+r.clientLeft}function H(r,n){var i=r._fullLayout,a=n.getBoundingClientRect(),o=a.x,s=a.y,c=o+a.width,u=s+a.height,f=l.apply3DTransform(i._invTransform)(o,s),h=l.apply3DTransform(i._invTransform)(c,u),p=f[0],d=f[1],m=h[0],g=h[1];return{x:p,y:d,width:m-p,height:g-d,top:Math.min(d,g),left:Math.min(p,m),right:Math.max(p,m),bottom:Math.max(d,g)}}},{"../../lib":503,"../../lib/events":492,"../../lib/override_cursor":514,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"../legend/defaults":418,"../legend/draw":419,"./constants":400,"./helpers":402,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:312}],404:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../color"),s=r("./helpers").isUnifiedHover;n.exports=function(r,n,i,l){l=l||{};var c=n.legend;function u(r){l.font[r]||(l.font[r]=c?n.legend.font[r]:n.font[r])}n&&s(n.hovermode)&&(l.font||(l.font={}),u("size"),u("family"),u("color"),c?(l.bgcolor||(l.bgcolor=o.combine(n.legend.bgcolor,n.paper_bgcolor)),l.bordercolor||(l.bordercolor=n.legend.bordercolor)):l.bgcolor||(l.bgcolor=n.paper_bgcolor)),i("hoverlabel.bgcolor",l.bgcolor),i("hoverlabel.bordercolor",l.bordercolor),i("hoverlabel.namelength",l.namelength),a.coerceFont(i,"hoverlabel.font",l.font),i("hoverlabel.align",l.align)}},{"../../lib":503,"../color":366,"./helpers":402}],405:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n){function i(i,s){return void 0!==n[i]?n[i]:a.coerce(r,n,o,i,s)}return i("clickmode"),i("hovermode")}},{"../../lib":503,"./layout_attributes":407}],406:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../dragelement"),l=r("./helpers"),c=r("./layout_attributes"),u=r("./hover");n.exports={moduleType:"component",name:"fx",constants:r("./constants"),schema:{layout:c},attributes:r("./attributes"),layoutAttributes:c,supplyLayoutGlobalDefaults:r("./layout_global_defaults"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),getDistanceFunction:l.getDistanceFunction,getClosest:l.getClosest,inbox:l.inbox,quadrature:l.quadrature,appendArrayPointValue:l.appendArrayPointValue,castHoverOption:function(r,n,i){return o.castOption(r,n,"hoverlabel."+i)},castHoverinfo:function(r,n,i){return o.castOption(r,i,"hoverinfo",function(i){return o.coerceHoverinfo({hoverinfo:i},{_module:r._module},n)})},hover:u.hover,unhover:s.unhover,loneHover:u.loneHover,loneUnhover:function(r){var n=o.isD3Selection(r)?r:a.select(r);n.selectAll("g.hovertext").remove(),n.selectAll(".spikeline").remove()},click:r("./click")}},{"../../lib":503,"../dragelement":385,"./attributes":397,"./calc":398,"./click":399,"./constants":400,"./defaults":401,"./helpers":402,"./hover":403,"./layout_attributes":407,"./layout_defaults":408,"./layout_global_defaults":409,"@plotly/d3":58}],407:[function(r,n,i){"use strict";var a=r("./constants"),o=r("../../plots/font_attributes"),s=o({editType:"none"});s.family.dflt=a.HOVERFONT,s.size.dflt=a.HOVERFONTSIZE,n.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:s,grouptitlefont:o({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":585,"./constants":400}],408:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes"),s=r("./hovermode_defaults"),l=r("./hoverlabel_defaults");n.exports=function(r,n){function i(i,s){return a.coerce(r,n,o,i,s)}s(r,n)&&(i("hoverdistance"),i("spikedistance")),"select"===i("dragmode")&&i("selectdirection");var c=n._has("mapbox"),u=n._has("geo"),f=n._basePlotModules.length;"zoom"===n.dragmode&&((c||u)&&1===f||c&&u&&2===f)&&(n.dragmode="pan"),l(r,n,i),a.coerceFont(i,"hoverlabel.grouptitlefont",n.hoverlabel.font)}},{"../../lib":503,"./hoverlabel_defaults":404,"./hovermode_defaults":405,"./layout_attributes":407}],409:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./hoverlabel_defaults"),s=r("./layout_attributes");n.exports=function(r,n){o(r,n,function(i,o){return a.coerce(r,n,s,i,o)})}},{"../../lib":503,"./hoverlabel_defaults":404,"./layout_attributes":407}],410:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../lib/regex").counter,s=r("../../plots/domain").attributes,l=r("../../plots/cartesian/constants").idRegex,c=r("../../plot_api/plot_template"),u={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[o("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[l.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[l.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:s({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function f(r,n,i){var a=n[i+"axes"],o=Object.keys((r._splomAxes||{})[i]||{});return Array.isArray(a)?a:o.length?o:void 0}function h(r,n,i,a,o,s){var l=n(r+"gap",i),c=n("domain."+r);n(r+"side",a);for(var u=Array(o),f=c[0],h=(c[1]-f)/(o-l),p=h*(1-l),d=0;d<o;d++){var m=f+h*d;u[s?o-1-d:d]=[m,m+p]}return u}function p(r,n,i,a,o){var s,l=Array(i);function c(r,i){-1!==n.indexOf(i)&&void 0===a[i]?(l[r]=i,a[i]=r):l[r]=""}if(Array.isArray(r))for(s=0;s<i;s++)c(s,r[s]);else for(c(0,o),s=1;s<i;s++)c(s,o+(s+1));return l}n.exports={moduleType:"component",name:"grid",schema:{layout:{grid:u}},layoutAttributes:u,sizeDefaults:function(r,n){var i=r.grid||{},o=f(n,i,"x"),s=f(n,i,"y");if(r.grid||o||s){var l,p,d=Array.isArray(i.subplots)&&Array.isArray(i.subplots[0]),m=Array.isArray(o),g=Array.isArray(s),v=m&&o!==i.xaxes&&g&&s!==i.yaxes;d?(l=i.subplots.length,p=i.subplots[0].length):(g&&(l=s.length),m&&(p=o.length));var y=c.newContainer(n,"grid"),x=M("rows",l),b=M("columns",p);if(x*b>1){d||m||g||"independent"!==M("pattern")||(d=!0),y._hasSubplotGrid=d;var _,w,T="top to bottom"===M("roworder"),k=d?.2:.1,A=d?.3:.1;v&&n._splomGridDflt&&(_=n._splomGridDflt.xside,w=n._splomGridDflt.yside),y._domains={x:h("x",M,k,_,b),y:h("y",M,A,w,x,T)}}else delete n.grid}function M(r,n){return a.coerce(i,y,u,r,n)}},contentDefaults:function(r,n){var i=n.grid;if(i&&i._domains){var a,o,s,l,c,u,h,d=r.grid||{},m=n._subplots,g=i._hasSubplotGrid,v=i.rows,y=i.columns,x="independent"===i.pattern,b=i._axisMap={};if(g){var _=d.subplots||[];u=i.subplots=Array(v);var w=1;for(a=0;a<v;a++){var T=u[a]=Array(y),k=_[a]||[];for(o=0;o<y;o++)if(x?(c=1===w?"xy":"x"+w+"y"+w,w++):c=k[o],T[o]="",-1!==m.cartesian.indexOf(c)){if(h=c.indexOf("y"),s=c.slice(0,h),l=c.slice(h),void 0!==b[s]&&b[s]!==o||void 0!==b[l]&&b[l]!==a)continue;T[o]=c,b[s]=o,b[l]=a}}}else{var A=f(n,d,"x"),M=f(n,d,"y");i.xaxes=p(A,m.xaxis,y,b,"x"),i.yaxes=p(M,m.yaxis,v,b,"y")}var S=i._anchors={},E="top to bottom"===i.roworder;for(var L in b){var C,P,I,O=L.charAt(0),z=i[O+"side"];if(z.length<8)S[L]="free";else if("x"===O){if("t"===z.charAt(0)===E?(C=0,P=1,I=v):(C=v-1,P=-1,I=-1),g){var D=b[L];for(a=C;a!==I;a+=P)if((c=u[a][D])&&(h=c.indexOf("y"),c.slice(0,h)===L)){S[L]=c.slice(h);break}}else for(a=C;a!==I;a+=P)if(l=i.yaxes[a],-1!==m.cartesian.indexOf(L+l)){S[L]=l;break}}else if("l"===z.charAt(0)?(C=0,P=1,I=y):(C=y-1,P=-1,I=-1),g){var R=b[L];for(a=C;a!==I;a+=P)if((c=u[R][a])&&(h=c.indexOf("y"),c.slice(h)===L)){S[L]=c.slice(0,h);break}}else for(a=C;a!==I;a+=P)if(s=i.xaxes[a],-1!==m.cartesian.indexOf(s+L)){S[L]=s;break}}}}}},{"../../lib":503,"../../lib/regex":520,"../../plot_api/plot_template":543,"../../plots/cartesian/constants":561,"../../plots/domain":584}],411:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/constants"),o=r("../../plot_api/plot_template").templatedArray;r("../../constants/axis_placeable_objects"),n.exports=o("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",a.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",a.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":472,"../../plot_api/plot_template":543,"../../plots/cartesian/constants":561}],412:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib/to_log_range");n.exports=function(r,n,i,s){n=n||{};var l="log"===i&&"linear"===n.type,c="linear"===i&&"log"===n.type;if(l||c){for(var u,f,h=r._fullLayout.images,p=n._id.charAt(0),d=0;d<h.length;d++)if(f="images["+d+"].",(u=h[d])[p+"ref"]===n._id){var m=u[p],g=u["size"+p],v=null,y=null;if(l){var x=g/Math.pow(10,v=o(m,n.range))/2;y=2*Math.log(x+Math.sqrt(1+x*x))/Math.LN10}else y=(v=Math.pow(10,m))*(Math.pow(10,g/2)-Math.pow(10,-g/2));a(v)?a(y)||(y=null):(v=null,y=null),s(f+p,v),s(f+"size"+p,y)}}}},{"../../lib/to_log_range":531,"fast-isnumeric":190}],413:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("../../plots/array_container_defaults"),l=r("./attributes");function c(r,n,i){function s(i,o){return a.coerce(r,n,l,i,o)}var c=s("source");if(!s("visible",!!c))return n;s("layer"),s("xanchor"),s("yanchor"),s("sizex"),s("sizey"),s("sizing"),s("opacity");for(var u={_fullLayout:i},f=["x","y"],h=0;h<2;h++){var p=f[h],d=o.coerceRef(r,n,u,p,"paper",void 0);"paper"!==d&&o.getFromId(u,d)._imgIndices.push(n._index),o.coercePosition(n,u,s,d,p,0)}return n}n.exports=function(r,n){s(r,n,{name:"images",handleItemDefaults:c})}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"./attributes":411}],414:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../drawing"),s=r("../../plots/cartesian/axes"),l=r("../../plots/cartesian/axis_ids"),c=r("../../constants/xmlns_namespaces");n.exports=function(r){var n,i,u=r._fullLayout,f=[],h={},p=[];for(i=0;i<u.images.length;i++){var d=u.images[i];if(d.visible){if("below"===d.layer&&"paper"!==d.xref&&"paper"!==d.yref){n=l.ref2id(d.xref)+l.ref2id(d.yref);var m=u._plots[n];if(!m){p.push(d);continue}m.mainplot&&(n=m.mainplot.id),h[n]||(h[n]=[]),h[n].push(d)}else"above"===d.layer?f.push(d):p.push(d)}}var g={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},v={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function y(n){var i=a.select(this);if(this._imgSrc!==n.source){if(i.attr("xmlns",c.svg),n.source&&"data:"===n.source.slice(0,5))i.attr("xlink:href",n.source),this._imgSrc=n.source;else{var o=new Promise((function(r){var a=new Image;function o(){i.remove(),r()}this.img=a,a.setAttribute("crossOrigin","anonymous"),a.onerror=o,a.onload=function(){var n=document.createElement("canvas");n.width=this.width,n.height=this.height,n.getContext("2d").drawImage(this,0,0);var a=n.toDataURL("image/png");i.attr("xlink:href",a),r()},i.on("error",o),a.src=n.source,this._imgSrc=n.source}).bind(this));r._promises.push(o)}}}function x(n){var i,l,c=a.select(this),f=s.getFromId(r,n.xref),h=s.getFromId(r,n.yref),p="domain"===s.getRefType(n.xref),d="domain"===s.getRefType(n.yref),m=u._size;i=void 0!==f?"string"==typeof n.xref&&p?f._length*n.sizex:Math.abs(f.l2p(n.sizex)-f.l2p(0)):n.sizex*m.w,l=void 0!==h?"string"==typeof n.yref&&d?h._length*n.sizey:Math.abs(h.l2p(n.sizey)-h.l2p(0)):n.sizey*m.h;var y,x,b=i*g[n.xanchor].offset,_=l*v[n.yanchor].offset,w=g[n.xanchor].sizing+v[n.yanchor].sizing;switch(y=(void 0!==f?"string"==typeof n.xref&&p?f._length*n.x+f._offset:f.r2p(n.x)+f._offset:n.x*m.w+m.l)+b,x=(void 0!==h?"string"==typeof n.yref&&d?h._length*(1-n.y)+h._offset:h.r2p(n.y)+h._offset:m.h-n.y*m.h+m.t)+_,n.sizing){case"fill":w+=" slice";break;case"stretch":w="none"}c.attr({x:y,y:x,width:i,height:l,preserveAspectRatio:w,opacity:n.opacity});var T=(f&&"domain"!==s.getRefType(n.xref)?f._id:"")+(h&&"domain"!==s.getRefType(n.yref)?h._id:"");o.setClipUrl(c,T?"clip"+u._uid+T:null,r)}var b=u._imageLowerLayer.selectAll("image").data(p),_=u._imageUpperLayer.selectAll("image").data(f);b.enter().append("image"),_.enter().append("image"),b.exit().remove(),_.exit().remove(),b.each(function(r){y.bind(this)(r),x.bind(this)(r)}),_.each(function(r){y.bind(this)(r),x.bind(this)(r)});var w=Object.keys(u._plots);for(i=0;i<w.length;i++){n=w[i];var T=u._plots[n];if(T.imagelayer){var k=T.imagelayer.selectAll("image").data(h[n]||[]);k.enter().append("image"),k.exit().remove(),k.each(function(r){y.bind(this)(r),x.bind(this)(r)})}}}},{"../../constants/xmlns_namespaces":480,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_ids":558,"../drawing":388,"@plotly/d3":58}],415:[function(r,n,i){"use strict";n.exports={moduleType:"component",name:"images",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),includeBasePlot:r("../../plots/cartesian/include_components")("images"),draw:r("./draw"),convertCoords:r("./convert_coords")}},{"../../plots/cartesian/include_components":567,"./attributes":411,"./convert_coords":412,"./defaults":413,"./draw":414}],416:[function(r,n,i){"use strict";var a=r("../../plots/font_attributes"),o=r("../color/attributes");n.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:o.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:a({editType:"legend"}),grouptitlefont:a({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:a({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":585,"../color/attributes":365}],417:[function(r,n,i){"use strict";n.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],418:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("../../plot_api/plot_template"),l=r("../../plots/attributes"),c=r("./attributes"),u=r("../../plots/layout_attributes"),f=r("./helpers");n.exports=function(r,n,i){var h,p=r.legend||{},d=s.newContainer(n,"legend");function m(r,n){return o.coerce(p,d,c,r,n)}for(var g=function(r,n){var i=h._input,a=h;return o.coerce(i,a,l,r,n)},v=n.font||{},y=o.coerceFont(m,"grouptitlefont",o.extendFlat({},v,{size:Math.round(1.1*v.size)})),x=0,b=!1,_="normal",w=0;w<i.length;w++)(h=i[w]).visible&&((h.showlegend||h._dfltShowLegend&&!(h._module&&h._module.attributes&&h._module.attributes.showlegend&&!1===h._module.attributes.showlegend.dflt))&&(x++,h.showlegend&&(b=!0,(a.traceIs(h,"pie-like")||!0===h._input.showlegend)&&x++),o.coerceFont(g,"legendgrouptitle.font",y)),(a.traceIs(h,"bar")&&"stack"===n.barmode||-1!==["tonextx","tonexty"].indexOf(h.fill))&&(_=f.isGrouped({traceorder:_})?"grouped+reversed":"reversed"),void 0!==h.legendgroup&&""!==h.legendgroup&&(_=f.isReversed({traceorder:_})?"reversed+grouped":"grouped"));var T=o.coerce(r,n,u,"showlegend",b&&x>1);if(!1===T&&(n.legend=void 0),(!1!==T||p.uirevision)&&(m("uirevision",n.uirevision),!1!==T)){m("bgcolor",n.paper_bgcolor),m("bordercolor"),m("borderwidth");var k,A,M,S=o.coerceFont(m,"font",n.font),E="h"===m("orientation");if(E?(k=0,a.getComponentMethod("rangeslider","isVisible")(r.xaxis)?(A=1.1,M="bottom"):(A=-.1,M="top")):(k=1.02,A=1,M="auto"),m("traceorder",_),f.isGrouped(n.legend)&&m("tracegroupgap"),m("itemsizing"),m("itemwidth"),m("itemclick"),m("itemdoubleclick"),m("groupclick"),m("x",k),m("xanchor"),m("y",A),m("yanchor",M),m("valign"),o.noneOrAll(p,d,["x","y"]),m("title.text")){m("title.side",E?"left":"top");var L=o.extendFlat({},S,{size:o.bigFont(S.size)});o.coerceFont(m,"title.font",L)}}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/attributes":550,"../../plots/layout_attributes":610,"../../registry":638,"./attributes":416,"./helpers":422}],419:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../plots/plots"),l=r("../../registry"),c=r("../../lib/events"),u=r("../dragelement"),f=r("../drawing"),h=r("../color"),p=r("../../lib/svg_text_utils"),d=r("./handle_click"),m=r("./constants"),g=r("../../constants/alignment"),v=g.LINE_SPACING,y=g.FROM_TL,x=g.FROM_BR,b=r("./get_legend_data"),_=r("./style"),w=r("./helpers");function T(r,n,i,a,o){var s=i.data()[0][0].trace,u={event:o,node:i.node(),curveNumber:s.index,expandedIndex:s._expandedIndex,data:r.data,layout:r.layout,frames:r._transitionData._frames,config:r._context,fullData:r._fullData,fullLayout:r._fullLayout};s._group&&(u.group=s._group),l.traceIs(s,"pie-like")&&(u.label=i.datum()[0].label),!1!==c.triggerHandler(r,"plotly_legendclick",u)&&(1===a?n._clickTimeout=setTimeout(function(){r._fullLayout&&d(i,r,a)},r._context.doubleClickDelay):2===a&&(n._clickTimeout&&clearTimeout(n._clickTimeout),r._legendMouseDownTime=0,!1!==c.triggerHandler(r,"plotly_legenddoubleclick",u)&&d(i,r,a)))}function k(r,n,i){var a,s,c=r.data()[0][0],u=c.trace,h=l.traceIs(u,"pie-like"),d=!i._inHover&&n._context.edits.legendText&&!h,g=i._maxNameLength;c.groupTitle?(a=c.groupTitle.text,s=c.groupTitle.font):(s=i.font,i.entries?a=c.text:(a=h?c.label:u.name,u._meta&&(a=o.templateString(a,u._meta))));var v=o.ensureSingle(r,"text","legendtext");v.attr("text-anchor","start").call(f.font,s).text(d?A(a,g):a);var y=i.itemwidth+2*m.itemGap;p.positionText(v,y,0),d?v.call(p.makeEditable,{gd:n,text:a}).call(S,r,n,i).on("edit",function(a){this.text(A(a,g)).call(S,r,n,i);var s=c.trace._fullInput||{},f={};if(l.hasTransform(s,"groupby")){var h=l.getTransformIndices(s,"groupby"),p=h[h.length-1],d=o.keyedContainer(s,"transforms["+p+"].styles","target","value.name");d.set(c.trace._group,a),f=d.constructUpdate()}else f.name=a;return l.call("_guiRestyle",n,f,u.index)}):S(v,r,n,i)}function A(r,n){var i=Math.max(4,n);if(r&&r.trim().length>=i/2)return r;for(var a=i-(r=r||"").length;a>0;a--)r+=" ";return r}function M(r,n){var i,s=n._context.doubleClickDelay,l=1,c=o.ensureSingle(r,"rect","legendtoggle",function(r){n._context.staticPlot||r.style("cursor","pointer").attr("pointer-events","all"),r.call(h.fill,"rgba(0,0,0,0)")});n._context.staticPlot||(c.on("mousedown",function(){(i=(new Date).getTime())-n._legendMouseDownTime<s?l+=1:(l=1,n._legendMouseDownTime=i)}),c.on("mouseup",function(){if(!n._dragged&&!n._editing){var i=n._fullLayout.legend;(new Date).getTime()-n._legendMouseDownTime>s&&(l=Math.max(l-1,1)),T(n,i,r,l,a.event)}}))}function S(r,n,i,a,o){a._inHover&&r.attr("data-notex",!0),p.convertToTspans(r,i,function(){!function(r,n,i,a){var o=r.data()[0][0];if(!i._inHover&&o&&!o.trace.showlegend)return void r.remove();var s=r.select("g[class*=math-group]"),l=s.node();i||(i=n._fullLayout.legend);var c,u,h=i.borderwidth,d=(1===a?i.title.font:o.groupTitle?o.groupTitle.font:i.font).size*v;if(l){var g=f.bBox(l);c=g.height,u=g.width,1===a?f.setTranslate(s,h,h+.75*c):f.setTranslate(s,0,.25*c)}else{var y=r.select(1===a?".legendtitletext":".legendtext"),x=p.lineCount(y),b=y.node();if(c=d*x,u=b?f.bBox(b).width:0,1===a)"left"===i.title.side&&(u+=2*m.itemGap),p.positionText(y,h+m.titlePad,h+d);else{var _=2*m.itemGap+i.itemwidth;o.groupTitle&&(_=m.itemGap,u-=i.itemwidth),p.positionText(y,_,-d*((x-1)/2-.3))}}1===a?(i._titleWidth=u,i._titleHeight=c):(o.lineHeight=d,o.height=Math.max(c,16)+3,o.width=u)}(n,i,a,o)})}function E(r){return o.isRightAnchor(r)?"right":o.isCenterAnchor(r)?"center":"left"}function L(r){return o.isBottomAnchor(r)?"bottom":o.isMiddleAnchor(r)?"middle":"top"}n.exports=function(r,n){return n||(n=r._fullLayout.legend||{}),function(r,n){var i,c,p=r._fullLayout,d="legend"+p._uid,g=n._inHover;if(g?(i=n.layer,d+="-hover"):i=p._infolayer,i){if(r._legendMouseDownTime||(r._legendMouseDownTime=0),g){if(!n.entries)return;c=b(n.entries,n)}else{if(!r.calcdata)return;c=p.showlegend&&b(r.calcdata,n)}var v=p.hiddenlabels||[];if(!(g||p.showlegend&&c.length))return i.selectAll(".legend").remove(),p._topdefs.select("#"+d).remove(),s.autoMargin(r,"legend");var A=o.ensureSingle(i,"g","legend",function(r){g||r.attr("pointer-events","all")}),C=o.ensureSingleById(p._topdefs,"clipPath",d,function(r){r.append("rect")}),P=o.ensureSingle(A,"rect","bg",function(r){r.attr("shape-rendering","crispEdges")});P.call(h.stroke,n.bordercolor).call(h.fill,n.bgcolor).style("stroke-width",n.borderwidth+"px");var I=o.ensureSingle(A,"g","scrollbox"),O=n.title;if(n._titleWidth=0,n._titleHeight=0,O.text){var z=o.ensureSingle(I,"text","legendtitletext");z.attr("text-anchor","start").call(f.font,O.font).text(O.text),S(z,I,r,n,1)}else I.selectAll(".legendtitletext").remove();var D=o.ensureSingle(A,"rect","scrollbar",function(r){r.attr(m.scrollBarEnterAttrs).call(h.fill,m.scrollBarColor)}),R=I.selectAll("g.groups").data(c);R.enter().append("g").attr("class","groups"),R.exit().remove();var F=R.selectAll("g.traces").data(o.identity);F.enter().append("g").attr("class","traces"),F.exit().remove(),F.style("opacity",function(r){var n=r[0].trace;return l.traceIs(n,"pie-like")?-1!==v.indexOf(r[0].label)?.5:1:"legendonly"===n.visible?.5:1}).each(function(){a.select(this).call(k,r,n)}).call(_,r,n).each(function(){g||a.select(this).call(M,r)}),o.syncOrAsync([s.previousPromises,function(){return function(r,n,i,o){var s,l,c,u,h=r._fullLayout;o||(o=h.legend);var p=h._size,d=w.isVertical(o),g=w.isGrouped(o),v=o.borderwidth,y=2*v,x=m.itemGap,b=o.itemwidth+2*x,_=2*(v+x),T=L(o),k=o.y<0||0===o.y&&"top"===T,A=o.y>1||1===o.y&&"bottom"===T,M=o.tracegroupgap;o._maxHeight=Math.max(k||A?h.height/2:p.h,30);var S=0;o._width=0,o._height=0;var C=(l=0,c=0,(u=(s=o).title.side)&&(-1!==u.indexOf("left")&&(l=s._titleWidth),-1!==u.indexOf("top")&&(c=s._titleHeight)),[l,c]);if(d)i.each(function(r){var n=r[0].height;f.setTranslate(this,v+C[0],v+C[1]+o._height+n/2+x),o._height+=n,o._width=Math.max(o._width,r[0].width)}),S=b+o._width,o._width+=x+b+y,o._height+=_,g&&(n.each(function(r,n){f.setTranslate(this,0,n*o.tracegroupgap)}),o._height+=(o._lgroupsLength-1)*o.tracegroupgap);else{var P=E(o),I=o.x<0||0===o.x&&"right"===P,O=o.x>1||1===o.x&&"left"===P,z=A||k,D=h.width/2;o._maxWidth=Math.max(I?z&&"left"===P?p.l+p.w:D:O?z&&"right"===P?p.r+p.w:D:p.w,2*b);var R=0,F=0;i.each(function(r){var n=r[0].width+b;R=Math.max(R,n),F+=n}),S=null;var B=0;if(g){var N=0,j=0,U=0;n.each(function(){var r=0,n=0;a.select(this).selectAll("g.traces").each(function(i){var a=i[0].width,o=i[0].height;f.setTranslate(this,C[0],C[1]+v+x+o/2+n),n+=o,r=Math.max(r,b+a)}),N=Math.max(N,n);var i=r+x;j>0&&i+v+j>o._maxWidth&&(B=Math.max(B,j),j=0,U+=N+M,N=n),f.setTranslate(this,j,U),j+=i}),o._width=Math.max(B,j)+v,o._height=U+N+_}else{var V=i.size(),H=F+y+(V-1)*x<o._maxWidth,q=0,G=0,Y=0,W=0;i.each(function(r){var n=r[0].height,i=b+r[0].width,a=(H?i:R)+x;a+v+G-x>=o._maxWidth&&(B=Math.max(B,W),G=0,Y+=q,o._height+=q,q=0),f.setTranslate(this,C[0]+v+G,C[1]+v+Y+n/2+x),W=G+i+x,G+=a,q=Math.max(q,n)}),H?(o._width=G+y,o._height=q+_):(o._width=Math.max(B,W)+y,o._height+=q+_)}}o._width=Math.ceil(Math.max(o._width+C[0],o._titleWidth+2*(v+m.titlePad))),o._height=Math.ceil(Math.max(o._height+C[1],o._titleHeight+2*(v+m.itemGap))),o._effHeight=Math.min(o._height,o._maxHeight);var X=r._context.edits,Z=X.legendText||X.legendPosition;i.each(function(r){var n=a.select(this).select(".legendtoggle"),i=r[0].height,o=Z?b:S||b+r[0].width;d||(o+=x/2),f.setRect(n,0,-i/2,o,i)})}(r,R,F,n)},function(){var c,h,v,b,_=p._size,w=n.borderwidth;if(!g){if(M=E(k=r._fullLayout.legend),S=L(k),s.autoMargin(r,"legend",{x:k.x,y:k.y,l:k._width*y[M],r:k._width*x[M],b:k._effHeight*x[S],t:k._effHeight*y[S]}))return;var k,M,S,O=_.l+_.w*n.x-y[E(n)]*n._width,z=_.t+_.h*(1-n.y)-y[L(n)]*n._effHeight;if(p.margin.autoexpand){var R=O,F=z;O=o.constrain(O,0,p.width-n._width),z=o.constrain(z,0,p.height-n._effHeight),O!==R&&o.log("Constrain legend.x to make legend fit inside graph"),z!==F&&o.log("Constrain legend.y to make legend fit inside graph")}f.setTranslate(A,O,z)}if(D.on(".drag",null),A.on("wheel",null),g||n._height<=n._maxHeight||r._context.staticPlot){var B=n._effHeight;g&&(B=n._height),P.attr({width:n._width-w,height:B-w,x:w/2,y:w/2}),f.setTranslate(I,0,0),C.select("rect").attr({width:n._width-2*w,height:B-2*w,x:w,y:w}),f.setClipUrl(I,d,r),f.setRect(D,0,0,0,0),delete n._scrollY}else{var N,j,U,V=Math.max(m.scrollBarMinHeight,n._effHeight*n._effHeight/n._height),H=n._effHeight-V-2*m.scrollBarMargin,q=n._height-n._effHeight,G=H/q,Y=Math.min(n._scrollY||0,q);P.attr({width:n._width-2*w+m.scrollBarWidth+m.scrollBarMargin,height:n._effHeight-w,x:w/2,y:w/2}),C.select("rect").attr({width:n._width-2*w+m.scrollBarWidth+m.scrollBarMargin,height:n._effHeight-2*w,x:w,y:w+Y}),f.setClipUrl(I,d,r),Z(Y,V,G),A.on("wheel",function(){Z(Y=o.constrain(n._scrollY+a.event.deltaY/H*q,0,q),V,G),0!==Y&&Y!==q&&a.event.preventDefault()});var W=a.behavior.drag().on("dragstart",function(){var r=a.event.sourceEvent;N="touchstart"===r.type?r.changedTouches[0].clientY:r.clientY,U=Y}).on("drag",function(){var r,n=a.event.sourceEvent;2===n.buttons||n.ctrlKey||Z((r=((j="touchmove"===n.type?n.changedTouches[0].clientY:n.clientY)-N)/G+U,Y=o.constrain(r,0,q)),V,G)});D.call(W);var X=a.behavior.drag().on("dragstart",function(){var r=a.event.sourceEvent;"touchstart"===r.type&&(N=r.changedTouches[0].clientY,U=Y)}).on("drag",function(){var r,n=a.event.sourceEvent;"touchmove"===n.type&&(j=n.changedTouches[0].clientY,Z((r=(N-j)/G+U,Y=o.constrain(r,0,q)),V,G))});I.call(X)}function Z(i,a,o){n._scrollY=r._fullLayout.legend._scrollY=i,f.setTranslate(I,0,-i),f.setRect(D,n._width,m.scrollBarMargin+i*o,m.scrollBarWidth,a),C.select("rect").attr("y",w+i)}r._context.edits.legendPosition&&(A.classed("cursor-move",!0),u.init({element:A.node(),gd:r,prepFn:function(){var r=f.getTranslate(A);v=r.x,b=r.y},moveFn:function(r,i){var a=v+r,o=b+i;f.setTranslate(A,a,o),c=u.align(a,0,_.l,_.l+_.w,n.xanchor),h=u.align(o,0,_.t+_.h,_.t,n.yanchor)},doneFn:function(){void 0!==c&&void 0!==h&&l.call("_guiRelayout",r,{"legend.x":c,"legend.y":h})},clickFn:function(n,a){var o=i.selectAll("g.traces").filter(function(){var r=this.getBoundingClientRect();return a.clientX>=r.left&&a.clientX<=r.right&&a.clientY>=r.top&&a.clientY<=r.bottom});o.size()>0&&T(r,A,o,n,a)}}))}],r)}}(r,n)}},{"../../constants/alignment":471,"../../lib":503,"../../lib/events":492,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"./constants":417,"./get_legend_data":420,"./handle_click":421,"./helpers":422,"./style":424,"@plotly/d3":58}],420:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("./helpers");n.exports=function(r,n){var i,s,l=n._inHover,c=o.isGrouped(n),u=o.isReversed(n),f={},h=[],p=!1,d={},m=0,g=0;function v(r,i){if(""!==r&&o.isGrouped(n))-1===h.indexOf(r)?(h.push(r),p=!0,f[r]=[i]):f[r].push(i);else{var a="~~i"+m;h.push(a),f[a]=[i],m++}}for(i=0;i<r.length;i++){var y=r[i],x=y[0],b=x.trace,_=b.legendgroup;if(l||b.visible&&b.showlegend){if(a.traceIs(b,"pie-like"))for(d[_]||(d[_]={}),s=0;s<y.length;s++){var w=y[s].label;d[_][w]||(v(_,{label:w,color:y[s].color,i:y[s].i,trace:b,pts:y[s].pts}),d[_][w]=!0,g=Math.max(g,(w||"").length))}else v(_,x),g=Math.max(g,(b.name||"").length)}}if(!h.length)return[];var T=!p||!c,k=[];for(i=0;i<h.length;i++){var A=f[h[i]];T?k.push(A[0]):k.push(A)}for(T&&(k=[k]),i=0;i<k.length;i++){var M=1/0;for(s=0;s<k[i].length;s++){var S=k[i][s].trace.legendrank;M>S&&(M=S)}k[i][0]._groupMinRank=M,k[i][0]._preGroupSort=i}var E=function(r,n){return r.trace.legendrank-n.trace.legendrank||r._preSort-n._preSort};for(k.forEach(function(r,n){r[0]._preGroupSort=n}),k.sort(function(r,n){return r[0]._groupMinRank-n[0]._groupMinRank||r[0]._preGroupSort-n[0]._preGroupSort}),i=0;i<k.length;i++){k[i].forEach(function(r,n){r._preSort=n}),k[i].sort(E);var L=k[i][0].trace,C=null;for(s=0;s<k[i].length;s++){var P=k[i][s].trace.legendgrouptitle;if(P&&P.text){C=P,l&&(P.font=n._groupTitleFont);break}}if(u&&k[i].reverse(),C){var I=!1;for(s=0;s<k[i].length;s++)if(a.traceIs(k[i][s].trace,"pie-like")){I=!0;break}k[i].unshift({i:-1,groupTitle:C,noClick:I,trace:{showlegend:L.showlegend,legendgroup:L.legendgroup,visible:"toggleitem"===n.groupclick||L.visible}})}for(s=0;s<k[i].length;s++)k[i][s]=[k[i][s]]}return n._lgroupsLength=k.length,n._maxNameLength=g,k}},{"../../registry":638,"./helpers":422}],421:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../registry"),s=!0;n.exports=function(r,n,i){var l=n._fullLayout;if(!n._dragged&&!n._editing){var c,u=l.legend.itemclick,f=l.legend.itemdoubleclick,h=l.legend.groupclick;if(1===i&&"toggle"===u&&"toggleothers"===f&&s&&n.data&&n._context.showTips&&a.notifier(a._(n,"Double-click on legend to isolate one trace"),"long"),s=!1,1===i?c=u:2===i&&(c=f),c){var p="togglegroup"===h,d=l.hiddenlabels?l.hiddenlabels.slice():[],m=r.data()[0][0];if(!m.groupTitle||!m.noClick){var g,v,y,x,b,_=n._fullData,w=m.trace,T=w.legendgroup,k={},A=[],M=[],S=[];if(o.traceIs(w,"pie-like")){var E=m.label,L=d.indexOf(E);"toggle"===c?-1===L?d.push(E):d.splice(L,1):"toggleothers"===c&&(d=[],n.calcdata[0].forEach(function(r){E!==r.label&&d.push(r.label)}),n._fullLayout.hiddenlabels&&n._fullLayout.hiddenlabels.length===d.length&&-1===L&&(d=[])),o.call("_guiRelayout",n,"hiddenlabels",d)}else{var C,P=T&&T.length,I=[];if(P)for(g=0;g<_.length;g++)(C=_[g]).visible&&C.legendgroup===T&&I.push(g);if("toggle"===c){switch(w.visible){case!0:O="legendonly";break;case!1:O=!1;break;case"legendonly":O=!0}if(P){if(p)for(g=0;g<_.length;g++)!1!==_[g].visible&&_[g].legendgroup===T&&V(_[g],O);else V(w,O)}else V(w,O)}else if("toggleothers"===c){var O,z,D,R,F,B=!0;for(g=0;g<_.length;g++)if(z=_[g]===w,R=!0!==_[g].showlegend,!(z||R||(D=P&&_[g].legendgroup===T)||!0!==_[g].visible||o.traceIs(_[g],"notLegendIsolatable"))){B=!1;break}for(g=0;g<_.length;g++)if(!1!==_[g].visible&&!o.traceIs(_[g],"notLegendIsolatable"))switch(w.visible){case"legendonly":V(_[g],!0);break;case!0:F=!!B||"legendonly",z=_[g]===w,R=!0!==_[g].showlegend&&!_[g].legendgroup,D=z||P&&_[g].legendgroup===T,V(_[g],!(!D&&!R)||F)}}for(g=0;g<M.length;g++)if(y=M[g]){var N=y.constructUpdate(),j=Object.keys(N);for(v=0;v<j.length;v++)(k[x=j[v]]=k[x]||[])[S[g]]=N[x]}for(b=Object.keys(k),g=0;g<b.length;g++)for(x=b[g],v=0;v<A.length;v++)k[x].hasOwnProperty(v)||(k[x][v]=void 0);o.call("_guiRestyle",n,k,A)}}}}function U(r,n,i){var a=A.indexOf(r),o=k[n];return o||(o=k[n]=[]),-1===A.indexOf(r)&&(A.push(r),a=A.length-1),o[a]=i,a}function V(r,n){if(!m.groupTitle||p){var i=r._fullInput;if(o.hasTransform(i,"groupby")){var s=M[i.index];if(!s){var l=o.getTransformIndices(i,"groupby"),c=l[l.length-1];s=a.keyedContainer(i,"transforms["+c+"].styles","target","value.visible"),M[i.index]=s}var u=s.get(r._group);void 0===u&&(u=!0),!1!==u&&s.set(r._group,n),S[i.index]=U(i.index,"visible",!1!==i.visible)}else{var f=!1!==i.visible&&n;U(i.index,"visible",f)}}}}},{"../../lib":503,"../../registry":638}],422:[function(r,n,i){"use strict";i.isGrouped=function(r){return -1!==(r.traceorder||"").indexOf("grouped")},i.isVertical=function(r){return"h"!==r.orientation},i.isReversed=function(r){return -1!==(r.traceorder||"").indexOf("reversed")}},{}],423:[function(r,n,i){"use strict";n.exports={moduleType:"component",name:"legend",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),draw:r("./draw"),style:r("./style")}},{"./attributes":416,"./defaults":418,"./draw":419,"./style":424}],424:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../registry"),s=r("../../lib"),l=s.strTranslate,c=r("../drawing"),u=r("../color"),f=r("../colorscale/helpers").extractOpts,h=r("../../traces/scatter/subtypes"),p=r("../../traces/pie/style_one"),d=r("../../traces/pie/helpers").castOption,m=r("./constants");function g(r,n){return(n?"radial":"horizontal")+(r?"":"reversed")}function v(r){var n=r[0].trace,i=n.contours,a=h.hasLines(n),o=h.hasMarkers(n),s=n.visible&&n.fill&&"none"!==n.fill,l=!1,c=!1;if(i){var u=i.coloring;"lines"===u?l=!0:a="none"===u||"heatmap"===u||i.showlines,"constraint"===i.type?s="="!==i._operation:"fill"!==u&&"heatmap"!==u||(c=!0)}return{showMarker:o,showLine:a,showFill:s,showGradientLine:l,showGradientFill:c,anyLine:a||l,anyFill:s||c}}function y(r,n,i){return r&&s.isArrayOrTypedArray(r)?n:r>i?i:r}n.exports=function(r,n,i){var x=n._fullLayout;i||(i=x.legend);var b="constant"===i.itemsizing,_=i.itemwidth,w=l((_+2*m.itemGap)/2,0),T=function(r,n,i,a){var o;if(r+1)o=r;else{if(!(n&&n.width>0))return 0;o=n.width}return b?a:Math.min(o,i)};function k(r,s,l){var h=r[0].trace,p=h.marker||{},d=p.line||{},m=l?h.visible&&h.type===l:o.traceIs(h,"bar"),g=a.select(s).select("g.legendpoints").selectAll("path.legend"+l).data(m?[r]:[]);g.enter().append("path").classed("legend"+l,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",w),g.exit().remove(),g.each(function(r){var o=a.select(this),s=r[0],l=T(s.mlw,p.line,5,2);o.style("stroke-width",l+"px");var m=s.mcc;if(!i._inHover&&"mc"in s){var g=f(p),v=g.mid;void 0===v&&(v=(g.max+g.min)/2),m=c.tryColorscale(p,"")(v)}var x=m||s.mc||p.color,b=p.pattern,_=b&&c.getPatternAttr(b.shape,0,"");if(_){var w=c.getPatternAttr(b.bgcolor,0,null),k=c.getPatternAttr(b.fgcolor,0,null),A=b.fgopacity,M=y(b.size,8,10),S=y(b.solidity,.5,1),E="legend-"+h.uid;o.call(c.pattern,"legend",n,E,_,M,S,m,b.fillmode,w,k,A)}else o.call(u.fill,x);l&&u.stroke(o,s.mlc||d.color)})}function A(r,n,i){var l=r[0],c=l.trace,u=i?c.visible&&c.type===i:o.traceIs(c,i),f=a.select(n).select("g.legendpoints").selectAll("path.legend"+i).data(u?[r]:[]);if(f.enter().append("path").classed("legend"+i,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",w),f.exit().remove(),f.size()){var h=(c.marker||{}).line,m=T(d(h.width,l.pts),h,5,2),g=s.minExtend(c,{marker:{line:{width:m}}});g.marker.line.color=h.color,p(f,s.minExtend(l,{trace:g}),g)}}r.each(function(r){var n=a.select(this),o=s.ensureSingle(n,"g","layers");o.style("opacity",r[0].trace.opacity);var c=i.valign,u=r[0].lineHeight,f=r[0].height;"middle"!==c&&u&&f?o.attr("transform",l(0,.5*(u-f+3)*({top:1,bottom:-1})[c])):o.attr("transform",null),o.selectAll("g.legendfill").data([r]).enter().append("g").classed("legendfill",!0),o.selectAll("g.legendlines").data([r]).enter().append("g").classed("legendlines",!0);var h=o.selectAll("g.legendsymbols").data([r]);h.enter().append("g").classed("legendsymbols",!0),h.selectAll("g.legendpoints").data([r]).enter().append("g").classed("legendpoints",!0)}).each(function(r){var i,o=r[0].trace,l=[];if(o.visible)switch(o.type){case"histogram2d":case"heatmap":l=[["M-15,-2V4H15V-2Z"]],i=!0;break;case"choropleth":case"choroplethmapbox":l=[["M-6,-6V6H6V-6Z"]],i=!0;break;case"densitymapbox":l=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],i="radial";break;case"cone":l=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],i=!1;break;case"streamtube":l=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],i=!1;break;case"surface":l=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],i=!0;break;case"mesh3d":l=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],i=!1;break;case"volume":l=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],i=!0;break;case"isosurface":l=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],i=!1}var h=a.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(l);h.enter().append("path").classed("legend3dandfriends",!0).attr("transform",w).style("stroke-miterlimit",1),h.exit().remove(),h.each(function(r,l){var h,p=a.select(this),d=f(o),m=d.colorscale,v=d.reversescale;if(m){if(!i){var y=m.length;h=0===l?m[v?y-1:0][1]:1===l?m[v?0:y-1][1]:m[Math.floor((y-1)/2)][1]}}else{var x=o.vertexcolor||o.facecolor||o.color;h=s.isArrayOrTypedArray(x)?x[l]||x[0]:x}p.attr("d",r[0]),h?p.call(u.fill,h):p.call(function(r){if(r.size()){var a="legendfill-"+o.uid;c.gradient(r,n,a,g(v,"radial"===i),m,"fill")}})})}).each(function(r){var n=r[0].trace,i="waterfall"===n.type;if(r[0]._distinct&&i){var o=r[0].trace[r[0].dir].marker;return r[0].mc=o.color,r[0].mlw=o.line.width,r[0].mlc=o.line.color,k(r,this,"waterfall")}var s=[];n.visible&&i&&(s=r[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var l=a.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(s);l.enter().append("path").classed("legendwaterfall",!0).attr("transform",w).style("stroke-miterlimit",1),l.exit().remove(),l.each(function(r){var i=a.select(this),o=n[r[0]].marker,s=T(void 0,o.line,5,2);i.attr("d",r[1]).style("stroke-width",s+"px").call(u.fill,o.color),s&&i.call(u.stroke,o.line.color)})}).each(function(r){k(r,this,"funnel")}).each(function(r){k(r,this)}).each(function(r){var i=r[0].trace,l=a.select(this).select("g.legendpoints").selectAll("path.legendbox").data(i.visible&&o.traceIs(i,"box-violin")?[r]:[]);l.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",w),l.exit().remove(),l.each(function(){var r=a.select(this);if("all"!==i.boxpoints&&"all"!==i.points||0!==u.opacity(i.fillcolor)||0!==u.opacity((i.line||{}).color)){var o=T(void 0,i.line,5,2);r.style("stroke-width",o+"px").call(u.fill,i.fillcolor),o&&u.stroke(r,i.line.color)}else{var f=s.minExtend(i,{marker:{size:b?12:s.constrain(i.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});l.call(c.pointStyle,f,n)}})}).each(function(r){A(r,this,"funnelarea")}).each(function(r){A(r,this,"pie")}).each(function(r){var i,o,l=v(r),u=l.showFill,p=l.showLine,d=l.showGradientLine,m=l.showGradientFill,y=l.anyFill,x=l.anyLine,b=r[0],w=b.trace,k=f(w),A=k.colorscale,M=k.reversescale,S=h.hasMarkers(w)||!y?"M5,0":x?"M5,-2":"M5,-3",E=a.select(this),L=E.select(".legendfill").selectAll("path").data(u||m?[r]:[]);if(L.enter().append("path").classed("js-fill",!0),L.exit().remove(),L.attr("d",S+"h"+_+"v6h-"+_+"z").call(u?c.fillGroupStyle:function(r){if(r.size()){var i="legendfill-"+w.uid;c.gradient(r,n,i,g(M),A,"fill")}}),p||d){var C=T(void 0,w.line,10,5);o=s.minExtend(w,{line:{width:C}}),i=[s.minExtend(b,{trace:o})]}var P=E.select(".legendlines").selectAll("path").data(p||d?[i]:[]);P.enter().append("path").classed("js-line",!0),P.exit().remove(),P.attr("d",S+(d?"l"+_+",0.0001":"h"+_)).call(p?c.lineGroupStyle:function(r){if(r.size()){var i="legendline-"+w.uid;c.lineGroupStyle(r),c.gradient(r,n,i,g(M),A,"stroke")}})}).each(function(r){var i,o,l=v(r),u=l.anyFill,f=l.anyLine,p=l.showLine,d=l.showMarker,m=r[0],g=m.trace,y=!d&&!f&&!u&&h.hasText(g);function x(r,n,i,a){var o=s.nestedProperty(g,r).get(),l=s.isArrayOrTypedArray(o)&&n?n(o):o;if(b&&l&&void 0!==a&&(l=a),i){if(l<i[0])return i[0];if(l>i[1])return i[1]}return l}function _(r){return m._distinct&&m.index&&r[m.index]?r[m.index]:r[0]}if(d||y||p){var T={},k={};if(d){T.mc=x("marker.color",_),T.mx=x("marker.symbol",_),T.mo=x("marker.opacity",s.mean,[.2,1]),T.mlc=x("marker.line.color",_),T.mlw=x("marker.line.width",s.mean,[0,5],2),k.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var A=x("marker.size",s.mean,[2,16],12);T.ms=A,k.marker.size=A}p&&(k.line={width:x("line.width",_,[0,10],5)}),y&&(T.tx="Aa",T.tp=x("textposition",_),T.ts=10,T.tc=x("textfont.color",_),T.tf=x("textfont.family",_)),i=[s.minExtend(m,T)],(o=s.minExtend(g,k)).selectedpoints=null,o.texttemplate=null}var M=a.select(this).select("g.legendpoints"),S=M.selectAll("path.scatterpts").data(d?i:[]);S.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",w),S.exit().remove(),S.call(c.pointStyle,o,n),d&&(i[0].mrc=3);var E=M.selectAll("g.pointtext").data(y?i:[]);E.enter().append("g").classed("pointtext",!0).append("text").attr("transform",w),E.exit().remove(),E.selectAll("text").call(c.textPointStyle,o,n)}).each(function(r){var n=r[0].trace,i=a.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(n.visible&&"candlestick"===n.type?[r,r]:[]);i.enter().append("path").classed("legendcandle",!0).attr("d",function(r,n){return n?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",w).style("stroke-miterlimit",1),i.exit().remove(),i.each(function(r,i){var o=a.select(this),s=n[i?"increasing":"decreasing"],l=T(void 0,s.line,5,2);o.style("stroke-width",l+"px").call(u.fill,s.fillcolor),l&&u.stroke(o,s.line.color)})}).each(function(r){var n=r[0].trace,i=a.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(n.visible&&"ohlc"===n.type?[r,r]:[]);i.enter().append("path").classed("legendohlc",!0).attr("d",function(r,n){return n?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",w).style("stroke-miterlimit",1),i.exit().remove(),i.each(function(r,i){var o=a.select(this),s=n[i?"increasing":"decreasing"],l=T(void 0,s.line,5,2);o.style("fill","none").call(c.dashLine,s.line.dash,l),l&&u.stroke(o,s.line.color)})})}},{"../../lib":503,"../../registry":638,"../../traces/pie/helpers":905,"../../traces/pie/style_one":911,"../../traces/scatter/subtypes":951,"../color":366,"../colorscale/helpers":377,"../drawing":388,"./constants":417,"@plotly/d3":58}],425:[function(r,n,i){"use strict";r("./constants"),n.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":427}],426:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../plots/plots"),s=r("../../plots/cartesian/axis_ids"),l=r("../../fonts/ploticon"),c=r("../shapes/draw").eraseActiveShape,u=r("../../lib"),f=u._,h=n.exports={};function p(r,n){var i,o,l=n.currentTarget,c=l.getAttribute("data-attr"),u=l.getAttribute("data-val")||!0,f=r._fullLayout,h={},p=s.list(r,null,!0),d=f._cartesianSpikesEnabled;if("zoom"===c){var m,g="in"===u?.5:2,v=(1+g)/2,y=(1-g)/2;for(o=0;o<p.length;o++)if(!(i=p[o]).fixedrange){if(m=i._name,"auto"===u)h[m+".autorange"]=!0;else if("reset"===u){if(void 0===i._rangeInitial)h[m+".autorange"]=!0;else{var x=i._rangeInitial.slice();h[m+".range[0]"]=x[0],h[m+".range[1]"]=x[1]}void 0!==i._showSpikeInitial&&(h[m+".showspikes"]=i._showSpikeInitial,"on"!==d||i._showSpikeInitial||(d="off"))}else{var b=[i.r2l(i.range[0]),i.r2l(i.range[1])],_=[v*b[0]+y*b[1],v*b[1]+y*b[0]];h[m+".range[0]"]=i.l2r(_[0]),h[m+".range[1]"]=i.l2r(_[1])}}}else"hovermode"!==c||"x"!==u&&"y"!==u||(u=f._isHoriz?"y":"x",l.setAttribute("data-val",u)),h[c]=u;f._cartesianSpikesEnabled=d,a.call("_guiRelayout",r,h)}function d(r,n){for(var i=n.currentTarget,o=i.getAttribute("data-attr"),s=i.getAttribute("data-val")||!0,l=r._fullLayout._subplots.gl3d||[],c={},u=o.split("."),f=0;f<l.length;f++)c[l[f]+"."+u[1]]=s;var h="pan"===s?s:"zoom";c.dragmode=h,a.call("_guiRelayout",r,c)}function m(r,n){for(var i=n.currentTarget.getAttribute("data-attr"),o="resetLastSave"===i,s="resetDefault"===i,l=r._fullLayout,c=l._subplots.gl3d||[],u={},f=0;f<c.length;f++){var h,p=c[f],d=p+".camera",m=p+".aspectratio",g=p+".aspectmode",v=l[p]._scene;o?(u[d+".up"]=v.viewInitial.up,u[d+".eye"]=v.viewInitial.eye,u[d+".center"]=v.viewInitial.center,h=!0):s&&(u[d+".up"]=null,u[d+".eye"]=null,u[d+".center"]=null,h=!0),h&&(u[m+".x"]=v.viewInitial.aspectratio.x,u[m+".y"]=v.viewInitial.aspectratio.y,u[m+".z"]=v.viewInitial.aspectratio.z,u[g]=v.viewInitial.aspectmode)}a.call("_guiRelayout",r,u)}function g(r,n){var i=n.currentTarget,a=i._previousVal,o=r._fullLayout,s=o._subplots.gl3d||[],l=["xaxis","yaxis","zaxis"],c={},u={};if(a)u=a,i._previousVal=null;else{for(var f=0;f<s.length;f++){var h=s[f],p=o[h],d=h+".hovermode";c[d]=p.hovermode,u[d]=!1;for(var m=0;m<3;m++){var g=l[m],v=h+"."+g+".showspikes";u[v]=!1,c[v]=p[g].showspikes}}i._previousVal=c}return u}function v(r,n){for(var i=n.currentTarget,o=i.getAttribute("data-attr"),s=i.getAttribute("data-val")||!0,l=r._fullLayout,c=l._subplots.geo||[],u=0;u<c.length;u++){var f=c[u],h=l[f];if("zoom"===o){var p=h.projection.scale,d="in"===s?2*p:.5*p;a.call("_guiRelayout",r,f+".projection.scale",d)}}"reset"===o&&_(r,"geo")}function y(r){var n=r._fullLayout;return!n.hovermode&&(n._has("cartesian")?n._isHoriz?"y":"x":"closest")}function x(r){var n=y(r);a.call("_guiRelayout",r,"hovermode",n)}function b(r,n){for(var i=n.currentTarget.getAttribute("data-val"),o=r._fullLayout,s=o._subplots.mapbox||[],l={},c=0;c<s.length;c++){var u=s[c],f=o[u].zoom,h="in"===i?1.05*f:f/1.05;l[u+".zoom"]=h}a.call("_guiRelayout",r,l)}function _(r,n){for(var i=r._fullLayout,o=i._subplots[n]||[],s={},l=0;l<o.length;l++)for(var c=o[l],u=i[c]._subplot.viewInitial,f=Object.keys(u),h=0;h<f.length;h++){var p=f[h];s[c+"."+p]=u[p]}a.call("_guiRelayout",r,s)}h.toImage={name:"toImage",title:function(r){var n=(r._context.toImageButtonOptions||{}).format||"png";return f(r,"png"===n?"Download plot as a png":"Download plot")},icon:l.camera,click:function(r){var n=r._context.toImageButtonOptions,i={format:n.format||"png"};u.notifier(f(r,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==i.format&&u.isIE()&&(u.notifier(f(r,"IE only supports svg.  Changing format to svg."),"long"),i.format="svg"),["filename","width","height","scale"].forEach(function(r){r in n&&(i[r]=n[r])}),a.call("downloadImage",r,i).then(function(n){u.notifier(f(r,"Snapshot succeeded")+" - "+n,"long")}).catch(function(){u.notifier(f(r,"Sorry, there was a problem downloading your snapshot!"),"long")})}},h.sendDataToCloud={name:"sendDataToCloud",title:function(r){return f(r,"Edit in Chart Studio")},icon:l.disk,click:function(r){o.sendDataToCloud(r)}},h.editInChartStudio={name:"editInChartStudio",title:function(r){return f(r,"Edit in Chart Studio")},icon:l.pencil,click:function(r){o.sendDataToCloud(r)}},h.zoom2d={name:"zoom2d",_cat:"zoom",title:function(r){return f(r,"Zoom")},attr:"dragmode",val:"zoom",icon:l.zoombox,click:p},h.pan2d={name:"pan2d",_cat:"pan",title:function(r){return f(r,"Pan")},attr:"dragmode",val:"pan",icon:l.pan,click:p},h.select2d={name:"select2d",_cat:"select",title:function(r){return f(r,"Box Select")},attr:"dragmode",val:"select",icon:l.selectbox,click:p},h.lasso2d={name:"lasso2d",_cat:"lasso",title:function(r){return f(r,"Lasso Select")},attr:"dragmode",val:"lasso",icon:l.lasso,click:p},h.drawclosedpath={name:"drawclosedpath",title:function(r){return f(r,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:l.drawclosedpath,click:p},h.drawopenpath={name:"drawopenpath",title:function(r){return f(r,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:l.drawopenpath,click:p},h.drawline={name:"drawline",title:function(r){return f(r,"Draw line")},attr:"dragmode",val:"drawline",icon:l.drawline,click:p},h.drawrect={name:"drawrect",title:function(r){return f(r,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:l.drawrect,click:p},h.drawcircle={name:"drawcircle",title:function(r){return f(r,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:l.drawcircle,click:p},h.eraseshape={name:"eraseshape",title:function(r){return f(r,"Erase active shape")},icon:l.eraseshape,click:c},h.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(r){return f(r,"Zoom in")},attr:"zoom",val:"in",icon:l.zoom_plus,click:p},h.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(r){return f(r,"Zoom out")},attr:"zoom",val:"out",icon:l.zoom_minus,click:p},h.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(r){return f(r,"Autoscale")},attr:"zoom",val:"auto",icon:l.autoscale,click:p},h.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(r){return f(r,"Reset axes")},attr:"zoom",val:"reset",icon:l.home,click:p},h.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(r){return f(r,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:l.tooltip_basic,gravity:"ne",click:p},h.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(r){return f(r,"Compare data on hover")},attr:"hovermode",val:function(r){return r._fullLayout._isHoriz?"y":"x"},icon:l.tooltip_compare,gravity:"ne",click:p},h.zoom3d={name:"zoom3d",_cat:"zoom",title:function(r){return f(r,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:l.zoombox,click:d},h.pan3d={name:"pan3d",_cat:"pan",title:function(r){return f(r,"Pan")},attr:"scene.dragmode",val:"pan",icon:l.pan,click:d},h.orbitRotation={name:"orbitRotation",title:function(r){return f(r,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:l["3d_rotate"],click:d},h.tableRotation={name:"tableRotation",title:function(r){return f(r,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:l["z-axis"],click:d},h.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(r){return f(r,"Reset camera to default")},attr:"resetDefault",icon:l.home,click:m},h.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(r){return f(r,"Reset camera to last save")},attr:"resetLastSave",icon:l.movie,click:m},h.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(r){return f(r,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:l.tooltip_basic,gravity:"ne",click:function(r,n){var i=g(r,n);a.call("_guiRelayout",r,i)}},h.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(r){return f(r,"Zoom in")},attr:"zoom",val:"in",icon:l.zoom_plus,click:v},h.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(r){return f(r,"Zoom out")},attr:"zoom",val:"out",icon:l.zoom_minus,click:v},h.resetGeo={name:"resetGeo",_cat:"reset",title:function(r){return f(r,"Reset")},attr:"reset",val:null,icon:l.autoscale,click:v},h.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(r){return f(r,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:l.tooltip_basic,gravity:"ne",click:x},h.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(r){return f(r,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:l.tooltip_basic,gravity:"ne",click:x},h.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(r){return f(r,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:l.tooltip_basic,gravity:"ne",click:x},h.resetViewSankey={name:"resetSankeyGroup",title:function(r){return f(r,"Reset view")},icon:l.home,click:function(r){for(var n={"node.groups":[],"node.x":[],"node.y":[]},i=0;i<r._fullData.length;i++){var o=r._fullData[i]._viewInitial;n["node.groups"].push(o.node.groups.slice()),n["node.x"].push(o.node.x.slice()),n["node.y"].push(o.node.y.slice())}a.call("restyle",r,n)}},h.toggleHover={name:"toggleHover",title:function(r){return f(r,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:l.tooltip_basic,gravity:"ne",click:function(r,n){var i=g(r,n);i.hovermode=y(r),a.call("_guiRelayout",r,i)}},h.resetViews={name:"resetViews",title:function(r){return f(r,"Reset views")},icon:l.home,click:function(r,n){var i=n.currentTarget;i.setAttribute("data-attr","zoom"),i.setAttribute("data-val","reset"),p(r,n),i.setAttribute("data-attr","resetLastSave"),m(r,n),_(r,"geo"),_(r,"mapbox")}},h.toggleSpikelines={name:"toggleSpikelines",title:function(r){return f(r,"Toggle Spike Lines")},icon:l.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(r){var n=r._fullLayout,i=n._cartesianSpikesEnabled;n._cartesianSpikesEnabled="on"===i?"off":"on",a.call("_guiRelayout",r,function(r){for(var n="on"===r._fullLayout._cartesianSpikesEnabled,i=s.list(r,null,!0),a={},o=0;o<i.length;o++){var l=i[o];a[l._name+".showspikes"]=!!n||l._showSpikeInitial}return a}(r))}},h.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(r){return f(r,"Reset view")},attr:"reset",icon:l.home,click:function(r){_(r,"mapbox")}},h.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(r){return f(r,"Zoom in")},attr:"zoom",val:"in",icon:l.zoom_plus,click:b},h.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(r){return f(r,"Zoom out")},attr:"zoom",val:"out",icon:l.zoom_minus,click:b}},{"../../fonts/ploticon":482,"../../lib":503,"../../plots/cartesian/axis_ids":558,"../../plots/plots":619,"../../registry":638,"../shapes/draw":450}],427:[function(r,n,i){"use strict";var a=r("./buttons"),o=Object.keys(a),s=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],l=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(s),c=[];o.forEach(function(r){!function(r){if(-1===l.indexOf(r._cat||r.name)){var n=r.name,i=(r._cat||r.name).toLowerCase();-1===c.indexOf(n)&&c.push(n),-1===c.indexOf(i)&&c.push(i)}}(a[r])}),c.sort(),n.exports={DRAW_MODES:s,backButtons:l,foreButtons:c}},{"./buttons":426}],428:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../color"),s=r("../../plot_api/plot_template"),l=r("./attributes");n.exports=function(r,n){var i=r.modebar||{},c=s.newContainer(n,"modebar");function u(r,n){return a.coerce(i,c,l,r,n)}u("orientation"),u("bgcolor",o.addOpacity(n.paper_bgcolor,.5));var f=o.contrast(o.rgb(n.modebar.bgcolor));u("color",o.addOpacity(f,.3)),u("activecolor",o.addOpacity(f,.7)),u("uirevision",n.uirevision),u("add"),u("remove")}},{"../../lib":503,"../../plot_api/plot_template":543,"../color":366,"./attributes":425}],429:[function(r,n,i){"use strict";n.exports={moduleType:"component",name:"modebar",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),manage:r("./manage")}},{"./attributes":425,"./defaults":428,"./manage":430}],430:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axis_ids"),o=r("../../traces/scatter/subtypes"),s=r("../../registry"),l=r("../fx/helpers").isUnifiedHover,c=r("./modebar"),u=r("./buttons"),f=r("./constants").DRAW_MODES;n.exports=function(r){var n=r._fullLayout,i=r._context,h=n._modeBar;if(i.displayModeBar||i.watermark){if(!Array.isArray(i.modeBarButtonsToRemove))throw Error("*modeBarButtonsToRemove* configuration options must be an array.");if(!Array.isArray(i.modeBarButtonsToAdd))throw Error("*modeBarButtonsToAdd* configuration options must be an array.");var p,d=i.modeBarButtons;p=Array.isArray(d)&&d.length?function(r){for(var n=0;n<r.length;n++)for(var i=r[n],a=0;a<i.length;a++){var o=i[a];if("string"==typeof o){if(void 0===u[o])throw Error("*modeBarButtons* configuration options invalid button name");r[n][a]=u[o]}}return r}(d):!i.displayModeBar&&i.watermark?[]:function(r){var n=r._fullLayout,i=r._fullData,c=r._context;function h(r,n){if("string"==typeof n){if(n.toLowerCase()===r.toLowerCase())return!0}else{var i=n.name,a=n._cat||n.name;if(i===r||a===r.toLowerCase())return!0}return!1}var p=n.modebar.add;"string"==typeof p&&(p=[p]);var d=n.modebar.remove;"string"==typeof d&&(d=[d]);var m=c.modeBarButtonsToAdd.concat(p.filter(function(r){for(var n=0;n<c.modeBarButtonsToRemove.length;n++)if(h(r,c.modeBarButtonsToRemove[n]))return!1;return!0})),g=c.modeBarButtonsToRemove.concat(d.filter(function(r){for(var n=0;n<c.modeBarButtonsToAdd.length;n++)if(h(r,c.modeBarButtonsToAdd[n]))return!1;return!0})),v=n._has("cartesian"),y=n._has("gl3d"),x=n._has("geo"),b=n._has("pie"),_=n._has("funnelarea"),w=n._has("gl2d"),T=n._has("ternary"),k=n._has("mapbox"),A=n._has("polar"),M=n._has("smith"),S=n._has("sankey"),E=function(r){for(var n=a.list({_fullLayout:r},null,!0),i=0;i<n.length;i++)if(!n[i].fixedrange)return!1;return!0}(n),L=l(n.hovermode),C=[];function P(r){if(r.length){for(var n=[],i=0;i<r.length;i++){for(var a=r[i],o=u[a],s=o.name.toLowerCase(),l=(o._cat||o.name).toLowerCase(),c=!1,f=0;f<g.length;f++){var h=g[f].toLowerCase();if(h===s||h===l){c=!0;break}}c||n.push(u[a])}C.push(n)}}var I=["toImage"];c.showEditInChartStudio?I.push("editInChartStudio"):c.showSendToCloud&&I.push("sendDataToCloud"),P(I);var O=[],z=[],D=[],R=[];(v||w||b||_||T)+x+y+k+A+M>1?(z=["toggleHover"],D=["resetViews"]):x?(O=["zoomInGeo","zoomOutGeo"],z=["hoverClosestGeo"],D=["resetGeo"]):y?(z=["hoverClosest3d"],D=["resetCameraDefault3d","resetCameraLastSave3d"]):k?(O=["zoomInMapbox","zoomOutMapbox"],z=["toggleHover"],D=["resetViewMapbox"]):w?z=["hoverClosestGl2d"]:b?z=["hoverClosestPie"]:S?(z=["hoverClosestCartesian","hoverCompareCartesian"],D=["resetViewSankey"]):z=["toggleHover"],v&&(z=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(r){for(var n=0;n<r.length;n++)if(!s.traceIs(r[n],"noHover"))return!1;return!0}(i)||L)&&(z=[]),(v||w)&&!E&&(O=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"===D[0]||(D=["resetScale2d"])),y?R=["zoom3d","pan3d","orbitRotation","tableRotation"]:(v||w)&&!E||T?R=["zoom2d","pan2d"]:k||x?R=["pan2d"]:A&&(R=["zoom2d"]),function(r){for(var n=!1,i=0;i<r.length&&!n;i++){var a=r[i];a._module&&a._module.selectPoints&&(s.traceIs(a,"scatter-like")?(o.hasMarkers(a)||o.hasText(a))&&(n=!0):s.traceIs(a,"box-violin")&&"all"!==a.boxpoints&&"all"!==a.points||(n=!0))}return n}(i)&&R.push("select2d","lasso2d");var F=[],B=function(r){-1===F.indexOf(r)&&-1!==z.indexOf(r)&&F.push(r)};if(Array.isArray(m)){for(var N=[],j=0;j<m.length;j++){var U=m[j];"string"==typeof U?(U=U.toLowerCase(),-1!==f.indexOf(U)?(n._has("mapbox")||n._has("cartesian"))&&R.push(U):"togglespikelines"===U?B("toggleSpikelines"):"togglehover"===U?B("toggleHover"):"hovercompare"===U?B("hoverCompareCartesian"):"hoverclosest"===U?(B("hoverClosestCartesian"),B("hoverClosestGeo"),B("hoverClosest3d"),B("hoverClosestGl2d"),B("hoverClosestPie")):"v1hovermode"===U&&(B("toggleHover"),B("hoverClosestCartesian"),B("hoverCompareCartesian"),B("hoverClosestGeo"),B("hoverClosest3d"),B("hoverClosestGl2d"),B("hoverClosestPie"))):N.push(U)}m=N}return P(R),P(O.concat(D)),P(F),function(r,n){if(n.length){if(Array.isArray(n[0]))for(var i=0;i<n.length;i++)r.push(n[i]);else r.push(n)}return r}(C,m)}(r),h?h.update(r,p):n._modeBar=c(r,p)}else h&&(h.destroy(),delete n._modeBar)}},{"../../plots/cartesian/axis_ids":558,"../../registry":638,"../../traces/scatter/subtypes":951,"../fx/helpers":402,"./buttons":426,"./constants":427,"./modebar":431}],431:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=r("../../lib"),l=r("../../fonts/ploticon"),c=new DOMParser;function u(r){this.container=r.container,this.element=document.createElement("div"),this.update(r.graphInfo,r.buttons),this.container.appendChild(this.element)}var f=u.prototype;f.update=function(r,n){this.graphInfo=r;var i=this.graphInfo._context,a=this.graphInfo._fullLayout,o="modebar-"+a._uid;this.element.setAttribute("id",o),this._uid=o,this.element.className="modebar","hover"===i.displayModeBar&&(this.element.className+=" modebar--hover ease-bg"),"v"===a.modebar.orientation&&(this.element.className+=" vertical",n=n.reverse());var l=a.modebar,c="hover"===i.displayModeBar?".js-plotly-plot .plotly:hover ":"";s.deleteRelatedStyleRule(o),s.addRelatedStyleRule(o,c+"#"+o+" .modebar-group","background-color: "+l.bgcolor),s.addRelatedStyleRule(o,"#"+o+" .modebar-btn .icon path","fill: "+l.color),s.addRelatedStyleRule(o,"#"+o+" .modebar-btn:hover .icon path","fill: "+l.activecolor),s.addRelatedStyleRule(o,"#"+o+" .modebar-btn.active .icon path","fill: "+l.activecolor);var u=!this.hasButtons(n),f=this.hasLogo!==i.displaylogo,h=this.locale!==i.locale;if(this.locale=i.locale,(u||f||h)&&(this.removeAllButtons(),this.updateButtons(n),i.watermark||i.displaylogo)){var p=this.getLogo();i.watermark&&(p.className=p.className+" watermark"),"v"===a.modebar.orientation?this.element.insertBefore(p,this.element.childNodes[0]):this.element.appendChild(p),this.hasLogo=!0}this.updateActiveButton()},f.updateButtons=function(r){var n=this;this.buttons=r,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(r){var i=n.createGroup();r.forEach(function(r){var a=r.name;if(!a)throw Error("must provide button 'name' in button config");if(-1!==n.buttonsNames.indexOf(a))throw Error("button name '"+a+"' is taken");n.buttonsNames.push(a);var o=n.createButton(r);n.buttonElements.push(o),i.appendChild(o)}),n.element.appendChild(i)})},f.createGroup=function(){var r=document.createElement("div");return r.className="modebar-group",r},f.createButton=function(r){var n=this,i=document.createElement("a");i.setAttribute("rel","tooltip"),i.className="modebar-btn";var o=r.title;void 0===o?o=r.name:"function"==typeof o&&(o=o(this.graphInfo)),(o||0===o)&&i.setAttribute("data-title",o),void 0!==r.attr&&i.setAttribute("data-attr",r.attr);var s=r.val;if(void 0!==s&&("function"==typeof s&&(s=s(this.graphInfo)),i.setAttribute("data-val",s)),"function"!=typeof r.click)throw Error("must provide button 'click' function in button config");i.addEventListener("click",function(i){r.click(n.graphInfo,i),n.updateActiveButton(i.currentTarget)}),i.setAttribute("data-toggle",r.toggle||!1),r.toggle&&a.select(i).classed("active",!0);var c=r.icon;return"function"==typeof c?i.appendChild(c()):i.appendChild(this.createIcon(c||l.question)),i.setAttribute("data-gravity",r.gravity||"n"),i},f.createIcon=function(r){var n,i=o(r.height)?Number(r.height):r.ascent-r.descent,a="http://www.w3.org/2000/svg";if(r.path){(n=document.createElementNS(a,"svg")).setAttribute("viewBox",[0,0,r.width,i].join(" ")),n.setAttribute("class","icon");var s=document.createElementNS(a,"path");s.setAttribute("d",r.path),r.transform?s.setAttribute("transform",r.transform):void 0!==r.ascent&&s.setAttribute("transform","matrix(1 0 0 -1 0 "+r.ascent+")"),n.appendChild(s)}return r.svg&&(n=c.parseFromString(r.svg,"application/xml").childNodes[0]),n.setAttribute("height","1em"),n.setAttribute("width","1em"),n},f.updateActiveButton=function(r){var n=this.graphInfo._fullLayout,i=void 0!==r?r.getAttribute("data-attr"):null;this.buttonElements.forEach(function(r){var o=r.getAttribute("data-val")||!0,l=r.getAttribute("data-attr"),c="true"===r.getAttribute("data-toggle"),u=a.select(r);if(c)l===i&&u.classed("active",!u.classed("active"));else{var f=null===l?l:s.nestedProperty(n,l).get();u.classed("active",f===o)}})},f.hasButtons=function(r){var n=this.buttons;if(!n||r.length!==n.length)return!1;for(var i=0;i<r.length;++i){if(r[i].length!==n[i].length)return!1;for(var a=0;a<r[i].length;a++)if(r[i][a].name!==n[i][a].name)return!1}return!0},f.getLogo=function(){var r=this.createGroup(),n=document.createElement("a");return n.href="https://plotly.com/",n.target="_blank",n.setAttribute("data-title",s._(this.graphInfo,"Produced with Plotly")),n.className="modebar-btn plotlyjsicon modebar-btn--logo",n.appendChild(this.createIcon(l.newplotlylogo)),r.appendChild(n),r},f.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},f.destroy=function(){s.removeElement(this.container.querySelector(".modebar")),s.deleteRelatedStyleRule(this._uid)},n.exports=function(r,n){var i=r._fullLayout,o=new u({graphInfo:r,container:i._modebardiv.node(),buttons:n});return i._privateplot&&a.select(o.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),o}},{"../../fonts/ploticon":482,"../../lib":503,"@plotly/d3":58,"fast-isnumeric":190}],432:[function(r,n,i){"use strict";var a=r("../../plots/font_attributes"),o=r("../color/attributes"),s=(0,r("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});n.exports={visible:{valType:"boolean",editType:"plot"},buttons:s,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:a({editType:"plot"}),bgcolor:{valType:"color",dflt:o.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:o.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":543,"../../plots/font_attributes":585,"../color/attributes":365}],433:[function(r,n,i){"use strict";n.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],434:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../color"),s=r("../../plot_api/plot_template"),l=r("../../plots/array_container_defaults"),c=r("./attributes"),u=r("./constants");function f(r,n,i,o){var s=o.calendar;function l(i,o){return a.coerce(r,n,c.buttons,i,o)}if(l("visible")){var u=l("step");"all"!==u&&(s&&"gregorian"!==s&&("month"===u||"year"===u)?n.stepmode="backward":l("stepmode"),l("count")),l("label")}}n.exports=function(r,n,i,h,p){var d=r.rangeselector||{},m=s.newContainer(n,"rangeselector");function g(r,n){return a.coerce(d,m,c,r,n)}if(g("visible",l(d,m,{name:"buttons",handleItemDefaults:f,calendar:p}).length>0)){var v=function(r,n,i){for(var a=i.filter(function(i){return n[i].anchor===r._id}),o=0,s=0;s<a.length;s++){var l=n[a[s]].domain;l&&(o=Math.max(l[1],o))}return[r.domain[0],o+u.yPad]}(n,i,h);g("x",v[0]),g("y",v[1]),a.noneOrAll(r,n,["x","y"]),g("xanchor"),g("yanchor"),a.coerceFont(g,"font",i.font);var y=g("bgcolor");g("activecolor",o.contrast(y,u.lightAmount,u.darkAmount)),g("bordercolor"),g("borderwidth")}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/array_container_defaults":549,"../color":366,"./attributes":432,"./constants":433}],435:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../registry"),s=r("../../plots/plots"),l=r("../color"),c=r("../drawing"),u=r("../../lib"),f=u.strTranslate,h=r("../../lib/svg_text_utils"),p=r("../../plots/cartesian/axis_ids"),d=r("../../constants/alignment"),m=d.LINE_SPACING,g=d.FROM_TL,v=d.FROM_BR,y=r("./constants"),x=r("./get_update_object");function b(r){return r._id}function _(r,n,i){var a=u.ensureSingle(r,"rect","selector-rect",function(r){r.attr("shape-rendering","crispEdges")});a.attr({rx:y.rx,ry:y.ry}),a.call(l.stroke,n.bordercolor).call(l.fill,i._isActive||i._isHovered?n.activecolor:n.bgcolor).style("stroke-width",n.borderwidth+"px")}function w(r,n,i,a){var o;u.ensureSingle(r,"text","selector-text",function(r){r.attr("text-anchor","middle")}).call(c.font,n.font).text((o=a._fullLayout._meta,i.label?o?u.templateString(i.label,o):i.label:"all"===i.step?"all":i.count+i.step.charAt(0))).call(function(r){h.convertToTspans(r,a)})}n.exports=function(r){var n=r._fullLayout._infolayer.selectAll(".rangeselector").data(function(r){for(var n=p.list(r,"x",!0),i=[],a=0;a<n.length;a++){var o=n[a];o.rangeselector&&o.rangeselector.visible&&i.push(o)}return i}(r),b);n.enter().append("g").classed("rangeselector",!0),n.exit().remove(),n.style({cursor:"pointer","pointer-events":"all"}),n.each(function(n){var i,l,p,d,b,T,k,A,M,S=a.select(this),E=n.rangeselector,L=S.selectAll("g.button").data(u.filterVisible(E.buttons));L.enter().append("g").classed("button",!0),L.exit().remove(),L.each(function(i){var s=a.select(this),l=x(n,i);i._isActive=function(r,n,i){if("all"===n.step)return!0===r.autorange;var a=Object.keys(i);return r.range[0]===i[a[0]]&&r.range[1]===i[a[1]]}(n,i,l),s.call(_,E,i),s.call(w,E,i,r),s.on("click",function(){r._dragged||o.call("_guiRelayout",r,l)}),s.on("mouseover",function(){i._isHovered=!0,s.call(_,E,i)}),s.on("mouseout",function(){i._isHovered=!1,s.call(_,E,i)})}),i=n._name,l=0,p=0,d=E.borderwidth,L.each(function(){var r=a.select(this).select(".selector-text"),n=Math.max(E.font.size*m*h.lineCount(r),16)+3;p=Math.max(p,n)}),L.each(function(){var r=a.select(this),n=r.select(".selector-rect"),i=r.select(".selector-text"),o=i.node()&&c.bBox(i.node()).width,s=E.font.size*m,u=h.lineCount(i),g=Math.max(o+10,y.minButtonWidth);r.attr("transform",f(d+l,d)),n.attr({x:0,y:0,width:g,height:p}),h.positionText(i,g/2,p/2-(u-1)*s/2+3),l+=g+5}),T=(b=r._fullLayout._size).l+b.w*E.x,k=b.t+b.h*(1-E.y),A="left",u.isRightAnchor(E)&&(T-=l,A="right"),u.isCenterAnchor(E)&&(T-=l/2,A="center"),M="top",u.isBottomAnchor(E)&&(k-=p,M="bottom"),u.isMiddleAnchor(E)&&(k-=p/2,M="middle"),l=Math.ceil(l),p=Math.ceil(p),T=Math.round(T),k=Math.round(k),s.autoMargin(r,i+"-range-selector",{x:E.x,y:E.y,l:l*g[A],r:l*v[A],b:p*v[M],t:p*g[M]}),S.attr("transform",f(T,k))})}},{"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axis_ids":558,"../../plots/plots":619,"../../registry":638,"../color":366,"../drawing":388,"./constants":433,"./get_update_object":436,"@plotly/d3":58}],436:[function(r,n,i){"use strict";var a=r("d3-time"),o=r("../../lib").titleCase;n.exports=function(r,n){var i=r._name,s={};if("all"===n.step)s[i+".autorange"]=!0;else{var l=function(r,n){var i,s=r.range,l=new Date(r.r2l(s[1])),c=a["utc"+o(n.step)],u=n.count;switch(n.stepmode){case"backward":i=r.l2r(+c.offset(l,-u));break;case"todate":var f=c.offset(l,-u);i=r.l2r(+c.ceil(f))}return[i,s[1]]}(r,n);s[i+".range[0]"]=l[0],s[i+".range[1]"]=l[1]}return s}},{"../../lib":503,"d3-time":122}],437:[function(r,n,i){"use strict";n.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:r("./attributes")}}},layoutAttributes:r("./attributes"),handleDefaults:r("./defaults"),draw:r("./draw")}},{"./attributes":432,"./defaults":434,"./draw":435}],438:[function(r,n,i){"use strict";var a=r("../color/attributes");n.exports={bgcolor:{valType:"color",dflt:a.background,editType:"plot"},bordercolor:{valType:"color",dflt:a.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":365}],439:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axis_ids").list,o=r("../../plots/cartesian/autorange").getAutoRange,s=r("./constants");n.exports=function(r){for(var n=a(r,"x",!0),i=0;i<n.length;i++){var l=n[i],c=l[s.name];c&&c.visible&&c.autorange&&(c._input.autorange=!0,c._input.range=c.range=o(r,l))}}},{"../../plots/cartesian/autorange":553,"../../plots/cartesian/axis_ids":558,"./constants":440}],440:[function(r,n,i){"use strict";n.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],441:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plot_api/plot_template"),s=r("../../plots/cartesian/axis_ids"),l=r("./attributes"),c=r("./oppaxis_attributes");n.exports=function(r,n,i){var u=r[i],f=n[i];if(u.rangeslider||n._requestRangeslider[f._id]){a.isPlainObject(u.rangeslider)||(u.rangeslider={});var h,p,d=u.rangeslider,m=o.newContainer(f,"rangeslider");if(T("visible")){T("bgcolor",n.plot_bgcolor),T("bordercolor"),T("borderwidth"),T("thickness"),T("autorange",!f.isValidRange(d.range)),T("range");var g=n._subplots;if(g)for(var v=g.cartesian.filter(function(r){return r.substr(0,r.indexOf("y"))===s.name2id(i)}).map(function(r){return r.substr(r.indexOf("y"),r.length)}),y=a.simpleMap(v,s.id2name),x=0;x<y.length;x++){var b=y[x];h=d[b]||{},p=o.newContainer(m,b,"yaxis");var _,w=n[b];h.range&&w.isValidRange(h.range)&&(_="fixed"),"match"!==k("rangemode",_)&&k("range",w.range.slice())}m._input=d}}function T(r,n){return a.coerce(d,m,l,r,n)}function k(r,n){return a.coerce(h,p,c,r,n)}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_ids":558,"./attributes":438,"./oppaxis_attributes":445}],442:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../registry"),s=r("../../plots/plots"),l=r("../../lib"),c=l.strTranslate,u=r("../drawing"),f=r("../color"),h=r("../titles"),p=r("../../plots/cartesian"),d=r("../../plots/cartesian/axis_ids"),m=r("../dragelement"),g=r("../../lib/setcursor"),v=r("./constants");function y(r,n,i,a){var o=l.ensureSingle(r,"rect",v.bgClassName,function(r){r.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),s=a.borderwidth%2==0?a.borderwidth:a.borderwidth-1,f=-a._offsetShift,h=u.crispRound(n,a.borderwidth);o.attr({width:a._width+s,height:a._height+s,transform:c(f,f),fill:a.bgcolor,stroke:a.bordercolor,"stroke-width":h})}function x(r,n,i,a){var o=n._fullLayout;l.ensureSingleById(o._topdefs,"clipPath",a._clipId,function(r){r.append("rect").attr({x:0,y:0})}).select("rect").attr({width:a._width,height:a._height})}function b(r,n,i,o){var c,f=n.calcdata,h=r.selectAll("g."+v.rangePlotClassName).data(i._subplotsWith,l.identity);h.enter().append("g").attr("class",function(r){return v.rangePlotClassName+" "+r}).call(u.setClipUrl,o._clipId,n),h.order(),h.exit().remove(),h.each(function(r,l){var u=a.select(this),h=d.getFromId(n,r,"y"),m=h._name,g=o[m],v={data:[],layout:{xaxis:{type:i.type,domain:[0,1],range:o.range.slice(),calendar:i.calendar},width:o._width,height:o._height,margin:{t:0,b:0,l:0,r:0}},_context:n._context};i.rangebreaks&&(v.layout.xaxis.rangebreaks=i.rangebreaks),v.layout[m]={type:h.type,domain:[0,1],range:"match"!==g.rangemode?g.range.slice():h.range.slice(),calendar:h.calendar},h.rangebreaks&&(v.layout[m].rangebreaks=h.rangebreaks),s.supplyDefaults(v);var y=v._fullLayout.xaxis,x=v._fullLayout[m];y.clearCalc(),y.setScale(),x.clearCalc(),x.setScale();var b={id:r,plotgroup:u,xaxis:y,yaxis:x,isRangePlot:!0};0===l?c=b:(b.mainplot="xy",b.mainplotinfo=c),p.rangePlot(n,b,function(r,n){for(var i=[],a=0;a<r.length;a++){var o=r[a],s=o[0].trace;s.xaxis+s.yaxis===n&&i.push(o)}return i}(f,r))})}function _(r,n,i,a,o){l.ensureSingle(r,"rect",v.maskMinClassName,function(r){r.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",a._height).call(f.fill,v.maskColor),l.ensureSingle(r,"rect",v.maskMaxClassName,function(r){r.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",a._height).call(f.fill,v.maskColor),"match"!==o.rangemode&&(l.ensureSingle(r,"rect",v.maskMinOppAxisClassName,function(r){r.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",a._width).call(f.fill,v.maskOppAxisColor),l.ensureSingle(r,"rect",v.maskMaxOppAxisClassName,function(r){r.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",a._width).style("border-top",v.maskOppBorder).call(f.fill,v.maskOppAxisColor))}function w(r,n,i,a){n._context.staticPlot||l.ensureSingle(r,"rect",v.slideBoxClassName,function(r){r.attr({y:0,cursor:v.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:a._height,fill:v.slideBoxFill})}function T(r,n,i,a){var o=l.ensureSingle(r,"g",v.grabberMinClassName),s=l.ensureSingle(r,"g",v.grabberMaxClassName),c={x:0,width:v.handleWidth,rx:v.handleRadius,fill:f.background,stroke:f.defaultLine,"stroke-width":v.handleStrokeWidth,"shape-rendering":"crispEdges"},u={y:Math.round(a._height/4),height:Math.round(a._height/2)};l.ensureSingle(o,"rect",v.handleMinClassName,function(r){r.attr(c)}).attr(u),l.ensureSingle(s,"rect",v.handleMaxClassName,function(r){r.attr(c)}).attr(u);var h={width:v.grabAreaWidth,x:0,y:0,fill:v.grabAreaFill,cursor:n._context.staticPlot?void 0:v.grabAreaCursor};l.ensureSingle(o,"rect",v.grabAreaMinClassName,function(r){r.attr(h)}).attr("height",a._height),l.ensureSingle(s,"rect",v.grabAreaMaxClassName,function(r){r.attr(h)}).attr("height",a._height)}n.exports=function(r){for(var n=r._fullLayout,i=n._rangeSliderData,s=0;s<i.length;s++){var u=i[s][v.name];u._clipId=u._id+"-"+n._uid}var f=n._infolayer.selectAll("g."+v.containerClassName).data(i,function(r){return r._name});f.exit().each(function(r){var i=r[v.name];n._topdefs.select("#"+i._clipId).remove()}).remove(),0!==i.length&&(f.enter().append("g").classed(v.containerClassName,!0).attr("pointer-events","all"),f.each(function(i){var s=a.select(this),u=i[v.name],f=n[d.id2name(i.anchor)],p=u[d.id2name(i.anchor)];if(u.range){var k,A=l.simpleMap(u.range,i.r2l),M=l.simpleMap(i.range,i.r2l);k=M[0]<M[1]?[Math.min(A[0],M[0]),Math.max(A[1],M[1])]:[Math.max(A[0],M[0]),Math.min(A[1],M[1])],u.range=u._input.range=l.simpleMap(k,i.l2r)}i.cleanRange("rangeslider.range");var S=n._size,E=i.domain;u._width=S.w*(E[1]-E[0]);var L=Math.round(S.l+S.w*E[0]),C=Math.round(S.t+S.h*(1-i._counterDomainMin)+("bottom"===i.side?i._depth:0)+u._offsetShift+v.extraPad);s.attr("transform",c(L,C)),u._rl=l.simpleMap(u.range,i.r2l);var P=u._rl[0],I=u._rl[1],O=I-P;if(u.p2d=function(r){return r/u._width*O+P},u.d2p=function(r){return(r-P)/O*u._width},i.rangebreaks){var z=i.locateBreaks(P,I);if(z.length){var D,R,F=0;for(D=0;D<z.length;D++)F+=(R=z[D]).max-R.min;var B=u._width/(I-P-F),N=[-B*P];for(D=0;D<z.length;D++)R=z[D],N.push(N[N.length-1]-B*(R.max-R.min));for(u.d2p=function(r){for(var n=N[0],i=0;i<z.length;i++){var a=z[i];if(r>=a.max)n=N[i+1];else if(r<a.min)break}return n+B*r},D=0;D<z.length;D++)(R=z[D]).pmin=u.d2p(R.min),R.pmax=u.d2p(R.max);u.p2d=function(r){for(var n=N[0],i=0;i<z.length;i++){var a=z[i];if(r>=a.pmax)n=N[i+1];else if(r<a.pmin)break}return(r-n)/B}}}if("match"!==p.rangemode){var j=f.r2l(p.range[0]),U=f.r2l(p.range[1])-j;u.d2pOppAxis=function(r){return(r-j)/U*u._height}}s.call(y,r,i,u).call(x,r,i,u).call(b,r,i,u).call(_,r,i,u,p).call(w,r,i,u).call(T,r,i,u),function(r,n,i,s){if(!n._context.staticPlot){var c=r.select("rect."+v.slideBoxClassName).node(),u=r.select("rect."+v.grabAreaMinClassName).node(),f=r.select("rect."+v.grabAreaMaxClassName).node();r.on("mousedown",h),r.on("touchstart",h)}function h(){var h=a.event,p=h.target,d=h.clientX||h.touches[0].clientX,v=d-r.node().getBoundingClientRect().left,y=s.d2p(i._rl[0]),x=s.d2p(i._rl[1]),b=m.coverSlip();function _(r){var h,m,_,w=+(r.clientX||r.touches[0].clientX)-d;switch(p){case c:_="ew-resize",h=y+w,m=x+w;break;case u:_="col-resize",h=y+w,m=x;break;case f:_="col-resize",h=y,m=x+w;break;default:_="ew-resize",h=v,m=v+w}if(m<h){var T=m;m=h,h=T}s._pixelMin=h,s._pixelMax=m,g(a.select(b),_),function(r,n,i,a){function s(r){return i.l2r(l.constrain(r,a._rl[0],a._rl[1]))}var c=s(a.p2d(a._pixelMin)),u=s(a.p2d(a._pixelMax));window.requestAnimationFrame(function(){o.call("_guiRelayout",n,i._name+".range",[c,u])})}(0,n,i,s)}function w(){b.removeEventListener("mousemove",_),b.removeEventListener("mouseup",w),this.removeEventListener("touchmove",_),this.removeEventListener("touchend",w),l.removeElement(b)}this.addEventListener("touchmove",_),this.addEventListener("touchend",w),b.addEventListener("mousemove",_),b.addEventListener("mouseup",w)}}(s,r,i,u),function(r,n,i,a,o,s){var u=v.handleWidth/2;function f(r){return l.constrain(r,0,a._width)}function h(r){return l.constrain(r,0,a._height)}function p(r){return l.constrain(r,-u,a._width+u)}var d=f(a.d2p(i._rl[0])),m=f(a.d2p(i._rl[1]));if(r.select("rect."+v.slideBoxClassName).attr("x",d).attr("width",m-d),r.select("rect."+v.maskMinClassName).attr("width",d),r.select("rect."+v.maskMaxClassName).attr("x",m).attr("width",a._width-m),"match"!==s.rangemode){var g=a._height-h(a.d2pOppAxis(o._rl[1])),y=a._height-h(a.d2pOppAxis(o._rl[0]));r.select("rect."+v.maskMinOppAxisClassName).attr("x",d).attr("height",g).attr("width",m-d),r.select("rect."+v.maskMaxOppAxisClassName).attr("x",d).attr("y",y).attr("height",a._height-y).attr("width",m-d),r.select("rect."+v.slideBoxClassName).attr("y",g).attr("height",y-g)}var x=Math.round(p(d-u))-.5,b=Math.round(p(m-u))+.5;r.select("g."+v.grabberMinClassName).attr("transform",c(x,.5)),r.select("g."+v.grabberMaxClassName).attr("transform",c(b,.5))}(s,0,i,u,f,p),"bottom"===i.side&&h.draw(r,i._id+"title",{propContainer:i,propName:i._name+".title",placeholder:n._dfltTitle.x,attributes:{x:i._offset+i._length/2,y:C+u._height+u._offsetShift+10+1.5*i.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":503,"../../lib/setcursor":524,"../../plots/cartesian":568,"../../plots/cartesian/axis_ids":558,"../../plots/plots":619,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"../titles":464,"./constants":440,"@plotly/d3":58}],443:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axis_ids"),o=r("../../lib/svg_text_utils"),s=r("./constants"),l=r("../../constants/alignment").LINE_SPACING,c=s.name;function u(r){var n=r&&r[c];return n&&n.visible}i.isVisible=u,i.makeData=function(r){var n=a.list({_fullLayout:r},"x",!0),i=r.margin,o=[];if(!r._has("gl2d"))for(var s=0;s<n.length;s++){var l=n[s];if(u(l)){o.push(l);var f=l[c];f._id=c+l._id,f._height=(r.height-i.b-i.t)*f.thickness,f._offsetShift=Math.floor(f.borderwidth/2)}}r._rangeSliderData=o},i.autoMarginOpts=function(r,n){var i=r._fullLayout,a=n[c],u=n._id.charAt(0),f=0,h=0;return"bottom"===n.side&&(f=n._depth,n.title.text!==i._dfltTitle[u]&&(h=1.5*n.title.font.size+10+a._offsetShift+(n.title.text.match(o.BR_TAG_ALL)||[]).length*n.title.font.size*l)),{x:0,y:n._counterDomainMin,l:0,r:0,t:0,b:a._height+f+Math.max(i.margin.b,h),pad:s.extraPad+2*a._offsetShift}}},{"../../constants/alignment":471,"../../lib/svg_text_utils":529,"../../plots/cartesian/axis_ids":558,"./constants":440}],444:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("./oppaxis_attributes"),l=r("./helpers");n.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:a.extendFlat({},o,{yaxis:s})}}},layoutAttributes:r("./attributes"),handleDefaults:r("./defaults"),calcAutorange:r("./calc_autorange"),draw:r("./draw"),isVisible:l.isVisible,makeData:l.makeData,autoMarginOpts:l.autoMarginOpts}},{"../../lib":503,"./attributes":438,"./calc_autorange":439,"./defaults":441,"./draw":442,"./helpers":443,"./oppaxis_attributes":445}],445:[function(r,n,i){"use strict";n.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],446:[function(r,n,i){"use strict";var a=r("../annotations/attributes"),o=r("../../traces/scatter/attributes").line,s=r("../drawing/attributes").dash,l=r("../../lib/extend").extendFlat,c=r("../../plot_api/plot_template").templatedArray;r("../../constants/axis_placeable_objects"),n.exports=c("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:l({},a.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:l({},a.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:l({},o.color,{editType:"arraydraw"}),width:l({},o.width,{editType:"calc+arraydraw"}),dash:l({},s,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":472,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../traces/scatter/attributes":926,"../annotations/attributes":349,"../drawing/attributes":387}],447:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("./constants"),l=r("./helpers");function c(r,n,i,o,c,u){var f=r/2;if("pixel"===n){var h=c?l.extractPathCoords(c,u?s.paramIsY:s.paramIsX):[i,o],p=a.aggNums(Math.max,null,h),d=a.aggNums(Math.min,null,h),m=d<0?Math.abs(d)+f:f,g=p>0?p+f:f;return{ppad:f,ppadplus:u?m:g,ppadminus:u?g:m}}return{ppad:f}}function u(r,n,i,a,o){var c="category"===r.type||"multicategory"===r.type?r.r2c:r.d2c;if(void 0!==n)return[c(n),c(i)];if(a){var u,f,h,p,d=1/0,m=-1/0,g=a.match(s.segmentRE);for("date"===r.type&&(c=l.decodeDate(c)),u=0;u<g.length;u++)void 0===(f=o[g[u].charAt(0)].drawn)||(h=g[u].substr(1).match(s.paramRE))&&!(h.length<f)&&((p=c(h[f]))<d&&(d=p),p>m&&(m=p));return m>=d?[d,m]:void 0}}n.exports=function(r){var n=r._fullLayout,i=a.filterVisible(n.shapes);if(i.length&&r._fullData.length)for(var l=0;l<i.length;l++){var f,h,p=i[l];p._extremes={};var d=o.getRefType(p.xref),m=o.getRefType(p.yref);if("paper"!==p.xref&&"domain"!==d){var g="pixel"===p.xsizemode?p.xanchor:p.x0,v="pixel"===p.xsizemode?p.xanchor:p.x1;(h=u(f=o.getFromId(r,p.xref),g,v,p.path,s.paramIsX))&&(p._extremes[f._id]=o.findExtremes(f,h,c(p.line.width,p.xsizemode,p.x0,p.x1,p.path,!1)))}if("paper"!==p.yref&&"domain"!==m){var y="pixel"===p.ysizemode?p.yanchor:p.y0,x="pixel"===p.ysizemode?p.yanchor:p.y1;(h=u(f=o.getFromId(r,p.yref),y,x,p.path,s.paramIsY))&&(p._extremes[f._id]=o.findExtremes(f,h,c(p.line.width,p.ysizemode,p.y0,p.y1,p.path,!0)))}}}},{"../../lib":503,"../../plots/cartesian/axes":554,"./constants":448,"./helpers":457}],448:[function(r,n,i){"use strict";n.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],449:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("../../plots/array_container_defaults"),l=r("./attributes"),c=r("./helpers");function u(r,n,i){function s(i,o){return a.coerce(r,n,l,i,o)}if(s("visible")){var u=s("path"),f=s("type",u?"path":"rect");"path"!==n.type&&delete n.path,s("editable"),s("layer"),s("opacity"),s("fillcolor"),s("fillrule"),s("line.width")&&(s("line.color"),s("line.dash"));for(var h=s("xsizemode"),p=s("ysizemode"),d=["x","y"],m=0;m<2;m++){var g,v,y,x=d[m],b=x+"anchor",_="x"===x?h:p,w={_fullLayout:i},T=o.coerceRef(r,n,w,x,void 0,"paper");if("range"===o.getRefType(T)?((g=o.getFromId(w,T))._shapeIndices.push(n._index),y=c.rangeToShapePosition(g),v=c.shapePositionToRange(g)):v=y=a.identity,"path"!==f){var k=x+"0",A=x+"1",M=r[k],S=r[A];r[k]=v(r[k],!0),r[A]=v(r[A],!0),"pixel"===_?(s(k,0),s(A,10)):(o.coercePosition(n,w,s,T,k,.25),o.coercePosition(n,w,s,T,A,.75)),n[k]=y(n[k]),n[A]=y(n[A]),r[k]=M,r[A]=S}if("pixel"===_){var E=r[b];r[b]=v(r[b],!0),o.coercePosition(n,w,s,T,b,.25),n[b]=y(n[b]),r[b]=E}}"path"===f?s("path"):a.noneOrAll(r,n,["x0","x1","y0","y1"])}}n.exports=function(r,n){s(r,n,{name:"shapes",handleItemDefaults:u})}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"./attributes":446,"./helpers":457}],450:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("../../plots/cartesian/axes"),l=r("./draw_newshape/helpers").readPaths,c=r("./draw_newshape/display_outlines"),u=r("../../plots/cartesian/handle_outline").clearOutlineControllers,f=r("../color"),h=r("../drawing"),p=r("../../plot_api/plot_template").arrayEditor,d=r("../dragelement"),m=r("../../lib/setcursor"),g=r("./constants"),v=r("./helpers");function y(r){var n=r._fullLayout;for(var i in n._shapeUpperLayer.selectAll("path").remove(),n._shapeLowerLayer.selectAll("path").remove(),n._plots){var a=n._plots[i].shapelayer;a&&a.selectAll("path").remove()}for(var o=0;o<n.shapes.length;o++)n.shapes[o].visible&&_(r,o)}function x(r){return!!r._fullLayout._drawing}function b(r){return!r._context.edits.shapePosition}function _(r,n){r._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+n+'"]').remove();var i=v.makeOptionsAndPlotinfo(r,n),u=i.options,_=i.plotinfo;u._input&&!1!==u.visible&&function(i){var M=T(r,u),S={"data-index":n,"fill-rule":u.fillrule,d:M},E=u.opacity,L=u.fillcolor,C=u.line.width?u.line.color:"rgba(0,0,0,0)",P=u.line.width,I=u.line.dash;P||!0!==u.editable||(P=5,I="solid");var O="Z"!==M[M.length-1],z=b(r)&&u.editable&&r._fullLayout._activeShapeIndex===n;z&&(L=O?"rgba(0,0,0,0)":r._fullLayout.activeshape.fillcolor,E=r._fullLayout.activeshape.opacity);var D,R=i.append("path").attr(S).style("opacity",E).call(f.stroke,C).call(f.fill,L).call(h.dashLine,I,P);if(w(R,r,u),(z||r._context.edits.shapePosition)&&(D=p(r.layout,"shapes",u)),z){R.style({cursor:"move"});var F={element:R.node(),plotinfo:_,gd:r,editHelpers:D,isActiveShape:!0};c(l(M,r),R,F)}else r._context.edits.shapePosition?function(r,n,i,l,c,u){var f,p,y,b,_,A,M,S,E,L,C,P,I,O,z,D,R,F,B,N,j="pixel"===i.xsizemode,U="pixel"===i.ysizemode,V="line"===i.type,H="path"===i.type,q=u.modifyItem,G=s.getFromId(r,i.xref),Y=s.getRefType(i.xref),W=s.getFromId(r,i.yref),X=s.getRefType(i.yref),Z=v.getDataToPixel(r,G,!1,Y),J=v.getDataToPixel(r,W,!0,X),K=v.getPixelToData(r,G,!1,Y),Q=v.getPixelToData(r,W,!0,X),$=V?(f=Math.max(i.line.width,10),(p=c.append("g").attr("data-index",l)).append("path").attr("d",n.attr("d")).style({cursor:"move","stroke-width":f,"stroke-opacity":"0"}),y={"fill-opacity":"0"},b=Math.max(f/2,10),p.append("circle").attr({"data-line-point":"start-point",cx:j?Z(i.xanchor)+i.x0:Z(i.x0),cy:U?J(i.yanchor)-i.y0:J(i.y0),r:b}).style(y).classed("cursor-grab",!0),p.append("circle").attr({"data-line-point":"end-point",cx:j?Z(i.xanchor)+i.x1:Z(i.x1),cy:U?J(i.yanchor)-i.y1:J(i.y1),r:b}).style(y).classed("cursor-grab",!0),p):n,tt={element:$.node(),gd:r,prepFn:function(a){if(!x(r)){var o,l,u,f,p;j&&(E=Z(i.xanchor)),U&&(L=J(i.yanchor)),"path"===i.type?B=i.path:(_=j?i.x0:Z(i.x0),A=U?i.y0:J(i.y0),M=j?i.x1:Z(i.x1),S=U?i.y1:J(i.y1)),_<M?(I=_,R="x0",O=M,F="x1"):(I=M,R="x1",O=_,F="x0"),!U&&A<S||U&&A>S?(C=A,z="y0",P=S,D="y1"):(C=S,z="y1",P=A,D="y0"),te(a),ti(c,i),o=i.xref,l=i.yref,u=s.getFromId(r,o),f=s.getFromId(r,l),p="","paper"===o||u.autorange||(p+=o),"paper"===l||f.autorange||(p+=l),h.setClipUrl(n,p?"clip"+r._fullLayout._uid+p:null,r),tt.moveFn="move"===N?tr:tn,tt.altKey=a.altKey}},doneFn:function(){x(r)||(m(n),ta(c),w(n,r,i),a.call("_guiRelayout",r,u.getUpdateObj()))},clickFn:function(){x(r)||ta(c)}};function te(i){if(x(r))N=null;else if(V)N="path"===i.target.tagName?"move":"start-point"===i.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var a=tt.element.getBoundingClientRect(),o=a.right-a.left,s=a.bottom-a.top,l=i.clientX-a.left,c=i.clientY-a.top,u=!H&&o>10&&s>10&&!i.shiftKey?d.getCursor(l/o,1-c/s):"move";m(n,u),N=u.split("-")[0]}}function tr(a,o){if("path"===i.type){var s=function(r){return r},l=s,u=s;j?q("xanchor",i.xanchor=K(E+a)):(l=function(r){return K(Z(r)+a)},G&&"date"===G.type&&(l=v.encodeDate(l))),U?q("yanchor",i.yanchor=Q(L+o)):(u=function(r){return Q(J(r)+o)},W&&"date"===W.type&&(u=v.encodeDate(u))),q("path",i.path=k(B,l,u))}else j?q("xanchor",i.xanchor=K(E+a)):(q("x0",i.x0=K(_+a)),q("x1",i.x1=K(M+a))),U?q("yanchor",i.yanchor=Q(L+o)):(q("y0",i.y0=Q(A+o)),q("y1",i.y1=Q(S+o)));n.attr("d",T(r,i)),ti(c,i)}function tn(a,o){if(H){var s=function(r){return r},l=s,u=s;j?q("xanchor",i.xanchor=K(E+a)):(l=function(r){return K(Z(r)+a)},G&&"date"===G.type&&(l=v.encodeDate(l))),U?q("yanchor",i.yanchor=Q(L+o)):(u=function(r){return Q(J(r)+o)},W&&"date"===W.type&&(u=v.encodeDate(u))),q("path",i.path=k(B,l,u))}else if(V){if("resize-over-start-point"===N){var f=_+a,h=U?A-o:A+o;q("x0",i.x0=j?f:K(f)),q("y0",i.y0=U?h:Q(h))}else if("resize-over-end-point"===N){var p=M+a,d=U?S-o:S+o;q("x1",i.x1=j?p:K(p)),q("y1",i.y1=U?d:Q(d))}}else{var m=function(r){return -1!==N.indexOf(r)},g=m("n"),y=m("s"),x=m("w"),b=m("e"),w=g?C+o:C,Y=y?P+o:P,X=x?I+a:I,$=b?O+a:O;U&&(g&&(w=C-o),y&&(Y=P-o)),(!U&&Y-w>10||U&&w-Y>10)&&(q(z,i[z]=U?w:Q(w)),q(D,i[D]=U?Y:Q(Y))),$-X>10&&(q(R,i[R]=j?X:K(X)),q(F,i[F]=j?$:K($)))}n.attr("d",T(r,i)),ti(c,i)}function ti(r,n){(j||U)&&function(){var i="path"!==n.type,a=r.selectAll(".visual-cue").data([0]);a.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var s=Z(j?n.xanchor:o.midRange(i?[n.x0,n.x1]:v.extractPathCoords(n.path,g.paramIsX))),l=J(U?n.yanchor:o.midRange(i?[n.y0,n.y1]:v.extractPathCoords(n.path,g.paramIsY)));if(s=v.roundPositionForSharpStrokeRendering(s,1),l=v.roundPositionForSharpStrokeRendering(l,1),j&&U){var c="M"+(s-1-1)+","+(l-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";a.attr("d",c)}else if(j){var u="M"+(s-1-1)+","+(l-9-1)+"v18 h2 v-18 Z";a.attr("d",u)}else{var f="M"+(s-9-1)+","+(l-1-1)+"h18 v2 h-18 Z";a.attr("d",f)}}()}function ta(r){r.selectAll(".visual-cue").remove()}d.init(tt),$.node().onmousemove=te}(r,R,u,n,i,D):!0===u.editable&&R.style("pointer-events",O||f.opacity(L)*E<=.5?"stroke":"all");R.node().addEventListener("click",function(){return function(r,n){if(b(r)){var i=+n.node().getAttribute("data-index");if(i>=0){if(i===r._fullLayout._activeShapeIndex)return void A(r);r._fullLayout._activeShapeIndex=i,r._fullLayout._deactivateShape=A,y(r)}}}(r,R)})}("below"!==u.layer?r._fullLayout._shapeUpperLayer:"paper"===u.xref||"paper"===u.yref?r._fullLayout._shapeLowerLayer:_._hadPlotinfo?(_.mainplotinfo||_).shapelayer:r._fullLayout._shapeLowerLayer)}function w(r,n,i){var a=(i.xref+i.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");h.setClipUrl(r,a?"clip"+n._fullLayout._uid+a:null,n)}function T(r,n){var i,a,l,c,u,f,h,p,d,m,y,x,b,_,w,T=n.type,k=s.getRefType(n.xref),A=s.getRefType(n.yref),M=s.getFromId(r,n.xref),S=s.getFromId(r,n.yref),E=r._fullLayout._size;if(M?"domain"===k?d=function(r){return M._offset+M._length*r}:(p=v.shapePositionToRange(M),d=function(r){return M._offset+M.r2p(p(r,!0))}):d=function(r){return E.l+E.w*r},S?"domain"===A?y=function(r){return S._offset+S._length*(1-r)}:(m=v.shapePositionToRange(S),y=function(r){return S._offset+S.r2p(m(r,!0))}):y=function(r){return E.t+E.h*(1-r)},"path"===T)return M&&"date"===M.type&&(d=v.decodeDate(d)),S&&"date"===S.type&&(y=v.decodeDate(y)),i=d,a=y,l=n.path,c=n.xsizemode,u=n.ysizemode,f=n.xanchor,h=n.yanchor,l.replace(g.segmentRE,function(r){var n=0,s=r.charAt(0),l=g.paramIsX[s],p=g.paramIsY[s],d=g.numParams[s],m=r.substr(1).replace(g.paramRE,function(r){return l[n]?r="pixel"===c?i(f)+Number(r):i(r):p[n]&&(r="pixel"===u?a(h)-Number(r):a(r)),++n>d&&(r="X"),r});return n>d&&(m=m.replace(/[\s,]*X.*/,""),o.log("Ignoring extra params in segment "+r)),s+m});if("pixel"===n.xsizemode){var L=d(n.xanchor);x=L+n.x0,b=L+n.x1}else x=d(n.x0),b=d(n.x1);if("pixel"===n.ysizemode){var C=y(n.yanchor);_=C-n.y0,w=C-n.y1}else _=y(n.y0),w=y(n.y1);if("line"===T)return"M"+x+","+_+"L"+b+","+w;if("rect"===T)return"M"+x+","+_+"H"+b+"V"+w+"H"+x+"Z";var P=(x+b)/2,I=(_+w)/2,O=Math.abs(P-x),z=Math.abs(I-_),D="A"+O+","+z,R=P+O+","+I;return"M"+R+D+" 0 1,1 "+P+","+(I-z)+D+" 0 0,1 "+R+"Z"}function k(r,n,i){return r.replace(g.segmentRE,function(r){var a=0,o=r.charAt(0),s=g.paramIsX[o],l=g.paramIsY[o],c=g.numParams[o];return o+r.substr(1).replace(g.paramRE,function(r){return a>=c||(s[a]?r=n(r):l[a]&&(r=i(r)),a++),r})})}function A(r){b(r)&&r._fullLayout._activeShapeIndex>=0&&(u(r),delete r._fullLayout._activeShapeIndex,y(r))}n.exports={draw:y,drawOne:_,eraseActiveShape:function(r){if(b(r)){u(r);var n=r._fullLayout._activeShapeIndex,i=(r.layout||{}).shapes||[];if(n<i.length){for(var o=[],s=0;s<i.length;s++)s!==n&&o.push(i[s]);delete r._fullLayout._activeShapeIndex,a.call("_guiRelayout",r,{shapes:o})}}}}},{"../../lib":503,"../../lib/setcursor":524,"../../plot_api/plot_template":543,"../../plots/cartesian/axes":554,"../../plots/cartesian/handle_outline":565,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"./constants":448,"./draw_newshape/display_outlines":454,"./draw_newshape/helpers":455,"./helpers":457}],451:[function(r,n,i){"use strict";var a=r("../../drawing/attributes").dash,o=r("../../../lib/extend").extendFlat;n.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:o({},a,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":493,"../../drawing/attributes":387}],452:[function(r,n,i){"use strict";n.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],453:[function(r,n,i){"use strict";var a=r("../../color");n.exports=function(r,n,i){if(i("newshape.drawdirection"),i("newshape.layer"),i("newshape.fillcolor"),i("newshape.fillrule"),i("newshape.opacity"),i("newshape.line.width")){var o=(r||{}).plot_bgcolor||"#FFF";i("newshape.line.color",a.contrast(o)),i("newshape.line.dash")}i("activeshape.fillcolor"),i("activeshape.opacity")}},{"../../color":366}],454:[function(r,n,i){"use strict";var a=r("../../dragelement"),o=r("../../dragelement/helpers").drawMode,s=r("../../../registry"),l=r("./constants"),c=l.i000,u=l.i090,f=l.i180,h=l.i270,p=r("../../../plots/cartesian/handle_outline").clearOutlineControllers,d=r("./helpers"),m=d.pointsShapeRectangle,g=d.pointsShapeEllipse,v=d.writePaths,y=r("./newshapes");n.exports=function r(n,i,l,d){d||(d=0);var x=l.gd;function b(){r(n,i,l,d++),g(n[0])&&_({redrawing:!0})}function _(r){l.isActiveShape=!1;var n=y(i,l);Object.keys(n).length&&s.call((r||{}).redrawing?"relayout":"_guiRelayout",x,n)}var w,T,k,A,M,S=l.isActiveShape,E=x._fullLayout._zoomlayer;function L(r){k=+r.srcElement.getAttribute("data-i"),A=+r.srcElement.getAttribute("data-j"),w[k][A].moveFn=C}function C(r,i){if(n.length){var a=M[k][A][1],o=M[k][A][2],s=n[k],l=s.length;if(m(s)){for(var c=0;c<l;c++)if(c!==A){var u=s[c];u[1]===s[A][1]&&(u[1]=a+r),u[2]===s[A][2]&&(u[2]=o+i)}if(s[A][1]=a+r,s[A][2]=o+i,!m(s))for(var f=0;f<l;f++)for(var h=0;h<s[f].length;h++)s[f][h]=M[k][f][h]}else s[A][1]=a+r,s[A][2]=o+i;b()}}function P(){_()}function I(r,i){if(2===r){k=+i.srcElement.getAttribute("data-i"),A=+i.srcElement.getAttribute("data-j");var a=n[k];m(a)||g(a)||function(){if(n.length&&n[k]&&n[k].length){for(var r=[],i=0;i<n[k].length;i++)i!==A&&r.push(n[k][i]);r.length>1&&(2!==r.length||"Z"!==r[1][0])&&(0===A&&(r[0][0]="M"),n[k]=r,b(),_())}}()}}function O(r,i){(function(r,i){if(n.length)for(var a=0;a<n.length;a++)for(var o=0;o<n[a].length;o++)for(var s=0;s+2<n[a][o].length;s+=2)n[a][o][s+1]=M[a][o][s+1]+r,n[a][o][s+2]=M[a][o][s+2]+i})(r,i),b()}o(l.dragmode)?x._fullLayout._drawing=!0:x._fullLayout._activeShapeIndex>=0&&p(x),i.attr("d",v(n)),!S||d||(M=function(r,n){for(var i=0;i<n.length;i++){var a=n[i];r[i]=[];for(var o=0;o<a.length;o++){r[i][o]=[];for(var s=0;s<a[o].length;s++)r[i][o][s]=a[o][s]}}return r}([],n),function(r){w=[];for(var i=0;i<n.length;i++){var o=n[i],s=!m(o)&&g(o);w[i]=[];for(var l=0;l<o.length;l++)if("Z"!==o[l][0]&&(!s||l===c||l===u||l===f||l===h)){var p=o[l][1],d=o[l][2],v=r.append("circle").classed("cursor-grab",!0).attr("data-i",i).attr("data-j",l).attr("cx",p).attr("cy",d).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});w[i][l]={element:v.node(),gd:x,prepFn:L,doneFn:P,clickFn:I},a.init(w[i][l])}}}(E.append("g").attr("class","outline-controllers")),T=[],n.length&&(T[0]={element:i[0][0],gd:x,prepFn:function(r){(k=+r.srcElement.getAttribute("data-i"))||(k=0),T[k].moveFn=O},doneFn:function(){_()}},a.init(T[0])))}},{"../../../plots/cartesian/handle_outline":565,"../../../registry":638,"../../dragelement":385,"../../dragelement/helpers":384,"./constants":452,"./helpers":455,"./newshapes":456}],455:[function(r,n,i){"use strict";var a=r("parse-svg-path"),o=r("./constants"),s=o.CIRCLE_SIDES,l=o.SQRT2,c=r("../../../plots/cartesian/helpers"),u=c.p2r,f=c.r2p,h=[0,3,4,5,6,1,2],p=[0,3,4,1,2];function d(r,n){return 1e-6>=Math.abs(r-n)}function m(r,n){var i=n[1]-r[1],a=n[2]-r[2];return Math.sqrt(i*i+a*a)}i.writePaths=function(r){var n=r.length;if(!n)return"M0,0Z";for(var i="",a=0;a<n;a++)for(var o=r[a].length,s=0;s<o;s++){var l=r[a][s][0];if("Z"===l)i+="Z";else for(var c=r[a][s].length,u=0;u<c;u++){var f=u;"Q"===l||"S"===l?f=p[u]:"C"===l&&(f=h[u]),i+=r[a][s][f],u>0&&u<c-1&&(i+=",")}}return i},i.readPaths=function(r,n,i,o){var l,c,h,p=a(r),d=[],m=-1,g=0,v=0,y=function(){c=g,h=v};y();for(var x=0;x<p.length;x++){var b,_,w,T,k=[],A=p[x][0],M=A;switch(A){case"M":d[++m]=[],g=+p[x][1],v=+p[x][2],k.push([M,g,v]),y();break;case"Q":case"S":b=+p[x][1],w=+p[x][2],g=+p[x][3],v=+p[x][4],k.push([M,g,v,b,w]);break;case"C":b=+p[x][1],w=+p[x][2],_=+p[x][3],T=+p[x][4],g=+p[x][5],v=+p[x][6],k.push([M,g,v,b,w,_,T]);break;case"T":case"L":g=+p[x][1],v=+p[x][2],k.push([M,g,v]);break;case"H":M="L",g=+p[x][1],k.push([M,g,v]);break;case"V":M="L",v=+p[x][1],k.push([M,g,v]);break;case"A":M="L";var S=+p[x][1],E=+p[x][2];+p[x][4]||(S=-S,E=-E);var L=g-S,C=v;for(l=1;l<=s/2;l++){var P=2*Math.PI*l/s;k.push([M,L+S*Math.cos(P),C+E*Math.sin(P)])}break;case"Z":g===c&&v===h||(g=c,v=h,k.push([M,g,v]))}for(var I=(i||{}).domain,O=n._fullLayout._size,z=i&&"pixel"===i.xsizemode,D=i&&"pixel"===i.ysizemode,R=!1===o,F=0;F<k.length;F++){for(l=0;l+2<7;l+=2){var B=k[F][l+1],N=k[F][l+2];void 0!==B&&void 0!==N&&(g=B,v=N,i&&(i.xaxis&&i.xaxis.p2r?(R&&(B-=i.xaxis._offset),B=z?f(i.xaxis,i.xanchor)+B:u(i.xaxis,B)):(R&&(B-=O.l),I?B=I.x[0]+B/O.w:B/=O.w),i.yaxis&&i.yaxis.p2r?(R&&(N-=i.yaxis._offset),N=D?f(i.yaxis,i.yanchor)-N:u(i.yaxis,N)):(R&&(N-=O.t),N=I?I.y[1]-N/O.h:1-N/O.h)),k[F][l+1]=B,k[F][l+2]=N)}d[m].push(k[F].slice())}}return d},i.pointsShapeRectangle=function(r){if(5!==r.length)return!1;for(var n=1;n<3;n++)if(!d(r[0][n]-r[1][n],r[3][n]-r[2][n])||!d(r[0][n]-r[3][n],r[1][n]-r[2][n]))return!1;return!(!d(r[0][1],r[1][1])&&!d(r[0][1],r[3][1]))&&!!(m(r[0],r[1])*m(r[0],r[3]))},i.pointsShapeEllipse=function(r){var n=r.length;if(n!==s+1)return!1;n=s;for(var i=0;i<n;i++){var a=(2*n-i)%n,o=(n/2+a)%n,l=(n/2+i)%n;if(!d(m(r[i],r[l]),m(r[a],r[o])))return!1}return!0},i.handleEllipse=function(r,n,a){if(!r)return[n,a];var o=i.ellipseOver({x0:n[0],y0:n[1],x1:a[0],y1:a[1]}),c=(o.x1+o.x0)/2,u=(o.y1+o.y0)/2,f=(o.x1-o.x0)/2,h=(o.y1-o.y0)/2;f||(f=h/=l),h||(h=f/=l);for(var p=[],d=0;d<s;d++){var m=2*d*Math.PI/s;p.push([c+f*Math.cos(m),u+h*Math.sin(m)])}return p},i.ellipseOver=function(r){var n=r.x0,i=r.y0,a=r.x1,o=r.y1,s=a-n,c=o-i,u=((n-=s)+a)/2,f=((i-=c)+o)/2;return{x0:u-(s*=l),y0:f-(c*=l),x1:u+s,y1:f+c}}},{"../../../plots/cartesian/helpers":566,"./constants":452,"parse-svg-path":250}],456:[function(r,n,i){"use strict";var a=r("../../dragelement/helpers"),o=a.drawMode,s=a.openMode,l=r("./constants"),c=l.i000,u=l.i090,f=l.i180,h=l.i270,p=l.cos45,d=l.sin45,m=r("../../../plots/cartesian/helpers"),g=m.p2r,v=m.r2p,y=r("../../../plots/cartesian/handle_outline").clearSelect,x=r("./helpers"),b=x.readPaths,_=x.writePaths,w=x.ellipseOver;n.exports=function(r,n){if(r.length){var i=r[0][0];if(i){var a=i.getAttribute("d"),l=n.gd,m=l._fullLayout.newshape,x=n.plotinfo,T=x.xaxis,k=x.yaxis,A=!!x.domain||!x.xaxis,M=!!x.domain||!x.yaxis,S=n.isActiveShape,E=n.dragmode,L=(l.layout||{}).shapes||[];if(!o(E)&&void 0!==S){var C=l._fullLayout._activeShapeIndex;if(C<L.length)switch(l._fullLayout.shapes[C].type){case"rect":E="drawrect";break;case"circle":E="drawcircle";break;case"line":E="drawline";break;case"path":var P=L[C].path||"";E="Z"===P[P.length-1]?"drawclosedpath":"drawopenpath"}}var I,O=s(E),z=b(a,l,x,S),D={editable:!0,xref:A?"paper":T._id,yref:M?"paper":k._id,layer:m.layer,opacity:m.opacity,line:{color:m.line.color,width:m.line.width,dash:m.line.dash}};if(O||(D.fillcolor=m.fillcolor,D.fillrule=m.fillrule),1===z.length&&(I=z[0]),I&&"drawrect"===E)D.type="rect",D.x0=I[0][1],D.y0=I[0][2],D.x1=I[2][1],D.y1=I[2][2];else if(I&&"drawline"===E)D.type="line",D.x0=I[0][1],D.y0=I[0][2],D.x1=I[1][1],D.y1=I[1][2];else if(I&&"drawcircle"===E){D.type="circle";var R=I[c][1],F=I[u][1],B=I[f][1],N=I[h][1],j=I[c][2],U=I[u][2],V=I[f][2],H=I[h][2],q=x.xaxis&&("date"===x.xaxis.type||"log"===x.xaxis.type),G=x.yaxis&&("date"===x.yaxis.type||"log"===x.yaxis.type);q&&(R=v(x.xaxis,R),F=v(x.xaxis,F),B=v(x.xaxis,B),N=v(x.xaxis,N)),G&&(j=v(x.yaxis,j),U=v(x.yaxis,U),V=v(x.yaxis,V),H=v(x.yaxis,H));var Y=(F+N)/2,W=(j+V)/2,X=w({x0:Y,y0:W,x1:Y+(N-F+B-R)/2*p,y1:W+(H-U+V-j)/2*d});q&&(X.x0=g(x.xaxis,X.x0),X.x1=g(x.xaxis,X.x1)),G&&(X.y0=g(x.yaxis,X.y0),X.y1=g(x.yaxis,X.y1)),D.x0=X.x0,D.y0=X.y0,D.x1=X.x1,D.y1=X.y1}else D.type="path",T&&k&&function(r,n,i){var a="date"===n.type,o="date"===i.type;if(a||o)for(var s=0;s<r.length;s++)for(var l=0;l<r[s].length;l++)for(var c=0;c+2<r[s][l].length;c+=2)a&&(r[s][l][c+1]=r[s][l][c+1].replace(" ","_")),o&&(r[s][l][c+2]=r[s][l][c+2].replace(" ","_"))}(z,T,k),D.path=_(z),I=null;y(l);for(var Z=n.editHelpers,J=(Z||{}).modifyItem,K=[],Q=0;Q<L.length;Q++){var $=l._fullLayout.shapes[Q];if(K[Q]=$._input,void 0!==S&&Q===l._fullLayout._activeShapeIndex)switch($.type){case"line":case"rect":case"circle":J("x0",D.x0),J("x1",D.x1),J("y0",D.y0),J("y1",D.y1);break;case"path":J("path",D.path)}}return void 0===S?(K.push(D),K):Z?Z.getUpdateObj():{}}}}},{"../../../plots/cartesian/handle_outline":565,"../../../plots/cartesian/helpers":566,"../../dragelement/helpers":384,"./constants":452,"./helpers":455}],457:[function(r,n,i){"use strict";var a=r("./constants"),o=r("../../lib");i.rangeToShapePosition=function(r){return"log"===r.type?r.r2d:function(r){return r}},i.shapePositionToRange=function(r){return"log"===r.type?r.d2r:function(r){return r}},i.decodeDate=function(r){return function(n){return n.replace&&(n=n.replace("_"," ")),r(n)}},i.encodeDate=function(r){return function(n){return r(n).replace(" ","_")}},i.extractPathCoords=function(r,n){var i=[];return r.match(a.segmentRE).forEach(function(r){var s=n[r.charAt(0)].drawn;if(void 0!==s){var l=r.substr(1).match(a.paramRE);!l||l.length<s||i.push(o.cleanNumber(l[s]))}}),i},i.getDataToPixel=function(r,n,a,o){var s,l=r._fullLayout._size;if(n){if("domain"===o)s=function(r){return n._length*(a?1-r:r)+n._offset};else{var c=i.shapePositionToRange(n);s=function(r){return n._offset+n.r2p(c(r,!0))},"date"===n.type&&(s=i.decodeDate(s))}}else s=a?function(r){return l.t+l.h*(1-r)}:function(r){return l.l+l.w*r};return s},i.getPixelToData=function(r,n,a,o){var s,l=r._fullLayout._size;if(n){if("domain"===o)s=function(r){var i=(r-n._offset)/n._length;return a?1-i:i};else{var c=i.rangeToShapePosition(n);s=function(r){return c(n.p2r(r-n._offset))}}}else s=a?function(r){return 1-(r-l.t)/l.h}:function(r){return(r-l.l)/l.w};return s},i.roundPositionForSharpStrokeRendering=function(r,n){var i=Math.round(r);return 1===Math.round(n%2)?i+.5:i},i.makeOptionsAndPlotinfo=function(r,n){var i=r._fullLayout.shapes[n]||{},a=r._fullLayout._plots[i.xref+i.yref];return a?a._hadPlotinfo=!0:(a={},i.xref&&"paper"!==i.xref&&(a.xaxis=r._fullLayout[i.xref+"axis"]),i.yref&&"paper"!==i.yref&&(a.yaxis=r._fullLayout[i.yref+"axis"])),a.xsizemode=i.xsizemode,a.ysizemode=i.ysizemode,a.xanchor=i.xanchor,a.yanchor=i.yanchor,{options:i,plotinfo:a}}},{"../../lib":503,"./constants":448}],458:[function(r,n,i){"use strict";var a=r("./draw");n.exports={moduleType:"component",name:"shapes",layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),supplyDrawNewShapeDefaults:r("./draw_newshape/defaults"),includeBasePlot:r("../../plots/cartesian/include_components")("shapes"),calcAutorange:r("./calc_autorange"),draw:a.draw,drawOne:a.drawOne}},{"../../plots/cartesian/include_components":567,"./attributes":446,"./calc_autorange":447,"./defaults":449,"./draw":450,"./draw_newshape/defaults":453}],459:[function(r,n,i){"use strict";var a=r("../../plots/font_attributes"),o=r("../../plots/pad_attributes"),s=r("../../lib/extend").extendDeepAll,l=r("../../plot_api/edit_types").overrideAll,c=r("../../plots/animation_attributes"),u=r("../../plot_api/plot_template").templatedArray,f=r("./constants"),h=u("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});n.exports=l(u("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:h,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:s(o({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:c.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:a({})},font:a({}),activebgcolor:{valType:"color",dflt:f.gripBgActiveColor},bgcolor:{valType:"color",dflt:f.railBgColor},bordercolor:{valType:"color",dflt:f.railBorderColor},borderwidth:{valType:"number",min:0,dflt:f.railBorderWidth},ticklen:{valType:"number",min:0,dflt:f.tickLength},tickcolor:{valType:"color",dflt:f.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:f.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/animation_attributes":548,"../../plots/font_attributes":585,"../../plots/pad_attributes":618,"./constants":460}],460:[function(r,n,i){"use strict";n.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],461:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/array_container_defaults"),s=r("./attributes"),l=r("./constants").name,c=s.steps;function u(r,n,i){function l(i,o){return a.coerce(r,n,s,i,o)}for(var c=o(r,n,{name:"steps",handleItemDefaults:f}),u=0,h=0;h<c.length;h++)c[h].visible&&u++;if(u<2?n.visible=!1:l("visible")){n._stepCount=u;var p=n._visibleSteps=a.filterVisible(c);(c[l("active")]||{}).visible||(n.active=p[0]._index),l("x"),l("y"),a.noneOrAll(r,n,["x","y"]),l("xanchor"),l("yanchor"),l("len"),l("lenmode"),l("pad.t"),l("pad.r"),l("pad.b"),l("pad.l"),a.coerceFont(l,"font",i.font),l("currentvalue.visible")&&(l("currentvalue.xanchor"),l("currentvalue.prefix"),l("currentvalue.suffix"),l("currentvalue.offset"),a.coerceFont(l,"currentvalue.font",n.font)),l("transition.duration"),l("transition.easing"),l("bgcolor"),l("activebgcolor"),l("bordercolor"),l("borderwidth"),l("ticklen"),l("tickwidth"),l("tickcolor"),l("minorticklen")}}function f(r,n){function i(i,o){return a.coerce(r,n,c,i,o)}if("skip"===r.method||Array.isArray(r.args)?i("visible"):n.visible=!1){i("method"),i("args");var o=i("label","step-"+n._index);i("value",o),i("execute")}}n.exports=function(r,n){o(r,n,{name:l,handleItemDefaults:u})}},{"../../lib":503,"../../plots/array_container_defaults":549,"./attributes":459,"./constants":460}],462:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../plots/plots"),s=r("../color"),l=r("../drawing"),c=r("../../lib"),u=c.strTranslate,f=r("../../lib/svg_text_utils"),h=r("../../plot_api/plot_template").arrayEditor,p=r("./constants"),d=r("../../constants/alignment"),m=d.LINE_SPACING,g=d.FROM_TL,v=d.FROM_BR;function y(r){return p.autoMarginIdRoot+r._index}function x(r){return r._index}function b(r,n,i){if(n.currentvalue.visible){var a,o,s=n._dims;switch(n.currentvalue.xanchor){case"right":a=s.inputAreaLength-p.currentValueInset-s.currentValueMaxWidth,o="left";break;case"center":a=.5*s.inputAreaLength,o="middle";break;default:a=p.currentValueInset,o="left"}var u=c.ensureSingle(r,"text",p.labelClass,function(r){r.attr({"text-anchor":o,"data-notex":1})}),h=n.currentvalue.prefix?n.currentvalue.prefix:"";if("string"==typeof i)h+=i;else{var d=n.steps[n.active].label,g=n._gd._fullLayout._meta;g&&(d=c.templateString(d,g)),h+=d}n.currentvalue.suffix&&(h+=n.currentvalue.suffix),u.call(l.font,n.currentvalue.font).text(h).call(f.convertToTspans,n._gd);var v=f.lineCount(u),y=(s.currentValueMaxLines+1-v)*n.currentvalue.font.size*m;return f.positionText(u,a,y),u}}function _(r,n,i){c.ensureSingle(r,"rect",p.gripRectClass,function(a){a.call(M,n,r,i).style("pointer-events","all")}).attr({width:p.gripWidth,height:p.gripHeight,rx:p.gripRadius,ry:p.gripRadius}).call(s.stroke,i.bordercolor).call(s.fill,i.bgcolor).style("stroke-width",i.borderwidth+"px")}function w(r,n,i){var a=c.ensureSingle(r,"text",p.labelClass,function(r){r.attr({"text-anchor":"middle","data-notex":1})}),o=n.step.label,s=i._gd._fullLayout._meta;return s&&(o=c.templateString(o,s)),a.call(l.font,i.font).text(o).call(f.convertToTspans,i._gd),a}function T(r,n){var i=c.ensureSingle(r,"g",p.labelsClass),o=n._dims,s=i.selectAll("g."+p.labelGroupClass).data(o.labelSteps);s.enter().append("g").classed(p.labelGroupClass,!0),s.exit().remove(),s.each(function(r){var i=a.select(this);i.call(w,r,n),l.setTranslate(i,L(n,r.fraction),p.tickOffset+n.ticklen+n.font.size*m+p.labelOffset+o.currentValueTotalHeight)})}function k(r,n,i,a,o){var s=Math.round(a*(i._stepCount-1)),l=i._visibleSteps[s]._index;l!==i.active&&A(r,n,i,l,!0,o)}function A(r,n,i,a,s,l){var c=i.active;i.active=a,h(r.layout,p.name,i).applyUpdate("active",a);var u=i.steps[i.active];n.call(E,i,l),n.call(b,i),r.emit("plotly_sliderchange",{slider:i,step:i.steps[i.active],interaction:s,previousActive:c}),u&&u.method&&s&&(n._nextMethod?(n._nextMethod.step=u,n._nextMethod.doCallback=s,n._nextMethod.doTransition=l):(n._nextMethod={step:u,doCallback:s,doTransition:l},n._nextMethodRaf=window.requestAnimationFrame(function(){var i=n._nextMethod.step;i.method&&(i.execute&&o.executeAPICommand(r,i.method,i.args),n._nextMethod=null,n._nextMethodRaf=null)})))}function M(r,n,i){var o=i.node(),l=a.select(n);function c(){return i.data()[0]}function u(){var r=c();n.emit("plotly_sliderstart",{slider:r});var u=i.select("."+p.gripRectClass);a.event.stopPropagation(),a.event.preventDefault(),u.call(s.fill,r.activebgcolor);var f=C(r,a.mouse(o)[0]);function h(){var r=c(),s=C(r,a.mouse(o)[0]);k(n,i,r,s,!1)}function d(){var r=c();r._dragging=!1,u.call(s.fill,r.bgcolor),l.on("mouseup",null),l.on("mousemove",null),l.on("touchend",null),l.on("touchmove",null),n.emit("plotly_sliderend",{slider:r,step:r.steps[r.active]})}k(n,i,r,f,!0),r._dragging=!0,l.on("mousemove",h),l.on("touchmove",h),l.on("mouseup",d),l.on("touchend",d)}r.on("mousedown",u),r.on("touchstart",u)}function S(r,n){var i=r.selectAll("rect."+p.tickRectClass).data(n._visibleSteps),o=n._dims;i.enter().append("rect").classed(p.tickRectClass,!0),i.exit().remove(),i.attr({width:n.tickwidth+"px","shape-rendering":"crispEdges"}),i.each(function(r,i){var c=i%o.labelStride==0,u=a.select(this);u.attr({height:c?n.ticklen:n.minorticklen}).call(s.fill,n.tickcolor),l.setTranslate(u,L(n,i/(n._stepCount-1))-.5*n.tickwidth,(c?p.tickOffset:p.minorTickOffset)+o.currentValueTotalHeight)})}function E(r,n,i){for(var a=r.select("rect."+p.gripRectClass),o=0,s=0;s<n._stepCount;s++)if(n._visibleSteps[s]._index===n.active){o=s;break}var l=L(n,o/(n._stepCount-1));if(!n._invokingCommand){var c=a;i&&n.transition.duration>0&&(c=c.transition().duration(n.transition.duration).ease(n.transition.easing)),c.attr("transform",u(l-.5*p.gripWidth,n._dims.currentValueTotalHeight))}}function L(r,n){var i=r._dims;return i.inputAreaStart+p.stepInset+(i.inputAreaLength-2*p.stepInset)*Math.min(1,Math.max(0,n))}function C(r,n){var i=r._dims;return Math.min(1,Math.max(0,(n-p.stepInset-i.inputAreaStart)/(i.inputAreaLength-2*p.stepInset-2*i.inputAreaStart)))}function P(r,n,i){var a=i._dims,o=c.ensureSingle(r,"rect",p.railTouchRectClass,function(a){a.call(M,n,r,i).style("pointer-events","all")});o.attr({width:a.inputAreaLength,height:Math.max(a.inputAreaWidth,p.tickOffset+i.ticklen+a.labelHeight)}).call(s.fill,i.bgcolor).attr("opacity",0),l.setTranslate(o,0,a.currentValueTotalHeight)}function I(r,n){var i=n._dims,a=i.inputAreaLength-2*p.railInset,o=c.ensureSingle(r,"rect",p.railRectClass);o.attr({width:a,height:p.railWidth,rx:p.railRadius,ry:p.railRadius,"shape-rendering":"crispEdges"}).call(s.stroke,n.bordercolor).call(s.fill,n.bgcolor).style("stroke-width",n.borderwidth+"px"),l.setTranslate(o,p.railInset,.5*(i.inputAreaWidth-p.railWidth)+i.currentValueTotalHeight)}n.exports=function(r){var n=r._fullLayout,i=function(r,n){for(var i=r[p.name],a=[],o=0;o<i.length;o++){var s=i[o];s.visible&&(s._gd=n,a.push(s))}return a}(n,r),s=n._infolayer.selectAll("g."+p.containerClassName).data(i.length>0?[0]:[]);function u(n){n._commandObserver&&(n._commandObserver.remove(),delete n._commandObserver),o.autoMargin(r,y(n))}if(s.enter().append("g").classed(p.containerClassName,!0).style("cursor","ew-resize"),s.exit().each(function(){a.select(this).selectAll("g."+p.groupClassName).each(u)}).remove(),0!==i.length){var h=s.selectAll("g."+p.groupClassName).data(i,x);h.enter().append("g").classed(p.groupClassName,!0),h.exit().each(u).remove();for(var d=0;d<i.length;d++)!function(r,n){var i=l.tester.selectAll("g."+p.labelGroupClass).data(n._visibleSteps);i.enter().append("g").classed(p.labelGroupClass,!0);var s=0,u=0;i.each(function(r){var i=w(a.select(this),{step:r},n).node();if(i){var o=l.bBox(i);u=Math.max(u,o.height),s=Math.max(s,o.width)}}),i.remove();var h=n._dims={};h.inputAreaWidth=Math.max(p.railWidth,p.gripHeight);var d=r._fullLayout._size;h.lx=d.l+d.w*n.x,h.ly=d.t+d.h*(1-n.y),"fraction"===n.lenmode?h.outerLength=Math.round(d.w*n.len):h.outerLength=n.len,h.inputAreaStart=0,h.inputAreaLength=Math.round(h.outerLength-n.pad.l-n.pad.r);var m=(h.inputAreaLength-2*p.stepInset)/(n._stepCount-1),x=s+p.labelPadding;if(h.labelStride=Math.max(1,Math.ceil(x/m)),h.labelHeight=u,h.currentValueMaxWidth=0,h.currentValueHeight=0,h.currentValueTotalHeight=0,h.currentValueMaxLines=1,n.currentvalue.visible){var _=l.tester.append("g");i.each(function(r){var i=b(_,n,r.label),a=i.node()&&l.bBox(i.node())||{width:0,height:0},o=f.lineCount(i);h.currentValueMaxWidth=Math.max(h.currentValueMaxWidth,Math.ceil(a.width)),h.currentValueHeight=Math.max(h.currentValueHeight,Math.ceil(a.height)),h.currentValueMaxLines=Math.max(h.currentValueMaxLines,o)}),h.currentValueTotalHeight=h.currentValueHeight+n.currentvalue.offset,_.remove()}h.height=h.currentValueTotalHeight+p.tickOffset+n.ticklen+p.labelOffset+h.labelHeight+n.pad.t+n.pad.b;var T="left";c.isRightAnchor(n)&&(h.lx-=h.outerLength,T="right"),c.isCenterAnchor(n)&&(h.lx-=h.outerLength/2,T="center");var k="top";c.isBottomAnchor(n)&&(h.ly-=h.height,k="bottom"),c.isMiddleAnchor(n)&&(h.ly-=h.height/2,k="middle"),h.outerLength=Math.ceil(h.outerLength),h.height=Math.ceil(h.height),h.lx=Math.round(h.lx),h.ly=Math.round(h.ly);var A={y:n.y,b:h.height*v[k],t:h.height*g[k]};"fraction"===n.lenmode?(A.l=0,A.xl=n.x-n.len*g[T],A.r=0,A.xr=n.x+n.len*v[T]):(A.x=n.x,A.l=h.outerLength*g[T],A.r=h.outerLength*v[T]),o.autoMargin(r,y(n),A)}(r,i[d]);h.each(function(n){var i,s,c=a.select(this);(function(r){var n=r._dims;n.labelSteps=[];for(var i=r._stepCount,a=0;a<i;a+=n.labelStride)n.labelSteps.push({fraction:a/(i-1),step:r._visibleSteps[a]})})(n),o.manageCommandObserver(r,n,n._visibleSteps,function(n){var i=c.data()[0];i.active!==n.index&&(i._dragging||A(r,c,i,n.index,!1,!0))}),i=a.select(this),(n.steps[n.active]||{}).visible||(n.active=n._visibleSteps[0]._index),i.call(b,n).call(I,n).call(T,n).call(S,n).call(P,r,n).call(_,r,n),s=n._dims,l.setTranslate(i,s.lx+n.pad.l,s.ly+n.pad.t),i.call(E,n,!1),i.call(b,n)})}}},{"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plot_api/plot_template":543,"../../plots/plots":619,"../color":366,"../drawing":388,"./constants":460,"@plotly/d3":58}],463:[function(r,n,i){"use strict";var a=r("./constants");n.exports={moduleType:"component",name:a.name,layoutAttributes:r("./attributes"),supplyLayoutDefaults:r("./defaults"),draw:r("./draw")}},{"./attributes":459,"./constants":460,"./defaults":461,"./draw":462}],464:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=r("../../plots/plots"),l=r("../../registry"),c=r("../../lib"),u=c.strTranslate,f=r("../drawing"),h=r("../color"),p=r("../../lib/svg_text_utils"),d=r("../../constants/interactions"),m=r("../../constants/alignment").OPPOSITE_SIDE,g=/ [XY][0-9]* /;n.exports={draw:function(r,n,i){var v,y=i.propContainer,x=i.propName,b=i.placeholder,_=i.traceIndex,w=i.avoid||{},T=i.attributes,k=i.transform,A=i.containerGroup,M=r._fullLayout,S=1,E=!1,L=y.title,C=(L&&L.text?L.text:"").trim(),P=L&&L.font?L.font:{},I=P.family,O=P.size,z=P.color;"title.text"===x?v="titleText":-1!==x.indexOf("axis")?v="axisTitleText":x.indexOf(!0)&&(v="colorbarTitleText");var D=r._context.edits[v];""===C?S=0:C.replace(g," % ")===b.replace(g," % ")&&(S=.2,E=!0,D||(C="")),i._meta?C=c.templateString(C,i._meta):M._meta&&(C=c.templateString(C,M._meta));var R,F=C||D;A||(A=c.ensureSingle(M._infolayer,"g","g-"+n),R=M._hColorbarMoveTitle);var B=A.selectAll("text").data(F?[0]:[]);if(B.enter().append("text"),B.text(C).attr("class",n),B.exit().remove(),!F)return A;function N(r){c.syncOrAsync([j,U],r)}function j(n){var i;return!k&&R&&(k={}),k?(i="",k.rotate&&(i+="rotate("+[k.rotate,T.x,T.y]+")"),(k.offset||R)&&(i+=u(0,(k.offset||0)-(R||0)))):i=null,n.attr("transform",i),n.style({"font-family":I,"font-size":a.round(O,2)+"px",fill:h.rgb(z),opacity:S*h.opacity(z),"font-weight":s.fontWeight}).attr(T).call(p.convertToTspans,r),s.previousPromises(r)}function U(r){var n=a.select(r.node().parentNode);if(w&&w.selection&&w.side&&C){n.attr("transform",null);var i=m[w.side],s="left"===w.side||"top"===w.side?-1:1,l=o(w.pad)?w.pad:2,h=f.bBox(n.node()),p={left:0,top:0,right:M.width,bottom:M.height},d=w.maxShift||s*(p[w.side]-h[w.side]),g=0;if(d<0)g=d;else{var v=w.offsetLeft||0,y=w.offsetTop||0;h.left-=v,h.right-=v,h.top-=y,h.bottom-=y,w.selection.each(function(){var r=f.bBox(this);c.bBoxIntersect(h,r,l)&&(g=Math.max(g,s*(r[w.side]-h[i])+l))}),g=Math.min(d,g)}if(g>0||d<0){var x={left:[-g,0],right:[g,0],top:[0,-g],bottom:[0,g]}[w.side];n.attr("transform",u(x[0],x[1]))}}}return B.call(N),D&&(C?B.on(".opacity",null):(S=0,E=!0,B.text(b).on("mouseover.opacity",function(){a.select(this).transition().duration(d.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){a.select(this).transition().duration(d.HIDE_PLACEHOLDER).style("opacity",0)})),B.call(p.makeEditable,{gd:r}).on("edit",function(n){void 0!==_?l.call("_guiRestyle",r,x,n,_):l.call("_guiRelayout",r,x,n)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(N)}).on("input",function(r){this.text(r||" ").call(p.positionText,T.x,T.y)})),B.classed("js-placeholder",E),A}}},{"../../constants/alignment":471,"../../constants/interactions":478,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../../registry":638,"../color":366,"../drawing":388,"@plotly/d3":58,"fast-isnumeric":190}],465:[function(r,n,i){"use strict";var a=r("../../plots/font_attributes"),o=r("../color/attributes"),s=r("../../lib/extend").extendFlat,l=r("../../plot_api/edit_types").overrideAll,c=r("../../plots/pad_attributes"),u=r("../../plot_api/plot_template").templatedArray,f=u("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});n.exports=l(u("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:f,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:s(c({editType:"arraydraw"}),{}),font:a({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:o.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/font_attributes":585,"../../plots/pad_attributes":618,"../color/attributes":365}],466:[function(r,n,i){"use strict";n.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"",right:"",up:"",down:""}}},{}],467:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/array_container_defaults"),s=r("./attributes"),l=r("./constants").name,c=s.buttons;function u(r,n,i){function l(i,o){return a.coerce(r,n,s,i,o)}l("visible",o(r,n,{name:"buttons",handleItemDefaults:f}).length>0)&&(l("active"),l("direction"),l("type"),l("showactive"),l("x"),l("y"),a.noneOrAll(r,n,["x","y"]),l("xanchor"),l("yanchor"),l("pad.t"),l("pad.r"),l("pad.b"),l("pad.l"),a.coerceFont(l,"font",i.font),l("bgcolor",i.paper_bgcolor),l("bordercolor"),l("borderwidth"))}function f(r,n){function i(i,o){return a.coerce(r,n,c,i,o)}i("visible","skip"===r.method||Array.isArray(r.args))&&(i("method"),i("args"),i("args2"),i("label"),i("execute"))}n.exports=function(r,n){o(r,n,{name:l,handleItemDefaults:u})}},{"../../lib":503,"../../plots/array_container_defaults":549,"./attributes":465,"./constants":466}],468:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../plots/plots"),s=r("../color"),l=r("../drawing"),c=r("../../lib"),u=r("../../lib/svg_text_utils"),f=r("../../plot_api/plot_template").arrayEditor,h=r("../../constants/alignment").LINE_SPACING,p=r("./constants"),d=r("./scrollbox");function m(r){return r._index}function g(r,n){return+r.attr(p.menuIndexAttrName)===n._index}function v(r,n,i,a,o,s,l,c){n.active=l,f(r.layout,p.name,n).applyUpdate("active",l),"buttons"===n.type?x(r,a,null,null,n):"dropdown"===n.type&&(o.attr(p.menuIndexAttrName,"-1"),y(r,a,o,s,n),c||x(r,a,o,s,n))}function y(r,n,i,a,o){var s=c.ensureSingle(n,"g",p.headerClassName,function(r){r.style("pointer-events","all")}),u=o._dims,f=o.active,h=o.buttons[f]||p.blankHeaderOpts,d={y:o.pad.t,yPad:0,x:o.pad.l,xPad:0,index:0},m={width:u.headerWidth,height:u.headerHeight};s.call(b,o,h,r).call(S,o,d,m),c.ensureSingle(n,"text",p.headerArrowClassName,function(r){r.attr("text-anchor","end").call(l.font,o.font).text(p.arrowSymbol[o.direction])}).attr({x:u.headerWidth-p.arrowOffsetX+o.pad.l,y:u.headerHeight/2+p.textOffsetY+o.pad.t}),s.on("click",function(){i.call(E,String(g(i,o)?-1:o._index)),x(r,n,i,a,o)}),s.on("mouseover",function(){s.call(k)}),s.on("mouseout",function(){s.call(A,o)}),l.setTranslate(n,u.lx,u.ly)}function x(r,n,i,s,l){i||(i=n).attr("pointer-events","all");var u,f,h=-1==+i.attr(p.menuIndexAttrName)&&"buttons"!==l.type?[]:l.buttons,d="dropdown"===l.type?p.dropdownButtonClassName:p.buttonClassName,m=i.selectAll("g."+d).data(c.filterVisible(h)),g=m.enter().append("g").classed(d,!0),y=m.exit();"dropdown"===l.type?(g.attr("opacity","0").transition().attr("opacity","1"),y.transition().attr("opacity","0").remove()):y.remove();var x=0,_=0,w=l._dims,M=-1!==["up","down"].indexOf(l.direction);"dropdown"===l.type&&(M?_=w.headerHeight+p.gapButtonHeader:x=w.headerWidth+p.gapButtonHeader),"dropdown"===l.type&&"up"===l.direction&&(_=-p.gapButtonHeader+p.gapButton-w.openHeight),"dropdown"===l.type&&"left"===l.direction&&(x=-p.gapButtonHeader+p.gapButton-w.openWidth);var E={x:w.lx+x+l.pad.l,y:w.ly+_+l.pad.t,yPad:p.gapButton,xPad:p.gapButton,index:0},L={l:E.x+l.borderwidth,t:E.y+l.borderwidth};m.each(function(c,u){var f=a.select(this);f.call(b,l,c,r).call(S,l,E),f.on("click",function(){a.event.defaultPrevented||(c.execute&&(c.args2&&l.active===u?(v(r,l,0,n,i,s,-1),o.executeAPICommand(r,c.method,c.args2)):(v(r,l,0,n,i,s,u),o.executeAPICommand(r,c.method,c.args))),r.emit("plotly_buttonclicked",{menu:l,button:c,active:l.active}))}),f.on("mouseover",function(){f.call(k)}),f.on("mouseout",function(){f.call(A,l),m.call(T,l)})}),m.call(T,l),M?(L.w=Math.max(w.openWidth,w.headerWidth),L.h=E.y-L.t):(L.w=E.x-L.l,L.h=Math.max(w.openHeight,w.headerHeight)),L.direction=l.direction,s&&(m.size()?function(r,n,i,a,o,s){var l,c,u,f=o.direction,h=o._dims,d=o.active;if("up"===f||"down"===f)for(c=0,u=0;u<d;u++)c+=h.heights[u]+p.gapButton;else for(l=0,u=0;u<d;u++)l+=h.widths[u]+p.gapButton;a.enable(s,l,c),a.hbar&&a.hbar.attr("opacity","0").transition().attr("opacity","1"),a.vbar&&a.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,s,l,L):(u=!!s.hbar,f=!!s.vbar,u&&s.hbar.transition().attr("opacity","0").each("end",function(){u=!1,f||s.disable()}),f&&s.vbar.transition().attr("opacity","0").each("end",function(){f=!1,u||s.disable()})))}function b(r,n,i,a){r.call(_,n).call(w,n,i,a)}function _(r,n){c.ensureSingle(r,"rect",p.itemRectClassName,function(r){r.attr({rx:p.rx,ry:p.ry,"shape-rendering":"crispEdges"})}).call(s.stroke,n.bordercolor).call(s.fill,n.bgcolor).style("stroke-width",n.borderwidth+"px")}function w(r,n,i,a){var o=c.ensureSingle(r,"text",p.itemTextClassName,function(r){r.attr({"text-anchor":"start","data-notex":1})}),s=i.label,f=a._fullLayout._meta;f&&(s=c.templateString(s,f)),o.call(l.font,n.font).text(s).call(u.convertToTspans,a)}function T(r,n){var i=n.active;r.each(function(r,o){var l=a.select(this);o===i&&n.showactive&&l.select("rect."+p.itemRectClassName).call(s.fill,p.activeColor)})}function k(r){r.select("rect."+p.itemRectClassName).call(s.fill,p.hoverColor)}function A(r,n){r.select("rect."+p.itemRectClassName).call(s.fill,n.bgcolor)}function M(r){return p.autoMarginIdRoot+r._index}function S(r,n,i,a){a=a||{};var o=r.select("."+p.itemRectClassName),s=r.select("."+p.itemTextClassName),c=n.borderwidth,f=i.index,d=n._dims;l.setTranslate(r,c+i.x,c+i.y);var m=-1!==["up","down"].indexOf(n.direction),g=a.height||(m?d.heights[f]:d.height1);o.attr({x:0,y:0,width:a.width||(m?d.width1:d.widths[f]),height:g});var v=n.font.size*h,y=(u.lineCount(s)-1)*v/2;u.positionText(s,p.textOffsetX,g/2-y+p.textOffsetY),m?i.y+=d.heights[f]+i.yPad:i.x+=d.widths[f]+i.xPad,i.index++}function E(r,n){r.attr(p.menuIndexAttrName,n||"-1").selectAll("g."+p.dropdownButtonClassName).remove()}n.exports=function(r){var n=r._fullLayout,i=c.filterVisible(n[p.name]);function s(n){o.autoMargin(r,M(n))}var f=n._menulayer.selectAll("g."+p.containerClassName).data(i.length>0?[0]:[]);if(f.enter().append("g").classed(p.containerClassName,!0).style("cursor","pointer"),f.exit().each(function(){a.select(this).selectAll("g."+p.headerGroupClassName).each(s)}).remove(),0!==i.length){var _=f.selectAll("g."+p.headerGroupClassName).data(i,m);_.enter().append("g").classed(p.headerGroupClassName,!0);for(var w=c.ensureSingle(f,"g",p.dropdownButtonGroupClassName,function(r){r.style("pointer-events","all")}),T=0;T<i.length;T++)!function(r,n){var i=n._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},s=l.tester.selectAll("g."+p.dropdownButtonClassName).data(c.filterVisible(n.buttons));s.enter().append("g").classed(p.dropdownButtonClassName,!0);var f=-1!==["up","down"].indexOf(n.direction);s.each(function(o,s){var c=a.select(this);c.call(b,n,o,r);var d=c.select("."+p.itemTextClassName),m=Math.max((d.node()&&l.bBox(d.node()).width)+p.textPadX,p.minWidth),g=Math.max(n.font.size*h*u.lineCount(d),p.minHeight)+p.textOffsetY;g=Math.ceil(g),m=Math.ceil(m),i.widths[s]=m,i.heights[s]=g,i.height1=Math.max(i.height1,g),i.width1=Math.max(i.width1,m),f?(i.totalWidth=Math.max(i.totalWidth,m),i.openWidth=i.totalWidth,i.totalHeight+=g+p.gapButton,i.openHeight+=g+p.gapButton):(i.totalWidth+=m+p.gapButton,i.openWidth+=m+p.gapButton,i.totalHeight=Math.max(i.totalHeight,g),i.openHeight=i.totalHeight)}),f?i.totalHeight-=p.gapButton:i.totalWidth-=p.gapButton,i.headerWidth=i.width1+p.arrowPadX,i.headerHeight=i.height1,"dropdown"===n.type&&(f?(i.width1+=p.arrowPadX,i.totalHeight=i.height1):i.totalWidth=i.width1,i.totalWidth+=p.arrowPadX),s.remove();var d=i.totalWidth+n.pad.l+n.pad.r,m=i.totalHeight+n.pad.t+n.pad.b,g=r._fullLayout._size;i.lx=g.l+g.w*n.x,i.ly=g.t+g.h*(1-n.y);var v="left";c.isRightAnchor(n)&&(i.lx-=d,v="right"),c.isCenterAnchor(n)&&(i.lx-=d/2,v="center");var y="top";c.isBottomAnchor(n)&&(i.ly-=m,y="bottom"),c.isMiddleAnchor(n)&&(i.ly-=m/2,y="middle"),i.totalWidth=Math.ceil(i.totalWidth),i.totalHeight=Math.ceil(i.totalHeight),i.lx=Math.round(i.lx),i.ly=Math.round(i.ly),o.autoMargin(r,M(n),{x:n.x,y:n.y,l:d*(({right:1,center:.5})[v]||0),r:d*(({left:1,center:.5})[v]||0),b:m*(({top:1,middle:.5})[y]||0),t:m*(({bottom:1,middle:.5})[y]||0)})}(r,i[T]);var k=new d(r,w,"updatemenus"+n._uid);_.enter().size()&&(w.node().parentNode.appendChild(w.node()),w.call(E)),_.exit().each(function(r){w.call(E),s(r)}).remove(),_.each(function(n){var i=a.select(this),s="dropdown"===n.type?w:null;o.manageCommandObserver(r,n,n.buttons,function(a){v(r,n,n.buttons[a.index],i,s,k,a.index,!0)}),"dropdown"===n.type?(y(r,i,w,k,n),g(w,n)&&x(r,i,w,k,n)):x(r,i,null,null,n)})}}},{"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plot_api/plot_template":543,"../../plots/plots":619,"../color":366,"../drawing":388,"./constants":466,"./scrollbox":470,"@plotly/d3":58}],469:[function(r,n,i){arguments[4][463][0].apply(i,arguments)},{"./attributes":465,"./constants":466,"./defaults":467,"./draw":468,dup:463}],470:[function(r,n,i){"use strict";n.exports=c;var a=r("@plotly/d3"),o=r("../color"),s=r("../drawing"),l=r("../../lib");function c(r,n,i){this.gd=r,this.container=n,this.id=i,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}c.barWidth=2,c.barLength=20,c.barRadius=2,c.barPad=1,c.barColor="#808BA4",c.prototype.enable=function(r,n,i){var l=this.gd._fullLayout,u=l.width,f=l.height;this.position=r;var h,p,d,m,g=this.position.l,v=this.position.w,y=this.position.t,x=this.position.h,b=this.position.direction,_="down"===b,w="left"===b,T="up"===b,k=v,A=x;_||w||"right"===b||T||(this.position.direction="down",_=!0),_||T?(p=(h=g)+k,A=_?(m=Math.min((d=y)+A,f))-d:(m=y+A)-(d=Math.max(m-A,0))):(m=(d=y)+A,k=w?(p=g+k)-(h=Math.max(p-k,0)):(p=Math.min((h=g)+k,u))-h),this._box={l:h,t:d,w:k,h:A};var M=v>k,S=c.barLength+2*c.barPad,E=c.barWidth+2*c.barPad,L=y+x;L+E>f&&(L=f-E);var C=this.container.selectAll("rect.scrollbar-horizontal").data(M?[0]:[]);C.exit().on(".drag",null).remove(),C.enter().append("rect").classed("scrollbar-horizontal",!0).call(o.fill,c.barColor),M?(this.hbar=C.attr({rx:c.barRadius,ry:c.barRadius,x:g,y:L,width:S,height:E}),this._hbarXMin=g+S/2,this._hbarTranslateMax=k-S):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var P=x>A,I=c.barWidth+2*c.barPad,O=c.barLength+2*c.barPad,z=g+v;z+I>u&&(z=u-I);var D=this.container.selectAll("rect.scrollbar-vertical").data(P?[0]:[]);D.exit().on(".drag",null).remove(),D.enter().append("rect").classed("scrollbar-vertical",!0).call(o.fill,c.barColor),P?(this.vbar=D.attr({rx:c.barRadius,ry:c.barRadius,x:z,y:y,width:I,height:O}),this._vbarYMin=y+O/2,this._vbarTranslateMax=A-O):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var R=this.id,F=h-.5,B=P?p+I+.5:p+.5,N=d-.5,j=M?m+E+.5:m+.5,U=l._topdefs.selectAll("#"+R).data(M||P?[0]:[]);if(U.exit().remove(),U.enter().append("clipPath").attr("id",R).append("rect"),M||P?(this._clipRect=U.select("rect").attr({x:Math.floor(F),y:Math.floor(N),width:Math.ceil(B)-Math.floor(F),height:Math.ceil(j)-Math.floor(N)}),this.container.call(s.setClipUrl,R,this.gd),this.bg.attr({x:g,y:y,width:v,height:x})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(s.setClipUrl,null),delete this._clipRect),M||P){var V=a.behavior.drag().on("dragstart",function(){a.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(V);var H=a.behavior.drag().on("dragstart",function(){a.event.sourceEvent.preventDefault(),a.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));M&&this.hbar.on(".drag",null).call(H),P&&this.vbar.on(".drag",null).call(H)}this.setTranslate(n,i)},c.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(s.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},c.prototype._onBoxDrag=function(){var r=this.translateX,n=this.translateY;this.hbar&&(r-=a.event.dx),this.vbar&&(n-=a.event.dy),this.setTranslate(r,n)},c.prototype._onBoxWheel=function(){var r=this.translateX,n=this.translateY;this.hbar&&(r+=a.event.deltaY),this.vbar&&(n+=a.event.deltaY),this.setTranslate(r,n)},c.prototype._onBarDrag=function(){var r=this.translateX,n=this.translateY;if(this.hbar){var i=r+this._hbarXMin,o=i+this._hbarTranslateMax;r=(l.constrain(a.event.x,i,o)-i)/(o-i)*(this.position.w-this._box.w)}if(this.vbar){var s=n+this._vbarYMin,c=s+this._vbarTranslateMax;n=(l.constrain(a.event.y,s,c)-s)/(c-s)*(this.position.h-this._box.h)}this.setTranslate(r,n)},c.prototype.setTranslate=function(r,n){var i=this.position.w-this._box.w,a=this.position.h-this._box.h;if(r=l.constrain(r||0,0,i),n=l.constrain(n||0,0,a),this.translateX=r,this.translateY=n,this.container.call(s.setTranslate,this._box.l-this.position.l-r,this._box.t-this.position.t-n),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+r-.5),y:Math.floor(this.position.t+n-.5)}),this.hbar){var o=r/i;this.hbar.call(s.setTranslate,r+o*this._hbarTranslateMax,n)}if(this.vbar){var c=n/a;this.vbar.call(s.setTranslate,r,n+c*this._vbarTranslateMax)}}},{"../../lib":503,"../color":366,"../drawing":388,"@plotly/d3":58}],471:[function(r,n,i){"use strict";n.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],472:[function(r,n,i){"use strict";n.exports={axisRefDescription:function(r,n,i){return["If set to a",r,"axis id (e.g. *"+r+"* or","*"+r+"2*), the `"+r+"` position refers to a",r,"coordinate. If set to *paper*, the `"+r+"`","position refers to the distance from the",n,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",n,"("+i+"). If set to a",r,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",n,"of the domain of that axis: e.g.,","*"+r+"2 domain* refers to the domain of the second",r," axis and a",r,"position of 0.5 refers to the","point between the",n,"and the",i,"of the domain of the","second",r,"axis."].join(" ")}}},{}],473:[function(r,n,i){"use strict";n.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:""},DECREASING:{COLOR:"#FF4136",SYMBOL:""}}},{}],474:[function(r,n,i){"use strict";n.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],475:[function(r,n,i){"use strict";n.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],476:[function(r,n,i){"use strict";n.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],477:[function(r,n,i){"use strict";n.exports={circle:"","circle-open":"",square:"","square-open":"",diamond:"","diamond-open":"",cross:"+",x:""}},{}],478:[function(r,n,i){"use strict";n.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],479:[function(r,n,i){"use strict";n.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:""}},{}],480:[function(r,n,i){"use strict";i.xmlns="http://www.w3.org/2000/xmlns/",i.svg="http://www.w3.org/2000/svg",i.xlink="http://www.w3.org/1999/xlink",i.svgAttrs={xmlns:i.svg,"xmlns:xlink":i.xlink}},{}],481:[function(r,n,i){"use strict";i.version=r("./version").version,r("native-promise-only"),r("../build/plotcss");for(var a=r("./registry"),o=i.register=a.register,s=r("./plot_api"),l=Object.keys(s),c=0;c<l.length;c++){var u=l[c];"_"!==u.charAt(0)&&(i[u]=s[u]),o({moduleType:"apiMethod",name:u,fn:s[u]})}o(r("./traces/scatter")),o([r("./components/legend"),r("./components/fx"),r("./components/annotations"),r("./components/annotations3d"),r("./components/shapes"),r("./components/images"),r("./components/updatemenus"),r("./components/sliders"),r("./components/rangeslider"),r("./components/rangeselector"),r("./components/grid"),r("./components/errorbars"),r("./components/colorscale"),r("./components/colorbar"),r("./components/modebar")]),o([r("./locale-en"),r("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(o(window.PlotlyLocales),delete window.PlotlyLocales),i.Icons=r("./fonts/ploticon");var f=r("./components/fx"),h=r("./plots/plots");i.Plots={resize:h.resize,graphJson:h.graphJson,sendDataToCloud:h.sendDataToCloud},i.Fx={hover:f.hover,unhover:f.unhover,loneHover:f.loneHover,loneUnhover:f.loneUnhover},i.Snapshot=r("./snapshot"),i.PlotSchema=r("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":357,"./components/annotations3d":362,"./components/colorbar":372,"./components/colorscale":378,"./components/errorbars":394,"./components/fx":406,"./components/grid":410,"./components/images":415,"./components/legend":423,"./components/modebar":429,"./components/rangeselector":437,"./components/rangeslider":444,"./components/shapes":458,"./components/sliders":463,"./components/updatemenus":469,"./fonts/ploticon":482,"./locale-en":534,"./locale-en-us":533,"./plot_api":538,"./plot_api/plot_schema":542,"./plots/plots":619,"./registry":638,"./snapshot":643,"./traces/scatter":938,"./version":1119,"native-promise-only":245}],482:[function(r,n,i){"use strict";n.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],483:[function(r,n,i){"use strict";i.isLeftAnchor=function(r){return"left"===r.xanchor||"auto"===r.xanchor&&r.x<=1/3},i.isCenterAnchor=function(r){return"center"===r.xanchor||"auto"===r.xanchor&&r.x>1/3&&r.x<2/3},i.isRightAnchor=function(r){return"right"===r.xanchor||"auto"===r.xanchor&&r.x>=2/3},i.isTopAnchor=function(r){return"top"===r.yanchor||"auto"===r.yanchor&&r.y>=2/3},i.isMiddleAnchor=function(r){return"middle"===r.yanchor||"auto"===r.yanchor&&r.y>1/3&&r.y<2/3},i.isBottomAnchor=function(r){return"bottom"===r.yanchor||"auto"===r.yanchor&&r.y<=1/3}},{}],484:[function(r,n,i){"use strict";var a=r("./mod"),o=a.mod,s=a.modHalf,l=Math.PI,c=2*l;function u(r){return Math.abs(r[1]-r[0])>c-1e-14}function f(r,n){return s(n-r,c)}function h(r,n){if(u(n))return!0;n[0]<n[1]?(i=n[0],a=n[1]):(i=n[1],a=n[0]),(i=o(i,c))>(a=o(a,c))&&(a+=c);var i,a,s=o(r,c),l=s+c;return s>=i&&s<=a||l>=i&&l<=a}function p(r,n,i,a,o,s,f){o=o||0,s=s||0;var h,p,d,m,g,v=u([i,a]);function y(r,n){return[r*Math.cos(n)+o,s-r*Math.sin(n)]}v?(h=0,p=l,d=c):i<a?(h=i,d=a):(h=a,d=i),r<n?(m=r,g=n):(m=n,g=r);var x,b=Math.abs(d-h)<=l?0:1;function _(r,n,i){return"A"+[r,r]+" "+[0,b,i]+" "+y(r,n)}return v?x=null===m?"M"+y(g,h)+_(g,p,0)+_(g,d,0)+"Z":"M"+y(m,h)+_(m,p,0)+_(m,d,0)+"ZM"+y(g,h)+_(g,p,1)+_(g,d,1)+"Z":null===m?(x="M"+y(g,h)+_(g,d,0),f&&(x+="L0,0Z")):x="M"+y(m,h)+"L"+y(g,h)+_(g,d,0)+"L"+y(m,d)+_(m,h,1)+"Z",x}n.exports={deg2rad:function(r){return r/180*l},rad2deg:function(r){return r/l*180},angleDelta:f,angleDist:function(r,n){return Math.abs(f(r,n))},isFullCircle:u,isAngleInsideSector:h,isPtInsideSector:function(r,n,i,a){var o,s;return!!h(n,a)&&(i[0]<i[1]?(o=i[0],s=i[1]):(o=i[1],s=i[0]),r>=o&&r<=s)},pathArc:function(r,n,i,a,o){return p(null,r,n,i,a,o,0)},pathSector:function(r,n,i,a,o){return p(null,r,n,i,a,o,1)},pathAnnulus:function(r,n,i,a,o,s){return p(r,n,i,a,o,s,1)}}},{"./mod":510}],485:[function(r,n,i){"use strict";var a=Array.isArray,o=ArrayBuffer,s=DataView;function l(r){return o.isView(r)&&!(r instanceof s)}function c(r){return a(r)||l(r)}function u(r,n,i){if(c(r)){if(c(r[0])){for(var a=i,o=0;o<r.length;o++)a=n(a,r[o].length);return a}return r.length}return 0}i.isTypedArray=l,i.isArrayOrTypedArray=c,i.isArray1D=function(r){return!c(r[0])},i.ensureArray=function(r,n){return a(r)||(r=[]),r.length=n,r},i.concat=function(){var r,n,i,o,s,l,c,u,f=[],h=!0,p=0;for(i=0;i<arguments.length;i++)(l=(o=arguments[i]).length)&&(n?f.push(o):(n=o,s=l),a(o)?r=!1:(h=!1,p?r!==o.constructor&&(r=!1):r=o.constructor),p+=l);if(!p)return[];if(!f.length)return n;if(h)return n.concat.apply(n,f);if(r){for((c=new r(p)).set(n),i=0;i<f.length;i++)o=f[i],c.set(o,s),s+=o.length;return c}for(c=Array(p),u=0;u<n.length;u++)c[u]=n[u];for(i=0;i<f.length;i++){for(o=f[i],u=0;u<o.length;u++)c[s+u]=o[u];s+=u}return c},i.maxRowLength=function(r){return u(r,Math.max,0)},i.minRowLength=function(r){return u(r,Math.min,1/0)}},{}],486:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../constants/numerical").BADNUM,s=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;n.exports=function(r){return"string"==typeof r&&(r=r.replace(s,"")),a(r)?Number(r):o}},{"../constants/numerical":479,"fast-isnumeric":190}],487:[function(r,n,i){"use strict";n.exports=function(r){var n=r._fullLayout;n._glcanvas&&n._glcanvas.size()&&n._glcanvas.each(function(r){r.regl&&r.regl.clear({color:!0,depth:!0})})}},{}],488:[function(r,n,i){"use strict";n.exports=function(r){r._responsiveChartHandler&&(window.removeEventListener("resize",r._responsiveChartHandler),delete r._responsiveChartHandler)}},{}],489:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("tinycolor2"),s=r("../plots/attributes"),l=r("../components/colorscale/scales"),c=r("../components/color"),u=r("../constants/interactions").DESELECTDIM,f=r("./nested_property"),h=r("./regex").counter,p=r("./mod").modHalf,d=r("./array").isArrayOrTypedArray;function m(r,n){var a=i.valObjectMeta[n.valType];if(n.arrayOk&&d(r))return!0;if(a.validateFunction)return a.validateFunction(r,n);var o={},s=o;return a.coerceFunction(r,{set:function(r){s=r}},o,n),s!==o}i.valObjectMeta={data_array:{coerceFunction:function(r,n,i){d(r)?n.set(r):void 0!==i&&n.set(i)}},enumerated:{coerceFunction:function(r,n,i,a){a.coerceNumber&&(r=+r),-1===a.values.indexOf(r)?n.set(i):n.set(r)},validateFunction:function(r,n){n.coerceNumber&&(r=+r);for(var i=n.values,a=0;a<i.length;a++){var o=String(i[a]);if("/"===o.charAt(0)&&"/"===o.charAt(o.length-1)){if(new RegExp(o.substr(1,o.length-2)).test(r))return!0}else if(r===i[a])return!0}return!1}},boolean:{coerceFunction:function(r,n,i){!0===r||!1===r?n.set(r):n.set(i)}},number:{coerceFunction:function(r,n,i,o){!a(r)||void 0!==o.min&&r<o.min||void 0!==o.max&&r>o.max?n.set(i):n.set(+r)}},integer:{coerceFunction:function(r,n,i,o){r%1||!a(r)||void 0!==o.min&&r<o.min||void 0!==o.max&&r>o.max?n.set(i):n.set(+r)}},string:{coerceFunction:function(r,n,i,a){if("string"!=typeof r){var o="number"==typeof r;!0!==a.strict&&o?n.set(String(r)):n.set(i)}else a.noBlank&&!r?n.set(i):n.set(r)}},color:{coerceFunction:function(r,n,i){o(r).isValid()?n.set(r):n.set(i)}},colorlist:{coerceFunction:function(r,n,i){Array.isArray(r)&&r.length&&r.every(function(r){return o(r).isValid()})?n.set(r):n.set(i)}},colorscale:{coerceFunction:function(r,n,i){n.set(l.get(r,i))}},angle:{coerceFunction:function(r,n,i){"auto"===r?n.set("auto"):a(r)?n.set(p(+r,360)):n.set(i)}},subplotid:{coerceFunction:function(r,n,i,a){var o=a.regex||h(i);"string"==typeof r&&o.test(r)?n.set(r):n.set(i)},validateFunction:function(r,n){var i=n.dflt;return r===i||"string"==typeof r&&!!h(i).test(r)}},flaglist:{coerceFunction:function(r,n,i,a){if("string"==typeof r){if(-1===(a.extras||[]).indexOf(r)){for(var o=r.split("+"),s=0;s<o.length;){var l=o[s];-1===a.flags.indexOf(l)||o.indexOf(l)<s?o.splice(s,1):s++}o.length?n.set(o.join("+")):n.set(i)}else n.set(r)}else n.set(i)}},any:{coerceFunction:function(r,n,i){void 0===r?n.set(i):n.set(r)}},info_array:{coerceFunction:function(r,n,a,o){function s(r,n,a){var o;return void 0===a&&(a=n.dflt),i.valObjectMeta[n.valType].coerceFunction(r,{set:function(r){o=r}},a,n),o}var l=2===o.dimensions||"1-2"===o.dimensions&&Array.isArray(r)&&Array.isArray(r[0]);if(Array.isArray(r)){var c,u,f,h,p,d,m=o.items,g=[],v=Array.isArray(m),y=v&&l&&Array.isArray(m[0]),x=l&&v&&!y,b=v&&!x?m.length:r.length;if(a=Array.isArray(a)?a:[],l)for(c=0;c<b;c++)for(g[c]=[],f=Array.isArray(r[c])?r[c]:[],p=x?m.length:v?m[c].length:f.length,u=0;u<p;u++)h=x?m[u]:v?m[c][u]:m,void 0!==(d=s(f[u],h,(a[c]||[])[u]))&&(g[c][u]=d);else for(c=0;c<b;c++)void 0!==(d=s(r[c],v?m[c]:m,a[c]))&&(g[c]=d);n.set(g)}else n.set(a)},validateFunction:function(r,n){if(!Array.isArray(r))return!1;var i=n.items,a=Array.isArray(i),o=2===n.dimensions;if(!n.freeLength&&r.length!==i.length)return!1;for(var s=0;s<r.length;s++)if(o){if(!Array.isArray(r[s])||!n.freeLength&&r[s].length!==i[s].length)return!1;for(var l=0;l<r[s].length;l++)if(!m(r[s][l],a?i[s][l]:i))return!1}else if(!m(r[s],a?i[s]:i))return!1;return!0}}},i.coerce=function(r,n,a,o,s){var l=f(a,o).get(),c=f(r,o),u=f(n,o),h=c.get(),p=n._template;if(void 0===h&&p&&(h=f(p,o).get(),p=0),void 0===s&&(s=l.dflt),l.arrayOk&&d(h))return u.set(h),h;var g=i.valObjectMeta[l.valType].coerceFunction;g(h,u,s,l);var v=u.get();return p&&v===s&&!m(h,l)&&(g(h=f(p,o).get(),u,s,l),v=u.get()),v},i.coerce2=function(r,n,a,o,s){var l=f(r,o),c=i.coerce(r,n,a,o,s);return null!=l.get()&&c},i.coerceFont=function(r,n,i){var a={};return i=i||{},a.family=r(n+".family",i.family),a.size=r(n+".size",i.size),a.color=r(n+".color",i.color),a},i.coercePattern=function(r,n,i,a){if(r(n+".shape")){r(n+".solidity"),r(n+".size");var o="overlay"===r(n+".fillmode");if(!a){var s=r(n+".bgcolor",o?i:void 0);r(n+".fgcolor",o?c.contrast(s):i)}r(n+".fgopacity",o?.5:1)}},i.coerceHoverinfo=function(r,n,a){var o,l=n._module.attributes,c=l.hoverinfo?l:s,u=c.hoverinfo;if(1===a._dataLength){var f="all"===u.dflt?u.flags.slice():u.dflt.split("+");f.splice(f.indexOf("name"),1),o=f.join("+")}return i.coerce(r,n,c,"hoverinfo",o)},i.coerceSelectionMarkerOpacity=function(r,n){if(r.marker){var i,a,o=r.marker.opacity;void 0!==o&&(d(o)||r.selected||r.unselected||(i=o,a=u*o),n("selected.marker.opacity",i),n("unselected.marker.opacity",a))}},i.validate=m},{"../components/color":366,"../components/colorscale/scales":381,"../constants/interactions":478,"../plots/attributes":550,"./array":485,"./mod":510,"./nested_property":511,"./regex":520,"fast-isnumeric":190,tinycolor2:312}],490:[function(r,n,i){"use strict";var a,o,s=r("d3-time-format").timeFormat,l=r("fast-isnumeric"),c=r("./loggers"),u=r("./mod").mod,f=r("../constants/numerical"),h=f.BADNUM,p=f.ONEDAY,d=f.ONEHOUR,m=f.ONEMIN,g=f.ONESEC,v=f.EPOCHJD,y=r("../registry"),x=r("d3-time-format").utcFormat,b=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,_=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,w=(new Date).getFullYear()-70;function T(r){return r&&y.componentsRegistry.calendars&&"string"==typeof r&&"gregorian"!==r}function k(r,n){return String(r+Math.pow(10,n)).substr(1)}i.dateTick0=function(r,n){var a,o=(a=!!n,T(r)?a?y.getComponentMethod("calendars","CANONICAL_SUNDAY")[r]:y.getComponentMethod("calendars","CANONICAL_TICK")[r]:a?"2000-01-02":"2000-01-01");if(n<2)return o;var s=i.dateTime2ms(o,r);return s+=p*(n-1),i.ms2DateTime(s,0,r)},i.dfltRange=function(r){return T(r)?y.getComponentMethod("calendars","DFLTRANGE")[r]:["2000-01-01","2001-01-01"]},i.isJSDate=function(r){return"object"==typeof r&&null!==r&&"function"==typeof r.getTime},i.dateTime2ms=function(r,n){if(i.isJSDate(r)){var s=r.getTimezoneOffset()*m,l=(r.getUTCMinutes()-r.getMinutes())*m+(r.getUTCSeconds()-r.getSeconds())*g+(r.getUTCMilliseconds()-r.getMilliseconds());if(l){var c=3*m;s=s-c/2+u(l-s+c/2,c)}return(r=Number(r)-s)>=a&&r<=o?r:h}if("string"!=typeof r&&"number"!=typeof r)return h;r=String(r);var f=T(n),x=r.charAt(0);f&&("G"===x||"g"===x)&&(r=r.substr(1),n="");var k=f&&"chinese"===n.substr(0,7),A=r.match(k?_:b);if(!A)return h;var M=A[1],S=A[3]||"1",E=Number(A[5]||1),L=Number(A[7]||0),C=Number(A[9]||0),P=Number(A[11]||0);if(f){if(2===M.length)return h;M=Number(M);try{var I,O=y.getComponentMethod("calendars","getCal")(n);if(k){var z="i"===S.charAt(S.length-1);S=parseInt(S,10),I=O.newDate(M,O.toMonthIndex(M,S,z),E)}else I=O.newDate(M,Number(S),E)}catch(r){return h}return I?(I.toJD()-v)*p+L*d+C*m+P*g:h}M=2===M.length?(Number(M)+2e3-w)%100+w:Number(M);var D=new Date(Date.UTC(2e3,S-=1,E,L,C));return D.setUTCFullYear(M),D.getUTCMonth()!==S||D.getUTCDate()!==E?h:D.getTime()+P*g},a=i.MIN_MS=i.dateTime2ms("-9999"),o=i.MAX_MS=i.dateTime2ms("9999-12-31 23:59:59.9999"),i.isDateTime=function(r,n){return i.dateTime2ms(r,n)!==h};var A=90*p,M=3*d,S=5*m;function E(r,n,i,a,o){if((n||i||a||o)&&(r+=" "+k(n,2)+":"+k(i,2),(a||o)&&(r+=":"+k(a,2),o))){for(var s=4;o%10==0;)s-=1,o/=10;r+="."+k(o,s)}return r}i.ms2DateTime=function(r,n,i){if("number"!=typeof r||!(r>=a&&r<=o))return h;n||(n=0);var s,l,c,f,b,_,w=Math.floor(10*u(r+.05,1)),k=Math.round(r-w/10);if(T(i)){var L=Math.floor(k/p)+v,C=Math.floor(u(r,p));try{s=y.getComponentMethod("calendars","getCal")(i).fromJD(L).formatDate("yyyy-mm-dd")}catch(r){s=x("G%Y-%m-%d")(new Date(k))}if("-"===s.charAt(0))for(;s.length<11;)s="-0"+s.substr(1);else for(;s.length<10;)s="0"+s;l=n<A?Math.floor(C/d):0,c=n<A?Math.floor(C%d/m):0,f=n<M?Math.floor(C%m/g):0,b=n<S?C%g*10+w:0}else _=new Date(k),s=x("%Y-%m-%d")(_),l=n<A?_.getUTCHours():0,c=n<A?_.getUTCMinutes():0,f=n<M?_.getUTCSeconds():0,b=n<S?10*_.getUTCMilliseconds()+w:0;return E(s,l,c,f,b)},i.ms2DateTimeLocal=function(r){if(!(r>=a+p&&r<=o-p))return h;var n=Math.floor(10*u(r+.05,1)),i=new Date(Math.round(r-n/10));return E(s("%Y-%m-%d")(i),i.getHours(),i.getMinutes(),i.getSeconds(),10*i.getUTCMilliseconds()+n)},i.cleanDate=function(r,n,a){if(r===h)return n;if(i.isJSDate(r)||"number"==typeof r&&isFinite(r)){if(T(a))return c.error("JS Dates and milliseconds are incompatible with world calendars",r),n;if(!(r=i.ms2DateTimeLocal(+r))&&void 0!==n)return n}else if(!i.isDateTime(r,a))return c.error("unrecognized date",r),n;return r};var L=/%\d?f/g,C=/%h/g,P={1:"1",2:"1",3:"2",4:"2"};function I(r,n,i,a){r=r.replace(L,function(r){var i=Math.min(+r.charAt(1)||6,6);return(n/1e3%1+2).toFixed(i).substr(2).replace(/0+$/,"")||"0"});var o=new Date(Math.floor(n+.05));if(r=r.replace(C,function(){return P[i("%q")(o)]}),T(a))try{r=y.getComponentMethod("calendars","worldCalFmt")(r,n,a)}catch(r){return"Invalid"}return i(r)(o)}var O=[59,59.9,59.99,59.999,59.9999];i.formatDate=function(r,n,i,a,o,s){if(o=T(o)&&o,!n){if("y"===i)n=s.year;else if("m"===i)n=s.month;else{if("d"!==i)return function(r,n){var i=u(r+.05,p),a=k(Math.floor(i/d),2)+":"+k(u(Math.floor(i/m),60),2);if("M"!==n){l(n)||(n=0);var o=(100+Math.min(u(r/g,60),O[n])).toFixed(n).substr(1);n>0&&(o=o.replace(/0+$/,"").replace(/[\.]$/,"")),a+=":"+o}return a}(r,i)+"\n"+I(s.dayMonthYear,r,a,o);n=s.dayMonth+"\n"+s.year}}return I(n,r,a,o)};var z=3*p;i.incrementMonth=function(r,n,i){i=T(i)&&i;var a=u(r,p);if(r=Math.round(r-a),i)try{var o=Math.round(r/p)+v,s=y.getComponentMethod("calendars","getCal")(i),l=s.fromJD(o);return n%12?s.add(l,n,"m"):s.add(l,n/12,"y"),(l.toJD()-v)*p+a}catch(n){c.error("invalid ms "+r+" in calendar "+i)}var f=new Date(r+z);return f.setUTCMonth(f.getUTCMonth()+n)+a-z},i.findExactDates=function(r,n){for(var i,a,o=0,s=0,c=0,u=0,f=T(n)&&y.getComponentMethod("calendars","getCal")(n),h=0;h<r.length;h++)if(l(a=r[h])){if(!(a%p)){if(f)try{1===(i=f.fromJD(a/p+v)).day()?1===i.month()?o++:s++:c++}catch(r){}else 1===(i=new Date(a)).getUTCDate()?0===i.getUTCMonth()?o++:s++:c++}}else u++;c+=s+=o;var d=r.length-u;return{exactYears:o/d,exactMonths:s/d,exactDays:c/d}}},{"../constants/numerical":479,"../registry":638,"./loggers":507,"./mod":510,"d3-time-format":120,"fast-isnumeric":190}],491:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("./loggers"),s=r("./matrix"),l=r("gl-mat4");function c(r){var n=r&&r.parentNode;n&&n.removeChild(r)}function u(r,n,i){var a="plotly.js-style-"+r,s=document.getElementById(a);s||((s=document.createElement("style")).setAttribute("id",a),s.appendChild(document.createTextNode("")),document.head.appendChild(s));var l=s.sheet;l.insertRule?l.insertRule(n+"{"+i+"}",0):l.addRule?l.addRule(n,i,0):o.warn("addStyleRule failed")}function f(r){var n=window.getComputedStyle(r,null),i=n.getPropertyValue("-webkit-transform")||n.getPropertyValue("-moz-transform")||n.getPropertyValue("-ms-transform")||n.getPropertyValue("-o-transform")||n.getPropertyValue("transform");return"none"===i?null:i.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(r){return+r})}function h(r){for(var n,i=[];(n=r)&&(n instanceof Element||n instanceof HTMLElement);)i.push(r),r=r.parentNode;return i}n.exports={getGraphDiv:function(r){var n;if("string"==typeof r){if(null===(n=document.getElementById(r)))throw Error("No DOM element with id '"+r+"' exists on the page.");return n}if(null==r)throw Error("DOM element provided is null or undefined");return r},isPlotDiv:function(r){var n=a.select(r);return n.node() instanceof HTMLElement&&n.size()&&n.classed("js-plotly-plot")},removeElement:c,addStyleRule:function(r,n){u("global",r,n)},addRelatedStyleRule:u,deleteRelatedStyleRule:function(r){var n=document.getElementById("plotly.js-style-"+r);n&&c(n)},getFullTransformMatrix:function(r){var n=h(r),i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return n.forEach(function(r){var n=f(r);if(n){var a=s.convertCssMatrix(n);i=l.multiply(i,i,a)}}),i},getElementTransformMatrix:f,getElementAndAncestors:h,equalDomRects:function(r,n){return r&&n&&r.x===n.x&&r.y===n.y&&r.top===n.top&&r.left===n.left&&r.right===n.right&&r.bottom===n.bottom}}},{"./loggers":507,"./matrix":509,"@plotly/d3":58,"gl-mat4":210}],492:[function(r,n,i){"use strict";var a=r("events").EventEmitter;n.exports={init:function(r){if(r._ev instanceof a)return r;var n=new a,i=new a;return r._ev=n,r._internalEv=i,r.on=n.on.bind(n),r.once=n.once.bind(n),r.removeListener=n.removeListener.bind(n),r.removeAllListeners=n.removeAllListeners.bind(n),r._internalOn=i.on.bind(i),r._internalOnce=i.once.bind(i),r._removeInternalListener=i.removeListener.bind(i),r._removeAllInternalListeners=i.removeAllListeners.bind(i),r.emit=function(a,o){"undefined"!=typeof jQuery&&jQuery(r).trigger(a,o),n.emit(a,o),i.emit(a,o)},r},triggerHandler:function(r,n,i){"undefined"!=typeof jQuery&&(o=jQuery(r).triggerHandler(n,i));var a=r._ev;if(!a)return o;var o,s,l,c=a._events[n];if(!c)return o;function u(r){return r.listener?(a.removeListener(n,r.listener),r.fired?void 0:(r.fired=!0,r.listener.apply(a,[i]))):r.apply(a,[i])}for(c=Array.isArray(c)?c:[c],l=0;l<c.length-1;l++)u(c[l]);return s=u(c[l]),void 0!==o?o:s},purge:function(r){return delete r._ev,delete r.on,delete r.once,delete r.removeListener,delete r.removeAllListeners,delete r.emit,delete r._ev,delete r._internalEv,delete r._internalOn,delete r._internalOnce,delete r._removeInternalListener,delete r._removeAllInternalListeners,r}}},{events:84}],493:[function(r,n,i){"use strict";var a=r("./is_plain_object.js"),o=Array.isArray;function s(r,n,i,l){var c,u,f,h,p,d,m=r[0],g=r.length;if(2===g&&o(m)&&o(r[1])&&0===m.length){if(function(r,n){var i,a;for(i=0;i<r.length;i++){if(null!==(a=r[i])&&"object"==typeof a)return!1;void 0!==a&&(n[i]=a)}return!0}(r[1],m))return m;m.splice(0,m.length)}for(var v=1;v<g;v++)for(u in c=r[v])f=m[u],h=c[u],l&&o(h)?m[u]=h:n&&h&&(a(h)||(p=o(h)))?(p?(p=!1,d=f&&o(f)?f:[]):d=f&&a(f)?f:{},m[u]=s([d,h],n,i,l)):(void 0!==h||i)&&(m[u]=h);return m}i.extendFlat=function(){return s(arguments,!1,!1,!1)},i.extendDeep=function(){return s(arguments,!0,!1,!1)},i.extendDeepAll=function(){return s(arguments,!0,!0,!1)},i.extendDeepNoArrays=function(){return s(arguments,!0,!1,!0)}},{"./is_plain_object.js":504}],494:[function(r,n,i){"use strict";n.exports=function(r){for(var n={},i=[],a=0,o=0;o<r.length;o++){var s=r[o];1!==n[s]&&(n[s]=1,i[a++]=s)}return i}},{}],495:[function(r,n,i){"use strict";function a(r){return!0===r.visible}function o(r){var n=r[0].trace;return!0===n.visible&&0!==n._length}n.exports=function(r){for(var n=Array.isArray(r)&&Array.isArray(r[0])&&r[0][0]&&r[0][0].trace?o:a,i=[],s=0;s<r.length;s++){var l=r[s];n(l)&&i.push(l)}return i}},{}],496:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("country-regex"),s=r("@turf/area"),l=r("@turf/centroid"),c=r("@turf/bbox"),u=r("./identity"),f=r("./loggers"),h=r("./is_plain_object"),p=r("./nested_property"),d=r("./polygon"),m=Object.keys(o),g={"ISO-3":u,"USA-states":u,"country names":function(r){for(var n=0;n<m.length;n++){var i=m[n];if(new RegExp(o[i]).test(r.trim().toLowerCase()))return i}return f.log("Unrecognized country name: "+r+"."),!1}};function v(r){var n=r.geojson,i=window.PlotlyGeoAssets||{},a="string"==typeof n?i[n]:n;return h(a)?a:(f.error("Oops ... something went wrong when fetching "+n),!1)}n.exports={locationToFeature:function(r,n,i){if(!n||"string"!=typeof n)return!1;var a,o,s,l=g[r](n);if(l){if("USA-states"===r)for(a=[],s=0;s<i.length;s++)(o=i[s]).properties&&o.properties.gu&&"USA"===o.properties.gu&&a.push(o);else a=i;for(s=0;s<a.length;s++)if((o=a[s]).id===l)return o;f.log(["Location with id",l,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(r){var n,i,a,o,s=r.geometry,l=s.coordinates,c=r.id,u=[];function f(r){for(var n=0;n<r.length-1;n++)if(r[n][0]>0&&r[n+1][0]<0)return n;return null}switch(n="RUS"===c||"FJI"===c?function(r){var n;if(null===f(r))n=r;else for(n=Array(r.length),o=0;o<r.length;o++)n[o]=[r[o][0]<0?r[o][0]+360:r[o][0],r[o][1]];u.push(d.tester(n))}:"ATA"===c?function(r){var n=f(r);if(null===n)return u.push(d.tester(r));var i=Array(r.length+1),a=0;for(o=0;o<r.length;o++)o>n?i[a++]=[r[o][0]+360,r[o][1]]:o===n?(i[a++]=r[o],i[a++]=[r[o][0],-90]):i[a++]=r[o];var s=d.tester(i);s.pts.pop(),u.push(s)}:function(r){u.push(d.tester(r))},s.type){case"MultiPolygon":for(i=0;i<l.length;i++)for(a=0;a<l[i].length;a++)n(l[i][a]);break;case"Polygon":for(i=0;i<l.length;i++)n(l[i])}return u},getTraceGeojson:v,extractTraceFeature:function(r){var n=r[0].trace,i=v(n);if(!i)return!1;var a,o={},c=[];for(a=0;a<n._length;a++){var u=r[a];(u.loc||0===u.loc)&&(o[u.loc]=u)}function h(r){var i=p(r,n.featureidkey||"id").get(),a=o[i];if(a){var u=r.geometry;if("Polygon"===u.type||"MultiPolygon"===u.type){var h={type:"Feature",id:i,geometry:u,properties:{}};h.properties.ct=function(r){var n,i=r.geometry;if("MultiPolygon"===i.type)for(var a=i.coordinates,o=0,c=0;c<a.length;c++){var u={type:"Polygon",coordinates:a[c]},f=s.default(u);f>o&&(o=f,n=u)}else n=i;return l.default(n).geometry.coordinates}(h),a.fIn=r,a.fOut=h,c.push(h)}else f.log(["Location",a.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete o[i]}switch(i.type){case"FeatureCollection":var d=i.features;for(a=0;a<d.length;a++)h(d[a]);break;case"Feature":h(i);break;default:return f.warn(["Invalid GeoJSON type",(i.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var m in o)f.log(["Location *"+m+"*","does not have a matching feature with id-key","*"+n.featureidkey+"*."].join(" "));return c},fetchTraceGeoData:function(r){for(var n=window.PlotlyGeoAssets||{},i=[],o=0;o<r.length;o++){var s=r[o][0].trace.geojson;"string"==typeof s&&(n[s]?"pending"===n[s]&&i.push(function(r){return new Promise(function(i,a){var o=0,s=setInterval(function(){return n[r]&&"pending"!==n[r]?(clearInterval(s),i(n[r])):o>100?(clearInterval(s),a("Unexpected error while fetching from "+r)):void o++},50)})}(s)):(n[s]="pending",i.push(function(r){return new Promise(function(i,o){a.json(r,function(a,s){return a?(delete n[r],o(Error(404===a.status?'GeoJSON at URL "'+r+'" does not exist.':"Unexpected error while fetching from "+r))):(n[r]=s,i(s))})})}(s))))}return i},computeBbox:function(r){return c.default(r)}}},{"./identity":501,"./is_plain_object":504,"./loggers":507,"./nested_property":511,"./polygon":515,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],497:[function(r,n,i){"use strict";var a=r("../constants/numerical").BADNUM;i.calcTraceToLineCoords=function(r){for(var n=r[0].trace.connectgaps,i=[],o=[],s=0;s<r.length;s++){var l=r[s].lonlat;l[0]!==a?o.push(l):!n&&o.length>0&&(i.push(o),o=[])}return o.length>0&&i.push(o),i},i.makeLine=function(r){return 1===r.length?{type:"LineString",coordinates:r[0]}:{type:"MultiLineString",coordinates:r}},i.makePolygon=function(r){if(1===r.length)return{type:"Polygon",coordinates:r};for(var n=Array(r.length),i=0;i<r.length;i++)n[i]=[r[i]];return{type:"MultiPolygon",coordinates:n}},i.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":479}],498:[function(r,n,i){"use strict";var a,o,s,l=r("./mod").mod;function c(r,n,i,a,o,s,l,c){var u=i-r,f=o-r,h=l-o,p=a-n,d=s-n,m=c-s,g=u*m-h*p;if(0===g)return null;var v=(f*m-h*d)/g,y=(f*p-u*d)/g;return y<0||y>1||v<0||v>1?null:{x:r+u*v,y:n+p*v}}function u(r,n,i,a,o){var s=a*r+o*n;if(s<0)return a*a+o*o;if(s>i){var l=a-r,c=o-n;return l*l+c*c}var u=a*n-o*r;return u*u/i}i.segmentsIntersect=c,i.segmentDistance=function(r,n,i,a,o,s,l,f){if(c(r,n,i,a,o,s,l,f))return 0;var h=i-r,p=a-n,d=l-o,m=f-s,g=h*h+p*p,v=d*d+m*m;return Math.sqrt(Math.min(u(h,p,g,o-r,s-n),u(h,p,g,l-r,f-n),u(d,m,v,r-o,n-s),u(d,m,v,i-o,a-s)))},i.getTextLocation=function(r,n,i,c){if(r===o&&c===s||(a={},o=r,s=c),a[i])return a[i];var u=r.getPointAtLength(l(i-c/2,n)),f=r.getPointAtLength(l(i+c/2,n)),h=Math.atan((f.y-u.y)/(f.x-u.x)),p=r.getPointAtLength(l(i,n)),d={x:(4*p.x+u.x+f.x)/6,y:(4*p.y+u.y+f.y)/6,theta:h};return a[i]=d,d},i.clearLocationCache=function(){o=null},i.getVisibleSegment=function(r,n,i){var a,o,s=n.left,l=n.right,c=n.top,u=n.bottom,f=0,h=r.getTotalLength(),p=h;function d(n){var i=r.getPointAtLength(n);0===n?a=i:n===h&&(o=i);var f=i.x<s?s-i.x:i.x>l?i.x-l:0,p=i.y<c?c-i.y:i.y>u?i.y-u:0;return Math.sqrt(f*f+p*p)}for(var m=d(f);m;){if((f+=m+i)>p)return;m=d(f)}for(m=d(p);m;){if(f>(p-=m+i))return;m=d(p)}return{min:f,max:p,len:p-f,total:h,isClosed:0===f&&p===h&&.1>Math.abs(a.x-o.x)&&.1>Math.abs(a.y-o.y)}},i.findPointOnPath=function(r,n,i,a){for(var o,s,l,c=(a=a||{}).pathLength||r.getTotalLength(),u=a.tolerance||.001,f=a.iterationLimit||30,h=r.getPointAtLength(0)[i]>r.getPointAtLength(c)[i]?-1:1,p=0,d=0,m=c;p<f&&(o=(d+m)/2,!(Math.abs(l=(s=r.getPointAtLength(o))[i]-n)<u));)h*l>0?m=o:d=o,p++;return s}},{"./mod":510}],499:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("tinycolor2"),s=r("color-normalize"),l=r("../components/colorscale"),c=r("../components/color/attributes").defaultLine,u=r("./array").isArrayOrTypedArray,f=s(c);function h(r){if(a(r))return f;var n=s(r);return n.length?n:f}function p(r){return a(r)?r:1}n.exports={formatColor:function(r,n,i){var a,o,c,d,m,g,v=r.color,y=u(v),x=u(n),b=l.extractOpts(r),_=[];if(o=void 0!==b.colorscale?l.makeColorScaleFuncFromTrace(r):h,c=y?function(r,n){return void 0===r[n]?f:s(o(r[n]))}:h,d=x?function(r,n){return void 0===r[n]?1:p(r[n])}:p,y||x)for(var w=0;w<i;w++)m=c(v,w),g=d(n,w),_[w]=(m[3]*=g,m);else a=s(v),a[3]*=n,_=a;return _},parseColorScale:function(r){var n=l.extractOpts(r),i=n.colorscale;return n.reversescale&&(i=l.flipScale(n.colorscale)),i.map(function(r){var n=r[0],i=o(r[1]).toRgb();return{index:n,rgb:[i.r,i.g,i.b,i.a]}})}}},{"../components/color/attributes":365,"../components/colorscale":378,"./array":485,"color-normalize":89,"fast-isnumeric":190,tinycolor2:312}],500:[function(r,n,i){"use strict";var a=r("./identity");function o(r){return[r]}n.exports={keyFun:function(r){return r.key},repeat:o,descend:a,wrap:o,unwrap:function(r){return r[0]}}},{"./identity":501}],501:[function(r,n,i){"use strict";n.exports=function(r){return r}},{}],502:[function(r,n,i){"use strict";n.exports=function(r,n){if(!n)return r;var i=1/Math.abs(n),a=i>1?(i*r+i*n)/i:r+n,o=String(a).length;if(o>16){var s=String(n).length;if(o>=String(r).length+s){var l=parseFloat(a).toPrecision(12);-1===l.indexOf("e+")&&(a=+l)}}return a}},{}],503:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("d3-time-format").utcFormat,s=r("d3-format").format,l=r("fast-isnumeric"),c=r("../constants/numerical"),u=c.FP_SAFE,f=-u,h=c.BADNUM,p=n.exports={};p.adjustFormat=function(r){return!r||/^\d[.]\df/.test(r)||/[.]\d%/.test(r)?r:"0.f"===r?"~f":/^\d%/.test(r)?"~%":/^\ds/.test(r)?"~s":!/^[~,.0$]/.test(r)&&/[&fps]/.test(r)?"~"+r:r};var d={};p.warnBadFormat=function(r){var n=String(r);d[n]||(d[n]=1,p.warn('encountered bad format: "'+n+'"'))},p.noFormat=function(r){return String(r)},p.numberFormat=function(r){var n;try{n=s(p.adjustFormat(r))}catch(n){return p.warnBadFormat(r),p.noFormat}return n},p.nestedProperty=r("./nested_property"),p.keyedContainer=r("./keyed_container"),p.relativeAttr=r("./relative_attr"),p.isPlainObject=r("./is_plain_object"),p.toLogRange=r("./to_log_range"),p.relinkPrivateKeys=r("./relink_private");var m=r("./array");p.isTypedArray=m.isTypedArray,p.isArrayOrTypedArray=m.isArrayOrTypedArray,p.isArray1D=m.isArray1D,p.ensureArray=m.ensureArray,p.concat=m.concat,p.maxRowLength=m.maxRowLength,p.minRowLength=m.minRowLength;var g=r("./mod");p.mod=g.mod,p.modHalf=g.modHalf;var v=r("./coerce");p.valObjectMeta=v.valObjectMeta,p.coerce=v.coerce,p.coerce2=v.coerce2,p.coerceFont=v.coerceFont,p.coercePattern=v.coercePattern,p.coerceHoverinfo=v.coerceHoverinfo,p.coerceSelectionMarkerOpacity=v.coerceSelectionMarkerOpacity,p.validate=v.validate;var y=r("./dates");p.dateTime2ms=y.dateTime2ms,p.isDateTime=y.isDateTime,p.ms2DateTime=y.ms2DateTime,p.ms2DateTimeLocal=y.ms2DateTimeLocal,p.cleanDate=y.cleanDate,p.isJSDate=y.isJSDate,p.formatDate=y.formatDate,p.incrementMonth=y.incrementMonth,p.dateTick0=y.dateTick0,p.dfltRange=y.dfltRange,p.findExactDates=y.findExactDates,p.MIN_MS=y.MIN_MS,p.MAX_MS=y.MAX_MS;var x=r("./search");p.findBin=x.findBin,p.sorterAsc=x.sorterAsc,p.sorterDes=x.sorterDes,p.distinctVals=x.distinctVals,p.roundUp=x.roundUp,p.sort=x.sort,p.findIndexOfMin=x.findIndexOfMin,p.sortObjectKeys=r("./sort_object_keys");var b=r("./stats");p.aggNums=b.aggNums,p.len=b.len,p.mean=b.mean,p.median=b.median,p.midRange=b.midRange,p.variance=b.variance,p.stdev=b.stdev,p.interp=b.interp;var _=r("./matrix");p.init2dArray=_.init2dArray,p.transposeRagged=_.transposeRagged,p.dot=_.dot,p.translationMatrix=_.translationMatrix,p.rotationMatrix=_.rotationMatrix,p.rotationXYMatrix=_.rotationXYMatrix,p.apply3DTransform=_.apply3DTransform,p.apply2DTransform=_.apply2DTransform,p.apply2DTransform2=_.apply2DTransform2,p.convertCssMatrix=_.convertCssMatrix,p.inverseTransformMatrix=_.inverseTransformMatrix;var w=r("./angles");p.deg2rad=w.deg2rad,p.rad2deg=w.rad2deg,p.angleDelta=w.angleDelta,p.angleDist=w.angleDist,p.isFullCircle=w.isFullCircle,p.isAngleInsideSector=w.isAngleInsideSector,p.isPtInsideSector=w.isPtInsideSector,p.pathArc=w.pathArc,p.pathSector=w.pathSector,p.pathAnnulus=w.pathAnnulus;var T=r("./anchor_utils");p.isLeftAnchor=T.isLeftAnchor,p.isCenterAnchor=T.isCenterAnchor,p.isRightAnchor=T.isRightAnchor,p.isTopAnchor=T.isTopAnchor,p.isMiddleAnchor=T.isMiddleAnchor,p.isBottomAnchor=T.isBottomAnchor;var k=r("./geometry2d");p.segmentsIntersect=k.segmentsIntersect,p.segmentDistance=k.segmentDistance,p.getTextLocation=k.getTextLocation,p.clearLocationCache=k.clearLocationCache,p.getVisibleSegment=k.getVisibleSegment,p.findPointOnPath=k.findPointOnPath;var A=r("./extend");p.extendFlat=A.extendFlat,p.extendDeep=A.extendDeep,p.extendDeepAll=A.extendDeepAll,p.extendDeepNoArrays=A.extendDeepNoArrays;var M=r("./loggers");p.log=M.log,p.warn=M.warn,p.error=M.error;var S=r("./regex");p.counterRegex=S.counter;var E=r("./throttle");p.throttle=E.throttle,p.throttleDone=E.done,p.clearThrottle=E.clear;var L=r("./dom");function C(r){var n={};for(var i in r)for(var a=r[i],o=0;o<a.length;o++)n[a[o]]=+i;return n}p.getGraphDiv=L.getGraphDiv,p.isPlotDiv=L.isPlotDiv,p.removeElement=L.removeElement,p.addStyleRule=L.addStyleRule,p.addRelatedStyleRule=L.addRelatedStyleRule,p.deleteRelatedStyleRule=L.deleteRelatedStyleRule,p.getFullTransformMatrix=L.getFullTransformMatrix,p.getElementTransformMatrix=L.getElementTransformMatrix,p.getElementAndAncestors=L.getElementAndAncestors,p.equalDomRects=L.equalDomRects,p.clearResponsive=r("./clear_responsive"),p.preserveDrawingBuffer=r("./preserve_drawing_buffer"),p.makeTraceGroups=r("./make_trace_groups"),p._=r("./localize"),p.notifier=r("./notifier"),p.filterUnique=r("./filter_unique"),p.filterVisible=r("./filter_visible"),p.pushUnique=r("./push_unique"),p.increment=r("./increment"),p.cleanNumber=r("./clean_number"),p.ensureNumber=function(r){return l(r)?(r=Number(r))>u||r<f?h:r:h},p.isIndex=function(r,n){return!(void 0!==n&&r>=n)&&l(r)&&r>=0&&r%1==0},p.noop=r("./noop"),p.identity=r("./identity"),p.repeat=function(r,n){for(var i=Array(n),a=0;a<n;a++)i[a]=r;return i},p.swapAttrs=function(r,n,i,a){i||(i="x"),a||(a="y");for(var o=0;o<n.length;o++){var s=n[o],l=p.nestedProperty(r,s.replace("?",i)),c=p.nestedProperty(r,s.replace("?",a)),u=l.get();l.set(c.get()),c.set(u)}},p.raiseToTop=function(r){r.parentNode.appendChild(r)},p.cancelTransition=function(r){return r.transition().duration(0)},p.constrain=function(r,n,i){return n>i?Math.max(i,Math.min(n,r)):Math.max(n,Math.min(i,r))},p.bBoxIntersect=function(r,n,i){return i=i||0,r.left<=n.right+i&&n.left<=r.right+i&&r.top<=n.bottom+i&&n.top<=r.bottom+i},p.simpleMap=function(r,n,i,a,o){for(var s=r.length,l=Array(s),c=0;c<s;c++)l[c]=n(r[c],i,a,o);return l},p.randstr=function r(n,i,a,o){if(a||(a=16),void 0===i&&(i=24),i<=0)return"0";var s,l=Math.log(Math.pow(2,i))/Math.log(a),c="";for(s=2;l===1/0;s*=2)l=Math.log(Math.pow(2,i/s))/Math.log(a)*s;var u=l-Math.floor(l);for(s=0;s<Math.floor(l);s++)c=Math.floor(Math.random()*a).toString(a)+c;u&&(c=Math.floor(Math.random()*Math.pow(a,u)).toString(a)+c);var f=parseInt(c,a);return n&&n[c]||f!==1/0&&f>=Math.pow(2,i)?o>10?(p.warn("randstr failed uniqueness"),c):r(n,i,a,(o||0)+1):c},p.OptionControl=function(r,n){r||(r={}),n||(n="opt");var i={optionList:[],_newoption:function(a){a[n]=r,i[a.name]=a,i.optionList.push(a)}};return i["_"+n]=r,i},p.smooth=function(r,n){if((n=Math.round(n)||0)<2)return r;var i,a,o,s,l=r.length,c=2*l,u=2*n-1,f=Array(u),h=Array(l);for(i=0;i<u;i++)f[i]=(1-Math.cos(Math.PI*(i+1)/n))/(2*n);for(i=0;i<l;i++){for(s=0,a=0;a<u;a++)(o=i+a+1-n)<-l?o-=c*Math.round(o/c):o>=c&&(o-=c*Math.floor(o/c)),o<0?o=-1-o:o>=l&&(o=c-1-o),s+=r[o]*f[a];h[i]=s}return h},p.syncOrAsync=function(r,n,i){var a;function o(){return p.syncOrAsync(r,n,i)}for(;r.length;)if((a=(0,r.splice(0,1)[0])(n))&&a.then)return a.then(o);return i&&i(n)},p.stripTrailingSlash=function(r){return"/"===r.substr(-1)?r.substr(0,r.length-1):r},p.noneOrAll=function(r,n,i){if(r){var a,o=!1,s=!0;for(a=0;a<i.length;a++)null!=r[i[a]]?o=!0:s=!1;if(o&&!s)for(a=0;a<i.length;a++)r[i[a]]=n[i[a]]}},p.mergeArray=function(r,n,i,a){var o="function"==typeof a;if(p.isArrayOrTypedArray(r))for(var s=Math.min(r.length,n.length),l=0;l<s;l++){var c=r[l];n[l][i]=o?a(c):c}},p.mergeArrayCastPositive=function(r,n,i){return p.mergeArray(r,n,i,function(r){var n=+r;return isFinite(n)&&n>0?n:0})},p.fillArray=function(r,n,i,a){if(a=a||p.identity,p.isArrayOrTypedArray(r))for(var o=0;o<n.length;o++)n[o][i]=a(r[o])},p.castOption=function(r,n,i,a){a=a||p.identity;var o=p.nestedProperty(r,i).get();return p.isArrayOrTypedArray(o)?a(Array.isArray(n)&&p.isArrayOrTypedArray(o[n[0]])?o[n[0]][n[1]]:o[n]):o},p.extractOption=function(r,n,i,a){if(i in r)return r[i];var o=p.nestedProperty(n,a).get();return Array.isArray(o)?void 0:o},p.tagSelected=function(r,n,i){var a,o=n.selectedpoints,s=n._indexToPoints;s&&(a=C(s));for(var l=0;l<o.length;l++){var c=o[l];if(p.isIndex(c)||p.isArrayOrTypedArray(c)&&p.isIndex(c[0])&&p.isIndex(c[1])){var u=a?a[c]:c,f=i?i[u]:u;void 0!==f&&f<r.length&&(r[f].selected=1)}}},p.selIndices2selPoints=function(r){var n=r.selectedpoints,i=r._indexToPoints;if(i){for(var a=C(i),o=[],s=0;s<n.length;s++){var l=n[s];if(p.isIndex(l)){var c=a[l];p.isIndex(c)&&o.push(c)}}return o}return n},p.getTargetArray=function(r,n){var i=n.target;if("string"==typeof i&&i){var a=p.nestedProperty(r,i).get();return!!Array.isArray(a)&&a}return!!Array.isArray(i)&&i},p.minExtend=function(r,n){var i={};"object"!=typeof n&&(n={});var a,o,s,l=Object.keys(r);for(a=0;a<l.length;a++)s=r[o=l[a]],"_"!==o.charAt(0)&&"function"!=typeof s&&("module"===o?i[o]=s:Array.isArray(s)?i[o]="colorscale"===o?s.slice():s.slice(0,3):p.isTypedArray(s)?i[o]=s.subarray(0,3):i[o]=s&&"object"==typeof s?p.minExtend(r[o],n[o]):s);for(l=Object.keys(n),a=0;a<l.length;a++)"object"==typeof(s=n[o=l[a]])&&o in i&&"object"==typeof i[o]||(i[o]=s);return i},p.titleCase=function(r){return r.charAt(0).toUpperCase()+r.substr(1)},p.containsAny=function(r,n){for(var i=0;i<n.length;i++)if(-1!==r.indexOf(n[i]))return!0;return!1},p.isIE=function(){return void 0!==window.navigator.msSaveBlob};var P=/Version\/[\d\.]+.*Safari/;p.isSafari=function(){return P.test(window.navigator.userAgent)};var I=/iPad|iPhone|iPod/;p.isIOS=function(){return I.test(window.navigator.userAgent)};var O=/Firefox\/(\d+)\.\d+/;p.getFirefoxVersion=function(){var r=O.exec(window.navigator.userAgent);if(r&&2===r.length){var n=parseInt(r[1]);if(!isNaN(n))return n}return null},p.isD3Selection=function(r){return r instanceof a.selection},p.ensureSingle=function(r,n,i,a){var o=r.select(n+(i?"."+i:""));if(o.size())return o;var s=r.append(n);return i&&s.classed(i,!0),a&&s.call(a),s},p.ensureSingleById=function(r,n,i,a){var o=r.select(n+"#"+i);if(o.size())return o;var s=r.append(n).attr("id",i);return a&&s.call(a),s},p.objectFromPath=function(r,n){for(var i,a=r.split("."),o=i={},s=0;s<a.length;s++){var l=a[s],c=null,u=a[s].match(/(.*)\[([0-9]+)\]/);u?(l=u[1],c=u[2],i=i[l]=[],s===a.length-1?i[c]=n:i[c]={},i=i[c]):(s===a.length-1?i[l]=n:i[l]={},i=i[l])}return o};var z=/^([^\[\.]+)\.(.+)?/,D=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;p.expandObjectPaths=function(r){var n,i,a,o,s,l,c;if("object"==typeof r&&!Array.isArray(r))for(i in r)r.hasOwnProperty(i)&&((n=i.match(z))?(o=r[i],a=n[1],delete r[i],r[a]=p.extendDeepNoArrays(r[a]||{},p.objectFromPath(i,p.expandObjectPaths(o))[a])):(n=i.match(D))?(o=r[i],a=n[1],s=parseInt(n[2]),delete r[i],r[a]=r[a]||[],"."===n[3]?(c=n[4],l=r[a][s]=r[a][s]||{},p.extendDeepNoArrays(l,p.objectFromPath(c,p.expandObjectPaths(o)))):r[a][s]=p.expandObjectPaths(o)):r[i]=p.expandObjectPaths(r[i]));return r},p.numSeparate=function(r,n,i){if(i||(i=!1),"string"!=typeof n||0===n.length)throw Error("Separator string required for formatting!");"number"==typeof r&&(r=String(r));var a=/(\d+)(\d{3})/,o=n.charAt(0),s=n.charAt(1),l=r.split("."),c=l[0],u=l.length>1?o+l[1]:"";if(s&&(l.length>1||c.length>4||i))for(;a.test(c);)c=c.replace(a,"$1"+s+"$2");return c+u},p.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var R=/^\w*$/;p.templateString=function(r,n){var i={};return r.replace(p.TEMPLATE_STRING_REGEX,function(r,a){var o;return R.test(a)?o=n[a]:(i[a]=i[a]||p.nestedProperty(n,a).get,o=i[a]()),p.isValidTextValue(o)?o:""})};var F={max:10,count:0,name:"hovertemplate"};p.hovertemplateString=function(){return j.apply(F,arguments)};var B={max:10,count:0,name:"texttemplate"};p.texttemplateString=function(){return j.apply(B,arguments)};var N=/^[:|\|]/;function j(r,n,i){var a=this,s=arguments;n||(n={});var l={};return r.replace(p.TEMPLATE_STRING_REGEX,function(r,c,u){var f,h,d,m,g="_xother"===c||"_yother"===c,v="_xother_"===c||"_yother_"===c,y="xother_"===c||"yother_"===c,x="xother"===c||"yother"===c||g||y||v,b=c;if((g||v)&&(b=b.substring(1)),(y||v)&&(b=b.substring(0,b.length-1)),x){if(void 0===(h=n[b]))return""}else for(m=3;m<s.length;m++)if(d=s[m]){if(d.hasOwnProperty(b)){h=d[b];break}if(R.test(b)||(h=p.nestedProperty(d,b).get(),(h=l[b]||p.nestedProperty(d,b).get())&&(l[b]=h)),void 0!==h)break}if(void 0===h&&a)return a.count<a.max&&(p.warn("Variable '"+b+"' in "+a.name+" could not be found!"),h=r),a.count===a.max&&p.warn("Too many "+a.name+" warnings - additional warnings will be suppressed"),a.count++,r;if(u){if(":"===u[0]&&(h=(f=i?i.numberFormat:p.numberFormat)(u.replace(N,""))(h)),"|"===u[0]){f=i?i.timeFormat:o;var _=p.dateTime2ms(h);h=p.formatDate(_,u.replace(N,""),!1,f)}}else{var w=b+"Label";n.hasOwnProperty(w)&&(h=n[w])}return x&&(h="("+h+")",(g||v)&&(h=" "+h),(y||v)&&(h+=" ")),h})}p.subplotSort=function(r,n){for(var i=Math.min(r.length,n.length)+1,a=0,o=0,s=0;s<i;s++){var l=r.charCodeAt(s)||0,c=n.charCodeAt(s)||0,u=l>=48&&l<=57,f=c>=48&&c<=57;if(u&&(a=10*a+l-48),f&&(o=10*o+c-48),!u||!f){if(a!==o)return a-o;if(l!==c)return l-c}}return o-a};var U=2e9;p.seedPseudoRandom=function(){U=2e9},p.pseudoRandom=function(){var r=U;return 429496729>Math.abs((U=(69069*U+1)%4294967296)-r)?p.pseudoRandom():U/4294967296},p.fillText=function(r,n,i){var a=Array.isArray(i)?function(r){i.push(r)}:function(r){i.text=r},o=p.extractOption(r,n,"htx","hovertext");if(p.isValidTextValue(o))return a(o);var s=p.extractOption(r,n,"tx","text");return p.isValidTextValue(s)?a(s):void 0},p.isValidTextValue=function(r){return r||0===r},p.formatPercent=function(r,n){n=n||0;for(var i=(Math.round(100*r*Math.pow(10,n))*Math.pow(.1,n)).toFixed(n)+"%",a=0;a<n;a++)-1!==i.indexOf(".")&&(i=(i=i.replace("0%","%")).replace(".%","%"));return i},p.isHidden=function(r){var n=window.getComputedStyle(r).display;return!n||"none"===n},p.strTranslate=function(r,n){return r||n?"translate("+r+","+n+")":""},p.strRotate=function(r){return r?"rotate("+r+")":""},p.strScale=function(r){return 1!==r?"scale("+r+")":""},p.getTextTransform=function(r){var n=r.noCenter,i=r.textX,a=r.textY,o=r.targetX,s=r.targetY,l=r.anchorX||0,c=r.anchorY||0,u=r.rotate,f=r.scale;return f?f>1&&(f=1):f=0,p.strTranslate(o-f*(i+l),s-f*(a+c))+p.strScale(f)+(u?"rotate("+u+(n?"":" "+i+" "+a)+")":"")},p.ensureUniformFontSize=function(r,n){var i=p.extendFlat({},n);return i.size=Math.max(n.size,r._fullLayout.uniformtext.minsize||0),i},p.join2=function(r,n,i){var a=r.length;return a>1?r.slice(0,-1).join(n)+i+r[a-1]:r.join(n)},p.bigFont=function(r){return Math.round(1.2*r)};var V=p.getFirefoxVersion(),H=null!==V&&V<86;p.getPositionFromD3Event=function(){return H?[a.event.layerX,a.event.layerY]:[a.event.offsetX,a.event.offsetY]}},{"../constants/numerical":479,"./anchor_utils":483,"./angles":484,"./array":485,"./clean_number":486,"./clear_responsive":488,"./coerce":489,"./dates":490,"./dom":491,"./extend":493,"./filter_unique":494,"./filter_visible":495,"./geometry2d":498,"./identity":501,"./increment":502,"./is_plain_object":504,"./keyed_container":505,"./localize":506,"./loggers":507,"./make_trace_groups":508,"./matrix":509,"./mod":510,"./nested_property":511,"./noop":512,"./notifier":513,"./preserve_drawing_buffer":517,"./push_unique":518,"./regex":520,"./relative_attr":521,"./relink_private":522,"./search":523,"./sort_object_keys":526,"./stats":527,"./throttle":530,"./to_log_range":531,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],504:[function(r,n,i){"use strict";n.exports=function(r){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(r):"[object Object]"===Object.prototype.toString.call(r)&&Object.getPrototypeOf(r).hasOwnProperty("hasOwnProperty")}},{}],505:[function(r,n,i){"use strict";var a=r("./nested_property"),o=/^\w*$/;n.exports=function(r,n,i,s){i=i||"name",s=s||"value";var l,c,u,f={};c=n&&n.length?(u=a(r,n)).get():r,n=n||"";var h={};if(c)for(l=0;l<c.length;l++)h[c[l][i]]=l;var p=o.test(s),d={set:function(r,n){var o=null===n?4:0;if(!c){if(!u||4===o)return;c=[],u.set(c)}var l=h[r];if(void 0===l){if(4===o)return;o|=3,l=c.length,h[r]=l}else n!==(p?c[l][s]:a(c[l],s).get())&&(o|=2);var m=c[l]=c[l]||{};return m[i]=r,p?m[s]=n:a(m,s).set(n),null!==n&&(o&=-5),f[l]=f[l]|o,d},get:function(r){if(c){var n=h[r];return void 0===n?void 0:p?c[n][s]:a(c[n],s).get()}},rename:function(r,n){var a=h[r];return void 0===a||(f[a]=1|f[a],h[n]=a,delete h[r],c[a][i]=n),d},remove:function(r){var n=h[r];if(void 0===n)return d;var o=c[n];if(Object.keys(o).length>2)return f[n]=2|f[n],d.set(r,null);if(p){for(l=n;l<c.length;l++)f[l]=3|f[l];for(l=n;l<c.length;l++)h[c[l][i]]--;c.splice(n,1),delete h[r]}else a(o,s).set(null),f[n]=6|f[n];return d},constructUpdate:function(){for(var r,o,l={},u=Object.keys(f),h=0;h<u.length;h++)o=u[h],r=n+"["+o+"]",c[o]?(1&f[o]&&(l[r+"."+i]=c[o][i]),2&f[o]&&(l[r+"."+s]=p?4&f[o]?null:c[o][s]:4&f[o]?null:a(c[o],s).get())):l[r]=null;return l}};return d}},{"./nested_property":511}],506:[function(r,n,i){"use strict";var a=r("../registry");n.exports=function(r,n){for(var i=r._context.locale,o=0;o<2;o++){for(var s=r._context.locales,l=0;l<2;l++){var c=(s[i]||{}).dictionary;if(c){var u=c[n];if(u)return u}s=a.localeRegistry}var f=i.split("-")[0];if(f===i)break;i=f}return n}},{"../registry":638}],507:[function(r,n,i){"use strict";var a=r("../plot_api/plot_config").dfltConfig,o=r("./notifier"),s=n.exports={};s.log=function(){var r;if(a.logging>1){var n=["LOG:"];for(r=0;r<arguments.length;r++)n.push(arguments[r]);console.trace.apply(console,n)}if(a.notifyOnLogging>1){var i=[];for(r=0;r<arguments.length;r++)i.push(arguments[r]);o(i.join("<br>"),"long")}},s.warn=function(){var r;if(a.logging>0){var n=["WARN:"];for(r=0;r<arguments.length;r++)n.push(arguments[r]);console.trace.apply(console,n)}if(a.notifyOnLogging>0){var i=[];for(r=0;r<arguments.length;r++)i.push(arguments[r]);o(i.join("<br>"),"stick")}},s.error=function(){var r;if(a.logging>0){var n=["ERROR:"];for(r=0;r<arguments.length;r++)n.push(arguments[r]);console.error.apply(console,n)}if(a.notifyOnLogging>0){var i=[];for(r=0;r<arguments.length;r++)i.push(arguments[r]);o(i.join("<br>"),"stick")}}},{"../plot_api/plot_config":541,"./notifier":513}],508:[function(r,n,i){"use strict";var a=r("@plotly/d3");n.exports=function(r,n,i){var o=r.selectAll("g."+i.replace(/\s/g,".")).data(n,function(r){return r[0].trace.uid});o.exit().remove(),o.enter().append("g").attr("class",i),o.order();var s=r.classed("rangeplot")?"nodeRangePlot3":"node3";return o.each(function(r){r[0][s]=a.select(this)}),o}},{"@plotly/d3":58}],509:[function(r,n,i){"use strict";var a=r("gl-mat4");i.init2dArray=function(r,n){for(var i=Array(r),a=0;a<r;a++)i[a]=Array(n);return i},i.transposeRagged=function(r){var n,i,a=0,o=r.length;for(n=0;n<o;n++)a=Math.max(a,r[n].length);var s=Array(a);for(n=0;n<a;n++)for(s[n]=Array(o),i=0;i<o;i++)s[n][i]=r[i][n];return s},i.dot=function(r,n){if(!r.length||!n.length||r.length!==n.length)return null;var a,o,s=r.length;if(r[0].length)for(a=Array(s),o=0;o<s;o++)a[o]=i.dot(r[o],n);else if(n[0].length){var l=i.transposeRagged(n);for(a=Array(l.length),o=0;o<l.length;o++)a[o]=i.dot(r,l[o])}else for(a=0,o=0;o<s;o++)a+=r[o]*n[o];return a},i.translationMatrix=function(r,n){return[[1,0,r],[0,1,n],[0,0,1]]},i.rotationMatrix=function(r){var n=r*Math.PI/180;return[[Math.cos(n),-Math.sin(n),0],[Math.sin(n),Math.cos(n),0],[0,0,1]]},i.rotationXYMatrix=function(r,n,a){return i.dot(i.dot(i.translationMatrix(n,a),i.rotationMatrix(r)),i.translationMatrix(-n,-a))},i.apply3DTransform=function(r){return function(){var n=arguments,a=1==arguments.length?n[0]:[n[0],n[1],n[2]||0];return i.dot(r,[a[0],a[1],a[2],1]).slice(0,3)}},i.apply2DTransform=function(r){return function(){var n=arguments;3===n.length&&(n=n[0]);var a=1==arguments.length?n[0]:[n[0],n[1]];return i.dot(r,[a[0],a[1],1]).slice(0,2)}},i.apply2DTransform2=function(r){var n=i.apply2DTransform(r);return function(r){return n(r.slice(0,2)).concat(n(r.slice(2,4)))}},i.convertCssMatrix=function(r){if(r){var n=r.length;if(16===n)return r;if(6===n)return[r[0],r[1],0,0,r[2],r[3],0,0,0,0,1,0,r[4],r[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},i.inverseTransformMatrix=function(r){var n=[];return a.invert(n,r),[[n[0],n[1],n[2],n[3]],[n[4],n[5],n[6],n[7]],[n[8],n[9],n[10],n[11]],[n[12],n[13],n[14],n[15]]]}},{"gl-mat4":210}],510:[function(r,n,i){"use strict";n.exports={mod:function(r,n){var i=r%n;return i<0?i+n:i},modHalf:function(r,n){return Math.abs(r)>n/2?r-Math.round(r/n)*n:r}}},{}],511:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("./array").isArrayOrTypedArray;n.exports=function(r,n){if(a(n))n=String(n);else if("string"!=typeof n||"[-1]"===n.substr(n.length-4))throw"bad property string";for(var i,s,u,f=0,h=n.split(".");f<h.length;){if(i=String(h[f]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(i[1])h[f]=i[1];else{if(0!==f)throw"bad property string";h.splice(0,1)}for(s=i[2].substr(1,i[2].length-2).split("]["),u=0;u<s.length;u++)f++,h.splice(f,0,Number(s[u]))}f++}return"object"!=typeof r?{set:function(){throw"bad container"},get:function(){},astr:n,parts:h,obj:r}:{set:function r(n,i,s){return function(u){var f,h,p=n,d="",m=[[n,d]],g=l(u,s);for(h=0;h<i.length-1;h++){if("number"==typeof(f=i[h])&&!o(p))throw"array index but container is not an array";if(-1===f){if(g=!function(n,i,a,s){var u,f=o(a),h=!0,p=a,d=s.replace("-1",0),m=!f&&l(a,d),g=i[0];for(u=0;u<n.length;u++)d=s.replace("-1",u),f&&(m=l(p=a[u%a.length],d)),m&&(h=!1),c(n,u,g,m)&&r(n[u],i,s.replace("-1",u))(p);return h}(p,i.slice(h+1),u,s))break;return}if(!c(p,f,i[h+1],g))break;if("object"!=typeof(p=p[f])||null===p)throw"container is not an object";d=function(r,n){var i=n;return a(n)?i="["+n+"]":r&&(i="."+n),r+i}(d,f),m.push([p,d])}if(g){if(h===i.length-1&&(delete p[i[h]],Array.isArray(p)&&+i[h]==p.length-1))for(;p.length&&void 0===p[p.length-1];)p.pop()}else p[i[h]]=u}}(r,h,n),get:function r(n,i){return function(){var a,s,l,c,u,f=n;for(c=0;c<i.length-1;c++){if(-1===(a=i[c])){for(s=!0,l=[],u=0;u<f.length;u++)l[u]=r(f[u],i.slice(c+1))(),l[u]!==l[0]&&(s=!1);return s?l[0]:l}if("number"==typeof a&&!o(f)||"object"!=typeof(f=f[a])||null===f)return}if("object"==typeof f&&null!==f&&null!==(l=f[i[c]]))return l}}(r,h),astr:n,parts:h,obj:r}};var s=/(^|\.)args\[/;function l(r,n){return void 0===r||null===r&&!n.match(s)}function c(r,n,i,a){if(void 0===r[n]){if(a)return!1;r[n]="number"==typeof i?[]:{}}return!0}},{"./array":485,"fast-isnumeric":190}],512:[function(r,n,i){"use strict";n.exports=function(){}},{}],513:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=[];n.exports=function(r,n){if(-1===s.indexOf(r)){s.push(r);var i=1e3;o(n)?i=n:"long"===n&&(i=3e3);var l=a.select("body").selectAll(".plotly-notifier").data([0]);l.enter().append("div").classed("plotly-notifier",!0),l.selectAll(".notifier-note").data(s).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(r){var o=a.select(this);o.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){o.transition().call(c)});for(var s=o.append("p"),l=r.split(/<br\s*\/?>/g),u=0;u<l.length;u++)u&&s.append("br"),s.append("span").text(l[u]);"stick"===n?o.transition().duration(350).style("opacity",1):o.transition().duration(700).style("opacity",1).transition().delay(i).call(c)})}function c(r){r.duration(700).style("opacity",0).each("end",function(r){var n=s.indexOf(r);-1!==n&&s.splice(n,1),a.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":190}],514:[function(r,n,i){"use strict";var a=r("./setcursor"),o="data-savedcursor";n.exports=function(r,n){var i=r.attr(o);if(n){if(!i){for(var s=(r.attr("class")||"").split(" "),l=0;l<s.length;l++){var c=s[l];0===c.indexOf("cursor-")&&r.attr(o,c.substr(7)).classed(c,!1)}r.attr(o)||r.attr(o,"!!")}a(r,n)}else i&&(r.attr(o,null),"!!"===i?a(r):a(r,i))}},{"./setcursor":524}],515:[function(r,n,i){"use strict";var a=r("./matrix").dot,o=r("../constants/numerical").BADNUM,s=n.exports={};s.tester=function(r){var n,i=r.slice(),a=i[0][0],s=a,l=i[0][1],c=l;for(i.push(i[0]),n=1;n<i.length;n++)a=Math.min(a,i[n][0]),s=Math.max(s,i[n][0]),l=Math.min(l,i[n][1]),c=Math.max(c,i[n][1]);var u,f=!1;5===i.length&&(i[0][0]===i[1][0]?i[2][0]===i[3][0]&&i[0][1]===i[3][1]&&i[1][1]===i[2][1]&&(f=!0,u=function(r){return r[0]===i[0][0]}):i[0][1]===i[1][1]&&i[2][1]===i[3][1]&&i[0][0]===i[3][0]&&i[1][0]===i[2][0]&&(f=!0,u=function(r){return r[1]===i[0][1]}));var h=!0,p=i[0];for(n=1;n<i.length;n++)if(p[0]!==i[n][0]||p[1]!==i[n][1]){h=!1;break}return{xmin:a,xmax:s,ymin:l,ymax:c,pts:i,contains:f?function(r,n){var i=r[0],f=r[1];return!(i===o||i<a||i>s||f===o||f<l||f>c)&&(!n||!u(r))}:function(r,n){var u=r[0],f=r[1];if(u===o||u<a||u>s||f===o||f<l||f>c)return!1;var h,p,d,m,g,v=i.length,y=i[0][0],x=i[0][1],b=0;for(h=1;h<v;h++)if(p=y,d=x,y=i[h][0],x=i[h][1],!(u<(m=Math.min(p,y))||u>Math.max(p,y)||f>Math.max(d,x))){if(f<Math.min(d,x))u!==m&&b++;else{if(f===(g=y===p?f:d+(u-p)*(x-d)/(y-p)))return 1!==h||!n;f<=g&&u!==m&&b++}}return b%2==1},isRect:f,degenerate:h}},s.isSegmentBent=function(r,n,i,o){var s,l,c,u=r[n],f=[r[i][0]-u[0],r[i][1]-u[1]],h=a(f,f),p=Math.sqrt(h),d=[-f[1]/p,f[0]/p];for(s=n+1;s<i;s++)if((c=a(l=[r[s][0]-u[0],r[s][1]-u[1]],f))<0||c>h||Math.abs(a(l,d))>o)return!0;return!1},s.filter=function(r,n){var i=[r[0]],a=0,o=0;function l(l){r.push(l);var c=i.length,u=a;i.splice(o+1);for(var f=u+1;f<r.length;f++)(f===r.length-1||s.isSegmentBent(r,u,f+1,n))&&(i.push(r[f]),i.length<c-2&&(a=f,o=i.length-1),u=f)}return r.length>1&&l(r.pop()),{addPt:l,raw:r,filtered:i}}},{"../constants/numerical":479,"./matrix":509}],516:[function(r,n,a){(function(i){(function(){"use strict";var a=r("./show_no_webgl_msg"),o=r("regl");n.exports=function(r,n){var s=r._fullLayout,l=!0;return s._glcanvas.each(function(a){if(!a.regl&&(!a.pick||s._has("parcoords"))){try{a.regl=o({canvas:this,attributes:{antialias:!a.pick,preserveDrawingBuffer:!0},pixelRatio:r._context.plotGlPixelRatio||i.devicePixelRatio,extensions:n||[]})}catch(r){l=!1}a.regl||(l=!1),l&&this.addEventListener("webglcontextlost",function(n){r&&r.emit&&r.emit("plotly_webglcontextlost",{event:n,layer:a.key})},!1)}}),l||a({container:s._glcontainer.node()}),l}}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./show_no_webgl_msg":525,regl:283}],517:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("is-mobile");n.exports=function(r){if("string"!=typeof(i=r&&r.hasOwnProperty("userAgent")?r.userAgent:("undefined"!=typeof navigator&&(n=navigator.userAgent),n&&n.headers&&"string"==typeof n.headers["user-agent"]&&(n=n.headers["user-agent"]),n)))return!0;var n,i,s=o({ua:{headers:{"user-agent":i}},tablet:!0,featureDetect:!1});if(!s){for(var l=i.split(" "),c=1;c<l.length;c++)if(-1!==l[c].indexOf("Safari"))for(var u=c-1;u>-1;u--){var f=l[u];if("Version/"===f.substr(0,8)){var h=f.substr(8).split(".")[0];if(a(h)&&(h=+h),h>=13)return!0}}}return s}},{"fast-isnumeric":190,"is-mobile":234}],518:[function(r,n,i){"use strict";n.exports=function(r,n){if(n instanceof RegExp){for(var i=n.toString(),a=0;a<r.length;a++)if(r[a]instanceof RegExp&&r[a].toString()===i)return r;r.push(n)}else(n||0===n)&&-1===r.indexOf(n)&&r.push(n);return r}},{}],519:[function(r,n,i){"use strict";var a=r("../lib"),o=r("../plot_api/plot_config").dfltConfig,s={add:function(r,n,i,a,s){var l,c;r.undoQueue=r.undoQueue||{index:0,queue:[],sequence:!1},c=r.undoQueue.index,r.autoplay?r.undoQueue.inSequence||(r.autoplay=!1):(!r.undoQueue.sequence||r.undoQueue.beginSequence?(l={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},r.undoQueue.queue.splice(c,r.undoQueue.queue.length-c,l),r.undoQueue.index+=1):l=r.undoQueue.queue[c-1],r.undoQueue.beginSequence=!1,l&&(l.undo.calls.unshift(n),l.undo.args.unshift(i),l.redo.calls.push(a),l.redo.args.push(s)),r.undoQueue.queue.length>o.queueLength&&(r.undoQueue.queue.shift(),r.undoQueue.index--))},startSequence:function(r){r.undoQueue=r.undoQueue||{index:0,queue:[],sequence:!1},r.undoQueue.sequence=!0,r.undoQueue.beginSequence=!0},stopSequence:function(r){r.undoQueue=r.undoQueue||{index:0,queue:[],sequence:!1},r.undoQueue.sequence=!1,r.undoQueue.beginSequence=!1},undo:function(r){var n,i;if(!(void 0===r.undoQueue||isNaN(r.undoQueue.index)||r.undoQueue.index<=0)){for(r.undoQueue.index--,n=r.undoQueue.queue[r.undoQueue.index],r.undoQueue.inSequence=!0,i=0;i<n.undo.calls.length;i++)s.plotDo(r,n.undo.calls[i],n.undo.args[i]);r.undoQueue.inSequence=!1,r.autoplay=!1}},redo:function(r){var n,i;if(!(void 0===r.undoQueue||isNaN(r.undoQueue.index)||r.undoQueue.index>=r.undoQueue.queue.length)){for(n=r.undoQueue.queue[r.undoQueue.index],r.undoQueue.inSequence=!0,i=0;i<n.redo.calls.length;i++)s.plotDo(r,n.redo.calls[i],n.redo.args[i]);r.undoQueue.inSequence=!1,r.autoplay=!1,r.undoQueue.index++}}};s.plotDo=function(r,n,i){r.autoplay=!0,i=function(r,n){for(var i,o=[],s=0;s<n.length;s++)i=n[s],o[s]=i===r?i:"object"==typeof i?Array.isArray(i)?a.extendDeep([],i):a.extendDeepAll({},i):i;return o}(r,i),n.apply(null,i)},n.exports=s},{"../lib":503,"../plot_api/plot_config":541}],520:[function(r,n,i){"use strict";i.counter=function(r,n,i,a){var o=(n||"")+(i?"":"$"),s=!1===a?"":"^";return"xy"===r?RegExp(s+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+o):RegExp(s+r+"([2-9]|[1-9][0-9]+)?"+o)}},{}],521:[function(r,n,i){"use strict";var a=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,o=/^[^\.\[\]]+$/;n.exports=function(r,n){for(;n;){var i=r.match(a);if(i)r=i[1];else{if(!r.match(o))throw Error("bad relativeAttr call:"+[r,n]);r=""}if("^"!==n.charAt(0))break;n=n.slice(1)}return r&&"["!==n.charAt(0)?r+"."+n:r+n}},{}],522:[function(r,n,i){"use strict";var a=r("./array").isArrayOrTypedArray,o=r("./is_plain_object");n.exports=function r(n,i){for(var s in i){var l=i[s],c=n[s];if(c!==l){if("_"===s.charAt(0)||"function"==typeof l){if(s in n)continue;n[s]=l}else if(a(l)&&a(c)&&o(l[0])){if("customdata"===s||"ids"===s)continue;for(var u=Math.min(l.length,c.length),f=0;f<u;f++)c[f]!==l[f]&&o(l[f])&&o(c[f])&&r(c[f],l[f])}else o(l)&&o(c)&&(r(c,l),Object.keys(c).length||delete n[s])}}}},{"./array":485,"./is_plain_object":504}],523:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("./loggers"),s=r("./identity"),l=r("../constants/numerical").BADNUM;function c(r,n){return r<n}function u(r,n){return r<=n}function f(r,n){return r>n}function h(r,n){return r>=n}i.findBin=function(r,n,i){if(a(n.start))return i?Math.ceil((r-n.start)/n.size-1e-9)-1:Math.floor((r-n.start)/n.size+1e-9);var s,l,p=0,d=n.length,m=0,g=d>1?(n[d-1]-n[0])/(d-1):1;for(l=g>=0?i?c:u:i?h:f,r+=1e-9*g*(i?-1:1)*(g>=0?1:-1);p<d&&m++<100;)l(n[s=Math.floor((p+d)/2)],r)?p=s+1:d=s;return m>90&&o.log("Long binary search..."),p-1},i.sorterAsc=function(r,n){return r-n},i.sorterDes=function(r,n){return n-r},i.distinctVals=function(r){var n,a=r.slice();for(a.sort(i.sorterAsc),n=a.length-1;n>-1&&a[n]===l;n--);for(var o,s=a[n]-a[0]||1,c=s/(n||1)/1e4,u=[],f=0;f<=n;f++){var h=a[f],p=h-o;void 0===o?(u.push(h),o=h):p>c&&(s=Math.min(s,p),u.push(h),o=h)}return{vals:u,minDiff:s}},i.roundUp=function(r,n,i){for(var a,o=0,s=n.length-1,l=0,c=i?0:1,u=i?1:0,f=i?Math.ceil:Math.floor;o<s&&l++<100;)n[a=f((o+s)/2)]<=r?o=a+c:s=a-u;return n[o]},i.sort=function(r,n){for(var i=0,a=0,o=1;o<r.length;o++){var s=n(r[o],r[o-1]);if(s<0?i=1:s>0&&(a=1),i&&a)return r.sort(n)}return a?r:r.reverse()},i.findIndexOfMin=function(r,n){n=n||s;for(var i,a=1/0,o=0;o<r.length;o++){var l=n(r[o]);l<a&&(a=l,i=o)}return i}},{"../constants/numerical":479,"./identity":501,"./loggers":507,"fast-isnumeric":190}],524:[function(r,n,i){"use strict";n.exports=function(r,n){(r.attr("class")||"").split(" ").forEach(function(n){0===n.indexOf("cursor-")&&r.classed(n,!1)}),n&&r.classed("cursor-"+n,!0)}},{}],525:[function(r,n,i){"use strict";var a=r("../components/color"),o=function(){};n.exports=function(r){for(var n in r)"function"==typeof r[n]&&(r[n]=o);r.destroy=function(){r.container.parentNode.removeChild(r.container)};var i=document.createElement("div");i.className="no-webgl",i.style.cursor="pointer",i.style.fontSize="24px",i.style.color=a.defaults[0],i.style.position="absolute",i.style.left=i.style.top="0px",i.style.width=i.style.height="100%",i.style["background-color"]=a.lightLine,i.style["z-index"]=30;var s=document.createElement("p");return s.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",s.style.position="relative",s.style.top="50%",s.style.left="50%",s.style.height="30%",s.style.width="50%",s.style.margin="-15% 0 0 -25%",i.appendChild(s),r.container.appendChild(i),r.container.style.background="#FFFFFF",r.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":366}],526:[function(r,n,i){"use strict";n.exports=function(r){return Object.keys(r).sort()}},{}],527:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("./array").isArrayOrTypedArray;i.aggNums=function(r,n,s,l){var c,u;if((!l||l>s.length)&&(l=s.length),a(n)||(n=!1),o(s[0])){for(u=Array(l),c=0;c<l;c++)u[c]=i.aggNums(r,n,s[c]);s=u}for(c=0;c<l;c++)a(n)?a(s[c])&&(n=r(+n,+s[c])):n=s[c];return n},i.len=function(r){return i.aggNums(function(r){return r+1},0,r)},i.mean=function(r,n){return n||(n=i.len(r)),i.aggNums(function(r,n){return r+n},0,r)/n},i.midRange=function(r){if(void 0!==r&&0!==r.length)return(i.aggNums(Math.max,null,r)+i.aggNums(Math.min,null,r))/2},i.variance=function(r,n,o){return n||(n=i.len(r)),a(o)||(o=i.mean(r,n)),i.aggNums(function(r,n){return r+Math.pow(n-o,2)},0,r)/n},i.stdev=function(r,n,a){return Math.sqrt(i.variance(r,n,a))},i.median=function(r){var n=r.slice().sort();return i.interp(n,.5)},i.interp=function(r,n){if(!a(n))throw"n should be a finite number";if((n=n*r.length-.5)<0)return r[0];if(n>r.length-1)return r[r.length-1];var i=n%1;return i*r[Math.ceil(n)]+(1-i)*r[Math.floor(n)]}},{"./array":485,"fast-isnumeric":190}],528:[function(r,n,i){"use strict";var a=r("color-normalize");n.exports=function(r){return r?a(r):[0,0,0,1]}},{"color-normalize":89}],529:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../lib"),s=o.strTranslate,l=r("../constants/xmlns_namespaces"),c=r("../constants/alignment").LINE_SPACING,u=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;i.convertToTspans=function(r,n,g){var S=r.text(),E=!r.attr("data-notex")&&"undefined"!=typeof MathJax&&S.match(u),P=a.select(r.node().parentNode);if(!P.empty()){var I=r.attr("class")?r.attr("class").split(" ")[0]:"text";return I+="-math",P.selectAll("svg."+I).remove(),P.selectAll("g."+I+"-group").remove(),r.style("display",null).attr({"data-unformatted":S,"data-math":"N"}),E?(n&&n._promises||[]).push(new Promise(function(n){r.style("display","none");var i,l,c,u,p,d,m,v=parseInt(r.node().style.fontSize,10);i=E[2],l={fontSize:v},c=function(i,a,o){P.selectAll("svg."+I).remove(),P.selectAll("g."+I+"-group").remove();var l=i&&i.select("svg");if(!l||!l.node())return O(),void n();var c=P.append("g").classed(I+"-group",!0).attr({"pointer-events":"none","data-unformatted":S,"data-math":"Y"});c.node().appendChild(l.node()),a&&a.node()&&l.node().insertBefore(a.node().cloneNode(!0),l.node().firstChild);var u=o.width,f=o.height;l.attr({class:I,height:f,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var h=r.node().style.fill||"black",p=l.select("g");p.attr({fill:h,stroke:h});var d=p.node().getBoundingClientRect(),m=d.width,y=d.height;(m>u||y>f)&&(l.style("overflow","hidden"),m=(d=l.node().getBoundingClientRect()).width,y=d.height);var x=+r.attr("x"),b=+r.attr("y"),_=-(v||r.node().getBoundingClientRect().height)/4;if("y"===I[0])c.attr({transform:"rotate("+[-90,x,b]+")"+s(-m/2,_-y/2)});else if("l"===I[0])b=_-y/2;else if("a"===I[0]&&0!==I.indexOf("atitle"))x=0,b=_;else{var w=r.attr("text-anchor");x-=m*("middle"===w?.5:"end"===w?1:0),b=b+_-y/2}l.attr({x:x,y:b}),g&&g.call(r,c),n(c)},MathJax.Hub.Queue(function(){return p=o.extendDeepAll({},MathJax.Hub.config),d=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})},function(){if("SVG"!==(u=MathJax.Hub.config.menuSettings.renderer))return MathJax.Hub.setRenderer("SVG")},function(){var r="math-output-"+o.randstr({},64);return m=a.select("body").append("div").attr({id:r}).style({visibility:"hidden",position:"absolute"}).style({"font-size":l.fontSize+"px"}).text(i.replace(f,"\\lt ").replace(h,"\\gt ")),MathJax.Hub.Typeset(m.node())},function(){var r=a.select("body").select("#MathJax_SVG_glyphs");if(m.select(".MathJax_SVG").empty()||!m.select("svg").node())o.log("There was an error in the tex syntax.",i),c();else{var n=m.select("svg").node().getBoundingClientRect();c(m.select(".MathJax_SVG"),r,n)}if(m.remove(),"SVG"!==u)return MathJax.Hub.setRenderer(u)},function(){return void 0!==d&&(MathJax.Hub.processSectionDelay=d),MathJax.Hub.Config(p)})})):O(),r}function O(){P.empty()||(I=r.attr("class")+"-math",P.select("svg."+I).remove()),r.text("").style("white-space","pre"),function(r,n){n=n.replace(v," ");var i,s=!1,u=[],f=-1;function h(){f++;var n=document.createElementNS(l.svg,"tspan");a.select(n).attr({class:"line",dy:f*c+"em"}),r.appendChild(n),i=n;var o=u;if(u=[{node:n}],o.length>1)for(var s=1;s<o.length;s++)g(o[s])}function g(r){var n,o=r.type,s={};if("a"===o){n="a";var c=r.target,f=r.href,h=r.popup;f&&(s={"xlink:xlink:show":"_blank"===c||"_"!==c.charAt(0)?"new":"replace",target:c,"xlink:xlink:href":f},h&&(s.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+h+'");return false;'))}else n="tspan";r.style&&(s.style=r.style);var p=document.createElementNS(l.svg,n);if("sup"===o||"sub"===o){S(i,""),i.appendChild(p);var g=document.createElementNS(l.svg,"tspan");S(g,""),a.select(g).attr("dy",m[o]),s.dy=d[o],i.appendChild(p),i.appendChild(g)}else i.appendChild(p);a.select(p).attr(s),i=r.node=p,u.push(r)}function S(r,n){r.appendChild(document.createTextNode(n))}b.test(n)?h():(i=r,u=[{node:r}]);for(var E=n.split(y),P=0;P<E.length;P++){var I=E[P],O=I.match(x),z=O&&O[2].toLowerCase(),D=p[z];if("br"===z)h();else if(void 0===D)S(i,L(I));else if(O[1])(function(r){if(1!==u.length){var a=u.pop();r!==a.type&&o.log("Start tag <"+a.type+"> doesnt match end tag <"+r+">. Pretending it did match.",n),i=u[u.length-1].node}else o.log("Ignoring unexpected end tag </"+r+">.",n)})(z);else{var R=O[4],F={type:z},B=A(R,_);if(B?(B=B.replace(M,"$1 fill:"),D&&(B+=";"+D)):D&&(B=D),B&&(F.style=B),"a"===z){s=!0;var N=A(R,w);if(N){var j=C(N);j&&(F.href=j,F.target=A(R,T)||"_blank",F.popup=A(R,k))}}g(F)}}return s}(r.node(),S)&&r.style("pointer-events","all"),i.positionText(r),g&&g.call(r)}};var f=/(<|&lt;|&#60;)/g,h=/(>|&gt;|&#62;)/g,p={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},d={sub:"0.3em",sup:"-0.6em"},m={sub:"-0.21em",sup:"0.42em"},g=["http:","https:","mailto:","",void 0,":"],v=i.NEWLINES=/(\r\n?|\n)/g,y=/(<[^<>]*>)/,x=/<(\/?)([^ >]*)(\s+(.*))?>/i,b=/<br(\s+.*)?>/i;i.BR_TAG_ALL=/<br(\s+.*)?>/gi;var _=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,w=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,T=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,k=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function A(r,n){if(!r)return null;var i=r.match(n),a=i&&(i[3]||i[4]);return a&&L(a)}var M=/(^|;)\s*color:/;i.plainText=function(r,n){for(var i=void 0!==(n=n||{}).len&&-1!==n.len?n.len:1/0,a=void 0!==n.allowedTags?n.allowedTags:["br"],o=r.split(y),s=[],l="",c=0,u=0;u<o.length;u++){var f=o[u],h=f.match(x),p=h&&h[2].toLowerCase();if(p)-1!==a.indexOf(p)&&(s.push(f),l=p);else{var d=f.length;if(c+d<i)s.push(f),c+=d;else if(c<i){var m=i-c;l&&("br"!==l||m<=3||d<=3)&&s.pop(),i>3?s.push(f.substr(0,m-3)+"..."):s.push(f.substr(0,m));break}l=""}}return s.join("")};var S={mu:"",amp:"&",lt:"<",gt:">",nbsp:"\xa0",times:"\xd7",plusmn:"\xb1",deg:"\xb0"},E=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function L(r){return r.replace(E,function(r,n){return("#"===n.charAt(0)?function(r){if(!(r>1114111)){var n=String.fromCodePoint;if(n)return n(r);var i=String.fromCharCode;return r<=65535?i(r):i(55232+(r>>10),r%1024+56320)}}("x"===n.charAt(1)?parseInt(n.substr(2),16):parseInt(n.substr(1),10)):S[n])||r})}function C(r){var n=encodeURI(decodeURI(r)),i=document.createElement("a"),a=document.createElement("a");i.href=r,a.href=n;var o=i.protocol,s=a.protocol;return -1!==g.indexOf(o)&&-1!==g.indexOf(s)?n:""}function P(r,n,i){var a,s,l,c=i.horizontalAlign,u=i.verticalAlign||"top",f=r.node().getBoundingClientRect(),h=n.node().getBoundingClientRect();return s="bottom"===u?function(){return f.bottom-a.height}:"middle"===u?function(){return f.top+(f.height-a.height)/2}:function(){return f.top},l="right"===c?function(){return f.right-a.width}:"center"===c?function(){return f.left+(f.width-a.width)/2}:function(){return f.left},function(){a=this.node().getBoundingClientRect();var r=l()-h.left,n=s()-h.top,c=i.gd||{};if(i.gd){c._fullLayout._calcInverseTransform(c);var u=o.apply3DTransform(c._fullLayout._invTransform)(r,n);r=u[0],n=u[1]}return this.style({top:n+"px",left:r+"px","z-index":1e3}),this}}i.convertEntities=L,i.sanitizeHTML=function(r){r=r.replace(v," ");for(var n=document.createElement("p"),i=n,o=[],s=r.split(y),l=0;l<s.length;l++){var c=s[l],u=c.match(x),f=u&&u[2].toLowerCase();if(f in p){if(u[1])o.length&&(i=o.pop());else{var h=u[4],d=A(h,_),m=d?{style:d}:{};if("a"===f){var g=A(h,w);if(g){var b=C(g);if(b){m.href=b;var k=A(h,T);k&&(m.target=k)}}}var M=document.createElement(f);i.appendChild(M),a.select(M).attr(m),i=M,o.push(M)}}else i.appendChild(document.createTextNode(L(c)))}return n.innerHTML},i.lineCount=function(r){return r.selectAll("tspan.line").size()||1},i.positionText=function(r,n,i){return r.each(function(){var r=a.select(this);function o(n,i){return void 0===i?null===(i=r.attr(n))&&(r.attr(n,0),i=0):r.attr(n,i),i}var s=o("x",n),l=o("y",i);"text"===this.nodeName&&r.selectAll("tspan.line").attr({x:s,y:l})})},i.makeTextShadow=function(r){var n="1px ",i="1px ",a="1px ";return n+i+a+r+", -"+n+"-"+i+a+r+", "+n+"-"+i+a+r+", -"+n+i+a+r},i.makeEditable=function(r,n){var i=n.gd,o=n.delegate,s=a.dispatch("edit","input","cancel"),l=o||r;if(r.style({"pointer-events":o?"none":"all"}),1!==r.size())throw Error("boo");function c(){c=(o=a.select(i).select(".svg-container")).append("div"),h=parseFloat((f=r.node().style).fontSize||12),void 0===(p=n.text)&&(p=r.attr("data-unformatted")),c.classed("plugin-editable editable",!0).style({position:"absolute","font-family":f.fontFamily||"Arial","font-size":h,color:n.fill||f.fill||"black",opacity:1,"background-color":n.background||"transparent",outline:"#ffffff33 1px solid",margin:[-h/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(p).call(P(r,o,n)).on("blur",function(){i._editing=!1,r.text(this.textContent).style({opacity:1});var n,o=a.select(this).attr("class");(n=o?"."+o.split(" ")[0]+"-math-group":"[class*=-math-group]")&&a.select(r.node().parentNode).select(n).style({opacity:0});var l=this.textContent;a.select(this).transition().duration(0).remove(),a.select(document).on("mouseup",null),s.edit.call(r,l)}).on("focus",function(){var r=this;i._editing=!0,a.select(document).on("mouseup",function(){if(a.event.target===r)return!1;document.activeElement===c.node()&&c.node().blur()})}).on("keyup",function(){27===a.event.which?(i._editing=!1,r.style({opacity:1}),a.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),s.cancel.call(r,this.textContent)):(s.input.call(r,this.textContent),a.select(this).call(P(r,o,n)))}).on("keydown",function(){13===a.event.which&&this.blur()}).call(u),r.style({opacity:0});var o,c,f,h,p,d,m=l.attr("class");(d=m?"."+m.split(" ")[0]+"-math-group":"[class*=-math-group]")&&a.select(r.node().parentNode).select(d).style({opacity:0})}function u(r){var n=r.node(),i=document.createRange();i.selectNodeContents(n);var a=window.getSelection();a.removeAllRanges(),a.addRange(i),n.focus()}return n.immediate?c():l.on("click",c),a.rebind(r,s,"on")}},{"../constants/alignment":471,"../constants/xmlns_namespaces":480,"../lib":503,"@plotly/d3":58}],530:[function(r,n,i){"use strict";var a={};function o(r){r&&null!==r.timer&&(clearTimeout(r.timer),r.timer=null)}i.throttle=function(r,n,i){var s=a[r],l=Date.now();if(!s){for(var c in a)a[c].ts<l-6e4&&delete a[c];s=a[r]={ts:0,timer:null}}function u(){i(),s.ts=Date.now(),s.onDone&&(s.onDone(),s.onDone=null)}o(s),l>s.ts+n?u():s.timer=setTimeout(function(){u(),s.timer=null},n)},i.done=function(r){var n=a[r];return n&&n.timer?new Promise(function(r){var i=n.onDone;n.onDone=function(){i&&i(),r(),n.onDone=null}}):Promise.resolve()},i.clear=function(r){if(r)o(a[r]),delete a[r];else for(var n in a)i.clear(n)}},{}],531:[function(r,n,i){"use strict";var a=r("fast-isnumeric");n.exports=function(r,n){if(r>0)return Math.log(r)/Math.LN10;var i=Math.log(Math.min(n[0],n[1]))/Math.LN10;return a(i)||(i=Math.log(Math.max(n[0],n[1]))/Math.LN10-6),i}},{"fast-isnumeric":190}],532:[function(r,n,i){"use strict";var a=n.exports={},o=r("../plots/geo/constants").locationmodeToLayer,s=r("topojson-client").feature;a.getTopojsonName=function(r){return[r.scope.replace(/ /g,"-"),"_",r.resolution.toString(),"m"].join("")},a.getTopojsonPath=function(r,n){return r+n+".json"},a.getTopojsonFeatures=function(r,n){var i=o[r.locationmode],a=n.objects[i];return s(n,a).features}},{"../plots/geo/constants":587,"topojson-client":315}],533:[function(r,n,i){"use strict";n.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],534:[function(r,n,i){"use strict";n.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],535:[function(r,n,i){"use strict";var a=r("../registry");n.exports=function(r){for(var n,i,o=a.layoutArrayContainers,s=a.layoutArrayRegexes,l=r.split("[")[0],c=0;c<s.length;c++)if((i=r.match(s[c]))&&0===i.index){n=i[0];break}if(n||(n=o[o.indexOf(l)]),!n)return!1;var u=r.substr(n.length);return u?!!(i=u.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:n,index:Number(i[1]),property:i[3]||""}:{array:n,index:"",property:""}}},{"../registry":638}],536:[function(r,n,i){"use strict";var a=r("../lib"),o=a.extendFlat,s=a.isPlainObject,l={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},c={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},u=l.flags.slice().concat(["fullReplot"]),f=c.flags.slice().concat("layoutReplot");function h(r){for(var n={},i=0;i<r.length;i++)n[r[i]]=!1;return n}n.exports={traces:l,layout:c,traceFlags:function(){return h(u)},layoutFlags:function(){return h(f)},update:function(r,n){var i=n.editType;if(i&&"none"!==i)for(var a=i.split("+"),o=0;o<a.length;o++)r[a[o]]=!0},overrideAll:function r(n,i,a){var l=o({},n);for(var c in l){var u=l[c];s(u)&&(l[c]=function n(i,a,s,l){if(i.valType){var c=o({},i);if(c.editType=a,Array.isArray(i.items)){c.items=Array(i.items.length);for(var u=0;u<i.items.length;u++)c.items[u]=n(i.items[u],a,"from-root")}return c}return r(i,a,"_"===l.charAt(0)?"nested":"from-root")}(u,i,a,c))}return"from-root"===a&&(l.editType=i),l}}},{"../lib":503}],537:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("gl-mat4/fromQuat"),s=r("../registry"),l=r("../lib"),c=r("../plots/plots"),u=r("../plots/cartesian/axis_ids"),f=r("../components/color"),h=u.cleanId,p=u.getFromTrace,d=s.traceIs;function m(r,n){var i=r[n],a=n.charAt(0);i&&"paper"!==i&&(r[n]=h(i,a,!0))}function g(r){function n(n,i){var a=r[n],o=r.title&&r.title[i];a&&!o&&(r.title||(r.title={}),r.title[i]=r[n],delete r[n])}r&&("string"!=typeof r.title&&"number"!=typeof r.title||(r.title={text:r.title}),n("titlefont","font"),n("titleposition","position"),n("titleside","side"),n("titleoffset","offset"))}function v(r){if(!l.isPlainObject(r))return!1;var n=r.name;return delete r.name,delete r.showlegend,("string"==typeof n||"number"==typeof n)&&String(n)}function y(r){var n="middle",i="center";return"string"==typeof r&&(-1!==r.indexOf("top")?n="top":-1!==r.indexOf("bottom")&&(n="bottom"),-1!==r.indexOf("left")?i="left":-1!==r.indexOf("right")&&(i="right")),n+" "+i}function x(r,n){return n in r&&"object"==typeof r[n]&&0===Object.keys(r[n]).length}i.clearPromiseQueue=function(r){Array.isArray(r._promises)&&r._promises.length>0&&l.log("Clearing previous rejected promises from queue."),r._promises=[]},i.cleanLayout=function(r){r||(r={}),r.xaxis1&&(r.xaxis||(r.xaxis=r.xaxis1),delete r.xaxis1),r.yaxis1&&(r.yaxis||(r.yaxis=r.yaxis1),delete r.yaxis1),r.scene1&&(r.scene||(r.scene=r.scene1),delete r.scene1);var n,a,s=(c.subplotsRegistry.cartesian||{}).attrRegex,u=(c.subplotsRegistry.polar||{}).attrRegex,p=(c.subplotsRegistry.ternary||{}).attrRegex,d=(c.subplotsRegistry.gl3d||{}).attrRegex,v=Object.keys(r);for(n=0;n<v.length;n++){var y=v[n];if(s&&s.test(y)){var b=r[y];b.anchor&&"free"!==b.anchor&&(b.anchor=h(b.anchor)),b.overlaying&&(b.overlaying=h(b.overlaying)),b.type||(b.isdate?b.type="date":b.islog?b.type="log":!1===b.isdate&&!1===b.islog&&(b.type="linear")),"withzero"!==b.autorange&&"tozero"!==b.autorange||(b.autorange=!0,b.rangemode="tozero"),delete b.islog,delete b.isdate,delete b.categories,x(b,"domain")&&delete b.domain,void 0!==b.autotick&&(void 0===b.tickmode&&(b.tickmode=b.autotick?"auto":"linear"),delete b.autotick),g(b)}else if(u&&u.test(y))g(r[y].radialaxis);else if(p&&p.test(y)){var _=r[y];g(_.aaxis),g(_.baxis),g(_.caxis)}else if(d&&d.test(y)){var w=r[y],T=w.cameraposition;if(Array.isArray(T)&&4===T[0].length){var k=T[0],A=T[1],M=T[2],S=o([],k),E=[];for(a=0;a<3;++a)E[a]=A[a]+M*S[2+4*a];w.camera={eye:{x:E[0],y:E[1],z:E[2]},center:{x:A[0],y:A[1],z:A[2]},up:{x:0,y:0,z:1}},delete w.cameraposition}g(w.xaxis),g(w.yaxis),g(w.zaxis)}}var L=Array.isArray(r.annotations)?r.annotations.length:0;for(n=0;n<L;n++){var C=r.annotations[n];l.isPlainObject(C)&&(C.ref&&("paper"===C.ref?(C.xref="paper",C.yref="paper"):"data"===C.ref&&(C.xref="x",C.yref="y"),delete C.ref),m(C,"xref"),m(C,"yref"))}var P=Array.isArray(r.shapes)?r.shapes.length:0;for(n=0;n<P;n++){var I=r.shapes[n];l.isPlainObject(I)&&(m(I,"xref"),m(I,"yref"))}var O=Array.isArray(r.images)?r.images.length:0;for(n=0;n<O;n++){var z=r.images[n];l.isPlainObject(z)&&(m(z,"xref"),m(z,"yref"))}var D=r.legend;return D&&(D.x>3?(D.x=1.02,D.xanchor="left"):D.x<-2&&(D.x=-.02,D.xanchor="right"),D.y>3?(D.y=1.02,D.yanchor="bottom"):D.y<-2&&(D.y=-.02,D.yanchor="top")),g(r),"rotate"===r.dragmode&&(r.dragmode="orbit"),f.clean(r),r.template&&r.template.layout&&i.cleanLayout(r.template.layout),r},i.cleanData=function(r){for(var n=0;n<r.length;n++){var a,o=r[n];if("histogramy"===o.type&&"xbins"in o&&!("ybins"in o)&&(o.ybins=o.xbins,delete o.xbins),o.error_y&&"opacity"in o.error_y){var u=f.defaults,p=o.error_y.color||(d(o,"bar")?f.defaultLine:u[n%u.length]);o.error_y.color=f.addOpacity(f.rgb(p),f.opacity(p)*o.error_y.opacity),delete o.error_y.opacity}if("bardir"in o&&("h"===o.bardir&&(d(o,"bar")||"histogram"===o.type.substr(0,9))&&(o.orientation="h",i.swapXYData(o)),delete o.bardir),"histogramy"===o.type&&i.swapXYData(o),"histogramx"!==o.type&&"histogramy"!==o.type||(o.type="histogram"),"scl"in o&&!("colorscale"in o)&&(o.colorscale=o.scl,delete o.scl),"reversescl"in o&&!("reversescale"in o)&&(o.reversescale=o.reversescl,delete o.reversescl),o.xaxis&&(o.xaxis=h(o.xaxis,"x")),o.yaxis&&(o.yaxis=h(o.yaxis,"y")),d(o,"gl3d")&&o.scene&&(o.scene=c.subplotsRegistry.gl3d.cleanId(o.scene)),!d(o,"pie-like")&&!d(o,"bar-like")){if(Array.isArray(o.textposition))for(a=0;a<o.textposition.length;a++)o.textposition[a]=y(o.textposition[a]);else o.textposition&&(o.textposition=y(o.textposition))}var m=s.getModule(o);if(m&&m.colorbar){var b=m.colorbar.container,_=b?o[b]:o;_&&_.colorscale&&("YIGnBu"===_.colorscale&&(_.colorscale="YlGnBu"),"YIOrRd"===_.colorscale&&(_.colorscale="YlOrRd"))}if("surface"===o.type&&l.isPlainObject(o.contours)){var w=["x","y","z"];for(a=0;a<w.length;a++){var T=o.contours[w[a]];l.isPlainObject(T)&&(T.highlightColor&&(T.highlightcolor=T.highlightColor,delete T.highlightColor),T.highlightWidth&&(T.highlightwidth=T.highlightWidth,delete T.highlightWidth))}}if("candlestick"===o.type||"ohlc"===o.type){var k=!1!==(o.increasing||{}).showlegend,A=!1!==(o.decreasing||{}).showlegend,M=v(o.increasing),S=v(o.decreasing);if(!1!==M&&!1!==S){var E=function(r,n,i,a){if(i&&!a)return r;if(a&&!i||!r.trim())return n;if(!n.trim())return r;var o,s=Math.min(r.length,n.length);for(o=0;o<s&&r.charAt(o)===n.charAt(o);o++);return r.substr(0,o).trim()}(M,S,k,A);E&&(o.name=E)}else(M||S)&&!o.name&&(o.name=M||S)}if(Array.isArray(o.transforms)){var L=o.transforms;for(a=0;a<L.length;a++){var C=L[a];if(l.isPlainObject(C))switch(C.type){case"filter":C.filtersrc&&(C.target=C.filtersrc,delete C.filtersrc),C.calendar&&(C.valuecalendar||(C.valuecalendar=C.calendar),delete C.calendar);break;case"groupby":if(C.styles=C.styles||C.style,C.styles&&!Array.isArray(C.styles)){var P=C.styles,I=Object.keys(P);C.styles=[];for(var O=0;O<I.length;O++)C.styles.push({target:I[O],value:P[I[O]]})}}}}x(o,"line")&&delete o.line,"marker"in o&&(x(o.marker,"line")&&delete o.marker.line,x(o,"marker")&&delete o.marker),f.clean(o),o.autobinx&&(delete o.autobinx,delete o.xbins),o.autobiny&&(delete o.autobiny,delete o.ybins),g(o),o.colorbar&&g(o.colorbar),o.marker&&o.marker.colorbar&&g(o.marker.colorbar),o.line&&o.line.colorbar&&g(o.line.colorbar),o.aaxis&&g(o.aaxis),o.baxis&&g(o.baxis)}},i.swapXYData=function(r){var n;if(l.swapAttrs(r,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(r.z)&&Array.isArray(r.z[0])&&(r.transpose?delete r.transpose:r.transpose=!0),r.error_x&&r.error_y){var i=r.error_y,a="copy_ystyle"in i?i.copy_ystyle:!(i.color||i.thickness||i.width);l.swapAttrs(r,["error_?.copy_ystyle"]),a&&l.swapAttrs(r,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof r.hoverinfo){var o=r.hoverinfo.split("+");for(n=0;n<o.length;n++)"x"===o[n]?o[n]="y":"y"===o[n]&&(o[n]="x");r.hoverinfo=o.join("+")}},i.coerceTraceIndices=function(r,n){if(a(n))return[n];if(!Array.isArray(n)||!n.length)return r.data.map(function(r,n){return n});if(Array.isArray(n)){for(var i=[],o=0;o<n.length;o++)l.isIndex(n[o],r.data.length)?i.push(n[o]):l.warn("trace index (",n[o],") is not a number or is out of bounds");return i}return n},i.manageArrayContainers=function(r,n,i){var o=r.obj,s=r.parts,c=s.length,u=s[c-1],f=a(u);if(f&&null===n){var h=s.slice(0,c-1).join(".");l.nestedProperty(o,h).get().splice(u,1)}else f&&void 0===r.get()&&void 0===r.get()&&(i[r.astr]=null),r.set(n)};var b=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function _(r){var n=r.search(b);if(n>0)return r.substr(0,n)}i.hasParent=function(r,n){for(var i=_(n);i;){if(i in r)return!0;i=_(i)}return!1};var w=["x","y","z"];i.clearAxisTypes=function(r,n,i){for(var a=0;a<n.length;a++)for(var o=r._fullData[a],s=0;s<3;s++){var c=p(r,o,w[s]);if(c&&"log"!==c.type){var u=c._name,f=c._id.substr(1);if("scene"===f.substr(0,5)){if(void 0!==i[f])continue;u=f+"."+u}var h=u+".type";void 0===i[u]&&void 0===i[h]&&l.nestedProperty(r.layout,h).set(null)}}}},{"../components/color":366,"../lib":503,"../plots/cartesian/axis_ids":558,"../plots/plots":619,"../registry":638,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],538:[function(r,n,i){"use strict";var a=r("./plot_api");i._doPlot=a._doPlot,i.newPlot=a.newPlot,i.restyle=a.restyle,i.relayout=a.relayout,i.redraw=a.redraw,i.update=a.update,i._guiRestyle=a._guiRestyle,i._guiRelayout=a._guiRelayout,i._guiUpdate=a._guiUpdate,i._storeDirectGUIEdit=a._storeDirectGUIEdit,i.react=a.react,i.extendTraces=a.extendTraces,i.prependTraces=a.prependTraces,i.addTraces=a.addTraces,i.deleteTraces=a.deleteTraces,i.moveTraces=a.moveTraces,i.purge=a.purge,i.addFrames=a.addFrames,i.deleteFrames=a.deleteFrames,i.animate=a.animate,i.setPlotConfig=a.setPlotConfig,i.toImage=r("./to_image"),i.validate=r("./validate"),i.downloadImage=r("../snapshot/download");var o=r("./template_api");i.makeTemplate=o.makeTemplate,i.validateTemplate=o.validateTemplate},{"../snapshot/download":640,"./plot_api":540,"./template_api":545,"./to_image":546,"./validate":547}],539:[function(r,n,i){"use strict";var a=r("../lib/is_plain_object"),o=r("../lib/noop"),s=r("../lib/loggers"),l=r("../lib/search").sorterAsc,c=r("../registry");i.containerArrayMatch=r("./container_array_match");var u=i.isAddVal=function(r){return"add"===r||a(r)},f=i.isRemoveVal=function(r){return null===r||"remove"===r};i.applyContainerArrayChanges=function(r,n,i,a,h){var p,d=n.astr,m=c.getComponentMethod(d,"supplyLayoutDefaults"),g=c.getComponentMethod(d,"draw"),v=c.getComponentMethod(d,"drawOne"),y=a.replot||a.recalc||m===o||g===o,x=r.layout,b=r._fullLayout;if(i[""]){Object.keys(i).length>1&&s.warn("Full array edits are incompatible with other edits",d);var _=i[""][""];if(f(_))n.set(null);else{if(!Array.isArray(_))return s.warn("Unrecognized full array edit value",d,_),!0;n.set(_)}return!y&&(m(x,b),g(r),!0)}var w,T,k,A,M,S,E,L,C=Object.keys(i).map(Number).sort(l),P=n.get(),I=P||[],O=h(b,d).get(),z=[],D=-1,R=I.length;for(w=0;w<C.length;w++)if(M=Object.keys(A=i[k=C[w]]),E=u(S=A[""]),k<0||k>I.length-(E?0:1))s.warn("index out of range",d,k);else if(void 0!==S)M.length>1&&s.warn("Insertion & removal are incompatible with edits to the same index.",d,k),f(S)?z.push(k):E?("add"===S&&(S={}),I.splice(k,0,S),O&&O.splice(k,0,{})):s.warn("Unrecognized full object edit value",d,k,S),-1===D&&(D=k);else for(T=0;T<M.length;T++)L=d+"["+k+"].",h(I[k],M[T],L).set(A[M[T]]);for(w=z.length-1;w>=0;w--)I.splice(z[w],1),O&&O.splice(z[w],1);if(I.length?P||n.set(I):n.set(null),y)return!1;if(m(x,b),v!==o){if(-1===D)p=C;else{for(R=Math.max(I.length,R),p=[],w=0;w<C.length&&!((k=C[w])>=D);w++)p.push(k);for(w=D;w<R;w++)p.push(w)}for(w=0;w<p.length;w++)v(r,p[w])}else g(r);return!0}},{"../lib/is_plain_object":504,"../lib/loggers":507,"../lib/noop":512,"../lib/search":523,"../registry":638,"./container_array_match":535}],540:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=r("has-hover"),l=r("../lib"),c=l.nestedProperty,u=r("../lib/events"),f=r("../lib/queue"),h=r("../registry"),p=r("./plot_schema"),d=r("../plots/plots"),m=r("../plots/cartesian/axes"),g=r("../components/drawing"),v=r("../components/color"),y=r("../plots/cartesian/graph_interact").initInteractions,x=r("../constants/xmlns_namespaces"),b=r("../plots/cartesian/select").clearSelect,_=r("./plot_config").dfltConfig,w=r("./manage_arrays"),T=r("./helpers"),k=r("./subroutines"),A=r("./edit_types"),M=r("../plots/cartesian/constants").AX_NAME_PATTERN,S=0;function E(r){var n=r._fullLayout;n._redrawFromAutoMarginCount?n._redrawFromAutoMarginCount--:r.emit("plotly_afterplot")}function L(r,n){try{r._fullLayout._paper.style("background",n)}catch(r){l.error(r)}}function C(r,n){L(r,v.combine(n,"white"))}function P(r,n){if(!r._context){r._context=l.extendDeep({},_);var i=a.select("base");r._context._baseUrl=i.size()&&i.attr("href")?window.location.href.split("#")[0]:""}var o,c,u,f=r._context;if(n){for(c=Object.keys(n),o=0;o<c.length;o++)"editable"!==(u=c[o])&&"edits"!==u&&u in f&&("setBackground"===u&&"opaque"===n[u]?f[u]=C:f[u]=n[u]);n.plot3dPixelRatio&&!f.plotGlPixelRatio&&(f.plotGlPixelRatio=f.plot3dPixelRatio);var h=n.editable;if(void 0!==h)for(f.editable=h,c=Object.keys(f.edits),o=0;o<c.length;o++)f.edits[c[o]]=h;if(n.edits)for(c=Object.keys(n.edits),o=0;o<c.length;o++)(u=c[o])in f.edits&&(f.edits[u]=n.edits[u]);f._exportedPlot=n._exportedPlot}f.staticPlot&&(f.editable=!1,f.edits={},f.autosizable=!1,f.scrollZoom=!1,f.doubleClick=!1,f.showTips=!1,f.showLink=!1,f.displayModeBar=!1),"hover"!==f.displayModeBar||s||(f.displayModeBar=!0),"transparent"!==f.setBackground&&"function"==typeof f.setBackground||(f.setBackground=L),f._hasZeroHeight=f._hasZeroHeight||0===r.clientHeight,f._hasZeroWidth=f._hasZeroWidth||0===r.clientWidth;var p=f.scrollZoom,d=f._scrollZoom={};if(!0===p)d.cartesian=1,d.gl3d=1,d.geo=1,d.mapbox=1;else if("string"==typeof p){var m=p.split("+");for(o=0;o<m.length;o++)d[m[o]]=1}else!1!==p&&(d.gl3d=1,d.geo=1,d.mapbox=1)}function I(r,n){var i,a,o=n+1,s=[];for(i=0;i<r.length;i++)(a=r[i])<0?s.push(o+a):s.push(a);return s}function O(r,n,i){var a,o;for(a=0;a<n.length;a++){if((o=n[a])!==parseInt(o,10))throw Error("all values in "+i+" must be integers");if(o>=r.data.length||o<-r.data.length)throw Error(i+" must be valid indices for gd.data.");if(n.indexOf(o,a+1)>-1||o>=0&&n.indexOf(-r.data.length+o)>-1||o<0&&n.indexOf(r.data.length+o)>-1)throw Error("each index in "+i+" must be unique.")}}function z(r,n,i){if(!Array.isArray(r.data))throw Error("gd.data must be an array.");if(void 0===n)throw Error("currentIndices is a required argument.");if(Array.isArray(n)||(n=[n]),O(r,n,"currentIndices"),void 0===i||Array.isArray(i)||(i=[i]),void 0!==i&&O(r,i,"newIndices"),void 0!==i&&n.length!==i.length)throw Error("current and new indices must be of equal length.")}function D(r,n,i,a,s){!function(r,n,i,a){var o=l.isPlainObject(a);if(!Array.isArray(r.data))throw Error("gd.data must be an array");if(!l.isPlainObject(n))throw Error("update must be a key:value object");if(void 0===i)throw Error("indices must be an integer or array of integers");for(var s in O(r,i,"indices"),n){if(!Array.isArray(n[s])||n[s].length!==i.length)throw Error("attribute "+s+" must be an array of length equal to indices array length");if(o&&(!(s in a)||!Array.isArray(a[s])||a[s].length!==n[s].length))throw Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}(r,n,i,a);for(var u=function(r,n,i,a){var s,u,f,h,p=l.isPlainObject(a),d=[];for(var m in Array.isArray(i)||(i=[i]),i=I(i,r.data.length-1),n)for(var g=0;g<i.length;g++){if(s=(u=c(r.data[i[g]],m)).get(),f=n[m][g],!l.isArrayOrTypedArray(f))throw Error("attribute: "+m+" index: "+g+" must be an array");if(!l.isArrayOrTypedArray(s))throw Error("cannot extend missing or non-array attribute: "+m);if(s.constructor!==f.constructor)throw Error("cannot extend array with an array of a different type: "+m);o(h=p?a[m][g]:a)||(h=-1),d.push({prop:u,target:s,insert:f,maxp:Math.floor(h)})}return d}(r,n,i,a),f={},h={},p=0;p<u.length;p++){var d=u[p].prop,m=u[p].maxp,g=s(u[p].target,u[p].insert,m);d.set(g[0]),Array.isArray(f[d.astr])||(f[d.astr]=[]),f[d.astr].push(g[1]),Array.isArray(h[d.astr])||(h[d.astr]=[]),h[d.astr].push(u[p].target.length)}return{update:f,maxPoints:h}}function R(r,n){var i=new r.constructor(r.length+n.length);return i.set(r),i.set(n,r.length),i}function F(r,n,a,o){r=l.getGraphDiv(r),T.clearPromiseQueue(r);var s={};if("string"==typeof n)s[n]=a;else{if(!l.isPlainObject(n))return l.warn("Restyle fail.",n,a,o),Promise.reject();s=l.extendFlat({},n),void 0===o&&(o=a)}Object.keys(s).length&&(r.changed=!0);var c=T.coerceTraceIndices(r,o),u=U(r,s,c),h=u.flags;h.calc&&(r.calcdata=void 0),h.clearAxisTypes&&T.clearAxisTypes(r,c,{});var p=[];h.fullReplot?p.push(i._doPlot):(p.push(d.previousPromises),d.supplyDefaults(r),h.markerSize&&(d.doCalcdata(r),G(p)),h.style&&p.push(k.doTraceStyle),h.colorbars&&p.push(k.doColorBars),p.push(E)),p.push(d.rehover,d.redrag),f.add(r,F,[r,u.undoit,u.traces],F,[r,u.redoit,u.traces]);var m=l.syncOrAsync(p,r);return m&&m.then||(m=Promise.resolve()),m.then(function(){return r.emit("plotly_restyle",u.eventData),r})}function B(r){return void 0===r?null:r}function N(r,n){return n?function(n,i,a){var o=c(n,i),s=o.set;return o.set=function(n){j((a||"")+i,o.get(),n,r),s(n)},o}:c}function j(r,n,i,a){if(Array.isArray(n)||Array.isArray(i))for(var o=Array.isArray(n)?n:[],s=Array.isArray(i)?i:[],c=Math.max(o.length,s.length),u=0;u<c;u++)j(r+"["+u+"]",o[u],s[u],a);else if(l.isPlainObject(n)||l.isPlainObject(i)){var f=l.isPlainObject(n)?n:{},h=l.isPlainObject(i)?i:{},p=l.extendFlat({},f,h);for(var d in p)j(r+"."+d,f[d],h[d],a)}else void 0===a[r]&&(a[r]=B(n))}function U(r,n,i){var a,o=r._fullLayout,s=r._fullData,u=r.data,f=o._guiEditing,g=N(o._preGUI,f),v=l.extendDeepAll({},n);V(n);var y,x=A.traceFlags(),b={},_={};function w(){return i.map(function(){})}function k(r){var n=m.id2name(r);-1===y.indexOf(n)&&y.push(n)}function M(r){return"LAYOUT"+r+".autorange"}function S(r){return"LAYOUT"+r+".range"}function E(r){for(var n=r;n<s.length;n++)if(s[n]._input===u[r])return s[n]}function L(a,s,l){if(Array.isArray(a))a.forEach(function(r){L(r,s,l)});else if(!(a in n)&&!T.hasParent(n,a)){var c;if("LAYOUT"===a.substr(0,6))c=g(r.layout,a.replace("LAYOUT",""));else{var h=i[l];c=N(o._tracePreGUI[E(h)._fullInput.uid],f)(u[h],a)}a in _||(_[a]=w()),void 0===_[a][l]&&(_[a][l]=B(c.get())),void 0!==s&&c.set(s)}}for(var C in n){if(T.hasParent(n,C))throw Error("cannot set "+C+" and a parent attribute simultaneously");var P,I,O,z,D,R,F=n[C];if("autobinx"!==C&&"autobiny"!==C||(C=C.charAt(C.length-1)+"bins",F=Array.isArray(F)?F.map(function(r){return function(n,a){return!1===n?s[i[a]][r]:null}}(C)):!1===F?i.map(function(r){return function(n){return s[n][r]}}(C)):null),b[C]=F,"LAYOUT"!==C.substr(0,6)){for(_[C]=w(),a=0;a<i.length;a++)if(P=u[i[a]],I=E(i[a]),z=(O=N(o._tracePreGUI[I._fullInput.uid],f)(P,C)).get(),void 0!==(D=Array.isArray(F)?F[a%F.length]:F)){var j=O.parts[O.parts.length-1],U=C.substr(0,C.length-j.length-1),H=U?U+".":"",q=U?c(I,U).get():I;if((R=p.getTraceValObject(I,O.parts))&&R.impliedEdits&&null!==D)for(var G in R.impliedEdits)L(l.relativeAttr(C,G),R.impliedEdits[G],a);else if(("thicknessmode"===j||"lenmode"===j)&&z!==D&&("fraction"===D||"pixels"===D)&&q){var Y=o._size,W=q.orient,X="top"===W||"bottom"===W;if("thicknessmode"===j){var Z=X?Y.h:Y.w;L(H+"thickness",q.thickness*("fraction"===D?1/Z:Z),a)}else{var J=X?Y.w:Y.h;L(H+"len",q.len*("fraction"===D?1/J:J),a)}}else if("type"===C&&("pie"===D!=("pie"===z)||"funnelarea"===D!=("funnelarea"===z))){var K="x",Q="y";"bar"!==D&&"bar"!==z||"h"!==P.orientation||(K="y",Q="x"),l.swapAttrs(P,["?","?src"],"labels",K),l.swapAttrs(P,["d?","?0"],"label",K),l.swapAttrs(P,["?","?src"],"values",Q),"pie"===z||"funnelarea"===z?(c(P,"marker.color").set(c(P,"marker.colors").get()),o._pielayer.selectAll("g.trace").remove()):h.traceIs(P,"cartesian")&&c(P,"marker.colors").set(c(P,"marker.color").get())}if(_[C][a]=B(z),-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(C)){if("orientation"===C){O.set(D);var $=P.x&&!P.y?"h":"v";if((O.get()||$)===I.orientation)continue}else"orientationaxes"===C&&(P.orientation=({v:"h",h:"v"})[I.orientation]);T.swapXYData(P),x.calc=x.clearAxisTypes=!0}else -1!==d.dataArrayContainers.indexOf(O.parts[0])?(T.manageArrayContainers(O,D,_),x.calc=!0):(R?R.arrayOk&&!h.traceIs(I,"regl")&&(l.isArrayOrTypedArray(D)||l.isArrayOrTypedArray(z))?x.calc=!0:A.update(x,R):x.calc=!0,O.set(D))}if(-1!==["swapxyaxes","orientationaxes"].indexOf(C)&&m.swap(r,i),"orientationaxes"===C){var tt=c(r.layout,"hovermode"),te=tt.get();"x"===te?tt.set("y"):"y"===te?tt.set("x"):"x unified"===te?tt.set("y unified"):"y unified"===te&&tt.set("x unified")}if(-1!==["orientation","type"].indexOf(C)){for(y=[],a=0;a<i.length;a++){var tr=u[i[a]];h.traceIs(tr,"cartesian")&&(k(tr.xaxis||"x"),k(tr.yaxis||"y"))}L(y.map(M),!0,0),L(y.map(S),[0,1],0)}}else O=g(r.layout,C.replace("LAYOUT","")),_[C]=[B(O.get())],O.set(Array.isArray(F)?F[0]:F),x.calc=!0}return(x.calc||x.plot)&&(x.fullReplot=!0),{flags:x,undoit:_,redoit:b,traces:i,eventData:l.extendDeepNoArrays([],[v,i])}}function V(r){var n,i,a,o=l.counterRegex("axis",".title",!1,!1),s=/colorbar\.title$/,c=Object.keys(r);for(n=0;n<c.length;n++)a=r[i=c[n]],("title"===i||o.test(i)||s.test(i))&&("string"==typeof a||"number"==typeof a)?u(i,i.replace("title","title.text")):i.indexOf("titlefont")>-1&&-1===i.indexOf("grouptitlefont")?u(i,i.replace("titlefont","title.font")):i.indexOf("titleposition")>-1?u(i,i.replace("titleposition","title.position")):i.indexOf("titleside")>-1?u(i,i.replace("titleside","title.side")):i.indexOf("titleoffset")>-1&&u(i,i.replace("titleoffset","title.offset"));function u(n,i){r[i]=r[n],delete r[n]}}function H(r,n,i){r=l.getGraphDiv(r),T.clearPromiseQueue(r);var a={};if("string"==typeof n)a[n]=i;else{if(!l.isPlainObject(n))return l.warn("Relayout fail.",n,i),Promise.reject();a=l.extendFlat({},n)}Object.keys(a).length&&(r.changed=!0);var o=Z(r,a),s=o.flags;s.calc&&(r.calcdata=void 0);var c=[d.previousPromises];s.layoutReplot?c.push(k.layoutReplot):Object.keys(a).length&&(q(r,s,o)||d.supplyDefaults(r),s.legend&&c.push(k.doLegend),s.layoutstyle&&c.push(k.layoutStyles),s.axrange&&G(c,o.rangesAltered),s.ticks&&c.push(k.doTicksRelayout),s.modebar&&c.push(k.doModeBar),s.camera&&c.push(k.doCamera),s.colorbars&&c.push(k.doColorBars),c.push(E)),c.push(d.rehover,d.redrag),f.add(r,H,[r,o.undoit],H,[r,o.redoit]);var u=l.syncOrAsync(c,r);return u&&u.then||(u=Promise.resolve(r)),u.then(function(){return r.emit("plotly_relayout",o.eventData),r})}function q(r,n,i){var a=r._fullLayout;if(!n.axrange)return!1;for(var o in n)if("axrange"!==o&&n[o])return!1;for(var s in i.rangesAltered){var l=m.id2name(s),c=r.layout[l],u=a[l];if(u.autorange=c.autorange,c.range&&(u.range=c.range.slice()),u.cleanRange(),u._matchGroup){for(var f in u._matchGroup)if(f!==s){var h=a[m.id2name(f)];h.autorange=u.autorange,h.range=u.range.slice(),h._input.range=u.range.slice()}}}return!0}function G(r,n){var i=n?function(r){var i=[],a=!0;for(var o in n){var s=m.getFromId(r,o);if(i.push(o),-1!==(s.ticklabelposition||"").indexOf("inside")&&s._anchorAxis&&i.push(s._anchorAxis._id),s._matchGroup)for(var l in s._matchGroup)n[l]||i.push(l);s.automargin&&(a=!1)}return m.draw(r,i,{skipTitle:a})}:function(r){return m.draw(r,"redraw")};r.push(b,k.doAutoRangeAndConstraints,i,k.drawData,k.finalDraw)}var Y=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,W=/^[xyz]axis[0-9]*\.autorange$/,X=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function Z(r,n){var i,a,o,s=r.layout,u=r._fullLayout,f=u._guiEditing,d=N(u._preGUI,f),g=Object.keys(n),v=m.list(r),y=l.extendDeepAll({},n),x={};for(V(n),g=Object.keys(n),a=0;a<g.length;a++)if(0===g[a].indexOf("allaxes")){for(o=0;o<v.length;o++){var b=v[o]._id.substr(1),_=-1!==b.indexOf("scene")?b+".":"",k=g[a].replace("allaxes",_+v[o]._name);n[k]||(n[k]=n[g[a]])}delete n[g[a]]}var S=A.layoutFlags(),E={},L={};function C(r,i){if(Array.isArray(r))r.forEach(function(r){C(r,i)});else if(!(r in n)&&!T.hasParent(n,r)){var a=d(s,r);r in L||(L[r]=B(a.get())),void 0!==i&&a.set(i)}}var P,I={};function O(r){var n=m.name2id(r.split(".")[0]);return I[n]=1,n}for(var z in n){if(T.hasParent(n,z))throw Error("cannot set "+z+" and a parent attribute simultaneously");for(var D=d(s,z),R=n[z],F=D.parts.length-1;F>0&&"string"!=typeof D.parts[F];)F--;var j=D.parts[F],U=D.parts[F-1]+"."+j,H=D.parts.slice(0,F).join("."),q=c(r.layout,H).get(),G=c(u,H).get(),Z=D.get();if(void 0!==R){E[z]=R,L[z]="reverse"===j?R:B(Z);var K=p.getLayoutValObject(u,D.parts);if(K&&K.impliedEdits&&null!==R)for(var Q in K.impliedEdits)C(l.relativeAttr(z,Q),K.impliedEdits[Q]);if(-1!==["width","height"].indexOf(z)){if(R){C("autosize",null);var $="height"===z?"width":"height";C($,u[$])}else u[z]=r._initialAutoSize[z]}else if("autosize"===z)C("width",R?null:u.width),C("height",R?null:u.height);else if(U.match(Y))O(U),c(u,H+"._inputRange").set(null);else if(U.match(W)){O(U),c(u,H+"._inputRange").set(null);var tt=c(u,H).get();tt._inputDomain&&(tt._input.domain=tt._inputDomain.slice())}else U.match(X)&&c(u,H+"._inputDomain").set(null);if("type"===j){P=q;var te="linear"===G.type&&"log"===R,tr="log"===G.type&&"linear"===R;if(te||tr){if(P&&P.range){if(G.autorange)te&&(P.range=P.range[1]>P.range[0]?[1,2]:[2,1]);else{var tn=P.range[0],ti=P.range[1];te?(tn<=0&&ti<=0&&C(H+".autorange",!0),tn<=0?tn=ti/1e6:ti<=0&&(ti=tn/1e6),C(H+".range[0]",Math.log(tn)/Math.LN10),C(H+".range[1]",Math.log(ti)/Math.LN10)):(C(H+".range[0]",Math.pow(10,tn)),C(H+".range[1]",Math.pow(10,ti)))}}else C(H+".autorange",!0);Array.isArray(u._subplots.polar)&&u._subplots.polar.length&&u[D.parts[0]]&&"radialaxis"===D.parts[1]&&delete u[D.parts[0]]._subplot.viewInitial["radialaxis.range"],h.getComponentMethod("annotations","convertCoords")(r,G,R,C),h.getComponentMethod("images","convertCoords")(r,G,R,C)}else C(H+".autorange",!0),C(H+".range",null);c(u,H+"._inputRange").set(null)}else if(j.match(M)){var ta=c(u,z).get(),to=(R||{}).type;to&&"-"!==to||(to="linear"),h.getComponentMethod("annotations","convertCoords")(r,ta,to,C),h.getComponentMethod("images","convertCoords")(r,ta,to,C)}var ts=w.containerArrayMatch(z);if(ts){i=ts.array,a=ts.index;var tl=ts.property,tc=K||{editType:"calc"};""!==a&&""===tl&&(w.isAddVal(R)?L[z]=null:w.isRemoveVal(R)?L[z]=(c(s,i).get()||[])[a]:l.warn("unrecognized full object value",n)),A.update(S,tc),x[i]||(x[i]={});var tu=x[i][a];tu||(tu=x[i][a]={}),tu[tl]=R,delete n[z]}else"reverse"===j?(q.range?q.range.reverse():(C(H+".autorange",!0),q.range=[1,0]),G.autorange?S.calc=!0:S.plot=!0):(u._has("scatter-like")&&u._has("regl")&&"dragmode"===z&&("lasso"===R||"select"===R)&&"lasso"!==Z&&"select"!==Z||u._has("gl2d")?S.plot=!0:K?A.update(S,K):S.calc=!0,D.set(R))}}for(i in x)w.applyContainerArrayChanges(r,d(s,i),x[i],S,d)||(S.plot=!0);for(var tf in I){var th=(P=m.getFromId(r,tf))&&P._constraintGroup;if(th)for(var tp in S.calc=!0,th)I[tp]||(m.getFromId(r,tp)._constraintShrinkable=!0)}return(J(r)||n.height||n.width)&&(S.plot=!0),(S.plot||S.calc)&&(S.layoutReplot=!0),{flags:S,rangesAltered:I,undoit:L,redoit:E,eventData:y}}function J(r){var n=r._fullLayout,i=n.width,a=n.height;return r.layout.autosize&&d.plotAutoSize(r,r.layout,n),n.width!==i||n.height!==a}function K(r,n,a,o){r=l.getGraphDiv(r),T.clearPromiseQueue(r),l.isPlainObject(n)||(n={}),l.isPlainObject(a)||(a={}),Object.keys(n).length&&(r.changed=!0),Object.keys(a).length&&(r.changed=!0);var s=T.coerceTraceIndices(r,o),c=U(r,l.extendFlat({},n),s),u=c.flags,h=Z(r,l.extendFlat({},a)),p=h.flags;(u.calc||p.calc)&&(r.calcdata=void 0),u.clearAxisTypes&&T.clearAxisTypes(r,s,a);var m=[];p.layoutReplot?m.push(k.layoutReplot):u.fullReplot?m.push(i._doPlot):(m.push(d.previousPromises),q(r,p,h)||d.supplyDefaults(r),u.style&&m.push(k.doTraceStyle),(u.colorbars||p.colorbars)&&m.push(k.doColorBars),p.legend&&m.push(k.doLegend),p.layoutstyle&&m.push(k.layoutStyles),p.axrange&&G(m,h.rangesAltered),p.ticks&&m.push(k.doTicksRelayout),p.modebar&&m.push(k.doModeBar),p.camera&&m.push(k.doCamera),m.push(E)),m.push(d.rehover,d.redrag),f.add(r,K,[r,c.undoit,h.undoit,c.traces],K,[r,c.redoit,h.redoit,c.traces]);var g=l.syncOrAsync(m,r);return g&&g.then||(g=Promise.resolve(r)),g.then(function(){return r.emit("plotly_update",{data:c.eventData,layout:h.eventData}),r})}function Q(r){return function(n){n._fullLayout._guiEditing=!0;var i=r.apply(null,arguments);return n._fullLayout._guiEditing=!1,i}}var $=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],tt=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function te(r,n){for(var i=0;i<n.length;i++){var a=n[i],o=r.match(a.pattern);if(o){var s=o[1]||"";return{head:s,tail:r.substr(s.length+1),attr:a.attr}}}}function tr(r,n){var i=c(n,r).get();if(void 0!==i)return i;var a=r.split(".");for(a.pop();a.length>1;)if(a.pop(),void 0!==(i=c(n,a.join(".")+".uirevision").get()))return i;return n.uirevision}function tn(r,n){var i=l.isPlainObject(r),a=Array.isArray(r);return i||a?(i&&l.isPlainObject(n)||a&&Array.isArray(n))&&JSON.stringify(r)===JSON.stringify(n):r===n}function ti(r,n,i,a){var o,s,u,f=a.getValObject,h=a.flags,p=a.immutable,d=a.inArray,m=a.arrayIndex;function g(){var r=o.editType;d&&-1!==r.indexOf("arraydraw")?l.pushUnique(h.arrays[d],m):(A.update(h,o),"none"!==r&&h.nChanges++,a.transition&&o.anim&&h.nChangesAnim++,(Y.test(u)||W.test(u))&&(h.rangesAltered[i[0]]=1),X.test(u)&&c(n,"_inputDomain").set(null),"datarevision"===s&&(h.newDataRevision=1))}function v(r){return"data_array"===r.valType||r.arrayOk}for(s in r){if(h.calc&&!a.transition)return;var y=r[s],x=n[s],b=i.concat(s);if(u=b.join("."),"_"!==s.charAt(0)&&"function"!=typeof y&&y!==x){if(("tick0"===s||"dtick"===s)&&"geo"!==i[0]){var _=n.tickmode;if("auto"===_||"array"===_||!_)continue}if(("range"!==s||!n.autorange)&&("zmin"!==s&&"zmax"!==s||"contourcarpet"!==n.type)&&(o=f(b))&&(!o._compareAsJSON||JSON.stringify(y)!==JSON.stringify(x))){var w,T=o.valType,k=v(o),M=Array.isArray(y),S=Array.isArray(x);if(M&&S){var E="_input_"+s,L=r[E],C=n[E];if(Array.isArray(L)&&L===C)continue}if(void 0===x)k&&M?h.calc=!0:g();else if(o._isLinkedToArray){var P=[],I=!1;d||(h.arrays[s]=P);var O=Math.min(y.length,x.length),z=Math.max(y.length,x.length);if(O!==z){if("arraydraw"!==o.editType){g();continue}I=!0}for(w=0;w<O;w++)ti(y[w],x[w],b.concat(w),l.extendFlat({inArray:s,arrayIndex:w},a));if(I)for(w=O;w<z;w++)P.push(w)}else!T&&l.isPlainObject(y)?ti(y,x,b,a):k?M&&S?(p&&(h.calc=!0),(p||a.newDataRevision)&&g()):M!==S?h.calc=!0:g():M&&S&&y.length===x.length&&String(y)===String(x)||g()}}}for(s in n)if(!(s in r)&&"_"!==s.charAt(0)&&"function"!=typeof n[s]){if(v(o=f(i.concat(s)))&&Array.isArray(n[s]))return void(h.calc=!0);g()}}function ta(r){var n=r._fullLayout,i=r.getBoundingClientRect();if(!l.equalDomRects(i,n._lastBBox)){var a=n._invTransform=l.inverseTransformMatrix(l.getFullTransformMatrix(r));n._invScaleX=Math.sqrt(a[0][0]*a[0][0]+a[0][1]*a[0][1]+a[0][2]*a[0][2]),n._invScaleY=Math.sqrt(a[1][0]*a[1][0]+a[1][1]*a[1][1]+a[1][2]*a[1][2]),n._lastBBox=i}}i.animate=function(r,n,i){if(r=l.getGraphDiv(r),!l.isPlotDiv(r))throw Error("This element is not a Plotly plot: "+r+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var a=r._transitionData;a._frameQueue||(a._frameQueue=[]);var o=(i=d.supplyAnimationDefaults(i)).transition,s=i.frame;return void 0===a._frameWaitingCnt&&(a._frameWaitingCnt=0),new Promise(function(c,u){var f,h,p=0;function m(r){return Array.isArray(o)?p>=o.length?r.transitionOpts=o[p]:r.transitionOpts=o[0]:r.transitionOpts=o,p++,r}var g=[],v=null==n,y=Array.isArray(n);if(!v&&!y&&l.isPlainObject(n))g.push({type:"object",data:m(l.extendFlat({},n))});else if(v||-1!==["string","number"].indexOf(typeof n))for(f=0;f<a._frames.length;f++)(h=a._frames[f])&&(v||String(h.group)===String(n))&&g.push({type:"byname",name:String(h.name),data:m({name:h.name})});else if(y)for(f=0;f<n.length;f++){var x=n[f];-1!==["number","string"].indexOf(typeof x)?(x=String(x),g.push({type:"byname",name:x,data:m({name:x})})):l.isPlainObject(x)&&g.push({type:"object",data:m(l.extendFlat({},x))})}for(f=0;f<g.length;f++)if("byname"===(h=g[f]).type&&!a._frameHash[h.data.name])return l.warn('animate failure: frame not found: "'+h.data.name+'"'),void u();-1!==["next","immediate"].indexOf(i.mode)&&function(){if(0!==a._frameQueue.length){for(;a._frameQueue.length;){var n=a._frameQueue.pop();n.onInterrupt&&n.onInterrupt()}r.emit("plotly_animationinterrupted",[])}}(),"reverse"===i.direction&&g.reverse();var b=r._fullLayout._currentFrame;if(b&&i.fromcurrent){var _=-1;for(f=0;f<g.length;f++)if("byname"===(h=g[f]).type&&h.name===b){_=f;break}if(_>0&&_<g.length-1){var w=[];for(f=0;f<g.length;f++)h=g[f],("byname"!==g[f].type||f>_)&&w.push(h);g=w}}g.length>0?function(n){if(0!==n.length){for(var l,f=0;f<n.length;f++){m="byname"===n[f].type?d.computeFrame(r,n[f].name):n[f].data;var h,p,m,g=(h=f,Array.isArray(s)?h>=s.length?s[0]:s[h]:s),v=(p=f,Array.isArray(o)?p>=o.length?o[0]:o[p]:o);v.duration=Math.min(v.duration,g.duration);var y={frame:m,name:n[f].name,frameOpts:g,transitionOpts:v};f===n.length-1&&(y.onComplete=function(r,n){var i=0;return function(){if(r&&2==++i)return r()}}(c,0),y.onInterrupt=u),a._frameQueue.push(y)}"immediate"===i.mode&&(a._lastFrameAt=-1/0),a._animationRaf||(r.emit("plotly_animating"),a._lastFrameAt=-1/0,a._timeToNext=0,a._runningTransitions=0,a._currentFrame=null,(l=function(){a._animationRaf=window.requestAnimationFrame(l),Date.now()-a._lastFrameAt>a._timeToNext&&function(){a._currentFrame&&a._currentFrame.onComplete&&a._currentFrame.onComplete();var n=a._currentFrame=a._frameQueue.shift();if(n){var i=n.name?n.name.toString():null;r._fullLayout._currentFrame=i,a._lastFrameAt=Date.now(),a._timeToNext=n.frameOpts.duration,d.transition(r,n.frame.data,n.frame.layout,T.coerceTraceIndices(r,n.frame.traces),n.frameOpts,n.transitionOpts).then(function(){n.onComplete&&n.onComplete()}),r.emit("plotly_animatingframe",{name:i,frame:n.frame,animation:{frame:n.frameOpts,transition:n.transitionOpts}})}else r.emit("plotly_animated"),window.cancelAnimationFrame(a._animationRaf),a._animationRaf=null}()})())}}(g):(r.emit("plotly_animated"),c())})},i.addFrames=function(r,n,i){if(r=l.getGraphDiv(r),null==n)return Promise.resolve();if(!l.isPlotDiv(r))throw Error("This element is not a Plotly plot: "+r+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var a,o,s,c,u=r._transitionData._frames,h=r._transitionData._frameHash;if(!Array.isArray(n))throw Error("addFrames failure: frameList must be an Array of frame definitions"+n);var p=u.length+2*n.length,m=[],g={};for(a=n.length-1;a>=0;a--)if(l.isPlainObject(n[a])){var v=n[a].name,y=(h[v]||g[v]||{}).name,x=n[a].name,b=h[y]||g[y];y&&x&&"number"==typeof x&&b&&S<5&&(S++,l.warn('addFrames: overwriting frame "'+(h[y]||g[y]).name+'" with a frame whose name of type "number" also equates to "'+y+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),5===S&&l.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),g[v]={name:v},m.push({frame:d.supplyFrameDefaults(n[a]),index:i&&void 0!==i[a]&&null!==i[a]?i[a]:p+a})}m.sort(function(r,n){return r.index>n.index?-1:r.index<n.index?1:0});var _=[],w=[],T=u.length;for(a=m.length-1;a>=0;a--){if("number"==typeof(o=m[a].frame).name&&l.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!o.name)for(;h[o.name="frame "+r._transitionData._counter++];);if(h[o.name]){for(s=0;s<u.length&&(u[s]||{}).name!==o.name;s++);_.push({type:"replace",index:s,value:o}),w.unshift({type:"replace",index:s,value:u[s]})}else c=Math.max(0,Math.min(m[a].index,T)),_.push({type:"insert",index:c,value:o}),w.unshift({type:"delete",index:c}),T++}var k=d.modifyFrames,A=d.modifyFrames,M=[r,w],E=[r,_];return f&&f.add(r,k,M,A,E),d.modifyFrames(r,_)},i.deleteFrames=function(r,n){if(r=l.getGraphDiv(r),!l.isPlotDiv(r))throw Error("This element is not a Plotly plot: "+r);var i,a,o=r._transitionData._frames,s=[],c=[];if(!n)for(n=[],i=0;i<o.length;i++)n.push(i);for((n=n.slice()).sort(),i=n.length-1;i>=0;i--)a=n[i],s.push({type:"delete",index:a}),c.unshift({type:"insert",index:a,value:o[a]});var u=d.modifyFrames,h=d.modifyFrames,p=[r,c],m=[r,s];return f&&f.add(r,u,p,h,m),d.modifyFrames(r,s)},i.addTraces=function r(n,a,o){n=l.getGraphDiv(n);var s,c,u=[],h=i.deleteTraces,p=r,d=[n,u],m=[n,a];for(function(r,n,i){var a,o;if(!Array.isArray(r.data))throw Error("gd.data must be an array.");if(void 0===n)throw Error("traces must be defined.");for(Array.isArray(n)||(n=[n]),a=0;a<n.length;a++)if("object"!=typeof(o=n[a])||Array.isArray(o)||null===o)throw Error("all values in traces array must be non-array objects");if(void 0===i||Array.isArray(i)||(i=[i]),void 0!==i&&i.length!==n.length)throw Error("if indices is specified, traces.length must equal indices.length")}(n,a,o),Array.isArray(a)||(a=[a]),a=a.map(function(r){return l.extendFlat({},r)}),T.cleanData(a),s=0;s<a.length;s++)n.data.push(a[s]);for(s=0;s<a.length;s++)u.push(-a.length+s);if(void 0===o)return c=i.redraw(n),f.add(n,h,d,p,m),c;Array.isArray(o)||(o=[o]);try{z(n,u,o)}catch(r){throw n.data.splice(n.data.length-a.length,a.length),r}return f.startSequence(n),f.add(n,h,d,p,m),c=i.moveTraces(n,u,o),f.stopSequence(n),c},i.deleteTraces=function r(n,a){n=l.getGraphDiv(n);var o,s,c=[],u=i.addTraces,h=r,p=[n,c,a],d=[n,a];if(void 0===a)throw Error("indices must be an integer or array of integers.");for(Array.isArray(a)||(a=[a]),O(n,a,"indices"),(a=I(a,n.data.length-1)).sort(l.sorterDes),o=0;o<a.length;o+=1)s=n.data.splice(a[o],1)[0],c.push(s);var m=i.redraw(n);return f.add(n,u,p,h,d),m},i.extendTraces=function r(n,a,o,s){var c=D(n=l.getGraphDiv(n),a,o,s,function(r,n,i){var a,o;if(l.isTypedArray(r)){if(i<0){var s=new r.constructor(0),c=R(r,n);i<0?(a=c,o=s):(a=s,o=c)}else if(a=new r.constructor(i),o=new r.constructor(r.length+n.length-i),i===n.length)a.set(n),o.set(r);else if(i<n.length){var u=n.length-i;a.set(n.subarray(u)),o.set(r),o.set(n.subarray(0,u),r.length)}else{var f=i-n.length,h=r.length-f;a.set(r.subarray(h)),a.set(n,f),o.set(r.subarray(0,h))}}else a=r.concat(n),o=i>=0&&i<a.length?a.splice(0,a.length-i):[];return[a,o]}),u=i.redraw(n),h=[n,c.update,o,c.maxPoints];return f.add(n,i.prependTraces,h,r,arguments),u},i.moveTraces=function r(n,a,o){var s,c=[],u=[],h=r,p=r,d=[n=l.getGraphDiv(n),o,a],m=[n,a,o];if(z(n,a,o),a=Array.isArray(a)?a:[a],void 0===o)for(o=[],s=0;s<a.length;s++)o.push(-a.length+s);for(o=Array.isArray(o)?o:[o],a=I(a,n.data.length-1),o=I(o,n.data.length-1),s=0;s<n.data.length;s++)-1===a.indexOf(s)&&c.push(n.data[s]);for(s=0;s<a.length;s++)u.push({newIndex:o[s],trace:n.data[a[s]]});for(u.sort(function(r,n){return r.newIndex-n.newIndex}),s=0;s<u.length;s+=1)c.splice(u[s].newIndex,0,u[s].trace);n.data=c;var g=i.redraw(n);return f.add(n,h,d,p,m),g},i.prependTraces=function r(n,a,o,s){var c=D(n=l.getGraphDiv(n),a,o,s,function(r,n,i){var a,o;if(l.isTypedArray(r)){if(i<=0){var s=new r.constructor(0),c=R(n,r);i<0?(a=c,o=s):(a=s,o=c)}else if(a=new r.constructor(i),o=new r.constructor(r.length+n.length-i),i===n.length)a.set(n),o.set(r);else if(i<n.length){var u=n.length-i;a.set(n.subarray(0,u)),o.set(n.subarray(u)),o.set(r,u)}else{var f=i-n.length;a.set(n),a.set(r.subarray(0,f),n.length),o.set(r.subarray(f))}}else a=n.concat(r),o=i>=0&&i<a.length?a.splice(i,a.length):[];return[a,o]}),u=i.redraw(n),h=[n,c.update,o,c.maxPoints];return f.add(n,i.extendTraces,h,r,arguments),u},i.newPlot=function(r,n,a,o){return r=l.getGraphDiv(r),d.cleanPlot([],{},r._fullData||[],r._fullLayout||{}),d.purge(r),i._doPlot(r,n,a,o)},i._doPlot=function(r,n,o,s){if(r=l.getGraphDiv(r),u.init(r),l.isPlainObject(n)){var c,f=n;n=f.data,o=f.layout,s=f.config,c=f.frames}if(!1===u.triggerHandler(r,"plotly_beforeplot",[n,o,s]))return Promise.reject();n||o||l.isPlotDiv(r)||l.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",r),P(r,s),o||(o={}),a.select(r).classed("js-plotly-plot",!0),g.makeTester(),Array.isArray(r._promises)||(r._promises=[]);var p=0===(r.data||[]).length&&Array.isArray(n);Array.isArray(n)&&(T.cleanData(n),p?r.data=n:r.data.push.apply(r.data,n),r.empty=!1),r.layout&&!p||(r.layout=T.cleanLayout(o)),d.supplyDefaults(r);var v=r._fullLayout,b=v._has("cartesian");v._replotting=!0,(p||v._shouldCreateBgLayer)&&(function(r){var n=a.select(r),i=r._fullLayout;if(i._calcInverseTransform=ta,i._calcInverseTransform(r),i._container=n.selectAll(".plot-container").data([0]),i._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),i._paperdiv=i._container.selectAll(".svg-container").data([0]),i._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),i._glcontainer=i._paperdiv.selectAll(".gl-container").data([{}]),i._glcontainer.enter().append("div").classed("gl-container",!0),i._paperdiv.selectAll(".main-svg").remove(),i._paperdiv.select(".modebar-container").remove(),i._paper=i._paperdiv.insert("svg",":first-child").classed("main-svg",!0),i._toppaper=i._paperdiv.append("svg").classed("main-svg",!0),i._modebardiv=i._paperdiv.append("div"),delete i._modeBar,i._hoverpaper=i._paperdiv.append("svg").classed("main-svg",!0),!i._uid){var o={};a.selectAll("defs").each(function(){this.id&&(o[this.id.split("-")[1]]=1)}),i._uid=l.randstr(o)}i._paperdiv.selectAll(".main-svg").attr(x.svgAttrs),i._defs=i._paper.append("defs").attr("id","defs-"+i._uid),i._clips=i._defs.append("g").classed("clips",!0),i._topdefs=i._toppaper.append("defs").attr("id","topdefs-"+i._uid),i._topclips=i._topdefs.append("g").classed("clips",!0),i._bgLayer=i._paper.append("g").classed("bglayer",!0),i._draggers=i._paper.append("g").classed("draglayer",!0);var s=i._paper.append("g").classed("layer-below",!0);i._imageLowerLayer=s.append("g").classed("imagelayer",!0),i._shapeLowerLayer=s.append("g").classed("shapelayer",!0),i._cartesianlayer=i._paper.append("g").classed("cartesianlayer",!0),i._polarlayer=i._paper.append("g").classed("polarlayer",!0),i._smithlayer=i._paper.append("g").classed("smithlayer",!0),i._ternarylayer=i._paper.append("g").classed("ternarylayer",!0),i._geolayer=i._paper.append("g").classed("geolayer",!0),i._funnelarealayer=i._paper.append("g").classed("funnelarealayer",!0),i._pielayer=i._paper.append("g").classed("pielayer",!0),i._iciclelayer=i._paper.append("g").classed("iciclelayer",!0),i._treemaplayer=i._paper.append("g").classed("treemaplayer",!0),i._sunburstlayer=i._paper.append("g").classed("sunburstlayer",!0),i._indicatorlayer=i._toppaper.append("g").classed("indicatorlayer",!0),i._glimages=i._paper.append("g").classed("glimages",!0);var c=i._toppaper.append("g").classed("layer-above",!0);i._imageUpperLayer=c.append("g").classed("imagelayer",!0),i._shapeUpperLayer=c.append("g").classed("shapelayer",!0),i._infolayer=i._toppaper.append("g").classed("infolayer",!0),i._menulayer=i._toppaper.append("g").classed("menulayer",!0),i._zoomlayer=i._toppaper.append("g").classed("zoomlayer",!0),i._hoverlayer=i._hoverpaper.append("g").classed("hoverlayer",!0),i._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),r.emit("plotly_framework")}(r),v._shouldCreateBgLayer&&delete v._shouldCreateBgLayer),g.initGradients(r),g.initPatterns(r),p&&m.saveShowSpikeInitial(r);var _=!r.calcdata||r.calcdata.length!==(r._fullData||[]).length;_&&d.doCalcdata(r);for(var w=0;w<r.calcdata.length;w++)r.calcdata[w][0].trace=r._fullData[w];r._context.responsive?r._responsiveChartHandler||(r._responsiveChartHandler=function(){l.isHidden(r)||d.resize(r)},window.addEventListener("resize",r._responsiveChartHandler)):l.clearResponsive(r);var A=l.extendFlat({},v._size),M=0;function S(){if(d.clearAutoMarginIds(r),k.drawMarginPushers(r),m.allowAutoMargin(r),v._has("pie"))for(var n=r._fullData,i=0;i<n.length;i++){var a=n[i];"pie"===a.type&&a.automargin&&d.allowAutoMargin(r,"pie."+a.uid+".automargin")}return d.doAutoMargin(r),d.previousPromises(r)}function L(){r._transitioning||(k.doAutoRangeAndConstraints(r),p&&m.saveRangeInitial(r),h.getComponentMethod("rangeslider","calcAutorange")(r))}var C=[d.previousPromises,function(){if(c)return i.addFrames(r,c)},function n(){for(var i=v._basePlotModules,a=0;a<i.length;a++)i[a].drawFramework&&i[a].drawFramework(r);!v._glcanvas&&v._has("gl")&&(v._glcanvas=v._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(r){return r.key}),v._glcanvas.enter().append("canvas").attr("class",function(r){return"gl-canvas gl-canvas-"+r.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var o=r._context.plotGlPixelRatio;if(v._glcanvas){v._glcanvas.attr("width",v.width*o).attr("height",v.height*o).style("width",v.width+"px").style("height",v.height+"px");var s=v._glcanvas.data()[0].regl;if(s&&(Math.floor(v.width*o)!==s._gl.drawingBufferWidth||Math.floor(v.height*o)!==s._gl.drawingBufferHeight)){var c="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!M)return l.log(c+" Clearing graph and plotting again."),d.cleanPlot([],{},r._fullData,v),d.supplyDefaults(r),v=r._fullLayout,d.doCalcdata(r),M++,n();l.error(c)}}return"h"===v.modebar.orientation?v._modebardiv.style("height",null).style("width","100%"):v._modebardiv.style("width",null).style("height",v.height+"px"),d.previousPromises(r)},S,function(){if(d.didMarginChange(A,v._size))return l.syncOrAsync([S,k.layoutStyles],r)}];b&&C.push(function(){if(_)return l.syncOrAsync([h.getComponentMethod("shapes","calcAutorange"),h.getComponentMethod("annotations","calcAutorange"),L],r);L()}),C.push(k.layoutStyles),b&&C.push(function(){return m.draw(r,p?"":"redraw")},function(r){r._fullLayout._insideTickLabelsAutorange&&H(r,r._fullLayout._insideTickLabelsAutorange).then(function(){r._fullLayout._insideTickLabelsAutorange=void 0})}),C.push(k.drawData,k.finalDraw,y,d.addLinks,d.rehover,d.redrag,d.doAutoMargin,function(r){r._fullLayout._insideTickLabelsAutorange&&p&&m.saveRangeInitial(r,!0)},d.previousPromises);var I=l.syncOrAsync(C,r);return I&&I.then||(I=Promise.resolve()),I.then(function(){return E(r),r})},i.purge=function(r){var n=(r=l.getGraphDiv(r))._fullLayout||{},i=r._fullData||[];return d.cleanPlot([],{},i,n),d.purge(r),u.purge(r),n._container&&n._container.remove(),delete r._context,r},i.react=function(r,n,a,o){r=l.getGraphDiv(r),T.clearPromiseQueue(r);var s,u,f=r._fullData,m=r._fullLayout;if(l.isPlotDiv(r)&&f&&m){if(l.isPlainObject(n)){var g,v,y=n;n=y.data,a=y.layout,o=y.config,s=y.frames}var x=!1;if(o){var b=l.extendDeep({},r._context);r._context=void 0,P(r,o),x=function r(n,i){var a;for(a in n)if("_"!==a.charAt(0)){var o=n[a],s=i[a];if(o!==s){if(l.isPlainObject(o)&&l.isPlainObject(s)){if(r(o,s))return!0}else{if(!Array.isArray(o)||!Array.isArray(s)||o.length!==s.length)return!0;for(var c=0;c<o.length;c++)if(o[c]!==s[c]&&(!l.isPlainObject(o[c])||!l.isPlainObject(s[c])||r(o[c],s[c])))return!0}}}}(b,r._context)}r.data=n||[],T.cleanData(r.data),r.layout=a||{},T.cleanLayout(r.layout),function(r,n,i,a){var o,s,u,f,h,p,d,m,g,v,y=a._preGUI,x=[],b={},_={};for(o in y){if(h=te(o,$)){if(g=h.head,v=h.tail,(f=(u=c(a,s=h.attr||g+".uirevision").get())&&tr(s,n))&&f===u){if(null===(p=y[o])&&(p=void 0),tn(m=(d=c(n,o)).get(),p)){void 0===m&&"autorange"===v&&x.push(g),d.set(B(c(a,o).get()));continue}if("autorange"===v||"range["===v.substr(0,6)){var w=y[g+".range[0]"],T=y[g+".range[1]"],k=y[g+".autorange"];if(k||null===k&&null===w&&null===T){if(!(g in b)){var A=c(n,g).get();b[g]=A&&(A.autorange||!1!==A.autorange&&(!A.range||2!==A.range.length))}if(b[g]){d.set(B(c(a,o).get()));continue}}}}}else l.warn("unrecognized GUI edit: "+o);delete y[o],h&&"range["===h.tail.substr(0,6)&&(_[h.head]=1)}for(var M=0;M<x.length;M++){var S=x[M];if(_[S]){var E=c(n,S).get();E&&delete E.autorange}}var L=a._tracePreGUI;for(var C in L){var P,I=L[C],O=null;for(o in I){if(!O){var z=function(r,n){for(var i=0;i<n.length;i++)if(n[i]._fullInput.uid===r)return i;return -1}(C,i);if(z<0){delete L[C];break}var D=function(r,n,i){for(var a=0;a<n.length;a++)if(n[a].uid===r)return a;return!n[i]||n[i].uid?-1:i}(C,r,(P=i[z]._fullInput).index);if(D<0){delete L[C];break}O=r[D]}if(h=te(o,tt)){if(h.attr?f=(u=c(a,h.attr).get())&&tr(h.attr,n):(u=P.uirevision,void 0===(f=O.uirevision)&&(f=n.uirevision)),f&&f===u&&(null===(p=I[o])&&(p=void 0),tn(m=(d=c(O,o)).get(),p))){d.set(B(c(P,o).get()));continue}}else l.warn("unrecognized GUI edit: "+o+" in trace uid "+C);delete I[o]}}}(r.data,r.layout,f,m),d.supplyDefaults(r,{skipUpdateCalc:!0});var _=r._fullData,w=r._fullLayout,M=void 0===w.datarevision,S=w.transition,L=(g=r,(v=A.layoutFlags()).arrays={},v.rangesAltered={},v.nChanges=0,v.nChangesAnim=0,ti(m,w,[],{getValObject:function(r){return p.getLayoutValObject(w,r)},flags:v,immutable:M,transition:S,gd:g}),(v.plot||v.calc)&&(v.layoutReplot=!0),S&&v.nChanges&&v.nChangesAnim&&(v.anim=v.nChanges===v.nChangesAnim?"all":"some"),v),C=L.newDataRevision,I=function(r,n,i,a,o,s){var l=n.length===i.length;if(!o&&!l)return{fullReplot:!0,calc:!0};var c,u,f=A.traceFlags();f.arrays={},f.nChanges=0,f.nChangesAnim=0;var h={getValObject:function(r){var n=p.getTraceValObject(u,r);return!u._module.animatable&&n.anim&&(n.anim=!1),n},flags:f,immutable:a,transition:o,newDataRevision:s,gd:r},m={};for(c=0;c<n.length;c++)if(i[c]){if(u=i[c]._fullInput,d.hasMakesDataTransform(u)&&(u=i[c]),m[u.uid])continue;m[u.uid]=1,ti(n[c]._fullInput,u,[],h)}return(f.calc||f.plot)&&(f.fullReplot=!0),o&&f.nChanges&&f.nChangesAnim&&(f.anim=f.nChanges===f.nChangesAnim&&l?"all":"some"),f}(r,f,_,M,S,C);if(J(r)&&(L.layoutReplot=!0),I.calc||L.calc){r.calcdata=void 0;for(var O=Object.getOwnPropertyNames(w),z=0;z<O.length;z++){var D=O[z],R=D.substring(0,5);if("xaxis"===R||"yaxis"===R){var F=w[D]._emptyCategories;F&&F()}}}else d.supplyDefaultsUpdateCalc(r.calcdata,_);var N=[];if(s&&(r._transitionData={},d.createTransitionData(r),N.push(function(){return i.addFrames(r,s)})),w.transition&&!x&&(I.anim||L.anim))L.ticks&&N.push(k.doTicksRelayout),d.doCalcdata(r),k.doAutoRangeAndConstraints(r),N.push(function(){return d.transitionFromReact(r,I,L,m)});else if(I.fullReplot||L.layoutReplot||x)r._fullLayout._skipDefaults=!0,N.push(i._doPlot);else{for(var j in L.arrays){var U=L.arrays[j];if(U.length){var V=h.getComponentMethod(j,"drawOne");if(V!==l.noop)for(var H=0;H<U.length;H++)V(r,U[H]);else{var q=h.getComponentMethod(j,"draw");if(q===l.noop)throw Error("cannot draw components: "+j);q(r)}}}N.push(d.previousPromises),I.style&&N.push(k.doTraceStyle),(I.colorbars||L.colorbars)&&N.push(k.doColorBars),L.legend&&N.push(k.doLegend),L.layoutstyle&&N.push(k.layoutStyles),L.axrange&&G(N),L.ticks&&N.push(k.doTicksRelayout),L.modebar&&N.push(k.doModeBar),L.camera&&N.push(k.doCamera),N.push(E)}N.push(d.rehover,d.redrag),(u=l.syncOrAsync(N,r))&&u.then||(u=Promise.resolve(r))}else u=i.newPlot(r,n,a,o);return u.then(function(){return r.emit("plotly_react",{data:n,layout:a}),r})},i.redraw=function(r){if(r=l.getGraphDiv(r),!l.isPlotDiv(r))throw Error("This element is not a Plotly plot: "+r);return T.cleanData(r.data),T.cleanLayout(r.layout),r.calcdata=void 0,i._doPlot(r).then(function(){return r.emit("plotly_redraw"),r})},i.relayout=H,i.restyle=F,i.setPlotConfig=function(r){return l.extendFlat(_,r)},i.update=K,i._guiRelayout=Q(H),i._guiRestyle=Q(F),i._guiUpdate=Q(K),i._storeDirectGUIEdit=function(r,n,i){for(var a in i)j(a,c(r,a).get(),i[a],n)}},{"../components/color":366,"../components/drawing":388,"../constants/xmlns_namespaces":480,"../lib":503,"../lib/events":492,"../lib/queue":519,"../plots/cartesian/axes":554,"../plots/cartesian/constants":561,"../plots/cartesian/graph_interact":564,"../plots/cartesian/select":575,"../plots/plots":619,"../registry":638,"./edit_types":536,"./helpers":537,"./manage_arrays":539,"./plot_config":541,"./plot_schema":542,"./subroutines":544,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],541:[function(r,n,i){"use strict";var a={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},o={};(function r(n,i){for(var a in n){var o=n[a];o.valType?i[a]=o.dflt:(i[a]||(i[a]={}),r(o,i[a]))}})(a,o),n.exports={configAttributes:a,dfltConfig:o}},{}],542:[function(r,n,i){"use strict";var a=r("../registry"),o=r("../lib"),s=r("../plots/attributes"),l=r("../plots/layout_attributes"),c=r("../plots/frame_attributes"),u=r("../plots/animation_attributes"),f=r("./plot_config").configAttributes,h=r("./edit_types"),p=o.extendDeepAll,d=o.isPlainObject,m=o.isArrayOrTypedArray,g=o.nestedProperty,v=o.valObjectMeta,y=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function x(r,n,i){if(!r)return!1;if(r._isLinkedToArray){if(b(n[i]))i++;else if(i<n.length)return!1}for(;i<n.length;i++){var a=r[n[i]];if(!d(a)||(r=a,i===n.length-1))break;if(r._isLinkedToArray){if(!b(n[++i]))return!1}else if("info_array"===r.valType){var o=n[++i];if(!b(o))return!1;var s=r.items;if(Array.isArray(s)){if(o>=s.length)return!1;if(2===r.dimensions){if(i++,n.length===i)return r;var l=n[i];if(!b(l))return!1;r=s[o][l]}else r=s[o]}else r=s}}return r}function b(r){return r===Math.round(r)&&r>=0}function _(r){return i.crawl(r,function(r,n,a){i.isValObject(r)?!0!==r.arrayOk&&"data_array"!==r.valType||(a[n+"src"]={valType:"string",editType:"none"}):d(r)&&(r.role="object")}),i.crawl(r,function(r,n,i){if(r){var a=r._isLinkedToArray;a&&(delete r._isLinkedToArray,i[n]={items:{}},i[n].items[a]=r,i[n].role="object")}}),function r(n){for(var i in n)if(d(n[i]))r(n[i]);else if(Array.isArray(n[i]))for(var a=0;a<n[i].length;a++)r(n[i][a]);else n[i]instanceof RegExp&&(n[i]=n[i].toString())}(r),r}function w(r,n,i){var a=g(r,i),o=p({},n.layoutAttributes);o._isSubplotObj=!0,a.set(o)}function T(r,n,i){var a=g(r,i);a.set(p(a.get()||{},n))}i.IS_SUBPLOT_OBJ="_isSubplotObj",i.IS_LINKED_TO_ARRAY="_isLinkedToArray",i.DEPRECATED="_deprecated",i.UNDERSCORE_ATTRS=y,i.get=function(){var r,n={};a.allTypes.forEach(function(r){n[r]=function(r){o=(n=a.modules[r]._module).basePlotModule;var n,o,l={type:null},c=p({},s),u=p({},n.attributes);i.crawl(u,function(r,n,i,a,o){g(c,o).set(void 0),void 0===r&&g(u,o).set(void 0)}),p(l,c),a.traceIs(r,"noOpacity")&&delete l.opacity,a.traceIs(r,"showLegend")||(delete l.showlegend,delete l.legendgroup),a.traceIs(r,"noHover")&&(delete l.hoverinfo,delete l.hoverlabel),n.selectPoints||delete l.selectedpoints,p(l,u),o.attributes&&p(l,o.attributes),l.type=r;var f={meta:n.meta||{},categories:n.categories||{},animatable:!!n.animatable,type:r,attributes:_(l)};if(n.layoutAttributes){var h={};p(h,n.layoutAttributes),f.layoutAttributes=_(h)}return n.animatable||i.crawl(f,function(r){i.isValObject(r)&&"anim"in r&&delete r.anim}),f}(r)});var o={};return Object.keys(a.transformsRegistry).forEach(function(r){var n;o[r]=(n=p({},a.transformsRegistry[r].attributes),Object.keys(a.componentsRegistry).forEach(function(i){var o=a.componentsRegistry[i];o.schema&&o.schema.transforms&&o.schema.transforms[r]&&Object.keys(o.schema.transforms[r]).forEach(function(i){T(n,o.schema.transforms[r][i],i)})}),{attributes:_(n)})}),{defs:{valObjects:v,metaKeys:y.concat(["description","role","editType","impliedEdits"]),editType:{traces:h.traces,layout:h.layout},impliedEdits:{}},traces:n,layout:function(){var r,n,i={};for(r in p(i,l),a.subplotsRegistry)if((n=a.subplotsRegistry[r]).layoutAttributes){if(Array.isArray(n.attr))for(var o=0;o<n.attr.length;o++)w(i,n,n.attr[o]);else w(i,n,"subplot"===n.attr?n.name:n.attr)}for(r in a.componentsRegistry){var s=(n=a.componentsRegistry[r]).schema;if(s&&(s.subplots||s.layout)){var c=s.subplots;if(c&&c.xaxis&&!c.yaxis)for(var u in c.xaxis)delete i.yaxis[u]}else"colorscale"===n.name?p(i,n.layoutAttributes):n.layoutAttributes&&T(i,n.layoutAttributes,n.name)}return{layoutAttributes:_(i)}}(),transforms:o,frames:(_(r={frames:p({},c)}),r.frames),animation:_(u),config:_(f)}},i.crawl=function(r,n,a,o){var s=a||0;o=o||"",Object.keys(r).forEach(function(a){var l=r[a];if(-1===y.indexOf(a)){var c=(o?o+".":"")+a;n(l,a,r,s,c),i.isValObject(l)||d(l)&&"impliedEdits"!==a&&i.crawl(l,n,s+1,c)}})},i.isValObject=function(r){return r&&void 0!==r.valType},i.findArrayAttributes=function(r){var n,a,o=[],l=[],c=[];function u(r,i,s,u){l=l.slice(0,u).concat([i]),c=c.slice(0,u).concat([r&&r._isLinkedToArray]),r&&("data_array"===r.valType||!0===r.arrayOk)&&!("colorbar"===l[u-1]&&("ticktext"===i||"tickvals"===i))&&function r(n,i,s){var u=n[l[i]],f=s+l[i];if(i===l.length-1)m(u)&&o.push(a+f);else if(c[i]){if(Array.isArray(u))for(var h=0;h<u.length;h++)d(u[h])&&r(u[h],i+1,f+"["+h+"].")}else d(u)&&r(u,i+1,f+".")}(n,0,"")}n=r,a="",i.crawl(s,u),r._module&&r._module.attributes&&i.crawl(r._module.attributes,u);var f=r.transforms;if(f)for(var h=0;h<f.length;h++){var p=f[h],g=p._module;g&&(a="transforms["+h+"].",n=p,i.crawl(g.attributes,u))}return o},i.getTraceValObject=function(r,n){var i,o,l=n[0],c=1;if("transforms"===l){if(1===n.length)return s.transforms;var u=r.transforms;if(!Array.isArray(u)||!u.length)return!1;var f=n[1];if(!b(f)||f>=u.length)return!1;o=(i=(a.transformsRegistry[u[f].type]||{}).attributes)&&i[n[2]],c=3}else{var h=r._module;if(h||(h=(a.modules[r.type||s.type.dflt]||{})._module),!h)return!1;if(!(o=(i=h.attributes)&&i[l])){var p=h.basePlotModule;p&&p.attributes&&(o=p.attributes[l])}o||(o=s[l])}return x(o,n,c)},i.getLayoutValObject=function(r,n){return x(function(r,n){var i,o,s,c,u,f=r._basePlotModules;if(f){for(o=0;o<f.length;o++){if((c=f[o]).attrRegex&&c.attrRegex.test(n)){if(c.layoutAttrOverrides)return c.layoutAttrOverrides;!i&&c.layoutAttributes&&(i=c.layoutAttributes)}var h=c.baseLayoutAttrOverrides;if(h&&n in h)return h[n]}if(i)return i}var p=r._modules;if(p){for(o=0;o<p.length;o++)if((u=p[o].layoutAttributes)&&n in u)return u[n]}for(s in a.componentsRegistry){if("colorscale"===(c=a.componentsRegistry[s]).name&&0===n.indexOf("coloraxis"))return c.layoutAttributes[n];if(!c.schema&&n===c.name)return c.layoutAttributes}return n in l&&l[n]}(r,n[0]),n,1)}},{"../lib":503,"../plots/animation_attributes":548,"../plots/attributes":550,"../plots/frame_attributes":586,"../plots/layout_attributes":610,"../registry":638,"./edit_types":536,"./plot_config":541}],543:[function(r,n,i){"use strict";var a=r("../lib"),o=r("../plots/attributes"),s={name:{valType:"string",editType:"none"}};function l(r){return r&&"string"==typeof r}function c(r){var n=r.length-1;return"s"!==r.charAt(n)&&a.warn("bad argument to arrayDefaultKey: "+r),r.substr(0,r.length-1)+"defaults"}s.templateitemname={valType:"string",editType:"calc"},i.templatedArray=function(r,n){return n._isLinkedToArray=r,n.name=s.name,n.templateitemname=s.templateitemname,n},i.traceTemplater=function(r){var n,i,s={};for(n in r)Array.isArray(i=r[n])&&i.length&&(s[n]=0);return{newTrace:function(l){var c={type:n=a.coerce(l,{},o,"type"),_template:null};if(n in s){i=r[n];var u=s[n]%i.length;s[n]++,c._template=i[u]}return c}}},i.newContainer=function(r,n,i){var o=r._template,s=o&&(o[n]||i&&o[i]);return a.isPlainObject(s)||(s=null),r[n]={_template:s}},i.arrayTemplater=function(r,n,i){var a=r._template,o=a&&a[c(n)],s=a&&a[n];Array.isArray(s)&&s.length||(s=[]);var u={};return{newItem:function(r){var n={name:r.name,_input:r},a=n.templateitemname=r.templateitemname;if(!l(a))return n._template=o,n;for(var c=0;c<s.length;c++){var f=s[c];if(f.name===a)return u[a]=1,n._template=f,n}return n[i]=r[i]||!1,n._template=!1,n},defaultItems:function(){for(var r=[],n=0;n<s.length;n++){var i=s[n],a=i.name;if(l(a)&&!u[a]){var o={_template:i,name:a,_input:{_templateitemname:a}};o.templateitemname=i.templateitemname,r.push(o),u[a]=1}}return r}}},i.arrayDefaultKey=c,i.arrayEditor=function(r,n,i){var o=(a.nestedProperty(r,n).get()||[]).length,s=i._index,l=s>=o&&(i._input||{})._templateitemname;l&&(s=o);var c,u=n+"["+s+"]";function f(){c={},l&&(c[u]={},c[u].templateitemname=l)}function h(r,n){l?a.nestedProperty(c[u],r).set(n):c[u+"."+r]=n}function p(){var r=c;return f(),r}return f(),{modifyBase:function(r,n){c[r]=n},modifyItem:h,getUpdateObj:p,applyUpdate:function(n,i){n&&h(n,i);var o=p();for(var s in o)a.nestedProperty(r,s).set(o[s])}}}},{"../lib":503,"../plots/attributes":550}],544:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../registry"),s=r("../plots/plots"),l=r("../lib"),c=r("../lib/clear_gl_canvases"),u=r("../components/color"),f=r("../components/drawing"),h=r("../components/titles"),p=r("../components/modebar"),d=r("../plots/cartesian/axes"),m=r("../constants/alignment"),g=r("../plots/cartesian/constraints"),v=g.enforce,y=g.clean,x=r("../plots/cartesian/autorange").doAutoRange;function b(r){var n,o,c,h,g,v,y=r._fullLayout,x=y._size,b=x.p,w=d.list(r,"",!0);if(y._paperdiv.style({width:r._context.responsive&&y.autosize&&!r._context._hasZeroWidth&&!r.layout.width?"100%":y.width+"px",height:r._context.responsive&&y.autosize&&!r._context._hasZeroHeight&&!r.layout.height?"100%":y.height+"px"}).selectAll(".main-svg").call(f.setSize,y.width,y.height),r._context.setBackground(r,y.paper_bgcolor),i.drawMainTitle(r),p.manage(r),!y._has("cartesian"))return s.previousPromises(r);function k(r,n,i){var a=r._lw/2;return"x"===r._id.charAt(0)?n?"top"===i?n._offset-b-a:n._offset+n._length+b+a:x.t+x.h*(1-(r.position||0))+a%1:n?"right"===i?n._offset+n._length+b+a:n._offset-b-a:x.l+x.w*(r.position||0)+a%1}for(n=0;n<w.length;n++){var A=(h=w[n])._anchorAxis;h._linepositions={},h._lw=f.crispRound(r,h.linewidth,1),h._mainLinePosition=k(h,A,h.side),h._mainMirrorPosition=h.mirror&&A?k(h,A,m.OPPOSITE_SIDE[h.side]):null}var M=[],S=[],E=[],L=1===u.opacity(y.paper_bgcolor)&&1===u.opacity(y.plot_bgcolor)&&y.paper_bgcolor===y.plot_bgcolor;for(o in y._plots)if((c=y._plots[o]).mainplot)c.bg&&c.bg.remove(),c.bg=void 0;else{var C=c.xaxis.domain,P=c.yaxis.domain,I=c.plotgroup;if(function(r,n,i){for(var a=0;a<i.length;a++){var o=i[a][0],s=i[a][1];if(!(o[0]>=r[1]||o[1]<=r[0])&&s[0]<n[1]&&s[1]>n[0])return!0}return!1}(C,P,E)){var O=I.node(),z=c.bg=l.ensureSingle(I,"rect","bg");O.insertBefore(z.node(),O.childNodes[0]),S.push(o)}else I.select("rect.bg").remove(),E.push([C,P]),L||(M.push(o),S.push(o))}var D,R,F,B,N,j,U,V,H,q,G,Y,W,X=y._bgLayer.selectAll(".bg").data(M);for(X.enter().append("rect").classed("bg",!0),X.exit().remove(),X.each(function(r){y._plots[r].bg=a.select(this)}),n=0;n<S.length;n++)g=(c=y._plots[S[n]]).xaxis,v=c.yaxis,c.bg&&void 0!==g._offset&&void 0!==v._offset&&c.bg.call(f.setRect,g._offset-b,v._offset-b,g._length+2*b,v._length+2*b).call(u.fill,y.plot_bgcolor).style("stroke-width",0);if(!y._hasOnlyLargeSploms)for(o in y._plots){g=(c=y._plots[o]).xaxis,v=c.yaxis;var Z,J,K=c.clipId="clip"+y._uid+o+"plot",Q=l.ensureSingleById(y._clips,"clipPath",K,function(r){r.classed("plotclip",!0).append("rect")});c.clipRect=Q.select("rect").attr({width:g._length,height:v._length}),f.setTranslate(c.plot,g._offset,v._offset),c._hasClipOnAxisFalse?(Z=null,J=K):(Z=K,J=null),f.setClipUrl(c.plot,Z,r),c.layerClipId=J}function $(r){return"M"+D+","+r+"H"+R}function tt(r){return"M"+g._offset+","+r+"h"+g._length}function te(r){return"M"+r+","+V+"V"+U}function tr(r){return"M"+r+","+v._offset+"v"+v._length}function tn(r,n,i){if(!r.showline||o!==r._mainSubplot)return"";if(!r._anchorAxis)return i(r._mainLinePosition);var a=n(r._mainLinePosition);return r.mirror&&(a+=n(r._mainMirrorPosition)),a}for(o in y._plots){g=(c=y._plots[o]).xaxis,v=c.yaxis;var ti="M0,0";_(g,o)&&(N=T(g,"left",v,w),D=g._offset-(N?b+N:0),j=T(g,"right",v,w),R=g._offset+g._length+(j?b+j:0),F=k(g,v,"bottom"),B=k(g,v,"top"),(W=!g._anchorAxis||o!==g._mainSubplot)&&("allticks"===g.mirror||"all"===g.mirror)&&(g._linepositions[o]=[F,B]),ti=tn(g,$,tt),W&&g.showline&&("all"===g.mirror||"allticks"===g.mirror)&&(ti+=$(F)+$(B)),c.xlines.style("stroke-width",g._lw+"px").call(u.stroke,g.showline?g.linecolor:"rgba(0,0,0,0)")),c.xlines.attr("d",ti);var ta="M0,0";_(v,o)&&(G=T(v,"bottom",g,w),U=v._offset+v._length+(G?b:0),Y=T(v,"top",g,w),V=v._offset-(Y?b:0),H=k(v,g,"left"),q=k(v,g,"right"),(W=!v._anchorAxis||o!==v._mainSubplot)&&("allticks"===v.mirror||"all"===v.mirror)&&(v._linepositions[o]=[H,q]),ta=tn(v,te,tr),W&&v.showline&&("all"===v.mirror||"allticks"===v.mirror)&&(ta+=te(H)+te(q)),c.ylines.style("stroke-width",v._lw+"px").call(u.stroke,v.showline?v.linecolor:"rgba(0,0,0,0)")),c.ylines.attr("d",ta)}return d.makeClipPaths(r),s.previousPromises(r)}function _(r,n){return(r.ticks||r.showline)&&(n===r._mainSubplot||"all"===r.mirror||"allticks"===r.mirror)}function w(r,n,i){if(!i.showline||!i._lw)return!1;if("all"===i.mirror||"allticks"===i.mirror)return!0;var a=i._anchorAxis;if(!a)return!1;var o=m.FROM_BL[n];return i.side===n?a.domain[o]===r.domain[o]:i.mirror&&a.domain[1-o]===r.domain[1-o]}function T(r,n,i,a){if(w(r,n,i))return i._lw;for(var o=0;o<a.length;o++){var s=a[o];if(s._mainAxis===i._mainAxis&&w(r,n,s))return s._lw}return 0}i.layoutStyles=function(r){return l.syncOrAsync([s.doAutoMargin,b],r)},i.drawMainTitle=function(r){var n,i,a,o,s,c,u,f,p,d,g=r._fullLayout,v=(u=g.title,f="middle",l.isRightAnchor(u)?f="end":l.isLeftAnchor(u)&&(f="start"),f),y=(p=g.title,d="0em",l.isTopAnchor(p)?d=m.CAP_SHIFT+"em":l.isMiddleAnchor(p)&&(d=m.MID_SHIFT+"em"),d);h.draw(r,"gtitle",{propContainer:g,propName:"title.text",placeholder:g._dfltTitle.plot,attributes:{x:(n=g.title,i=g._size,a=0,("start"===v?a=n.pad.l:"end"===v&&(a=-n.pad.r),"paper"===n.xref)?i.l+i.w*n.x+a:g.width*n.x+a),y:(o=g.title,s=g._size,c=0,("0em"!==y&&y?y===m.CAP_SHIFT+"em"&&(c=o.pad.t):c=-o.pad.b,"auto"===o.y)?s.t/2:"paper"===o.yref?s.t+s.h-s.h*o.y+c:g.height-g.height*o.y+c),"text-anchor":v,dy:y}})},i.doTraceStyle=function(r){var n,a=r.calcdata,l=[];for(n=0;n<a.length;n++){var u=a[n],f=u[0]||{},h=f.trace||{},p=h._module||{},d=p.arraysToCalcdata;d&&d(u,h);var m=p.editStyle;m&&l.push({fn:m,cd0:f})}if(l.length){for(n=0;n<l.length;n++){var g=l[n];g.fn(r,g.cd0)}c(r),i.redrawReglTraces(r)}return s.style(r),o.getComponentMethod("legend","draw")(r),s.previousPromises(r)},i.doColorBars=function(r){return o.getComponentMethod("colorbar","draw")(r),s.previousPromises(r)},i.layoutReplot=function(r){var n=r.layout;return r.layout=void 0,o.call("_doPlot",r,"",n)},i.doLegend=function(r){return o.getComponentMethod("legend","draw")(r),s.previousPromises(r)},i.doTicksRelayout=function(r){return d.draw(r,"redraw"),r._fullLayout._hasOnlyLargeSploms&&(o.subplotsRegistry.splom.updateGrid(r),c(r),i.redrawReglTraces(r)),i.drawMainTitle(r),s.previousPromises(r)},i.doModeBar=function(r){var n=r._fullLayout;p.manage(r);for(var i=0;i<n._basePlotModules.length;i++){var a=n._basePlotModules[i].updateFx;a&&a(r)}return s.previousPromises(r)},i.doCamera=function(r){for(var n=r._fullLayout,i=n._subplots.gl3d,a=0;a<i.length;a++){var o=n[i[a]];o._scene.setViewport(o)}},i.drawData=function(r){var n=r._fullLayout;c(r);for(var a=n._basePlotModules,l=0;l<a.length;l++)a[l].plot(r);return i.redrawReglTraces(r),s.style(r),o.getComponentMethod("shapes","draw")(r),o.getComponentMethod("annotations","draw")(r),o.getComponentMethod("images","draw")(r),n._replotting=!1,s.previousPromises(r)},i.redrawReglTraces=function(r){var n=r._fullLayout;if(n._has("regl")){var i,a,o=r._fullData,s=[],c=[];for(n._hasOnlyLargeSploms&&n._splomGrid.draw(),i=0;i<o.length;i++){var u=o[i];!0===u.visible&&0!==u._length&&("splom"===u.type?n._splomScenes[u.uid].draw():"scattergl"===u.type?l.pushUnique(s,u.xaxis+u.yaxis):"scatterpolargl"===u.type&&l.pushUnique(c,u.subplot))}for(i=0;i<s.length;i++)(a=n._plots[s[i]])._scene&&a._scene.draw();for(i=0;i<c.length;i++)(a=n[c[i]]._subplot)._scene&&a._scene.draw()}},i.doAutoRangeAndConstraints=function(r){for(var n,i=d.list(r,"",!0),a={},o=0;o<i.length;o++)if(!a[(n=i[o])._id]){a[n._id]=1,y(r,n),x(r,n);var s=n._matchGroup;if(s)for(var l in s){var c=d.getFromId(r,l);x(r,c,n.range),a[l]=1}}v(r)},i.finalDraw=function(r){o.getComponentMethod("rangeslider","draw")(r),o.getComponentMethod("rangeselector","draw")(r)},i.drawMarginPushers=function(r){o.getComponentMethod("legend","draw")(r),o.getComponentMethod("rangeselector","draw")(r),o.getComponentMethod("sliders","draw")(r),o.getComponentMethod("updatemenus","draw")(r),o.getComponentMethod("colorbar","draw")(r)}},{"../components/color":366,"../components/drawing":388,"../components/modebar":429,"../components/titles":464,"../constants/alignment":471,"../lib":503,"../lib/clear_gl_canvases":487,"../plots/cartesian/autorange":553,"../plots/cartesian/axes":554,"../plots/cartesian/constraints":562,"../plots/plots":619,"../registry":638,"@plotly/d3":58}],545:[function(r,n,i){"use strict";var a=r("../lib"),o=a.isPlainObject,s=r("./plot_schema"),l=r("../plots/plots"),c=r("../plots/attributes"),u=r("./plot_template"),f=r("./plot_config").dfltConfig;function h(r,n){var i,s,l=Object.keys(r=a.extendDeep({},r)).sort();function c(n,i,a){if(o(i)&&o(n))h(n,i);else if(Array.isArray(i)&&Array.isArray(n)){var l=u.arrayTemplater({_template:r},a);for(s=0;s<i.length;s++){var c=i[s],f=l.newItem(c)._template;f&&h(f,c)}var p=l.defaultItems();for(s=0;s<p.length;s++)i.push(p[s]._template);for(s=0;s<i.length;s++)delete i[s].templateitemname}}for(i=0;i<l.length;i++){var f=l[i],d=r[f];if(f in n?c(d,n[f],f):n[f]=d,p(f)===f)for(var m in n){var g=p(m);m===g||g!==f||m in r||c(d,n[m],f)}}}function p(r){return r.replace(/[0-9]+$/,"")}function d(r,n,i,s,l){var c=l&&i(l);for(var f in r){var h=r[f],m=v(r,f,s),g=v(r,f,l),y=i(g);if(!y){var x=p(f);x!==f&&(y=i(g=v(r,x,l)))}if((!c||c!==y)&&!(!y||y._noTemplating||"data_array"===y.valType||y.arrayOk&&Array.isArray(h))){if(!y.valType&&o(h))d(h,n,i,m,g);else if(y._isLinkedToArray&&Array.isArray(h))for(var b=!1,_=0,w={},T=0;T<h.length;T++){var k=h[T];if(o(k)){var A=k.name;if(A)w[A]||(d(k,n,i,v(h,_,m),v(h,_,g)),_++,w[A]=1);else if(!b){var M=v(r,u.arrayDefaultKey(f),s),S=v(h,_,m);d(k,n,i,S,v(h,_,g));var E=a.nestedProperty(n,S);a.nestedProperty(n,M).set(E.get()),E.set(null),b=!0}}}else a.nestedProperty(n,m).set(h)}}}function m(r,n){return s.getLayoutValObject(r,a.nestedProperty({},n).parts)}function g(r,n){return s.getTraceValObject(r,a.nestedProperty({},n).parts)}function v(r,n,i){return i?Array.isArray(r)?i+"["+n+"]":i+"."+n:n}function y(r){var n;switch(r.code){case"data":n="The template has no key data.";break;case"layout":n="The template has no key layout.";break;case"missing":n=r.path?"There are no templates for item "+r.path+" with name "+r.templateitemname:"There are no templates for trace "+r.index+", of type "+r.traceType+".";break;case"unused":n=r.path?"The template item at "+r.path+" was not used in constructing the plot.":r.dataCount?"Some of the templates of type "+r.traceType+" were not used. The template has "+r.templateCount+" traces, the data only has "+r.dataCount+" of this type.":"The template has "+r.templateCount+" traces of type "+r.traceType+" but there are none in the data.";break;case"reused":n="Some of the templates of type "+r.traceType+" were used more than once. The template has "+r.templateCount+" traces, the data has "+r.dataCount+" of this type."}return r.msg=n,r}i.makeTemplate=function(r){r=a.isPlainObject(r)?r:a.getGraphDiv(r),r=a.extendDeep({_context:f},{data:r.data,layout:r.layout}),l.supplyDefaults(r);var n=r.data||[],i=r.layout||{};i._basePlotModules=r._fullLayout._basePlotModules,i._modules=r._fullLayout._modules;var s={data:{},layout:{}};n.forEach(function(r){var n={};d(r,n,g.bind(null,r));var i=a.coerce(r,{},c,"type"),o=s.data[i];o||(o=s.data[i]=[]),o.push(n)}),d(i,s.layout,m.bind(null,i)),delete s.layout.template;var u=i.template;if(o(u)){var p,v,y,x,b,_,w=u.layout;o(w)&&h(w,s.layout);var T=u.data;if(o(T)){for(v in s.data)if(Array.isArray(y=T[v])){for(_=(b=s.data[v]).length,x=y.length,p=0;p<_;p++)h(y[p%x],b[p]);for(p=_;p<x;p++)b.push(a.extendDeep({},y[p]))}for(v in T)v in s.data||(s.data[v]=a.extendDeep([],T[v]))}}return s},i.validateTemplate=function(r,n){var i=a.extendDeep({},{_context:f,data:r.data,layout:r.layout}),s=i.layout||{};o(n)||(n=s.template||{});var c=n.layout,u=n.data,h=[];i.layout=s,i.layout.template=n,l.supplyDefaults(i);var d=i._fullLayout,m=i._fullData,g={};if(o(c)?(function r(n,i){for(var a in n)if("_"!==a.charAt(0)&&o(n[a])){var s,l=p(a),c=[];for(s=0;s<i.length;s++)c.push(v(n,a,i[s])),l!==a&&c.push(v(n,l,i[s]));for(s=0;s<c.length;s++)g[c[s]]=1;r(n[a],c)}}(d,["layout"]),function r(n,i){for(var a in n)if(-1===a.indexOf("defaults")&&o(n[a])){var s=v(n,a,i);g[s]?r(n[a],s):h.push({code:"unused",path:s})}}(c,"layout")):h.push({code:"layout"}),o(u)){for(var x,b={},_=0;_<m.length;_++){var w=m[_];b[x=w.type]=(b[x]||0)+1,w._fullInput._template||h.push({code:"missing",index:w._fullInput.index,traceType:x})}for(x in u){var T=u[x].length,k=b[x]||0;T>k?h.push({code:"unused",traceType:x,templateCount:T,dataCount:k}):k>T&&h.push({code:"reused",traceType:x,templateCount:T,dataCount:k})}}else h.push({code:"data"});if(function r(n,i){for(var a in n)if("_"!==a.charAt(0)){var s=n[a],l=v(n,a,i);o(s)?(Array.isArray(n)&&!1===s._template&&s.templateitemname&&h.push({code:"missing",path:l,templateitemname:s.templateitemname}),r(s,l)):Array.isArray(s)&&function(r){for(var n=0;n<r.length;n++)if(o(r[n]))return!0}(s)&&r(s,l)}}({data:m,layout:d},""),h.length)return h.map(y)}},{"../lib":503,"../plots/attributes":550,"../plots/plots":619,"./plot_config":541,"./plot_schema":542,"./plot_template":543}],546:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("./plot_api"),s=r("../plots/plots"),l=r("../lib"),c=r("../snapshot/helpers"),u=r("../snapshot/tosvg"),f=r("../snapshot/svgtoimg"),h=r("../version").version,p={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};n.exports=function(r,n){function i(r){return!(r in n)||l.validate(n[r],p[r])}if(n=n||{},l.isPlainObject(r)?(d=r.data||[],m=r.layout||{},g=r.config||{},v={}):(r=l.getGraphDiv(r),d=l.extendDeep([],r.data),m=l.extendDeep({},r.layout),g=r._context,v=r._fullLayout||{}),!i("width")&&null!==n.width||!i("height")&&null!==n.height)throw Error("Height and width should be pixel values.");if(!i("format"))throw Error("Export format is not "+l.join2(p.format.values,", "," or ")+".");var d,m,g,v,y={};function x(r,i){return l.coerce(n,y,p,r,i)}var b=x("format"),_=x("width"),w=x("height"),T=x("scale"),k=x("setBackground"),A=x("imageDataOnly"),M=document.createElement("div");M.style.position="absolute",M.style.left="-5000px",document.body.appendChild(M);var S=l.extendFlat({},m);_?S.width=_:null===n.width&&a(v.width)&&(S.width=v.width),w?S.height=w:null===n.height&&a(v.height)&&(S.height=v.height);var E=l.extendFlat({},g,{_exportedPlot:!0,staticPlot:!0,setBackground:k}),L=c.getRedrawFunc(M);function C(){return new Promise(function(r){setTimeout(r,c.getDelay(M._fullLayout))})}function P(){return new Promise(function(r,n){var i=u(M,b,T),a=M._fullLayout.width,p=M._fullLayout.height;function d(){o.purge(M),document.body.removeChild(M)}if("full-json"===b){var m=s.graphJson(M,!1,"keepdata","object",!0,!0);return m.version=h,m=JSON.stringify(m),d(),r(A?m:c.encodeJSON(m))}if(d(),"svg"===b)return r(A?i:c.encodeSVG(i));var g=document.createElement("canvas");g.id=l.randstr(),f({format:b,width:a,height:p,scale:T,canvas:g,svg:i,promise:!0}).then(r).catch(n)})}return new Promise(function(r,n){o.newPlot(M,d,S,E).then(L).then(C).then(P).then(function(n){r(A?n.replace(c.IMAGE_URL_PREFIX,""):n)}).catch(function(r){n(r)})})}},{"../lib":503,"../plots/plots":619,"../snapshot/helpers":642,"../snapshot/svgtoimg":644,"../snapshot/tosvg":646,"../version":1119,"./plot_api":540,"fast-isnumeric":190}],547:[function(r,n,i){"use strict";var a=r("../lib"),o=r("../plots/plots"),s=r("./plot_schema"),l=r("./plot_config").dfltConfig,c=a.isPlainObject,u=Array.isArray,f=a.isArrayOrTypedArray;function h(r,n,i,o,s,l){l=l||[];for(var p=Object.keys(r),d=0;d<p.length;d++){var g=p[d];if("transforms"!==g){var y=l.slice();y.push(g);var x=r[g],b=n[g],_=g in i?i[g]:i[v(g).keyMinusId],w=(_||{}).valType,T="info_array"===w,k="colorscale"===w,A=(_||{}).items;if(function(r,n){var i=v(n),a=i.keyMinusId,o=i.id;return!!(a in r&&r[a]._isSubplotObj&&o)||n in r}(i,g)){if(c(x)&&c(b)&&"any"!==w)h(x,b,_,o,s,y);else if(T&&u(x)){x.length>b.length&&o.push(m("unused",s,y.concat(b.length)));var M,S,E,L,C,P=b.length,I=Array.isArray(A);if(I&&(P=Math.min(P,A.length)),2===_.dimensions)for(S=0;S<P;S++)if(u(x[S])){x[S].length>b[S].length&&o.push(m("unused",s,y.concat(S,b[S].length)));var O=b[S].length;for(M=0;M<(I?Math.min(O,A[S].length):O);M++)E=I?A[S][M]:A,L=x[S][M],C=b[S][M],a.validate(L,E)?C!==L&&C!==+L&&o.push(m("dynamic",s,y.concat(S,M),L,C)):o.push(m("value",s,y.concat(S,M),L))}else o.push(m("array",s,y.concat(S),x[S]));else for(S=0;S<P;S++)E=I?A[S]:A,L=x[S],C=b[S],a.validate(L,E)?C!==L&&C!==+L&&o.push(m("dynamic",s,y.concat(S),L,C)):o.push(m("value",s,y.concat(S),L))}else if(_.items&&!T&&u(x)){var z,D,R=A[Object.keys(A)[0]],F=[];for(z=0;z<b.length;z++){var B=b[z]._index||z;if((D=y.slice()).push(B),c(x[B])&&c(b[z])){F.push(B);var N=x[B],j=b[z];c(N)&&!1!==N.visible&&!1===j.visible?o.push(m("invisible",s,D)):h(N,j,R,o,s,D)}}for(z=0;z<x.length;z++)(D=y.slice()).push(z),c(x[z])?-1===F.indexOf(z)&&o.push(m("unused",s,D)):o.push(m("object",s,D,x[z]))}else!c(x)&&c(b)?o.push(m("object",s,y,x)):f(x)||!f(b)||T||k?g in n?a.validate(x,_)?"enumerated"===_.valType&&(_.coerceNumber&&x!==+b||x!==b)&&o.push(m("dynamic",s,y,x,b)):o.push(m("value",s,y,x)):o.push(m("unused",s,y,x)):o.push(m("array",s,y,x))}else o.push(m("schema",s,y))}}return o}n.exports=function(r,n){void 0===r&&(r=[]),void 0===n&&(n={});var i,f,p=s.get(),d=[],g={_context:a.extendFlat({},l)};u(r)?(g.data=a.extendDeep([],r),i=r):(g.data=[],i=[],d.push(m("array","data"))),c(n)?(g.layout=a.extendDeep({},n),f=n):(g.layout={},f={},arguments.length>1&&d.push(m("object","layout"))),o.supplyDefaults(g);for(var v=g._fullData,y=i.length,x=0;x<y;x++){var b=i[x],_=["data",x];if(c(b)){var w=v[x],T=w.type,k=p.traces[T].attributes;k.type={valType:"enumerated",values:[T]},!1===w.visible&&!1!==b.visible&&d.push(m("invisible",_)),h(b,w,k,d,_);var A=b.transforms,M=w.transforms;if(A){u(A)||d.push(m("array",_,["transforms"])),_.push("transforms");for(var S=0;S<A.length;S++){var E=["transforms",S],L=A[S].type;if(c(A[S])){var C=p.transforms[L]?p.transforms[L].attributes:{};C.type={valType:"enumerated",values:Object.keys(p.transforms)},h(A[S],M[S],C,d,_,E)}else d.push(m("object",_,E))}}}else d.push(m("object",_))}return h(f,g._fullLayout,function(r,n){for(var i=r.layout.layoutAttributes,o=0;o<n.length;o++){var s=n[o],l=r.traces[s.type],c=l.layoutAttributes;c&&(s.subplot?a.extendFlat(i[l.attributes.subplot.dflt],c):a.extendFlat(i,c))}return i}(p,v),d,"layout"),0===d.length?void 0:d};var p={object:function(r,n){return("layout"===r&&""===n?"The layout argument":"data"===r[0]&&""===n?"Trace "+r[1]+" in the data argument":d(r)+"key "+n)+" must be linked to an object container"},array:function(r,n){return("data"===r?"The data argument":d(r)+"key "+n)+" must be linked to an array container"},schema:function(r,n){return d(r)+"key "+n+" is not part of the schema"},unused:function(r,n,i){var a=c(i)?"container":"key";return d(r)+a+" "+n+" did not get coerced"},dynamic:function(r,n,i,a){return[d(r)+"key",n,"(set to '"+i+"')","got reset to","'"+a+"'","during defaults."].join(" ")},invisible:function(r,n){return(n?d(r)+"item "+n:"Trace "+r[1])+" got defaulted to be not visible"},value:function(r,n,i){return[d(r)+"key "+n,"is set to an invalid value ("+i+")"].join(" ")}};function d(r){return u(r)?"In data trace "+r[1]+", ":"In "+r+", "}function m(r,n,i,o,s){i=i||"",u(n)?(l=n[0],c=n[1]):(l=n,c=null);var l,c,f=function(r){if(!u(r))return String(r);for(var n="",i=0;i<r.length;i++){var a=r[i];"number"==typeof a?n=n.substr(0,n.length-1)+"["+a+"]":n+=a,i<r.length-1&&(n+=".")}return n}(i),h=p[r](n,f,o,s);return a.log(h),{code:r,container:l,trace:c,path:i,astr:f,msg:h}}var g=a.counterRegex("([a-z]+)");function v(r){var n=r.match(g);return{keyMinusId:n&&n[1],id:n&&n[2]}}},{"../lib":503,"../plots/plots":619,"./plot_config":541,"./plot_schema":542}],548:[function(r,n,i){"use strict";n.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],549:[function(r,n,i){"use strict";var a=r("../lib"),o=r("../plot_api/plot_template");n.exports=function(r,n,i){var s,l,c=i.name,u=i.inclusionAttr||"visible",f=n[c],h=a.isArrayOrTypedArray(r[c])?r[c]:[],p=n[c]=[],d=o.arrayTemplater(n,c,u);for(s=0;s<h.length;s++){var m=h[s];a.isPlainObject(m)?l=d.newItem(m):(l=d.newItem({}))[u]=!1,l._index=s,!1!==l[u]&&i.handleItemDefaults(m,l,n,i),p.push(l)}var g=d.defaultItems();for(s=0;s<g.length;s++)(l=g[s])._index=p.length,i.handleItemDefaults({},l,n,i,{}),p.push(l);if(a.isArrayOrTypedArray(f)){var v=Math.min(f.length,p.length);for(s=0;s<v;s++)a.relinkPrivateKeys(p[s],f[s])}return p}},{"../lib":503,"../plot_api/plot_template":543}],550:[function(r,n,i){"use strict";var a=r("./font_attributes"),o=r("../components/fx/attributes");n.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:a({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:o.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":397,"./font_attributes":585}],551:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=o.dateTime2ms,l=o.incrementMonth,c=r("../../constants/numerical").ONEAVGMONTH;n.exports=function(r,n,i,o){if("date"!==n.type)return{vals:o};var u=r[i+"periodalignment"];if(!u)return{vals:o};var f,h=r[i+"period"];if(a(h)){if((h=+h)<=0)return{vals:o}}else if("string"==typeof h&&"M"===h.charAt(0)){var p=+h.substring(1);if(!(p>0&&Math.round(p)===p))return{vals:o};f=p}for(var d=n.calendar,m="start"===u,g="end"===u,v=r[i+"period0"],y=s(v,d)||0,x=[],b=[],_=[],w=o.length,T=0;T<w;T++){var k,A,M,S=o[T];if(f){for(k=Math.round((S-y)/(f*c)),M=l(y,f*k,d);M>S;)M=l(M,-f,d);for(;M<=S;)M=l(M,f,d);A=l(M,-f,d)}else{for(M=y+(k=Math.round((S-y)/h))*h;M>S;)M-=h;for(;M<=S;)M+=h;A=M-h}x[T]=m?A:g?M:(A+M)/2,b[T]=A,_[T]=M}return{vals:x,starts:b,ends:_}}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],552:[function(r,n,i){"use strict";n.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],553:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=r("../../lib"),l=r("../../constants/numerical").FP_SAFE,c=r("../../registry"),u=r("../../components/drawing"),f=r("./axis_ids"),h=f.getFromId,p=f.isLinked;function d(r,n){var i,a,o=[],l=r._fullLayout,c=g(l,n,0),u=g(l,n,1),f=v(r,n),h=f.min,p=f.max;if(0===h.length||0===p.length)return s.simpleMap(n.range,n.r2l);var d=h[0].val,y=p[0].val;for(i=1;i<h.length&&d===y;i++)d=Math.min(d,h[i].val);for(i=1;i<p.length&&d===y;i++)y=Math.max(y,p[i].val);var x=!1;if(n.range){var b=s.simpleMap(n.range,n.r2l);x=b[1]<b[0]}"reversed"===n.autorange&&(x=!0,n.autorange=!0);var _,w,T,k,A,M,S=n.rangemode,E="tozero"===S,L="nonnegative"===S,C=n._length,P=C/10,I=0;for(i=0;i<h.length;i++)for(_=h[i],a=0;a<p.length;a++)(M=(w=p[a]).val-_.val-m(n,_.val,w.val))>0&&((A=C-c(_)-u(w))>P?M/A>I&&(T=_,k=w,I=M/A):M/C>I&&(T={val:_.val,nopad:1},k={val:w.val,nopad:1},I=M/C));if(d===y){var O=d-1,z=d+1;if(E){if(0===d)o=[0,1];else{var D=(d>0?p:h).reduce(function(r,n){return Math.max(r,u(n))},0),R=d/(1-Math.min(.5,D/C));o=d>0?[0,R]:[R,0]}}else o=L?[Math.max(0,O),Math.max(1,z)]:[O,z]}else E?(T.val>=0&&(T={val:0,nopad:1}),k.val<=0&&(k={val:0,nopad:1})):L&&(T.val-I*c(T)<0&&(T={val:0,nopad:1}),k.val<=0&&(k={val:1,nopad:1})),I=(k.val-T.val-m(n,_.val,w.val))/(C-c(T)-u(k)),o=[T.val-I*c(T),k.val+I*u(k)];return x&&o.reverse(),s.simpleMap(o,n.l2r||Number)}function m(r,n,i){var a=0;if(r.rangebreaks)for(var o=r.locateBreaks(n,i),s=0;s<o.length;s++){var l=o[s];a+=l.max-l.min}return a}function g(r,n,i){var o=.05*n._length,l=n._anchorAxis||{};if(-1!==(n.ticklabelposition||"").indexOf("inside")||-1!==(l.ticklabelposition||"").indexOf("inside")){var c="reversed"===n.autorange;if(!c){var f=s.simpleMap(n.range,n.r2l);c=f[1]<f[0]}c&&(i=!i)}var h=0;return p(r,n._id)||(h=function(r,n,i){var o=0,l="x"===n._id.charAt(0);for(var c in r._plots){var f=r._plots[c];if(n._id===f.xaxis._id||n._id===f.yaxis._id){var h=(l?f.yaxis:f.xaxis)||{};if(-1!==(h.ticklabelposition||"").indexOf("inside")&&(!i&&("left"===h.side||"bottom"===h.side)||i&&("top"===h.side||"right"===h.side))){if(h._vals){var p=s.deg2rad(h._tickAngles[h._id+"tick"]||0),d=Math.abs(Math.cos(p)),m=Math.abs(Math.sin(p));if(!h._vals[0].bb){var g=h._id+"tick";h._selections[g].each(function(r){var n=a.select(this);n.select(".text-math-group").empty()&&(r.bb=u.bBox(n.node()))})}for(var v=0;v<h._vals.length;v++){var y=h._vals[v].bb;if(y){var x=6+y.width,b=6+y.height;o=Math.max(o,l?Math.max(x*d,b*m):Math.max(b*d,x*m))}}}"inside"===h.ticks&&"inside"===h.ticklabelposition&&(o+=h.ticklen||0)}}}return o}(r,n,i)),o=Math.max(h,o),"domain"===n.constrain&&n._inputDomain&&(o*=(n._inputDomain[1]-n._inputDomain[0])/(n.domain[1]-n.domain[0])),function(r){return r.nopad?0:r.pad+(r.extrapad?o:h)}}function v(r,n,i){var a,o,s,l=n._id,c=r._fullData,u=r._fullLayout,f=[],p=[];function d(r,n){for(a=0;a<n.length;a++){var i,c,u=r[n[a]],h=(u._extremes||{})[l];if(!0===u.visible&&h){for(o=0;o<h.min.length;o++)i=(s=h.min[o]).val,y(f,i,s.pad,{extrapad:s.extrapad},b);for(o=0;o<h.max.length;o++)c=(s=h.max[o]).val,y(p,c,s.pad,{extrapad:s.extrapad},_)}}}if(d(c,n._traceIndices),d(u.annotations||[],n._annIndices||[]),d(u.shapes||[],n._shapeIndices||[]),n._matchGroup&&!i){for(var m in n._matchGroup)if(m!==n._id){var g,x,w=h(r,m),T=v(r,w,!0),k=n._length/w._length;for(o=0;o<T.min.length;o++)g=(s=T.min[o]).val,y(f,g,s.pad*k,{extrapad:s.extrapad},b);for(o=0;o<T.max.length;o++)x=(s=T.max[o]).val,y(p,x,s.pad*k,{extrapad:s.extrapad},_)}}return{min:f,max:p}}function y(r,n,i,a,o){for(var s=a.tozero,l=a.extrapad,c=!0,u=0;u<r.length&&c;u++){var f=r[u];if(o(f.val,n)&&f.pad>=i&&(f.extrapad||!l)){c=!1;break}o(n,f.val)&&f.pad<=i&&(l||!f.extrapad)&&(r.splice(u,1),u--)}if(c){var h=s&&0===n;r.push({val:n,pad:h?0:i,extrapad:!h&&l})}}function x(r){return o(r)&&Math.abs(r)<l}function b(r,n){return r<=n}function _(r,n){return r>=n}n.exports={getAutoRange:d,makePadFn:g,doAutoRange:function(r,n,i){if(n.setScale(),n.autorange){n.range=i?i.slice():d(r,n),n._r=n.range.slice(),n._rl=s.simpleMap(n._r,n.r2l);var a=n._input,o={};o[n._attr+".range"]=n.range,o[n._attr+".autorange"]=n.autorange,c.call("_storeDirectGUIEdit",r.layout,r._fullLayout._preGUI,o),a.range=n.range.slice(),a.autorange=n.autorange}var l=n._anchorAxis;if(l&&l.rangeslider){var u=l.rangeslider[n._name];u&&"auto"===u.rangemode&&(u.range=d(r,n)),l._input.rangeslider[n._name]=s.extendFlat({},u)}},findExtremes:function(r,n,i){i||(i={}),r._m||r.setScale();var a,s,c,u,f,h,p,d,m,g=[],v=[],w=n.length,T=i.padded||!1,k=i.tozero&&("linear"===r.type||"-"===r.type),A="log"===r.type,M=!1,S=i.vpadLinearized||!1;function E(r){if(Array.isArray(r))return M=!0,function(n){return Math.max(Number(r[n]||0),0)};var n=Math.max(Number(r||0),0);return function(){return n}}var L=E((r._m>0?i.ppadplus:i.ppadminus)||i.ppad||0),C=E((r._m>0?i.ppadminus:i.ppadplus)||i.ppad||0),P=E(i.vpadplus||i.vpad),I=E(i.vpadminus||i.vpad);if(!M){if(d=1/0,m=-1/0,A)for(a=0;a<w;a++)(s=n[a])<d&&s>0&&(d=s),s>m&&s<l&&(m=s);else for(a=0;a<w;a++)(s=n[a])<d&&s>-l&&(d=s),s>m&&s<l&&(m=s);n=[d,m],w=2}var O={tozero:k,extrapad:T};function z(i){o(c=n[i])&&(h=L(i),p=C(i),S?(u=r.c2l(c)-I(i),f=r.c2l(c)+P(i)):(d=c-I(i),m=c+P(i),A&&d<m/10&&(d=m/10),u=r.c2l(d),f=r.c2l(m)),k&&(u=Math.min(0,u),f=Math.max(0,f)),x(u)&&y(g,u,p,O,b),x(f)&&y(v,f,h,O,_))}var D=Math.min(6,w);for(a=0;a<D;a++)z(a);for(a=w-1;a>=D;a--)z(a);return{min:g,max:v,opts:i}},concatExtremes:v}},{"../../components/drawing":388,"../../constants/numerical":479,"../../lib":503,"../../registry":638,"./axis_ids":558,"@plotly/d3":58,"fast-isnumeric":190}],554:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=r("../../plots/plots"),l=r("../../registry"),c=r("../../lib"),u=c.strTranslate,f=r("../../lib/svg_text_utils"),h=r("../../components/titles"),p=r("../../components/color"),d=r("../../components/drawing"),m=r("./layout_attributes"),g=r("./clean_ticks"),v=r("../../constants/numerical"),y=v.ONEMAXYEAR,x=v.ONEAVGYEAR,b=v.ONEMINYEAR,_=v.ONEMAXQUARTER,w=v.ONEAVGQUARTER,T=v.ONEMINQUARTER,k=v.ONEMAXMONTH,A=v.ONEAVGMONTH,M=v.ONEMINMONTH,S=v.ONEWEEK,E=v.ONEDAY,L=E/2,C=v.ONEHOUR,P=v.ONEMIN,I=v.ONESEC,O=v.MINUS_SIGN,z=v.BADNUM,D={K:"zeroline"},R={K:"gridline",L:"path"},F={K:"tick",L:"path"},B={K:"tick",L:"text"},N=r("../../constants/alignment"),j=N.MID_SHIFT,U=N.CAP_SHIFT,V=N.LINE_SPACING,H=N.OPPOSITE_SIDE,q=n.exports={};q.setConvert=r("./set_convert");var G=r("./axis_autotype"),Y=r("./axis_ids"),W=Y.idSort,X=Y.isLinked;q.id2name=Y.id2name,q.name2id=Y.name2id,q.cleanId=Y.cleanId,q.list=Y.list,q.listIds=Y.listIds,q.getFromId=Y.getFromId,q.getFromTrace=Y.getFromTrace;var Z=r("./autorange");function J(r){var n=1e-4*(r[1]-r[0]);return[r[0]-n,r[1]+n]}q.getAutoRange=Z.getAutoRange,q.findExtremes=Z.findExtremes,q.coerceRef=function(r,n,i,a,o,s){var l=a.charAt(a.length-1),u=i._fullLayout._subplots[l+"axis"],f=a+"ref",h={};return o||(o=u[0]||("string"==typeof s?s:s[0])),s||(s=o),u=u.concat(u.map(function(r){return r+" domain"})),h[f]={valType:"enumerated",values:u.concat(s?"string"==typeof s?[s]:s:[]),dflt:o},c.coerce(r,n,h,f)},q.getRefType=function(r){return void 0===r?r:"paper"===r?"paper":"pixel"===r?"pixel":/( domain)$/.test(r)?"domain":"range"},q.coercePosition=function(r,n,i,a,o,s){var l,u;if("range"!==q.getRefType(a))l=c.ensureNumber,u=i(o,s);else{var f=q.getFromId(n,a);u=i(o,s=f.fraction2r(s)),l=f.cleanPos}r[o]=l(u)},q.cleanPosition=function(r,n,i){return("paper"===i||"pixel"===i?c.ensureNumber:q.getFromId(n,i).cleanPos)(r)},q.redrawComponents=function(r,n){n=n||q.listIds(r);var i=r._fullLayout;function a(a,o,s,c){for(var u=l.getComponentMethod(a,o),f={},h=0;h<n.length;h++)for(var p=i[q.id2name(n[h])][s],d=0;d<p.length;d++){var m=p[d];if(!f[m]&&(u(r,m),f[m]=1,c))return}}a("annotations","drawOne","_annIndices"),a("shapes","drawOne","_shapeIndices"),a("images","draw","_imgIndices",!0)};var K=q.getDataConversions=function(r,n,i,a){var o,s="x"===i||"y"===i||"z"===i?i:a;if(Array.isArray(s)){if(o={type:G(a,void 0,{autotypenumbers:r._fullLayout.autotypenumbers}),_categories:[]},q.setConvert(o),"category"===o.type)for(var l=0;l<a.length;l++)o.d2c(a[l])}else o=q.getFromTrace(r,n,s);return o?{d2c:o.d2c,c2d:o.c2d}:"ids"===s?{d2c:$,c2d:$}:{d2c:Q,c2d:Q}};function Q(r){return+r}function $(r){return String(r)}function tt(r){return+r.substring(1)}q.getDataToCoordFunc=function(r,n,i,a){return K(r,n,i,a).d2c},q.counterLetter=function(r){var n=r.charAt(0);return"x"===n?"y":"y"===n?"x":void 0},q.minDtick=function(r,n,i,a){-1===["log","category","multicategory"].indexOf(r.type)&&a?void 0===r._minDtick?(r._minDtick=n,r._forceTick0=i):r._minDtick&&((r._minDtick/n+1e-6)%1<2e-6&&((i-r._forceTick0)/n%1+1.000001)%1<2e-6?(r._minDtick=n,r._forceTick0=i):((n/r._minDtick+1e-6)%1>2e-6||((i-r._forceTick0)/r._minDtick%1+1.000001)%1>2e-6)&&(r._minDtick=0)):r._minDtick=0},q.saveRangeInitial=function(r,n){for(var i=q.list(r,"",!0),a=!1,o=0;o<i.length;o++){var s=i[o],l=void 0===s._rangeInitial,c=l||!(s.range[0]===s._rangeInitial[0]&&s.range[1]===s._rangeInitial[1]);(l&&!1===s.autorange||n&&c)&&(s._rangeInitial=s.range.slice(),a=!0)}return a},q.saveShowSpikeInitial=function(r,n){for(var i=q.list(r,"",!0),a=!1,o="on",s=0;s<i.length;s++){var l=i[s],c=void 0===l._showSpikeInitial,u=c||l.showspikes!==l._showspikes;(c||n&&u)&&(l._showSpikeInitial=l.showspikes,a=!0),"on"!==o||l.showspikes||(o="off")}return r._fullLayout._cartesianSpikesEnabled=o,a},q.autoBin=function(r,n,i,a,s,l){var u,f=c.aggNums(Math.min,null,r),h=c.aggNums(Math.max,null,r);if("category"===n.type||"multicategory"===n.type)return{start:f-.5,end:h+.5,size:Math.max(1,Math.round(l)||1),_dataSpan:h-f};if(s||(s=n.calendar),u="log"===n.type?{type:"linear",range:[f,h]}:{type:n.type,range:c.simpleMap([f,h],n.c2r,0,s),calendar:s},q.setConvert(u),l=l&&g.dtick(l,u.type))u.dtick=l,u.tick0=g.tick0(void 0,u.type,s);else{if(i)m=(h-f)/i;else{var p=c.distinctVals(r),d=Math.pow(10,Math.floor(Math.log(p.minDiff)/Math.LN10));o(m=Math.max(d*c.roundUp(p.minDiff/d,[.9,1.9,4.9,9.9],!0),2*c.stdev(r)/Math.pow(r.length,a?.25:.4)))||(m=1)}q.autoTicks(u,m)}var m,v,y=u.dtick,x=q.tickIncrement(q.tickFirst(u),y,"reverse",s);if("number"==typeof y)v=(x=function(r,n,i,a,s){var l=0,c=0,u=0,f=0;function h(n){return(1+100*(n-r)/i.dtick)%100<2}for(var p=0;p<n.length;p++)n[p]%1==0?u++:o(n[p])||f++,h(n[p])&&l++,h(n[p]+i.dtick/2)&&c++;var d=n.length-f;if(u===d&&"date"!==i.type)i.dtick<1?r=a-.5*i.dtick:(r-=.5)+i.dtick<a&&(r+=i.dtick);else if(c<.1*d&&(l>.3*d||h(a)||h(s))){var m=i.dtick/2;r+=r+m<a?m:-m}return r}(x,r,u,f,h))+(1+Math.floor((h-x)/y))*y;else for("M"===u.dtick.charAt(0)&&(x=function(r,n,i,a,o){var s=c.findExactDates(n,o);if(s.exactDays>.8){var l=Number(i.substr(1));s.exactYears>.8&&l%12==0?r=q.tickIncrement(r,"M6","reverse")+1.5*E:s.exactMonths>.8?r=q.tickIncrement(r,"M1","reverse")+15.5*E:r-=L;var u=q.tickIncrement(r,i);if(u<=a)return u}return r}(x,r,y,f,s)),v=x;v<=h;)v=q.tickIncrement(v,y,!1,s);return{start:n.c2r(x,0,s),end:n.c2r(v,0,s),size:y,_dataSpan:h-f}},q.prepTicks=function(r,n){var i=c.simpleMap(r.range,r.r2l,void 0,void 0,n);if(r._dtickInit=r.dtick,r._tick0Init=r.tick0,"auto"===r.tickmode||!r.dtick){var a,s=r.nticks;s||("category"===r.type||"multicategory"===r.type?(a=r.tickfont?c.bigFont(r.tickfont.size||12):15,s=r._length/a):(a="y"===r._id.charAt(0)?40:80,s=c.constrain(r._length/a,4,9)+1),"radialaxis"===r._name&&(s*=2)),"array"===r.tickmode&&(s*=100),r._roughDTick=Math.abs(i[1]-i[0])/s,q.autoTicks(r,r._roughDTick),r._minDtick>0&&r.dtick<2*r._minDtick&&(r.dtick=r._minDtick,r.tick0=r.l2r(r._forceTick0))}"period"===r.ticklabelmode&&function(r){function n(){return!(o(r.dtick)||"M"!==r.dtick.charAt(0))}var i,a=n(),s=q.getTickFormat(r);if(s){var l=r._dtickInit!==r.dtick;/%[fLQsSMX]/.test(s)||(/%[HI]/.test(s)?(i=C,l&&!a&&r.dtick<C&&(r.dtick=C)):/%p/.test(s)?(i=L,l&&!a&&r.dtick<L&&(r.dtick=L)):/%[Aadejuwx]/.test(s)?(i=E,l&&!a&&r.dtick<E&&(r.dtick=E)):/%[UVW]/.test(s)?(i=S,l&&!a&&r.dtick<S&&(r.dtick=S)):/%[Bbm]/.test(s)?(i=A,l&&(a?1>tt(r.dtick):r.dtick<M)&&(r.dtick="M1")):/%[q]/.test(s)?(i=w,l&&(a?3>tt(r.dtick):r.dtick<T)&&(r.dtick="M3")):/%[Yy]/.test(s)&&(i=x,l&&(a?12>tt(r.dtick):r.dtick<b)&&(r.dtick="M12")))}(a=n())&&r.tick0===r._dowTick0&&(r.tick0=r._rawTick0),r._definedDelta=i}(r),r.tick0||(r.tick0="date"===r.type?"2000-01-01":0),"date"===r.type&&r.dtick<.1&&(r.dtick=.1),tc(r)},q.calcTicks=function(r,n){q.prepTicks(r,n);var i=c.simpleMap(r.range,r.r2l,void 0,void 0,n);if("array"===r.tickmode)return function(r){var n=r.tickvals,i=r.ticktext,a=Array(n.length),o=J(c.simpleMap(r.range,r.r2l)),s=Math.min(o[0],o[1]),l=Math.max(o[0],o[1]),u=0;Array.isArray(i)||(i=[]);var f="category"===r.type?r.d2l_noadd:r.d2l;"log"===r.type&&"L"!==String(r.dtick).charAt(0)&&(r.dtick="L"+Math.pow(10,Math.floor(Math.min(r.range[0],r.range[1]))-1));for(var h=0;h<n.length;h++){var p=f(n[h]);p>s&&p<l&&(void 0===i[h]?a[u]=q.tickText(r,p):a[u]=tu(r,p,String(i[h])),u++)}return u<n.length&&a.splice(u,n.length-u),r.rangebreaks&&(a=a.filter(function(n){return r.maskBreaks(n.x)!==z})),a}(r);var a=J(i),s=a[0],l=a[1],u=i[1]<i[0],f=Math.min(i[0],i[1]),h=Math.max(i[0],i[1]),p="log"===r.type&&!(o(r.dtick)||"L"===r.dtick.charAt(0)),d="period"===r.ticklabelmode;if(r._tmin=q.tickFirst(r,n),r._tmin<s!==u)return[];"category"!==r.type&&"multicategory"!==r.type||(l=u?Math.max(-.5,l):Math.min(r._categories.length-.5,l));var m=r._tmin;r.rangebreaks&&r._tick0Init!==r.tick0&&(m=tA(m,r),u||(m=q.tickIncrement(m,r.dtick,!u,r.calendar))),d&&(m=q.tickIncrement(m,r.dtick,!u,r.calendar));for(var g,v=Math.max(1e3,r._length||0),P=[],I=null;u?m>=l:m<=l;m=q.tickIncrement(m,r.dtick,u,r.calendar)){if(r.rangebreaks&&!u){if(m<s)continue;if(r.maskBreaks(m)===z&&tA(m,r)>=h)break}if(P.length>v||m===I)break;I=m;var O=!1;p&&m!==(0|m)&&(O=!0),P.push({minor:O,value:m})}if(d&&function(r,n,i){for(var a=0;a<r.length;a++){var o=r[a].value,s=a,l=a+1;a<r.length-1?(s=a,l=a+1):(s=a>0?a-1:a,l=a);var c,u=r[s].value,f=Math.abs(r[l].value-u),h=i||f,p=0;h>=b?p=f>=b&&f<=y?f:x:i===w&&h>=T?p=f>=T&&f<=_?f:w:h>=M?p=f>=M&&f<=k?f:A:i===S&&h>=S?p=S:h>=E?p=E:i===L&&h>=L?p=L:i===C&&h>=C&&(p=C),p>=f&&(p=f,c=!0);var d=o+p;if(n.rangebreaks&&p>0){for(var m=0,g=0;g<84;g++){var v=(g+.5)/84;n.maskBreaks(o*(1-v)+v*d)!==z&&m++}(p*=m/84)||(r[a].drop=!0),c&&f>S&&(p=f)}(p>0||0===a)&&(r[a].periodX=o+p/2)}}(P,r,r._definedDelta),r.rangebreaks){var D="y"===r._id.charAt(0),R=1;"auto"===r.tickmode&&(R=r.tickfont?r.tickfont.size:12);var F=NaN;for(g=P.length-1;g>-1;g--)if(P[g].drop)P.splice(g,1);else{P[g].value=tA(P[g].value,r);var B=r.c2p(P[g].value);(D?F>B-R:F<B+R)?P.splice(u?g+1:g,1):F=B}}tk(r)&&360===Math.abs(i[1]-i[0])&&P.pop(),r._tmax=(P[P.length-1]||{}).value,r._prevDateHead="",r._inCalcTicks=!0;var N,j,U=[];for(g=0;g<P.length;g++){var V=P[g].minor,H=P[g].value;N=q.tickText(r,H,!1,V),void 0!==(j=P[g].periodX)&&(N.periodX=j,(j>h||j<f)&&(j>h&&(N.periodX=h),j<f&&(N.periodX=f),N.text=" ",r._prevDateHead="")),U.push(N)}return r._inCalcTicks=!1,U};var te=[2,5,10],tr=[1,2,3,6,12],tn=[1,2,5,10,15,30],ti=[1,2,3,7,14],ta=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],to=[-.301,0,.301,.699,1],ts=[15,30,45,90,180];function tl(r,n,i){return n*c.roundUp(r/n,i)}function tc(r){var n=r.dtick;if(r._tickexponent=0,o(n)||"string"==typeof n||(n=1),"category"!==r.type&&"multicategory"!==r.type||(r._tickround=null),"date"===r.type){var i=r.r2l(r.tick0),a=r.l2r(i).replace(/(^-|i)/g,""),s=a.length;if("M"===String(n).charAt(0))s>10||"01-01"!==a.substr(5)?r._tickround="d":r._tickround=+n.substr(1)%12==0?"y":"m";else if(n>=E&&s<=10||n>=15*E)r._tickround="d";else if(n>=P&&s<=16||n>=C)r._tickround="M";else if(n>=I&&s<=19||n>=P)r._tickround="S";else{var l=r.l2r(i+n).replace(/^-/,"").length;r._tickround=Math.max(s,l)-20,r._tickround<0&&(r._tickround=4)}}else if(o(n)||"L"===n.charAt(0)){var c=r.range.map(r.r2d||Number);o(n)||(n=Number(n.substr(1))),r._tickround=2-Math.floor(Math.log(n)/Math.LN10+.01);var u=Math.floor(Math.log(Math.max(Math.abs(c[0]),Math.abs(c[1])))/Math.LN10+.01);Math.abs(u)>(void 0===r.minexponent?3:r.minexponent)&&(th(r.exponentformat)&&!tp(u)?r._tickexponent=3*Math.round((u-1)/3):r._tickexponent=u)}else r._tickround=null}function tu(r,n,i){var a=r.tickfont||{};return{x:n,dx:0,dy:0,text:i||"",fontSize:a.size,font:a.family,fontColor:a.color}}q.autoTicks=function(r,n){var i;function a(r){return Math.pow(r,Math.floor(Math.log(n)/Math.LN10))}if("date"===r.type){r.tick0=c.dateTick0(r.calendar,0);var s=2*n;if(s>x)n/=x,i=a(10),r.dtick="M"+12*tl(n,i,te);else if(s>A)n/=A,r.dtick="M"+tl(n,1,tr);else if(s>E){r.dtick=tl(n,E,r._hasDayOfWeekBreaks?[1,2,7,14]:ti);var l=q.getTickFormat(r),u="period"===r.ticklabelmode;u&&(r._rawTick0=r.tick0),/%[uVW]/.test(l)?r.tick0=c.dateTick0(r.calendar,2):r.tick0=c.dateTick0(r.calendar,1),u&&(r._dowTick0=r.tick0)}else s>C?r.dtick=tl(n,C,tr):s>P?r.dtick=tl(n,P,tn):s>I?r.dtick=tl(n,I,tn):(i=a(10),r.dtick=tl(n,i,te))}else if("log"===r.type){r.tick0=0;var f=c.simpleMap(r.range,r.r2l);if(n>.7)r.dtick=Math.ceil(n);else if(1>Math.abs(f[1]-f[0])){var h=1.5*Math.abs((f[1]-f[0])/n);n=Math.abs(Math.pow(10,f[1])-Math.pow(10,f[0]))/h,i=a(10),r.dtick="L"+tl(n,i,te)}else r.dtick=n>.3?"D2":"D1"}else"category"===r.type||"multicategory"===r.type?(r.tick0=0,r.dtick=Math.ceil(Math.max(n,1))):tk(r)?(r.tick0=0,i=1,r.dtick=tl(n,i,ts)):(r.tick0=0,i=a(10),r.dtick=tl(n,i,te));if(0===r.dtick&&(r.dtick=1),!o(r.dtick)&&"string"!=typeof r.dtick){var p=r.dtick;throw r.dtick=1,"ax.dtick error: "+String(p)}},q.tickIncrement=function(r,n,i,s){var l=i?-1:1;if(o(n))return c.increment(r,l*n);var u=n.charAt(0),f=l*Number(n.substr(1));if("M"===u)return c.incrementMonth(r,f,s);if("L"===u)return Math.log(Math.pow(10,r)+f)/Math.LN10;if("D"===u){var h="D2"===n?to:ta,p=r+.01*l,d=c.roundUp(c.mod(p,1),h,i);return Math.floor(p)+Math.log(a.round(Math.pow(10,d),1))/Math.LN10}throw"unrecognized dtick "+String(n)},q.tickFirst=function(r,n){var i=r.r2l||Number,s=c.simpleMap(r.range,i,void 0,void 0,n),l=s[1]<s[0],u=l?Math.floor:Math.ceil,f=J(s)[0],h=r.dtick,p=i(r.tick0);if(o(h)){var d=u((f-p)/h)*h+p;return"category"!==r.type&&"multicategory"!==r.type||(d=c.constrain(d,0,r._categories.length-1)),d}var m=h.charAt(0),g=Number(h.substr(1));if("M"===m){for(var v,y,x,b=0,_=p;b<10;){if(((v=q.tickIncrement(_,h,l,r.calendar))-f)*(_-f)<=0)return l?Math.min(_,v):Math.max(_,v);x=m+(Math.abs(Math.round(y=(f-(_+v)/2)/(v-_)))||1)*g,_=q.tickIncrement(_,x,y<0?!l:l,r.calendar),b++}return c.error("tickFirst did not converge",r),_}if("L"===m)return Math.log(u((Math.pow(10,f)-p)/g)*g+p)/Math.LN10;if("D"===m){var w="D2"===h?to:ta,T=c.roundUp(c.mod(f,1),w,l);return Math.floor(f)+Math.log(a.round(Math.pow(10,T),1))/Math.LN10}throw"unrecognized dtick "+String(h)},q.tickText=function(r,n,i,a){var s,l,u,f,h,p,d,m=tu(r,n),g="array"===r.tickmode,v=i||g,y=r.type,x="category"===y?r.d2l_noadd:r.d2l;if(g&&Array.isArray(r.ticktext)){var b=c.simpleMap(r.range,r.r2l),_=(Math.abs(b[1]-b[0])-(r._lBreaks||0))/1e4;for(d=0;d<r.ticktext.length&&!(Math.abs(n-x(r.tickvals[d]))<_);d++);if(d<r.ticktext.length)return m.text=String(r.ticktext[d]),m}function w(a){if(void 0===a)return!0;if(i)return"none"===a;var o={first:r._tmin,last:r._tmax}[a];return"all"!==a&&n!==o}var T=i?"never":"none"!==r.exponentformat&&w(r.showexponent)?"hide":"";if("date"===y?function(r,n,i,a){var s=r._tickround,l=i&&r.hoverformat||q.getTickFormat(r);a&&(s=o(s)?4:({y:"m",m:"d",d:"M",M:"S",S:4})[s]);var u,f=c.formatDate(n.x,l,s,r._dateFormat,r.calendar,r._extraFormat),h=f.indexOf("\n");if(-1!==h&&(u=f.substr(h+1),f=f.substr(0,h)),a&&("00:00:00"===f||"00:00"===f?(f=u,u=""):8===f.length&&(f=f.replace(/:00$/,""))),u){if(i)"d"===s?f+=", "+u:f=u+(f?", "+f:"");else if(r._inCalcTicks&&r._prevDateHead===u){var p=tM(r),d=r._trueSide||r.side;(!p&&"top"===d||p&&"bottom"===d)&&(f+="<br> ")}else r._prevDateHead=u,f+="<br>"+u}n.text=f}(r,m,i,v):"log"===y?function(r,n,i,a,s){var l=r.dtick,u=n.x,f=r.tickformat,h="string"==typeof l&&l.charAt(0);if("never"===s&&(s=""),a&&"L"!==h&&(l="L3",h="L"),f||"L"===h)n.text=td(Math.pow(10,u),r,s,a);else if(o(l)||"D"===h&&.1>c.mod(u+.01,1)){var p=Math.round(u),d=Math.abs(p),m=r.exponentformat;"power"===m||th(m)&&tp(p)?(n.text=0===p?1:1===p?"10":"10<sup>"+(p>1?"":O)+d+"</sup>",n.fontSize*=1.25):("e"===m||"E"===m)&&d>2?n.text="1"+m+(p>0?"+":O)+d:(n.text=td(Math.pow(10,u),r,"","fakehover"),"D1"===l&&"y"===r._id.charAt(0)&&(n.dy-=n.fontSize/6))}else{if("D"!==h)throw"unrecognized dtick "+String(l);n.text=String(Math.round(Math.pow(10,c.mod(u,1)))),n.fontSize*=.75}if("D1"===r.dtick){var g=String(n.text).charAt(0);"0"!==g&&"1"!==g||("y"===r._id.charAt(0)?n.dx-=n.fontSize/4:(n.dy+=n.fontSize/2,n.dx+=(r.range[1]>r.range[0]?1:-1)*n.fontSize*(u<0?.5:.25)))}}(r,m,0,v,T):"category"===y?(void 0===(s=r._categories[Math.round(m.x)])&&(s=""),m.text=String(s)):"multicategory"===y?(l=Math.round(m.x),f=void 0===(u=r._categories[l]||[])[1]?"":String(u[1]),h=void 0===u[0]?"":String(u[0]),i?m.text=h+" - "+f:(m.text=f,m.text2=h)):tk(r)?function(r,n,i,a,o){if("radians"!==r.thetaunit||i)n.text=td(n.x,r,o,a);else{var s=n.x/180;if(0===s)n.text="0";else{var l=function(r){function n(r,n){return 1e-6>=Math.abs(r-n)}var i=function(r){for(var i=1;!n(Math.round(r*i)/i,r);)i*=10;return i}(r),a=r*i,o=Math.abs(function r(i,a){return n(a,0)?i:r(a,i%a)}(a,i));return[Math.round(a/o),Math.round(i/o)]}(s);if(l[1]>=100)n.text=td(c.deg2rad(n.x),r,o,a);else{var u=n.x<0;1===l[1]?1===l[0]?n.text="":n.text=l[0]+"":n.text=["<sup>",l[0],"</sup>","","<sub>",l[1],"</sub>",""].join(""),u&&(n.text=O+n.text)}}}}(r,m,i,v,T):("never"===(p=T)?p="":"all"===r.showexponent&&1e-6>Math.abs(m.x/r.dtick)&&(p="hide"),m.text=td(m.x,r,p,v)),a||(r.tickprefix&&!w(r.showtickprefix)&&(m.text=r.tickprefix+m.text),r.ticksuffix&&!w(r.showticksuffix)&&(m.text+=r.ticksuffix)),"boundaries"===r.tickson||r.showdividers){var k=function(n){var i=r.l2p(n);return i>=0&&i<=r._length?n:null};m.xbnd=[k(m.x-.5),k(m.x+r.dtick-.5)]}return m},q.hoverLabelText=function(r,n,i){i&&(r=c.extendFlat({},r,{hoverformat:i}));var a=Array.isArray(n)?n[0]:n,o=Array.isArray(n)?n[1]:void 0;if(void 0!==o&&o!==a)return q.hoverLabelText(r,a,i)+" - "+q.hoverLabelText(r,o,i);var s="log"===r.type&&a<=0,l=q.tickText(r,r.c2l(s?-a:a),"hover").text;return s?0===a?"0":O+l:l};var tf=["f","p","n","","m","","k","M","G","T"];function th(r){return"SI"===r||"B"===r}function tp(r){return r>14||r<-15}function td(r,n,i,a){var s=r<0,l=n._tickround,u=i||n.exponentformat||"B",f=n._tickexponent,h=q.getTickFormat(n),p=n.separatethousands;if(a){var d={exponentformat:u,minexponent:n.minexponent,dtick:"none"===n.showexponent?n.dtick:o(r)&&Math.abs(r)||1,range:"none"===n.showexponent?n.range.map(n.r2d):[0,r||1]};tc(d),l=(Number(d._tickround)||0)+4,f=d._tickexponent,n.hoverformat&&(h=n.hoverformat)}if(h)return n._numFormat(h)(r).replace(/-/g,O);var m,g=Math.pow(10,-l)/2;if("none"===u&&(f=0),(r=Math.abs(r))<g)r="0",s=!1;else{if(r+=g,f&&(r*=Math.pow(10,-f),l+=f),0===l)r=String(Math.floor(r));else if(l<0){r=(r=String(Math.round(r))).substr(0,r.length+l);for(var v=l;v<0;v++)r+="0"}else{var y=(r=String(r)).indexOf(".")+1;y&&(r=r.substr(0,y+l).replace(/\.?0+$/,""))}r=c.numSeparate(r,n._separators,p)}return f&&"hide"!==u&&(th(u)&&tp(f)&&(u="power"),m=f<0?O+-f:"power"!==u?"+"+f:String(f),"e"===u||"E"===u?r+=u+m:"power"===u?r+="\xd710<sup>"+m+"</sup>":"B"===u&&9===f?r+="B":th(u)&&(r+=tf[f/3+5])),s?O+r:r}function tm(r){return void 0!==r.periodX?r.periodX:r.x}function tg(r){return[r.text,r.x,r.axInfo,r.font,r.fontSize,r.fontColor].join("_")}function tv(r){var n=r.title.font.size,i=(r.title.text.match(f.BR_TAG_ALL)||[]).length;return r.title.hasOwnProperty("standoff")?i?n*(U+i*V):n*U:i?n*(i+1)*V:n}function ty(r,n){var i=r.l2p(n);return i>1&&i<r._length-1}function tx(r){var n=a.select(r),i=n.select(".text-math-group");return i.empty()?n.select("text"):i}function tb(r){return r._id+".automargin"}function t_(r){return tb(r)+".mirror"}function tw(r){return r._id+".rangeslider"}function tT(r,n){for(var i=0;i<n.length;i++)-1===r.indexOf(n[i])&&r.push(n[i])}function tk(r){return"angularaxis"===r._id}function tA(r,n){for(var i=n._rangebreaks.length,a=0;a<i;a++){var o=n._rangebreaks[a];if(r>=o.min&&r<o.max)return o.max}return r}function tM(r){return -1!==(r.ticklabelposition||"").indexOf("inside")}function tS(r,n){tM(r._anchorAxis||{})&&r._hideCounterAxisInsideTickLabels&&r._hideCounterAxisInsideTickLabels(n)}q.getTickFormat=function(r){var n,i,a,o,s,l,c,u;function f(r){return"string"!=typeof r?r:Number(r.replace("M",""))*A}function h(r,n){var i=["L","D"];if(typeof r==typeof n){if("number"==typeof r)return r-n;var a=i.indexOf(r.charAt(0)),o=i.indexOf(n.charAt(0));return a===o?Number(r.replace(/(L|D)/g,""))-Number(n.replace(/(L|D)/g,"")):a-o}return"number"==typeof r?1:-1}if(r.tickformatstops&&r.tickformatstops.length>0)switch(r.type){case"date":case"linear":for(n=0;n<r.tickformatstops.length;n++)if((a=r.tickformatstops[n]).enabled&&(o=r.dtick,s=a.dtickrange,l=void 0,c=void 0,u=void 0,l=f||function(r){return r},c=s[0],u=s[1],(!c&&"number"!=typeof c||l(c)<=l(o))&&(!u&&"number"!=typeof u||l(u)>=l(o)))){i=a;break}break;case"log":for(n=0;n<r.tickformatstops.length;n++)if((a=r.tickformatstops[n]).enabled&&function(r,n){var i=null===n[0],a=null===n[1],o=h(r,n[0])>=0,s=0>=h(r,n[1]);return(i||o)&&(a||s)}(r.dtick,a.dtickrange)){i=a;break}}return i?i.value:r.tickformat},q.getSubplots=function(r,n){var i=r._fullLayout._subplots,a=i.cartesian.concat(i.gl2d||[]),o=n?q.findSubplotsWithAxis(a,n):a;return o.sort(function(r,n){var i=r.substr(1).split("y"),a=n.substr(1).split("y");return i[0]===a[0]?+i[1]-+a[1]:+i[0]-+a[0]}),o},q.findSubplotsWithAxis=function(r,n){for(var i=new RegExp("x"===n._id.charAt(0)?"^"+n._id+"y":n._id+"$"),a=[],o=0;o<r.length;o++){var s=r[o];i.test(s)&&a.push(s)}return a},q.makeClipPaths=function(r){var n=r._fullLayout;if(!n._hasOnlyLargeSploms){var i,o,s={_offset:0,_length:n.width,_id:""},l={_offset:0,_length:n.height,_id:""},c=q.list(r,"x",!0),u=q.list(r,"y",!0),f=[];for(i=0;i<c.length;i++)for(f.push({x:c[i],y:l}),o=0;o<u.length;o++)0===i&&f.push({x:s,y:u[o]}),f.push({x:c[i],y:u[o]});var h=n._clips.selectAll(".axesclip").data(f,function(r){return r.x._id+r.y._id});h.enter().append("clipPath").classed("axesclip",!0).attr("id",function(r){return"clip"+n._uid+r.x._id+r.y._id}).append("rect"),h.exit().remove(),h.each(function(r){a.select(this).select("rect").attr({x:r.x._offset||0,y:r.y._offset||0,width:r.x._length||1,height:r.y._length||1})})}},q.draw=function(r,n,i){var a=r._fullLayout;"redraw"===n&&a._paper.selectAll("g.subplot").each(function(r){var n=r[0],i=a._plots[n];if(i){var o=i.xaxis,s=i.yaxis;i.xaxislayer.selectAll("."+o._id+"tick").remove(),i.yaxislayer.selectAll("."+s._id+"tick").remove(),i.xaxislayer.selectAll("."+o._id+"tick2").remove(),i.yaxislayer.selectAll("."+s._id+"tick2").remove(),i.xaxislayer.selectAll("."+o._id+"divider").remove(),i.yaxislayer.selectAll("."+s._id+"divider").remove(),i.gridlayer&&i.gridlayer.selectAll("path").remove(),i.zerolinelayer&&i.zerolinelayer.selectAll("path").remove(),a._infolayer.select(".g-"+o._id+"title").remove(),a._infolayer.select(".g-"+s._id+"title").remove()}});var o=n&&"redraw"!==n?n:q.listIds(r);return c.syncOrAsync(o.map(function(n){return function(){if(n){var a=q.getFromId(r,n),o=q.drawOne(r,a,i);return a._r=a.range.slice(),a._rl=c.simpleMap(a._r,a.r2l),o}}}))},q.drawOne=function(r,n,i){i=i||{},n.setScale();var a=r._fullLayout,o=n._id,u=o.charAt(0),f=q.counterLetter(o),m=a._plots[n._mainSubplot];if(m){var g=m[u+"axislayer"],v=n._mainLinePosition,y=n._mainMirrorPosition,x=n._vals=q.calcTicks(n),b=[n.mirror,v,y].join("_");for(w=0;w<x.length;w++)x[w].axInfo=b;n._selections={},n._tickAngles&&(n._prevTickAngles=n._tickAngles),n._tickAngles={},n._depth=null;var _={};if(n.visible){var w,T,k,A,M,S=q.makeTransTickFn(n),E=q.makeTransTickLabelFn(n),L="inside"===n.ticks,C="outside"===n.ticks;if("boundaries"===n.tickson){var P=function(r,n){var i,a=[],o=function(r,n){var i=r.xbnd[n];null!==i&&a.push(c.extendFlat({},r,{x:i}))};if(n.length){for(i=0;i<n.length;i++)o(n[i],0);o(n[i-1],1)}return a}(0,x);M=q.clipEnds(n,P),A=L?M:P}else M=q.clipEnds(n,x),A=L&&"period"!==n.ticklabelmode?M:x;var I=n._gridVals=M,O=function(r,n){var i,a,o=[],s=n.length&&n[n.length-1].x<n[0].x,l=function(r,n){var i=r.xbnd[n];null!==i&&o.push(c.extendFlat({},r,{x:i}))};if(r.showdividers&&n.length){for(i=0;i<n.length;i++){var u=n[i];u.text2!==a&&l(u,s?1:0),a=u.text2}l(n[i-1],s?0:1)}return o}(n,x);if(!a._hasOnlyLargeSploms){var z=n._subplotsWith,D={};for(w=0;w<z.length;w++){T=z[w];var R=(k=a._plots[T])[f+"axis"],F=R._mainAxis._id;if(!D[F]){D[F]=1;var B="x"===u?"M0,"+R._offset+"v"+R._length:"M"+R._offset+",0h"+R._length;q.drawGrid(r,n,{vals:I,counterAxis:R,layer:k.gridlayer.select("."+o),path:B,transFn:S}),q.drawZeroLine(r,n,{counterAxis:R,layer:k.zerolinelayer,path:B,transFn:S})}}}var N=q.getTickSigns(n),j=[];if(n.ticks){var U,G,Y,W=q.makeTickPath(n,v,N[2]);if(n._anchorAxis&&n.mirror&&!0!==n.mirror?G=W+(U=q.makeTickPath(n,y,N[3])):(U="",G=W),n.showdividers&&C&&"boundaries"===n.tickson){var X={};for(w=0;w<O.length;w++)X[O[w].x]=1;Y=function(r){return X[r.x]?U:G}}else Y=G;q.drawTicks(r,n,{vals:A,layer:g,path:Y,transFn:S}),"allticks"===n.mirror&&(j=Object.keys(n._linepositions||{}))}for(w=0;w<j.length;w++){T=j[w],k=a._plots[T];var Z=n._linepositions[T]||[],J=q.makeTickPath(n,Z[0],N[0])+q.makeTickPath(n,Z[1],N[1]);q.drawTicks(r,n,{vals:A,layer:k[u+"axislayer"],path:J,transFn:S})}var K=[];if(K.push(function(){return q.drawLabels(r,n,{vals:x,layer:g,plotinfo:k,transFn:E,labelFns:q.makeLabelFns(n,v)})}),"multicategory"===n.type){var Q={x:2,y:10}[u];K.push(function(){var i=tt()[({x:"height",y:"width"})[u]]+Q+(n._tickAngles[o+"tick"]?n.tickfont.size*V:0);return q.drawLabels(r,n,{vals:function(r,n){for(var i=[],a={},o=0;o<n.length;o++){var s=n[o];a[s.text2]?a[s.text2].push(s.x):a[s.text2]=[s.x]}for(var l in a)i.push(tu(r,c.interp(a[l],.5),l));return i}(n,x),layer:g,cls:o+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:S,labelFns:q.makeLabelFns(n,v+i*N[4])})}),K.push(function(){var i,a,o,s;return n._depth=N[4]*(tt("tick2")[n.side]-v),i={vals:O,layer:g,path:q.makeTickPath(n,v,N[4],n._depth),transFn:S},a=n._id+"divider",o=i.vals,void((s=i.layer.selectAll("path."+a).data(o,tg)).exit().remove(),s.enter().insert("path",":first-child").classed(a,1).classed("crisp",1).call(p.stroke,n.dividercolor).style("stroke-width",d.crispRound(r,n.dividerwidth,1)+"px"),s.attr("transform",i.transFn).attr("d",i.path))})}else n.title.hasOwnProperty("standoff")&&K.push(function(){n._depth=N[4]*(tt()[n.side]-v)});var $=l.getComponentMethod("rangeslider","isVisible")(n);return K.push(function(){var i,o,c,h,p=n.side.charAt(0),d=H[n.side].charAt(0),m=q.getPxPosition(r,n),g=C?n.ticklen:0;if((n.automargin||$)&&("multicategory"===n.type?i=tt("tick2"):(i=tt(),"x"===u&&"b"===p&&(n._depth=Math.max(i.width>0?i.bottom-m:0,g)))),n.automargin){o={x:0,y:0,r:0,l:0,t:0,b:0};var v=[0,1];if("x"===u){if("b"===p?o[p]=n._depth:(o[p]=n._depth=Math.max(i.width>0?m-i.top:0,g),v.reverse()),i.width>0){var y=i.right-(n._offset+n._length);y>0&&(o.xr=1,o.r=y);var x=n._offset-i.left;x>0&&(o.xl=0,o.l=x)}}else if("l"===p?o[p]=n._depth=Math.max(i.height>0?m-i.left:0,g):(o[p]=n._depth=Math.max(i.height>0?i.right-m:0,g),v.reverse()),i.height>0){var b=i.bottom-(n._offset+n._length);b>0&&(o.yb=0,o.b=b);var _=n._offset-i.top;_>0&&(o.yt=1,o.t=_)}o[f]="free"===n.anchor?n.position:n._anchorAxis.domain[v[0]],n.title.text!==a._dfltTitle[u]&&(o[p]+=tv(n)+(n.title.standoff||0)),n.mirror&&"free"!==n.anchor&&((c={x:0,y:0,r:0,l:0,t:0,b:0})[d]=n.linewidth,n.mirror&&!0!==n.mirror&&(c[d]+=g),!0===n.mirror||"ticks"===n.mirror?c[f]=n._anchorAxis.domain[v[1]]:"all"!==n.mirror&&"allticks"!==n.mirror||(c[f]=[n._counterDomainMin,n._counterDomainMax][v[1]]))}$&&(h=l.getComponentMethod("rangeslider","autoMarginOpts")(r,n)),s.autoMargin(r,tb(n),o),s.autoMargin(r,t_(n),c),s.autoMargin(r,tw(n),h)}),i.skipTitle||$&&"bottom"===n.side||K.push(function(){return function(r,n){var i,a=r._fullLayout,o=n._id,s=o.charAt(0),l=n.title.font.size;if(n.title.hasOwnProperty("standoff"))i=n._depth+n.title.standoff+tv(n);else{var c=tM(n);if("multicategory"===n.type)i=n._depth;else{var u=1.5*l;c&&(u=.5*l,"outside"===n.ticks&&(u+=n.ticklen)),i=10+u+(n.linewidth?n.linewidth-1:0)}c||(i+="x"===s?"top"===n.side?l*(n.showticklabels?1:0):l*(n.showticklabels?1.5:.5):"right"===n.side?l*(n.showticklabels?1:.5):l*(n.showticklabels?.5:0))}var f,p,m,g,v=q.getPxPosition(r,n);if("x"===s?(p=n._offset+n._length/2,m="top"===n.side?v-i:v+i):(m=n._offset+n._length/2,p="right"===n.side?v+i:v-i,f={rotate:"-90",offset:0}),"multicategory"!==n.type){var y=n._selections[n._id+"tick"];if(g={selection:y,side:n.side},y&&y.node()&&y.node().parentNode){var x=d.getTranslate(y.node().parentNode);g.offsetLeft=x.x,g.offsetTop=x.y}n.title.hasOwnProperty("standoff")&&(g.pad=0)}return h.draw(r,o+"title",{propContainer:n,propName:n._name+".title.text",placeholder:a._dfltTitle[s],avoid:g,transform:f,attributes:{x:p,y:m,"text-anchor":"middle"}})}(r,n)}),c.syncOrAsync(K)}}function tt(r){var i,a,s,l,c=o+(r||"tick");return _[c]||(_[c]=(n._selections[c].size()?(i=1/0,a=-1/0,s=1/0,l=-1/0,n._selections[c].each(function(){var r=tx(this),n=d.bBox(r.node().parentNode);i=Math.min(i,n.top),a=Math.max(a,n.bottom),s=Math.min(s,n.left),l=Math.max(l,n.right)})):(i=0,a=0,s=0,l=0),{top:i,bottom:a,left:s,right:l,height:a-i,width:l-s})),_[c]}},q.getTickSigns=function(r){var n=r._id.charAt(0),i=r.side===({x:"top",y:"right"})[n]?1:-1,a=[-1,1,i,-i];return"inside"!==r.ticks==("x"===n)&&(a=a.map(function(r){return-r})),r.side&&a.push({l:-1,t:-1,r:1,b:1}[r.side.charAt(0)]),a},q.makeTransTickFn=function(r){return"x"===r._id.charAt(0)?function(n){return u(r._offset+r.l2p(n.x),0)}:function(n){return u(0,r._offset+r.l2p(n.x))}},q.makeTransTickLabelFn=function(r){var n=function(r){var n=r.ticklabelposition||"",i=function(r){return -1!==n.indexOf(r)},a=i("top"),o=i("left"),s=i("right"),l=i("bottom"),c=i("inside"),u=l||o||a||s;if(!u&&!c)return[0,0];var f=r.side,h=u?(r.tickwidth||0)/2:0,p=3,d=r.tickfont?r.tickfont.size:12;return(l||a)&&(h+=d*U,p+=(r.linewidth||0)/2),(o||s)&&(h+=(r.linewidth||0)/2,p+=3),c&&"top"===f&&(p-=d*(1-U)),(o||a)&&(h=-h),"bottom"!==f&&"right"!==f||(p=-p),[u?h:0,c?p:0]}(r),i=n[0],a=n[1];return"x"===r._id.charAt(0)?function(n){return u(i+r._offset+r.l2p(tm(n)),a)}:function(n){return u(a,i+r._offset+r.l2p(tm(n)))}},q.makeTickPath=function(r,n,i,a){a=void 0!==a?a:r.ticklen;var o=r._id.charAt(0),s=(r.linewidth||1)/2;return"x"===o?"M0,"+(n+s*i)+"v"+a*i:"M"+(n+s*i)+",0h"+a*i},q.makeLabelFns=function(r,n,i){var a=r.ticklabelposition||"",s=function(r){return -1!==a.indexOf(r)},l=s("top"),u=s("left"),f=s("right"),h=s("bottom")||u||l||f,p=s("inside"),d="inside"===a&&"inside"===r.ticks||!p&&"outside"===r.ticks&&"boundaries"!==r.tickson,m=0,g=0,v=d?r.ticklen:0;if(p?v*=-1:h&&(v=0),d&&(m+=v,i)){var y=c.deg2rad(i);m=v*Math.cos(y)+1,g=v*Math.sin(y)}r.showticklabels&&(d||r.showline)&&(m+=.2*r.tickfont.size);var x,b,_,w,T,k={labelStandoff:m+=(r.linewidth||1)/2*(p?-1:1),labelShift:g},A=0,M=r.side,S=r._id.charAt(0),E=r.tickangle;if("x"===S)w=(T=!p&&"bottom"===M||p&&"top"===M)?1:-1,p&&(w*=-1),x=g*w,b=n+m*w,_=T?1:-.2,90===Math.abs(E)&&(p?_+=j:_=-90===E&&"bottom"===M?U:90===E&&"top"===M?j:.5,A=j/2*(E/90)),k.xFn=function(r){return r.dx+x+A*r.fontSize},k.yFn=function(r){return r.dy+b+r.fontSize*_},k.anchorFn=function(r,n){if(h){if(u)return"end";if(f)return"start"}return o(n)&&0!==n&&180!==n?n*w<0!==p?"end":"start":"middle"},k.heightFn=function(n,i,a){return i<-60||i>60?-.5*a:"top"===r.side!==p?-a:0};else if("y"===S){if(w=(T=!p&&"left"===M||p&&"right"===M)?1:-1,p&&(w*=-1),x=m,b=g*w,_=0,p||90!==Math.abs(E)||(_=-90===E&&"left"===M||90===E&&"right"===M?U:.5),p){var L=o(E)?+E:0;0!==L&&(A=Math.abs(Math.sin(c.deg2rad(L)))*U*w,_=0)}k.xFn=function(r){return r.dx+n-(x+r.fontSize*_)*w+A*r.fontSize},k.yFn=function(r){return r.dy+b+r.fontSize*j},k.anchorFn=function(r,n){return o(n)&&90===Math.abs(n)?"middle":T?"end":"start"},k.heightFn=function(n,i,a){return"right"===r.side&&(i*=-1),i<-30?-a:i<30?-.5*a:0}}return k},q.drawTicks=function(r,n,i){i=i||{};var a=n._id+"tick",o=i.vals;"period"===n.ticklabelmode&&(o=o.slice()).shift();var s=i.layer.selectAll("path."+a).data(n.ticks?o:[],tg);s.exit().remove(),s.enter().append("path").classed(a,1).classed("ticks",1).classed("crisp",!1!==i.crisp).call(p.stroke,n.tickcolor).style("stroke-width",d.crispRound(r,n.tickwidth,1)+"px").attr("d",i.path).style("display",null),tS(n,[F]),s.attr("transform",i.transFn)},q.drawGrid=function(r,n,i){i=i||{};var a=n._id+"grid",o=i.vals,s=i.counterAxis;if(!1===n.showgrid)o=[];else if(s&&q.shouldShowZeroLine(r,n,s))for(var l="array"===n.tickmode,c=0;c<o.length;c++){var u=o[c].x;if(l?!u:Math.abs(u)<n.dtick/100){if(o=o.slice(0,c).concat(o.slice(c+1)),!l)break;c--}}var f=i.layer.selectAll("path."+a).data(o,tg);f.exit().remove(),f.enter().append("path").classed(a,1).classed("crisp",!1!==i.crisp),n._gw=d.crispRound(r,n.gridwidth,1),f.attr("transform",i.transFn).attr("d",i.path).call(p.stroke,n.gridcolor||"#ddd").style("stroke-width",n._gw+"px").style("display",null),tS(n,[R]),"function"==typeof i.path&&f.attr("d",i.path)},q.drawZeroLine=function(r,n,i){i=i||i;var a=n._id+"zl",o=q.shouldShowZeroLine(r,n,i.counterAxis),s=i.layer.selectAll("path."+a).data(o?[{x:0,id:n._id}]:[]);s.exit().remove(),s.enter().append("path").classed(a,1).classed("zl",1).classed("crisp",!1!==i.crisp).each(function(){i.layer.selectAll("path").sort(function(r,n){return W(r.id,n.id)})}),s.attr("transform",i.transFn).attr("d",i.path).call(p.stroke,n.zerolinecolor||p.defaultLine).style("stroke-width",d.crispRound(r,n.zerolinewidth,n._gw||1)+"px").style("display",null),tS(n,[D])},q.drawLabels=function(r,n,i){i=i||{};var s=r._fullLayout,l=n._id,h=l.charAt(0),p=i.cls||l+"tick",m=i.vals,g=i.labelFns,v=i.secondary?0:n.tickangle,y=(n._prevTickAngles||{})[p],x=i.layer.selectAll("g."+p).data(n.showticklabels?m:[],tg),b=[];function _(r,s){r.each(function(r){var l=a.select(this),c=l.select(".text-math-group"),h=g.anchorFn(r,s),p=i.transFn.call(l.node(),r)+(o(s)&&0!=+s?" rotate("+s+","+g.xFn(r)+","+(g.yFn(r)-r.fontSize/2)+")":""),m=f.lineCount(l),v=V*r.fontSize,y=g.heightFn(r,o(s)?+s:0,(m-1)*v);if(y&&(p+=u(0,y)),c.empty()){var x=l.select("text");x.attr({transform:p,"text-anchor":h}),x.style("opacity",1),n._adjustTickLabelsOverflow&&n._adjustTickLabelsOverflow()}else{var b=d.bBox(c.node()).width*({end:-.5,start:.5})[h];c.attr("transform",p+u(b,0))}})}x.enter().append("g").classed(p,1).append("text").attr("text-anchor","middle").each(function(n){var i=a.select(this),o=r._promises.length;i.call(f.positionText,g.xFn(n),g.yFn(n)).call(d.font,n.font,n.fontSize,n.fontColor).text(n.text).call(f.convertToTspans,r),r._promises[o]?b.push(r._promises.pop().then(function(){_(i,v)})):_(i,v)}),tS(n,[B]),x.exit().remove(),i.repositionOnUpdate&&x.each(function(r){a.select(this).select("text").call(f.positionText,g.xFn(r),g.yFn(r))}),n._adjustTickLabelsOverflow=function(){var i=n.ticklabeloverflow;if(i&&"allow"!==i){var o=-1!==i.indexOf("hide"),l="x"===n._id.charAt(0),u=0,f=l?r._fullLayout.width:r._fullLayout.height;if(-1!==i.indexOf("domain")){var h=c.simpleMap(n.range,n.r2l);u=n.l2p(h[0])+n._offset,f=n.l2p(h[1])+n._offset}var p=Math.min(u,f),m=Math.max(u,f),g=n.side,v=1/0,y=-1/0;for(var b in x.each(function(r){var i=a.select(this);if(i.select(".text-math-group").empty()){var s=d.bBox(i.node()),c=0;l?(s.right>m||s.left<p)&&(c=1):(s.bottom>m||s.top+(n.tickangle?0:r.fontSize/4)<p)&&(c=1);var u=i.select("text");c?o&&u.style("opacity",0):(u.style("opacity",1),v="bottom"===g||"right"===g?Math.min(v,l?s.top:s.left):-1/0,y="top"===g||"left"===g?Math.max(y,l?s.bottom:s.right):1/0)}}),s._plots){var _=s._plots[b];if(n._id===_.xaxis._id||n._id===_.yaxis._id){var w=l?_.yaxis:_.xaxis;w&&(w["_visibleLabelMin_"+n._id]=v,w["_visibleLabelMax_"+n._id]=y)}}}},n._hideCounterAxisInsideTickLabels=function(r){var i="x"===n._id.charAt(0),o=[];for(var l in s._plots){var c=s._plots[l];n._id!==c.xaxis._id&&n._id!==c.yaxis._id||o.push(i?c.yaxis:c.xaxis)}o.forEach(function(i,o){i&&tM(i)&&(r||[D,R,F,B]).forEach(function(r){var l="tick"===r.K&&"text"===r.L&&"period"===n.ticklabelmode,c=s._plots[n._mainSubplot];(r.K===D.K?c.zerolinelayer.selectAll("."+n._id+"zl"):r.K===R.K?c.gridlayer.selectAll("."+n._id):c[n._id.charAt(0)+"axislayer"]).each(function(){var s=a.select(this);r.L&&(s=s.selectAll(r.L)),s.each(function(s){var c=n.l2p(l?tm(s):s.x)+n._offset,u=a.select(this);c<n["_visibleLabelMax_"+i._id]&&c>n["_visibleLabelMin_"+i._id]?u.style("display","none"):"tick"!==r.K||o||u.style("display",null)})})})})},_(x,y+1?y:v);var w=null;n._selections&&(n._selections[p]=x);var T=[function(){return b.length&&Promise.all(b)}];n.automargin&&s._redrawFromAutoMarginCount&&90===y?(w=90,T.push(function(){_(x,y)})):T.push(function(){if(_(x,v),m.length&&"x"===h&&!o(v)&&("log"!==n.type||"D"!==String(n.dtick).charAt(0))){w=0;var r,a=0,s=[];if(x.each(function(r){a=Math.max(a,r.fontSize);var i=n.l2p(r.x),o=tx(this),l=d.bBox(o.node());s.push({top:0,bottom:10,height:10,left:i-l.width/2,right:i+l.width/2+2,width:l.width+2})}),"boundaries"!==n.tickson&&!n.showdividers||i.secondary){var l=m.length,u=Math.abs((m[l-1].x-m[0].x)*n._m)/(l-1),f=n.ticklabelposition||"",p=function(r){return -1!==f.indexOf(r)},g=p("top"),y=p("left"),b=p("right"),T=p("bottom")||y||g||b?(n.tickwidth||0)+6:0,k=u<2.5*a||"multicategory"===n.type||"realaxis"===n._name;for(r=0;r<s.length-1;r++)if(c.bBoxIntersect(s[r],s[r+1],T)){w=k?90:30;break}}else{var A=2;for(n.ticks&&(A+=n.tickwidth/2),r=0;r<s.length;r++){var M=m[r].xbnd,S=s[r];if(null!==M[0]&&S.left-n.l2p(M[0])<A||null!==M[1]&&n.l2p(M[1])-S.right<A){w=90;break}}}w&&_(x,w)}}),n._tickAngles&&T.push(function(){n._tickAngles[p]=null===w?o(v)?v:0:w});var k=n._anchorAxis;k&&k.autorange&&tM(n)&&!X(s,n._id)&&(s._insideTickLabelsAutorange||(s._insideTickLabelsAutorange={}),s._insideTickLabelsAutorange[k._name+".autorange"]=k.autorange,T.push(function(){x.each(function(r,i){var a=tx(this);a.select(".text-math-group").empty()&&(n._vals[i].bb=d.bBox(a.node()))})}));var A=c.syncOrAsync(T);return A&&A.then&&r._promises.push(A),A},q.getPxPosition=function(r,n){var i,a=r._fullLayout._size,o=n._id.charAt(0),s=n.side;return"free"!==n.anchor?i=n._anchorAxis:"x"===o?i={_offset:a.t+(1-(n.position||0))*a.h,_length:0}:"y"===o&&(i={_offset:a.l+(n.position||0)*a.w,_length:0}),"top"===s||"left"===s?i._offset:"bottom"===s||"right"===s?i._offset+i._length:void 0},q.shouldShowZeroLine=function(r,n,i){var a=c.simpleMap(n.range,n.r2l);return a[0]*a[1]<=0&&n.zeroline&&("linear"===n.type||"-"===n.type)&&!(n.rangebreaks&&n.maskBreaks(0)===z)&&(ty(n,0)||!function(r,n,i,a){var o=i._mainAxis;if(o){var s=r._fullLayout,l=n._id.charAt(0),c=q.counterLetter(n._id),u=n._offset+(Math.abs(a[0])<Math.abs(a[1])==("x"===l)?0:n._length),f=s._plots[i._mainSubplot];if(!(f.mainplotinfo||f).overlays.length)return m(i);for(var h=q.list(r,c),p=0;p<h.length;p++){var d=h[p];if(d._mainAxis===o&&m(d))return!0}}function m(r){if(!r.showline||!r.linewidth)return!1;var i=Math.max((r.linewidth+n.zerolinewidth)/2,1);function a(r){return"number"==typeof r&&Math.abs(r-u)<i}if(a(r._mainLinePosition)||a(r._mainMirrorPosition))return!0;var o=r._linepositions||{};for(var s in o)if(a(o[s][0])||a(o[s][1]))return!0}}(r,n,i,a)||function(r,n){for(var i=r._fullData,a=n._mainSubplot,o=n._id.charAt(0),s=0;s<i.length;s++){var c=i[s];if(!0===c.visible&&c.xaxis+c.yaxis===a&&(l.traceIs(c,"bar-like")&&c.orientation===({x:"h",y:"v"})[o]||c.fill&&c.fill.charAt(c.fill.length-1)===o))return!0}return!1}(r,n))},q.clipEnds=function(r,n){return n.filter(function(n){return ty(r,n.x)})},q.allowAutoMargin=function(r){for(var n=q.list(r,"",!0),i=0;i<n.length;i++){var a=n[i];a.automargin&&(s.allowAutoMargin(r,tb(a)),a.mirror&&s.allowAutoMargin(r,t_(a))),l.getComponentMethod("rangeslider","isVisible")(a)&&s.allowAutoMargin(r,tw(a))}},q.swap=function(r,n){for(var i=function(r,n){var i,a,o=[];for(i=0;i<n.length;i++){var s=[],l=r._fullData[n[i]].xaxis,c=r._fullData[n[i]].yaxis;if(l&&c){for(a=0;a<o.length;a++)-1===o[a].x.indexOf(l)&&-1===o[a].y.indexOf(c)||s.push(a);if(s.length){var u,f=o[s[0]];if(s.length>1)for(a=1;a<s.length;a++)u=o[s[a]],tT(f.x,u.x),tT(f.y,u.y);tT(f.x,[l]),tT(f.y,[c])}else o.push({x:[l],y:[c]})}}return o}(r,n),a=0;a<i.length;a++)(function(r,n,i){var a,o,s=[],l=[],u=r.layout;for(a=0;a<n.length;a++)s.push(q.getFromId(r,n[a]));for(a=0;a<i.length;a++)l.push(q.getFromId(r,i[a]));var f=Object.keys(m),h=["anchor","domain","overlaying","position","side","tickangle","editType"],p=["linear","log"];for(a=0;a<f.length;a++){var d=f[a],g=s[0][d],v=l[0][d],y=!0,x=!1,b=!1;if("_"!==d.charAt(0)&&"function"!=typeof g&&-1===h.indexOf(d)){for(o=1;o<s.length&&y;o++){var _=s[o][d];"type"===d&&-1!==p.indexOf(g)&&-1!==p.indexOf(_)&&g!==_?x=!0:_!==g&&(y=!1)}for(o=1;o<l.length&&y;o++){var w=l[o][d];"type"===d&&-1!==p.indexOf(v)&&-1!==p.indexOf(w)&&v!==w?b=!0:l[o][d]!==v&&(y=!1)}y&&(x&&(u[s[0]._name].type="linear"),b&&(u[l[0]._name].type="linear"),function(r,n,i,a,o){var s,l=c.nestedProperty,u=l(r[i[0]._name],n).get(),f=l(r[a[0]._name],n).get();for("title"===n&&(u&&u.text===o.x&&(u.text=o.y),f&&f.text===o.y&&(f.text=o.x)),s=0;s<i.length;s++)l(r,i[s]._name+"."+n).set(f);for(s=0;s<a.length;s++)l(r,a[s]._name+"."+n).set(u)}(u,d,s,l,r._fullLayout._dfltTitle))}}for(a=0;a<r._fullLayout.annotations.length;a++){var T=r._fullLayout.annotations[a];-1!==n.indexOf(T.xref)&&-1!==i.indexOf(T.yref)&&c.swapAttrs(u.annotations[a],["?"])}})(r,i[a].x,i[a].y)}},{"../../components/color":366,"../../components/drawing":388,"../../components/titles":464,"../../constants/alignment":471,"../../constants/numerical":479,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../../registry":638,"./autorange":553,"./axis_autotype":555,"./axis_ids":558,"./clean_ticks":560,"./layout_attributes":569,"./set_convert":576,"@plotly/d3":58,"fast-isnumeric":190}],555:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../../constants/numerical").BADNUM,l=o.isArrayOrTypedArray,c=o.isDateTime,u=o.cleanNumber,f=Math.round;function h(r){return Math.max(1,(r-1)/1e3)}n.exports=function(r,n,i){var o,p=r,d=i.noMultiCategory;if(l(p)&&!p.length)return"-";if(!d&&l((o=p)[0])&&l(o[1]))return"multicategory";if(d&&Array.isArray(p[0])){for(var m=[],g=0;g<p.length;g++)if(l(p[g]))for(var v=0;v<p[g].length;v++)m.push(p[g][v]);p=m}if(function(r,n){for(var i=r.length,o=h(i),s=0,l=0,u={},p=0;p<i;p+=o){var d=r[f(p)],m=String(d);u[m]||(u[m]=1,c(d,n)&&s++,a(d)&&l++)}return s>2*l}(p,n))return"date";var y="strict"!==i.autotypenumbers;return!function(r,n){for(var i=r.length,a=h(i),o=0,l=0,c={},p=0;p<i;p+=a){var d=r[f(p)],m=String(d);if(!c[m]){c[m]=1;var g=typeof d;"boolean"===g?l++:(n?u(d)!==s:"number"===g)?o++:"string"===g&&l++}}return l>2*o}(p,y)?!function(r,n){for(var i,o=r.length,s=0;s<o;s++)if(i=r[s],n?a(i):"number"==typeof i)return!0;return!1}(p,y)?"-":"linear":"category"}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],556:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../registry"),s=r("../../lib"),l=r("../array_container_defaults"),c=r("./layout_attributes"),u=r("./tick_value_defaults"),f=r("./tick_mark_defaults"),h=r("./tick_label_defaults"),p=r("./prefix_suffix_defaults"),d=r("./category_order_defaults"),m=r("./line_grid_defaults"),g=r("./set_convert"),v=r("./constants").WEEKDAY_PATTERN,y=r("./constants").HOUR_PATTERN;function x(r,n,i){function o(i,a){return s.coerce(r,n,c.rangebreaks,i,a)}if(o("enabled")){var l=o("bounds");if(l&&l.length>=2){var u,f,h="";if(2===l.length){for(u=0;u<2;u++)if(f=_(l[u])){h=v;break}}var p=o("pattern",h);if(p===v)for(u=0;u<2;u++)(f=_(l[u]))&&(n.bounds[u]=l[u]=f-1);if(p)for(u=0;u<2;u++)switch(f=l[u],p){case v:if(!a(f)||(f=+f)!==Math.floor(f)||f<0||f>=7)return void(n.enabled=!1);n.bounds[u]=l[u]=f;break;case y:if(!a(f)||(f=+f)<0||f>24)return void(n.enabled=!1);n.bounds[u]=l[u]=f}if(!1===i.autorange){var d=i.range;if(d[0]<d[1]){if(l[0]<d[0]&&l[1]>d[1])return void(n.enabled=!1)}else if(l[0]>d[0]&&l[1]<d[1])return void(n.enabled=!1)}}else{var m=o("values");if(!m||!m.length)return void(n.enabled=!1);o("dvalue")}}}n.exports=function(r,n,i,a,y){var b,_=a.letter,w=a.font||{},T=a.splomStash||{},k=i("visible",!a.visibleDflt),A=n._template||{},M=n.type||A.type||"-";"date"===M&&(o.getComponentMethod("calendars","handleDefaults")(r,n,"calendar",a.calendar),a.noTicklabelmode||(b=i("ticklabelmode")));var S="";a.noTicklabelposition&&"multicategory"!==M||(S=s.coerce(r,n,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:"period"===b?["outside","inside"]:"x"===_?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),a.noTicklabeloverflow||i("ticklabeloverflow",-1!==S.indexOf("inside")?"hide past domain":"category"===M||"multicategory"===M?"allow":"hide past div"),g(n,y);var E=!n.isValidRange(r.range);E&&a.reverseDflt&&(E="reversed"),i("autorange",E)&&("linear"===M||"-"===M)&&i("rangemode"),i("range"),n.cleanRange(),d(r,n,i,a),"category"===M||a.noHover||i("hoverformat");var L=i("color"),C=L!==c.color.dflt?L:w.color,P=T.label||y._dfltTitle[_];if(p(r,n,i,M,a),!k)return n;i("title.text",P),s.coerceFont(i,"title.font",{family:w.family,size:s.bigFont(w.size),color:C}),u(r,n,i,M),h(r,n,i,M,a),f(r,n,i,a),m(r,n,i,{dfltColor:L,bgColor:a.bgColor,showGrid:a.showGrid,attributes:c}),(n.showline||n.ticks)&&i("mirror"),a.automargin&&i("automargin");var I,O="multicategory"===M;if(!a.noTickson&&("category"===M||O)&&(n.ticks||n.showgrid)&&(O&&(I="boundaries"),"boundaries"!==i("tickson",I)||delete n.ticklabelposition),O&&i("showdividers")&&(i("dividercolor"),i("dividerwidth")),"date"===M){if(l(r,n,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:x}),n.rangebreaks.length){for(var z=0;z<n.rangebreaks.length;z++)if(n.rangebreaks[z].pattern===v){n._hasDayOfWeekBreaks=!0;break}if(g(n,y),y._has("scattergl")||y._has("splom"))for(var D=0;D<a.data.length;D++){var R=a.data[D];"scattergl"!==R.type&&"splom"!==R.type||(R.visible=!1,s.warn(R.type+" traces do not work on axes with rangebreaks. Setting trace "+R.index+" to `visible: false`."))}}else delete n.rangebreaks}return n};var b={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function _(r){if("string"==typeof r)return b[r.substr(0,3).toLowerCase()]}},{"../../lib":503,"../../registry":638,"../array_container_defaults":549,"./category_order_defaults":559,"./constants":561,"./layout_attributes":569,"./line_grid_defaults":571,"./prefix_suffix_defaults":573,"./set_convert":576,"./tick_label_defaults":578,"./tick_mark_defaults":579,"./tick_value_defaults":580,"fast-isnumeric":190}],557:[function(r,n,i){"use strict";var a=r("../../constants/docs"),o=a.FORMAT_LINK,s=a.DATE_FORMAT_LINK;function l(r,n){return["Sets the "+r+" formatting rule"+(n?"for `"+n+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+o+"."].join(" ")}function c(r,n){return l(r,n)+[" And for dates see: "+s+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}n.exports={axisHoverFormat:function(r,n){return{valType:"string",dflt:"",editType:"none",description:(n?l:c)("hover text",r)+["By default the values are formatted using "+(n?"generic number format":"`"+r+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:l,descriptionWithDates:c}},{"../../constants/docs":474}],558:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("./constants");function s(r,n){if(n&&n.length){for(var i=0;i<n.length;i++)if(n[i][r])return!0}return!1}i.id2name=function(r){if("string"==typeof r&&r.match(o.AX_ID_PATTERN)){var n=r.split(" ")[0].substr(1);return"1"===n&&(n=""),r.charAt(0)+"axis"+n}},i.name2id=function(r){if(r.match(o.AX_NAME_PATTERN)){var n=r.substr(5);return"1"===n&&(n=""),r.charAt(0)+n}},i.cleanId=function(r,n,i){var a=/( domain)$/.test(r);if("string"==typeof r&&r.match(o.AX_ID_PATTERN)&&(!n||r.charAt(0)===n)&&(!a||i)){var s=r.split(" ")[0].substr(1).replace(/^0+/,"");return"1"===s&&(s=""),r.charAt(0)+s+(a&&i?" domain":"")}},i.list=function(r,n,a){var o=r._fullLayout;if(!o)return[];var s,l=i.listIds(r,n),c=Array(l.length);for(s=0;s<l.length;s++){var u=l[s];c[s]=o[u.charAt(0)+"axis"+u.substr(1)]}if(!a){var f=o._subplots.gl3d||[];for(s=0;s<f.length;s++){var h=o[f[s]];n?c.push(h[n+"axis"]):c.push(h.xaxis,h.yaxis,h.zaxis)}}return c},i.listIds=function(r,n){var i=r._fullLayout;if(!i)return[];var a=i._subplots;return n?a[n+"axis"]:a.xaxis.concat(a.yaxis)},i.getFromId=function(r,n,a){var o=r._fullLayout;return n=void 0===n||"string"!=typeof n?n:n.replace(" domain",""),"x"===a?n=n.replace(/y[0-9]*/,""):"y"===a&&(n=n.replace(/x[0-9]*/,"")),o[i.id2name(n)]},i.getFromTrace=function(r,n,o){var s=r._fullLayout,l=null;if(a.traceIs(n,"gl3d")){var c=n.scene;"scene"===c.substr(0,5)&&(l=s[c][o+"axis"])}else l=i.getFromId(r,n[o+"axis"]||o);return l},i.idSort=function(r,n){var i=r.charAt(0),a=n.charAt(0);return i!==a?i>a?1:-1:+(r.substr(1)||1)-+(n.substr(1)||1)},i.ref2id=function(r){return!!/^[xyz]/.test(r)&&r.split(" ")[0]},i.isLinked=function(r,n){return s(n,r._axisMatchGroups)||s(n,r._axisConstraintGroups)}},{"../../registry":638,"./constants":561}],559:[function(r,n,i){"use strict";n.exports=function(r,n,i,a){if("category"===n.type){var o,s=r.categoryarray,l=Array.isArray(s)&&s.length>0;l&&(o="array");var c,u=i("categoryorder",o);"array"===u&&(c=i("categoryarray")),l||"array"!==u||(u=n.categoryorder="trace"),"trace"===u?n._initialCategories=[]:"array"===u?n._initialCategories=c.slice():(c=(function(r,n){var i,a,o,s=n.dataAttr||r._id.charAt(0),l={};if(n.axData)i=n.axData;else for(i=[],a=0;a<n.data.length;a++){var c=n.data[a];c[s+"axis"]===r._id&&i.push(c)}for(a=0;a<i.length;a++){var u=i[a][s];for(o=0;o<u.length;o++){var f=u[o];null!=f&&(l[f]=1)}}return Object.keys(l)})(n,a).sort(),"category ascending"===u?n._initialCategories=c:"category descending"===u&&(n._initialCategories=c.reverse()))}}},{}],560:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../../constants/numerical"),l=s.ONEDAY,c=s.ONEWEEK;i.dtick=function(r,n){var i="log"===n,o="date"===n,s=o?l:1;if(!r)return s;if(a(r))return(r=Number(r))<=0?s:"category"===n?Math.max(1,Math.round(r)):o?Math.max(.1,r):r;if("string"!=typeof r||!o&&!i)return s;var c=r.charAt(0),u=r.substr(1);return(u=a(u)?Number(u):0)<=0||!(o&&"M"===c&&u===Math.round(u)||i&&"L"===c||i&&"D"===c&&(1===u||2===u))?s:r},i.tick0=function(r,n,i,s){return"date"===n?o.cleanDate(r,o.dateTick0(i,s%c==0?1:0)):"D1"!==s&&"D2"!==s?a(r)?Number(r):0:void 0}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],561:[function(r,n,i){"use strict";var a=r("../../lib/regex").counter;n.exports={idRegex:{x:a("x","( domain)?"),y:a("y","( domain)?")},attrRegex:a("[xy]axis"),xAxisMatch:a("xaxis"),yAxisMatch:a("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":520}],562:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./autorange"),s=r("./axis_ids").id2name,l=r("./layout_attributes"),c=r("./scale_zoom"),u=r("./set_convert"),f=r("../../constants/numerical").ALMOST_EQUAL,h=r("../../constants/alignment").FROM_BL;function p(r,n){var i=n.domain;return i||(i=r[s(n.overlaying)].domain),i[1]-i[0]}function d(r,n){for(var i=0;i<r.length;i++)if(r[i][n])return r[i];return null}function m(r,n,i,a){var o,s,l,c,u,f=d(r,n);null===f?((f={})[n]=1,u=r.length,r.push(f)):u=r.indexOf(f);var h=Object.keys(f);for(o=0;o<r.length;o++)if(l=r[o],o!==u&&l[i]){var p=l[i];for(s=0;s<h.length;s++)l[c=h[s]]=g(p,g(a,f[c]));return void r.splice(u,1)}if(1!==a)for(s=0;s<h.length;s++){var m=h[s];f[m]=g(a,f[m])}f[i]=1}function g(r,n){var i,a,o="",s="";"string"==typeof r&&(i=(o=r.match(/^[xy]*/)[0]).length,r=+r.substr(i)),"string"==typeof n&&(a=(s=n.match(/^[xy]*/)[0]).length,n=+n.substr(a));var l=r*n;return i||a?i&&a&&o.charAt(0)!==s.charAt(0)?i===a?l:(i>a?o.substr(a):s.substr(i))+l:o+s+r*n:l}function v(r,n){var i=r._inputDomain,a=h[r.constraintoward],o=i[0]+(i[1]-i[0])*a;r.domain=r._input.domain=[o+(i[0]-o)/n,o+(i[1]-o)/n],r.setScale()}i.handleDefaults=function(r,n,i){var o,c,f,h,g,v,y,x,b=i.axIds,_=i.axHasImage,w=n._axisConstraintGroups=[],T=n._axisMatchGroups=[];for(o=0;o<b.length;o++)(function(r,n,i){var o=i.axIds,c=i.layoutOut,u=i.hasImage,f=c._axisConstraintGroups,h=c._axisMatchGroups,g=n._id,v=g.charAt(0),y=((c._splomAxes||{})[v]||{})[g]||{},x=n._id,b="x"===x.charAt(0);function _(i,o){return a.coerce(r,n,l,i,o)}n._matchGroup=null,n._constraintGroup=null,_("constrain",u?"domain":"range"),a.coerce(r,n,{constraintoward:{valType:"enumerated",values:b?["left","center","right"]:["bottom","middle","top"],dflt:b?"center":"middle"}},"constraintoward");var w,T,k=n.type,A=[];for(w=0;w<o.length;w++)(T=o[w])!==x&&c[s(T)].type===k&&A.push(T);var M=d(f,x);if(M){var S=[];for(w=0;w<A.length;w++)M[T=A[w]]||S.push(T);A=S}var E,L,C=A.length;C&&(r.matches||y.matches)&&(E=a.coerce(r,n,{matches:{valType:"enumerated",values:A,dflt:-1!==A.indexOf(y.matches)?y.matches:void 0}},"matches"));var P=u&&!b?n.anchor:void 0;if(C&&!E&&(r.scaleanchor||P)&&(L=a.coerce(r,n,{scaleanchor:{valType:"enumerated",values:A}},"scaleanchor",P)),E){n._matchGroup=m(h,x,E,1);var I=c[s(E)],O=p(c,n)/p(c,I);b!==("x"===E.charAt(0))&&(O=(b?"x":"y")+O),m(f,x,E,O)}else r.matches&&-1!==o.indexOf(r.matches)&&a.warn("ignored "+n._name+'.matches: "'+r.matches+'" to avoid an infinite loop');if(L){var z=_("scaleratio");z||(z=n.scaleratio=1),m(f,x,L,z)}else r.scaleanchor&&-1!==o.indexOf(r.scaleanchor)&&a.warn("ignored "+n._name+'.scaleanchor: "'+r.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')})(g=r[h=s(b[o])],v=n[h],{axIds:b,layoutOut:n,hasImage:_[h]});function k(r,i){for(o=0;o<r.length;o++)for(f in c=r[o])n[s(f)][i]=c}for(k(T,"_matchGroup"),o=0;o<w.length;o++)for(f in c=w[o])if((v=n[s(f)]).fixedrange){for(var A in c){var M=s(A);!1===(r[M]||{}).fixedrange&&a.warn("fixedrange was specified as false for axis "+M+" but was overridden because another axis in its constraint group has fixedrange true"),n[M].fixedrange=!0}break}for(o=0;o<w.length;){for(f in c=w[o]){(v=n[s(f)])._matchGroup&&Object.keys(v._matchGroup).length===Object.keys(c).length&&(w.splice(o,1),o--);break}o++}k(w,"_constraintGroup");var S=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],E=!1,L=!1;function C(){x=v[y],"rangebreaks"===y&&(L=v._hasDayOfWeekBreaks)}for(o=0;o<T.length;o++){c=T[o];for(var P,I=0;I<S.length;I++){for(f in y=S[I],x=null,c)if(g=r[h=s(f)],v=n[h],y in v){if(!v.matches&&(P=v,y in g)){C();break}null===x&&y in g&&C()}if("range"===y&&x&&(E=!0),"autorange"===y&&null===x&&E&&(x=!1),null===x&&y in P&&(x=P[y]),null!==x)for(f in c)(v=n[s(f)])[y]="range"===y?x.slice():x,"rangebreaks"===y&&(v._hasDayOfWeekBreaks=L,u(v,n))}}},i.enforce=function(r){var n,i,a,l,u,h,p,d,m=r._fullLayout,g=m._axisConstraintGroups||[];for(n=0;n<g.length;n++){var y=Object.keys(a=function(r,n){for(var i=n._size,a=i.h/i.w,o={},s=Object.keys(r),l=0;l<s.length;l++){var c=s[l],u=r[c];if("string"==typeof u){var f=u.match(/^[xy]*/)[0],h=f.length;u=+u.substr(h);for(var p="y"===f.charAt(0)?a:1/a,d=0;d<h;d++)u*=p}o[c]=u}return o}(g[n],m)),x=1/0,b=0,_=1/0,w={},T={},k=!1;for(i=0;i<y.length;i++)T[l=y[i]]=u=m[s(l)],u._inputDomain?u.domain=u._inputDomain.slice():u._inputDomain=u.domain.slice(),u._inputRange||(u._inputRange=u.range.slice()),u.setScale(),w[l]=h=Math.abs(u._m)/a[l],x=Math.min(x,h),"domain"!==u.constrain&&u._constraintShrinkable||(_=Math.min(_,h)),delete u._constraintShrinkable,b=Math.max(b,h),"domain"===u.constrain&&(k=!0);if(!(x>f*b)||k){for(i=0;i<y.length;i++)if(h=w[l=y[i]],p=(u=T[l]).constrain,h!==_||"domain"===p){if(d=h/_,"range"===p)c(u,d);else{var A=u._inputDomain,M=(u.domain[1]-u.domain[0])/(A[1]-A[0]),S=(u.r2l(u.range[1])-u.r2l(u.range[0]))/(u.r2l(u._inputRange[1])-u.r2l(u._inputRange[0]));if((d/=M)*S<1){u.domain=u._input.domain=A.slice(),c(u,d);continue}if(S<1&&(u.range=u._input.range=u._inputRange.slice(),d*=S),u.autorange){var E=u.r2l(u.range[0]),L=u.r2l(u.range[1]),C=(E+L)/2,P=C,I=C,O=Math.abs(L-C),z=C-O*d*1.0001,D=C+O*d*1.0001,R=o.makePadFn(m,u,0),F=o.makePadFn(m,u,1);v(u,d);var B,N,j=Math.abs(u._m),U=o.concatExtremes(r,u),V=U.min,H=U.max;for(N=0;N<V.length;N++)(B=V[N].val-R(V[N])/j)>z&&B<P&&(P=B);for(N=0;N<H.length;N++)(B=H[N].val+F(H[N])/j)<D&&B>I&&(I=B);d/=(I-P)/(2*O),P=u.l2r(P),I=u.l2r(I),u.range=u._input.range=E<L?[P,I]:[I,P]}v(u,d)}}}}},i.getAxisGroup=function(r,n){for(var i=r._axisMatchGroups,a=0;a<i.length;a++)if(i[a][n])return"g"+a;return n},i.clean=function(r,n){if(n._inputDomain){for(var i=!1,a=n._id,o=r._fullLayout._axisConstraintGroups,s=0;s<o.length;s++)if(o[s][a]){i=!0;break}i&&"domain"===n.constrain||(n._input.domain=n.domain=n._inputDomain,delete n._inputDomain)}}},{"../../constants/alignment":471,"../../constants/numerical":479,"../../lib":503,"./autorange":553,"./axis_ids":558,"./layout_attributes":569,"./scale_zoom":574,"./set_convert":576}],563:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=o.numberFormat,l=r("tinycolor2"),c=r("has-passive-events"),u=r("../../registry"),f=o.strTranslate,h=r("../../lib/svg_text_utils"),p=r("../../components/color"),d=r("../../components/drawing"),m=r("../../components/fx"),g=r("./axes"),v=r("../../lib/setcursor"),y=r("../../components/dragelement"),x=r("../../components/dragelement/helpers"),b=x.selectingOrDrawing,_=x.freeMode,w=r("../../constants/alignment").FROM_TL,T=r("../../lib/clear_gl_canvases"),k=r("../../plot_api/subroutines").redrawReglTraces,A=r("../plots"),M=r("./axis_ids").getFromId,S=r("./select").prepSelect,E=r("./select").clearSelect,L=r("./select").selectOnClick,C=r("./scale_zoom"),P=r("./constants"),I=P.MINDRAG,O=P.MINZOOM,z=!0;function D(r,n,i,a){var s=o.ensureSingle(r.draglayer,n,i,function(n){n.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",r.id)});return s.call(v,a),s.node()}function R(r,n,i,o,s,l,c){var u=D(r,"rect",n,i);return a.select(u).call(d.setRect,o,s,l,c),u}function F(r,n){for(var i=0;i<r.length;i++)if(!r[i].fixedrange)return n;return""}function B(r,n,i,a,o){for(var s=0;s<r.length;s++){var l=r[s];if(!l.fixedrange){if(l.rangebreaks){var c="y"===l._id.charAt(0),u=c?1-n:n,f=c?1-i:i;a[l._name+".range[0]"]=l.l2r(l.p2l(u*l._length)),a[l._name+".range[1]"]=l.l2r(l.p2l(f*l._length))}else{var h=l._rl[0],p=l._rl[1]-h;a[l._name+".range[0]"]=l.l2r(h+p*n),a[l._name+".range[1]"]=l.l2r(h+p*i)}}}if(o&&o.length){var d=(n+(1-i))/2;B(o,d,1-d,a,[])}}function N(r,n){for(var i=0;i<r.length;i++){var a=r[i];if(!a.fixedrange){if(a.rangebreaks){var o=a._length,s=(a.p2l(0+n)-a.p2l(0)+(a.p2l(o+n)-a.p2l(o)))/2;a.range=[a.l2r(a._rl[0]-s),a.l2r(a._rl[1]-s)]}else a.range=[a.l2r(a._rl[0]-n/a._m),a.l2r(a._rl[1]-n/a._m)]}}}function j(r,n,i,a,o){return r.append("path").attr("class","zoombox").style({fill:n>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",f(i,a)).attr("d",o+"Z")}function U(r,n,i){return r.append("path").attr("class","zoombox-corners").style({fill:p.background,stroke:p.defaultLine,"stroke-width":1,opacity:0}).attr("transform",f(n,i)).attr("d","M0,0Z")}function V(r,n,i,a,o,s){r.attr("d",a+"M"+i.l+","+i.t+"v"+i.h+"h"+i.w+"v-"+i.h+"h-"+i.w+"Z"),H(r,n,o,s)}function H(r,n,i,a){i||(r.transition().style("fill",a>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),n.transition().style("opacity",1).duration(200))}function q(r){a.select(r).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function G(r){z&&r.data&&r._context.showTips&&(o.notifier(o._(r,"Double-click to zoom back out"),"long"),z=!1)}function Y(r){var n=Math.floor(Math.min(r.b-r.t,r.r-r.l,O)/2);return"M"+(r.l-3.5)+","+(r.t-.5+n)+"h3v"+-n+"h"+n+"v-3h-"+(n+3)+"ZM"+(r.r+3.5)+","+(r.t-.5+n)+"h-3v"+-n+"h"+-n+"v-3h"+(n+3)+"ZM"+(r.r+3.5)+","+(r.b+.5-n)+"h-3v"+n+"h"+-n+"v3h"+(n+3)+"ZM"+(r.l-3.5)+","+(r.b+.5-n)+"h3v"+n+"h"+n+"v3h-"+(n+3)+"Z"}function W(r,n,i,a,s){for(var l,c,u,f,h=!1,p={},d={},m=(s||{}).xaHash,g=(s||{}).yaHash,v=0;v<n.length;v++){var y=n[v];for(l in i)if(y[l]){for(u in y)s&&(m[u]||g[u])||("x"===u.charAt(0)?i:a)[u]||(p[u]=l);for(c in a)s&&(m[c]||g[c])||!y[c]||(h=!0)}for(c in a)if(y[c])for(f in y)s&&(m[f]||g[f])||("x"===f.charAt(0)?i:a)[f]||(d[f]=c)}h&&(o.extendFlat(p,d),d={});var x={},b=[];for(u in p){var _=M(r,u);b.push(_),x[_._id]=_}var w={},T=[];for(f in d){var k=M(r,f);T.push(k),w[k._id]=k}return{xaHash:x,yaHash:w,xaxes:b,yaxes:T,xLinks:p,yLinks:d,isSubplotConstrained:h}}function X(r,n){if(c){var i=void 0!==r.onwheel?"wheel":"mousewheel";r._onwheel&&r.removeEventListener(i,r._onwheel),r._onwheel=n,r.addEventListener(i,n,{passive:!1})}else void 0!==r.onwheel?r.onwheel=n:void 0!==r.onmousewheel?r.onmousewheel=n:r.isAddedWheelEvent||(r.isAddedWheelEvent=!0,r.addEventListener("wheel",n,{passive:!1}))}function Z(r){var n=[];for(var i in r)n.push(r[i]);return n}n.exports={makeDragBox:function(r,n,i,c,f,p,v,x){var z,D,H,J,K,Q,$,tt,te,tr,tn,ti,ta,to,ts,tl,tc,tu,tf,th,tp,td,tm,tg=r._fullLayout._zoomlayer,tv=v+x==="nsew",ty=1===(v+x).length;function tx(){if(z=n.xaxis,D=n.yaxis,te=z._length,tr=D._length,$=z._offset,tt=D._offset,(H={})[z._id]=z,(J={})[D._id]=D,v&&x)for(var i=n.overlays,a=0;a<i.length;a++){var o=i[a].xaxis;H[o._id]=o;var s=i[a].yaxis;J[s._id]=s}K=Z(H),Q=Z(J),ta=F(K,x),ts=!(to=F(Q,v))&&!ta,ti=W(r,r._fullLayout._axisMatchGroups,H,J);var l=(tn=W(r,r._fullLayout._axisConstraintGroups,H,J,ti)).isSubplotConstrained||ti.isSubplotConstrained;tl=x||l,tc=v||l;var c=r._fullLayout;tu=c._has("scattergl"),tf=c._has("splom"),th=c._has("svg")}tx();var tb=R(n,v+x+"drag",(t_=to+ta,tw=r._fullLayout.dragmode,t_?"nsew"===t_?tv?"":"pan"===tw?"move":"crosshair":t_.toLowerCase()+"-resize":"pointer"),i,c,f,p);if(ts&&!tv)return tb.onmousedown=null,tb.style.pointerEvents="none",tb;var t_,tw,tT,tk,tA,tM,tS,tE,tL,tC,tP,tI,tO={element:tb,gd:r,plotinfo:n};function tz(){tO.plotinfo.selection=!1,E(r)}function tD(i,o){var l=tO.gd;if(l._fullLayout._activeShapeIndex>=0)l._fullLayout._deactivateShape(l);else{var c=l._fullLayout.clickmode;if(q(l),2!==i||ty||function(){if(!r._transitioningWithDuration){var n=r._context.doubleClick,i=[];ta&&(i=i.concat(K)),to&&(i=i.concat(Q)),ti.xaxes&&(i=i.concat(ti.xaxes)),ti.yaxes&&(i=i.concat(ti.yaxes));var a,o,s,l={};if("reset+autosize"===n){for(n="autosize",o=0;o<i.length;o++)if((a=i[o])._rangeInitial&&(a.range[0]!==a._rangeInitial[0]||a.range[1]!==a._rangeInitial[1])||!a._rangeInitial&&!a.autorange){n="reset";break}}if("autosize"===n)for(o=0;o<i.length;o++)(a=i[o]).fixedrange||(l[a._name+".autorange"]=!0);else if("reset"===n)for((ta||tn.isSubplotConstrained)&&(i=i.concat(tn.xaxes)),to&&!tn.isSubplotConstrained&&(i=i.concat(tn.yaxes)),tn.isSubplotConstrained&&(ta?to||(i=i.concat(Q)):i=i.concat(K)),o=0;o<i.length;o++)(a=i[o]).fixedrange||(a._rangeInitial?(s=a._rangeInitial,l[a._name+".range[0]"]=s[0],l[a._name+".range[1]"]=s[1]):l[a._name+".autorange"]=!0);r.emit("plotly_doubleclick",null),u.call("_guiRelayout",r,l)}}(),tv)c.indexOf("select")>-1&&L(o,l,K,Q,n.id,tO),c.indexOf("event")>-1&&m.click(l,o,n.id);else if(1===i&&ty){var f,p,d=v?D:z,g="s"===v||"w"===x?0:1,y=d._name+".range["+g+"]",b=(p=Math.abs((f=d.range[g])-d.range[1-g]),"date"===d.type?f:"log"===d.type?s("."+(Math.ceil(Math.max(0,-Math.log(p)/Math.LN10))+3)+"g")(Math.pow(10,f)):s("."+String(Math.floor(Math.log(Math.abs(f))/Math.LN10)-Math.floor(Math.log(p)/Math.LN10)+4)+"g")(f)),_="left",w="middle";if(d.fixedrange)return;v?(w="n"===v?"top":"bottom","right"===d.side&&(_="right")):"e"===x&&(_="right"),l._context.showAxisRangeEntryBoxes&&a.select(tb).call(h.makeEditable,{gd:l,immediate:!0,background:l._fullLayout.paper_bgcolor,text:String(b),fill:d.tickfont?d.tickfont.color:"#444",horizontalAlign:_,verticalAlign:w}).on("edit",function(r){var n=d.d2r(r);void 0!==n&&u.call("_guiRelayout",l,y,n)})}}}function tR(n,i){if(r._transitioningWithDuration)return!1;var a,o,s,l,c=Math.max(0,Math.min(te,td*n+tT)),u=Math.max(0,Math.min(tr,tm*i+tk)),f=Math.abs(c-tT),h=Math.abs(u-tk);function p(){tL="",tA.r=tA.l,tA.t=tA.b,tP.attr("d","M0,0Z")}if(tA.l=Math.min(tT,c),tA.r=Math.max(tT,c),tA.t=Math.min(tk,u),tA.b=Math.max(tk,u),tn.isSubplotConstrained)f>O||h>O?(tL="xy",f/te>h/tr?(h=f*tr/te,tk>u?tA.t=tk-h:tA.b=tk+h):(f=h*te/tr,tT>c?tA.l=tT-f:tA.r=tT+f),tP.attr("d",Y(tA))):p();else if(ti.isSubplotConstrained){if(f>O||h>O){tL="xy";var d=Math.min(tA.l/te,(tr-tA.b)/tr),m=Math.max(tA.r/te,(tr-tA.t)/tr);tA.l=d*te,tA.r=m*te,tA.b=(1-d)*tr,tA.t=(1-m)*tr,tP.attr("d",Y(tA))}else p()}else!to||h<Math.min(Math.max(.6*f,I),O)?f<I||!ta?p():(tA.t=0,tA.b=tr,tL="x",tP.attr("d",(a=tA,o=tk,"M"+(a.l-.5)+","+(o-O-.5)+"h-3v"+(2*O+1)+"h3ZM"+(a.r+.5)+","+(o-O-.5)+"h3v"+(2*O+1)+"h-3Z"))):!ta||f<Math.min(.6*h,O)?(tA.l=0,tA.r=te,tL="y",tP.attr("d",(s=tA,"M"+((l=tT)-O-.5)+","+(s.t-.5)+"v-3h"+(2*O+1)+"v3ZM"+(l-O-.5)+","+(s.b+.5)+"v3h"+(2*O+1)+"v-3Z"))):(tL="xy",tP.attr("d",Y(tA)));tA.w=tA.r-tA.l,tA.h=tA.b-tA.t,tL&&(tI=!0),r._dragged=tI,V(tC,tP,tA,tS,tE,tM),tF(),r.emit("plotly_relayouting",tp),tE=!0}function tF(){tp={},"xy"!==tL&&"x"!==tL||(B(K,tA.l/te,tA.r/te,tp,tn.xaxes),tq("x",tp)),"xy"!==tL&&"y"!==tL||(B(Q,(tr-tA.b)/tr,(tr-tA.t)/tr,tp,tn.yaxes),tq("y",tp))}function tB(){tF(),q(r),tY(),G(r)}tO.prepFn=function(n,i,a){var s,c,u=tO.dragmode,f=r._fullLayout.dragmode;f!==u&&(tO.dragmode=f),tx(),td=r._fullLayout._invScaleX,tm=r._fullLayout._invScaleY,ts||(tv?n.shiftKey?"pan"===f?f="zoom":b(f)||(f="pan"):n.ctrlKey&&(f="pan"):f="pan"),_(f)?tO.minDrag=1:tO.minDrag=void 0,b(f)?(tO.xaxes=K,tO.yaxes=Q,S(n,i,a,tO,f)):(tO.clickFn=tD,b(u)&&tz(),ts||("zoom"===f?(tO.moveFn=tR,tO.doneFn=tB,tO.minDrag=1,tT=i-(s=tb.getBoundingClientRect()).left,tk=a-s.top,r._fullLayout._calcInverseTransform(r),tT=(c=o.apply3DTransform(r._fullLayout._invTransform)(tT,tk))[0],tk=c[1],tA={l:tT,r:tT,w:0,t:tk,b:tk,h:0},tM=r._hmpixcount?r._hmlumcount/r._hmpixcount:l(r._fullLayout.plot_bgcolor).getLuminance(),tE=!1,tL="xy",tI=!1,tC=j(tg,tM,$,tt,tS="M0,0H"+te+"V"+tr+"H0V0"),tP=U(tg,$,tt)):"pan"===f&&(tO.moveFn=tH,tO.doneFn=tY))),r._fullLayout._redrag=function(){var n=r._dragdata;n&&n.element===tb&&(b(r._fullLayout.dragmode)||(tx(),tW([0,0,te,tr]),tO.moveFn(n.dx,n.dy)))}},y.init(tO);var tN=[0,0,te,tr],tj=null,tU=P.REDRAWDELAY,tV=n.mainplot?r._fullLayout._plots[n.mainplot]:n;function tH(n,i){if(n*=td,i*=tm,!r._transitioningWithDuration){if(r._fullLayout._replotting=!0,"ew"===ta||"ns"===to){var a,o=ta?-n:0,s=to?-i:0;if(ti.isSubplotConstrained){if(ta&&to){var l=(n/te-i/tr)/2;o=-(n=l*te),s=-(i=-l*tr)}to?o=-s*te/tr:s=-o*tr/te}return ta&&(N(K,n),tq("x")),to&&(N(Q,i),tq("y")),tW([o,s,te,tr]),tG(),void r.emit("plotly_relayouting",tp)}var c,u,f="w"===ta==("n"===to)?1:-1;if(ta&&to&&(tn.isSubplotConstrained||ti.isSubplotConstrained)){var h=(n/te+f*i/tr)/2;n=h*te,i=f*h*tr}if("w"===ta?n=m(K,0,n):"e"===ta?n=m(K,1,-n):ta||(n=0),"n"===to?i=m(Q,1,i):"s"===to?i=m(Q,0,-i):to||(i=0),c="w"===ta?n:0,u="n"===to?i:0,tn.isSubplotConstrained&&!ti.isSubplotConstrained||ti.isSubplotConstrained&&ta&&to&&f>0){if(ti.isSubplotConstrained||!ta&&1===to.length){for(a=0;a<K.length;a++)K[a].range=K[a]._r.slice(),C(K[a],1-i/tr);c=(n=i*te/tr)/2}if(ti.isSubplotConstrained||!to&&1===ta.length){for(a=0;a<Q.length;a++)Q[a].range=Q[a]._r.slice(),C(Q[a],1-n/te);u=(i=n*tr/te)/2}}ti.isSubplotConstrained&&to||tq("x"),ti.isSubplotConstrained&&ta||tq("y");var p=te-n,d=tr-i;!ti.isSubplotConstrained||ta&&to||(ta?(u=c?0:n*tr/te,d=p*tr/te):(c=u?0:i*te/tr,p=d*te/tr)),tW([c,u,p,d]),tG(),r.emit("plotly_relayouting",tp)}function m(r,n,i){for(var a,o,s=1-n,l=0;l<r.length;l++){var c=r[l];if(!c.fixedrange){a=c,o=c._rl[s]+(c._rl[n]-c._rl[s])/(1-((u=i/c._length)>=0?Math.min(u,.9):1/(1/Math.max(u,-.3)+3.222)));var u,f=c.l2r(o);!1!==f&&void 0!==f&&(c.range[n]=f)}}return a._length*(a._rl[n]-o)/(a._rl[n]-a._rl[s])}}function tq(r,n){for(var i=ti.isSubplotConstrained?({x:Q,y:K})[r]:ti[r+"axes"],a=ti.isSubplotConstrained?({x:K,y:Q})[r]:[],o=0;o<i.length;o++){var s=i[o],l=s._id,c=ti.xLinks[l]||ti.yLinks[l],u=a[0]||H[c]||J[c];u&&(n?(n[s._name+".range[0]"]=n[u._name+".range[0]"],n[s._name+".range[1]"]=n[u._name+".range[1]"]):s.range=u.range.slice())}}function tG(){var n,i=[];function a(r){for(n=0;n<r.length;n++)r[n].fixedrange||i.push(r[n]._id)}for(tl&&(a(K),a(tn.xaxes),a(ti.xaxes)),tc&&(a(Q),a(tn.yaxes),a(ti.yaxes)),tp={},n=0;n<i.length;n++){var o=M(r,i[n]);g.drawOne(r,o,{skipTitle:!0}),tp[o._name+".range[0]"]=o.range[0],tp[o._name+".range[1]"]=o.range[1]}g.redrawComponents(r,i)}function tY(){tW([0,0,te,tr]),o.syncOrAsync([A.previousPromises,function(){r._fullLayout._replotting=!1,u.call("_guiRelayout",r,tp)}],r)}function tW(n){var i,a,s,l,c=r._fullLayout,f=c._plots,h=c._subplots.cartesian;if(tf&&u.subplotsRegistry.splom.drag(r),tu){for(i=0;i<h.length;i++)if(s=(a=f[h[i]]).xaxis,l=a.yaxis,a._scene){var p=o.simpleMap(s.range,s.r2l),m=o.simpleMap(l.range,l.r2l);a._scene.update({range:[p[0],m[0],p[1],m[1]]})}}if((tf||tu)&&(T(r),k(r)),th){var g=n[2]/z._length,y=n[3]/D._length;for(i=0;i<h.length;i++){s=(a=f[h[i]]).xaxis,l=a.yaxis;var b,_,w,A,M=(tl||ti.isSubplotConstrained)&&!s.fixedrange&&H[s._id],S=(tc||ti.isSubplotConstrained)&&!l.fixedrange&&J[l._id];if(M?(b=g,w=x||ti.isSubplotConstrained?n[0]:tJ(s,b)):ti.xaHash[s._id]?(b=g,w=n[0]*s._length/z._length):ti.yaHash[s._id]?(b=y,w="ns"===to?-n[1]*s._length/D._length:tJ(s,b,{n:"top",s:"bottom"}[to])):w=tZ(s,b=tX(s,g,y)),S?(_=y,A=v||ti.isSubplotConstrained?n[1]:tJ(l,_)):ti.yaHash[l._id]?(_=y,A=n[1]*l._length/D._length):ti.xaHash[l._id]?(_=g,A="ew"===ta?-n[0]*l._length/z._length:tJ(l,_,{e:"right",w:"left"}[ta])):A=tZ(l,_=tX(l,g,y)),b||_){b||(b=1),_||(_=1);var E=s._offset-w/b,L=l._offset-A/_;a.clipRect.call(d.setTranslate,w,A).call(d.setScale,b,_),a.plot.call(d.setTranslate,E,L).call(d.setScale,1/b,1/_),b===a.xScaleFactor&&_===a.yScaleFactor||(d.setPointGroupScale(a.zoomScalePts,b,_),d.setTextPointsScale(a.zoomScaleTxt,b,_)),d.hideOutsideRangePoints(a.clipOnAxisFalseTraces,a),a.xScaleFactor=b,a.yScaleFactor=_}}}}function tX(r,n,i){return r.fixedrange?0:tl&&tn.xaHash[r._id]?n:tc&&(tn.isSubplotConstrained?tn.xaHash:tn.yaHash)[r._id]?i:0}function tZ(r,n){return n?(r.range=r._r.slice(),C(r,n),tJ(r,n)):0}function tJ(r,n,i){return r._length*(1-n)*w[i||r.constraintoward||"middle"]}return v.length*x.length!=1&&X(tb,function(n){if(r._context._scrollZoom.cartesian||r._fullLayout._enablescrollzoom){if(tz(),r._transitioningWithDuration)return n.preventDefault(),void n.stopPropagation();tx(),clearTimeout(tj);var i=-n.deltaY;if(isFinite(i)||(i=n.wheelDelta/10),isFinite(i)){var a,s=Math.exp(-Math.min(Math.max(i,-20),20)/200),l=tV.draglayer.select(".nsewdrag").node().getBoundingClientRect(),c=(n.clientX-l.left)/l.width,u=(l.bottom-n.clientY)/l.height;if(tl){for(x||(c=.5),a=0;a<K.length;a++)f(K[a],c,s);tq("x"),tN[2]*=s,tN[0]+=tN[2]*c*(1/s-1)}if(tc){for(v||(u=.5),a=0;a<Q.length;a++)f(Q[a],u,s);tq("y"),tN[3]*=s,tN[1]+=tN[3]*(1-u)*(1/s-1)}tW(tN),tG(),r.emit("plotly_relayouting",tp),tj=setTimeout(function(){r._fullLayout&&(tN=[0,0,te,tr],tY())},tU),n.preventDefault()}else o.log("Did not find wheel motion attributes: ",n)}function f(r,n,i){if(!r.fixedrange){var a=o.simpleMap(r.range,r.r2l),s=a[0]+(a[1]-a[0])*n;r.range=a.map(function(n){return r.l2r(s+(n-s)*i)})}}}),tb},makeDragger:D,makeRectDragger:R,makeZoombox:j,makeCorners:U,updateZoombox:V,xyCorners:Y,transitionZoombox:H,removeZoombox:q,showDoubleClickNotifier:G,attachWheelEventHandler:X}},{"../../components/color":366,"../../components/dragelement":385,"../../components/dragelement/helpers":384,"../../components/drawing":388,"../../components/fx":406,"../../constants/alignment":471,"../../lib":503,"../../lib/clear_gl_canvases":487,"../../lib/setcursor":524,"../../lib/svg_text_utils":529,"../../plot_api/subroutines":544,"../../registry":638,"../plots":619,"./axes":554,"./axis_ids":558,"./constants":561,"./scale_zoom":574,"./select":575,"@plotly/d3":58,"has-passive-events":229,tinycolor2:312}],564:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/fx"),s=r("../../components/dragelement"),l=r("../../lib/setcursor"),c=r("./dragbox").makeDragBox,u=r("./constants").DRAGGERSIZE;i.initInteractions=function(r){var n=r._fullLayout;if(r._context.staticPlot)a.select(r).selectAll(".drag").remove();else if(n._has("cartesian")||n._has("splom")){Object.keys(n._plots||{}).sort(function(r,i){if((n._plots[r].mainplot&&!0)===(n._plots[i].mainplot&&!0)){var a=r.split("y"),o=i.split("y");return a[0]===o[0]?Number(a[1]||1)-Number(o[1]||1):Number(a[0]||1)-Number(o[0]||1)}return n._plots[r].mainplot?1:-1}).forEach(function(i){var a=n._plots[i],l=a.xaxis,f=a.yaxis;if(!a.mainplot){var h=c(r,a,l._offset,f._offset,l._length,f._length,"ns","ew");h.onmousemove=function(n){r._fullLayout._rehover=function(){r._fullLayout._hoversubplot===i&&r._fullLayout._plots[i]&&o.hover(r,n,i)},o.hover(r,n,i),r._fullLayout._lasthover=h,r._fullLayout._hoversubplot=i},h.onmouseout=function(n){r._dragging||(r._fullLayout._hoversubplot=null,s.unhover(r,n))},r._context.showAxisDragHandles&&(c(r,a,l._offset-u,f._offset-u,u,u,"n","w"),c(r,a,l._offset+l._length,f._offset-u,u,u,"n","e"),c(r,a,l._offset-u,f._offset+f._length,u,u,"s","w"),c(r,a,l._offset+l._length,f._offset+f._length,u,u,"s","e"))}if(r._context.showAxisDragHandles){if(i===l._mainSubplot){var p=l._mainLinePosition;"top"===l.side&&(p-=u),c(r,a,l._offset+.1*l._length,p,.8*l._length,u,"","ew"),c(r,a,l._offset,p,.1*l._length,u,"","w"),c(r,a,l._offset+.9*l._length,p,.1*l._length,u,"","e")}if(i===f._mainSubplot){var d=f._mainLinePosition;"right"!==f.side&&(d-=u),c(r,a,d,f._offset+.1*f._length,u,.8*f._length,"ns",""),c(r,a,d,f._offset+.9*f._length,u,.1*f._length,"s",""),c(r,a,d,f._offset,u,.1*f._length,"n","")}}});var l=n._hoverlayer.node();l.onmousemove=function(i){i.target=r._fullLayout._lasthover,o.hover(r,i,n._hoversubplot)},l.onclick=function(n){n.target=r._fullLayout._lasthover,o.click(r,n)},l.onmousedown=function(n){r._fullLayout._lasthover.onmousedown(n)},i.updateFx(r)}},i.updateFx=function(r){var n=r._fullLayout,i="pan"===n.dragmode?"move":"crosshair";l(n._draggers,i)}},{"../../components/dragelement":385,"../../components/fx":406,"../../lib/setcursor":524,"./constants":561,"./dragbox":563,"@plotly/d3":58}],565:[function(r,n,i){"use strict";n.exports={clearOutlineControllers:function(r){var n=r._fullLayout._zoomlayer;n&&n.selectAll(".outline-controllers").remove()},clearSelect:function(r){var n=r._fullLayout._zoomlayer;n&&n.selectAll(".select-outline").remove(),r._fullLayout._drawing=!1}}},{}],566:[function(r,n,i){"use strict";var a=r("../../lib").strTranslate;function o(r,n){switch(r.type){case"log":return r.p2d(n);case"date":return r.p2r(n,0,r.calendar);default:return r.p2r(n)}}n.exports={p2r:o,r2p:function(r,n){switch(r.type){case"log":return r.d2p(n);case"date":return r.r2p(n,0,r.calendar);default:return r.r2p(n)}},axValue:function(r){var n="y"===r._id.charAt(0)?1:0;return function(i){return o(r,i[n])}},getTransform:function(r){return a(r.xaxis._offset,r.yaxis._offset)}}},{"../../lib":503}],567:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("./axis_ids");n.exports=function(r){return function(n,i){var l=n[r];if(Array.isArray(l))for(var c=a.subplotsRegistry.cartesian,u=c.idRegex,f=i._subplots,h=f.xaxis,p=f.yaxis,d=f.cartesian,m=i._has("cartesian")||i._has("gl2d"),g=0;g<l.length;g++){var v=l[g];if(o.isPlainObject(v)){var y=s.cleanId(v.xref,"x",!1),x=s.cleanId(v.yref,"y",!1),b=u.x.test(y),_=u.y.test(x);if(b||_){m||o.pushUnique(i._basePlotModules,c);var w=!1;b&&-1===h.indexOf(y)&&(h.push(y),w=!0),_&&-1===p.indexOf(x)&&(p.push(x),w=!0),w&&b&&_&&d.push(y+x)}}}}}},{"../../lib":503,"../../registry":638,"./axis_ids":558}],568:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../registry"),s=r("../../lib"),l=r("../plots"),c=r("../../components/drawing"),u=r("../get_data").getModuleCalcData,f=r("./axis_ids"),h=r("./constants"),p=r("../../constants/xmlns_namespaces"),d=s.ensureSingle;function m(r,n,i){return s.ensureSingle(r,n,i,function(r){r.datum(i)})}function g(r,n,i,s,l){for(var f,p,d,m=h.traceLayerClasses,g=r._fullLayout,v=g._modules,y=[],x=[],b=0;b<v.length;b++){var _=(f=v[b]).name,w=o.modules[_].categories;if(w.svg){var T=f.layerName||_+"layer",k=f.plot;d=(p=u(i,k))[0],i=p[1],d.length&&y.push({i:m.indexOf(T),className:T,plotMethod:k,cdModule:d}),w.zoomScale&&x.push("."+T)}}y.sort(function(r,n){return r.i-n.i});var A=n.plot.selectAll("g.mlayer").data(y,function(r){return r.className});if(A.enter().append("g").attr("class",function(r){return r.className}).classed("mlayer",!0).classed("rangeplot",n.isRangePlot),A.exit().remove(),A.order(),A.each(function(i){var o=a.select(this),u=i.className;i.plotMethod(r,n,i.cdModule,o,s,l),-1===h.clipOnAxisFalseQuery.indexOf("."+u)&&c.setClipUrl(o,n.layerClipId,r)}),g._has("scattergl")&&(d=u(i,f=o.getModule("scattergl"))[0],f.plot(r,n,d)),!r._context.staticPlot&&(n._hasClipOnAxisFalse&&(n.clipOnAxisFalseTraces=n.plot.selectAll(h.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),x.length)){var M=n.plot.selectAll(x.join(",")).selectAll(".trace");n.zoomScalePts=M.selectAll("path.point"),n.zoomScaleTxt=M.selectAll(".textpoint")}}function v(r,n){var i=n.plotgroup,a=n.id,o=h.layerValue2layerClass[n.xaxis.layer],s=h.layerValue2layerClass[n.yaxis.layer],l=r._fullLayout._hasOnlyLargeSploms;if(n.mainplot){var c=n.mainplotinfo,u=c.plotgroup,p=a+"-x",g=a+"-y";n.gridlayer=c.gridlayer,n.zerolinelayer=c.zerolinelayer,d(c.overlinesBelow,"path",p),d(c.overlinesBelow,"path",g),d(c.overaxesBelow,"g",p),d(c.overaxesBelow,"g",g),n.plot=d(c.overplot,"g",a),d(c.overlinesAbove,"path",p),d(c.overlinesAbove,"path",g),d(c.overaxesAbove,"g",p),d(c.overaxesAbove,"g",g),n.xlines=u.select(".overlines-"+o).select("."+p),n.ylines=u.select(".overlines-"+s).select("."+g),n.xaxislayer=u.select(".overaxes-"+o).select("."+p),n.yaxislayer=u.select(".overaxes-"+s).select("."+g)}else if(l)n.xlines=d(i,"path","xlines-above"),n.ylines=d(i,"path","ylines-above"),n.xaxislayer=d(i,"g","xaxislayer-above"),n.yaxislayer=d(i,"g","yaxislayer-above");else{var v=d(i,"g","layer-subplot");n.shapelayer=d(v,"g","shapelayer"),n.imagelayer=d(v,"g","imagelayer"),n.gridlayer=d(i,"g","gridlayer"),n.zerolinelayer=d(i,"g","zerolinelayer"),d(i,"path","xlines-below"),d(i,"path","ylines-below"),n.overlinesBelow=d(i,"g","overlines-below"),d(i,"g","xaxislayer-below"),d(i,"g","yaxislayer-below"),n.overaxesBelow=d(i,"g","overaxes-below"),n.plot=d(i,"g","plot"),n.overplot=d(i,"g","overplot"),n.xlines=d(i,"path","xlines-above"),n.ylines=d(i,"path","ylines-above"),n.overlinesAbove=d(i,"g","overlines-above"),d(i,"g","xaxislayer-above"),d(i,"g","yaxislayer-above"),n.overaxesAbove=d(i,"g","overaxes-above"),n.xlines=i.select(".xlines-"+o),n.ylines=i.select(".ylines-"+s),n.xaxislayer=i.select(".xaxislayer-"+o),n.yaxislayer=i.select(".yaxislayer-"+s)}l||(m(n.gridlayer,"g",n.xaxis._id),m(n.gridlayer,"g",n.yaxis._id),n.gridlayer.selectAll("g").map(function(r){return r[0]}).sort(f.idSort)),n.xlines.style("fill","none").classed("crisp",!0),n.ylines.style("fill","none").classed("crisp",!0)}function y(r,n){if(r){var i={};for(var o in r.each(function(r){var o=r[0];a.select(this).remove(),x(o,n),i[o]=!0}),n._plots)for(var s=n._plots[o].overlays||[],l=0;l<s.length;l++){var c=s[l];i[c.id]&&c.plot.selectAll(".trace").remove()}}}function x(r,n){n._draggers.selectAll("g."+r).remove(),n._defs.select("#clip"+n._uid+r+"plot").remove()}i.name="cartesian",i.attr=["xaxis","yaxis"],i.idRoot=["x","y"],i.idRegex=h.idRegex,i.attrRegex=h.attrRegex,i.attributes=r("./attributes"),i.layoutAttributes=r("./layout_attributes"),i.supplyLayoutDefaults=r("./layout_defaults"),i.transitionAxes=r("./transition_axes"),i.finalizeSubplots=function(r,n){var i,a,o,l=n._subplots,c=l.xaxis,u=l.yaxis,p=l.cartesian,d=p.concat(l.gl2d||[]),m={},g={};for(i=0;i<d.length;i++){var v=d[i].split("y");m[v[0]]=1,g["y"+v[1]]=1}for(i=0;i<c.length;i++)m[a=c[i]]||(o=(r[f.id2name(a)]||{}).anchor,h.idRegex.y.test(o)||(o="y"),p.push(a+o),d.push(a+o),g[o]||(g[o]=1,s.pushUnique(u,o)));for(i=0;i<u.length;i++)g[o=u[i]]||(a=(r[f.id2name(o)]||{}).anchor,h.idRegex.x.test(a)||(a="x"),p.push(a+o),d.push(a+o),m[a]||(m[a]=1,s.pushUnique(c,a)));if(!d.length){for(var y in a="",o="",r)h.attrRegex.test(y)&&("x"===y.charAt(0)?(!a||+y.substr(5)<+a.substr(5))&&(a=y):(!o||+y.substr(5)<+o.substr(5))&&(o=y));a=a?f.name2id(a):"x",o=o?f.name2id(o):"y",c.push(a),u.push(o),p.push(a+o)}},i.plot=function(r,n,i,a){var o,s=r._fullLayout,l=s._subplots.cartesian,c=r.calcdata;if(!Array.isArray(n))for(n=[],o=0;o<c.length;o++)n.push(o);for(o=0;o<l.length;o++){for(var u,f=l[o],h=s._plots[f],p=[],d=0;d<c.length;d++){var m=c[d],v=m[0].trace;v.xaxis+v.yaxis===f&&((-1!==n.indexOf(v.index)||v.carpet)&&(u&&u[0].trace.xaxis+u[0].trace.yaxis===f&&-1!==["tonextx","tonexty","tonext"].indexOf(v.fill)&&-1===p.indexOf(u)&&p.push(u),p.push(m)),u=m)}g(r,h,p,i,a)}},i.clean=function(r,n,i,a){var o,s,l,c=a._plots||{},u=n._plots||{},h=a._subplots||{};if(a._hasOnlyLargeSploms&&!n._hasOnlyLargeSploms)for(l in c)(o=c[l]).plotgroup&&o.plotgroup.remove();var p=a._has&&a._has("gl"),d=n._has&&n._has("gl");if(p&&!d)for(l in c)(o=c[l])._scene&&o._scene.destroy();if(h.xaxis&&h.yaxis){var m=f.listIds({_fullLayout:a});for(s=0;s<m.length;s++){var g=m[s];n[f.id2name(g)]||a._infolayer.selectAll(".g-"+g+"title").remove()}}var v=a._has&&a._has("cartesian"),b=n._has&&n._has("cartesian");if(v&&!b)y(a._cartesianlayer.selectAll(".subplot"),a),a._defs.selectAll(".axesclip").remove(),delete a._axisConstraintGroups,delete a._axisMatchGroups;else if(h.cartesian)for(s=0;s<h.cartesian.length;s++){var _=h.cartesian[s];if(!u[_]){var w="."+_+",."+_+"-x,."+_+"-y";a._cartesianlayer.selectAll(w).remove(),x(_,a)}}},i.drawFramework=function(r){var n=r._fullLayout,i=function(r){var n,i,a,o,s,l,c=r._fullLayout,u=c._subplots.cartesian,f=u.length,h=[],p=[];for(n=0;n<f;n++){a=u[n],s=(o=c._plots[a]).xaxis,l=o.yaxis;var d=s._mainAxis,m=l._mainAxis,g=d._id+m._id,v=c._plots[g];o.overlays=[],g!==a&&v?(o.mainplot=g,o.mainplotinfo=v,p.push(a)):(o.mainplot=void 0,o.mainplotinfo=void 0,h.push(a))}for(n=0;n<p.length;n++)a=p[n],(o=c._plots[a]).mainplotinfo.overlays.push(o);var y=h.concat(p),x=Array(f);for(n=0;n<f;n++){a=y[n],s=(o=c._plots[a]).xaxis,l=o.yaxis;var b=[a,s.layer,l.layer,s.overlaying||"",l.overlaying||""];for(i=0;i<o.overlays.length;i++)b.push(o.overlays[i].id);x[n]=b}return x}(r),o=n._cartesianlayer.selectAll(".subplot").data(i,String);o.enter().append("g").attr("class",function(r){return"subplot "+r[0]}),o.order(),o.exit().call(y,n),o.each(function(i){var o=i[0],s=n._plots[o];s.plotgroup=a.select(this),v(r,s),s.draglayer=d(n._draggers,"g",o)})},i.rangePlot=function(r,n,i){v(r,n),g(r,n,i),l.style(r)},i.toSVG=function(r){var n=r._fullLayout._glimages,i=a.select(r).selectAll(".svg-container");i.filter(function(r,n){return n===i.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var r=this.toDataURL("image/png");n.append("svg:image").attr({xmlns:p.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},i.updateFx=r("./graph_interact").updateFx},{"../../components/drawing":388,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../registry":638,"../get_data":593,"../plots":619,"./attributes":552,"./axis_ids":558,"./constants":561,"./graph_interact":564,"./layout_attributes":569,"./layout_defaults":570,"./transition_axes":581,"@plotly/d3":58}],569:[function(r,n,i){"use strict";var a=r("../font_attributes"),o=r("../../components/color/attributes"),s=r("../../components/drawing/attributes").dash,l=r("../../lib/extend").extendFlat,c=r("../../plot_api/plot_template").templatedArray,u=r("../../plots/cartesian/axis_format_attributes").descriptionWithDates,f=r("../../constants/numerical").ONEDAY,h=r("./constants"),p=h.HOUR_PATTERN,d=h.WEEKDAY_PATTERN;n.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:o.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:a({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[h.idRegex.x.toString(),h.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[h.idRegex.x.toString(),h.idRegex.y.toString()],editType:"calc"},rangebreaks:c("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[d,p,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:f},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:o.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:l({},s,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:a({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:u("tick label")},tickformatstops:c("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:u("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:o.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:o.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:o.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:o.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",h.idRegex.x.toString(),h.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",h.idRegex.x.toString(),h.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:a({editType:"ticks"})}}},{"../../components/color/attributes":365,"../../components/drawing/attributes":387,"../../constants/numerical":479,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_format_attributes":557,"../font_attributes":585,"./constants":561}],570:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/color"),s=r("../../components/fx/helpers").isUnifiedHover,l=r("../../components/fx/hovermode_defaults"),c=r("../../plot_api/plot_template"),u=r("../layout_attributes"),f=r("./layout_attributes"),h=r("./type_defaults"),p=r("./axis_defaults"),d=r("./constraints"),m=r("./position_defaults"),g=r("./axis_ids"),v=g.id2name,y=g.name2id,x=r("./constants").AX_ID_PATTERN,b=r("../../registry"),_=b.traceIs,w=b.getComponentMethod;function T(r,n,i){Array.isArray(r[n])?r[n].push(i):r[n]=[i]}n.exports=function(r,n,i){var b,k,A=n.autotypenumbers,M={},S={},E={},L={},C={},P={},I={},O={},z={},D={};for(b=0;b<i.length;b++){var R,F,B=i[b];if(_(B,"cartesian")||_(B,"gl2d")){if(B.xaxis)T(M,R=v(B.xaxis),B);else if(B.xaxes)for(k=0;k<B.xaxes.length;k++)T(M,v(B.xaxes[k]),B);if(B.yaxis)T(M,F=v(B.yaxis),B);else if(B.yaxes)for(k=0;k<B.yaxes.length;k++)T(M,v(B.yaxes[k]),B);"funnel"===B.type?"h"===B.orientation?(R&&(S[R]=!0),F&&(I[F]=!0)):F&&(E[F]=!0):"image"===B.type?(F&&(O[F]=!0),R&&(O[R]=!0)):(F&&(C[F]=!0,P[F]=!0),_(B,"carpet")&&("carpet"!==B.type||B._cheater)||R&&(L[R]=!0)),"carpet"===B.type&&B._cheater&&R&&(S[R]=!0),_(B,"2dMap")&&(z[R]=!0,z[F]=!0),_(B,"oriented")&&(D["h"===B.orientation?F:R]=!0)}}var N=n._subplots,j=N.xaxis,U=N.yaxis,V=a.simpleMap(j,v),H=a.simpleMap(U,v),q=V.concat(H),G=o.background;j.length&&U.length&&(G=a.coerce(r,n,u,"plot_bgcolor"));var Y,W,X,Z,J,K=o.combine(G,n.paper_bgcolor);function Q(){var r=M[Y]||[];J._traceIndices=r.map(function(r){return r._expandedIndex}),J._annIndices=[],J._shapeIndices=[],J._imgIndices=[],J._subplotsWith=[],J._counterAxes=[],J._name=J._attr=Y,J._id=W}function $(r,n){return a.coerce(Z,J,f,r,n)}function tt(r,n){return a.coerce2(Z,J,f,r,n)}function te(n,i){for(var a="x"===n?V:H,o=[],s=0;s<a.length;s++){var l=a[s];l===i||(r[l]||{}).overlaying||o.push(y(l))}return o}var tr={x:U,y:j},tn=tr.x.concat(tr.y),ti={},ta=[];function to(){var r=Z.matches;x.test(r)&&-1===tn.indexOf(r)&&(ti[r]=Z.type,ta=Object.keys(ti))}var ts=l(r,n),tl=s(ts);for(b=0;b<q.length;b++){W=y(Y=q[b]),X=Y.charAt(0),a.isPlainObject(r[Y])||(r[Y]={}),Z=r[Y],J=c.newContainer(n,Y,X+"axis"),Q();var tc="x"===X&&!L[Y]&&S[Y]||"y"===X&&!C[Y]&&E[Y],tu="y"===X&&(!P[Y]&&I[Y]||O[Y]),tf={letter:X,font:n.font,outerTicks:z[Y],showGrid:!D[Y],data:M[Y]||[],bgColor:K,calendar:n.calendar,automargin:!0,visibleDflt:tc,reverseDflt:tu,autotypenumbersDflt:A,splomStash:((n._splomAxes||{})[X]||{})[W]};$("uirevision",n.uirevision),h(Z,J,$,tf),p(Z,J,$,tf,n);var th=tl&&X===ts.charAt(0),tp=tt("spikecolor",tl?J.color:void 0),td=tt("spikethickness",tl?1.5:void 0),tm=tt("spikedash",tl?"dot":void 0),tg=tt("spikemode",tl?"across":void 0),tv=tt("spikesnap");$("showspikes",!!(th||tp||td||tm||tg||tv))||(delete J.spikecolor,delete J.spikethickness,delete J.spikedash,delete J.spikemode,delete J.spikesnap),m(Z,J,$,{letter:X,counterAxes:tr[X],overlayableAxes:te(X,Y),grid:n.grid}),$("title.standoff"),to(),J._input=Z}for(b=0;b<ta.length;){X=(Y=v(W=ta[b++])).charAt(0),a.isPlainObject(r[Y])||(r[Y]={}),Z=r[Y],J=c.newContainer(n,Y,X+"axis"),Q();var ty={letter:X,font:n.font,outerTicks:z[Y],showGrid:!D[Y],data:[],bgColor:K,calendar:n.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:A,splomStash:((n._splomAxes||{})[X]||{})[W]};$("uirevision",n.uirevision),J.type=ti[W]||"linear",p(Z,J,$,ty,n),m(Z,J,$,{letter:X,counterAxes:tr[X],overlayableAxes:te(X,Y),grid:n.grid}),$("fixedrange"),to(),J._input=Z}var tx=w("rangeslider","handleDefaults"),tb=w("rangeselector","handleDefaults");for(b=0;b<V.length;b++)Z=r[Y=V[b]],J=n[Y],tx(r,n,Y),"date"===J.type&&tb(Z,J,n,H,J.calendar),$("fixedrange");for(b=0;b<H.length;b++){Z=r[Y=H[b]],J=n[Y];var t_=n[v(J.anchor)];$("fixedrange",w("rangeslider","isVisible")(t_))}d.handleDefaults(r,n,{axIds:tn.concat(ta).sort(g.idSort),axHasImage:O})}},{"../../components/color":366,"../../components/fx/helpers":402,"../../components/fx/hovermode_defaults":405,"../../lib":503,"../../plot_api/plot_template":543,"../../registry":638,"../layout_attributes":610,"./axis_defaults":556,"./axis_ids":558,"./constants":561,"./constraints":562,"./layout_attributes":569,"./position_defaults":572,"./type_defaults":582}],571:[function(r,n,i){"use strict";var a=r("tinycolor2").mix,o=r("../../components/color/attributes").lightFraction,s=r("../../lib");n.exports=function(r,n,i,l){var c=(l=l||{}).dfltColor;function u(i,a){return s.coerce2(r,n,l.attributes,i,a)}var f=u("linecolor",c),h=u("linewidth");i("showline",l.showLine||!!f||!!h)||(delete n.linecolor,delete n.linewidth);var p=u("gridcolor",a(c,l.bgColor,l.blend||o).toRgbString()),d=u("gridwidth");if(i("showgrid",l.showGrid||!!p||!!d)||(delete n.gridcolor,delete n.gridwidth),!l.noZeroLine){var m=u("zerolinecolor",c),g=u("zerolinewidth");i("zeroline",l.showGrid||!!m||!!g)||(delete n.zerolinecolor,delete n.zerolinewidth)}}},{"../../components/color/attributes":365,"../../lib":503,tinycolor2:312}],572:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib");n.exports=function(r,n,i,s){var l,c,u,f,h=s.counterAxes||[],p=s.overlayableAxes||[],d=s.letter,m=s.grid;m&&(c=m._domains[d][m._axisMap[n._id]],l=m._anchors[n._id],c&&(u=m[d+"side"].split(" ")[0],f=m.domain[d]["right"===u||"top"===u?1:0])),c=c||[0,1],l=l||(a(r.position)?"free":h[0]||"free"),u=u||("x"===d?"bottom":"left"),f=f||0,"free"===o.coerce(r,n,{anchor:{valType:"enumerated",values:["free"].concat(h),dflt:l}},"anchor")&&i("position",f),o.coerce(r,n,{side:{valType:"enumerated",values:"x"===d?["bottom","top"]:["left","right"],dflt:u}},"side");var g=!1;if(p.length&&(g=o.coerce(r,n,{overlaying:{valType:"enumerated",values:[!1].concat(p),dflt:!1}},"overlaying")),!g){var v=i("domain",c);v[0]>v[1]-1/4096&&(n.domain=c),o.noneOrAll(r.domain,n.domain,c)}return i("layer"),n}},{"../../lib":503,"fast-isnumeric":190}],573:[function(r,n,i){"use strict";var a=r("./show_dflt");n.exports=function(r,n,i,o,s){s||(s={});var l=s.tickSuffixDflt,c=a(r);i("tickprefix")&&i("showtickprefix",c),i("ticksuffix",l)&&i("showticksuffix",c)}},{"./show_dflt":577}],574:[function(r,n,i){"use strict";var a=r("../../constants/alignment").FROM_BL;n.exports=function(r,n,i){void 0===i&&(i=a[r.constraintoward||"center"]);var o=[r.r2l(r.range[0]),r.r2l(r.range[1])],s=o[0]+(o[1]-o[0])*i;r.range=r._input.range=[r.l2r(s+(o[0]-s)*n),r.l2r(s+(o[1]-s)*n)],r.setScale()}},{"../../constants/alignment":471}],575:[function(r,n,i){"use strict";var a=r("polybooljs"),o=r("../../registry"),s=r("../../components/drawing").dashStyle,l=r("../../components/color"),c=r("../../components/fx"),u=r("../../components/fx/helpers").makeEventData,f=r("../../components/dragelement/helpers"),h=f.freeMode,p=f.rectMode,d=f.drawMode,m=f.openMode,g=f.selectMode,v=r("../../components/shapes/draw_newshape/display_outlines"),y=r("../../components/shapes/draw_newshape/helpers").handleEllipse,x=r("../../components/shapes/draw_newshape/newshapes"),b=r("../../lib"),_=r("../../lib/polygon"),w=r("../../lib/throttle"),T=r("./axis_ids").getFromId,k=r("../../lib/clear_gl_canvases"),A=r("../../plot_api/subroutines").redrawReglTraces,M=r("./constants"),S=M.MINSELECT,E=_.filter,L=_.tester,C=r("./handle_outline").clearSelect,P=r("./helpers"),I=P.p2r,O=P.axValue,z=P.getTransform;function D(r,n,i,a,o,s,l){var c,u,f,h,p,d,g,y,x,b=n._hoverdata,_=n._fullLayout.clickmode.indexOf("event")>-1,w=[];if(b&&Array.isArray(b)&&!0!==b[0].hoverOnBox){B(r,n,s);var T=function(r,n){var i,a,o=r[0],s=-1,l=[];for(a=0;a<n.length;a++)if(i=n[a],o.fullData._expandedIndex===i.cd[0].trace._expandedIndex){if(!0===o.hoverOnBox)break;void 0!==o.pointNumber?s=o.pointNumber:void 0!==o.binNumber&&(s=o.binNumber,l=o.pointNumbers);break}return{pointNumber:s,pointNumbers:l,searchInfo:i}}(b,c=j(n,i,a,o));if(T.pointNumbers.length>0?function(r,n){var i,a,o,s=[];for(o=0;o<r.length;o++)(i=r[o]).cd[0].trace.selectedpoints&&i.cd[0].trace.selectedpoints.length>0&&s.push(i);if(1===s.length&&s[0]===n.searchInfo&&(a=n.searchInfo.cd[0].trace).selectedpoints.length===n.pointNumbers.length){for(o=0;o<n.pointNumbers.length;o++)if(0>a.selectedpoints.indexOf(n.pointNumbers[o]))return!1;return!0}return!1}(c,T):function(r){var n,i,a=0;for(i=0;i<r.length;i++)if((n=r[i].cd[0].trace).selectedpoints&&(n.selectedpoints.length>1||(a+=n.selectedpoints.length)>1))return!1;return 1===a}(c)&&(d=U(T))){for(l&&l.remove(),x=0;x<c.length;x++)(u=c[x])._module.selectPoints(u,!1);V(n,c),N(s),_&&n.emit("plotly_deselect",null)}else{for(g=r.shiftKey&&(void 0!==d?d:U(T)),f={pointNumber:T.pointNumber,searchInfo:T.searchInfo,subtract:g},h=F(s.selectionDefs.concat([f])),x=0;x<c.length;x++)if(p=H(c[x]._module.selectPoints(c[x],h),c[x]),w.length)for(var k=0;k<p.length;k++)w.push(p[k]);else w=p;V(n,c,y={points:w}),f&&s&&s.selectionDefs.push(f),l&&v(q(s.mergedPolygons,m(s.dragmode)),l,s),_&&n.emit("plotly_selected",y)}}}function R(r){return"pointNumber"in r&&"searchInfo"in r}function F(r){for(var n=[],i=R(r[0])?0:r[0][0][0],a=i,o=R(r[0])?0:r[0][0][1],s=o,l=0;l<r.length;l++)if(R(r[l]))n.push(function(r){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(n,i,a,o){var s=r.searchInfo.cd[0].trace._expandedIndex;return o.cd[0].trace._expandedIndex===s&&a===r.pointNumber},isRect:!1,degenerate:!1,subtract:r.subtract}}(r[l]));else{var c=_.tester(r[l]);c.subtract=r[l].subtract,n.push(c),i=Math.min(i,c.xmin),a=Math.max(a,c.xmax),o=Math.min(o,c.ymin),s=Math.max(s,c.ymax)}return{xmin:i,xmax:a,ymin:o,ymax:s,pts:[],contains:function(r,i,a,o){for(var s=!1,l=0;l<n.length;l++)n[l].contains(r,i,a,o)&&(s=!1===n[l].subtract);return s},isRect:!1,degenerate:!1}}function B(r,n,i){n._fullLayout._drawing=!1;var a=n._fullLayout,o=i.plotinfo,s=i.dragmode,l=a._lastSelectedSubplot&&a._lastSelectedSubplot===o.id,c=(r.shiftKey||r.altKey)&&!(d(s)&&m(s));l&&c&&o.selection&&o.selection.selectionDefs&&!i.selectionDefs?(i.selectionDefs=o.selection.selectionDefs,i.mergedPolygons=o.selection.mergedPolygons):c&&o.selection||N(i),l||(C(n),a._lastSelectedSubplot=o.id)}function N(r){var n=r.dragmode,i=r.plotinfo,a=r.gd;if(a._fullLayout._activeShapeIndex>=0&&a._fullLayout._deactivateShape(a),d(n)){var s=a._fullLayout._zoomlayer.selectAll(".select-outline-"+i.id);if(s&&a._fullLayout._drawing){var l=x(s,r);l&&o.call("_guiRelayout",a,{shapes:l}),a._fullLayout._drawing=!1}}i.selection={},i.selection.selectionDefs=r.selectionDefs=[],i.selection.mergedPolygons=r.mergedPolygons=[]}function j(r,n,i,a){var o,s,l,c=[],u=n.map(function(r){return r._id}),f=i.map(function(r){return r._id});for(l=0;l<r.calcdata.length;l++)if(!0===(s=(o=r.calcdata[l])[0].trace).visible&&s._module&&s._module.selectPoints){if(a&&(s.subplot===a||s.geo===a))c.push(d(s._module,o,n[0],i[0]));else if("splom"===s.type&&s._xaxes[u[0]]&&s._yaxes[f[0]]){var h=d(s._module,o,n[0],i[0]);h.scene=r._fullLayout._splomScenes[s.uid],c.push(h)}else if("sankey"===s.type){var p=d(s._module,o,n[0],i[0]);c.push(p)}else{if(-1===u.indexOf(s.xaxis)||-1===f.indexOf(s.yaxis))continue;c.push(d(s._module,o,T(r,s.xaxis),T(r,s.yaxis)))}}return c;function d(r,n,i,a){return{_module:r,cd:n,xaxis:i,yaxis:a}}}function U(r){var n=r.searchInfo.cd[0].trace,i=r.pointNumber,a=r.pointNumbers,o=a.length>0?a[0]:i;return!!n.selectedpoints&&n.selectedpoints.indexOf(o)>-1}function V(r,n,i){for(a=0;a<n.length;a++){var a,s,l,c,u=n[a].cd[0].trace._fullInput,f=r._fullLayout._tracePreGUI[u.uid]||{};void 0===f.selectedpoints&&(f.selectedpoints=u._input.selectedpoints||null)}if(i){var h=i.points||[];for(a=0;a<n.length;a++)(c=n[a].cd[0].trace)._input.selectedpoints=c._fullInput.selectedpoints=[],c._fullInput!==c&&(c.selectedpoints=[]);for(a=0;a<h.length;a++){var p=h[a],d=p.data,m=p.fullData;p.pointIndices?([].push.apply(d.selectedpoints,p.pointIndices),c._fullInput!==c&&[].push.apply(m.selectedpoints,p.pointIndices)):(d.selectedpoints.push(p.pointIndex),c._fullInput!==c&&m.selectedpoints.push(p.pointIndex))}}else for(a=0;a<n.length;a++)delete(c=n[a].cd[0].trace).selectedpoints,delete c._input.selectedpoints,c._fullInput!==c&&delete c._fullInput.selectedpoints;var g=!1;for(a=0;a<n.length;a++){c=(l=(s=n[a]).cd)[0].trace,o.traceIs(c,"regl")&&(g=!0);var v=s._module,y=v.styleOnSelect||v.style;y&&(y(r,l,l[0].node3),l[0].nodeRangePlot3&&y(r,l,l[0].nodeRangePlot3))}g&&(k(r),A(r))}function H(r,n){if(Array.isArray(r))for(var i=n.cd,a=n.cd[0].trace,o=0;o<r.length;o++)r[o]=u(r[o],a,i);return r}function q(r,n){for(var i=[],a=0;a<r.length;a++){i[a]=[];for(var o=0;o<r[a].length;o++){i[a][o]=[],i[a][o][0]=o?"L":"M";for(var s=0;s<r[a][o].length;s++)i[a][o].push(r[a][o][s])}n||i[a].push(["Z",i[a][0][1],i[a][0][2]])}return i}n.exports={prepSelect:function(r,n,i,o,u){var f=h(u),x=p(u),_=m(u),T=d(u),k=g(u),A="drawcircle"===u,C="drawline"===u||A,P=o.gd,R=P._fullLayout,U=R._zoomlayer,G=o.element.getBoundingClientRect(),Y=o.plotinfo,W=z(Y),X=n-G.left,Z=i-G.top;R._calcInverseTransform(P);var J=b.apply3DTransform(R._invTransform)(X,Z);X=J[0],Z=J[1];var K,Q,$,tt,te,tr,tn,ti=R._invScaleX,ta=R._invScaleY,to=X,ts=Z,tl="M"+X+","+Z,tc=o.xaxes[0]._length,tu=o.yaxes[0]._length,tf=o.xaxes.concat(o.yaxes),th=r.altKey&&!(d(u)&&_);B(r,P,o),f&&(K=E([[X,Z]],M.BENDPX));var tp=U.selectAll("path.select-outline-"+Y.id).data(T?[0]:[1,2]),td=R.newshape;tp.enter().append("path").attr("class",function(r){return"select-outline select-outline-"+r+" select-outline-"+Y.id}).style(T?{opacity:td.opacity/2,fill:_?void 0:td.fillcolor,stroke:td.line.color,"stroke-dasharray":s(td.line.dash,td.line.width),"stroke-width":td.line.width+"px"}:{}).attr("fill-rule",td.fillrule).classed("cursor-move",!!T).attr("transform",W).attr("d",tl+"Z");var tm,tg=U.append("path").attr("class","zoombox-corners").style({fill:l.background,stroke:l.defaultLine,"stroke-width":1}).attr("transform",W).attr("d","M0,0Z"),tv=R._uid+M.SELECTID,ty=[],tx=j(P,o.xaxes,o.yaxes,o.subplot);function tb(r,n){return r-n}tm=Y.fillRangeItems?Y.fillRangeItems:x?function(r,n){var i=r.range={};for(te=0;te<tf.length;te++){var a=tf[te],o=a._id.charAt(0);i[a._id]=[I(a,n[o+"min"]),I(a,n[o+"max"])].sort(tb)}}:function(r,n,i){var a=r.lassoPoints={};for(te=0;te<tf.length;te++){var o=tf[te];a[o._id]=i.filtered.map(O(o))}},o.moveFn=function(r,n){to=Math.max(0,Math.min(tc,ti*r+X)),ts=Math.max(0,Math.min(tu,ta*n+Z));var i,s,l,c,u,h=Math.abs(to-X),p=Math.abs(ts-Z);if(x){if(k){var d=R.selectdirection;switch(l="any"===d?p<Math.min(.6*h,S)?"h":h<Math.min(.6*p,S)?"v":"d":d){case"h":c=A?tu/2:0,u=tu;break;case"v":c=A?tc/2:0,u=tc}}if(T)switch(R.newshape.drawdirection){case"vertical":l="h",c=A?tu/2:0,u=tu;break;case"horizontal":l="v",c=A?tc/2:0,u=tc;break;case"ortho":h<p?(l="h",c=Z,u=ts):(l="v",c=X,u=to);break;default:l="d"}"h"===l?((tt=C?y(A,[to,c],[to,u]):[[X,c],[X,u],[to,u],[to,c]]).xmin=C?to:Math.min(X,to),tt.xmax=C?to:Math.max(X,to),tt.ymin=Math.min(c,u),tt.ymax=Math.max(c,u),tg.attr("d","M"+tt.xmin+","+(Z-S)+"h-4v"+2*S+"h4ZM"+(tt.xmax-1)+","+(Z-S)+"h4v"+2*S+"h-4Z")):"v"===l?((tt=C?y(A,[c,ts],[u,ts]):[[c,Z],[c,ts],[u,ts],[u,Z]]).xmin=Math.min(c,u),tt.xmax=Math.max(c,u),tt.ymin=C?ts:Math.min(Z,ts),tt.ymax=C?ts:Math.max(Z,ts),tg.attr("d","M"+(X-S)+","+tt.ymin+"v-4h"+2*S+"v4ZM"+(X-S)+","+(tt.ymax-1)+"v4h"+2*S+"v-4Z")):"d"===l&&((tt=C?y(A,[X,Z],[to,ts]):[[X,Z],[X,ts],[to,ts],[to,Z]]).xmin=Math.min(X,to),tt.xmax=Math.max(X,to),tt.ymin=Math.min(Z,ts),tt.ymax=Math.max(Z,ts),tg.attr("d","M0,0Z"))}else f&&(K.addPt([to,ts]),tt=K.filtered);o.selectionDefs&&o.selectionDefs.length?(i=o.mergedPolygons,s=tt,$=th?a.difference({regions:i,inverted:!1},{regions:[s],inverted:!1}).regions:a.union({regions:i,inverted:!1},{regions:[s],inverted:!1}).regions,tt.subtract=th,Q=F(o.selectionDefs.concat([tt]))):($=[tt],Q=L(tt)),v(q($,_),tp,o),k&&w.throttle(tv,M.SELECTDELAY,function(){ty=[];var r,n,i=[];for(te=0;te<tx.length;te++)if(i.push(n=(tr=tx[te])._module.selectPoints(tr,Q)),r=H(n,tr),ty.length)for(var a=0;a<r.length;a++)ty.push(r[a]);else ty=r;V(P,tx,tn={points:ty}),tm(tn,tt,K),o.gd.emit("plotly_selecting",tn)})},o.clickFn=function(r,n){if(tg.remove(),P._fullLayout._activeShapeIndex>=0)P._fullLayout._deactivateShape(P);else if(!T){var i=R.clickmode;w.done(tv).then(function(){if(w.clear(tv),2===r){for(tp.remove(),te=0;te<tx.length;te++)(tr=tx[te])._module.selectPoints(tr,!1);V(P,tx),N(o),P.emit("plotly_deselect",null)}else i.indexOf("select")>-1&&D(n,P,o.xaxes,o.yaxes,o.subplot,o,tp),"event"===i&&P.emit("plotly_selected",void 0);c.click(P,n)}).catch(b.error)}},o.doneFn=function(){tg.remove(),w.done(tv).then(function(){w.clear(tv),o.gd.emit("plotly_selected",tn),tt&&o.selectionDefs&&(tt.subtract=th,o.selectionDefs.push(tt),o.mergedPolygons.length=0,[].push.apply(o.mergedPolygons,$)),o.doneFnCompleted&&o.doneFnCompleted(ty)}).catch(b.error),T&&N(o)}},clearSelect:C,clearSelectionsCache:N,selectOnClick:D}},{"../../components/color":366,"../../components/dragelement/helpers":384,"../../components/drawing":388,"../../components/fx":406,"../../components/fx/helpers":402,"../../components/shapes/draw_newshape/display_outlines":454,"../../components/shapes/draw_newshape/helpers":455,"../../components/shapes/draw_newshape/newshapes":456,"../../lib":503,"../../lib/clear_gl_canvases":487,"../../lib/polygon":515,"../../lib/throttle":530,"../../plot_api/subroutines":544,"../../registry":638,"./axis_ids":558,"./constants":561,"./handle_outline":565,"./helpers":566,polybooljs:254}],576:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("d3-time-format").utcFormat,s=r("../../lib"),l=s.numberFormat,c=r("fast-isnumeric"),u=s.cleanNumber,f=s.ms2DateTime,h=s.dateTime2ms,p=s.ensureNumber,d=s.isArrayOrTypedArray,m=r("../../constants/numerical"),g=m.FP_SAFE,v=m.BADNUM,y=m.LOG_CLIP,x=m.ONEWEEK,b=m.ONEDAY,_=m.ONEHOUR,w=m.ONEMIN,T=m.ONESEC,k=r("./axis_ids"),A=r("./constants"),M=A.HOUR_PATTERN,S=A.WEEKDAY_PATTERN;function E(r){return Math.pow(10,r)}n.exports=function(r,n){n=n||{};var i=r._id||"x",m=i.charAt(0);function L(n,i){if(n>0)return Math.log(n)/Math.LN10;if(n<=0&&i&&r.range&&2===r.range.length){var a=r.range[0],o=r.range[1];return .5*(a+o-2*y*Math.abs(a-o))}return v}function C(n,i,a,o){if((o||{}).msUTC&&c(n))return+n;var l=h(n,a||r.calendar);if(l===v){if(!c(n))return v;n=+n;var u=Math.floor(10*s.mod(n+.05,1));l=h(new Date(Math.round(n-u/10)))+u/10}return l}function P(n,i,a){return f(n,i,a||r.calendar)}function I(n){return r._categories[Math.round(n)]}function O(n){if(null!=n){if(void 0===r._categoriesMap&&(r._categoriesMap={}),void 0!==r._categoriesMap[n])return r._categoriesMap[n];r._categories.push("number"==typeof n?String(n):n);var i=r._categories.length-1;return r._categoriesMap[n]=i,i}return v}function z(n){if(r._categoriesMap)return r._categoriesMap[n]}function D(r){var n=z(r);return void 0!==n?n:c(r)?+r:void 0}function R(r){return c(r)?+r:z(r)}function F(r,n,i){return a.round(i+n*r,2)}var B=function(n){return c(n)?F(n,r._m,r._b):v},N=function(n){var i;return i=r._m,(n-r._b)/i};if(r.rangebreaks){var j="y"===m;B=function(n){if(!c(n))return v;var i=r._rangebreaks.length;if(!i)return F(n,r._m,r._b);var a=j;r.range[0]>r.range[1]&&(a=!a);for(var o=a?-1:1,s=o*n,l=0,u=0;u<i;u++){var f=o*r._rangebreaks[u].min,h=o*r._rangebreaks[u].max;if(s<f)break;if(!(s>h)){l=s<(f+h)/2?u:u+1;break}l=u+1}var p=r._B[l]||0;return isFinite(p)?F(n,r._m2,p):0},N=function(n){var i,a,o=r._rangebreaks.length;if(!o)return i=r._m,(n-r._b)/i;for(var s=0,l=0;l<o&&!(n<r._rangebreaks[l].pmin);l++)n>r._rangebreaks[l].pmax&&(s=l+1);return a=r._m2,(n-r._B[s])/a}}r.c2l="log"===r.type?L:p,r.l2c="log"===r.type?E:p,r.l2p=B,r.p2l=N,r.c2p="log"===r.type?function(r,n){return B(L(r,n))}:B,r.p2c="log"===r.type?function(r){return E(N(r))}:N,-1!==["linear","-"].indexOf(r.type)?(r.d2r=r.r2d=r.d2c=r.r2c=r.d2l=r.r2l=u,r.c2d=r.c2r=r.l2d=r.l2r=p,r.d2p=r.r2p=function(n){return r.l2p(u(n))},r.p2d=r.p2r=N,r.cleanPos=p):"log"===r.type?(r.d2r=r.d2l=function(r,n){return L(u(r),n)},r.r2d=r.r2c=function(r){return E(u(r))},r.d2c=r.r2l=u,r.c2d=r.l2r=p,r.c2r=L,r.l2d=E,r.d2p=function(n,i){return r.l2p(r.d2r(n,i))},r.p2d=function(r){return E(N(r))},r.r2p=function(n){return r.l2p(u(n))},r.p2r=N,r.cleanPos=p):"date"===r.type?(r.d2r=r.r2d=s.identity,r.d2c=r.r2c=r.d2l=r.r2l=C,r.c2d=r.c2r=r.l2d=r.l2r=P,r.d2p=r.r2p=function(n,i,a){return r.l2p(C(n,0,a))},r.p2d=r.p2r=function(r,n,i){return P(N(r),n,i)},r.cleanPos=function(n){return s.cleanDate(n,v,r.calendar)}):"category"===r.type?(r.d2c=r.d2l=O,r.r2d=r.c2d=r.l2d=I,r.d2r=r.d2l_noadd=D,r.r2c=function(n){var i=R(n);return void 0!==i?i:r.fraction2r(.5)},r.l2r=r.c2r=p,r.r2l=R,r.d2p=function(n){return r.l2p(r.r2c(n))},r.p2d=function(r){return I(N(r))},r.r2p=r.d2p,r.p2r=N,r.cleanPos=function(r){return"string"==typeof r&&""!==r?r:p(r)}):"multicategory"===r.type&&(r.r2d=r.c2d=r.l2d=I,r.d2r=r.d2l_noadd=D,r.r2c=function(n){var i=D(n);return void 0!==i?i:r.fraction2r(.5)},r.r2c_just_indices=z,r.l2r=r.c2r=p,r.r2l=D,r.d2p=function(n){return r.l2p(r.r2c(n))},r.p2d=function(r){return I(N(r))},r.r2p=r.d2p,r.p2r=N,r.cleanPos=function(r){return Array.isArray(r)||"string"==typeof r&&""!==r?r:p(r)},r.setupMultiCategory=function(a){var o,l,c=r._traceIndices,u=r._matchGroup;if(u&&0===r._categories.length){for(var f in u)if(f!==i){var h=n[k.id2name(f)];c=c.concat(h._traceIndices)}}var p=[[0,{}],[0,{}]],g=[];for(o=0;o<c.length;o++){var v=a[c[o]];if(m in v){var y=v[m],x=v._length||s.minRowLength(y);if(d(y[0])&&d(y[1]))for(l=0;l<x;l++){var b=y[0][l],_=y[1][l];null!=b&&null!=_&&(g.push([b,_]),b in p[0][1]||(p[0][1][b]=p[0][0]++),_ in p[1][1]||(p[1][1][_]=p[1][0]++))}}}for(g.sort(function(r,n){var i=p[0][1],a=i[r[0]]-i[n[0]];if(a)return a;var o=p[1][1];return o[r[1]]-o[n[1]]}),o=0;o<g.length;o++)O(g[o])}),r.fraction2r=function(n){var i=r.r2l(r.range[0]),a=r.r2l(r.range[1]);return r.l2r(i+n*(a-i))},r.r2fraction=function(n){var i=r.r2l(r.range[0]),a=r.r2l(r.range[1]);return(r.r2l(n)-i)/(a-i)},r.cleanRange=function(n,i){i||(i={}),n||(n="range");var a,o,l=s.nestedProperty(r,n).get();if(o=(o="date"===r.type?s.dfltRange(r.calendar):"y"===m?A.DFLTRANGEY:"realaxis"===r._name?[0,1]:i.dfltRange||A.DFLTRANGEX).slice(),"tozero"!==r.rangemode&&"nonnegative"!==r.rangemode||(o[0]=0),l&&2===l.length)for("date"!==r.type||r.autorange||(l[0]=s.cleanDate(l[0],v,r.calendar),l[1]=s.cleanDate(l[1],v,r.calendar)),a=0;a<2;a++)if("date"===r.type){if(!s.isDateTime(l[a],r.calendar)){r[n]=o;break}if(r.r2l(l[0])===r.r2l(l[1])){var u=s.constrain(r.r2l(l[0]),s.MIN_MS+1e3,s.MAX_MS-1e3);l[0]=r.l2r(u-1e3),l[1]=r.l2r(u+1e3);break}}else{if(!c(l[a])){if(!c(l[1-a])){r[n]=o;break}l[a]=l[1-a]*(a?10:.1)}if(l[a]<-g?l[a]=-g:l[a]>g&&(l[a]=g),l[0]===l[1]){var f=Math.max(1,Math.abs(1e-6*l[0]));l[0]-=f,l[1]+=f}}else s.nestedProperty(r,n).set(o)},r.setScale=function(i){var a=n._size;if(r.overlaying){var o=k.getFromId({_fullLayout:n},r.overlaying);r.domain=o.domain}var s=i&&r._r?"_r":"range",l=r.calendar;r.cleanRange(s);var c,u,f=r.r2l(r[s][0],l),h=r.r2l(r[s][1],l),p="y"===m;if(p?(r._offset=a.t+(1-r.domain[1])*a.h,r._length=a.h*(r.domain[1]-r.domain[0]),r._m=r._length/(f-h),r._b=-r._m*h):(r._offset=a.l+r.domain[0]*a.w,r._length=a.w*(r.domain[1]-r.domain[0]),r._m=r._length/(h-f),r._b=-r._m*f),r._rangebreaks=[],r._lBreaks=0,r._m2=0,r._B=[],r.rangebreaks&&(r._rangebreaks=r.locateBreaks(Math.min(f,h),Math.max(f,h)),r._rangebreaks.length)){for(c=0;c<r._rangebreaks.length;c++)u=r._rangebreaks[c],r._lBreaks+=Math.abs(u.max-u.min);var d=p;f>h&&(d=!d),d&&r._rangebreaks.reverse();var g=d?-1:1;for(r._m2=g*r._length/(Math.abs(h-f)-r._lBreaks),r._B.push(-r._m2*(p?h:f)),c=0;c<r._rangebreaks.length;c++)u=r._rangebreaks[c],r._B.push(r._B[r._B.length-1]-g*r._m2*(u.max-u.min));for(c=0;c<r._rangebreaks.length;c++)(u=r._rangebreaks[c]).pmin=B(u.min),u.pmax=B(u.max)}if(!isFinite(r._m)||!isFinite(r._b)||r._length<0)throw n._replotting=!1,Error("Something went wrong with axis scaling")},r.maskBreaks=function(n){var i,a,o,l,c,f=r.rangebreaks||[];f._cachedPatterns||(f._cachedPatterns=f.map(function(n){return n.enabled&&n.bounds?s.simpleMap(n.bounds,n.pattern?u:r.d2c):null})),f._cachedValues||(f._cachedValues=f.map(function(n){return n.enabled&&n.values?s.simpleMap(n.values,r.d2c).sort(s.sorterAsc):null}));for(var h=0;h<f.length;h++){var p=f[h];if(p.enabled){if(p.bounds){var d=p.pattern;switch(a=(i=f._cachedPatterns[h])[0],o=i[1],d){case S:l=(c=new Date(n)).getUTCDay(),a>o&&(o+=7,l<a&&(l+=7));break;case M:l=(c=new Date(n)).getUTCHours()+(c.getUTCMinutes()/60+c.getUTCSeconds()/3600+c.getUTCMilliseconds()/36e5),a>o&&(o+=24,l<a&&(l+=24));break;case"":l=n}if(l>=a&&l<o)return v}else for(var m=f._cachedValues[h],g=0;g<m.length;g++)if(o=(a=m[g])+p.dvalue,n>=a&&n<o)return v}}return n},r.locateBreaks=function(n,i){var a,o,l,c,f=[];if(!r.rangebreaks)return f;var h=r.rangebreaks.slice().sort(function(r,n){return r.pattern===S&&n.pattern===M?-1:n.pattern===S&&r.pattern===M?1:0}),p=function(r,a){if((r=s.constrain(r,n,i))!==(a=s.constrain(a,n,i))){for(var o=!0,l=0;l<f.length;l++){var c=f[l];r<c.max&&a>=c.min&&(r<c.min&&(c.min=r),a>c.max&&(c.max=a),o=!1)}o&&f.push({min:r,max:a})}};for(a=0;a<h.length;a++){var d=h[a];if(d.enabled){if(d.bounds){var m=n,g=i;d.pattern&&(m=Math.floor(m)),l=(o=s.simpleMap(d.bounds,d.pattern?u:r.r2l))[0],c=o[1];var v,y,k=new Date(m);switch(d.pattern){case S:y=x,v=(c-l+(c<l?7:0))*b,m+=l*b-(k.getUTCDay()*b+k.getUTCHours()*_+k.getUTCMinutes()*w+k.getUTCSeconds()*T+k.getUTCMilliseconds());break;case M:y=b,v=(c-l+(c<l?24:0))*_,m+=l*_-(k.getUTCHours()*_+k.getUTCMinutes()*w+k.getUTCSeconds()*T+k.getUTCMilliseconds());break;default:m=Math.min(o[0],o[1]),v=y=(g=Math.max(o[0],o[1]))-m}for(var A=m;A<g;A+=y)p(A,A+v)}else for(var E=s.simpleMap(d.values,r.d2c),L=0;L<E.length;L++)p(l=E[L],c=l+d.dvalue)}}return f.sort(function(r,n){return r.min-n.min}),f},r.makeCalcdata=function(n,i,a){var o,l,c,u,f=r.type,h="date"===f&&n[i+"calendar"];if(i in n){if(o=n[i],u=n._length||s.minRowLength(o),s.isTypedArray(o)&&("linear"===f||"log"===f)){if(u===o.length)return o;if(o.subarray)return o.subarray(0,u)}if("multicategory"===f)return function(r,n){for(var i=Array(n),a=0;a<n;a++){var o=(r[0]||[])[a],s=(r[1]||[])[a];i[a]=z([o,s])}return i}(o,u);for(l=Array(u),c=0;c<u;c++)l[c]=r.d2c(o[c],0,h,a)}else{var p=i+"0" in n?r.d2c(n[i+"0"],0,h):0,d=n["d"+i]?Number(n["d"+i]):1;for(o=n[({x:"y",y:"x"})[i]],l=Array(u=n._length||o.length),c=0;c<u;c++)l[c]=p+c*d}if(r.rangebreaks)for(c=0;c<u;c++)l[c]=r.maskBreaks(l[c]);return l},r.isValidRange=function(n){return Array.isArray(n)&&2===n.length&&c(r.r2l(n[0]))&&c(r.r2l(n[1]))},r.isPtWithinRange=function(n,i){var a=r.c2l(n[m],null,i),o=r.r2l(r.range[0]),s=r.r2l(r.range[1]);return o<s?o<=a&&a<=s:s<=a&&a<=o},r._emptyCategories=function(){r._categories=[],r._categoriesMap={}},r.clearCalc=function(){var i=r._matchGroup;if(i){var a=null,o=null;for(var s in i){var l=n[k.id2name(s)];if(l._categories){a=l._categories,o=l._categoriesMap;break}}a&&o?(r._categories=a,r._categoriesMap=o):r._emptyCategories()}else r._emptyCategories();if(r._initialCategories)for(var c=0;c<r._initialCategories.length;c++)O(r._initialCategories[c])},r.sortByInitialCategories=function(){var a=[];if(r._emptyCategories(),r._initialCategories)for(var o=0;o<r._initialCategories.length;o++)O(r._initialCategories[o]);a=a.concat(r._traceIndices);var s=r._matchGroup;for(var l in s)if(i!==l){var c=n[k.id2name(l)];c._categories=r._categories,c._categoriesMap=r._categoriesMap,a=a.concat(c._traceIndices)}return a};var U=n._d3locale;"date"===r.type&&(r._dateFormat=U?U.timeFormat:o,r._extraFormat=n._extraFormat),r._separators=n.separators,r._numFormat=U?U.numberFormat:l,delete r._minDtick,delete r._forceTick0}},{"../../constants/numerical":479,"../../lib":503,"./axis_ids":558,"./constants":561,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],577:[function(r,n,i){"use strict";n.exports=function(r){var n=["showexponent","showtickprefix","showticksuffix"].filter(function(n){return void 0!==r[n]});if(n.every(function(i){return r[i]===r[n[0]]})||1===n.length)return r[n[0]]}},{}],578:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/color").contrast,s=r("./layout_attributes"),l=r("./show_dflt"),c=r("../array_container_defaults");function u(r,n){function i(i,o){return a.coerce(r,n,s.tickformatstops,i,o)}i("enabled")&&(i("dtickrange"),i("value"))}n.exports=function(r,n,i,f,h){h||(h={});var p=l(r);if(i("showticklabels")){var d=h.font||{},m=n.color,g=-1!==(n.ticklabelposition||"").indexOf("inside")?o(h.bgColor):m&&m!==s.color.dflt?m:d.color;if(a.coerceFont(i,"tickfont",{family:d.family,size:d.size,color:g}),h.noAng||i("tickangle"),"category"!==f){var v=i("tickformat");c(r,n,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:u}),n.tickformatstops.length||delete n.tickformatstops,h.noExp||v||"date"===f||(i("showexponent",p),i("exponentformat"),i("minexponent"),i("separatethousands"))}}}},{"../../components/color":366,"../../lib":503,"../array_container_defaults":549,"./layout_attributes":569,"./show_dflt":577}],579:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n,i,s){var l=a.coerce2(r,n,o,"ticklen"),c=a.coerce2(r,n,o,"tickwidth"),u=a.coerce2(r,n,o,"tickcolor",n.color);i("ticks",s.outerTicks||l||c||u?"outside":"")||(delete n.ticklen,delete n.tickwidth,delete n.tickcolor)}},{"../../lib":503,"./layout_attributes":569}],580:[function(r,n,i){"use strict";var a=r("./clean_ticks"),o=r("../../lib").isArrayOrTypedArray;n.exports=function(r,n,i,s){function l(i){var a=r[i];return void 0!==a?a:(n._template||{})[i]}var c=l("tick0"),u=l("dtick"),f=i("tickmode",o(l("tickvals"))?"array":u?"linear":"auto");if("auto"===f)i("nticks");else if("linear"===f){var h=n.dtick=a.dtick(u,s);n.tick0=a.tick0(c,s,n.calendar,h)}else"multicategory"!==s&&(void 0===i("tickvals")?n.tickmode="auto":i("ticktext"))}},{"../../lib":503,"./clean_ticks":560}],581:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../registry"),s=r("../../lib"),l=r("../../components/drawing"),c=r("./axes");n.exports=function(r,n,i,u){var f=r._fullLayout;if(0!==n.length){u&&(h=u());var h,p,d,m,g=a.ease(i.easing);return r._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(m),m=null,function(){for(var i={},a=0;a<n.length;a++){var s=n[a],l=s.plotinfo.xaxis,c=s.plotinfo.yaxis;s.xr0&&(i[l._name+".range"]=s.xr0.slice()),s.yr0&&(i[c._name+".range"]=s.yr0.slice())}return o.call("relayout",r,i).then(function(){for(var r=0;r<n.length;r++)v(n[r].plotinfo)})}()}),p=Date.now(),m=window.requestAnimationFrame(function a(){d=Date.now();for(var u=Math.min(1,(d-p)/i.duration),f=g(u),y=0;y<n.length;y++)(function(n,i){var a=n.plotinfo,o=a.xaxis,u=a.yaxis,f=o._length,h=u._length,p=!!n.xr1,d=!!n.yr1,m=[];if(p){var g=s.simpleMap(n.xr0,o.r2l),v=s.simpleMap(n.xr1,o.r2l),y=g[1]-g[0],x=v[1]-v[0];m[0]=(g[0]*(1-i)+i*v[0]-g[0])/(g[1]-g[0])*f,m[2]=f*(1-i+i*x/y),o.range[0]=o.l2r(g[0]*(1-i)+i*v[0]),o.range[1]=o.l2r(g[1]*(1-i)+i*v[1])}else m[0]=0,m[2]=f;if(d){var b=s.simpleMap(n.yr0,u.r2l),_=s.simpleMap(n.yr1,u.r2l),w=b[1]-b[0],T=_[1]-_[0];m[1]=(b[1]*(1-i)+i*_[1]-b[1])/(b[0]-b[1])*h,m[3]=h*(1-i+i*T/w),u.range[0]=o.l2r(b[0]*(1-i)+i*_[0]),u.range[1]=u.l2r(b[1]*(1-i)+i*_[1])}else m[1]=0,m[3]=h;c.drawOne(r,o,{skipTitle:!0}),c.drawOne(r,u,{skipTitle:!0}),c.redrawComponents(r,[o._id,u._id]);var k=p?f/m[2]:1,A=d?h/m[3]:1,M=p?m[0]:0,S=d?m[1]:0,E=p?m[0]/m[2]*f:0,L=d?m[1]/m[3]*h:0,C=o._offset-E,P=u._offset-L;a.clipRect.call(l.setTranslate,M,S).call(l.setScale,1/k,1/A),a.plot.call(l.setTranslate,C,P).call(l.setScale,k,A),l.setPointGroupScale(a.zoomScalePts,1/k,1/A),l.setTextPointsScale(a.zoomScaleTxt,1/k,1/A)})(n[y],f);d-p>i.duration?(function(){for(var i={},a=0;a<n.length;a++){var s=n[a],l=s.plotinfo.xaxis,c=s.plotinfo.yaxis;s.xr1&&(i[l._name+".range"]=s.xr1.slice()),s.yr1&&(i[c._name+".range"]=s.yr1.slice())}h&&h(),o.call("relayout",r,i).then(function(){for(var r=0;r<n.length;r++)v(n[r].plotinfo)})}(),m=window.cancelAnimationFrame(a)):m=window.requestAnimationFrame(a)}),Promise.resolve()}function v(r){var n=r.xaxis,i=r.yaxis;f._defs.select("#"+r.clipId+"> rect").call(l.setTranslate,0,0).call(l.setScale,1,1),r.plot.call(l.setTranslate,n._offset,i._offset).call(l.setScale,1,1);var a=r.plot.selectAll(".scatterlayer .trace");a.selectAll(".point").call(l.setPointGroupScale,1,1),a.selectAll(".textpoint").call(l.setTextPointsScale,1,1),a.call(l.hideOutsideRangePoints,r)}c.redrawComponents(r)}},{"../../components/drawing":388,"../../lib":503,"../../registry":638,"./axes":554,"@plotly/d3":58}],582:[function(r,n,i){"use strict";var a=r("../../registry").traceIs,o=r("./axis_autotype");function s(r){return({v:"x",h:"y"})[r.orientation||"v"]}function l(r,n){var i=s(r),o=a(r,"box-violin"),l=a(r._fullInput||{},"candlestick");return o&&!l&&n===i&&void 0===r[i]&&void 0===r[i+"0"]}n.exports=function(r,n,i,c){i("autotypenumbers",c.autotypenumbersDflt),"-"===i("type",(c.splomStash||{}).type)&&(function(r,n){if("-"===r.type){var i,c=r._id,u=c.charAt(0);-1!==c.indexOf("scene")&&(c=u);var f=function(r,n,i){for(var a=0;a<r.length;a++){var o=r[a];if("splom"===o.type&&o._length>0&&(o["_"+i+"axes"]||{})[n]||(o[i+"axis"]||i)===n&&(l(o,i)||(o[i]||[]).length||o[i+"0"]))return o}}(n,c,u);if(f){if("histogram"===f.type&&u===({v:"y",h:"x"})[f.orientation||"v"])return void(r.type="linear");var h=u+"calendar",p=f[h],d={noMultiCategory:!a(f,"cartesian")||a(f,"noMultiCategory")};if("box"===f.type&&f._hasPreCompStats&&u===({h:"x",v:"y"})[f.orientation||"v"]&&(d.noMultiCategory=!0),d.autotypenumbers=r.autotypenumbers,l(f,u)){var m=s(f),g=[];for(i=0;i<n.length;i++){var v=n[i];a(v,"box-violin")&&(v[u+"axis"]||u)===c&&(void 0!==v[m]?g.push(v[m][0]):void 0!==v.name?g.push(v.name):g.push("text"),v[h]!==p&&(p=void 0))}r.type=o(g,p,d)}else if("splom"===f.type){var y=f.dimensions[f._axesDim[c]];y.visible&&(r.type=o(y.values,p,d))}else r.type=o(f[u]||[f[u+"0"]],p,d)}}}(n,c.data),"-"===n.type?n.type="linear":r.type=n.type)}},{"../../registry":638,"./axis_autotype":555}],583:[function(r,n,i){"use strict";var a=r("../registry"),o=r("../lib");function s(r,n,i){var a,s,l,c=!1;if("data"===n.type)a=r._fullData[null!==n.traces?n.traces[0]:0];else{if("layout"!==n.type)return!1;a=r._fullLayout}return s=o.nestedProperty(a,n.prop).get(),(l=i[n.type]=i[n.type]||{}).hasOwnProperty(n.prop)&&l[n.prop]!==s&&(c=!0),l[n.prop]=s,{changed:c,value:s}}function l(r,n){var i=[],a=n[0],s={};if("string"==typeof a)s[a]=n[1];else{if(!o.isPlainObject(a))return i;s=a}return u(s,function(r,n,a){i.push({type:"layout",prop:r,value:a})},"",0),i}function c(r,n){var i,a,s,l,c=[];if(a=n[0],s=n[1],i=n[2],l={},"string"==typeof a)l[a]=s;else{if(!o.isPlainObject(a))return c;l=a,void 0===i&&(i=s)}return void 0===i&&(i=null),u(l,function(n,a,o){var s,l;if(Array.isArray(o)){var u=Math.min((l=o.slice()).length,r.data.length);i&&(u=Math.min(u,i.length)),s=[];for(var f=0;f<u;f++)s[f]=i?i[f]:f}else l=o,s=i?i.slice():null;if(null===s)Array.isArray(l)&&(l=l[0]);else if(Array.isArray(s)){if(!Array.isArray(l)){var h=l;l=[];for(var p=0;p<s.length;p++)l[p]=h}l.length=Math.min(s.length,l.length)}c.push({type:"data",prop:n,traces:s,value:l})},"",0),c}function u(r,n,i,a){Object.keys(r).forEach(function(s){var l=r[s];if("_"!==s[0]){var c=i+(a>0?".":"")+s;o.isPlainObject(l)?u(l,n,c,a+1):n(c,s,l)}})}i.manageCommandObserver=function(r,n,a,l){var c={},u=!0;n&&n._commandObserver&&(c=n._commandObserver),c.cache||(c.cache={}),c.lookupTable={};var f=i.hasSimpleAPICommandBindings(r,a,c.lookupTable);if(n&&n._commandObserver){if(f)return c;if(n._commandObserver.remove)return n._commandObserver.remove(),n._commandObserver=null,c}if(f){s(r,f,c.cache),c.check=function(){if(u){var n=s(r,f,c.cache);return n.changed&&l&&void 0!==c.lookupTable[n.value]&&(c.disable(),Promise.resolve(l({value:n.value,type:f.type,prop:f.prop,traces:f.traces,index:c.lookupTable[n.value]})).then(c.enable,c.enable)),n.changed}};for(var h=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],p=0;p<h.length;p++)r._internalOn(h[p],c.check);c.remove=function(){for(var n=0;n<h.length;n++)r._removeInternalListener(h[n],c.check)}}else o.log("Unable to automatically bind plot updates to API command"),c.lookupTable={},c.remove=function(){};return c.disable=function(){u=!1},c.enable=function(){u=!0},n&&(n._commandObserver=c),c},i.hasSimpleAPICommandBindings=function(r,n,a){var o,s,l=n.length;for(o=0;o<l;o++){var c,u=n[o],f=u.method,h=u.args;if(Array.isArray(h)||(h=[]),!f)return!1;var p=i.computeAPICommandBindings(r,f,h);if(1!==p.length)return!1;if(s){if((c=p[0]).type!==s.type||c.prop!==s.prop)return!1;if(Array.isArray(s.traces)){if(!Array.isArray(c.traces))return!1;c.traces.sort();for(var d=0;d<s.traces.length;d++)if(s.traces[d]!==c.traces[d])return!1}else if(c.prop!==s.prop)return!1}else Array.isArray((s=p[0]).traces)&&s.traces.sort();var m=(c=p[0]).value;if(Array.isArray(m)){if(1!==m.length)return!1;m=m[0]}a&&(a[m]=o)}return s},i.executeAPICommand=function(r,n,i){if("skip"===n)return Promise.resolve();var s=a.apiMethodRegistry[n],l=[r];Array.isArray(i)||(i=[]);for(var c=0;c<i.length;c++)l.push(i[c]);return s.apply(null,l).catch(function(r){return o.warn("API call to Plotly."+n+" rejected.",r),Promise.reject(r)})},i.computeAPICommandBindings=function(r,n,i){var a,o;switch(Array.isArray(i)||(i=[]),n){case"restyle":a=c(r,i);break;case"relayout":a=l(r,i);break;case"update":a=c(r,[i[0],i[2]]).concat(l(r,[i[1]]));break;case"animate":a=Array.isArray((o=i)[0])&&1===o[0].length&&-1!==["string","number"].indexOf(typeof o[0][0])?[{type:"layout",prop:"_currentFrame",value:o[0][0].toString()}]:[];break;default:a=[]}return a}},{"../lib":503,"../registry":638}],584:[function(r,n,i){"use strict";var a=r("../lib/extend").extendFlat;i.attributes=function(r,n){n=n||{};var i={valType:"info_array",editType:(r=r||{}).editType,items:[{valType:"number",min:0,max:1,editType:r.editType},{valType:"number",min:0,max:1,editType:r.editType}],dflt:[0,1]},o=(r.name&&r.name,r.trace,n.description&&n.description,{x:a({},i,{}),y:a({},i,{}),editType:r.editType});return r.noGridCell||(o.row={valType:"integer",min:0,dflt:0,editType:r.editType},o.column={valType:"integer",min:0,dflt:0,editType:r.editType}),o},i.defaults=function(r,n,i,a){var o=a&&a.x||[0,1],s=a&&a.y||[0,1],l=n.grid;if(l){var c=i("domain.column");void 0!==c&&(c<l.columns?o=l._domains.x[c]:delete r.domain.column);var u=i("domain.row");void 0!==u&&(u<l.rows?s=l._domains.y[u]:delete r.domain.row)}var f=i("domain.x",o),h=i("domain.y",s);f[0]<f[1]||(r.domain.x=o.slice()),h[0]<h[1]||(r.domain.y=s.slice())}},{"../lib/extend":493}],585:[function(r,n,i){"use strict";n.exports=function(r){var n=r.editType,i=r.colorEditType;void 0===i&&(i=n);var a={family:{valType:"string",noBlank:!0,strict:!0,editType:n},size:{valType:"number",min:1,editType:n},color:{valType:"color",editType:i},editType:n};return r.autoSize&&(a.size.dflt="auto"),r.autoColor&&(a.color.dflt="auto"),r.arrayOk&&(a.family.arrayOk=!0,a.size.arrayOk=!0,a.color.arrayOk=!0),a}},{}],586:[function(r,n,i){"use strict";n.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],587:[function(r,n,i){"use strict";i.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},i.axesNames=["lonaxis","lataxis"],i.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},i.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},i.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},i.clipPad=.001,i.precision=.1,i.landColor="#F0DC82",i.waterColor="#3399FF",i.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},i.sphereSVG={type:"Sphere"},i.fillLayers={ocean:1,land:1,lakes:1},i.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},i.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],i.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],i.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],588:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("d3-geo"),s=o.geoPath,l=o.geoDistance,c=r("d3-geo-projection"),u=r("../../registry"),f=r("../../lib"),h=f.strTranslate,p=r("../../components/color"),d=r("../../components/drawing"),m=r("../../components/fx"),g=r("../plots"),v=r("../cartesian/axes"),y=r("../cartesian/autorange").getAutoRange,x=r("../../components/dragelement"),b=r("../cartesian/select").prepSelect,_=r("../cartesian/select").clearSelect,w=r("../cartesian/select").selectOnClick,T=r("./zoom"),k=r("./constants"),A=r("../../lib/geo_location_utils"),M=r("../../lib/topojson_utils"),S=r("topojson-client").feature;function E(r){this.id=r.id,this.graphDiv=r.graphDiv,this.container=r.container,this.topojsonURL=r.topojsonURL,this.isStatic=r.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var L=E.prototype;function C(r,n){var i=k.clipPad,a=r[0]+i,o=r[1]-i,s=n[0]+i,l=n[1]-i;a>0&&o<0&&(o+=360);var c=(o-a)/4;return{type:"Polygon",coordinates:[[[a,s],[a,l],[a+c,l],[a+2*c,l],[a+3*c,l],[o,l],[o,s],[o-c,s],[o-2*c,s],[o-3*c,s],[a,s]]]}}n.exports=function(r){return new E(r)},L.plot=function(r,n,i){var a=this,o=n[this.id],s=[],l=!1;for(var c in k.layerNameToAdjective)if("frame"!==c&&o["show"+c]){l=!0;break}for(var u=0;u<r.length;u++)if(r[0][0].trace.locationmode){l=!0;break}if(l){var f=M.getTopojsonName(o);null!==a.topojson&&f===a.topojsonName||(a.topojsonName=f,void 0===PlotlyGeoAssets.topojson[a.topojsonName]&&s.push(a.fetchTopojson()))}s=s.concat(A.fetchTraceGeoData(r)),i.push(new Promise(function(i,o){Promise.all(s).then(function(){a.topojson=PlotlyGeoAssets.topojson[a.topojsonName],a.update(r,n),i()}).catch(o)}))},L.fetchTopojson=function(){var r=this,n=M.getTopojsonPath(r.topojsonURL,r.topojsonName);return new Promise(function(i,o){a.json(n,function(a,s){if(a)return 404===a.status?o(Error(["plotly.js could not find topojson file at",n,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):o(Error(["unexpected error while fetching topojson file at",n].join(" ")));PlotlyGeoAssets.topojson[r.topojsonName]=s,i()})})},L.update=function(r,n){var i=n[this.id];this.hasChoropleth=!1;for(var a=0;a<r.length;a++){var o=r[a],s=o[0].trace;"choropleth"===s.type&&(this.hasChoropleth=!0),!0===s.visible&&s._length>0&&s._module.calcGeoJSON(o,n)}if(!this.updateProjection(r,n)){this.viewInitial&&this.scope===i.scope||this.saveViewInitial(i),this.scope=i.scope,this.updateBaseLayers(n,i),this.updateDims(n,i),this.updateFx(n,i),g.generalUpdatePerTraceModule(this.graphDiv,this,r,i);var l=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=l.selectAll(".point"),this.dataPoints.text=l.selectAll("text"),this.dataPaths.line=l.selectAll(".js-line");var c=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=c.selectAll("path"),this.render()}},L.updateProjection=function(r,n){var i=this.graphDiv,a=n[this.id],u=n._size,h=a.domain,p=a.projection,d=a.lonaxis,m=a.lataxis,g=d._ax,v=m._ax,x=this.projection=function(r){var n=r.projection,i=n.type,a=k.projNames[i];a="geo"+f.titleCase(a);for(var u=(o[a]||c[a])(),h=r._isSatellite?180*Math.acos(1/n.distance)/Math.PI:r._isClipped?k.lonaxisSpan[i]/2:null,p=["center","rotate","parallels","clipExtent"],d=function(r){return r?u:[]},m=0;m<p.length;m++){var g=p[m];"function"!=typeof u[g]&&(u[g]=d)}return u.isLonLatOverEdges=function(r){if(null===u(r))return!0;if(h){var n=u.rotate();return l(r,[-n[0],-n[1]])>h*Math.PI/180}return!1},u.getPath=function(){return s().projection(u)},u.getBounds=function(r){return u.getPath().bounds(r)},u.precision(k.precision),r._isSatellite&&u.tilt(n.tilt).distance(n.distance),h&&u.clipAngle(h-k.clipPad),u}(a),b=[[u.l+u.w*h.x[0],u.t+u.h*(1-h.y[1])],[u.l+u.w*h.x[1],u.t+u.h*(1-h.y[0])]],_=a.center||{},w=p.rotation||{},T=d.range||[],A=m.range||[];if(a.fitbounds){g._length=b[1][0]-b[0][0],v._length=b[1][1]-b[0][1],g.range=y(i,g),v.range=y(i,v);var M=(g.range[0]+g.range[1])/2,S=(v.range[0]+v.range[1])/2;if(a._isScoped)_={lon:M,lat:S};else if(a._isClipped){_={lon:M,lat:S},w={lon:M,lat:S,roll:w.roll};var E=p.type,L=k.lonaxisSpan[E]/2||180,P=k.lataxisSpan[E]/2||90;T=[M-L,M+L],A=[S-P,S+P]}else _={lon:M,lat:S},w={lon:M,lat:w.lat,roll:w.roll}}x.center([_.lon-w.lon,_.lat-w.lat]).rotate([-w.lon,-w.lat,w.roll]).parallels(p.parallels);var I=C(T,A);x.fitExtent(b,I);var O=this.bounds=x.getBounds(I),z=this.fitScale=x.scale(),D=x.translate();if(a.fitbounds){var R=x.getBounds(C(g.range,v.range)),F=Math.min((O[1][0]-O[0][0])/(R[1][0]-R[0][0]),(O[1][1]-O[0][1])/(R[1][1]-R[0][1]));isFinite(F)?x.scale(F*z):f.warn("Something went wrong during"+this.id+"fitbounds computations.")}else x.scale(p.scale*z);var B=this.midPt=[(O[0][0]+O[1][0])/2,(O[0][1]+O[1][1])/2];if(x.translate([D[0]+(B[0]-D[0]),D[1]+(B[1]-D[1])]).clipExtent(O),a._isAlbersUsa){var N=x([_.lon,_.lat]),j=x.translate();x.translate([j[0]-(N[0]-j[0]),j[1]-(N[1]-j[1])])}},L.updateBaseLayers=function(r,n){var i=this,o=i.topojson,s=i.layers,l=i.basePaths;function c(r){return"lonaxis"===r||"lataxis"===r}function u(r){return!!k.lineLayers[r]}function f(r){return!!k.fillLayers[r]}var h=(this.hasChoropleth?k.layersForChoropleth:k.layers).filter(function(r){return u(r)||f(r)?n["show"+r]:!c(r)||n[r].showgrid}),m=i.framework.selectAll(".layer").data(h,String);m.exit().each(function(r){delete s[r],delete l[r],a.select(this).remove()}),m.enter().append("g").attr("class",function(r){return"layer "+r}).each(function(r){var n=s[r]=a.select(this);"bg"===r?i.bgRect=n.append("rect").style("pointer-events","all"):c(r)?l[r]=n.append("path").style("fill","none"):"backplot"===r?n.append("g").classed("choroplethlayer",!0):"frontplot"===r?n.append("g").classed("scatterlayer",!0):u(r)?l[r]=n.append("path").style("fill","none").style("stroke-miterlimit",2):f(r)&&(l[r]=n.append("path").style("stroke","none"))}),m.order(),m.each(function(i){var a=l[i],s=k.layerNameToAdjective[i];"frame"===i?a.datum(k.sphereSVG):u(i)||f(i)?a.datum(S(o,o.objects[i])):c(i)&&a.datum(function(r,n,i){var a,o,s,l=n[r],c=k.scopeDefaults[n.scope];"lonaxis"===r?(a=c.lonaxisRange,o=c.lataxisRange,s=function(r,n){return[r,n]}):"lataxis"===r&&(a=c.lataxisRange,o=c.lonaxisRange,s=function(r,n){return[n,r]});var u={type:"linear",range:[a[0],a[1]-1e-6],tick0:l.tick0,dtick:l.dtick};v.setConvert(u,i);var f=v.calcTicks(u);n.isScoped||"lonaxis"!==r||f.pop();for(var h=f.length,p=Array(h),d=0;d<h;d++)for(var m=f[d].x,g=p[d]=[],y=o[0];y<o[1]+2.5;y+=2.5)g.push(s(m,y));return{type:"MultiLineString",coordinates:p}}(i,n,r)).call(p.stroke,n[i].gridcolor).call(d.dashLine,"",n[i].gridwidth),u(i)?a.call(p.stroke,n[s+"color"]).call(d.dashLine,"",n[s+"width"]):f(i)&&a.call(p.fill,n[s+"color"])})},L.updateDims=function(r,n){var i=this.bounds,a=(n.framewidth||0)/2,o=i[0][0]-a,s=i[0][1]-a,l=i[1][0]-o+a,c=i[1][1]-s+a;d.setRect(this.clipRect,o,s,l,c),this.bgRect.call(d.setRect,o,s,l,c).call(p.fill,n.bgcolor),this.xaxis._offset=o,this.xaxis._length=l,this.yaxis._offset=s,this.yaxis._length=c},L.updateFx=function(r,n){var i=this,o=i.graphDiv,s=i.bgRect,l=r.dragmode,c=r.clickmode;if(!i.isStatic){"select"===l?h=function(r,n){(r.range={})[i.id]=[d([n.xmin,n.ymin]),d([n.xmax,n.ymax])]}:"lasso"===l&&(h=function(r,n,a){(r.lassoPoints={})[i.id]=a.filtered.map(d)});var h,p={element:i.bgRect.node(),gd:o,plotinfo:{id:i.id,xaxis:i.xaxis,yaxis:i.yaxis,fillRangeItems:h},xaxes:[i.xaxis],yaxes:[i.yaxis],subplot:i.id,clickFn:function(r){2===r&&_(o)}};"pan"===l?(s.node().onmousedown=null,s.call(T(i,n)),s.on("dblclick.zoom",function(){var r=i.viewInitial,n={};for(var a in r)n[i.id+"."+a]=r[a];u.call("_guiRelayout",o,n),o.emit("plotly_doubleclick",null)}),o._context._scrollZoom.geo||s.on("wheel.zoom",null)):"select"!==l&&"lasso"!==l||(s.on(".zoom",null),p.prepFn=function(r,n,i){b(r,n,i,p,l)},x.init(p)),s.on("mousemove",function(){var r=i.projection.invert(f.getPositionFromD3Event());if(!r)return x.unhover(o,a.event);i.xaxis.p2c=function(){return r[0]},i.yaxis.p2c=function(){return r[1]},m.hover(o,a.event,i.id)}),s.on("mouseout",function(){o._dragging||x.unhover(o,a.event)}),s.on("click",function(){"select"!==l&&"lasso"!==l&&(c.indexOf("select")>-1&&w(a.event,o,[i.xaxis],[i.yaxis],i.id,p),c.indexOf("event")>-1&&m.click(o,a.event))})}function d(r){return i.projection.invert([r[0]+i.xaxis._offset,r[1]+i.yaxis._offset])}},L.makeFramework=function(){var r=this,n=r.graphDiv,i=n._fullLayout,o="clip"+i._uid+r.id;r.clipDef=i._clips.append("clipPath").attr("id",o),r.clipRect=r.clipDef.append("rect"),r.framework=a.select(r.container).append("g").attr("class","geo "+r.id).call(d.setClipUrl,o,n),r.project=function(n){var i=r.projection(n);return i?[i[0]-r.xaxis._offset,i[1]-r.yaxis._offset]:[null,null]},r.xaxis={_id:"x",c2p:function(n){return r.project(n)[0]}},r.yaxis={_id:"y",c2p:function(n){return r.project(n)[1]}},r.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},v.setConvert(r.mockAxis,i)},L.saveViewInitial=function(r){var n,i=r.center||{},a=r.projection,o=a.rotation||{};this.viewInitial={fitbounds:r.fitbounds,"projection.scale":a.scale},n=r._isScoped?{"center.lon":i.lon,"center.lat":i.lat}:r._isClipped?{"projection.rotation.lon":o.lon,"projection.rotation.lat":o.lat}:{"center.lon":i.lon,"center.lat":i.lat,"projection.rotation.lon":o.lon},f.extendFlat(this.viewInitial,n)},L.render=function(){var r,n=this.projection,i=n.getPath();function a(r){var i=n(r.lonlat);return i?h(i[0],i[1]):null}function o(r){return n.isLonLatOverEdges(r.lonlat)?"none":null}for(r in this.basePaths)this.basePaths[r].attr("d",i);for(r in this.dataPaths)this.dataPaths[r].attr("d",function(r){return i(r.geojson)});for(r in this.dataPoints)this.dataPoints[r].attr("display",o).attr("transform",a)}},{"../../components/color":366,"../../components/dragelement":385,"../../components/drawing":388,"../../components/fx":406,"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/topojson_utils":532,"../../registry":638,"../cartesian/autorange":553,"../cartesian/axes":554,"../cartesian/select":575,"../plots":619,"./constants":587,"./zoom":592,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":315}],589:[function(r,n,i){"use strict";var a=r("../../plots/get_data").getSubplotCalcData,o=r("../../lib").counterRegex,s=r("./geo"),l=o("geo"),c={};c.geo={valType:"subplotid",dflt:"geo",editType:"calc"},n.exports={attr:"geo",name:"geo",idRoot:"geo",idRegex:l,attrRegex:l,attributes:c,layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),plot:function(r){for(var n=r._fullLayout,i=r.calcdata,o=n._subplots.geo,l=0;l<o.length;l++){var c=o[l],u=a(i,"geo",c),f=n[c]._subplot;f||(f=s({id:c,graphDiv:r,container:n._geolayer.node(),topojsonURL:r._context.topojsonURL,staticPlot:r._context.staticPlot}),n[c]._subplot=f),f.plot(u,n,r._promises)}},updateFx:function(r){for(var n=r._fullLayout,i=n._subplots.geo,a=0;a<i.length;a++){var o=n[i[a]];o._subplot.updateFx(n,o)}},clean:function(r,n,i,a){for(var o=a._subplots.geo||[],s=0;s<o.length;s++){var l=o[s],c=a[l]._subplot;!n[l]&&c&&(c.framework.remove(),c.clipDef.remove())}}}},{"../../lib":503,"../../plots/get_data":593,"./geo":588,"./layout_attributes":590,"./layout_defaults":591}],590:[function(r,n,i){"use strict";var a=r("../../components/color/attributes"),o=r("../domain").attributes,s=r("./constants"),l=r("../../plot_api/edit_types").overrideAll,c=r("../../lib/sort_object_keys"),u={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:a.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};(n.exports=l({domain:o({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:c(s.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:c(s.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:a.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:s.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:s.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:s.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:s.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:a.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:a.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:a.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:a.background},lonaxis:u,lataxis:u},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":365,"../../lib/sort_object_keys":526,"../../plot_api/edit_types":536,"../domain":584,"./constants":587}],591:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../subplot_defaults"),s=r("../get_data").getSubplotData,l=r("./constants"),c=r("./layout_attributes"),u=l.axesNames;function f(r,n,i,o){var c=s(o.fullData,"geo",o.id).map(function(r){return r._expandedIndex}),f=i("resolution"),h=i("scope"),p=l.scopeDefaults[h],d=i("projection.type",p.projType),m=n._isAlbersUsa="albers usa"===d;m&&(h=n.scope="usa");var g=n._isScoped="world"!==h,v=n._isSatellite="satellite"===d,y=n._isConic=-1!==d.indexOf("conic")||"albers"===d,x=n._isClipped=!!l.lonaxisSpan[d];if(!1===r.visible){var b=a.extendDeep({},n._template);b.showcoastlines=!1,b.showcountries=!1,b.showframe=!1,b.showlakes=!1,b.showland=!1,b.showocean=!1,b.showrivers=!1,b.showsubunits=!1,b.lonaxis&&(b.lonaxis.showgrid=!1),b.lataxis&&(b.lataxis.showgrid=!1),n._template=b}for(var _=i("visible"),w=0;w<u.length;w++){var T,k=u[w],A=[30,10][w];if(g)T=p[k+"Range"];else{var M=l[k+"Span"],S=(M[d]||M["*"])/2,E=i("projection.rotation."+k.substr(0,3),p.projRotate[w]);T=[E-S,E+S]}var L=i(k+".range",T);i(k+".tick0"),i(k+".dtick",A),i(k+".showgrid",!!_&&void 0)&&(i(k+".gridcolor"),i(k+".gridwidth")),n[k]._ax={type:"linear",_id:k.slice(0,3),_traceIndices:c,setScale:a.identity,c2l:a.identity,r2l:a.identity,autorange:!0,range:L.slice(),_m:1,_input:{}}}var C=n.lonaxis.range,P=n.lataxis.range,I=C[0],O=C[1];I>0&&O<0&&(O+=360);var z,D,R,F=(I+O)/2;if(!m){var B=g?p.projRotate:[F,0,0];z=i("projection.rotation.lon",B[0]),i("projection.rotation.lat",B[1]),i("projection.rotation.roll",B[2]),i("showcoastlines",!g&&_)&&(i("coastlinecolor"),i("coastlinewidth")),i("showocean",!!_&&void 0)&&i("oceancolor")}m?(D=-96.6,R=38.7):(D=g?F:z,R=(P[0]+P[1])/2),i("center.lon",D),i("center.lat",R),v&&(i("projection.tilt"),i("projection.distance")),y&&i("projection.parallels",p.projParallels||[0,60]),i("projection.scale"),i("showland",!!_&&void 0)&&i("landcolor"),i("showlakes",!!_&&void 0)&&i("lakecolor"),i("showrivers",!!_&&void 0)&&(i("rivercolor"),i("riverwidth")),i("showcountries",g&&"usa"!==h&&_)&&(i("countrycolor"),i("countrywidth")),("usa"===h||"north america"===h&&50===f)&&(i("showsubunits",_),i("subunitcolor"),i("subunitwidth")),g||i("showframe",_)&&(i("framecolor"),i("framewidth")),i("bgcolor"),i("fitbounds")&&(delete n.projection.scale,g?(delete n.center.lon,delete n.center.lat):x?(delete n.center.lon,delete n.center.lat,delete n.projection.rotation.lon,delete n.projection.rotation.lat,delete n.lonaxis.range,delete n.lataxis.range):(delete n.center.lon,delete n.center.lat,delete n.projection.rotation.lon))}n.exports=function(r,n,i){o(r,n,i,{type:"geo",attributes:c,handleDefaults:f,fullData:i,partition:"y"})}},{"../../lib":503,"../get_data":593,"../subplot_defaults":632,"./constants":587,"./layout_attributes":590}],592:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../registry"),l=Math.PI/180,c=180/Math.PI,u={cursor:"pointer"},f={cursor:"auto"};function h(r,n){return a.behavior.zoom().translate(n.translate()).scale(n.scale())}function p(r,n,i){var a=r.id,l=r.graphDiv,c=l.layout,u=c[a],f=l._fullLayout,h=f[a],p={},d={};function m(r,n){p[a+"."+r]=o.nestedProperty(u,r).get(),s.call("_storeDirectGUIEdit",c,f._preGUI,p);var i=o.nestedProperty(h,r);i.get()!==n&&(i.set(n),o.nestedProperty(u,r).set(n),d[a+"."+r]=n)}i(m),m("projection.scale",n.scale()/r.fitScale),m("fitbounds",!1),l.emit("plotly_relayout",d)}function d(r,n){var i,a,o,s=r.invert(n);return s&&isFinite(s[0])&&isFinite(s[1])&&(i=s[0]*l,[(o=Math.cos(a=s[1]*l))*Math.cos(i),o*Math.sin(i),Math.sin(a)])}function m(r,n,i,a){var o=g(i-r),s=g(a-n);return Math.sqrt(o*o+s*s)}function g(r){return(r%360+540)%360-180}function v(r,n,i){var a=i*l,o=r.slice(),s=0===n?1:0,c=2===n?1:2,u=Math.cos(a),f=Math.sin(a);return o[s]=r[s]*u-r[c]*f,o[c]=r[c]*u+r[s]*f,o}function y(r,n){for(var i=0,a=0,o=r.length;a<o;++a)i+=r[a]*n[a];return i}n.exports=function(r,n){var i=r.projection;return(n._isScoped?function(r,n){var i=h(0,n);function o(i){var a=n.invert(r.midPt);i("center.lon",a[0]),i("center.lat",a[1])}return i.on("zoomstart",function(){a.select(this).style(u)}).on("zoom",function(){n.scale(a.event.scale).translate(a.event.translate),r.render();var i=n.invert(r.midPt);r.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":n.scale()/r.fitScale,"geo.center.lon":i[0],"geo.center.lat":i[1]})}).on("zoomend",function(){a.select(this).style(f),p(r,n,o)}),i}:n._isClipped?function(r,n){var i,o={r:n.rotate(),k:n.scale()},s=h(0,n),g=function(r){for(var n=0,i=arguments.length,o=[];++n<i;)o.push(arguments[n]);var s=a.dispatch.apply(null,o);return s.of=function(n,i){return function(o){var l;try{l=o.sourceEvent=a.event,o.target=r,a.event=o,s[o.type].apply(n,i)}finally{a.event=l}}},s}(s,"zoomstart","zoom","zoomend"),x=0,b=s.on;function _(r){var i=n.rotate();r("projection.rotation.lon",-i[0]),r("projection.rotation.lat",-i[1])}return s.on("zoomstart",function(){a.select(this).style(u);var r,f,h,p,_,w,T,k,A,M,S=a.mouse(this),E=n.rotate(),L=E,C=n.translate(),P=(r=.5*E[0]*l,f=.5*E[1]*l,h=.5*E[2]*l,p=Math.sin(r),_=Math.cos(r),w=Math.sin(f),T=Math.cos(f),k=Math.sin(h),[_*T*(A=Math.cos(h))+p*w*k,p*T*A-_*w*k,_*w*A+p*T*k,_*T*k-p*w*A]);i=d(n,S),b.call(s,"zoom",function(){var r,s=a.mouse(this);if(n.scale(o.k=a.event.scale),i){if(d(n,s)){n.rotate(E).translate(C);var l,u,f,h,p,x,b,_,w,T,k,A,M,I,O,z,D,R,F,B,N,j,U,V,H,q,G=d(n,s),Y=[Math.atan2(2*((l=function(r,n){if(r&&n){var i=[r[1]*n[2]-r[2]*n[1],r[2]*n[0]-r[0]*n[2],r[0]*n[1]-r[1]*n[0]],a=Math.sqrt(y(i,i)),o=.5*Math.acos(Math.max(-1,Math.min(1,y(r,n)))),s=Math.sin(o)/a;return a&&[Math.cos(o),i[2]*s,-i[1]*s,i[0]*s]}}(i,G),u=P[0],f=P[1],h=P[2],p=P[3],x=l[0],b=l[1],T=[u*x-f*b-h*(_=l[2])-p*(w=l[3]),u*b+f*x+h*w-p*_,u*_-f*w+h*x+p*b,u*w+f*_-h*b+p*x])[0]*T[1]+T[2]*T[3]),1-2*(T[1]*T[1]+T[2]*T[2]))*c,Math.asin(Math.max(-1,Math.min(1,2*(T[0]*T[2]-T[3]*T[1]))))*c,Math.atan2(2*(T[0]*T[3]+T[1]*T[2]),1-2*(T[2]*T[2]+T[3]*T[3]))*c],W=o.r=(k=i,A=L,M=v(k,2,Y[0]),M=v(M,1,Y[1]),M=v(M,0,Y[2]-A[2]),z=k[0],D=k[1],R=k[2],F=M[0],B=M[1],N=M[2],j=Math.atan2(D,z)*c,Math.abs(B)>(U=Math.sqrt(z*z+D*D))?(O=(B>0?90:-90)-j,I=0):(O=Math.asin(B/U)*c-j,I=Math.sqrt(U*U-B*B)),V=180-O-2*j,H=(Math.atan2(N,F)-Math.atan2(R,I))*c,q=(Math.atan2(N,F)-Math.atan2(R,-I))*c,m(A[0],A[1],O,H)<=m(A[0],A[1],V,q)?[O,H,A[2]]:[V,q,A[2]]);isFinite(W[0])&&isFinite(W[1])&&isFinite(W[2])||(W=L),n.rotate(W),L=W}}else i=d(n,S=s);r=g.of(this,arguments),r({type:"zoom"})}),M=g.of(this,arguments),x++||M({type:"zoomstart"})}).on("zoomend",function(){var i;a.select(this).style(f),b.call(s,"zoom",null),i=g.of(this,arguments),--x||i({type:"zoomend"}),p(r,n,_)}).on("zoom.redraw",function(){r.render();var i=n.rotate();r.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":n.scale()/r.fitScale,"geo.projection.rotation.lon":-i[0],"geo.projection.rotation.lat":-i[1]})}),a.rebind(s,g,"on")}:function(r,n){var i,o,s,l,c,d,m,g,v,y=h(0,n);function x(r){return n.invert(r)}function b(i){var a=n.rotate(),o=n.invert(r.midPt);i("projection.rotation.lon",-a[0]),i("center.lon",o[0]),i("center.lat",o[1])}return y.on("zoomstart",function(){a.select(this).style(u),i=a.mouse(this),o=n.rotate(),s=n.translate(),l=o,c=x(i)}).on("zoom",function(){if(d=a.mouse(this),function(r){var i=x(r);if(!i)return!0;var a=n(i);return Math.abs(a[0]-r[0])>2||Math.abs(a[1]-r[1])>2}(i))return y.scale(n.scale()),void y.translate(n.translate());n.scale(a.event.scale),n.translate([s[0],a.event.translate[1]]),c?x(d)&&(g=x(d),m=[l[0]+(g[0]-c[0]),o[1],o[2]],n.rotate(m),l=m):c=x(i=d),v=!0,r.render();var u=n.rotate(),f=n.invert(r.midPt);r.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":n.scale()/r.fitScale,"geo.center.lon":f[0],"geo.center.lat":f[1],"geo.projection.rotation.lon":-u[0]})}).on("zoomend",function(){a.select(this).style(f),v&&p(r,n,b)}),y})(r,i)}},{"../../lib":503,"../../registry":638,"@plotly/d3":58}],593:[function(r,n,i){"use strict";var a=r("../registry"),o=r("./cartesian/constants").SUBPLOT_PATTERN;i.getSubplotCalcData=function(r,n,i){var o=a.subplotsRegistry[n];if(!o)return[];for(var s=o.attr,l=[],c=0;c<r.length;c++){var u=r[c];u[0].trace[s]===i&&l.push(u)}return l},i.getModuleCalcData=function(r,n){var i,o=[],s=[];if(!(i="string"==typeof n?a.getModule(n).plot:"function"==typeof n?n:n.plot))return[o,r];for(var l=0;l<r.length;l++){var c=r[l],u=c[0].trace;!0===u.visible&&0!==u._length&&(u._module.plot===i?o.push(c):s.push(c))}return[o,s]},i.getSubplotData=function(r,n,i){if(!a.subplotsRegistry[n])return[];var s,l,c,u=a.subplotsRegistry[n].attr,f=[];if("gl2d"===n){var h=i.match(o);l="x"+h[1],c="y"+h[2]}for(var p=0;p<r.length;p++)s=r[p],"gl2d"===n&&a.traceIs(s,"gl2d")?s[u[0]]===l&&s[u[1]]===c&&f.push(s):s[u]===i&&f.push(s);return f}},{"../registry":638,"./cartesian/constants":561}],594:[function(r,n,i){"use strict";var a=r("mouse-change"),o=r("mouse-wheel"),s=r("mouse-event-offset"),l=r("../cartesian/constants"),c=r("has-passive-events");function u(r,n){this.element=r,this.plot=n,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}n.exports=function(r){var n=r.mouseContainer,i=r.glplot,f=new u(n,i);function h(){r.xaxis.autorange=!1,r.yaxis.autorange=!1}function p(n,a,o){var s,c,u=r.calcDataBox(),p=i.viewBox,d=f.lastPos[0],m=f.lastPos[1],g=l.MINDRAG*i.pixelRatio,v=l.MINZOOM*i.pixelRatio;function y(n,i,a){var o=Math.min(i,a),s=Math.max(i,a);o!==s?(u[n]=o,u[n+2]=s,f.dataBox=u,r.setRanges(u)):(r.selectBox.selectBox=[0,0,1,1],r.glplot.setDirty())}switch(a*=i.pixelRatio,o*=i.pixelRatio,o=p[3]-p[1]-o,r.fullLayout.dragmode){case"zoom":if(n){var x=a/(p[2]-p[0])*(u[2]-u[0])+u[0],b=o/(p[3]-p[1])*(u[3]-u[1])+u[1];f.boxInited||(f.boxStart[0]=x,f.boxStart[1]=b,f.dragStart[0]=a,f.dragStart[1]=o),f.boxEnd[0]=x,f.boxEnd[1]=b,f.boxInited=!0,f.boxEnabled||f.boxStart[0]===f.boxEnd[0]&&f.boxStart[1]===f.boxEnd[1]||(f.boxEnabled=!0);var _=Math.abs(f.dragStart[0]-a)<v,w=Math.abs(f.dragStart[1]-o)<v;if(!function(){for(var n=r.graphDiv._fullLayout._axisConstraintGroups,i=r.xaxis._id,a=r.yaxis._id,o=0;o<n.length;o++)if(-1!==n[o][i]){if(-1!==n[o][a])return!0;break}return!1}()||_&&w)_&&(f.boxEnd[0]=f.boxStart[0]),w&&(f.boxEnd[1]=f.boxStart[1]);else{s=f.boxEnd[0]-f.boxStart[0],c=f.boxEnd[1]-f.boxStart[1];var T=(u[3]-u[1])/(u[2]-u[0]);Math.abs(s*T)>Math.abs(c)?(f.boxEnd[1]=f.boxStart[1]+Math.abs(s)*T*(c>=0?1:-1),f.boxEnd[1]<u[1]?(f.boxEnd[1]=u[1],f.boxEnd[0]=f.boxStart[0]+(u[1]-f.boxStart[1])/Math.abs(T)):f.boxEnd[1]>u[3]&&(f.boxEnd[1]=u[3],f.boxEnd[0]=f.boxStart[0]+(u[3]-f.boxStart[1])/Math.abs(T))):(f.boxEnd[0]=f.boxStart[0]+Math.abs(c)/T*(s>=0?1:-1),f.boxEnd[0]<u[0]?(f.boxEnd[0]=u[0],f.boxEnd[1]=f.boxStart[1]+(u[0]-f.boxStart[0])*Math.abs(T)):f.boxEnd[0]>u[2]&&(f.boxEnd[0]=u[2],f.boxEnd[1]=f.boxStart[1]+(u[2]-f.boxStart[0])*Math.abs(T)))}}else f.boxEnabled?(s=f.boxStart[0]!==f.boxEnd[0],c=f.boxStart[1]!==f.boxEnd[1],s||c?(s&&(y(0,f.boxStart[0],f.boxEnd[0]),r.xaxis.autorange=!1),c&&(y(1,f.boxStart[1],f.boxEnd[1]),r.yaxis.autorange=!1),r.relayoutCallback()):r.glplot.setDirty(),f.boxEnabled=!1,f.boxInited=!1):f.boxInited&&(f.boxInited=!1);break;case"pan":f.boxEnabled=!1,f.boxInited=!1,n?(f.panning||(f.dragStart[0]=a,f.dragStart[1]=o),Math.abs(f.dragStart[0]-a)<g&&(a=f.dragStart[0]),Math.abs(f.dragStart[1]-o)<g&&(o=f.dragStart[1]),s=(d-a)*(u[2]-u[0])/(i.viewBox[2]-i.viewBox[0]),c=(m-o)*(u[3]-u[1])/(i.viewBox[3]-i.viewBox[1]),u[0]+=s,u[2]+=s,u[1]+=c,u[3]+=c,r.setRanges(u),f.panning=!0,f.lastInputTime=Date.now(),h(),r.cameraChanged(),r.handleAnnotations()):f.panning&&(f.panning=!1,r.relayoutCallback())}f.lastPos[0]=a,f.lastPos[1]=o}return f.mouseListener=a(n,p),n.addEventListener("touchstart",function(r){var i=s(r.changedTouches[0],n);p(0,i[0],i[1]),p(1,i[0],i[1]),r.preventDefault()},!!c&&{passive:!1}),n.addEventListener("touchmove",function(r){r.preventDefault();var i=s(r.changedTouches[0],n);p(1,i[0],i[1]),r.preventDefault()},!!c&&{passive:!1}),n.addEventListener("touchend",function(r){p(0,f.lastPos[0],f.lastPos[1]),r.preventDefault()},!!c&&{passive:!1}),f.wheelListener=o(n,function(n,a){if(!r.scrollZoom)return!1;var o=r.calcDataBox(),s=i.viewBox,l=f.lastPos[0],c=f.lastPos[1],u=Math.exp(5*a/(s[3]-s[1])),p=l/(s[2]-s[0])*(o[2]-o[0])+o[0],d=c/(s[3]-s[1])*(o[3]-o[1])+o[1];return o[0]=(o[0]-p)*u+p,o[2]=(o[2]-p)*u+p,o[1]=(o[1]-d)*u+d,o[3]=(o[3]-d)*u+d,r.setRanges(o),f.lastInputTime=Date.now(),h(),r.cameraChanged(),r.handleAnnotations(),r.relayoutCallback(),!0},!0),f}},{"../cartesian/constants":561,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],595:[function(r,n,i){"use strict";var a=r("../cartesian/axes"),o=r("../../lib/str2rgbarray");function s(r){this.scene=r,this.gl=r.gl,this.pixelRatio=r.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var l=s.prototype,c=["xaxis","yaxis"];l.merge=function(r){var n,i,a,s,l,u,f,h,p,d,m;for(this.titleEnable=!1,this.backgroundColor=o(r.plot_bgcolor),d=0;d<2;++d){var g=(n=c[d]).charAt(0);for(a=(i=r[this.scene[n]._name]).title.text===this.scene.fullLayout._dfltTitle[g]?"":i.title.text,m=0;m<=2;m+=2)this.labelEnable[d+m]=!1,this.labels[d+m]=a,this.labelColor[d+m]=o(i.title.font.color),this.labelFont[d+m]=i.title.font.family,this.labelSize[d+m]=i.title.font.size,this.labelPad[d+m]=this.getLabelPad(n,i),this.tickEnable[d+m]=!1,this.tickColor[d+m]=o((i.tickfont||{}).color),this.tickAngle[d+m]="auto"===i.tickangle?0:-(Math.PI*i.tickangle)/180,this.tickPad[d+m]=this.getTickPad(i),this.tickMarkLength[d+m]=0,this.tickMarkWidth[d+m]=i.tickwidth||0,this.tickMarkColor[d+m]=o(i.tickcolor),this.borderLineEnable[d+m]=!1,this.borderLineColor[d+m]=o(i.linecolor),this.borderLineWidth[d+m]=i.linewidth||0;f=this.hasSharedAxis(i),l=this.hasAxisInDfltPos(n,i)&&!f,u=this.hasAxisInAltrPos(n,i)&&!f,s=i.mirror||!1,h=f?-1!==String(s).indexOf("all"):!!s,p=f?"allticks"===s:-1!==String(s).indexOf("ticks"),l?this.labelEnable[d]=!0:u&&(this.labelEnable[d+2]=!0),l?this.tickEnable[d]=i.showticklabels:u&&(this.tickEnable[d+2]=i.showticklabels),(l||h)&&(this.borderLineEnable[d]=i.showline),(u||h)&&(this.borderLineEnable[d+2]=i.showline),(l||p)&&(this.tickMarkLength[d]=this.getTickMarkLength(i)),(u||p)&&(this.tickMarkLength[d+2]=this.getTickMarkLength(i)),this.gridLineEnable[d]=i.showgrid,this.gridLineColor[d]=o(i.gridcolor),this.gridLineWidth[d]=i.gridwidth,this.zeroLineEnable[d]=i.zeroline,this.zeroLineColor[d]=o(i.zerolinecolor),this.zeroLineWidth[d]=i.zerolinewidth}},l.hasSharedAxis=function(r){var n=this.scene,i=n.fullLayout._subplots.gl2d;return 0!==a.findSubplotsWithAxis(i,r).indexOf(n.id)},l.hasAxisInDfltPos=function(r,n){var i=n.side;return"xaxis"===r?"bottom"===i:"yaxis"===r?"left"===i:void 0},l.hasAxisInAltrPos=function(r,n){var i=n.side;return"xaxis"===r?"top"===i:"yaxis"===r?"right"===i:void 0},l.getLabelPad=function(r,n){var i=n.title.font.size,a=n.showticklabels;return"xaxis"===r?"top"===n.side?i*(1.5+(a?1:0))-10:i*(1.5+(a?.5:0))-10:"yaxis"===r?"right"===n.side?10+i*(1.5+(a?1:.5)):10+i*(1.5+(a?.5:0)):void 0},l.getTickPad=function(r){return"outside"===r.ticks?10+r.ticklen:15},l.getTickMarkLength=function(r){if(!r.ticks)return 0;var n=r.ticklen;return"inside"===r.ticks?-n:n},n.exports=function(r){return new s(r)}},{"../../lib/str2rgbarray":528,"../cartesian/axes":554}],596:[function(r,n,i){"use strict";var a=r("../../plot_api/edit_types").overrideAll,o=r("./scene2d"),s=r("../layout_attributes"),l=r("../../constants/xmlns_namespaces"),c=r("../cartesian/constants"),u=r("../cartesian"),f=r("../../components/fx/layout_attributes"),h=r("../get_data").getSubplotData;i.name="gl2d",i.attr=["xaxis","yaxis"],i.idRoot=["x","y"],i.idRegex=c.idRegex,i.attrRegex=c.attrRegex,i.attributes=r("../cartesian/attributes"),i.supplyLayoutDefaults=function(r,n,i){n._has("cartesian")||u.supplyLayoutDefaults(r,n,i)},i.layoutAttrOverrides=a(u.layoutAttributes,"plot","from-root"),i.baseLayoutAttrOverrides=a({plot_bgcolor:s.plot_bgcolor,hoverlabel:f.hoverlabel},"plot","nested"),i.plot=function(r){for(var n=r._fullLayout,i=r._fullData,a=n._subplots.gl2d,s=0;s<a.length;s++){var l=a[s],c=n._plots[l],u=h(i,"gl2d",l),f=c._scene2d;void 0===f&&(f=new o({id:l,graphDiv:r,container:r.querySelector(".gl-container"),staticPlot:r._context.staticPlot,plotGlPixelRatio:r._context.plotGlPixelRatio},n),c._scene2d=f),f.plot(u,r.calcdata,n,r.layout)}},i.clean=function(r,n,i,a){for(var o=a._subplots.gl2d||[],s=0;s<o.length;s++){var l=o[s],c=a._plots[l];c._scene2d&&0===h(r,"gl2d",l).length&&(c._scene2d.destroy(),delete a._plots[l])}u.clean.apply(this,arguments)},i.drawFramework=function(r){r._context.staticPlot||u.drawFramework(r)},i.toSVG=function(r){for(var n=r._fullLayout,i=n._subplots.gl2d,a=0;a<i.length;a++){var o=n._plots[i[a]]._scene2d,s=o.toImage("png");n._glimages.append("svg:image").attr({xmlns:l.svg,"xlink:href":s,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),o.destroy()}},i.updateFx=function(r){for(var n=r._fullLayout,i=n._subplots.gl2d,a=0;a<i.length;a++)n._plots[i[a]]._scene2d.updateFx(n.dragmode)}},{"../../components/fx/layout_attributes":407,"../../constants/xmlns_namespaces":480,"../../plot_api/edit_types":536,"../cartesian":568,"../cartesian/attributes":552,"../cartesian/constants":561,"../get_data":593,"../layout_attributes":610,"./scene2d":597}],597:[function(r,n,i){"use strict";var a,o,s=r("../../registry"),l=r("../../plots/cartesian/axes"),c=r("../../components/fx"),u=r("../../../stackgl_modules").gl_plot2d,f=r("../../../stackgl_modules").gl_spikes2d,h=r("../../../stackgl_modules").gl_select_box,p=r("webgl-context"),d=r("./convert"),m=r("./camera"),g=r("../../lib/show_no_webgl_msg"),v=r("../cartesian/constraints"),y=v.enforce,x=v.clean,b=r("../cartesian/autorange").doAutoRange,_=r("../../components/dragelement/helpers"),w=_.drawMode,T=_.selectMode,k=["xaxis","yaxis"],A=r("../cartesian/constants").SUBPLOT_PATTERN;function M(r,n){this.container=r.container,this.graphDiv=r.graphDiv,this.pixelRatio=r.plotGlPixelRatio||window.devicePixelRatio,this.id=r.id,this.staticPlot=!!r.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(n),this.makeFramework(),this.stopped||(this.glplotOptions=d(this),this.glplotOptions.merge(n),this.glplot=u(this.glplotOptions),this.camera=m(this),this.traces={},this.spikes=f(this.glplot),this.selectBox=h(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}n.exports=M;var S=M.prototype;S.makeFramework=function(){if(this.staticPlot){if(!(o||(o=p({canvas:a=document.createElement("canvas"),preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw Error("Error creating static canvas/context for image server");this.canvas=a,this.gl=o}else{var r=this.container.querySelector(".gl-canvas-focus"),n=p({canvas:r,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!n)return g(this),void(this.stopped=!0);this.canvas=r,this.gl=n}var i=this.canvas;i.style.width="100%",i.style.height="100%",i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.style["pointer-events"]="none",this.updateSize(i);var s=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");s.style.position="absolute",s.style.top=s.style.left="0px",s.style.width=s.style.height="100%",s.style["z-index"]=20,s.style["pointer-events"]="none";var l=this.mouseContainer=document.createElement("div");l.style.position="absolute",l.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var c=this.container;c.appendChild(s),c.appendChild(l);var u=this;l.addEventListener("mouseout",function(){u.isMouseOver=!1,u.unhover()}),l.addEventListener("mouseover",function(){u.isMouseOver=!0})},S.toImage=function(r){r||(r="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(a),this.updateSize(this.canvas);var n=this.glplot.gl,i=n.drawingBufferWidth,o=n.drawingBufferHeight;n.clearColor(1,1,1,0),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),n.bindFramebuffer(n.FRAMEBUFFER,null);var s=new Uint8Array(i*o*4);n.readPixels(0,0,i,o,n.RGBA,n.UNSIGNED_BYTE,s);for(var l=0,c=o-1;l<c;++l,--c)for(var u=0;u<i;++u)for(var f=0;f<4;++f){var h=s[4*(i*l+u)+f];s[4*(i*l+u)+f]=s[4*(i*c+u)+f],s[4*(i*c+u)+f]=h}var p=document.createElement("canvas");p.width=i,p.height=o;var d,m=p.getContext("2d"),g=m.createImageData(i,o);switch(g.data.set(s),m.putImageData(g,0,0),r){case"jpeg":d=p.toDataURL("image/jpeg");break;case"webp":d=p.toDataURL("image/webp");break;default:d=p.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(a),d},S.updateSize=function(r){r||(r=this.canvas);var n=this.pixelRatio,i=this.fullLayout,a=i.width,o=i.height,s=0|Math.ceil(n*a),l=0|Math.ceil(n*o);return r.width===s&&r.height===l||(r.width=s,r.height=l),r},S.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var r=[l.calcTicks(this.xaxis),l.calcTicks(this.yaxis)],n=0;n<2;++n)for(var i=0;i<r[n].length;++i)r[n][i].text=r[n][i].text+"";return r},S.updateRefs=function(r){this.fullLayout=r;var n=this.id.match(A),i="xaxis"+n[1],a="yaxis"+n[2];this.xaxis=this.fullLayout[i],this.yaxis=this.fullLayout[a]},S.relayoutCallback=function(){var r=this.graphDiv,n=this.xaxis,i=this.yaxis,a=r.layout,o={},l=o[n._name+".range"]=n.range.slice(),c=o[i._name+".range"]=i.range.slice();o[n._name+".autorange"]=n.autorange,o[i._name+".autorange"]=i.autorange,s.call("_storeDirectGUIEdit",r.layout,r._fullLayout._preGUI,o);var u=a[n._name];u.range=l,u.autorange=n.autorange;var f=a[i._name];f.range=c,f.autorange=i.autorange,o.lastInputTime=this.camera.lastInputTime,r.emit("plotly_relayout",o)},S.cameraChanged=function(){var r=this.camera;this.glplot.setDataBox(this.calcDataBox());var n=this.computeTickMarks();(function(r,n){for(var i=0;i<2;++i){var a=r[i],o=n[i];if(a.length!==o.length)return!0;for(var s=0;s<a.length;++s)if(a[s].x!==o[s].x)return!0}return!1})(n,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=n,this.glplotOptions.dataBox=r.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},S.handleAnnotations=function(){for(var r=this.graphDiv,n=this.fullLayout.annotations,i=0;i<n.length;i++){var a=n[i];a.xref===this.xaxis._id&&a.yref===this.yaxis._id&&s.getComponentMethod("annotations","drawOne")(r,i)}},S.destroy=function(){if(this.glplot){var r=this.traces;r&&Object.keys(r).map(function(n){r[n].dispose(),delete r[n]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},S.plot=function(r,n,i){var a=this.glplot;this.updateRefs(i),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(r,n),this.updateFx(i.dragmode);var o=i.width,s=i.height;this.updateSize(this.canvas);var l=this.glplotOptions;l.merge(i),l.screenBox=[0,0,o,s];var c={_fullLayout:{_axisConstraintGroups:i._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:i._size}};x(c,this.xaxis),x(c,this.yaxis);var u,f,h=i._size,p=this.xaxis.domain,d=this.yaxis.domain;for(l.viewBox=[h.l+p[0]*h.w,h.b+d[0]*h.h,o-h.r-(1-p[1])*h.w,s-h.t-(1-d[1])*h.h],this.mouseContainer.style.width=h.w*(p[1]-p[0])+"px",this.mouseContainer.style.height=h.h*(d[1]-d[0])+"px",this.mouseContainer.height=h.h*(d[1]-d[0]),this.mouseContainer.style.left=h.l+p[0]*h.w+"px",this.mouseContainer.style.top=h.t+(1-d[1])*h.h+"px",f=0;f<2;++f)(u=this[k[f]])._length=l.viewBox[f+2]-l.viewBox[f],b(this.graphDiv,u),u.setScale();y(c),l.ticks=this.computeTickMarks(),l.dataBox=this.calcDataBox(),l.merge(i),a.update(l),this.glplot.draw()},S.calcDataBox=function(){var r=this.xaxis,n=this.yaxis,i=r.range,a=n.range,o=r.r2l,s=n.r2l;return[o(i[0]),s(a[0]),o(i[1]),s(a[1])]},S.setRanges=function(r){var n=this.xaxis,i=this.yaxis,a=n.l2r,o=i.l2r;n.range=[a(r[0]),a(r[2])],i.range=[o(r[1]),o(r[3])]},S.updateTraces=function(r,n){var i,a,o,s=Object.keys(this.traces);this.fullData=r;t:for(i=0;i<s.length;i++){var l=s[i],c=this.traces[l];for(a=0;a<r.length;a++)if((o=r[a]).uid===l&&o.type===c.type)continue t;c.dispose(),delete this.traces[l]}for(i=0;i<r.length;i++){o=r[i];var u=n[i],f=this.traces[o.uid];f?f.update(o,u):(f=o._module.plot(this,o,u),this.traces[o.uid]=f)}this.glplot.objects.sort(function(r,n){return r._trace.index-n._trace.index})},S.updateFx=function(r){T(r)||w(r)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===r?"move":"zoom"===r?"crosshair":null},S.emitPointAction=function(r,n){for(var i,a=r.trace.uid,o=r.pointIndex,s=0;s<this.fullData.length;s++)this.fullData[s].uid===a&&(i=this.fullData[s]);var l={x:r.traceCoord[0],y:r.traceCoord[1],curveNumber:i.index,pointNumber:o,data:i._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};c.appendArrayPointValue(l,i,o),this.graphDiv.emit(n,{points:[l]})},S.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var r=this.glplot,n=this.camera,i=n.mouseListener,a=1===this.lastButtonState&&0===i.buttons,o=this.fullLayout;this.lastButtonState=i.buttons,this.cameraChanged();var s,l=i.x*r.pixelRatio,u=this.canvas.height-r.pixelRatio*i.y;if(n.boxEnabled&&"zoom"===o.dragmode){this.selectBox.enabled=!0;for(var f=this.selectBox.selectBox=[Math.min(n.boxStart[0],n.boxEnd[0]),Math.min(n.boxStart[1],n.boxEnd[1]),Math.max(n.boxStart[0],n.boxEnd[0]),Math.max(n.boxStart[1],n.boxEnd[1])],h=0;h<2;h++)n.boxStart[h]===n.boxEnd[h]&&(f[h]=r.dataBox[h],f[h+2]=r.dataBox[h+2]);r.setDirty()}else if(!n.panning&&this.isMouseOver){this.selectBox.enabled=!1;var p=o._size,d=this.xaxis.domain,m=this.yaxis.domain,g=(s=r.pick(l/r.pixelRatio+p.l+d[0]*p.w,u/r.pixelRatio-(p.t+(1-m[1])*p.h)))&&s.object._trace.handlePick(s);if(g&&a&&this.emitPointAction(g,"plotly_click"),s&&"skip"!==s.object._trace.hoverinfo&&o.hovermode&&g&&(!this.lastPickResult||this.lastPickResult.traceUid!==g.trace.uid||this.lastPickResult.dataCoord[0]!==g.dataCoord[0]||this.lastPickResult.dataCoord[1]!==g.dataCoord[1])){this.lastPickResult={traceUid:g.trace?g.trace.uid:null,dataCoord:g.dataCoord.slice()},this.spikes.update({center:s.dataCoord}),g.screenCoord=[((r.viewBox[2]-r.viewBox[0])*(s.dataCoord[0]-r.dataBox[0])/(r.dataBox[2]-r.dataBox[0])+r.viewBox[0])/r.pixelRatio,(this.canvas.height-(r.viewBox[3]-r.viewBox[1])*(s.dataCoord[1]-r.dataBox[1])/(r.dataBox[3]-r.dataBox[1])-r.viewBox[1])/r.pixelRatio],this.emitPointAction(g,"plotly_hover");var v=this.fullData[g.trace.index]||{},y=g.pointIndex,x=c.castHoverinfo(v,o,y);if(x&&"all"!==x){var b=x.split("+");-1===b.indexOf("x")&&(g.traceCoord[0]=void 0),-1===b.indexOf("y")&&(g.traceCoord[1]=void 0),-1===b.indexOf("z")&&(g.traceCoord[2]=void 0),-1===b.indexOf("text")&&(g.textLabel=void 0),-1===b.indexOf("name")&&(g.name=void 0)}c.loneHover({x:g.screenCoord[0],y:g.screenCoord[1],xLabel:this.hoverFormatter("xaxis",g.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",g.traceCoord[1]),zLabel:g.traceCoord[2],text:g.textLabel,name:g.name,color:c.castHoverOption(v,y,"bgcolor")||g.color,borderColor:c.castHoverOption(v,y,"bordercolor"),fontFamily:c.castHoverOption(v,y,"font.family"),fontSize:c.castHoverOption(v,y,"font.size"),fontColor:c.castHoverOption(v,y,"font.color"),nameLength:c.castHoverOption(v,y,"namelength"),textAlign:c.castHoverOption(v,y,"align")},{container:this.svgContainer,gd:this.graphDiv})}}s||this.unhover(),r.draw()}},S.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),c.loneUnhover(this.svgContainer))},S.hoverFormatter=function(r,n){if(void 0!==n){var i=this[r];return l.tickText(i,i.c2l(n),"hover").text}}},{"../../../stackgl_modules":1120,"../../components/dragelement/helpers":384,"../../components/fx":406,"../../lib/show_no_webgl_msg":525,"../../plots/cartesian/axes":554,"../../registry":638,"../cartesian/autorange":553,"../cartesian/constants":561,"../cartesian/constraints":562,"./camera":594,"./convert":595,"webgl-context":331}],598:[function(r,n,i){"use strict";var a=r("../../plot_api/edit_types").overrideAll,o=r("../../components/fx/layout_attributes"),s=r("./scene"),l=r("../get_data").getSubplotData,c=r("../../lib"),u=r("../../constants/xmlns_namespaces");i.name="gl3d",i.attr="scene",i.idRoot="scene",i.idRegex=i.attrRegex=c.counterRegex("scene"),i.attributes=r("./layout/attributes"),i.layoutAttributes=r("./layout/layout_attributes"),i.baseLayoutAttrOverrides=a({hoverlabel:o.hoverlabel},"plot","nested"),i.supplyLayoutDefaults=r("./layout/defaults"),i.plot=function(r){for(var n=r._fullLayout,i=r._fullData,a=n._subplots.gl3d,o=0;o<a.length;o++){var c=a[o],u=l(i,"gl3d",c),f=n[c],h=f.camera,p=f._scene;p||(p=new s({id:c,graphDiv:r,container:r.querySelector(".gl-container"),staticPlot:r._context.staticPlot,plotGlPixelRatio:r._context.plotGlPixelRatio,camera:h},n),f._scene=p),p.viewInitial||(p.viewInitial={up:{x:h.up.x,y:h.up.y,z:h.up.z},eye:{x:h.eye.x,y:h.eye.y,z:h.eye.z},center:{x:h.center.x,y:h.center.y,z:h.center.z}}),p.plot(u,n,r.layout)}},i.clean=function(r,n,i,a){for(var o=a._subplots.gl3d||[],s=0;s<o.length;s++){var l=o[s];!n[l]&&a[l]._scene&&(a[l]._scene.destroy(),a._infolayer&&a._infolayer.selectAll(".annotation-"+l).remove())}},i.toSVG=function(r){for(var n=r._fullLayout,i=n._subplots.gl3d,a=n._size,o=0;o<i.length;o++){var s=n[i[o]],l=s.domain,c=s._scene,f=c.toImage("png");n._glimages.append("svg:image").attr({xmlns:u.svg,"xlink:href":f,x:a.l+a.w*l.x[0],y:a.t+a.h*(1-l.y[1]),width:a.w*(l.x[1]-l.x[0]),height:a.h*(l.y[1]-l.y[0]),preserveAspectRatio:"none"}),c.destroy()}},i.cleanId=function(r){if(r.match(/^scene[0-9]*$/)){var n=r.substr(5);return"1"===n&&(n=""),"scene"+n}},i.updateFx=function(r){for(var n=r._fullLayout,i=n._subplots.gl3d,a=0;a<i.length;a++)n[i[a]]._scene.updateFx(n.dragmode,n.hovermode)}},{"../../components/fx/layout_attributes":407,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../plot_api/edit_types":536,"../get_data":593,"./layout/attributes":599,"./layout/defaults":603,"./layout/layout_attributes":604,"./scene":608}],599:[function(r,n,i){"use strict";n.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],600:[function(r,n,i){"use strict";var a=r("../../../components/color"),o=r("../../cartesian/layout_attributes"),s=r("../../../lib/extend").extendFlat,l=r("../../../plot_api/edit_types").overrideAll;n.exports=l({visible:o.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:a.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:o.color,categoryorder:o.categoryorder,categoryarray:o.categoryarray,title:{text:o.title.text,font:o.title.font},type:s({},o.type,{values:["-","linear","log","date","category"]}),autotypenumbers:o.autotypenumbers,autorange:o.autorange,rangemode:o.rangemode,range:s({},o.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:o.tickmode,nticks:o.nticks,tick0:o.tick0,dtick:o.dtick,tickvals:o.tickvals,ticktext:o.ticktext,ticks:o.ticks,mirror:o.mirror,ticklen:o.ticklen,tickwidth:o.tickwidth,tickcolor:o.tickcolor,showticklabels:o.showticklabels,tickfont:o.tickfont,tickangle:o.tickangle,tickprefix:o.tickprefix,showtickprefix:o.showtickprefix,ticksuffix:o.ticksuffix,showticksuffix:o.showticksuffix,showexponent:o.showexponent,exponentformat:o.exponentformat,minexponent:o.minexponent,separatethousands:o.separatethousands,tickformat:o.tickformat,tickformatstops:o.tickformatstops,hoverformat:o.hoverformat,showline:o.showline,linecolor:o.linecolor,linewidth:o.linewidth,showgrid:o.showgrid,gridcolor:s({},o.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:o.gridwidth,zeroline:o.zeroline,zerolinecolor:o.zerolinecolor,zerolinewidth:o.zerolinewidth,_deprecated:{title:o._deprecated.title,titlefont:o._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":366,"../../../lib/extend":493,"../../../plot_api/edit_types":536,"../../cartesian/layout_attributes":569}],601:[function(r,n,i){"use strict";var a=r("tinycolor2").mix,o=r("../../../lib"),s=r("../../../plot_api/plot_template"),l=r("./axis_attributes"),c=r("../../cartesian/type_defaults"),u=r("../../cartesian/axis_defaults"),f=["xaxis","yaxis","zaxis"];n.exports=function(r,n,i){var h,p;function d(r,n){return o.coerce(h,p,l,r,n)}for(var m=0;m<f.length;m++){var g=f[m];h=r[g]||{},(p=s.newContainer(n,g))._id=g[0]+i.scene,p._name=g,c(h,p,d,i),u(h,p,d,{font:i.font,letter:g[0],data:i.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:i.bgColor,calendar:i.calendar},i.fullLayout),d("gridcolor",a(p.color,i.bgColor,13600/187).toRgbString()),d("title.text",g[0]),p.setScale=o.noop,d("showspikes")&&(d("spikesides"),d("spikethickness"),d("spikecolor",p.color)),d("showaxeslabels"),d("showbackground")&&d("backgroundcolor")}}},{"../../../lib":503,"../../../plot_api/plot_template":543,"../../cartesian/axis_defaults":556,"../../cartesian/type_defaults":582,"./axis_attributes":600,tinycolor2:312}],602:[function(r,n,i){"use strict";var a=r("../../../lib/str2rgbarray"),o=r("../../../lib"),s=["xaxis","yaxis","zaxis"];function l(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}l.prototype.merge=function(r,n){for(var i=0;i<3;++i){var l=n[s[i]];l.visible?(this.labels[i]=r._meta?o.templateString(l.title.text,r._meta):l.title.text,"font"in l.title&&(l.title.font.color&&(this.labelColor[i]=a(l.title.font.color)),l.title.font.family&&(this.labelFont[i]=l.title.font.family),l.title.font.size&&(this.labelSize[i]=l.title.font.size)),"showline"in l&&(this.lineEnable[i]=l.showline),"linecolor"in l&&(this.lineColor[i]=a(l.linecolor)),"linewidth"in l&&(this.lineWidth[i]=l.linewidth),"showgrid"in l&&(this.gridEnable[i]=l.showgrid),"gridcolor"in l&&(this.gridColor[i]=a(l.gridcolor)),"gridwidth"in l&&(this.gridWidth[i]=l.gridwidth),"log"===l.type?this.zeroEnable[i]=!1:"zeroline"in l&&(this.zeroEnable[i]=l.zeroline),"zerolinecolor"in l&&(this.zeroLineColor[i]=a(l.zerolinecolor)),"zerolinewidth"in l&&(this.zeroLineWidth[i]=l.zerolinewidth),"ticks"in l&&l.ticks?this.lineTickEnable[i]=!0:this.lineTickEnable[i]=!1,"ticklen"in l&&(this.lineTickLength[i]=this._defaultLineTickLength[i]=l.ticklen),"tickcolor"in l&&(this.lineTickColor[i]=a(l.tickcolor)),"tickwidth"in l&&(this.lineTickWidth[i]=l.tickwidth),"tickangle"in l&&(this.tickAngle[i]="auto"===l.tickangle?-3600:-(Math.PI*l.tickangle)/180),"showticklabels"in l&&(this.tickEnable[i]=l.showticklabels),"tickfont"in l&&(l.tickfont.color&&(this.tickColor[i]=a(l.tickfont.color)),l.tickfont.family&&(this.tickFont[i]=l.tickfont.family),l.tickfont.size&&(this.tickSize[i]=l.tickfont.size)),"mirror"in l?-1!==["ticks","all","allticks"].indexOf(l.mirror)?(this.lineTickMirror[i]=!0,this.lineMirror[i]=!0):!0===l.mirror?(this.lineTickMirror[i]=!1,this.lineMirror[i]=!0):(this.lineTickMirror[i]=!1,this.lineMirror[i]=!1):this.lineMirror[i]=!1,"showbackground"in l&&!1!==l.showbackground?(this.backgroundEnable[i]=!0,this.backgroundColor[i]=a(l.backgroundcolor)):this.backgroundEnable[i]=!1):(this.tickEnable[i]=!1,this.labelEnable[i]=!1,this.lineEnable[i]=!1,this.lineTickEnable[i]=!1,this.gridEnable[i]=!1,this.zeroEnable[i]=!1,this.backgroundEnable[i]=!1)}},n.exports=function(r,n){var i=new l;return i.merge(r,n),i}},{"../../../lib":503,"../../../lib/str2rgbarray":528}],603:[function(r,n,i){"use strict";var a=r("../../../lib"),o=r("../../../components/color"),s=r("../../../registry"),l=r("../../subplot_defaults"),c=r("./axis_defaults"),u=r("./layout_attributes"),f=r("../../get_data").getSubplotData;function h(r,n,i,a){for(var l=i("bgcolor"),u=o.combine(l,a.paper_bgcolor),h=["up","center","eye"],p=0;p<h.length;p++)i("camera."+h[p]+".x"),i("camera."+h[p]+".y"),i("camera."+h[p]+".z");i("camera.projection.type");var d=!!i("aspectratio.x")&&!!i("aspectratio.y")&&!!i("aspectratio.z"),m=i("aspectmode",d?"manual":"auto");d||(r.aspectratio=n.aspectratio={x:1,y:1,z:1},"manual"===m&&(n.aspectmode="auto"),r.aspectmode=n.aspectmode);var g=f(a.fullData,"gl3d",a.id);c(r,n,{font:a.font,scene:a.id,data:g,bgColor:u,calendar:a.calendar,autotypenumbersDflt:a.autotypenumbersDflt,fullLayout:a.fullLayout}),s.getComponentMethod("annotations3d","handleDefaults")(r,n,a);var v=a.getDfltFromLayout("dragmode");if(!1!==v&&!v){if(v="orbit",r.camera&&r.camera.up){var y=r.camera.up.x,x=r.camera.up.y,b=r.camera.up.z;0!==b&&(y&&x&&b?b/Math.sqrt(y*y+x*x+b*b)>.999&&(v="turntable"):v="turntable")}else v="turntable"}i("dragmode",v),i("hovermode",a.getDfltFromLayout("hovermode"))}n.exports=function(r,n,i){var o=n._basePlotModules.length>1;l(r,n,i,{type:"gl3d",attributes:u,handleDefaults:h,fullLayout:n,font:n.font,fullData:i,getDfltFromLayout:function(n){if(!o)return a.validate(r[n],u[n])?r[n]:void 0},autotypenumbersDflt:n.autotypenumbers,paper_bgcolor:n.paper_bgcolor,calendar:n.calendar})}},{"../../../components/color":366,"../../../lib":503,"../../../registry":638,"../../get_data":593,"../../subplot_defaults":632,"./axis_defaults":601,"./layout_attributes":604}],604:[function(r,n,i){"use strict";var a=r("./axis_attributes"),o=r("../../domain").attributes,s=r("../../../lib/extend").extendFlat,l=r("../../../lib").counterRegex;function c(r,n,i){return{x:{valType:"number",dflt:r,editType:"camera"},y:{valType:"number",dflt:n,editType:"camera"},z:{valType:"number",dflt:i,editType:"camera"},editType:"camera"}}n.exports={_arrayAttrRegexps:[l("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:s(c(0,0,1),{}),center:s(c(0,0,0),{}),eye:s(c(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:o({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:a,yaxis:a,zaxis:a,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":503,"../../../lib/extend":493,"../../domain":584,"./axis_attributes":600}],605:[function(r,n,i){"use strict";var a=r("../../../lib/str2rgbarray"),o=["xaxis","yaxis","zaxis"];function s(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}s.prototype.merge=function(r){for(var n=0;n<3;++n){var i=r[o[n]];i.visible?(this.enabled[n]=i.showspikes,this.colors[n]=a(i.spikecolor),this.drawSides[n]=i.spikesides,this.lineWidth[n]=i.spikethickness):(this.enabled[n]=!1,this.drawSides[n]=!1)}},n.exports=function(r){var n=new s;return n.merge(r),n}},{"../../../lib/str2rgbarray":528}],606:[function(r,n,i){"use strict";n.exports=function(r){for(var n=r.axesOptions,i=r.glplot.axesPixels,c=r.fullSceneLayout,u=[[],[],[]],f=0;f<3;++f){var h=c[s[f]];if(h._length=(i[f].hi-i[f].lo)*i[f].pixelsPerDataUnit/r.dataScale[f],Math.abs(h._length)===1/0||isNaN(h._length))u[f]=[];else{h._input_range=h.range.slice(),h.range[0]=i[f].lo/r.dataScale[f],h.range[1]=i[f].hi/r.dataScale[f],h._m=1/(r.dataScale[f]*i[f].pixelsPerDataUnit),h.range[0]===h.range[1]&&(h.range[0]-=1,h.range[1]+=1);var p=h.tickmode;if("auto"===h.tickmode){h.tickmode="linear";var d=h.nticks||o.constrain(h._length/40,4,9);a.autoTicks(h,Math.abs(h.range[1]-h.range[0])/d)}for(var m=a.calcTicks(h,{msUTC:!0}),g=0;g<m.length;++g)m[g].x=m[g].x*r.dataScale[f],"date"===h.type&&(m[g].text=m[g].text.replace(/\<br\>/g," "));u[f]=m,h.tickmode=p}}for(f=0,n.ticks=u;f<3;++f)for(g=0,l[f]=.5*(r.glplot.bounds[0][f]+r.glplot.bounds[1][f]);g<2;++g)n.bounds[g][f]=r.glplot.bounds[g][f];r.contourLevels=function(r){for(var n=[,,,],i=0;i<3;++i){for(var a=r[i],o=Array(a.length),s=0;s<a.length;++s)o[s]=a[s].x;n[i]=o}return n}(u)};var a=r("../../cartesian/axes"),o=r("../../../lib"),s=["xaxis","yaxis","zaxis"],l=[0,0,0]},{"../../../lib":503,"../../cartesian/axes":554}],607:[function(r,n,i){"use strict";function a(r,n){var i,a,o=[0,0,0,0];for(i=0;i<4;++i)for(a=0;a<4;++a)o[a]+=r[4*i+a]*n[i];return o}n.exports=function(r,n){return a(r.projection,a(r.view,a(r.model,[n[0],n[1],n[2],1])))}},{}],608:[function(r,n,i){"use strict";var a,o,s=r("../../../stackgl_modules").gl_plot3d,l=s.createCamera,c=s.createScene,u=r("webgl-context"),f=r("has-passive-events"),h=r("../../registry"),p=r("../../lib"),d=p.preserveDrawingBuffer(),m=r("../../plots/cartesian/axes"),g=r("../../components/fx"),v=r("../../lib/str2rgbarray"),y=r("../../lib/show_no_webgl_msg"),x=r("./project"),b=r("./layout/convert"),_=r("./layout/spikes"),w=r("./layout/tick_marks");function T(r,n){var i=document.createElement("div"),a=r.container;this.graphDiv=r.graphDiv;var o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.style.position="absolute",o.style.top=o.style.left="0px",o.style.width=o.style.height="100%",o.style["z-index"]=20,o.style["pointer-events"]="none",i.appendChild(o),this.svgContainer=o,i.id=r.id,i.style.position="absolute",i.style.top=i.style.left="0px",i.style.width=i.style.height="100%",a.appendChild(i),this.fullLayout=n,this.id=r.id||"scene",this.fullSceneLayout=n[this.id],this.plotArgs=[[],{},{}],this.axesOptions=b(n,n[this.id]),this.spikeOptions=_(n[this.id]),this.container=i,this.staticMode=!!r.staticPlot,this.pixelRatio=this.pixelRatio||r.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=h.getComponentMethod("annotations3d","convert"),this.drawAnnotations=h.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var k=T.prototype;k.prepareOptions=function(){var r={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:d,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(o||(o=u({canvas:a=document.createElement("canvas"),preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw Error("error creating static canvas/context for image server");r.gl=o,r.canvas=a}return r};var A=!0;k.tryCreatePlot=function(){var r=this.prepareOptions(),n=!0;try{this.glplot=c(r)}catch(i){if(this.staticMode||!A||d)n=!1;else{p.warn("webgl setup failed possibly due to false preserveDrawingBuffer config. The mobile/tablet device may not be detected by is-mobile module. Enabling preserveDrawingBuffer in second attempt to create webgl scene...");try{d=r.glOptions.preserveDrawingBuffer=!0,this.glplot=c(r)}catch(i){d=r.glOptions.preserveDrawingBuffer=!1,n=!1}}}return A=!1,n},k.initializeGLCamera=function(){var r=this.fullSceneLayout.camera,n="orthographic"===r.projection.type;this.camera=l(this.container,{center:[r.center.x,r.center.y,r.center.z],eye:[r.eye.x,r.eye.y,r.eye.z],up:[r.up.x,r.up.y,r.up.z],_ortho:n,zoomMin:.01,zoomMax:100,mode:"orbit"})},k.initializeGLPlot=function(){var r=this;if(r.initializeGLCamera(),!r.tryCreatePlot())return y(r);r.traces={},r.make4thDimension();var n=r.graphDiv,i=n.layout,a=function(){var n={};return r.isCameraChanged(i)&&(n[r.id+".camera"]=r.getCamera()),r.isAspectChanged(i)&&(n[r.id+".aspectratio"]=r.glplot.getAspectratio(),"manual"!==i[r.id].aspectmode&&(r.fullSceneLayout.aspectmode=i[r.id].aspectmode=n[r.id+".aspectmode"]="manual")),n},o=function(r){if(!1!==r.fullSceneLayout.dragmode){var n=a();r.saveLayout(i),r.graphDiv.emit("plotly_relayout",n)}};return r.glplot.canvas&&(r.glplot.canvas.addEventListener("mouseup",function(){o(r)}),r.glplot.canvas.addEventListener("wheel",function(i){if(n._context._scrollZoom.gl3d){if(r.camera._ortho){var a=i.deltaX>i.deltaY?1.1:1/1.1,s=r.glplot.getAspectratio();r.glplot.setAspectratio({x:a*s.x,y:a*s.y,z:a*s.z})}o(r)}},!!f&&{passive:!1}),r.glplot.canvas.addEventListener("mousemove",function(){if(!1!==r.fullSceneLayout.dragmode&&0!==r.camera.mouseListener.buttons){var n=a();r.graphDiv.emit("plotly_relayouting",n)}}),r.staticMode||r.glplot.canvas.addEventListener("webglcontextlost",function(i){n&&n.emit&&n.emit("plotly_webglcontextlost",{event:i,layer:r.id})},!1)),r.glplot.oncontextloss=function(){r.recoverContext()},r.glplot.onrender=function(){r.render()},!0},k.render=function(){var r,n=this,i=n.graphDiv,a=n.svgContainer,o=n.container.getBoundingClientRect();i._fullLayout._calcInverseTransform(i);var s=i._fullLayout._invScaleX,l=i._fullLayout._invScaleY,c=o.width*s,u=o.height*l;a.setAttributeNS(null,"viewBox","0 0 "+c+" "+u),a.setAttributeNS(null,"width",c),a.setAttributeNS(null,"height",u),w(n),n.glplot.axes.update(n.axesOptions);for(var f=Object.keys(n.traces),h=null,d=n.glplot.selection,v=0;v<f.length;++v)"skip"!==(r=n.traces[f[v]]).data.hoverinfo&&r.handlePick(d)&&(h=r),r.setContourLevels&&r.setContourLevels();function y(r,i,a){var o=n.fullSceneLayout[r+"axis"];return"log"!==o.type&&(i=o.d2l(i)),m.hoverLabelText(o,i,a)}if(null!==h){var b=x(n.glplot.cameraParams,d.dataCoordinate);r=h.data;var _,T=i._fullData[r.index],k=d.index,A={xLabel:y("x",d.traceCoordinate[0],r.xhoverformat),yLabel:y("y",d.traceCoordinate[1],r.yhoverformat),zLabel:y("z",d.traceCoordinate[2],r.zhoverformat)},M=g.castHoverinfo(T,n.fullLayout,k),S=(M||"").split("+"),E=M&&"all"===M;T.hovertemplate||E||(-1===S.indexOf("x")&&(A.xLabel=void 0),-1===S.indexOf("y")&&(A.yLabel=void 0),-1===S.indexOf("z")&&(A.zLabel=void 0),-1===S.indexOf("text")&&(d.textLabel=void 0),-1===S.indexOf("name")&&(h.name=void 0));var L=[];"cone"===r.type||"streamtube"===r.type?(A.uLabel=y("x",d.traceCoordinate[3],r.uhoverformat),(E||-1!==S.indexOf("u"))&&L.push("u: "+A.uLabel),A.vLabel=y("y",d.traceCoordinate[4],r.vhoverformat),(E||-1!==S.indexOf("v"))&&L.push("v: "+A.vLabel),A.wLabel=y("z",d.traceCoordinate[5],r.whoverformat),(E||-1!==S.indexOf("w"))&&L.push("w: "+A.wLabel),A.normLabel=d.traceCoordinate[6].toPrecision(3),(E||-1!==S.indexOf("norm"))&&L.push("norm: "+A.normLabel),"streamtube"===r.type&&(A.divergenceLabel=d.traceCoordinate[7].toPrecision(3),(E||-1!==S.indexOf("divergence"))&&L.push("divergence: "+A.divergenceLabel)),d.textLabel&&L.push(d.textLabel),_=L.join("<br>")):"isosurface"===r.type||"volume"===r.type?(A.valueLabel=m.hoverLabelText(n._mockAxis,n._mockAxis.d2l(d.traceCoordinate[3]),r.valuehoverformat),L.push("value: "+A.valueLabel),d.textLabel&&L.push(d.textLabel),_=L.join("<br>")):_=d.textLabel;var C={x:d.traceCoordinate[0],y:d.traceCoordinate[1],z:d.traceCoordinate[2],data:T._input,fullData:T,curveNumber:T.index,pointNumber:k};g.appendArrayPointValue(C,T,k),r._module.eventData&&(C=T._module.eventData(C,d,T,{},k));var P={points:[C]};if(n.fullSceneLayout.hovermode){var I=[];g.loneHover({trace:T,x:(.5+.5*b[0]/b[3])*c,y:(.5-.5*b[1]/b[3])*u,xLabel:A.xLabel,yLabel:A.yLabel,zLabel:A.zLabel,text:_,name:h.name,color:g.castHoverOption(T,k,"bgcolor")||h.color,borderColor:g.castHoverOption(T,k,"bordercolor"),fontFamily:g.castHoverOption(T,k,"font.family"),fontSize:g.castHoverOption(T,k,"font.size"),fontColor:g.castHoverOption(T,k,"font.color"),nameLength:g.castHoverOption(T,k,"namelength"),textAlign:g.castHoverOption(T,k,"align"),hovertemplate:p.castOption(T,k,"hovertemplate"),hovertemplateLabels:p.extendFlat({},C,A),eventData:[C]},{container:a,gd:i,inOut_bbox:I}),C.bbox=I[0]}d.buttons&&d.distance<5?i.emit("plotly_click",P):i.emit("plotly_hover",P),this.oldEventData=P}else g.loneUnhover(a),this.oldEventData&&i.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;n.drawAnnotations(n)},k.recoverContext=function(){var r=this;r.glplot.dispose();var n=function(){r.glplot.gl.isContextLost()?requestAnimationFrame(n):r.initializeGLPlot()?r.plot.apply(r,r.plotArgs):p.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(n)};var M=["xaxis","yaxis","zaxis"];k.plot=function(r,n,i){if(this.plotArgs=[r,n,i],!this.glplot.contextLost){var a,o,s,l,c,u,f=n[this.id],h=i[this.id];this.fullLayout=n,this.fullSceneLayout=f,this.axesOptions.merge(n,f),this.spikeOptions.merge(f),this.setViewport(f),this.updateFx(f.dragmode,f.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(v(f.bgcolor)),this.setConvert(c),r?Array.isArray(r)||(r=[r]):r=[];var d=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(s=0;s<r.length;++s)!0===(a=r[s]).visible&&0!==a._length&&function(r,n,i){for(var a=r.fullSceneLayout,o=0;o<3;o++){var s=M[o],l=s.charAt(0),c=a[s],u=n[l],f=n[l+"calendar"],h=n["_"+l+"length"];if(p.isArrayOrTypedArray(u))for(var d,m=0;m<(h||u.length);m++)if(p.isArrayOrTypedArray(u[m]))for(var g=0;g<u[m].length;++g)!isNaN(d=c.d2l(u[m][g],0,f))&&isFinite(d)&&(i[0][o]=Math.min(i[0][o],d),i[1][o]=Math.max(i[1][o],d));else!isNaN(d=c.d2l(u[m],0,f))&&isFinite(d)&&(i[0][o]=Math.min(i[0][o],d),i[1][o]=Math.max(i[1][o],d));else i[0][o]=Math.min(i[0][o],0),i[1][o]=Math.max(i[1][o],h-1)}}(this,a,d);!function(r,n){for(var i=r.fullSceneLayout,a=i.annotations||[],o=0;o<3;o++)for(var s=M[o],l=s.charAt(0),c=i[s],u=0;u<a.length;u++){var f=a[u];if(f.visible){var h=c.r2l(f[l]);!isNaN(h)&&isFinite(h)&&(n[0][o]=Math.min(n[0][o],h),n[1][o]=Math.max(n[1][o],h))}}}(this,d);var m=[1,1,1];for(l=0;l<3;++l)d[1][l]===d[0][l]?m[l]=1:m[l]=1/(d[1][l]-d[0][l]);for(this.dataScale=m,this.convertAnnotations(this),s=0;s<r.length;++s)!0===(a=r[s]).visible&&0!==a._length&&((o=this.traces[a.uid])?o.data.type===a.type?o.update(a):(o.dispose(),o=a._module.plot(this,a),this.traces[a.uid]=o):(o=a._module.plot(this,a),this.traces[a.uid]=o),o.name=a.name);var g=Object.keys(this.traces);t:for(s=0;s<g.length;++s){for(l=0;l<r.length;++l)if(r[l].uid===g[s]&&!0===r[l].visible&&0!==r[l]._length)continue t;(o=this.traces[g[s]]).dispose(),delete this.traces[g[s]]}this.glplot.objects.sort(function(r,n){return r._trace.data.index-n._trace.data.index});var y,x=[[0,0,0],[0,0,0]],b=[],_={};for(s=0;s<3;++s){if((u=(c=f[M[s]]).type)in _?(_[u].acc*=m[s],_[u].count+=1):_[u]={acc:m[s],count:1},c.autorange){x[0][s]=1/0,x[1][s]=-1/0;var w=this.glplot.objects,T=this.fullSceneLayout.annotations||[],k=c._name.charAt(0);for(l=0;l<w.length;l++){var A=w[l],S=A.bounds,E=A._trace.data._pad||0;"ErrorBars"===A.constructor.name&&c._lowerLogErrorBound?x[0][s]=Math.min(x[0][s],c._lowerLogErrorBound):x[0][s]=Math.min(x[0][s],S[0][s]/m[s]-E),x[1][s]=Math.max(x[1][s],S[1][s]/m[s]+E)}for(l=0;l<T.length;l++){var L=T[l];if(L.visible){var C=c.r2l(L[k]);x[0][s]=Math.min(x[0][s],C),x[1][s]=Math.max(x[1][s],C)}}if("rangemode"in c&&"tozero"===c.rangemode&&(x[0][s]=Math.min(x[0][s],0),x[1][s]=Math.max(x[1][s],0)),x[0][s]>x[1][s])x[0][s]=-1,x[1][s]=1;else{var P=x[1][s]-x[0][s];x[0][s]-=P/32,x[1][s]+=P/32}if("reversed"===c.autorange){var I=x[0][s];x[0][s]=x[1][s],x[1][s]=I}}else{var O=c.range;x[0][s]=c.r2l(O[0]),x[1][s]=c.r2l(O[1])}x[0][s]===x[1][s]&&(x[0][s]-=1,x[1][s]+=1),b[s]=x[1][s]-x[0][s],this.glplot.setBounds(s,{min:x[0][s]*m[s],max:x[1][s]*m[s]})}var z=f.aspectmode;if("cube"===z)y=[1,1,1];else if("manual"===z){var D=f.aspectratio;y=[D.x,D.y,D.z]}else{if("auto"!==z&&"data"!==z)throw Error("scene.js aspectRatio was not one of the enumerated types");var R=[1,1,1];for(s=0;s<3;++s){var F=_[u=(c=f[M[s]]).type];R[s]=Math.pow(F.acc,1/F.count)/m[s]}y="data"===z||Math.max.apply(null,R)/Math.min.apply(null,R)<=4?R:[1,1,1]}f.aspectratio.x=h.aspectratio.x=y[0],f.aspectratio.y=h.aspectratio.y=y[1],f.aspectratio.z=h.aspectratio.z=y[2],this.glplot.setAspectratio(f.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:f.aspectratio.x,y:f.aspectratio.y,z:f.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=f.aspectmode);var B=f.domain||null,N=n._size||null;if(B&&N){var j=this.container.style;j.position="absolute",j.left=N.l+B.x[0]*N.w+"px",j.top=N.t+(1-B.y[1])*N.h+"px",j.width=N.w*(B.x[1]-B.x[0])+"px",j.height=N.h*(B.y[1]-B.y[0])+"px"}this.glplot.redraw()}},k.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},k.getCamera=function(){var r;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(r=this.camera).up[0],y:r.up[1],z:r.up[2]},center:{x:r.center[0],y:r.center[1],z:r.center[2]},eye:{x:r.eye[0],y:r.eye[1],z:r.eye[2]},projection:{type:!0===r._ortho?"orthographic":"perspective"}}},k.setViewport=function(r){var n=r.camera;this.camera.lookAt.apply(this,[[n.eye.x,n.eye.y,n.eye.z],[n.center.x,n.center.y,n.center.z],[n.up.x,n.up.y,n.up.z]]),this.glplot.setAspectratio(r.aspectratio),"orthographic"===n.projection.type!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},k.isCameraChanged=function(r){var n=this.getCamera(),i=p.nestedProperty(r,this.id+".camera").get(),a=!1;if(void 0===i)a=!0;else{for(var o=0;o<3;o++)for(var s=0;s<3;s++)if(!function(r,n,i,a){var o=["up","center","eye"],s=["x","y","z"];return n[o[i]]&&r[o[i]][s[a]]===n[o[i]][s[a]]}(n,i,o,s)){a=!0;break}(!i.projection||n.projection&&n.projection.type!==i.projection.type)&&(a=!0)}return a},k.isAspectChanged=function(r){var n=this.glplot.getAspectratio(),i=p.nestedProperty(r,this.id+".aspectratio").get();return void 0===i||i.x!==n.x||i.y!==n.y||i.z!==n.z},k.saveLayout=function(r){var n,i,a,o,s,l,c=this.fullLayout,u=this.isCameraChanged(r),f=this.isAspectChanged(r),d=u||f;if(d){var m={};u&&(n=this.getCamera(),a=(i=p.nestedProperty(r,this.id+".camera")).get(),m[this.id+".camera"]=a),f&&(o=this.glplot.getAspectratio(),l=(s=p.nestedProperty(r,this.id+".aspectratio")).get(),m[this.id+".aspectratio"]=l),h.call("_storeDirectGUIEdit",r,c._preGUI,m),u&&(i.set(n),p.nestedProperty(c,this.id+".camera").set(n)),f&&(s.set(o),p.nestedProperty(c,this.id+".aspectratio").set(o),this.glplot.redraw())}return d},k.updateFx=function(r,n){var i=this.camera;if(i){if("orbit"===r)i.mode="orbit",i.keyBindingMode="rotate";else if("turntable"===r){i.up=[0,0,1],i.mode="turntable",i.keyBindingMode="rotate";var a=this.graphDiv,o=a._fullLayout,s=this.fullSceneLayout.camera,l=s.up.x,c=s.up.y,u=s.up.z;if(u/Math.sqrt(l*l+c*c+u*u)<.999){var f=this.id+".camera.up",d={x:0,y:0,z:1},m={};m[f]=d;var g=a.layout;h.call("_storeDirectGUIEdit",g,o._preGUI,m),s.up=d,p.nestedProperty(g,f).set(d)}}else i.keyBindingMode=r}this.fullSceneLayout.hovermode=n},k.toImage=function(r){r||(r="png"),this.staticMode&&this.container.appendChild(a),this.glplot.redraw();var n=this.glplot.gl,i=n.drawingBufferWidth,o=n.drawingBufferHeight;n.bindFramebuffer(n.FRAMEBUFFER,null);var s=new Uint8Array(i*o*4);n.readPixels(0,0,i,o,n.RGBA,n.UNSIGNED_BYTE,s),function(r,n,i){for(var a=0,o=i-1;a<o;++a,--o)for(var s=0;s<n;++s)for(var l=0;l<4;++l){var c=4*(n*a+s)+l,u=4*(n*o+s)+l,f=r[c];r[c]=r[u],r[u]=f}}(s,i,o),function(r,n,i){for(var a=0;a<i;++a)for(var o=0;o<n;++o){var s=4*(n*a+o),l=r[s+3];if(l>0)for(var c=255/l,u=0;u<3;++u)r[s+u]=Math.min(c*r[s+u],255)}}(s,i,o);var l=document.createElement("canvas");l.width=i,l.height=o;var c,u=l.getContext("2d"),f=u.createImageData(i,o);switch(f.data.set(s),u.putImageData(f,0,0),r){case"jpeg":c=l.toDataURL("image/jpeg");break;case"webp":c=l.toDataURL("image/webp");break;default:c=l.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(a),c},k.setConvert=function(){for(var r=0;r<3;r++){var n=this.fullSceneLayout[M[r]];m.setConvert(n,this.fullLayout),n.setScale=p.noop}},k.make4thDimension=function(){var r=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},m.setConvert(this._mockAxis,r)},n.exports=T},{"../../../stackgl_modules":1120,"../../components/fx":406,"../../lib":503,"../../lib/show_no_webgl_msg":525,"../../lib/str2rgbarray":528,"../../plots/cartesian/axes":554,"../../registry":638,"./layout/convert":602,"./layout/spikes":605,"./layout/tick_marks":606,"./project":607,"has-passive-events":229,"webgl-context":331}],609:[function(r,n,i){"use strict";n.exports=function(r,n,i,a){a=a||r.length;for(var o=Array(a),s=0;s<a;s++)o[s]=[r[s],n[s],i[s]];return o}},{}],610:[function(r,n,i){"use strict";var a=r("./font_attributes"),o=r("./animation_attributes"),s=r("../components/color/attributes"),l=r("../components/shapes/draw_newshape/attributes"),c=r("./pad_attributes"),u=r("../lib/extend").extendFlat,f=a({editType:"calc"});f.family.dflt='"Open Sans", verdana, arial, sans-serif',f.size.dflt=12,f.color.dflt=s.defaultLine,n.exports={font:f,title:{text:{valType:"string",editType:"layoutstyle"},font:a({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:u(c({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:s.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:s.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:s.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:l.newshape,activeshape:l.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:u({},o.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:a({editType:"layoutstyle"})}}},{"../components/color/attributes":365,"../components/shapes/draw_newshape/attributes":451,"../lib/extend":493,"./animation_attributes":548,"./font_attributes":585,"./pad_attributes":618}],611:[function(r,n,i){"use strict";var a=r("../../lib/sort_object_keys"),o='\xa9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',s=['\xa9 <a target="_blank" href="https://carto.com/">Carto</a>',o].join(" "),l='Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a> under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>',c={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:o,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:s,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:s,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:l,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:l,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:'Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a> under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>',tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},u=a(c);n.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:c,styleValuesNonMapbox:u,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:"Your custom plotly.js bundle is not using the correct mapbox-gl version\nPlease install mapbox-gl@1.10.1.",noAccessTokenErrorMsg:"Missing Mapbox access token.\nMapbox trace type require a Mapbox access token to be registered.\nFor example:\n  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });\nMore info here: https://www.mapbox.com/help/define-access-token/",missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",u.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:"Set multiple mapbox access token across different mapbox subplot,\nusing first token found as mapbox-gl does not allow multipleaccess tokens on the same page.",mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":'content: ""; cursor: pointer; position: absolute; background-image: url(\'data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E\'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;',"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":'display:block; width: 21px; height: 21px; background-image: url(\'data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E\')'}}},{"../../lib/sort_object_keys":526}],612:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n){var i=r.split(" "),o=i[0],s=i[1],l=a.isArrayOrTypedArray(n)?a.mean(n):n,c=.5+l/100,u=1.5+l/100,f=["",""],h=[0,0];switch(o){case"top":f[0]="top",h[1]=-u;break;case"bottom":f[0]="bottom",h[1]=u}switch(s){case"left":f[1]="right",h[0]=-c;break;case"right":f[1]="left",h[0]=c}return{anchor:f[0]&&f[1]?f.join("-"):f[0]?f[0]:f[1]?f[1]:"center",offset:h}}},{"../../lib":503}],613:[function(r,n,i){"use strict";var a=r("mapbox-gl/dist/mapbox-gl-unminified"),o=r("../../lib"),s=o.strTranslate,l=o.strScale,c=r("../../plots/get_data").getSubplotCalcData,u=r("../../constants/xmlns_namespaces"),f=r("@plotly/d3"),h=r("../../components/drawing"),p=r("../../lib/svg_text_utils"),d=r("./mapbox"),m=i.constants=r("./constants");function g(r){return"string"==typeof r&&(-1!==m.styleValuesMapbox.indexOf(r)||0===r.indexOf("mapbox://"))}i.name="mapbox",i.attr="subplot",i.idRoot="mapbox",i.idRegex=i.attrRegex=o.counterRegex("mapbox"),i.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},i.layoutAttributes=r("./layout_attributes"),i.supplyLayoutDefaults=r("./layout_defaults"),i.plot=function(r){var n=r._fullLayout,i=r.calcdata,s=n._subplots.mapbox;if(a.version!==m.requiredVersion)throw Error(m.wrongVersionErrorMsg);var l=function(r,n){var i=r._fullLayout;if(""===r._context.mapboxAccessToken)return"";for(var a=[],s=[],l=!1,c=!1,u=0;u<n.length;u++){var f=i[n[u]],h=f.accesstoken;g(f.style)&&(h?o.pushUnique(a,h):(g(f._input.style)&&(o.error("Uses Mapbox map style, but did not set an access token."),l=!0),c=!0)),h&&o.pushUnique(s,h)}if(c){var p=l?m.noAccessTokenErrorMsg:m.missingStyleErrorMsg;throw o.error(p),Error(p)}return a.length?(a.length>1&&o.warn(m.multipleTokensErrorMsg),a[0]):(s.length&&o.log(["Listed mapbox access token(s)",s.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(r,s);a.accessToken=l;for(var u=0;u<s.length;u++){var f=s[u],h=c(i,"mapbox",f),p=n[f],v=p._subplot;v||(v=new d(r,f),n[f]._subplot=v),v.viewInitial||(v.viewInitial={center:o.extendFlat({},p.center),zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),v.plot(h,n,r._promises)}},i.clean=function(r,n,i,a){for(var o=a._subplots.mapbox||[],s=0;s<o.length;s++){var l=o[s];!n[l]&&a[l]._subplot&&a[l]._subplot.destroy()}},i.toSVG=function(r){for(var n=r._fullLayout,i=n._subplots.mapbox,a=n._size,o=0;o<i.length;o++){var c=n[i[o]],d=c.domain,g=c._subplot.toImage("png");n._glimages.append("svg:image").attr({xmlns:u.svg,"xlink:href":g,x:a.l+a.w*d.x[0],y:a.t+a.h*(1-d.y[1]),width:a.w*(d.x[1]-d.x[0]),height:a.h*(d.y[1]-d.y[0]),preserveAspectRatio:"none"});var v=f.select(c._subplot.div);if(null!==v.select(".mapboxgl-ctrl-logo").node().offsetParent){var y=n._glimages.append("g");y.attr("transform",s(a.l+a.w*d.x[0]+10,a.t+a.h*(1-d.y[0])-31)),y.append("path").attr("d",m.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),y.append("path").attr("d",m.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),y.append("path").attr("d",m.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),y.append("polygon").attr("points",m.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var x=v.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),b=n._glimages.append("g"),_=b.append("text");_.text(x).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":x});var w=h.bBox(_.node()),T=a.w*(d.x[1]-d.x[0]);if(w.width>T/2){var k=x.split("|").join("<br>");_.text(k).attr("data-unformatted",k).call(p.convertToTspans,r),w=h.bBox(_.node())}_.attr("transform",s(-3,8-w.height)),b.insert("rect",".static-attribution").attr({x:-w.width-6,y:-w.height-3,width:w.width+6,height:w.height+3,fill:"rgba(255, 255, 255, 0.75)"});var A=1;w.width+6>T&&(A=T/(w.width+6));var M=[a.l+a.w*d.x[1],a.t+a.h*(1-d.y[0])];b.attr("transform",s(M[0],M[1])+l(A))}},i.updateFx=function(r){for(var n=r._fullLayout,i=n._subplots.mapbox,a=0;a<i.length;a++)n[i[a]]._subplot.updateFx(n)}},{"../../components/drawing":388,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/get_data":593,"./constants":611,"./layout_attributes":615,"./layout_defaults":616,"./mapbox":617,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],614:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../lib/svg_text_utils").sanitizeHTML,s=r("./convert_text_opts"),l=r("./constants");function c(r,n){this.subplot=r,this.uid=r.uid+"-"+n,this.index=n,this.idSource="source-"+this.uid,this.idLayer=l.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var u=c.prototype;function f(r){if(!r.visible)return!1;var n=r.source;if(Array.isArray(n)&&n.length>0){for(var i=0;i<n.length;i++)if("string"!=typeof n[i]||0===n[i].length)return!1;return!0}return a.isPlainObject(n)||"string"==typeof n&&n.length>0}function h(r){var n={},i={};switch(r.type){case"circle":a.extendFlat(i,{"circle-radius":r.circle.radius,"circle-color":r.color,"circle-opacity":r.opacity});break;case"line":a.extendFlat(i,{"line-width":r.line.width,"line-color":r.color,"line-opacity":r.opacity,"line-dasharray":r.line.dash});break;case"fill":a.extendFlat(i,{"fill-color":r.color,"fill-outline-color":r.fill.outlinecolor,"fill-opacity":r.opacity});break;case"symbol":var o=r.symbol,l=s(o.textposition,o.iconsize);a.extendFlat(n,{"icon-image":o.icon+"-15","icon-size":o.iconsize/10,"text-field":o.text,"text-size":o.textfont.size,"text-anchor":l.anchor,"text-offset":l.offset,"symbol-placement":o.placement}),a.extendFlat(i,{"icon-color":r.color,"text-color":o.textfont.color,"text-opacity":r.opacity});break;case"raster":a.extendFlat(i,{"raster-fade-duration":0,"raster-opacity":r.opacity})}return{layout:n,paint:i}}u.update=function(r){this.visible?this.needsNewImage(r)?this.updateImage(r):this.needsNewSource(r)?(this.removeLayer(),this.updateSource(r),this.updateLayer(r)):this.needsNewLayer(r)?this.updateLayer(r):this.updateStyle(r):(this.updateSource(r),this.updateLayer(r)),this.visible=f(r)},u.needsNewImage=function(r){return this.subplot.map.getSource(this.idSource)&&"image"===this.sourceType&&"image"===r.sourcetype&&(this.source!==r.source||JSON.stringify(this.coordinates)!==JSON.stringify(r.coordinates))},u.needsNewSource=function(r){return this.sourceType!==r.sourcetype||JSON.stringify(this.source)!==JSON.stringify(r.source)||this.layerType!==r.type},u.needsNewLayer=function(r){return this.layerType!==r.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},u.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},u.updateImage=function(r){this.subplot.map.getSource(this.idSource).updateImage({url:r.source,coordinates:r.coordinates});var n=this.findFollowingMapboxLayerId(this.lookupBelow());null!==n&&this.subplot.map.moveLayer(this.idLayer,n)},u.updateSource=function(r){var n=this.subplot.map;if(n.getSource(this.idSource)&&n.removeSource(this.idSource),this.sourceType=r.sourcetype,this.source=r.source,f(r)){var i,a,s,l,c=(a=r.sourcetype,s=r.source,l={type:a},"geojson"===a?i="data":"vector"===a?i="string"==typeof s?"url":"tiles":"raster"===a?(i="tiles",l.tileSize=256):"image"===a&&(i="url",l.coordinates=r.coordinates),l[i]=s,r.sourceattribution&&(l.attribution=o(r.sourceattribution)),l);n.addSource(this.idSource,c)}},u.findFollowingMapboxLayerId=function(r){if("traces"===r)for(var n=this.subplot.getMapLayers(),i=0;i<n.length;i++){var a=n[i].id;if("string"==typeof a&&0===a.indexOf(l.traceLayerPrefix)){r=a;break}}return r},u.updateLayer=function(r){var n=this.subplot,i=h(r),a=this.lookupBelow(),o=this.findFollowingMapboxLayerId(a);this.removeLayer(),f(r)&&n.addLayer({id:this.idLayer,source:this.idSource,"source-layer":r.sourcelayer||"",type:r.type,minzoom:r.minzoom,maxzoom:r.maxzoom,layout:i.layout,paint:i.paint},o),this.layerType=r.type,this.below=a},u.updateStyle=function(r){if(f(r)){var n=h(r);this.subplot.setOptions(this.idLayer,"setLayoutProperty",n.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",n.paint)}},u.removeLayer=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer)},u.dispose=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer),r.getSource(this.idSource)&&r.removeSource(this.idSource)},n.exports=function(r,n,i){var a=new c(r,n);return a.update(i),a}},{"../../lib":503,"../../lib/svg_text_utils":529,"./constants":611,"./convert_text_opts":612}],615:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/color").defaultLine,s=r("../domain").attributes,l=r("../font_attributes"),c=r("../../traces/scatter/attributes").textposition,u=r("../../plot_api/edit_types").overrideAll,f=r("../../plot_api/plot_template").templatedArray,h=r("./constants"),p=l({});p.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(n.exports=u({_arrayAttrRegexps:[a.counterRegex("mapbox",".layers",!0)],domain:s({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:h.styleValuesMapbox.concat(h.styleValuesNonMapbox),dflt:h.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:f("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:o},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:o}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:p,textposition:a.extendFlat({},c,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":366,"../../lib":503,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../traces/scatter/attributes":926,"../domain":584,"../font_attributes":585,"./constants":611}],616:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../subplot_defaults"),s=r("../array_container_defaults"),l=r("./layout_attributes");function c(r,n,i,a){i("accesstoken",a.accessToken),i("style"),i("center.lon"),i("center.lat"),i("zoom"),i("bearing"),i("pitch"),s(r,n,{name:"layers",handleItemDefaults:u}),n._input=r}function u(r,n){function i(i,o){return a.coerce(r,n,l.layers,i,o)}if(i("visible")){var o,s=i("sourcetype"),c="raster"===s||"image"===s;i("source"),i("sourceattribution"),"vector"===s&&i("sourcelayer"),"image"===s&&i("coordinates"),c&&(o="raster");var u=i("type",o);c&&"raster"!==u&&(u=n.type="raster",a.log("Source types *raster* and *image* must drawn *raster* layer type.")),i("below"),i("color"),i("opacity"),i("minzoom"),i("maxzoom"),"circle"===u&&i("circle.radius"),"line"===u&&(i("line.width"),i("line.dash")),"fill"===u&&i("fill.outlinecolor"),"symbol"===u&&(i("symbol.icon"),i("symbol.iconsize"),i("symbol.text"),a.coerceFont(i,"symbol.textfont"),i("symbol.textposition"),i("symbol.placement"))}}n.exports=function(r,n,i){o(r,n,i,{type:"mapbox",attributes:l,handleDefaults:c,partition:"y",accessToken:n._mapboxAccessToken})}},{"../../lib":503,"../array_container_defaults":549,"../subplot_defaults":632,"./layout_attributes":615}],617:[function(r,n,i){"use strict";var a=r("mapbox-gl/dist/mapbox-gl-unminified"),o=r("../../lib"),s=r("../../lib/geo_location_utils"),l=r("../../registry"),c=r("../cartesian/axes"),u=r("../../components/dragelement"),f=r("../../components/fx"),h=r("../../components/dragelement/helpers"),p=h.rectMode,d=h.drawMode,m=h.selectMode,g=r("../cartesian/select").prepSelect,v=r("../cartesian/select").clearSelect,y=r("../cartesian/select").clearSelectionsCache,x=r("../cartesian/select").selectOnClick,b=r("./constants"),_=r("./layers");function w(r,n){this.id=n,this.gd=r;var i=r._fullLayout,a=r._context;this.container=i._glcontainer.node(),this.isStatic=a.staticPlot,this.uid=i._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(i),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var T=w.prototype;T.plot=function(r,n,i){var a,o=this,s=n[o.id];o.map&&s.accesstoken!==o.accessToken&&(o.map.remove(),o.map=null,o.styleObj=null,o.traceHash={},o.layerList=[]),a=new Promise(o.map?function(i,a){o.updateMap(r,n,i,a)}:function(i,a){o.createMap(r,n,i,a)}),i.push(a)},T.createMap=function(r,n,i,o){var l=this,c=n[l.id],u=l.styleObj=A(c.style);l.accessToken=c.accesstoken;var f=l.map=new a.Map({container:l.div,style:u.style,center:S(c.center),zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,interactive:!l.isStatic,preserveDrawingBuffer:l.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new a.AttributionControl({compact:!0}));f._canvas.style.left="0px",f._canvas.style.top="0px",l.rejectOnError(o),l.isStatic||l.initFx(r,n);var h=[];h.push(new Promise(function(r){f.once("load",r)})),Promise.all(h=h.concat(s.fetchTraceGeoData(r))).then(function(){l.fillBelowLookup(r,n),l.updateData(r),l.updateLayout(n),l.resolveOnRender(i)}).catch(o)},T.updateMap=function(r,n,i,a){var o=this,l=o.map,c=n[this.id];o.rejectOnError(a);var u=[],f=A(c.style);JSON.stringify(o.styleObj)!==JSON.stringify(f)&&(o.styleObj=f,l.setStyle(f.style),o.traceHash={},u.push(new Promise(function(r){l.once("styledata",r)}))),Promise.all(u=u.concat(s.fetchTraceGeoData(r))).then(function(){o.fillBelowLookup(r,n),o.updateData(r),o.updateLayout(n),o.resolveOnRender(i)}).catch(a)},T.fillBelowLookup=function(r,n){var i,a,o=n[this.id].layers,s=this.belowLookup={},l=!1;for(i=0;i<r.length;i++){var c=r[i][0].trace,u=c._module;"string"==typeof c.below?a=c.below:u.getBelow&&(a=u.getBelow(c,this)),""===a&&(l=!0),s["trace-"+c.uid]=a||""}for(i=0;i<o.length;i++){var f=o[i];a="string"==typeof f.below?f.below:l?"traces":"",s["layout-"+i]=a}var h,p,d={};for(h in s)d[a=s[h]]?d[a].push(h):d[a]=[h];for(a in d){var m=d[a];if(m.length>1)for(i=0;i<m.length;i++)0===(h=m[i]).indexOf("trace-")?(p=h.split("trace-")[1],this.traceHash[p]&&(this.traceHash[p].below=null)):0===h.indexOf("layout-")&&(p=h.split("layout-")[1],this.layerList[p]&&(this.layerList[p].below=null))}};var k={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function A(r){var n={};return o.isPlainObject(r)?(n.id=r.id,n.style=r):"string"==typeof r?(n.id=r,-1!==b.styleValuesMapbox.indexOf(r)?n.style=M(r):b.stylesNonMapbox[r]?n.style=b.stylesNonMapbox[r]:n.style=r):(n.id=b.styleValueDflt,n.style=M(b.styleValueDflt)),n.transition={duration:0,delay:0},n}function M(r){return b.styleUrlPrefix+r+"-"+b.styleUrlSuffix}function S(r){return[r.lon,r.lat]}T.updateData=function(r){var n,i,a,o,s=this.traceHash,l=r.slice().sort(function(r,n){return k[r[0].trace.type]-k[n[0].trace.type]});for(a=0;a<l.length;a++){var c=l[a],u=!1;(n=s[(i=c[0].trace).uid])&&(n.type===i.type?(n.update(c),u=!0):n.dispose()),!u&&i._module&&(s[i.uid]=i._module.plot(this,c))}var f=Object.keys(s);t:for(a=0;a<f.length;a++){var h=f[a];for(o=0;o<r.length;o++)if(h===(i=r[o][0].trace).uid)continue t;(n=s[h]).dispose(),delete s[h]}},T.updateLayout=function(r){var n=this.map,i=r[this.id];this.dragging||this.wheeling||(n.setCenter(S(i.center)),n.setZoom(i.zoom),n.setBearing(i.bearing),n.setPitch(i.pitch)),this.updateLayers(r),this.updateFramework(r),this.updateFx(r),this.map.resize(),this.gd._context._scrollZoom.mapbox?n.scrollZoom.enable():n.scrollZoom.disable()},T.resolveOnRender=function(r){var n=this.map;n.on("render",function i(){n.loaded()&&(n.off("render",i),setTimeout(r,10))})},T.rejectOnError=function(r){var n=this.map;function i(){r(Error(b.mapOnErrorMsg))}n.once("error",i),n.once("style.error",i),n.once("source.error",i),n.once("tile.error",i),n.once("layer.error",i)},T.createFramework=function(r){var n=this,i=n.div=document.createElement("div");i.id=n.uid,i.style.position="absolute",n.container.appendChild(i),n.xaxis={_id:"x",c2p:function(r){return n.project(r).x}},n.yaxis={_id:"y",c2p:function(r){return n.project(r).y}},n.updateFramework(r),n.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},c.setConvert(n.mockAxis,r)},T.initFx=function(r,n){var i=this,a=i.gd,o=i.map;function s(){f.loneUnhover(n._hoverlayer)}function c(){var r=i.getView();a.emit("plotly_relayouting",i.getViewEditsWithDerived(r))}o.on("moveend",function(r){if(i.map){var n=a._fullLayout;if(r.originalEvent||i.wheeling){var o=n[i.id];l.call("_storeDirectGUIEdit",a.layout,n._preGUI,i.getViewEdits(o));var s=i.getView();o._input.center=o.center=s.center,o._input.zoom=o.zoom=s.zoom,o._input.bearing=o.bearing=s.bearing,o._input.pitch=o.pitch=s.pitch,a.emit("plotly_relayout",i.getViewEditsWithDerived(s))}r.originalEvent&&"mouseup"===r.originalEvent.type?i.dragging=!1:i.wheeling&&(i.wheeling=!1),n._rehover&&n._rehover()}}),o.on("wheel",function(){i.wheeling=!0}),o.on("mousemove",function(r){var n=i.div.getBoundingClientRect(),s=[r.originalEvent.offsetX,r.originalEvent.offsetY];r.target.getBoundingClientRect=function(){return n},i.xaxis.p2c=function(){return o.unproject(s).lng},i.yaxis.p2c=function(){return o.unproject(s).lat},a._fullLayout._rehover=function(){a._fullLayout._hoversubplot===i.id&&a._fullLayout[i.id]&&f.hover(a,r,i.id)},f.hover(a,r,i.id),a._fullLayout._hoversubplot=i.id}),o.on("dragstart",function(){i.dragging=!0,s()}),o.on("zoomstart",s),o.on("mouseout",function(){a._fullLayout._hoversubplot=null}),o.on("drag",c),o.on("zoom",c),o.on("dblclick",function(){var r=a._fullLayout[i.id];l.call("_storeDirectGUIEdit",a.layout,a._fullLayout._preGUI,i.getViewEdits(r));var n=i.viewInitial;o.setCenter(S(n.center)),o.setZoom(n.zoom),o.setBearing(n.bearing),o.setPitch(n.pitch);var s=i.getView();r._input.center=r.center=s.center,r._input.zoom=r.zoom=s.zoom,r._input.bearing=r.bearing=s.bearing,r._input.pitch=r.pitch=s.pitch,a.emit("plotly_doubleclick",null),a.emit("plotly_relayout",i.getViewEditsWithDerived(s))}),i.clearSelect=function(){y(i.dragOptions),v(i.dragOptions.gd)},i.onClickInPanFn=function(r){return function(n){var o=a._fullLayout.clickmode;o.indexOf("select")>-1&&x(n.originalEvent,a,[i.xaxis],[i.yaxis],i.id,r),o.indexOf("event")>-1&&f.click(a,n.originalEvent)}}},T.updateFx=function(r){var n=this,i=n.map,a=n.gd;if(!n.isStatic){var s,l=r.dragmode;s=p(l)?function(r,i){(r.range={})[n.id]=[f([i.xmin,i.ymin]),f([i.xmax,i.ymax])]}:function(r,i,a){(r.lassoPoints={})[n.id]=a.filtered.map(f)};var c=n.dragOptions;n.dragOptions=o.extendDeep(c||{},{dragmode:r.dragmode,element:n.div,gd:a,plotinfo:{id:n.id,domain:r[n.id].domain,xaxis:n.xaxis,yaxis:n.yaxis,fillRangeItems:s},xaxes:[n.xaxis],yaxes:[n.yaxis],subplot:n.id}),i.off("click",n.onClickInPanHandler),m(l)||d(l)?(i.dragPan.disable(),i.on("zoomstart",n.clearSelect),n.dragOptions.prepFn=function(r,i,a){g(r,i,a,n.dragOptions,l)},u.init(n.dragOptions)):(i.dragPan.enable(),i.off("zoomstart",n.clearSelect),n.div.onmousedown=null,n.onClickInPanHandler=n.onClickInPanFn(n.dragOptions),i.on("click",n.onClickInPanHandler))}function f(r){var i=n.map.unproject(r);return[i.lng,i.lat]}},T.updateFramework=function(r){var n=r[this.id].domain,i=r._size,a=this.div.style;a.width=i.w*(n.x[1]-n.x[0])+"px",a.height=i.h*(n.y[1]-n.y[0])+"px",a.left=i.l+n.x[0]*i.w+"px",a.top=i.t+(1-n.y[1])*i.h+"px",this.xaxis._offset=i.l+n.x[0]*i.w,this.xaxis._length=i.w*(n.x[1]-n.x[0]),this.yaxis._offset=i.t+(1-n.y[1])*i.h,this.yaxis._length=i.h*(n.y[1]-n.y[0])},T.updateLayers=function(r){var n,i=r[this.id].layers,a=this.layerList;if(i.length!==a.length){for(n=0;n<a.length;n++)a[n].dispose();for(a=this.layerList=[],n=0;n<i.length;n++)a.push(_(this,n,i[n]))}else for(n=0;n<i.length;n++)a[n].update(i[n])},T.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},T.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},T.setOptions=function(r,n,i){for(var a in i)this.map[n](r,a,i[a])},T.getMapLayers=function(){return this.map.getStyle().layers},T.addLayer=function(r,n){var i=this.map;if("string"==typeof n){if(""===n)return void i.addLayer(r,n);for(var a=this.getMapLayers(),s=0;s<a.length;s++)if(n===a[s].id)return void i.addLayer(r,n);o.warn(["Trying to add layer with *below* value",n,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}i.addLayer(r)},T.project=function(r){return this.map.project(new a.LngLat(r[0],r[1]))},T.getView=function(){var r=this.map,n=r.getCenter(),i={lon:n.lng,lat:n.lat},a=r.getCanvas(),o=parseInt(a.style.width),s=parseInt(a.style.height);return{center:i,zoom:r.getZoom(),bearing:r.getBearing(),pitch:r.getPitch(),_derived:{coordinates:[r.unproject([0,0]).toArray(),r.unproject([o,0]).toArray(),r.unproject([o,s]).toArray(),r.unproject([0,s]).toArray()]}}},T.getViewEdits=function(r){for(var n=this.id,i=["center","zoom","bearing","pitch"],a={},o=0;o<i.length;o++){var s=i[o];a[n+"."+s]=r[s]}return a},T.getViewEditsWithDerived=function(r){var n=this.id,i=this.getViewEdits(r);return i[n+"._derived"]=r._derived,i},n.exports=w},{"../../components/dragelement":385,"../../components/dragelement/helpers":384,"../../components/fx":406,"../../lib":503,"../../lib/geo_location_utils":496,"../../registry":638,"../cartesian/axes":554,"../cartesian/select":575,"./constants":611,"./layers":614,"mapbox-gl/dist/mapbox-gl-unminified":239}],618:[function(r,n,i){"use strict";n.exports=function(r){var n=r.editType;return{t:{valType:"number",dflt:0,editType:n},r:{valType:"number",dflt:0,editType:n},b:{valType:"number",dflt:0,editType:n},l:{valType:"number",dflt:0,editType:n},editType:n}}},{}],619:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("d3-time-format").timeFormatLocale,s=r("d3-format").formatLocale,l=r("fast-isnumeric"),c=r("../registry"),u=r("../plot_api/plot_schema"),f=r("../plot_api/plot_template"),h=r("../lib"),p=r("../components/color"),d=r("../constants/numerical").BADNUM,m=r("./cartesian/axis_ids"),g=r("./cartesian/handle_outline").clearSelect,v=r("./animation_attributes"),y=r("./frame_attributes"),x=r("../plots/get_data").getModuleCalcData,b=h.relinkPrivateKeys,_=h._,w=n.exports={};h.extendFlat(w,c),w.attributes=r("./attributes"),w.attributes.type.values=w.allTypes,w.fontAttrs=r("./font_attributes"),w.layoutAttributes=r("./layout_attributes"),w.fontWeight="normal";var T=w.transformsRegistry,k=r("./command");w.executeAPICommand=k.executeAPICommand,w.computeAPICommandBindings=k.computeAPICommandBindings,w.manageCommandObserver=k.manageCommandObserver,w.hasSimpleAPICommandBindings=k.hasSimpleAPICommandBindings,w.redrawText=function(r){return r=h.getGraphDiv(r),new Promise(function(n){setTimeout(function(){r._fullLayout&&(c.getComponentMethod("annotations","draw")(r),c.getComponentMethod("legend","draw")(r),c.getComponentMethod("colorbar","draw")(r),n(w.previousPromises(r)))},300)})},w.resize=function(r){r=h.getGraphDiv(r);var n,i=new Promise(function(i,a){r&&!h.isHidden(r)||a(Error("Resize must be passed a displayed plot div element.")),r._redrawTimer&&clearTimeout(r._redrawTimer),r._resolveResize&&(n=r._resolveResize),r._resolveResize=i,r._redrawTimer=setTimeout(function(){if(!r.layout||r.layout.width&&r.layout.height||h.isHidden(r))i(r);else{delete r.layout.width,delete r.layout.height;var n=r.changed;r.autoplay=!0,c.call("relayout",r,{autosize:!0}).then(function(){r.changed=n,r._resolveResize===i&&(delete r._resolveResize,i(r))})}},100)});return n&&n(i),i},w.previousPromises=function(r){if((r._promises||[]).length)return Promise.all(r._promises).then(function(){r._promises=[]})},w.addLinks=function(r){if(r._context.showLink||r._context.showSources){var n=r._fullLayout,i=h.ensureSingle(n._paper,"text","js-plot-link-container",function(r){r.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:p.defaultLine,"pointer-events":"all"}).each(function(){var r=a.select(this);r.append("tspan").classed("js-link-to-tool",!0),r.append("tspan").classed("js-link-spacer",!0),r.append("tspan").classed("js-sourcelinks",!0)})}),o=i.node(),s={y:n._paper.attr("height")-9};document.body.contains(o)&&o.getComputedTextLength()>=n.width-20?(s["text-anchor"]="start",s.x=5):(s["text-anchor"]="end",s.x=n._paper.attr("width")-7),i.attr(s);var l=i.select(".js-link-to-tool"),c=i.select(".js-link-spacer"),u=i.select(".js-sourcelinks");r._context.showSources&&r._context.showSources(r),r._context.showLink&&function(r,n){n.text("");var i=n.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(r._context.linkText+" "+String.fromCharCode(187));if(r._context.sendData)i.on("click",function(){w.sendDataToCloud(r)});else{var a=window.location.pathname.split("/"),o=window.location.search;i.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+a[2].split(".")[0]+"/"+a[1]+o})}}(r,l),c.text(l.text()&&u.text()?" - ":"")}},w.sendDataToCloud=function(r){var n=(window.PLOTLYENV||{}).BASE_URL||r._context.plotlyServerURL;if(n){r.emit("plotly_beforeexport");var i=a.select(r).append("div").attr("id","hiddenform").style("display","none"),o=i.append("form").attr({action:n+"/external",method:"post",target:"_blank"});return o.append("input").attr({type:"text",name:"data"}).node().value=w.graphJson(r,!1,"keepdata"),o.node().submit(),i.remove(),r.emit("plotly_afterexport"),!1}};var A=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],M=["year","month","dayMonth","dayMonthYear"];function S(r,n){var i=r._context.locale;i||(i="en-US");var a=!1,o={};function s(r){for(var i=!0,s=0;s<n.length;s++){var l=n[s];o[l]||(r[l]?o[l]=r[l]:i=!1)}i&&(a=!0)}for(var l=0;l<2;l++){for(var u=r._context.locales,f=0;f<2;f++){var h=(u[i]||{}).format;if(h&&(s(h),a))break;u=c.localeRegistry}var p=i.split("-")[0];if(a||p===i)break;i=p}return a||s(c.localeRegistry.en.format),o}function E(r){var n=r.transforms;if(Array.isArray(n)&&n.length)for(var i=0;i<n.length;i++){var a=n[i],o=a._module||T[a.type];if(o&&o.makesData)return!0}return!1}function L(r){return"string"==typeof r&&"px"===r.substr(r.length-2)&&parseFloat(r)}function C(r){var n=r.margin;if(!r._size){var i=r._size={l:Math.round(n.l),r:Math.round(n.r),t:Math.round(n.t),b:Math.round(n.b),p:Math.round(n.pad)};i.w=Math.round(r.width)-i.l-i.r,i.h=Math.round(r.height)-i.t-i.b}r._pushmargin||(r._pushmargin={}),r._pushmarginIds||(r._pushmarginIds={})}w.supplyDefaults=function(r,n){var i=n&&n.skipUpdateCalc,a=r._fullLayout||{};if(a._skipDefaults)delete a._skipDefaults;else{var l,u=r._fullLayout={},f=r.layout||{},p=r._fullData||[],d=r._fullData=[],m=r.data||[],v=r.calcdata||[],y=r._context||{};r._transitionData||w.createTransitionData(r),u._dfltTitle={plot:_(r,"Click to enter Plot title"),x:_(r,"Click to enter X axis title"),y:_(r,"Click to enter Y axis title"),colorbar:_(r,"Click to enter Colorscale title"),annotation:_(r,"new text")},u._traceWord=_(r,"trace");var x=S(r,A);if(u._mapboxAccessToken=y.mapboxAccessToken,a._initialAutoSizeIsDone){var T=a.width,k=a.height;w.supplyLayoutGlobalDefaults(f,u,x),f.width||(u.width=T),f.height||(u.height=k),w.sanitizeMargins(u)}else{w.supplyLayoutGlobalDefaults(f,u,x);var E=!f.width||!f.height,L=u.autosize,P=y.autosizable;E&&(L||P)?w.plotAutoSize(r,f,u):E&&w.sanitizeMargins(u),!L&&E&&(f.width=u.width,f.height=u.height)}u._d3locale=(G=u.separators,x.decimal=G.charAt(0),x.thousands=G.charAt(1),{numberFormat:function(r){try{r=s(x).format(h.adjustFormat(r))}catch(n){return h.warnBadFormat(r),h.noFormat}return r},timeFormat:o(x).utcFormat}),u._extraFormat=S(r,M),u._initialAutoSizeIsDone=!0,u._dataLength=m.length,u._modules=[],u._visibleModules=[],u._basePlotModules=[];var I=u._subplots=function(){var r,n,i=c.collectableSubplotTypes,a={};if(!i){i=[];var o=c.subplotsRegistry;for(var s in o){var l=o[s].attr;if(l&&(i.push(s),Array.isArray(l)))for(n=0;n<l.length;n++)h.pushUnique(i,l[n])}}for(r=0;r<i.length;r++)a[i[r]]=[];return a}(),O=u._splomAxes={x:{},y:{}},z=u._splomSubplots={};u._splomGridDflt={},u._scatterStackOpts={},u._firstScatter={},u._alignmentOpts={},u._colorAxes={},u._requestRangeslider={},u._traceUids=function(r,n){var i,a,o=n.length,s=[];for(i=0;i<r.length;i++){var l=r[i]._fullInput;l!==a&&s.push(l),a=l}var c=s.length,u=Array(o),f={};function p(r,n){if(r&&"string"==typeof r&&!f[r])return u[n]=r,f[r]=1,!0}for(i=0;i<o;i++){var d,m=n[i].uid;"number"==typeof m&&(m=String(m)),p(m,i)||i<c&&p(s[i].uid,i)||(d=h.randstr(f),u[i]=d,f[d]=1)}return u}(p,m),u._globalTransforms=(r._context||{}).globalTransforms,w.supplyDataDefaults(m,d,f,u);var D=Object.keys(O.x),R=Object.keys(O.y);if(D.length>1&&R.length>1){for(c.getComponentMethod("grid","sizeDefaults")(f,u),l=0;l<D.length;l++)h.pushUnique(I.xaxis,D[l]);for(l=0;l<R.length;l++)h.pushUnique(I.yaxis,R[l]);for(var F in z)h.pushUnique(I.cartesian,F)}if(u._has=w._hasPlotType.bind(u),p.length===d.length)for(l=0;l<d.length;l++)b(d[l],p[l]);w.supplyLayoutModuleDefaults(f,u,d,r._transitionData);var B=u._visibleModules,N=[];for(l=0;l<B.length;l++){var j=B[l].crossTraceDefaults;j&&h.pushUnique(N,j)}for(l=0;l<N.length;l++)N[l](d,u);u._hasOnlyLargeSploms=1===u._basePlotModules.length&&"splom"===u._basePlotModules[0].name&&D.length>15&&R.length>15&&0===u.shapes.length&&0===u.images.length,w.linkSubplots(d,u,p,a),w.cleanPlot(d,u,p,a);var U=!(!a._has||!a._has("gl2d")),V=!(!u._has||!u._has("gl2d")),H=!(!a._has||!a._has("cartesian"))||U,q=!(!u._has||!u._has("cartesian"))||V;H&&!q?a._bgLayer.remove():q&&!H&&(u._shouldCreateBgLayer=!0),a._zoomlayer&&!r._dragging&&g({_fullLayout:a}),function(r,n){var i,a=[];n.meta&&(i=n._meta={meta:n.meta,layout:{meta:n.meta}});for(var o=0;o<r.length;o++){var s=r[o];s.meta?a[s.index]=s._meta={meta:s.meta}:n.meta&&(s._meta={meta:n.meta}),n.meta&&(s._meta.layout={meta:n.meta})}a.length&&(i||(i=n._meta={}),i.data=a)}(d,u),b(u,a),c.getComponentMethod("colorscale","crossTraceDefaults")(d,u),u._preGUI||(u._preGUI={}),u._tracePreGUI||(u._tracePreGUI={});var G,Y,W=u._tracePreGUI,X={};for(Y in W)X[Y]="old";for(l=0;l<d.length;l++)X[Y=d[l]._fullInput.uid]||(W[Y]={}),X[Y]="new";for(Y in X)"old"===X[Y]&&delete W[Y];C(u),c.getComponentMethod("rangeslider","makeData")(u),i||v.length!==d.length||w.supplyDefaultsUpdateCalc(v,d)}},w.supplyDefaultsUpdateCalc=function(r,n){for(var i=0;i<n.length;i++){var a=n[i],o=(r[i]||[])[0];if(o&&o.trace){var s=o.trace;if(s._hasCalcTransform){var l,c,u,f=s._arrayAttrs;for(l=0;l<f.length;l++)c=f[l],u=h.nestedProperty(s,c).get().slice(),h.nestedProperty(a,c).set(u)}o.trace=a}}},w.createTransitionData=function(r){r._transitionData||(r._transitionData={}),r._transitionData._frames||(r._transitionData._frames=[]),r._transitionData._frameHash||(r._transitionData._frameHash={}),r._transitionData._counter||(r._transitionData._counter=0),r._transitionData._interruptCallbacks||(r._transitionData._interruptCallbacks=[])},w._hasPlotType=function(r){var n,i=this._basePlotModules||[];for(n=0;n<i.length;n++)if(i[n].name===r)return!0;var a=this._modules||[];for(n=0;n<a.length;n++){var o=a[n].name;if(o===r)return!0;var s=c.modules[o];if(s&&s.categories[r])return!0}return!1},w.cleanPlot=function(r,n,i,a){var o,s,l=a._basePlotModules||[];for(o=0;o<l.length;o++){var c=l[o];c.clean&&c.clean(r,n,i,a)}var u=a._has&&a._has("gl"),f=n._has&&n._has("gl");u&&!f&&void 0!==a._glcontainer&&(a._glcontainer.selectAll(".gl-canvas").remove(),a._glcontainer.selectAll(".no-webgl").remove(),a._glcanvas=null);var h=!!a._infolayer;t:for(o=0;o<i.length;o++){var p=i[o].uid;for(s=0;s<r.length;s++)if(p===r[s].uid)continue t;h&&a._infolayer.select(".cb"+p).remove()}},w.linkSubplots=function(r,n,i,a){var o,s,l=a._plots||{},u=n._plots={},f=n._subplots,p={_fullData:r,_fullLayout:n},d=f.cartesian.concat(f.gl2d||[]);for(o=0;o<d.length;o++){var g,v=d[o],y=l[v],x=m.getFromId(p,v,"x"),b=m.getFromId(p,v,"y");for(y?g=u[v]=y:(g=u[v]={}).id=v,x._counterAxes.push(b._id),b._counterAxes.push(x._id),x._subplotsWith.push(v),b._subplotsWith.push(v),g.xaxis=x,g.yaxis=b,g._hasClipOnAxisFalse=!1,s=0;s<r.length;s++){var _=r[s];if(_.xaxis===g.xaxis._id&&_.yaxis===g.yaxis._id&&!1===_.cliponaxis){g._hasClipOnAxisFalse=!0;break}}}var w,T=m.list(p,null,!0);for(o=0;o<T.length;o++){var k=null;(w=T[o]).overlaying&&(k=m.getFromId(p,w.overlaying))&&k.overlaying&&(w.overlaying=!1,k=null),w._mainAxis=k||w,k&&(w.domain=k.domain.slice()),w._anchorAxis="free"===w.anchor?null:m.getFromId(p,w.anchor)}for(o=0;o<T.length;o++)if((w=T[o])._counterAxes.sort(m.idSort),w._subplotsWith.sort(h.subplotSort),w._mainSubplot=function(r,n){var i={_fullLayout:n},a="x"===r._id.charAt(0),o=r._mainAxis._anchorAxis,s="",l="",c="";if(o&&(c=o._mainAxis._id,s=a?r._id+c:c+r._id),!s||!n._plots[s]){s="";for(var u=r._counterAxes,f=0;f<u.length;f++){var h=u[f],p=a?r._id+h:h+r._id;l||(l=p);var d=m.getFromId(i,h);if(c&&d.overlaying===c){s=p;break}}}return s||l}(w,n),w._counterAxes.length&&(w.spikemode&&-1!==w.spikemode.indexOf("across")||w.automargin&&w.mirror&&"free"!==w.anchor||c.getComponentMethod("rangeslider","isVisible")(w))){var A=1,M=0;for(s=0;s<w._counterAxes.length;s++){var S=m.getFromId(p,w._counterAxes[s]);A=Math.min(A,S.domain[0]),M=Math.max(M,S.domain[1])}A<M&&(w._counterDomainMin=A,w._counterDomainMax=M)}},w.clearExpandedTraceDefaultColors=function(r){var n,i,a;for(i=[],(n=r._module._colorAttrs)||(r._module._colorAttrs=n=[],u.crawl(r._module.attributes,function(r,a,o,s){i[s]=a,i.length=s+1,"color"===r.valType&&void 0===r.dflt&&n.push(i.join("."))})),a=0;a<n.length;a++)h.nestedProperty(r,"_input."+n[a]).get()||h.nestedProperty(r,n[a]).set(null)},w.supplyDataDefaults=function(r,n,i,a){var o,s,l,u=a._modules,p=a._visibleModules,d=a._basePlotModules,m=0,g=0;function v(r){n.push(r);var i=r._module;i&&(h.pushUnique(u,i),!0===r.visible&&h.pushUnique(p,i),h.pushUnique(d,r._module.basePlotModule),m++,!1!==r._input.visible&&g++)}a._transformModules=[];var y={},x=[],_=(i.template||{}).data||{},k=f.traceTemplater(_);for(o=0;o<r.length;o++){if(l=r[o],(s=k.newTrace(l)).uid=a._traceUids[o],w.supplyTraceDefaults(l,s,g,a,o),s.index=o,s._input=l,s._expandedIndex=m,s.transforms&&s.transforms.length)for(var A=!1!==l.visible&&!1===s.visible,M=function(r,n,i,a){for(var o=r.transforms,s=[r],l=0;l<o.length;l++){var c=o[l],u=T[c.type];u&&u.transform&&(s=u.transform(s,{transform:c,fullTrace:r,fullData:n,layout:i,fullLayout:a,transformIndex:l}))}return s}(s,n,i,a),S=0;S<M.length;S++){var E=M[S],L={_template:s._template,type:s.type,uid:s.uid+S};A&&!1===E.visible&&delete E.visible,w.supplyTraceDefaults(E,L,m,a,o),b(L,E),L.index=o,L._input=l,L._fullInput=s,L._expandedIndex=m,L._expandedInput=E,v(L)}else s._fullInput=s,s._expandedInput=s,v(s);c.traceIs(s,"carpetAxis")&&(y[s.carpet]=s),c.traceIs(s,"carpetDependent")&&x.push(o)}for(o=0;o<x.length;o++)if((s=n[x[o]]).visible){var C=y[s.carpet];s._carpet=C,C&&C.visible?(s.xaxis=C.xaxis,s.yaxis=C.yaxis):s.visible=!1}},w.supplyAnimationDefaults=function(r){r=r||{};var n,i={};function a(n,a){return h.coerce(r||{},i,v,n,a)}if(a("mode"),a("direction"),a("fromcurrent"),Array.isArray(r.frame))for(i.frame=[],n=0;n<r.frame.length;n++)i.frame[n]=w.supplyAnimationFrameDefaults(r.frame[n]||{});else i.frame=w.supplyAnimationFrameDefaults(r.frame||{});if(Array.isArray(r.transition))for(i.transition=[],n=0;n<r.transition.length;n++)i.transition[n]=w.supplyAnimationTransitionDefaults(r.transition[n]||{});else i.transition=w.supplyAnimationTransitionDefaults(r.transition||{});return i},w.supplyAnimationFrameDefaults=function(r){var n={};function i(i,a){return h.coerce(r||{},n,v.frame,i,a)}return i("duration"),i("redraw"),n},w.supplyAnimationTransitionDefaults=function(r){var n={};function i(i,a){return h.coerce(r||{},n,v.transition,i,a)}return i("duration"),i("easing"),n},w.supplyFrameDefaults=function(r){var n={};function i(i,a){return h.coerce(r,n,y,i,a)}return i("group"),i("name"),i("traces"),i("baseframe"),i("data"),i("layout"),n},w.supplyTraceDefaults=function(r,n,i,a,o){var s,l=a.colorway||p.defaults,u=l[i%l.length];function f(i,a){return h.coerce(r,n,w.attributes,i,a)}var d=f("visible");f("type"),f("name",a._traceWord+" "+o),f("uirevision",a.uirevision);var m=w.getModule(n);if(n._module=m,m){var g=m.basePlotModule,v=g.attr,y=g.attributes;if(v&&y){var x=a._subplots,b="";if(d||"gl2d"!==g.name){if(Array.isArray(v))for(s=0;s<v.length;s++){var _=v[s],T=h.coerce(r,n,y,_);x[_]&&h.pushUnique(x[_],T),b+=T}else b=h.coerce(r,n,y,v);x[g.name]&&h.pushUnique(x[g.name],b)}}}return d&&(f("customdata"),f("ids"),f("meta"),c.traceIs(n,"showLegend")?(h.coerce(r,n,m.attributes.showlegend?m.attributes:w.attributes,"showlegend"),f("legendgroup"),f("legendgrouptitle.text"),f("legendrank"),n._dfltShowLegend=!0):n._dfltShowLegend=!1,m&&m.supplyDefaults(r,n,u,a),c.traceIs(n,"noOpacity")||f("opacity"),c.traceIs(n,"notLegendIsolatable")&&(n.visible=!!n.visible),c.traceIs(n,"noHover")||(n.hovertemplate||h.coerceHoverinfo(r,n,a),"parcats"!==n.type&&c.getComponentMethod("fx","supplyDefaults")(r,n,u,a)),m&&m.selectPoints&&f("selectedpoints"),w.supplyTransformDefaults(r,n,a)),n},w.hasMakesDataTransform=E,w.supplyTransformDefaults=function(r,n,i){if(n._length||E(r)){var a=i._globalTransforms||[],o=i._transformModules||[];if(Array.isArray(r.transforms)||0!==a.length)for(var s=r.transforms||[],l=a.concat(s),c=n.transforms=[],u=0;u<l.length;u++){var f,p=l[u],d=p.type,m=T[d],g=!(p._module&&p._module===m),v=m&&"function"==typeof m.transform;m||h.warn("Unrecognized transform type "+d+"."),m&&m.supplyDefaults&&(g||v)?((f=m.supplyDefaults(p,n,i,r)).type=d,f._module=m,h.pushUnique(o,m)):f=h.extendFlat({},p),c.push(f)}}},w.supplyLayoutGlobalDefaults=function(r,n,i){function a(i,a){return h.coerce(r,n,w.layoutAttributes,i,a)}var o=r.template;h.isPlainObject(o)&&(n.template=o,n._template=o.layout,n._dataTemplate=o.data),a("autotypenumbers");var s=h.coerceFont(a,"font"),l=s.size;h.coerceFont(a,"title.font",h.extendFlat({},s,{size:Math.round(1.4*l)})),a("title.text",n._dfltTitle.plot),a("title.xref"),a("title.yref"),a("title.x"),a("title.y"),a("title.xanchor"),a("title.yanchor"),a("title.pad.t"),a("title.pad.r"),a("title.pad.b"),a("title.pad.l"),a("uniformtext.mode")&&a("uniformtext.minsize"),a("autosize",!(r.width&&r.height)),a("width"),a("height"),a("margin.l"),a("margin.r"),a("margin.t"),a("margin.b"),a("margin.pad"),a("margin.autoexpand"),r.width&&r.height&&w.sanitizeMargins(n),c.getComponentMethod("grid","sizeDefaults")(r,n),a("paper_bgcolor"),a("separators",i.decimal+i.thousands),a("hidesources"),a("colorway"),a("datarevision");var u=a("uirevision");a("editrevision",u),a("selectionrevision",u),c.getComponentMethod("modebar","supplyLayoutDefaults")(r,n),c.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(r,n,a),a("meta"),h.isPlainObject(r.transition)&&(a("transition.duration"),a("transition.easing"),a("transition.ordering")),c.getComponentMethod("calendars","handleDefaults")(r,n,"calendar"),c.getComponentMethod("fx","supplyLayoutGlobalDefaults")(r,n,a)},w.plotAutoSize=function(r,n,i){var a,o,s=r._context||{},c=s.frameMargins,u=h.isPlotDiv(r);if(u&&r.emit("plotly_autosize"),s.fillFrame)a=window.innerWidth,o=window.innerHeight,document.body.style.overflow="hidden";else{var f=u?window.getComputedStyle(r):{};if(a=L(f.width)||L(f.maxWidth)||i.width,o=L(f.height)||L(f.maxHeight)||i.height,l(c)&&c>0){var p=1-2*c;a=Math.round(p*a),o=Math.round(p*o)}}var d=w.layoutAttributes.width.min,m=w.layoutAttributes.height.min;a<d&&(a=d),o<m&&(o=m);var g=!n.width&&Math.abs(i.width-a)>1,v=!n.height&&Math.abs(i.height-o)>1;(v||g)&&(g&&(i.width=a),v&&(i.height=o)),r._initialAutoSize||(r._initialAutoSize={width:a,height:o}),w.sanitizeMargins(i)},w.supplyLayoutModuleDefaults=function(r,n,i,a){var o,s,l,u=c.componentsRegistry,f=n._basePlotModules,p=c.subplotsRegistry.cartesian;for(o in u)(l=u[o]).includeBasePlot&&l.includeBasePlot(r,n);for(var d in f.length||f.push(p),n._has("cartesian")&&(c.getComponentMethod("grid","contentDefaults")(r,n),p.finalizeSubplots(r,n)),n._subplots)n._subplots[d].sort(h.subplotSort);for(s=0;s<f.length;s++)(l=f[s]).supplyLayoutDefaults&&l.supplyLayoutDefaults(r,n,i);var m=n._modules;for(s=0;s<m.length;s++)(l=m[s]).supplyLayoutDefaults&&l.supplyLayoutDefaults(r,n,i);var g=n._transformModules;for(s=0;s<g.length;s++)(l=g[s]).supplyLayoutDefaults&&l.supplyLayoutDefaults(r,n,i,a);for(o in u)(l=u[o]).supplyLayoutDefaults&&l.supplyLayoutDefaults(r,n,i)},w.purge=function(r){var n=r._fullLayout||{};void 0!==n._glcontainer&&(n._glcontainer.selectAll(".gl-canvas").remove(),n._glcontainer.remove(),n._glcanvas=null),n._modeBar&&n._modeBar.destroy(),r._transitionData&&(r._transitionData._interruptCallbacks&&(r._transitionData._interruptCallbacks.length=0),r._transitionData._animationRaf&&window.cancelAnimationFrame(r._transitionData._animationRaf)),h.clearThrottle(),h.clearResponsive(r),delete r.data,delete r.layout,delete r._fullData,delete r._fullLayout,delete r.calcdata,delete r.empty,delete r.fid,delete r.undoqueue,delete r.undonum,delete r.autoplay,delete r.changed,delete r._promises,delete r._redrawTimer,delete r._hmlumcount,delete r._hmpixcount,delete r._transitionData,delete r._transitioning,delete r._initialAutoSize,delete r._transitioningWithDuration,delete r._dragging,delete r._dragged,delete r._dragdata,delete r._hoverdata,delete r._snapshotInProgress,delete r._editing,delete r._mouseDownTime,delete r._legendMouseDownTime,r.removeAllListeners&&r.removeAllListeners()},w.style=function(r){var n,i=r._fullLayout._visibleModules,a=[];for(n=0;n<i.length;n++){var o=i[n];o.style&&h.pushUnique(a,o.style)}for(n=0;n<a.length;n++)a[n](r)},w.sanitizeMargins=function(r){if(r&&r.margin){var n,i=r.width,a=r.height,o=r.margin,s=i-(o.l+o.r),l=a-(o.t+o.b);s<0&&(n=(i-1)/(o.l+o.r),o.l=Math.floor(n*o.l),o.r=Math.floor(n*o.r)),l<0&&(n=(a-1)/(o.t+o.b),o.t=Math.floor(n*o.t),o.b=Math.floor(n*o.b))}},w.clearAutoMarginIds=function(r){r._fullLayout._pushmarginIds={}},w.allowAutoMargin=function(r,n){r._fullLayout._pushmarginIds[n]=1},w.autoMargin=function(r,n,i){var a=r._fullLayout,o=a.width,s=a.height,l=a.margin,c=h.constrain(o-l.l-l.r,2,64),u=h.constrain(s-l.t-l.b,2,64),f=Math.max(0,o-c),p=Math.max(0,s-u),d=a._pushmargin,m=a._pushmarginIds;if(!1!==l.autoexpand){if(i){var g=i.pad;if(void 0===g&&(g=Math.min(12,l.l,l.r,l.t,l.b)),f){var v=(i.l+i.r)/f;v>1&&(i.l/=v,i.r/=v)}if(p){var y=(i.t+i.b)/p;y>1&&(i.t/=y,i.b/=y)}var x=void 0!==i.xl?i.xl:i.x,b=void 0!==i.xr?i.xr:i.x,_=void 0!==i.yt?i.yt:i.y,T=void 0!==i.yb?i.yb:i.y;d[n]={l:{val:x,size:i.l+g},r:{val:b,size:i.r+g},b:{val:T,size:i.b+g},t:{val:_,size:i.t+g}},m[n]=1}else delete d[n],delete m[n];if(!a._replotting)return w.doAutoMargin(r)}},w.doAutoMargin=function(r){var n,i=r._fullLayout,a=i.width,o=i.height;i._size||(i._size={}),C(i);var s=i._size,u=i.margin,f=h.extendFlat({},s),p=u.l,d=u.r,g=u.t,v=u.b,y=i._pushmargin,x=i._pushmarginIds;if(!1!==i.margin.autoexpand){for(var b in y)x[b]||delete y[b];for(var _ in y.base={l:{val:0,size:p},r:{val:1,size:d},t:{val:1,size:g},b:{val:0,size:v}},y){var T=y[_].l||{},k=y[_].b||{},A=T.val,M=T.size,S=k.val,E=k.size;for(var L in y){if(l(M)&&y[L].r){var P=y[L].r.val,I=y[L].r.size;if(P>A){var O=(M*P+(I-a)*A)/(P-A),z=(I*(1-A)+(M-a)*(1-P))/(P-A);O+z>p+d&&(p=O,d=z)}}if(l(E)&&y[L].t){var D=y[L].t.val,R=y[L].t.size;if(D>S){var F=(E*D+(R-o)*S)/(D-S),B=(R*(1-S)+(E-o)*(1-D))/(D-S);F+B>v+g&&(v=F,g=B)}}}}}var N=h.constrain(a-u.l-u.r,2,64),j=h.constrain(o-u.t-u.b,2,64),U=Math.max(0,a-N),V=Math.max(0,o-j);if(U){var H=(p+d)/U;H>1&&(p/=H,d/=H)}if(V){var q=(v+g)/V;q>1&&(v/=q,g/=q)}if(s.l=Math.round(p),s.r=Math.round(d),s.t=Math.round(g),s.b=Math.round(v),s.p=Math.round(u.pad),s.w=Math.round(a)-s.l-s.r,s.h=Math.round(o)-s.t-s.b,!i._replotting&&w.didMarginChange(f,s)){"_redrawFromAutoMarginCount"in i?i._redrawFromAutoMarginCount++:i._redrawFromAutoMarginCount=1;var G=3*(1+Object.keys(x).length);if(i._redrawFromAutoMarginCount<G)return c.call("_doPlot",r);i._size=f,h.warn("Too many auto-margin redraws.")}n=m.list(r,"",!0),["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(r){for(var i=0;i<n.length;i++){var a=n[i][r];a&&a()}})};var P=["l","r","t","b","p","w","h"];function I(r,n,i){var a=!1,o=[w.previousPromises,function(){if(r._transitionData)return r._transitioning=!1,function(r){var n=Promise.resolve();if(!r)return n;for(;r.length;)n=n.then(r.shift());return n}(r._transitionData._interruptCallbacks)},i.prepareFn,w.rehover,function(){return r.emit("plotly_transitioning",[]),new Promise(function(o){r._transitioning=!0,n.duration>0&&(r._transitioningWithDuration=!0),r._transitionData._interruptCallbacks.push(function(){a=!0}),i.redraw&&r._transitionData._interruptCallbacks.push(function(){return c.call("redraw",r)}),r._transitionData._interruptCallbacks.push(function(){r.emit("plotly_transitioninterrupted",[])});var s=0,l=0;function u(){return s++,function(){l++,a||l!==s||!r._transitionData||(function(r){if(r)for(;r.length;)r.shift()}(r._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(i.redraw)return c.call("redraw",r)}).then(function(){r._transitioning=!1,r._transitioningWithDuration=!1,r.emit("plotly_transitioned",[])}).then(o))}}i.runFn(u),setTimeout(u())})}],s=h.syncOrAsync(o,r);return s&&s.then||(s=Promise.resolve()),s.then(function(){return r})}w.didMarginChange=function(r,n){for(var i=0;i<P.length;i++){var a=P[i],o=r[a],s=n[a];if(!l(o)||Math.abs(s-o)>1)return!0}return!1},w.graphJson=function(r,n,i,a,o,s){(o&&n&&!r._fullData||o&&!n&&!r._fullLayout)&&w.supplyDefaults(r);var l=o?r._fullData:r.data,c=o?r._fullLayout:r.layout,u=(r._transitionData||{})._frames;function f(r,n){if("function"==typeof r)return n?"_function_":null;if(h.isPlainObject(r)){var a,o={};return Object.keys(r).sort().forEach(function(s){if(-1===["_","["].indexOf(s.charAt(0))){if("function"!=typeof r[s]){if("keepdata"===i){if("src"===s.substr(s.length-3))return}else if("keepstream"===i){if("string"==typeof(a=r[s+"src"])&&a.indexOf(":")>0&&!h.isPlainObject(r.stream))return}else if("keepall"!==i&&"string"==typeof(a=r[s+"src"])&&a.indexOf(":")>0)return;o[s]=f(r[s],n)}else n&&(o[s]="_function")}}),o}return Array.isArray(r)?r.map(function(r){return f(r,n)}):h.isTypedArray(r)?h.simpleMap(r,h.identity):h.isJSDate(r)?h.ms2DateTimeLocal(+r):r}var p={data:(l||[]).map(function(r){var i=f(r);return n&&delete i.fit,i})};if(!n&&(p.layout=f(c),o)){var d=c._size;p.layout.computed={margin:{b:d.b,l:d.l,r:d.r,t:d.t}}}return u&&(p.frames=f(u)),s&&(p.config=f(r._context,!0)),"object"===a?p:JSON.stringify(p)},w.modifyFrames=function(r,n){var i,a,o,s=r._transitionData._frames,l=r._transitionData._frameHash;for(i=0;i<n.length;i++)switch((a=n[i]).type){case"replace":o=a.value;var c=(s[a.index]||{}).name,u=o.name;s[a.index]=l[u]=o,u!==c&&(delete l[c],l[u]=o);break;case"insert":l[(o=a.value).name]=o,s.splice(a.index,0,o);break;case"delete":delete l[(o=s[a.index]).name],s.splice(a.index,1)}return Promise.resolve()},w.computeFrame=function(r,n){var i,a,o,s,l=r._transitionData._frameHash;if(!n)throw Error("computeFrame must be given a string frame name");var c=l[n.toString()];if(!c)return!1;for(var u=[c],f=[c.name];c.baseframe&&(c=l[c.baseframe.toString()])&&-1===f.indexOf(c.name);)u.push(c),f.push(c.name);for(var h={};c=u.pop();)if(c.layout&&(h.layout=w.extendLayout(h.layout,c.layout)),c.data){if(h.data||(h.data=[]),!(a=c.traces))for(a=[],i=0;i<c.data.length;i++)a[i]=i;for(h.traces||(h.traces=[]),i=0;i<c.data.length;i++)null!=(o=a[i])&&(-1===(s=h.traces.indexOf(o))&&(s=h.data.length,h.traces[s]=o),h.data[s]=w.extendTrace(h.data[s],c.data[i]))}return h},w.recomputeFrameHash=function(r){for(var n=r._transitionData._frameHash={},i=r._transitionData._frames,a=0;a<i.length;a++){var o=i[a];o&&o.name&&(n[o.name]=o)}},w.extendObjectWithContainers=function(r,n,i){var a,o,s,l,c,u,f,p=h.extendDeepNoArrays({},n||{}),d=h.expandObjectPaths(p),m={};if(i&&i.length)for(s=0;s<i.length;s++)void 0===(o=(a=h.nestedProperty(d,i[s])).get())?h.nestedProperty(m,i[s]).set(null):(a.set(null),h.nestedProperty(m,i[s]).set(o));if(r=h.extendDeepNoArrays(r||{},d),i&&i.length){for(s=0;s<i.length;s++)if(u=h.nestedProperty(m,i[s]).get()){for(Array.isArray(f=(c=h.nestedProperty(r,i[s])).get())||(f=[],c.set(f)),l=0;l<u.length;l++){var g=u[l];f[l]=null===g?null:w.extendObjectWithContainers(f[l],g)}c.set(f)}}return r},w.dataArrayContainers=["transforms","dimensions"],w.layoutArrayContainers=c.layoutArrayContainers,w.extendTrace=function(r,n){return w.extendObjectWithContainers(r,n,w.dataArrayContainers)},w.extendLayout=function(r,n){return w.extendObjectWithContainers(r,n,w.layoutArrayContainers)},w.transition=function(r,n,i,a,o,s){var l={redraw:o.redraw},c={},u=[];return l.prepareFn=function(){for(var o=Array.isArray(n)?n.length:0,s=a.slice(0,o),l=0;l<s.length;l++){var f=s[l],p=r._fullData[f]._module;if(p){if(p.animatable){var d=p.basePlotModule.name;c[d]||(c[d]=[]),c[d].push(f)}r.data[s[l]]=w.extendTrace(r.data[s[l]],n[l])}}var m=h.expandObjectPaths(h.extendDeepNoArrays({},i)),g=/^[xy]axis[0-9]*$/;for(var v in m)g.test(v)&&delete m[v].range;w.extendLayout(r.layout,m),delete r.calcdata,w.supplyDefaults(r),w.doCalcdata(r);var y=h.expandObjectPaths(i);if(y){var x=r._fullLayout._plots;for(var b in x){var _=x[b],T=_.xaxis,k=_.yaxis,A=T.range.slice(),M=k.range.slice(),S=null,E=null,L=null,C=null;Array.isArray(y[T._name+".range"])?S=y[T._name+".range"].slice():Array.isArray((y[T._name]||{}).range)&&(S=y[T._name].range.slice()),Array.isArray(y[k._name+".range"])?E=y[k._name+".range"].slice():Array.isArray((y[k._name]||{}).range)&&(E=y[k._name].range.slice()),A&&S&&(T.r2l(A[0])!==T.r2l(S[0])||T.r2l(A[1])!==T.r2l(S[1]))&&(L={xr0:A,xr1:S}),M&&E&&(k.r2l(M[0])!==k.r2l(E[0])||k.r2l(M[1])!==k.r2l(E[1]))&&(C={yr0:M,yr1:E}),(L||C)&&u.push(h.extendFlat({plotinfo:_},L,C))}}return Promise.resolve()},l.runFn=function(n){var a,o,l=r._fullLayout._basePlotModules,f=u.length;if(i)for(o=0;o<l.length;o++)l[o].transitionAxes&&l[o].transitionAxes(r,u,s,n);for(var p in f?((a=h.extendFlat({},s)).duration=0,delete c.cartesian):a=s,c){var d=c[p];r._fullData[d[0]]._module.basePlotModule.plot(r,d,a,n)}},I(r,s,l)},w.transitionFromReact=function(r,n,i,a){var o=r._fullLayout,s=o.transition,l={},c=[];return l.prepareFn=function(){var r=o._plots;for(var s in l.redraw=!1,"some"===n.anim&&(l.redraw=!0),"some"===i.anim&&(l.redraw=!0),r){var u=r[s],f=u.xaxis,p=u.yaxis,d=a[f._name].range.slice(),m=a[p._name].range.slice(),g=f.range.slice(),v=p.range.slice();f.setScale(),p.setScale();var y=null,x=null;f.r2l(d[0])===f.r2l(g[0])&&f.r2l(d[1])===f.r2l(g[1])||(y={xr0:d,xr1:g}),p.r2l(m[0])===p.r2l(v[0])&&p.r2l(m[1])===p.r2l(v[1])||(x={yr0:m,yr1:v}),(y||x)&&c.push(h.extendFlat({plotinfo:u},y,x))}return Promise.resolve()},l.runFn=function(i){for(var a,o,l,u=r._fullData,f=r._fullLayout._basePlotModules,p=[],d=0;d<u.length;d++)p.push(d);function m(){if(r._fullLayout)for(var n=0;n<f.length;n++)f[n].transitionAxes&&f[n].transitionAxes(r,c,a,i)}function g(){if(r._fullLayout)for(var n=0;n<f.length;n++)f[n].plot(r,l,o,i)}c.length&&n.anim?"traces first"===s.ordering?(a=h.extendFlat({},s,{duration:0}),l=p,o=s,setTimeout(m,s.duration),g()):(a=s,l=null,o=h.extendFlat({},s,{duration:0}),setTimeout(g,a.duration),m()):c.length?(a=s,m()):n.anim&&(l=p,o=s,g())},I(r,s,l)},w.doCalcdata=function(r,n){var i,a,o,s,l=m.list(r),f=r._fullData,p=r._fullLayout,g=Array(f.length),v=(r.calcdata||[]).slice();for(r.calcdata=g,p._numBoxes=0,p._numViolins=0,p._violinScaleGroupStats={},r._hmpixcount=0,r._hmlumcount=0,p._piecolormap={},p._sunburstcolormap={},p._treemapcolormap={},p._iciclecolormap={},p._funnelareacolormap={},o=0;o<f.length;o++)Array.isArray(n)&&-1===n.indexOf(o)&&(g[o]=v[o]);for(o=0;o<f.length;o++)(i=f[o])._arrayAttrs=u.findArrayAttributes(i),i._extremes={};var y=p._subplots.polar||[];for(o=0;o<y.length;o++)l.push(p[y[o]].radialaxis,p[y[o]].angularaxis);for(var x in p._colorAxes){var b=p[x];!1!==b.cauto&&(delete b.cmin,delete b.cmax)}var _=!1;function w(n,o){if(!!(a=(i=f[n])._module).isContainer===o){var l=[];if(!0===i.visible&&0!==i._length){delete i._indexToPoints;var c=i.transforms||[];for(s=c.length-1;s>=0;s--)if(c[s].enabled){i._indexToPoints=c[s]._indexToPoints;break}a&&a.calc&&(l=a.calc(r,i))}Array.isArray(l)&&l[0]||(l=[{x:d,y:d}]),l[0].t||(l[0].t={}),l[0].trace=i,g[n]=l}}for(z(l,f,p),o=0;o<f.length;o++)w(o,!0);for(o=0;o<f.length;o++)(function(n){if(a=(i=f[n])._module,!0===i.visible&&i.transforms){if(a&&a.calc){var o=a.calc(r,i);o[0]&&o[0].t&&o[0].t._scene&&delete o[0].t._scene.dirty}for(s=0;s<i.transforms.length;s++){var l=i.transforms[s];(a=T[l.type])&&a.calcTransform&&(i._hasCalcTransform=!0,_=!0,a.calcTransform(r,i,l))}}})(o);for(_&&z(l,f,p),o=0;o<f.length;o++)w(o,!0);for(o=0;o<f.length;o++)w(o,!1);D(r);var k=function(r,n){var i,a,o,s,l,u=[],f={min:function(r){return h.aggNums(Math.min,null,r)},max:function(r){return h.aggNums(Math.max,null,r)},sum:function(r){return h.aggNums(function(r,n){return r+n},null,r)},total:function(r){return h.aggNums(function(r,n){return r+n},null,r)},mean:function(r){return h.mean(r)},median:function(r){return h.median(r)}};for(i=0;i<r.length;i++){var p=r[i];if("category"===p.type){var d=p.categoryorder.match(O);if(d){var g=d[1],v=d[2],y=p._id.charAt(0),x="x"===y,b=[];for(a=0;a<p._categories.length;a++)b.push([p._categories[a],[]]);for(a=0;a<p._traceIndices.length;a++){var _=p._traceIndices[a],w=n._fullData[_];if(!0===w.visible){var T=w.type;c.traceIs(w,"histogram")&&(delete w._xautoBinFinished,delete w._yautoBinFinished);var k="splom"===T,A="scattergl"===T,M=n.calcdata[_];for(o=0;o<M.length;o++){var S,E,L=M[o];if(k){var C=w._axesDim[p._id];if(!x){var P=w._diag[C][0];P&&(p=n._fullLayout[m.id2name(P)])}var I=L.trace.dimensions[C].values;for(s=0;s<I.length;s++)for(S=p._categoriesMap[I[s]],l=0;l<L.trace.dimensions.length;l++)if(l!==C){var z=L.trace.dimensions[l];b[S][1].push(z.values[s])}}else if(A){for(s=0;s<L.t.x.length;s++)x?(S=L.t.x[s],E=L.t.y[s]):(S=L.t.y[s],E=L.t.x[s]),b[S][1].push(E);L.t&&L.t._scene&&delete L.t._scene.dirty}else if(L.hasOwnProperty("z")){E=L.z;var D=function(r,i,a){var o=i._id.charAt(0);if("histogram2dcontour"===r){var s=i._counterAxes[0],l=m.getFromId(n,s),c="x"===o||"x"===s&&"category"===l.type,u="y"===o||"y"===s&&"category"===l.type;return function(r,n){return 0===r||0===n||c&&r===a[n].length-1||u&&n===a.length-1?-1:("y"===o?n:r)-1}}return function(r,n){return"y"===o?n:r}}(w.type,p,E);for(s=0;s<E.length;s++)for(l=0;l<E[s].length;l++)(S=D(l,s))+1&&b[S][1].push(E[s][l])}else for(void 0===(S=L.p)&&(S=L[y]),void 0===(E=L.s)&&(E=L.v),void 0===E&&(E=x?L.y:L.x),Array.isArray(E)||(E=void 0===E?[]:[E]),s=0;s<E.length;s++)b[S][1].push(E[s])}}}p._categoriesValue=b;var R=[];for(a=0;a<b.length;a++)R.push([b[a][0],f[g](b[a][1])]);R.sort(function(r,n){return r[1]-n[1]}),p._categoriesAggregatedValue=R,p._initialCategories=R.map(function(r){return r[0]}),"descending"===v&&p._initialCategories.reverse(),u=u.concat(p.sortByInitialCategories())}}}return u}(l,r);if(k.length){for(p._numBoxes=0,p._numViolins=0,o=0;o<k.length;o++)w(k[o],!0);for(o=0;o<k.length;o++)w(k[o],!1);D(r)}c.getComponentMethod("fx","calc")(r),c.getComponentMethod("errorbars","calc")(r)};var O=/(total|sum|min|max|mean|median) (ascending|descending)/;function z(r,n,i){var a={};function o(r){r.clearCalc(),"multicategory"===r.type&&r.setupMultiCategory(n),a[r._id]=1}h.simpleMap(r,o);for(var s=i._axisMatchGroups||[],l=0;l<s.length;l++)for(var c in s[l])a[c]||o(i[m.id2name(c)])}function D(r){var n,i,a,o=r._fullLayout,s=o._visibleModules,l={};for(i=0;i<s.length;i++){var c=s[i],u=c.crossTraceCalc;if(u){var f=c.basePlotModule.name;l[f]?h.pushUnique(l[f],u):l[f]=[u]}}for(a in l){var p=l[a],d=o._subplots[a];if(Array.isArray(d))for(n=0;n<d.length;n++){var m=d[n],g="cartesian"===a?o._plots[m]:o[m];for(i=0;i<p.length;i++)p[i](r,g,m)}else for(i=0;i<p.length;i++)p[i](r)}}w.rehover=function(r){r._fullLayout._rehover&&r._fullLayout._rehover()},w.redrag=function(r){r._fullLayout._redrag&&r._fullLayout._redrag()},w.generalUpdatePerTraceModule=function(r,n,i,a){var o,s=n.traceHash,l={};for(o=0;o<i.length;o++){var c=i[o],u=c[0].trace;u.visible&&(l[u.type]=l[u.type]||[],l[u.type].push(c))}for(var f in s)if(!l[f]){var p=s[f][0];p[0].trace.visible=!1,l[f]=[p]}for(var d in l){var m=l[d];m[0][0].trace._module.plot(r,n,h.filterVisible(m),a)}n.traceHash=l},w.plotBasePlot=function(r,n,i,a,o){var s=c.getModule(r),l=x(n.calcdata,s)[0];s.plot(n,l,a,o)},w.cleanBasePlot=function(r,n,i,a,o){var s=o._has&&o._has(r),l=i._has&&i._has(r);s&&!l&&o["_"+r+"layer"].selectAll("g.trace").remove()}},{"../components/color":366,"../constants/numerical":479,"../lib":503,"../plot_api/plot_schema":542,"../plot_api/plot_template":543,"../plots/get_data":593,"../registry":638,"./animation_attributes":548,"./attributes":550,"./cartesian/axis_ids":558,"./cartesian/handle_outline":565,"./command":583,"./font_attributes":585,"./frame_attributes":586,"./layout_attributes":610,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],620:[function(r,n,i){"use strict";n.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],621:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../lib/polygon").tester,s=a.findIndexOfMin,l=a.isAngleInsideSector,c=a.angleDelta,u=a.angleDist;function f(r,n,i,a){var o,s,l=a[0],c=a[1],u=p(Math.sin(n)-Math.sin(r)),f=p(Math.cos(n)-Math.cos(r)),h=Math.tan(i),d=p(1/h),m=u/f,g=c-m*l;return d?u&&f?s=h*(o=g/(h-m)):f?(o=c*d,s=c):(o=l,s=l*h):u&&f?(o=0,s=g):f?(o=0,s=c):o=s=NaN,[o,s]}function h(r,n,i,o){return a.isFullCircle([n,i])?function(r,n){var i,a=n.length,o=Array(a+1);for(i=0;i<a;i++){var s=n[i];o[i]=[r*Math.cos(s),r*Math.sin(s)]}return o[i]=o[0].slice(),o}(r,o):function(r,n,i,o){var c,h,p,d,m=o.length,g=[];function v(n){return[r*Math.cos(n),r*Math.sin(n)]}function y(r){return a.mod(r,m)}function x(r){return l(r,[n,i])}var b=s(o,function(r){return x(r)?u(r,n):1/0}),_=f(c=o[b],o[y(b-1)],n,v(c));for(g.push(_),p=b,d=0;d<m;p++,d++){var w=o[y(p)];if(!x(w))break;g.push(v(w))}var T=s(o,function(r){return x(r)?u(r,i):1/0}),k=f(h=o[T],o[y(T+1)],i,v(h));return g.push(k),g.push([0,0]),g.push(g[0].slice()),g}(r,n,i,o)}function p(r){return Math.abs(r)>1e-10?r:0}function d(r,n,i){n=n||0,i=i||0;for(var a=r.length,o=Array(a),s=0;s<a;s++){var l=r[s];o[s]=[n+l[0],i-l[1]]}return o}n.exports={isPtInsidePolygon:function(r,n,i,a,s){if(!l(n,a))return!1;i[0]<i[1]?(c=i[0],u=i[1]):(c=i[1],u=i[0]);var c,u,f=o(h(c,a[0],a[1],s)),p=o(h(u,a[0],a[1],s)),d=[r*Math.cos(n),r*Math.sin(n)];return p.contains(d)&&!f.contains(d)},findPolygonOffset:function(r,n,i,a){for(var o=1/0,s=1/0,l=h(r,n,i,a),c=0;c<l.length;c++){var u=l[c];o=Math.min(o,u[0]),s=Math.min(s,-u[1])}return[o,s]},findEnclosingVertexAngles:function(r,n){var i=s(n,function(n){var i=c(n,r);return i>0?i:1/0}),o=a.mod(i+1,n.length);return[n[i],n[o]]},findIntersectionXY:f,findXYatLength:function(r,n,i,a){var o=-n*i,s=n*n+1,l=2*(n*o-i),c=Math.sqrt(l*l-4*s*(o*o+i*i-r*r)),u=(-l+c)/(2*s),f=(-l-c)/(2*s);return[[u,n*u+o+a],[f,n*f+o+a]]},clampTiny:p,pathPolygon:function(r,n,i,a,o,s){return"M"+d(h(r,n,i,a),o,s).join("L")},pathPolygonAnnulus:function(r,n,i,a,o,s,l){r<n?(c=r,u=n):(c=n,u=r);var c,u,f=d(h(c,i,a,o),s,l);return"M"+d(h(u,i,a,o),s,l).reverse().join("L")+"M"+f.join("L")}}},{"../../lib":503,"../../lib/polygon":515}],622:[function(r,n,i){"use strict";var a=r("../get_data").getSubplotCalcData,o=r("../../lib").counterRegex,s=r("./polar"),l=r("./constants"),c=l.attr,u=l.name,f=o(u),h={};h[c]={valType:"subplotid",dflt:u,editType:"calc"},n.exports={attr:c,name:u,idRoot:u,idRegex:f,attrRegex:f,attributes:h,layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),plot:function(r){for(var n=r._fullLayout,i=r.calcdata,o=n._subplots[u],l=0;l<o.length;l++){var c=o[l],f=a(i,u,c),h=n[c]._subplot;h||(h=s(r,c),n[c]._subplot=h),h.plot(f,n,r._promises)}},clean:function(r,n,i,a){for(var o=a._subplots[u]||[],s=a._has&&a._has("gl"),l=n._has&&n._has("gl"),c=s&&!l,f=0;f<o.length;f++){var h=o[f],p=a[h]._subplot;if(!n[h]&&p)for(var d in p.framework.remove(),p.layers["radial-axis-title"].remove(),p.clipPaths)p.clipPaths[d].remove();c&&p._scene&&(p._scene.destroy(),p._scene=null)}},toSVG:r("../cartesian").toSVG}},{"../../lib":503,"../cartesian":568,"../get_data":593,"./constants":620,"./layout_attributes":623,"./layout_defaults":624,"./polar":625}],623:[function(r,n,i){"use strict";var a=r("../../components/color/attributes"),o=r("../cartesian/layout_attributes"),s=r("../domain").attributes,l=r("../../lib").extendFlat,c=r("../../plot_api/edit_types").overrideAll,u=c({color:o.color,showline:l({},o.showline,{dflt:!0}),linecolor:o.linecolor,linewidth:o.linewidth,showgrid:l({},o.showgrid,{dflt:!0}),gridcolor:o.gridcolor,gridwidth:o.gridwidth},"plot","from-root"),f=c({tickmode:o.tickmode,nticks:o.nticks,tick0:o.tick0,dtick:o.dtick,tickvals:o.tickvals,ticktext:o.ticktext,ticks:o.ticks,ticklen:o.ticklen,tickwidth:o.tickwidth,tickcolor:o.tickcolor,showticklabels:o.showticklabels,showtickprefix:o.showtickprefix,tickprefix:o.tickprefix,showticksuffix:o.showticksuffix,ticksuffix:o.ticksuffix,showexponent:o.showexponent,exponentformat:o.exponentformat,minexponent:o.minexponent,separatethousands:o.separatethousands,tickfont:o.tickfont,tickangle:o.tickangle,tickformat:o.tickformat,tickformatstops:o.tickformatstops,layer:o.layer},"plot","from-root"),h={visible:l({},o.visible,{dflt:!0}),type:l({},o.type,{values:["-","linear","log","date","category"]}),autotypenumbers:o.autotypenumbers,autorange:l({},o.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:l({},o.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:o.categoryorder,categoryarray:o.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:l({},o.title.text,{editType:"plot",dflt:""}),font:l({},o.title.font,{editType:"plot"}),editType:"plot"},hoverformat:o.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:o._deprecated.title,titlefont:o._deprecated.titlefont}};l(h,u,f);var p={visible:l({},o.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:o.autotypenumbers,categoryorder:o.categoryorder,categoryarray:o.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:o.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};l(p,u,f),n.exports={domain:s({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:a.background},radialaxis:h,angularaxis:p,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":365,"../../lib":503,"../../plot_api/edit_types":536,"../cartesian/layout_attributes":569,"../domain":584}],624:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/color"),s=r("../../plot_api/plot_template"),l=r("../subplot_defaults"),c=r("../get_data").getSubplotData,u=r("../cartesian/tick_value_defaults"),f=r("../cartesian/tick_mark_defaults"),h=r("../cartesian/tick_label_defaults"),p=r("../cartesian/prefix_suffix_defaults"),d=r("../cartesian/category_order_defaults"),m=r("../cartesian/line_grid_defaults"),g=r("../cartesian/axis_autotype"),v=r("./layout_attributes"),y=r("./set_convert"),x=r("./constants"),b=x.axisNames;function _(r,n,i,l){var _=i("bgcolor");l.bgColor=o.combine(_,l.paper_bgcolor);var w=i("sector");i("hole");var T,k=c(l.fullData,x.name,l.id),A=l.layoutOut;function M(r,n){return i(T+"."+r,n)}for(var S=0;S<b.length;S++){T=b[S],a.isPlainObject(r[T])||(r[T]={});var E=r[T],L=s.newContainer(n,T);L._id=L._name=T,L._attr=l.id+"."+T,L._traceIndices=k.map(function(r){return r._expandedIndex});var C=x.axisName2dataArray[T],P=function(r,n,i,a,o,s){var l=i("autotypenumbers",s.autotypenumbersDflt);if("-"===i("type")){for(var c,u=0;u<a.length;u++)if(a[u].visible){c=a[u];break}c&&c[o]&&(n.type=g(c[o],"gregorian",{noMultiCategory:!0,autotypenumbers:l})),"-"===n.type?n.type="linear":r.type=n.type}return n.type}(E,L,M,k,C,l);d(E,L,M,{axData:k,dataAttr:C});var I=M("visible");switch(y(L,n,A),M("uirevision",n.uirevision),L._m=1,T){case"radialaxis":var O=M("autorange",!L.isValidRange(E.range));E.autorange=O,O&&("linear"===P||"-"===P)&&M("rangemode"),"reversed"===O&&(L._m=-1),M("range"),L.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if("date"===P){a.log("Polar plots do not support date angular axes yet.");for(var z=0;z<k.length;z++)k[z].visible=!1;P=E.type=L.type="linear"}M("linear"===P?"thetaunit":"period");var D=M("direction");M("rotation",{counterclockwise:0,clockwise:90}[D])}if(p(E,L,M,L.type,{tickSuffixDflt:"degrees"===L.thetaunit?"\xb0":void 0}),I){var R,F,B,N,j=l.font||{};F=(R=M("color"))===E.color?R:j.color,B=j.size,N=j.family,u(E,L,M,L.type),h(E,L,M,L.type,{font:{color:F,size:B,family:N}}),f(E,L,M,{outerTicks:!0}),m(E,L,M,{dfltColor:R,bgColor:l.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:v[T]}),M("layer"),"radialaxis"===T&&(M("side"),M("angle",w[0]),M("title.text"),a.coerceFont(M,"title.font",{color:F,size:a.bigFont(B),family:N}))}"category"!==P&&M("hoverformat"),L._input=E}"category"===n.angularaxis.type&&i("gridshape")}n.exports=function(r,n,i){l(r,n,i,{type:x.name,attributes:v,handleDefaults:_,font:n.font,autotypenumbersDflt:n.autotypenumbers,paper_bgcolor:n.paper_bgcolor,fullData:i,layoutOut:n})}},{"../../components/color":366,"../../lib":503,"../../plot_api/plot_template":543,"../cartesian/axis_autotype":555,"../cartesian/category_order_defaults":559,"../cartesian/line_grid_defaults":571,"../cartesian/prefix_suffix_defaults":573,"../cartesian/tick_label_defaults":578,"../cartesian/tick_mark_defaults":579,"../cartesian/tick_value_defaults":580,"../get_data":593,"../subplot_defaults":632,"./constants":620,"./layout_attributes":623,"./set_convert":626}],625:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("tinycolor2"),s=r("../../registry"),l=r("../../lib"),c=l.strRotate,u=l.strTranslate,f=r("../../components/color"),h=r("../../components/drawing"),p=r("../plots"),d=r("../../plots/cartesian/axes"),m=r("../cartesian/set_convert"),g=r("./set_convert"),v=r("../cartesian/autorange").doAutoRange,y=r("../cartesian/dragbox"),x=r("../../components/dragelement"),b=r("../../components/fx"),_=r("../../components/titles"),w=r("../cartesian/select").prepSelect,T=r("../cartesian/select").selectOnClick,k=r("../cartesian/select").clearSelect,A=r("../../lib/setcursor"),M=r("../../lib/clear_gl_canvases"),S=r("../../plot_api/subroutines").redrawReglTraces,E=r("../../constants/alignment").MID_SHIFT,L=r("./constants"),C=r("./helpers"),P=r("../smith/helpers"),I=P.smith,O=P.reactanceArc,z=P.resistanceArc,D=P.smithTransform,R=l._,F=l.mod,B=l.deg2rad,N=l.rad2deg;function j(r,n,i){this.isSmith=i||!1,this.id=n,this.gd=r,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var a=r._fullLayout,o="clip"+a._uid+n;this.clipIds.forTraces=o+"-for-traces",this.clipPaths.forTraces=a._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=a["_"+(i?"smith":"polar")+"layer"].append("g").attr("class",n),this.getHole=function(r){return this.isSmith?0:r.hole},this.getSector=function(r){return this.isSmith?[0,360]:r.sector},this.getRadial=function(r){return this.isSmith?r.realaxis:r.radialaxis},this.getAngular=function(r){return this.isSmith?r.imaginaryaxis:r.angularaxis},i||(this.radialTickLayout=null,this.angularTickLayout=null)}var U=j.prototype;function V(r){var n=r.ticks+String(r.ticklen)+String(r.showticklabels);return"side"in r&&(n+=r.side),n}function H(r,n){return n[l.findIndexOfMin(n,function(n){return l.angleDist(r,n)})]}function q(r,n,i){return n?(r.attr("display",null),r.attr(i)):r&&r.attr("display","none"),r}n.exports=function(r,n,i){return new j(r,n,i)},U.plot=function(r,n){for(var i=n[this.id],a=!1,o=0;o<r.length;o++)if(!1===r[o][0].trace.cliponaxis){a=!0;break}this._hasClipOnAxisFalse=a,this.updateLayers(n,i),this.updateLayout(n,i),p.generalUpdatePerTraceModule(this.gd,this,r,i),this.updateFx(n,i),this.isSmith&&(delete i.realaxis.range,delete i.imaginaryaxis.range)},U.updateLayers=function(r,n){var i=this.isSmith,o=this.layers,s=this.getRadial(n),l=this.getAngular(n),c=L.layerNames,u=c.indexOf("frontplot"),f=c.slice(0,u),h="below traces"===l.layer,p="below traces"===s.layer;h&&f.push("angular-line"),p&&f.push("radial-line"),h&&f.push("angular-axis"),p&&f.push("radial-axis"),f.push("frontplot"),h||f.push("angular-line"),p||f.push("radial-line"),h||f.push("angular-axis"),p||f.push("radial-axis");var d=(i?"smith":"polar")+"sublayer",m=this.framework.selectAll("."+d).data(f,String);m.enter().append("g").attr("class",function(r){return d+" "+r}).each(function(r){var n=o[r]=a.select(this);switch(r){case"frontplot":i||n.append("g").classed("barlayer",!0),n.append("g").classed("scatterlayer",!0);break;case"backplot":n.append("g").classed("maplayer",!0);break;case"plotbg":o.bg=n.append("path");break;case"radial-grid":case"angular-grid":n.style("fill","none");break;case"radial-line":n.append("line").style("fill","none");break;case"angular-line":n.append("path").style("fill","none")}}),m.order()},U.updateLayout=function(r,n){var i=this.layers,a=r._size,o=this.getRadial(n),s=this.getAngular(n),l=n.domain.x,c=n.domain.y;this.xOffset=a.l+a.w*l[0],this.yOffset=a.t+a.h*(1-c[1]);var p=this.xLength=a.w*(l[1]-l[0]),d=this.yLength=a.h*(c[1]-c[0]),m=this.getSector(n);this.sectorInRad=m.map(B);var g,v,y,x,b,_,w,T,k,A,M,S,E,L,C=this.sectorBBox=(v=m[0],y=m[1]-v,b=(x=F(v,360))+y,_=Math.cos(B(x)),w=Math.sin(B(x)),T=Math.cos(B(b)),k=Math.sin(B(b)),g=x<=90&&b>=90||x>90&&b>=450?1:w<=0&&k<=0?0:Math.max(w,k),[x<=180&&b>=180||x>180&&b>=540?-1:_>=0&&T>=0?0:Math.min(_,T),x<=270&&b>=270||x>270&&b>=630?-1:w>=0&&k>=0?0:Math.min(w,k),b>=360?1:_<=0&&T<=0?0:Math.max(_,T),g]),P=C[2]-C[0],I=Math.abs((C[3]-C[1])/P);d/p>I?(A=p,L=(d-(M=p*I))/a.h/2,S=[l[0],l[1]],E=[c[0]+L,c[1]-L]):(M=d,L=(p-(A=d/I))/a.w/2,S=[l[0]+L,l[1]-L],E=[c[0],c[1]]),this.xLength2=A,this.yLength2=M,this.xDomain2=S,this.yDomain2=E;var O,z=this.xOffset2=a.l+a.w*S[0],D=this.yOffset2=a.t+a.h*(1-E[1]),R=this.radius=A/P,N=this.innerRadius=this.getHole(n)*R,j=this.cx=z-R*C[0],U=this.cy=D+R*C[3],V=this.cxx=j-z,H=this.cyy=U-D,q=o.side;"counterclockwise"===q?(O=q,q="top"):"clockwise"===q&&(O=q,q="bottom"),this.radialAxis=this.mockAxis(r,n,o,{_id:"x",side:q,_trueSide:O,domain:[N/a.w,R/a.w]}),this.angularAxis=this.mockAxis(r,n,s,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(r,n),this.updateAngularAxis(r,n),this.updateRadialAxis(r,n),this.updateRadialAxisTitle(r,n),this.xaxis=this.mockCartesianAxis(r,n,{_id:"x",domain:S}),this.yaxis=this.mockCartesianAxis(r,n,{_id:"y",domain:E});var G=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",G).attr("transform",u(V,H)),i.frontplot.attr("transform",u(z,D)).call(h.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),i.bg.attr("d",G).attr("transform",u(j,U)).call(f.fill,n.bgcolor)},U.mockAxis=function(r,n,i,a){var o=l.extendFlat({},i,a);return g(o,n,r),o},U.mockCartesianAxis=function(r,n,i){var a=this,o=a.isSmith,s=i._id,c=l.extendFlat({type:"linear"},i);m(c,r);var u={x:[0,2],y:[1,3]};return c.setRange=function(){var r=a.sectorBBox,i=u[s],o=a.radialAxis._rl,l=(o[1]-o[0])/(1-a.getHole(n));c.range=[r[i[0]]*l,r[i[1]]*l]},c.isPtWithinRange="x"!==s||o?function(){return!0}:function(r){return a.isPtInside(r)},c.setRange(),c.setScale(),c},U.doAutoRange=function(r,n){var i=this.gd,a=this.radialAxis,o=this.getRadial(n);v(i,a);var s=a.range;o.range=s.slice(),o._input.range=s.slice(),a._rl=[a.r2l(s[0],null,"gregorian"),a.r2l(s[1],null,"gregorian")]},U.updateRadialAxis=function(r,n){var i=this,a=i.gd,o=i.layers,s=i.radius,h=i.innerRadius,p=i.cx,m=i.cy,g=i.getRadial(n),v=F(i.getSector(n)[0],360),y=i.radialAxis,x=h<s,b=i.isSmith;b||(i.fillViewInitialKey("radialaxis.angle",g.angle),i.fillViewInitialKey("radialaxis.range",y.range.slice()),y.setGeometry()),"auto"===y.tickangle&&v>90&&v<=270&&(y.tickangle=180);var _=b?function(r){var n=D(i,I([r.x,0]));return u(n[0]-p,n[1]-m)}:function(r){return u(y.l2p(r.x)+h,0)},w=b?function(r){return z(i,r.x,-1/0,1/0)}:function(r){return i.pathArc(y.r2p(r.x)+h)},T=V(g);if(i.radialTickLayout!==T&&(o["radial-axis"].selectAll(".xtick").remove(),i.radialTickLayout=T),x){y.setScale();var k=0,A=b?(y.tickvals||[]).filter(function(r){return r>=0}).map(function(r){return d.tickText(y,r,!0,!1)}):d.calcTicks(y),M=b?A:d.clipEnds(y,A),S=d.getTickSigns(y)[2];b&&(("top"===y.ticks&&"bottom"===y.side||"bottom"===y.ticks&&"top"===y.side)&&(S=-S),"top"===y.ticks&&"top"===y.side&&(k=-y.ticklen),"bottom"===y.ticks&&"bottom"===y.side&&(k=y.ticklen)),d.drawTicks(a,y,{vals:A,layer:o["radial-axis"],path:d.makeTickPath(y,0,S),transFn:_,crisp:!1}),d.drawGrid(a,y,{vals:M,layer:o["radial-grid"],path:w,transFn:l.noop,crisp:!1}),d.drawLabels(a,y,{vals:A,layer:o["radial-axis"],transFn:_,labelFns:d.makeLabelFns(y,k)})}var E=i.radialAxisAngle=i.vangles?N(H(B(g.angle),i.vangles)):g.angle,L=u(p,m),C=L+c(-E);q(o["radial-axis"],x&&(g.showticklabels||g.ticks),{transform:C}),q(o["radial-grid"],x&&g.showgrid,{transform:b?"":L}),q(o["radial-line"].select("line"),x&&g.showline,{x1:b?-s:h,y1:0,x2:s,y2:0,transform:C}).attr("stroke-width",g.linewidth).call(f.stroke,g.linecolor)},U.updateRadialAxisTitle=function(r,n,i){if(!this.isSmith){var a=this.gd,o=this.radius,s=this.cx,l=this.cy,c=this.getRadial(n),u=this.id+"title",f=0;if(c.title){var p=h.bBox(this.layers["radial-axis"].node()).height,d=c.title.font.size,m=c.side;f="top"===m?d:"counterclockwise"===m?-(p+.4*d):p+.8*d}var g=void 0!==i?i:this.radialAxisAngle,v=B(g),y=Math.cos(v),x=Math.sin(v),b=s+o/2*y+f*x,w=l-o/2*x+f*y;this.layers["radial-axis-title"]=_.draw(a,u,{propContainer:c,propName:this.id+".radialaxis.title",placeholder:R(a,"Click to enter radial axis title"),attributes:{x:b,y:w,"text-anchor":"middle"},transform:{rotate:-g}})}},U.updateAngularAxis=function(r,n){var i=this,a=i.gd,o=i.layers,s=i.radius,h=i.innerRadius,p=i.cx,m=i.cy,g=i.getAngular(n),v=i.angularAxis,y=i.isSmith;y||(i.fillViewInitialKey("angularaxis.rotation",g.rotation),v.setGeometry(),v.setScale());var x=y?function(r){var n=D(i,I([0,r.x]));return Math.atan2(n[0]-p,n[1]-m)-Math.PI/2}:function(r){return v.t2g(r.x)};"linear"===v.type&&"radians"===v.thetaunit&&(v.tick0=N(v.tick0),v.dtick=N(v.dtick));var b=function(r){return u(p+s*Math.cos(r),m-s*Math.sin(r))},_=y?function(r){var n=D(i,I([0,r.x]));return u(n[0],n[1])}:function(r){return b(x(r))},w=y?function(r){var n=D(i,I([0,r.x])),a=Math.atan2(n[0]-p,n[1]-m)-Math.PI/2;return u(n[0],n[1])+c(-N(a))}:function(r){var n=x(r);return b(n)+c(-N(n))},T=y?function(r){return O(i,r.x,0,1/0)}:function(r){var n=x(r),i=Math.cos(n),a=Math.sin(n);return"M"+[p+h*i,m-h*a]+"L"+[p+s*i,m-s*a]},k=d.makeLabelFns(v,0).labelStandoff,A=V(g);i.angularTickLayout!==A&&(o["angular-axis"].selectAll("."+v._id+"tick").remove(),i.angularTickLayout=A);var M,S=y?[1/0].concat(v.tickvals||[]).map(function(r){return d.tickText(v,r,!0,!1)}):d.calcTicks(v);if(y&&(S[0].text="",S[0].fontSize*=1.75),"linear"===n.gridshape?(M=S.map(x),0>l.angleDelta(M[0],M[1])&&(M=M.slice().reverse())):M=null,i.vangles=M,"category"===v.type&&(S=S.filter(function(r){return l.isAngleInsideSector(x(r),i.sectorInRad)})),v.visible){var L="inside"===v.ticks?-1:1,C=(v.linewidth||1)/2;d.drawTicks(a,v,{vals:S,layer:o["angular-axis"],path:"M"+L*C+",0h"+L*v.ticklen,transFn:w,crisp:!1}),d.drawGrid(a,v,{vals:S,layer:o["angular-grid"],path:T,transFn:l.noop,crisp:!1}),d.drawLabels(a,v,{vals:S,layer:o["angular-axis"],repositionOnUpdate:!0,transFn:_,labelFns:{xFn:function(r){return Math.cos(x(r))*k},yFn:function(r){var n=x(r),i=Math.sin(n)>0?.2:1;return-Math.sin(n)*(k+r.fontSize*i)+r.fontSize*E*Math.abs(Math.cos(n))},anchorFn:function(r){var n=Math.cos(x(r));return .1>Math.abs(n)?"middle":n>0?"start":"end"},heightFn:function(r,n,i){return -.5*(1+Math.sin(x(r)))*i}}})}q(o["angular-line"].select("path"),g.showline,{d:i.pathSubplot(),transform:u(p,m)}).attr("stroke-width",g.linewidth).call(f.stroke,g.linecolor)},U.updateFx=function(r,n){this.gd._context.staticPlot||(this.isSmith||(this.updateAngularDrag(r),this.updateRadialDrag(r,n,0),this.updateRadialDrag(r,n,1)),this.updateHoverAndMainDrag(r))},U.updateHoverAndMainDrag=function(r){var n,i,c=this,f=c.isSmith,h=c.gd,p=c.layers,d=r._zoomlayer,m=L.MINZOOM,g=L.OFFEDGE,v=c.radius,_=c.innerRadius,A=c.cx,M=c.cy,S=c.cxx,E=c.cyy,P=c.sectorInRad,I=c.vangles,O=c.radialAxis,z=C.clampTiny,D=C.findXYatLength,R=C.findEnclosingVertexAngles,F=L.cornerHalfWidth,B=L.cornerLen/2,N=y.makeDragger(p,"path","maindrag","crosshair");a.select(N).attr("d",c.pathSubplot()).attr("transform",u(A,M)),N.onmousemove=function(r){b.hover(h,r,c.id),h._fullLayout._lasthover=N,h._fullLayout._hoversubplot=c.id},N.onmouseout=function(r){h._dragging||x.unhover(h,r)};var j,U,V,H,q,G,Y,W,X,Z={element:N,gd:h,subplot:c.id,plotinfo:{id:c.id,xaxis:c.xaxis,yaxis:c.yaxis},xaxes:[c.xaxis],yaxes:[c.yaxis]};function J(r,n){return Math.sqrt(r*r+n*n)}function K(r,n){return Math.atan2(E-n,r-S)}function Q(r,n){return[r*Math.cos(n),r*Math.sin(-n)]}function $(r,n){if(0===r)return c.pathSector(2*F);var i=B/r,a=n-i,o=n+i,s=Math.max(0,Math.min(r,v)),l=s-F,u=s+F;return"M"+Q(l,a)+"A"+[l,l]+" 0,0,0 "+Q(l,o)+"L"+Q(u,o)+"A"+[u,u]+" 0,0,1 "+Q(u,a)+"Z"}function tt(r,n,i){if(0===r)return c.pathSector(2*F);var a,o,s,l,u=Q(r,n),f=Q(r,i),h=z((u[0]+f[0])/2),p=z((u[1]+f[1])/2);if(h&&p){var d=p/h,m=-1/d,g=D(F,d,h,p);s=D(B,m,g[0][0],g[0][1]),l=D(B,m,g[1][0],g[1][1])}else p?(a=B,o=F):(a=F,o=B),s=[[h-a,p-o],[h+a,p-o]],l=[[h-a,p+o],[h+a,p+o]];return"M"+s.join("L")+"L"+l.reverse().join("L")+"Z"}function te(r,n){return n=Math.max(Math.min(n,v),_),r<g?r=0:v-r<g?r=v:n<g?n=0:v-n<g&&(n=v),Math.abs(n-r)>m?(r<n?(V=r,H=n):(V=n,H=r),!0):(V=null,H=null,!1)}function tr(r,n){r=r||q,n=n||"M0,0Z",W.attr("d",r),X.attr("d",n),y.transitionZoombox(W,X,G,Y),G=!0;var i={};ts(i),h.emit("plotly_relayouting",i)}function tn(r,a){var o,s,l=j+(r*=n),u=U+(a*=i),f=J(j-S,U-E),h=Math.min(J(l-S,u-E),v),p=K(j,U);te(f,h)&&(o=q+c.pathSector(H),V&&(o+=c.pathSector(V)),s=$(V,p)+$(H,p)),tr(o,s)}function ti(r,n,i,a){var o=C.findIntersectionXY(i,a,i,[r-S,E-n]);return J(o[0],o[1])}function ta(r,n){var i,a,o=j+r,s=U+n,l=K(j,U),u=K(o,s),f=R(l,I),h=R(u,I);te(ti(j,U,f[0],f[1]),Math.min(ti(o,s,h[0],h[1]),v))&&(i=q+c.pathSector(H),V&&(i+=c.pathSector(V)),a=[tt(V,f[0],f[1]),tt(H,f[0],f[1])].join(" ")),tr(i,a)}function to(){if(y.removeZoombox(h),null!==V&&null!==H){var r={};ts(r),y.showDoubleClickNotifier(h),s.call("_guiRelayout",h,r)}}function ts(r){var n=O._rl,i=(n[1]-n[0])/(1-_/v)/v,a=[n[0]+(V-_)*i,n[0]+(H-_)*i];r[c.id+".radialaxis.range"]=a}function tl(r,n){var i=h._fullLayout.clickmode;if(y.removeZoombox(h),2===r){var a={};for(var o in c.viewInitial)a[c.id+"."+o]=c.viewInitial[o];h.emit("plotly_doubleclick",null),s.call("_guiRelayout",h,a)}i.indexOf("select")>-1&&1===r&&T(n,h,[c.xaxis],[c.yaxis],c.id,Z),i.indexOf("event")>-1&&b.click(h,n,c.id)}Z.prepFn=function(r,a,s){var u=h._fullLayout.dragmode,p=N.getBoundingClientRect();h._fullLayout._calcInverseTransform(h);var m=h._fullLayout._invTransform;n=h._fullLayout._invScaleX,i=h._fullLayout._invScaleY;var g=l.apply3DTransform(m)(a-p.left,s-p.top);if(j=g[0],U=g[1],I){var x=C.findPolygonOffset(v,P[0],P[1],I);j+=S+x[0],U+=E+x[1]}switch(u){case"zoom":Z.clickFn=tl,f||(Z.moveFn=I?ta:tn,Z.doneFn=to,V=null,H=null,q=c.pathSubplot(),G=!1,Y=o(h._fullLayout[c.id].bgcolor).getLuminance(),(W=y.makeZoombox(d,Y,A,M,q)).attr("fill-rule","evenodd"),X=y.makeCorners(d,A,M),k(h));break;case"select":case"lasso":w(r,a,s,Z,u)}},x.init(Z)},U.updateRadialDrag=function(r,n,i){var o=this,f=o.gd,h=o.layers,p=o.radius,d=o.innerRadius,m=o.cx,g=o.cy,v=o.radialAxis,b=L.radialDragBoxSize,_=b/2;if(v.visible){var w,T,A,E=B(o.radialAxisAngle),C=v._rl,P=C[0],I=C[1],O=C[i],z=.75*(C[1]-C[0])/(1-o.getHole(n))/p;i?(w=m+(p+_)*Math.cos(E),T=g-(p+_)*Math.sin(E),A="radialdrag"):(w=m+(d-_)*Math.cos(E),T=g-(d-_)*Math.sin(E),A="radialdrag-inner");var D,R,F,j=y.makeRectDragger(h,A,"crosshair",-_,-_,b,b),U={element:j,gd:f};q(a.select(j),v.visible&&d<p,{transform:u(w,T)}),U.prepFn=function(){D=null,R=null,F=null,U.moveFn=V,U.doneFn=G,k(f)},U.clampFn=function(r,n){return Math.sqrt(r*r+n*n)<L.MINDRAG&&(r=0,n=0),[r,n]},x.init(U)}function V(r,n){if(D)D(r,n);else{var a=[r,-n],s=[Math.cos(E),Math.sin(E)],c=Math.abs(l.dot(a,s)/Math.sqrt(l.dot(a,a)));isNaN(c)||(D=c<.5?Y:W)}var u={};null!==R?u[o.id+".radialaxis.angle"]=R:null!==F&&(u[o.id+".radialaxis.range["+i+"]"]=F),f.emit("plotly_relayouting",u)}function G(){null!==R?s.call("_guiRelayout",f,o.id+".radialaxis.angle",R):null!==F&&s.call("_guiRelayout",f,o.id+".radialaxis.range["+i+"]",F)}function Y(r,n){if(0!==i){R=Math.atan2(g-(T+n),w+r-m),o.vangles&&(R=H(R,o.vangles)),R=N(R);var a=u(m,g)+c(-R);h["radial-axis"].attr("transform",a),h["radial-line"].select("line").attr("transform",a);var s=o.gd._fullLayout,l=s[o.id];o.updateRadialAxisTitle(s,l,R)}}function W(r,n){var a=l.dot([r,-n],[Math.cos(E),Math.sin(E)]);if(F=O-z*a,z>0==(i?F>P:F<I)){var c=f._fullLayout,u=c[o.id];v.range[i]=F,v._rl[i]=F,o.updateRadialAxis(c,u),o.xaxis.setRange(),o.xaxis.setScale(),o.yaxis.setRange(),o.yaxis.setScale();var h=!1;for(var p in o.traceHash){var d=o.traceHash[p],m=l.filterVisible(d);d[0][0].trace._module.plot(f,o,m,u),s.traceIs(p,"gl")&&m.length&&(h=!0)}h&&(M(f),S(f))}else F=null}},U.updateAngularDrag=function(r){var n=this,i=n.gd,o=n.layers,f=n.radius,p=n.angularAxis,d=n.cx,m=n.cy,g=n.cxx,v=n.cyy,b=L.angularDragBoxSize,_=y.makeDragger(o,"path","angulardrag","move"),w={element:_,gd:i};function T(r,n){return Math.atan2(v+b-n,r-g-b)}a.select(_).attr("d",n.pathAnnulus(f,f+b)).attr("transform",u(d,m)).call(A,"move");var E,C,P,I,O,z,D=o.frontplot.select(".scatterlayer").selectAll(".trace"),R=D.selectAll(".point"),F=D.selectAll(".textpoint");function B(f,y){var x=n.gd._fullLayout,b=x[n.id],_=N(T(E+f*r._invScaleX,C+y*r._invScaleY)-z);if(I=P+_,o.frontplot.attr("transform",u(n.xOffset2,n.yOffset2)+c([-_,g,v])),n.vangles){O=n.radialAxisAngle+_;var w=u(d,m)+c(-_),k=u(d,m)+c(-O);o.bg.attr("transform",w),o["radial-grid"].attr("transform",w),o["radial-axis"].attr("transform",k),o["radial-line"].select("line").attr("transform",k),n.updateRadialAxisTitle(x,b,O)}else n.clipPaths.forTraces.select("path").attr("transform",u(g,v)+c(_));R.each(function(){var r=a.select(this),n=h.getTranslate(r);r.attr("transform",u(n.x,n.y)+c([_]))}),F.each(function(){var r=a.select(this),n=r.select("text"),i=h.getTranslate(r);r.attr("transform",c([_,n.attr("x"),n.attr("y")])+u(i.x,i.y))}),p.rotation=l.modHalf(I,360),n.updateAngularAxis(x,b),n._hasClipOnAxisFalse&&!l.isFullCircle(n.sectorInRad)&&D.call(h.hideOutsideRangePoints,n);var A=!1;for(var L in n.traceHash)if(s.traceIs(L,"gl")){var B=n.traceHash[L],U=l.filterVisible(B);B[0][0].trace._module.plot(i,n,U,b),U.length&&(A=!0)}A&&(M(i),S(i));var V={};j(V),i.emit("plotly_relayouting",V)}function j(r){r[n.id+".angularaxis.rotation"]=I,n.vangles&&(r[n.id+".radialaxis.angle"]=O)}function U(){F.select("text").attr("transform",null);var r={};j(r),s.call("_guiRelayout",i,r)}w.prepFn=function(a,o,s){P=r[n.id].angularaxis.rotation;var c=_.getBoundingClientRect();E=o-c.left,C=s-c.top,i._fullLayout._calcInverseTransform(i);var u=l.apply3DTransform(r._invTransform)(E,C);E=u[0],C=u[1],z=T(E,C),w.moveFn=B,w.doneFn=U,k(i)},n.vangles&&!l.isFullCircle(n.sectorInRad)&&(w.prepFn=l.noop,A(a.select(_),null)),x.init(w)},U.isPtInside=function(r){if(this.isSmith)return!0;var n=this.sectorInRad,i=this.vangles,a=this.angularAxis.c2g(r.theta),o=this.radialAxis,s=o.c2l(r.r),c=o._rl;return(i?C.isPtInsidePolygon:l.isPtInsideSector)(s,a,c,n,i)},U.pathArc=function(r){var n=this.sectorInRad,i=this.vangles;return(i?C.pathPolygon:l.pathArc)(r,n[0],n[1],i)},U.pathSector=function(r){var n=this.sectorInRad,i=this.vangles;return(i?C.pathPolygon:l.pathSector)(r,n[0],n[1],i)},U.pathAnnulus=function(r,n){var i=this.sectorInRad,a=this.vangles;return(a?C.pathPolygonAnnulus:l.pathAnnulus)(r,n,i[0],i[1],a)},U.pathSubplot=function(){var r=this.innerRadius,n=this.radius;return r?this.pathAnnulus(r,n):this.pathSector(n)},U.fillViewInitialKey=function(r,n){r in this.viewInitial||(this.viewInitial[r]=n)}},{"../../components/color":366,"../../components/dragelement":385,"../../components/drawing":388,"../../components/fx":406,"../../components/titles":464,"../../constants/alignment":471,"../../lib":503,"../../lib/clear_gl_canvases":487,"../../lib/setcursor":524,"../../plot_api/subroutines":544,"../../plots/cartesian/axes":554,"../../registry":638,"../cartesian/autorange":553,"../cartesian/dragbox":563,"../cartesian/select":575,"../cartesian/set_convert":576,"../plots":619,"../smith/helpers":628,"./constants":620,"./helpers":621,"./set_convert":626,"@plotly/d3":58,tinycolor2:312}],626:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../cartesian/set_convert"),s=a.deg2rad,l=a.rad2deg;n.exports=function(r,n,i){switch(o(r,i),r._id){case"x":case"radialaxis":var c;c=n._subplot,r.setGeometry=function(){var n=r._rl[0],i=r._rl[1],a=c.innerRadius,o=(c.radius-a)/(i-n),s=a/o,l=n>i?function(r){return r<=0}:function(r){return r>=0};r.c2g=function(i){var a=r.c2l(i)-n;return(l(a)?a:0)+s},r.g2c=function(i){return r.l2c(i+n-s)},r.g2p=function(r){return r*o},r.c2p=function(n){return r.g2p(r.c2g(n))}};break;case"angularaxis":!function(r,n){var i=r.type;if("linear"===i){var o=r.d2c,c=r.c2d;r.d2c=function(r,n){var i;return i=o(r),"degrees"===n?s(i):i},r.c2d=function(r,n){return c("degrees"===n?l(r):r)}}r.makeCalcdata=function(n,o){var s,l,c=n[o],u=n._length,f=function(i){return r.d2c(i,n.thetaunit)};if(c){if(a.isTypedArray(c)&&"linear"===i){if(u===c.length)return c;if(c.subarray)return c.subarray(0,u)}for(s=Array(u),l=0;l<u;l++)s[l]=f(c[l])}else{var h=o+"0",p="d"+o,d=h in n?f(n[h]):0,m=n[p]?f(n[p]):(r.period||2*Math.PI)/u;for(s=Array(u),l=0;l<u;l++)s[l]=d+l*m}return s},r.setGeometry=function(){var o,c,u,f,h=n.sector,p=h.map(s),d={clockwise:-1,counterclockwise:1}[r.direction],m=s(r.rotation),g=function(r){return d*r+m},v=function(r){return(r-m)/d};switch(i){case"linear":c=o=a.identity,f=s,u=l,r.range=a.isFullCircle(p)?[h[0],h[0]+360]:p.map(v).map(l);break;case"category":var y=r._categories.length,x=r.period?Math.max(r.period,y):y;0===x&&(x=1),c=f=function(r){return 2*r*Math.PI/x},o=u=function(r){return r*x/Math.PI/2},r.range=[0,x]}r.c2g=function(r){return g(c(r))},r.g2c=function(r){return o(v(r))},r.t2g=function(r){return g(f(r))},r.g2t=function(r){return u(v(r))}}}(r,n)}}},{"../../lib":503,"../cartesian/set_convert":576}],627:[function(r,n,i){"use strict";n.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],628:[function(r,n,i){"use strict";function a(r){return r<0?-1:r>0?1:0}function o(r){var n=r[0],i=r[1];if(!isFinite(n)||!isFinite(i))return[1,0];var a=(n+1)*(n+1)+i*i;return[(n*n+i*i-1)/a,2*i/a]}function s(r,n){var i=n[0],a=n[1];return[i*r.radius+r.cx,-a*r.radius+r.cy]}n.exports={smith:o,reactanceArc:function(r,n,i,a){var l=s(r,o([i,n])),c=l[0],u=l[1],f=s(r,o([a,n])),h=f[0],p=f[1];if(0===n)return["M"+c+","+u,"L"+h+","+p].join(" ");var d=1/Math.abs(n)*r.radius;return["M"+c+","+u,"A"+d+","+d+" 0 0,"+(n<0?1:0)+" "+h+","+p].join(" ")},resistanceArc:function(r,n,i,l){var c=1/(n+1)*r.radius,u=s(r,o([n,i])),f=u[0],h=u[1],p=s(r,o([n,l])),d=p[0],m=p[1];if(a(i)!==a(l)){var g=s(r,o([n,0]));return["M"+f+","+h,"A"+c+","+c+" 0 0,"+(0<i?0:1)+" "+g[0]+","+g[1],"A"+c+","+c+" 0 0,"+(l<0?0:1)+d+","+m].join(" ")}return["M"+f+","+h,"A"+c+","+c+" 0 0,"+(l<i?0:1)+" "+d+","+m].join(" ")},smithTransform:s}},{}],629:[function(r,n,i){"use strict";var a=r("../get_data").getSubplotCalcData,o=r("../../lib").counterRegex,s=r("../polar/polar"),l=r("./constants"),c=l.attr,u=l.name,f=o(u),h={};h[c]={valType:"subplotid",dflt:u,editType:"calc"},n.exports={attr:c,name:u,idRoot:u,idRegex:f,attrRegex:f,attributes:h,layoutAttributes:r("./layout_attributes"),supplyLayoutDefaults:r("./layout_defaults"),plot:function(r){for(var n=r._fullLayout,i=r.calcdata,o=n._subplots[u],l=0;l<o.length;l++){var c=o[l],f=a(i,u,c),h=n[c]._subplot;h||(h=s(r,c,!0),n[c]._subplot=h),h.plot(f,n,r._promises)}},clean:function(r,n,i,a){for(var o=a._subplots[u]||[],s=0;s<o.length;s++){var l=o[s],c=a[l]._subplot;if(!n[l]&&c)for(var f in c.framework.remove(),c.clipPaths)c.clipPaths[f].remove()}},toSVG:r("../cartesian").toSVG}},{"../../lib":503,"../cartesian":568,"../get_data":593,"../polar/polar":625,"./constants":627,"./layout_attributes":630,"./layout_defaults":631}],630:[function(r,n,i){"use strict";var a=r("../../components/color/attributes"),o=r("../cartesian/layout_attributes"),s=r("../domain").attributes,l=r("../../lib").extendFlat,c=r("../../plot_api/edit_types").overrideAll,u=c({color:o.color,showline:l({},o.showline,{dflt:!0}),linecolor:o.linecolor,linewidth:o.linewidth,showgrid:l({},o.showgrid,{dflt:!0}),gridcolor:o.gridcolor,gridwidth:o.gridwidth},"plot","from-root"),f=c({ticklen:o.ticklen,tickwidth:l({},o.tickwidth,{dflt:2}),tickcolor:o.tickcolor,showticklabels:o.showticklabels,showtickprefix:o.showtickprefix,tickprefix:o.tickprefix,showticksuffix:o.showticksuffix,ticksuffix:o.ticksuffix,tickfont:o.tickfont,tickformat:o.tickformat,hoverformat:o.hoverformat,layer:o.layer},"plot","from-root"),h=l({visible:l({},o.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:l({},o.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},u,f),p=l({visible:l({},o.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:o.ticks,editType:"calc"},u,f);n.exports={domain:s({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:a.background},realaxis:h,imaginaryaxis:p,editType:"calc"}},{"../../components/color/attributes":365,"../../lib":503,"../../plot_api/edit_types":536,"../cartesian/layout_attributes":569,"../domain":584}],631:[function(r,n,i){"use strict";var a,o,s=r("../../lib"),l=r("../../components/color"),c=r("../../plot_api/plot_template"),u=r("../subplot_defaults"),f=r("../get_data").getSubplotData,h=r("../cartesian/prefix_suffix_defaults"),p=r("../cartesian/tick_label_defaults"),d=r("../cartesian/line_grid_defaults"),m=r("../cartesian/set_convert"),g=r("./layout_attributes"),v=r("./constants"),y=v.axisNames,x=(a=String,o={},function(r){var n=a?a(r):r;if(n in o)return o[n];var i=r.slice().reverse().map(function(r){return-r}).concat([0]).concat(r);return o[n]=i,i});function b(r,n,i,a){var o=i("bgcolor");a.bgColor=l.combine(o,a.paper_bgcolor);var u,b=f(a.fullData,v.name,a.id),_=a.layoutOut;function w(r,n){return i(u+"."+r,n)}for(var T=0;T<y.length;T++){u=y[T],s.isPlainObject(r[u])||(r[u]={});var k=r[u],A=c.newContainer(n,u);A._id=A._name=u,A._attr=a.id+"."+u,A._traceIndices=b.map(function(r){return r._expandedIndex});var M=w("visible");if(A.type="linear",m(A,_),h(k,A,w,A.type),M){var S,E,L,C,P="realaxis"===u;(P&&w("side"),P)?w("tickvals"):w("tickvals",x(n.realaxis.tickvals||g.realaxis.tickvals.dflt));var I=a.font||{};M&&(E=(S=w("color"))===k.color?S:I.color,L=I.size,C=I.family),p(k,A,w,A.type,{noAng:!P,noExp:!0,font:{color:E,size:L,family:C}}),s.coerce2(r,n,g,u+".ticklen"),s.coerce2(r,n,g,u+".tickwidth"),s.coerce2(r,n,g,u+".tickcolor",n.color),w("ticks")||(delete n[u].ticklen,delete n[u].tickwidth,delete n[u].tickcolor),d(k,A,w,{dfltColor:S,bgColor:a.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:g[u]}),w("layer")}w("hoverformat"),delete A.type,A._input=k}}n.exports=function(r,n,i){u(r,n,i,{noUirevision:!0,type:v.name,attributes:g,handleDefaults:b,font:n.font,paper_bgcolor:n.paper_bgcolor,fullData:i,layoutOut:n})}},{"../../components/color":366,"../../lib":503,"../../plot_api/plot_template":543,"../cartesian/line_grid_defaults":571,"../cartesian/prefix_suffix_defaults":573,"../cartesian/set_convert":576,"../cartesian/tick_label_defaults":578,"../get_data":593,"../subplot_defaults":632,"./constants":627,"./layout_attributes":630}],632:[function(r,n,i){"use strict";var a=r("../lib"),o=r("../plot_api/plot_template"),s=r("./domain").defaults;n.exports=function(r,n,i,l){var c,u,f=l.type,h=l.attributes,p=l.handleDefaults,d=l.partition||"x",m=n._subplots[f],g=m.length,v=g&&m[0].replace(/\d+$/,"");function y(r,n){return a.coerce(c,u,h,r,n)}for(var x=0;x<g;x++){var b=m[x];c=r[b]?r[b]:r[b]={},u=o.newContainer(n,b,v),l.noUirevision||y("uirevision",n.uirevision);var _={};_[d]=[x/g,(x+1)/g],s(u,n,y,_),l.id=b,p(c,u,y,l)}}},{"../lib":503,"../plot_api/plot_template":543,"./domain":584}],633:[function(r,n,i){"use strict";var a=r("../constants/docs");function o(r){var n=r.description?" "+r.description:"",i=r.keys||[];if(i.length>0){for(var a=[],o=0;o<i.length;o++)a[o]="`"+i[o]+"`";n+="Finally, the template string has access to ",n=1===i.length?"variable "+a[0]:"variables "+a.slice(0,-1).join(", ")+" and "+a.slice(-1)+"."}return n}a.FORMAT_LINK,a.DATE_FORMAT_LINK,i.hovertemplateAttrs=function(r,n){r=r||{},o(n=n||{});var i={valType:"string",dflt:"",editType:r.editType||"none"};return!1!==r.arrayOk&&(i.arrayOk=!0),i},i.texttemplateAttrs=function(r,n){r=r||{},o(n=n||{});var i={valType:"string",dflt:"",editType:r.editType||"calc"};return!1!==r.arrayOk&&(i.arrayOk=!0),i}},{"../constants/docs":474}],634:[function(r,n,i){"use strict";var a=r("./ternary"),o=r("../../plots/get_data").getSubplotCalcData,s=r("../../lib").counterRegex;i.name="ternary";var l=i.attr="subplot";i.idRoot="ternary",i.idRegex=i.attrRegex=s("ternary"),(i.attributes={})[l]={valType:"subplotid",dflt:"ternary",editType:"calc"},i.layoutAttributes=r("./layout_attributes"),i.supplyLayoutDefaults=r("./layout_defaults"),i.plot=function(r){for(var n=r._fullLayout,i=r.calcdata,s=n._subplots.ternary,l=0;l<s.length;l++){var c=s[l],u=o(i,"ternary",c),f=n[c]._subplot;f||(f=new a({id:c,graphDiv:r,container:n._ternarylayer.node()},n),n[c]._subplot=f),f.plot(u,n,r._promises)}},i.clean=function(r,n,i,a){for(var o=a._subplots.ternary||[],s=0;s<o.length;s++){var l=o[s],c=a[l]._subplot;!n[l]&&c&&(c.plotContainer.remove(),c.clipDef.remove(),c.clipDefRelative.remove(),c.layers["a-title"].remove(),c.layers["b-title"].remove(),c.layers["c-title"].remove())}}},{"../../lib":503,"../../plots/get_data":593,"./layout_attributes":635,"./layout_defaults":636,"./ternary":637}],635:[function(r,n,i){"use strict";var a=r("../../components/color/attributes"),o=r("../domain").attributes,s=r("../cartesian/layout_attributes"),l=r("../../plot_api/edit_types").overrideAll,c=r("../../lib/extend").extendFlat,u={title:{text:s.title.text,font:s.title.font},color:s.color,tickmode:s.tickmode,nticks:c({},s.nticks,{dflt:6,min:1}),tick0:s.tick0,dtick:s.dtick,tickvals:s.tickvals,ticktext:s.ticktext,ticks:s.ticks,ticklen:s.ticklen,tickwidth:s.tickwidth,tickcolor:s.tickcolor,showticklabels:s.showticklabels,showtickprefix:s.showtickprefix,tickprefix:s.tickprefix,showticksuffix:s.showticksuffix,ticksuffix:s.ticksuffix,showexponent:s.showexponent,exponentformat:s.exponentformat,minexponent:s.minexponent,separatethousands:s.separatethousands,tickfont:s.tickfont,tickangle:s.tickangle,tickformat:s.tickformat,tickformatstops:s.tickformatstops,hoverformat:s.hoverformat,showline:c({},s.showline,{dflt:!0}),linecolor:s.linecolor,linewidth:s.linewidth,showgrid:c({},s.showgrid,{dflt:!0}),gridcolor:s.gridcolor,gridwidth:s.gridwidth,layer:s.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:s._deprecated.title,titlefont:s._deprecated.titlefont}},f=n.exports=l({domain:o({name:"ternary"}),bgcolor:{valType:"color",dflt:a.background},sum:{valType:"number",dflt:1,min:0},aaxis:u,baxis:u,caxis:u},"plot","from-root");f.uirevision={valType:"any",editType:"none"},f.aaxis.uirevision=f.baxis.uirevision=f.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":365,"../../lib/extend":493,"../../plot_api/edit_types":536,"../cartesian/layout_attributes":569,"../domain":584}],636:[function(r,n,i){"use strict";var a=r("../../components/color"),o=r("../../plot_api/plot_template"),s=r("../../lib"),l=r("../subplot_defaults"),c=r("../cartesian/tick_label_defaults"),u=r("../cartesian/prefix_suffix_defaults"),f=r("../cartesian/tick_mark_defaults"),h=r("../cartesian/tick_value_defaults"),p=r("../cartesian/line_grid_defaults"),d=r("./layout_attributes"),m=["aaxis","baxis","caxis"];function g(r,n,i,l){var g,v,y,x=i("bgcolor"),b=i("sum");l.bgColor=a.combine(x,l.paper_bgcolor);for(var _=0;_<m.length;_++)v=r[g=m[_]]||{},(y=o.newContainer(n,g))._name=g,function(r,n,i,a){var o=d[n._name];function l(i,a){return s.coerce(r,n,o,i,a)}l("uirevision",a.uirevision),n.type="linear";var m=l("color"),g=m!==o.color.dflt?m:i.font.color,v=n._name.charAt(0).toUpperCase(),y="Component "+v,x=l("title.text",y);n._hovertitle=x===y?x:v,s.coerceFont(l,"title.font",{family:i.font.family,size:s.bigFont(i.font.size),color:g}),l("min"),h(r,n,l,"linear"),u(r,n,l,"linear"),c(r,n,l,"linear"),f(r,n,l,{outerTicks:!0}),l("showticklabels")&&(s.coerceFont(l,"tickfont",{family:i.font.family,size:i.font.size,color:g}),l("tickangle"),l("tickformat")),p(r,n,l,{dfltColor:m,bgColor:i.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:o}),l("hoverformat"),l("layer")}(v,y,l,n);var w=n.aaxis,T=n.baxis,k=n.caxis;w.min+T.min+k.min>=b&&(w.min=0,T.min=0,k.min=0,r.aaxis&&delete r.aaxis.min,r.baxis&&delete r.baxis.min,r.caxis&&delete r.caxis.min)}n.exports=function(r,n,i){l(r,n,i,{type:"ternary",attributes:d,handleDefaults:g,font:n.font,paper_bgcolor:n.paper_bgcolor})}},{"../../components/color":366,"../../lib":503,"../../plot_api/plot_template":543,"../cartesian/line_grid_defaults":571,"../cartesian/prefix_suffix_defaults":573,"../cartesian/tick_label_defaults":578,"../cartesian/tick_mark_defaults":579,"../cartesian/tick_value_defaults":580,"../subplot_defaults":632,"./layout_attributes":635}],637:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("tinycolor2"),s=r("../../registry"),l=r("../../lib"),c=l.strTranslate,u=l._,f=r("../../components/color"),h=r("../../components/drawing"),p=r("../cartesian/set_convert"),d=r("../../lib/extend").extendFlat,m=r("../plots"),g=r("../cartesian/axes"),v=r("../../components/dragelement"),y=r("../../components/fx"),x=r("../../components/dragelement/helpers"),b=x.freeMode,_=x.rectMode,w=r("../../components/titles"),T=r("../cartesian/select").prepSelect,k=r("../cartesian/select").selectOnClick,A=r("../cartesian/select").clearSelect,M=r("../cartesian/select").clearSelectionsCache,S=r("../cartesian/constants");function E(r,n){this.id=r.id,this.graphDiv=r.graphDiv,this.init(n),this.makeFramework(n),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}n.exports=E;var L=E.prototype;L.init=function(r){this.container=r._ternarylayer,this.defs=r._defs,this.layoutId=r._uid,this.traceHash={},this.layers={}},L.plot=function(r,n){var i=n[this.id],a=n._size;this._hasClipOnAxisFalse=!1;for(var o=0;o<r.length;o++)if(!1===r[o][0].trace.cliponaxis){this._hasClipOnAxisFalse=!0;break}this.updateLayers(i),this.adjustLayout(i,a),m.generalUpdatePerTraceModule(this.graphDiv,this,r,i),this.layers.plotbg.select("path").call(f.fill,i.bgcolor)},L.makeFramework=function(r){var n=this.graphDiv,i=r[this.id],a=this.clipId="clip"+this.layoutId+this.id,o=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=l.ensureSingleById(r._clips,"clipPath",a,function(r){r.append("path").attr("d","M0,0Z")}),this.clipDefRelative=l.ensureSingleById(r._clips,"clipPath",o,function(r){r.append("path").attr("d","M0,0Z")}),this.plotContainer=l.ensureSingle(this.container,"g",this.id),this.updateLayers(i),h.setClipUrl(this.layers.backplot,a,n),h.setClipUrl(this.layers.grids,a,n)},L.updateLayers=function(r){var n=this.layers,i=["draglayer","plotbg","backplot","grids"];"below traces"===r.aaxis.layer&&i.push("aaxis","aline"),"below traces"===r.baxis.layer&&i.push("baxis","bline"),"below traces"===r.caxis.layer&&i.push("caxis","cline"),i.push("frontplot"),"above traces"===r.aaxis.layer&&i.push("aaxis","aline"),"above traces"===r.baxis.layer&&i.push("baxis","bline"),"above traces"===r.caxis.layer&&i.push("caxis","cline");var o=this.plotContainer.selectAll("g.toplevel").data(i,String),s=["agrid","bgrid","cgrid"];o.enter().append("g").attr("class",function(r){return"toplevel "+r}).each(function(r){var i=a.select(this);n[r]=i,"frontplot"===r?i.append("g").classed("scatterlayer",!0):"backplot"===r?i.append("g").classed("maplayer",!0):"plotbg"===r?i.append("path").attr("d","M0,0Z"):"aline"===r||"bline"===r||"cline"===r?i.append("path"):"grids"===r&&s.forEach(function(r){n[r]=i.append("g").classed("grid "+r,!0)})}),o.order()};var C=Math.sqrt(4/3);L.adjustLayout=function(r,n){var i,a,o,s,l,u,m=this,g=r.domain,v=(g.x[0]+g.x[1])/2,y=(g.y[0]+g.y[1])/2,x=g.x[1]-g.x[0],b=g.y[1]-g.y[0],_=x*n.w,w=b*n.h,T=r.sum,k=r.aaxis.min,A=r.baxis.min,M=r.caxis.min;_>C*w?o=(s=w)*C:s=(o=_)/C,l=x*o/_,u=b*s/w,i=n.l+n.w*v-o/2,a=n.t+n.h*(1-y)-s/2,m.x0=i,m.y0=a,m.w=o,m.h=s,m.sum=T,m.xaxis={type:"linear",range:[k+2*M-T,T-k-2*A],domain:[v-l/2,v+l/2],_id:"x"},p(m.xaxis,m.graphDiv._fullLayout),m.xaxis.setScale(),m.xaxis.isPtWithinRange=function(r){return r.a>=m.aaxis.range[0]&&r.a<=m.aaxis.range[1]&&r.b>=m.baxis.range[1]&&r.b<=m.baxis.range[0]&&r.c>=m.caxis.range[1]&&r.c<=m.caxis.range[0]},m.yaxis={type:"linear",range:[k,T-A-M],domain:[y-u/2,y+u/2],_id:"y"},p(m.yaxis,m.graphDiv._fullLayout),m.yaxis.setScale(),m.yaxis.isPtWithinRange=function(){return!0};var S=m.yaxis.domain[0],E=m.aaxis=d({},r.aaxis,{range:[k,T-A-M],side:"left",tickangle:(+r.aaxis.tickangle||0)-30,domain:[S,S+u*C],anchor:"free",position:0,_id:"y",_length:o});p(E,m.graphDiv._fullLayout),E.setScale();var L=m.baxis=d({},r.baxis,{range:[T-k-M,A],side:"bottom",domain:m.xaxis.domain,anchor:"free",position:0,_id:"x",_length:o});p(L,m.graphDiv._fullLayout),L.setScale();var P=m.caxis=d({},r.caxis,{range:[T-k-A,M],side:"right",tickangle:(+r.caxis.tickangle||0)+30,domain:[S,S+u*C],anchor:"free",position:0,_id:"y",_length:o});p(P,m.graphDiv._fullLayout),P.setScale();var I="M"+i+","+(a+s)+"h"+o+"l-"+o/2+",-"+s+"Z";m.clipDef.select("path").attr("d",I),m.layers.plotbg.select("path").attr("d",I);var O="M0,"+s+"h"+o+"l-"+o/2+",-"+s+"Z";m.clipDefRelative.select("path").attr("d",O);var z=c(i,a);m.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",z),m.clipDefRelative.select("path").attr("transform",null);var D=c(i-L._offset,a+s);m.layers.baxis.attr("transform",D),m.layers.bgrid.attr("transform",D);var R=c(i+o/2,a)+"rotate(30)"+c(0,-E._offset);m.layers.aaxis.attr("transform",R),m.layers.agrid.attr("transform",R);var F=c(i+o/2,a)+"rotate(-30)"+c(0,-P._offset);m.layers.caxis.attr("transform",F),m.layers.cgrid.attr("transform",F),m.drawAxes(!0),m.layers.aline.select("path").attr("d",E.showline?"M"+i+","+(a+s)+"l"+o/2+",-"+s:"M0,0").call(f.stroke,E.linecolor||"#000").style("stroke-width",(E.linewidth||0)+"px"),m.layers.bline.select("path").attr("d",L.showline?"M"+i+","+(a+s)+"h"+o:"M0,0").call(f.stroke,L.linecolor||"#000").style("stroke-width",(L.linewidth||0)+"px"),m.layers.cline.select("path").attr("d",P.showline?"M"+(i+o/2)+","+a+"l"+o/2+","+s:"M0,0").call(f.stroke,P.linecolor||"#000").style("stroke-width",(P.linewidth||0)+"px"),m.graphDiv._context.staticPlot||m.initInteractions(),h.setClipUrl(m.layers.frontplot,m._hasClipOnAxisFalse?null:m.clipId,m.graphDiv)},L.drawAxes=function(r){var n=this.graphDiv,i=this.id.substr(7)+"title",a=this.layers,o=this.aaxis,s=this.baxis,l=this.caxis;if(this.drawAx(o),this.drawAx(s),this.drawAx(l),r){var c=Math.max(o.showticklabels?o.tickfont.size/2:0,(l.showticklabels?.75*l.tickfont.size:0)+("outside"===l.ticks?.87*l.ticklen:0)),f=(s.showticklabels?s.tickfont.size:0)+("outside"===s.ticks?s.ticklen:0)+3;a["a-title"]=w.draw(n,"a"+i,{propContainer:o,propName:this.id+".aaxis.title",placeholder:u(n,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-o.title.font.size/3-c,"text-anchor":"middle"}}),a["b-title"]=w.draw(n,"b"+i,{propContainer:s,propName:this.id+".baxis.title",placeholder:u(n,"Click to enter Component B title"),attributes:{x:this.x0-f,y:this.y0+this.h+.83*s.title.font.size+f,"text-anchor":"middle"}}),a["c-title"]=w.draw(n,"c"+i,{propContainer:l,propName:this.id+".caxis.title",placeholder:u(n,"Click to enter Component C title"),attributes:{x:this.x0+this.w+f,y:this.y0+this.h+.83*l.title.font.size+f,"text-anchor":"middle"}})}},L.drawAx=function(r){var n=this.graphDiv,i=r._name,a=i.charAt(0),o=r._id,s=this.layers[i],c=a+"tickLayout",u=r.ticks+String(r.ticklen)+String(r.showticklabels);this[c]!==u&&(s.selectAll("."+o+"tick").remove(),this[c]=u),r.setScale();var f=g.calcTicks(r),h=g.clipEnds(r,f),p=g.makeTransTickFn(r),d=g.getTickSigns(r)[2],m=l.deg2rad(30),v=d*(r.linewidth||1)/2,y=d*r.ticklen,x=this.w,b=this.h,_="b"===a?"M0,"+v+"l"+Math.sin(m)*y+","+Math.cos(m)*y:"M"+v+",0l"+Math.cos(m)*y+","+-Math.sin(m)*y;g.drawTicks(n,r,{vals:"inside"===r.ticks?h:f,layer:s,path:_,transFn:p,crisp:!1}),g.drawGrid(n,r,{vals:h,layer:this.layers[a+"grid"],path:{a:"M0,0l"+b+",-"+x/2,b:"M0,0l-"+x/2+",-"+b,c:"M0,0l-"+b+","+x/2}[a],transFn:p,crisp:!1}),g.drawLabels(n,r,{vals:f,layer:s,transFn:p,labelFns:g.makeLabelFns(r,0,30)})};var P=S.MINZOOM/2+.87,I="m-0.87,.5h"+P+"v3h-"+(P+5.2)+"l"+(P/2+2.6)+",-"+(.87*P+4.5)+"l2.6,1.5l-"+P/2+","+.87*P+"Z",O="m0.87,.5h-"+P+"v3h"+(P+5.2)+"l-"+(P/2+2.6)+",-"+(.87*P+4.5)+"l-2.6,1.5l"+P/2+","+.87*P+"Z",z="m0,1l"+P/2+","+.87*P+"l2.6,-1.5l-"+(P/2+2.6)+",-"+(.87*P+4.5)+"l-"+(P/2+2.6)+","+(.87*P+4.5)+"l2.6,1.5l"+P/2+",-"+.87*P+"Z",D=!0;function R(r){a.select(r).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}L.clearSelect=function(){M(this.dragOptions),A(this.dragOptions.gd)},L.initInteractions=function(){var r,n,i,a,p,d,m,g,x,w,A,M,E=this,L=E.layers.plotbg.select("path").node(),P=E.graphDiv,F=P._fullLayout._zoomlayer;function B(r){var n={};return n[E.id+".aaxis.min"]=r.a,n[E.id+".baxis.min"]=r.b,n[E.id+".caxis.min"]=r.c,n}function N(r,n){var i=P._fullLayout.clickmode;R(P),2===r&&(P.emit("plotly_doubleclick",null),s.call("_guiRelayout",P,B({a:0,b:0,c:0}))),i.indexOf("select")>-1&&1===r&&k(n,P,[E.xaxis],[E.yaxis],E.id,E.dragOptions),i.indexOf("event")>-1&&y.click(P,n,E.id)}function j(r,n){return 1-(r+(E.h-n)/Math.sqrt(3))/E.w}function U(r,n){return(r-(E.h-n)/Math.sqrt(3))/E.w}function V(o,s){var l=i+o*r,c=a+s*n,u=Math.max(0,Math.min(1,1-a/E.h,1-c/E.h)),f=Math.max(0,Math.min(1,j(i,a),j(l,c))),h=Math.max(0,Math.min(1,U(i,a),U(l,c))),v=(u/2+h)*E.w,y=(1-u/2-f)*E.w,b=(v+y)/2,_=y-v,T=(1-u)*E.h,k=T-_/C;_<S.MINZOOM?(m=p,A.attr("d",x),M.attr("d","M0,0Z")):(m={a:p.a+u*d,b:p.b+f*d,c:p.c+h*d},A.attr("d",x+"M"+v+","+T+"H"+y+"L"+b+","+k+"L"+v+","+T+"Z"),M.attr("d","M"+i+","+a+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+v+","+T+I+"M"+y+","+T+O+"M"+b+","+k+z)),w||(A.transition().style("fill",g>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),M.transition().style("opacity",1).duration(200),w=!0),P.emit("plotly_relayouting",B(m))}function H(){R(P),m!==p&&(s.call("_guiRelayout",P,B(m)),D&&P.data&&P._context.showTips&&(l.notifier(u(P,"Double-click to zoom back out"),"long"),D=!1))}function q(r,n){var i=r/E.xaxis._m,a=n/E.yaxis._m,o=[(m={a:p.a-a,b:p.b+(i+a)/2,c:p.c-(i-a)/2}).a,m.b,m.c].sort(l.sorterAsc),s=o.indexOf(m.a),u=o.indexOf(m.b),f=o.indexOf(m.c);o[0]<0&&(o[1]+o[0]/2<0?(o[2]+=o[0]+o[1],o[0]=o[1]=0):(o[2]+=o[0]/2,o[1]+=o[0]/2,o[0]=0),m={a:o[s],b:o[u],c:o[f]},n=(p.a-m.a)*E.yaxis._m,r=(p.c-m.c-p.b+m.b)*E.xaxis._m);var d=c(E.x0+r,E.y0+n);E.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",d);var g=c(-r,-n);E.clipDefRelative.select("path").attr("transform",g),E.aaxis.range=[m.a,E.sum-m.b-m.c],E.baxis.range=[E.sum-m.a-m.c,m.b],E.caxis.range=[E.sum-m.a-m.b,m.c],E.drawAxes(!1),E._hasClipOnAxisFalse&&E.plotContainer.select(".scatterlayer").selectAll(".trace").call(h.hideOutsideRangePoints,E),P.emit("plotly_relayouting",B(m))}function G(){s.call("_guiRelayout",P,B(m))}this.dragOptions={element:L,gd:P,plotinfo:{id:E.id,domain:P._fullLayout[E.id].domain,xaxis:E.xaxis,yaxis:E.yaxis},subplot:E.id,prepFn:function(s,u,h){E.dragOptions.xaxes=[E.xaxis],E.dragOptions.yaxes=[E.yaxis],r=P._fullLayout._invScaleX,n=P._fullLayout._invScaleY;var v,y,k,S=E.dragOptions.dragmode=P._fullLayout.dragmode;b(S)?E.dragOptions.minDrag=1:E.dragOptions.minDrag=void 0,"zoom"===S?(E.dragOptions.moveFn=V,E.dragOptions.clickFn=N,E.dragOptions.doneFn=H,i=u-(v=L.getBoundingClientRect()).left,a=h-v.top,P._fullLayout._calcInverseTransform(P),y=P._fullLayout._invTransform,i=(k=l.apply3DTransform(y)(i,a))[0],a=k[1],m=p={a:E.aaxis.range[0],b:E.baxis.range[1],c:E.caxis.range[1]},d=E.aaxis.range[1]-p.a,g=o(E.graphDiv._fullLayout[E.id].bgcolor).getLuminance(),x="M0,"+E.h+"L"+E.w/2+", 0L"+E.w+","+E.h+"Z",w=!1,A=F.append("path").attr("class","zoombox").attr("transform",c(E.x0,E.y0)).style({fill:g>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",x),M=F.append("path").attr("class","zoombox-corners").attr("transform",c(E.x0,E.y0)).style({fill:f.background,stroke:f.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),E.clearSelect(P)):"pan"===S?(E.dragOptions.moveFn=q,E.dragOptions.clickFn=N,E.dragOptions.doneFn=G,m=p={a:E.aaxis.range[0],b:E.baxis.range[1],c:E.caxis.range[1]},E.clearSelect(P)):(_(S)||b(S))&&T(s,u,h,E.dragOptions,S)}},L.onmousemove=function(r){y.hover(P,r,E.id),P._fullLayout._lasthover=L,P._fullLayout._hoversubplot=E.id},L.onmouseout=function(r){P._dragging||v.unhover(P,r)},v.init(this.dragOptions)}},{"../../components/color":366,"../../components/dragelement":385,"../../components/dragelement/helpers":384,"../../components/drawing":388,"../../components/fx":406,"../../components/titles":464,"../../lib":503,"../../lib/extend":493,"../../registry":638,"../cartesian/axes":554,"../cartesian/constants":561,"../cartesian/select":575,"../cartesian/set_convert":576,"../plots":619,"@plotly/d3":58,tinycolor2:312}],638:[function(r,n,i){"use strict";var a=r("./lib/loggers"),o=r("./lib/noop"),s=r("./lib/push_unique"),l=r("./lib/is_plain_object"),c=r("./lib/dom").addStyleRule,u=r("./lib/extend"),f=r("./plots/attributes"),h=r("./plots/layout_attributes"),p=u.extendFlat,d=u.extendDeepAll;function m(r){if(r.layoutAttributes){var n=r.layoutAttributes._arrayAttrRegexps;if(n)for(var a=0;a<n.length;a++)s(i.layoutArrayRegexes,n[a])}}function g(r,n){var a=i.componentsRegistry[r].schema;if(a&&a.traces){var o=a.traces[n];o&&d(i.modules[n]._module.attributes,o)}}function v(r,n){var a=i.componentsRegistry[r].schema;if(a&&a.transforms){var o=a.transforms[n];o&&d(i.transformsRegistry[n].attributes,o)}}function y(r,n){var a=i.componentsRegistry[r].schema;if(a&&a.subplots){var o=i.subplotsRegistry[n],s=o.layoutAttributes,l="subplot"===o.attr?o.name:o.attr;Array.isArray(l)&&(l=l[0]);var c=a.subplots[l];s&&c&&d(s,c)}}function x(r){return"object"==typeof r&&(r=r.type),r}i.modules={},i.allCategories={},i.allTypes=[],i.subplotsRegistry={},i.transformsRegistry={},i.componentsRegistry={},i.layoutArrayContainers=[],i.layoutArrayRegexes=[],i.traceLayoutAttributes={},i.localeRegistry={},i.apiMethodRegistry={},i.collectableSubplotTypes=null,i.register=function(r){if(i.collectableSubplotTypes=null,!r)throw Error("No argument passed to Plotly.register.");r&&!Array.isArray(r)&&(r=[r]);for(var n=0;n<r.length;n++){var o=r[n];if(!o)throw Error("Invalid module was attempted to be registered!");switch(o.moduleType){case"trace":(function(r){var n=r.name,o=r.categories,s=r.meta;if(i.modules[n])a.log("Type "+n+" already registered");else{i.subplotsRegistry[r.basePlotModule.name]||function(r){var n=r.name;if(i.subplotsRegistry[n])return void a.log("Plot type "+n+" already registered.");for(var o in m(r),i.subplotsRegistry[n]=r,i.componentsRegistry)y(o,r.name)}(r.basePlotModule);for(var l={},u=0;u<o.length;u++)l[o[u]]=!0,i.allCategories[o[u]]=!0;for(var f in i.modules[n]={_module:r,categories:l},s&&Object.keys(s).length&&(i.modules[n].meta=s),i.allTypes.push(n),i.componentsRegistry)g(f,n);r.layoutAttributes&&p(i.traceLayoutAttributes,r.layoutAttributes);var h=r.basePlotModule,d=h.name;if("mapbox"===d){var v=h.constants.styleRules;for(var x in v)c(".js-plotly-plot .plotly .mapboxgl-"+x,v[x])}"geo"!==d&&"mapbox"!==d||void 0!==window.PlotlyGeoAssets||(window.PlotlyGeoAssets={topojson:{}})}})(o);break;case"transform":(function(r){if("string"!=typeof r.name)throw Error("Transform module *name* must be a string.");var n="Transform module "+r.name,o="function"==typeof r.transform,s="function"==typeof r.calcTransform;if(!o&&!s)throw Error(n+" is missing a *transform* or *calcTransform* method.");for(var c in o&&s&&a.log([n+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),l(r.attributes)||a.log(n+" registered without an *attributes* object."),"function"!=typeof r.supplyDefaults&&a.log(n+" registered without a *supplyDefaults* method."),i.transformsRegistry[r.name]=r,i.componentsRegistry)v(c,r.name)})(o);break;case"component":(function(r){if("string"!=typeof r.name)throw Error("Component module *name* must be a string.");var n=r.name;for(var a in i.componentsRegistry[n]=r,r.layoutAttributes&&(r.layoutAttributes._isLinkedToArray&&s(i.layoutArrayContainers,n),m(r)),i.modules)g(n,a);for(var o in i.subplotsRegistry)y(n,o);for(var l in i.transformsRegistry)v(n,l);r.schema&&r.schema.layout&&d(h,r.schema.layout)})(o);break;case"locale":(function(r){var n=r.name,a=n.split("-")[0],o=r.dictionary,s=r.format,l=o&&Object.keys(o).length,c=s&&Object.keys(s).length,u=i.localeRegistry,f=u[n];if(f||(u[n]=f={}),a!==n){var h=u[a];h||(u[a]=h={}),l&&h.dictionary===f.dictionary&&(h.dictionary=o),c&&h.format===f.format&&(h.format=s)}l&&(f.dictionary=o),c&&(f.format=s)})(o);break;case"apiMethod":var u=o.name;i.apiMethodRegistry[u]=o.fn;break;default:throw Error("Invalid module was attempted to be registered!")}}},i.getModule=function(r){var n=i.modules[x(r)];return!!n&&n._module},i.traceIs=function(r,n){if("various"===(r=x(r)))return!1;var o=i.modules[r];return o||(r&&a.log("Unrecognized trace type "+r+"."),o=i.modules[f.type.dflt]),!!o.categories[n]},i.getTransformIndices=function(r,n){for(var i=[],a=r.transforms||[],o=0;o<a.length;o++)a[o].type===n&&i.push(o);return i},i.hasTransform=function(r,n){for(var i=r.transforms||[],a=0;a<i.length;a++)if(i[a].type===n)return!0;return!1},i.getComponentMethod=function(r,n){var a=i.componentsRegistry[r];return a&&a[n]||o},i.call=function(){var r=arguments[0],n=[].slice.call(arguments,1);return i.apiMethodRegistry[r].apply(null,n)}},{"./lib/dom":491,"./lib/extend":493,"./lib/is_plain_object":504,"./lib/loggers":507,"./lib/noop":512,"./lib/push_unique":518,"./plots/attributes":550,"./plots/layout_attributes":610}],639:[function(r,n,i){"use strict";var a=r("../registry"),o=r("../lib"),s=o.extendFlat,l=o.extendDeep;function c(r){var n;switch(r){case"themes__thumb":n={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":n={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:n={}}return n}n.exports=function(r,n){var i,o=r.data,u=r.layout,f=l([],o),h=l({},u,c(n.tileClass)),p=r._context||{};if(n.width&&(h.width=n.width),n.height&&(h.height=n.height),"thumbnail"===n.tileClass||"themes__thumb"===n.tileClass){h.annotations=[];var d=Object.keys(h);for(i=0;i<d.length;i++)["xaxis","yaxis","zaxis"].indexOf(d[i].slice(0,5))>-1&&(h[d[i]].title={text:""});for(i=0;i<f.length;i++){var m=f[i];m.showscale=!1,m.marker&&(m.marker.showscale=!1),a.traceIs(m,"pie-like")&&(m.textposition="none")}}if(Array.isArray(n.annotations))for(i=0;i<n.annotations.length;i++)h.annotations.push(n.annotations[i]);var g=Object.keys(h).filter(function(r){return r.match(/^scene\d*$/)});if(g.length){var v={};for("thumbnail"===n.tileClass&&(v={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),i=0;i<g.length;i++){var y=h[g[i]];y.xaxis||(y.xaxis={}),y.yaxis||(y.yaxis={}),y.zaxis||(y.zaxis={}),s(y.xaxis,v),s(y.yaxis,v),s(y.zaxis,v),y._scene=null}}var x=document.createElement("div");n.tileClass&&(x.className=n.tileClass);var b={gd:x,td:x,layout:h,data:f,config:{staticPlot:void 0===n.staticPlot||n.staticPlot,plotGlPixelRatio:void 0===n.plotGlPixelRatio?2:n.plotGlPixelRatio,displaylogo:n.displaylogo||!1,showLink:n.showLink||!1,showTips:n.showTips||!1,mapboxAccessToken:p.mapboxAccessToken}};return"transparent"!==n.setBackground&&(b.config.setBackground=n.setBackground||"opaque"),b.gd.defaultLayout=c(n.tileClass),b}},{"../lib":503,"../registry":638}],640:[function(r,n,i){"use strict";var a=r("../lib"),o=r("../plot_api/to_image"),s=r("./filesaver"),l=r("./helpers");n.exports=function(r,n){var i;return a.isPlainObject(r)||(i=a.getGraphDiv(r)),(n=n||{}).format=n.format||"png",n.width=n.width||null,n.height=n.height||null,n.imageDataOnly=!0,new Promise(function(c,u){i&&i._snapshotInProgress&&u(Error("Snapshotting already in progress.")),a.isIE()&&"svg"!==n.format&&u(Error(l.MSG_IE_BAD_FORMAT)),i&&(i._snapshotInProgress=!0);var f=o(r,n),h=n.filename||r.fn||"newplot";h+="."+n.format.replace("-","."),f.then(function(r){return i&&(i._snapshotInProgress=!1),s(r,h,n.format)}).then(function(r){c(r)}).catch(function(r){i&&(i._snapshotInProgress=!1),u(r)})})}},{"../lib":503,"../plot_api/to_image":546,"./filesaver":641,"./helpers":642}],641:[function(r,n,i){"use strict";var a=r("../lib"),o=r("./helpers");n.exports=function(r,n,i){var s=document.createElement("a"),l="download"in s;return new Promise(function(c,u){var f,h;if(a.isIE())return f=o.createBlob(r,"svg"),window.navigator.msSaveBlob(f,n),f=null,c(n);if(l)return f=o.createBlob(r,i),h=o.createObjectURL(f),s.href=h,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),o.revokeObjectURL(h),f=null,c(n);if(a.isSafari()){var p="svg"===i?",":";base64,";return o.octetStream(p+encodeURIComponent(r)),c(n)}u(Error("download error"))})}},{"../lib":503,"./helpers":642}],642:[function(r,n,i){"use strict";var a=r("../registry");i.getDelay=function(r){return r._has&&(r._has("gl3d")||r._has("gl2d")||r._has("mapbox"))?500:0},i.getRedrawFunc=function(r){return function(){a.getComponentMethod("colorbar","draw")(r)}},i.encodeSVG=function(r){return"data:image/svg+xml,"+encodeURIComponent(r)},i.encodeJSON=function(r){return"data:application/json,"+encodeURIComponent(r)};var o=window.URL||window.webkitURL;i.createObjectURL=function(r){return o.createObjectURL(r)},i.revokeObjectURL=function(r){return o.revokeObjectURL(r)},i.createBlob=function(r,n){if("svg"===n)return new window.Blob([r],{type:"image/svg+xml;charset=utf-8"});if("full-json"===n)return new window.Blob([r],{type:"application/json;charset=utf-8"});var i=function(r){for(var n=r.length,i=new ArrayBuffer(n),a=new Uint8Array(i),o=0;o<n;o++)a[o]=r.charCodeAt(o);return i}(window.atob(r));return new window.Blob([i],{type:"image/"+n})},i.octetStream=function(r){document.location.href="data:application/octet-stream"+r},i.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,i.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":638}],643:[function(r,n,i){"use strict";var a=r("./helpers"),o={getDelay:a.getDelay,getRedrawFunc:a.getRedrawFunc,clone:r("./cloneplot"),toSVG:r("./tosvg"),svgToImg:r("./svgtoimg"),toImage:r("./toimage"),downloadImage:r("./download")};n.exports=o},{"./cloneplot":639,"./download":640,"./helpers":642,"./svgtoimg":644,"./toimage":645,"./tosvg":646}],644:[function(r,n,i){"use strict";var a=r("../lib"),o=r("events").EventEmitter,s=r("./helpers");n.exports=function(r){var n=r.emitter||new o,i=new Promise(function(o,l){var c=window.Image,u=r.svg,f=r.format||"png";if(a.isIE()&&"svg"!==f){var h=Error(s.MSG_IE_BAD_FORMAT);return l(h),r.promise?i:n.emit("error",h)}var p,d,m=r.canvas,g=r.scale||1,v=r.width||300,y=r.height||150,x=g*v,b=g*y,_=m.getContext("2d"),w=new c;"svg"===f||a.isSafari()?d=s.encodeSVG(u):(p=s.createBlob(u,"svg"),d=s.createObjectURL(p)),m.width=x,m.height=b,w.onload=function(){var i;switch(p=null,s.revokeObjectURL(d),"svg"!==f&&_.drawImage(w,0,0,x,b),f){case"jpeg":i=m.toDataURL("image/jpeg");break;case"png":i=m.toDataURL("image/png");break;case"webp":i=m.toDataURL("image/webp");break;case"svg":i=d;break;default:var a="Image format is not jpeg, png, svg or webp.";if(l(Error(a)),!r.promise)return n.emit("error",a)}o(i),r.promise||n.emit("success",i)},w.onerror=function(i){if(p=null,s.revokeObjectURL(d),l(i),!r.promise)return n.emit("error",i)},w.src=d});return r.promise?i:n}},{"../lib":503,"./helpers":642,events:84}],645:[function(r,n,i){"use strict";var a=r("events").EventEmitter,o=r("../registry"),s=r("../lib"),l=r("./helpers"),c=r("./cloneplot"),u=r("./tosvg"),f=r("./svgtoimg");n.exports=function(r,n){var i=new a,h=c(r,{format:"png"}),p=h.gd;p.style.position="absolute",p.style.left="-5000px",document.body.appendChild(p);var d=l.getRedrawFunc(p);return o.call("_doPlot",p,h.data,h.layout,h.config).then(d).then(function(){setTimeout(function(){var r=u(p),a=document.createElement("canvas");a.id=s.randstr(),(i=f({format:n.format,width:p._fullLayout.width,height:p._fullLayout.height,canvas:a,emitter:i,svg:r})).clean=function(){p&&document.body.removeChild(p)}},l.getDelay(p._fullLayout))}).catch(function(r){i.emit("error",r)}),i}},{"../lib":503,"../registry":638,"./cloneplot":639,"./helpers":642,"./svgtoimg":644,"./tosvg":646,events:84}],646:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../lib"),s=r("../components/drawing"),l=r("../components/color"),c=r("../constants/xmlns_namespaces"),u=/"/g,f=RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");n.exports=function(r,n,i){var h,p,d,m,g,v=r._fullLayout,y=v._paper,x=v._toppaper,b=v.width,_=v.height;y.insert("rect",":first-child").call(s.setRect,0,0,b,_).call(l.fill,v.paper_bgcolor);var w=v._basePlotModules||[];for(m=0;m<w.length;m++){var T=w[m];T.toSVG&&T.toSVG(r)}if(x){var k=x.node().childNodes,A=Array.prototype.slice.call(k);for(m=0;m<A.length;m++){var M=A[m];M.childNodes.length&&y.node().appendChild(M)}}v._draggers&&v._draggers.remove(),y.node().style.background="",y.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var r=a.select(this);if("hidden"!==this.style.visibility&&"none"!==this.style.display){r.style({visibility:null,display:null});var n=this.style.fontFamily;n&&-1!==n.indexOf('"')&&r.style("font-family",n.replace(u,"TOBESTRIPPED"))}else r.remove()});var S=[];if(v._gradientUrlQueryParts)for(g in v._gradientUrlQueryParts)S.push(g);if(v._patternUrlQueryParts)for(g in v._patternUrlQueryParts)S.push(g);S.length&&y.selectAll(S.join(",")).each(function(){var r=a.select(this),n=this.style.fill;n&&-1!==n.indexOf("url(")&&r.style("fill",n.replace(u,"TOBESTRIPPED"));var i=this.style.stroke;i&&-1!==i.indexOf("url(")&&r.style("stroke",i.replace(u,"TOBESTRIPPED"))}),"pdf"!==n&&"eps"!==n||y.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),y.node().setAttributeNS(c.xmlns,"xmlns",c.svg),y.node().setAttributeNS(c.xmlns,"xmlns:xlink",c.xlink),"svg"===n&&i&&(y.attr("width",i*b),y.attr("height",i*_),y.attr("viewBox","0 0 "+b+" "+_));var E=(new window.XMLSerializer).serializeToString(y.node());return h=E,p=a.select("body").append("div").style({display:"none"}).html(""),d=h.replace(/(&[^;]*;)/gi,function(r){return"&lt;"===r?"&#60;":"&rt;"===r?"&#62;":-1!==r.indexOf("<")||-1!==r.indexOf(">")?"":p.html(r).text()}),p.remove(),E=(E=(E=d).replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(f,"'"),o.isIE()&&(E=(E=(E=E.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),E}},{"../components/color":366,"../components/drawing":388,"../constants/xmlns_namespaces":480,"../lib":503,"@plotly/d3":58}],647:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n){for(var i=0;i<r.length;i++)r[i].i=i;a.mergeArray(n.text,r,"tx"),a.mergeArray(n.hovertext,r,"htx");var o=n.marker;if(o){a.mergeArray(o.opacity,r,"mo",!0),a.mergeArray(o.color,r,"mc");var s=o.line;s&&(a.mergeArray(s.color,r,"mlc"),a.mergeArrayCastPositive(s.width,r,"mlw"))}}},{"../../lib":503}],648:[function(r,n,i){"use strict";var a=r("../scatter/attributes"),o=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,s=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../../plots/template_attributes").texttemplateAttrs,c=r("../../components/colorscale/attributes"),u=r("../../plots/font_attributes"),f=r("./constants"),h=r("../../components/drawing/attributes").pattern,p=r("../../lib/extend").extendFlat,d=u({editType:"calc",arrayOk:!0,colorEditType:"style"}),m=p({},a.marker.line.width,{dflt:0}),g=p({width:m,editType:"calc"},c("marker.line")),v=p({line:g,editType:"calc"},c("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:h});n.exports={x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:o("x"),yhoverformat:o("y"),text:a.text,texttemplate:l({editType:"plot"},{keys:f.eventDataKeys}),hovertext:a.hovertext,hovertemplate:s({},{keys:f.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:p({},d,{}),insidetextfont:p({},d,{}),outsidetextfont:p({},d,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:p({},a.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:v,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:a.selected.marker.opacity,color:a.selected.marker.color,editType:"style"},textfont:a.selected.textfont,editType:"style"},unselected:{marker:{opacity:a.unselected.marker.opacity,color:a.unselected.marker.color,editType:"style"},textfont:a.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"../scatter/attributes":926,"./constants":650}],649:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../plots/cartesian/align_period"),s=r("../../components/colorscale/helpers").hasColorscale,l=r("../../components/colorscale/calc"),c=r("./arrays_to_calcdata"),u=r("../scatter/calc_selection");n.exports=function(r,n){var i,f,h,p,d,m,g=a.getFromId(r,n.xaxis||"x"),v=a.getFromId(r,n.yaxis||"y"),y={msUTC:!(!n.base&&0!==n.base)};"h"===n.orientation?(i=g.makeCalcdata(n,"x",y),h=v.makeCalcdata(n,"y"),p=o(n,v,"y",h),d=!!n.yperiodalignment,m="y"):(i=v.makeCalcdata(n,"y",y),h=g.makeCalcdata(n,"x"),p=o(n,g,"x",h),d=!!n.xperiodalignment,m="x"),f=p.vals;for(var x=Math.min(f.length,i.length),b=Array(x),_=0;_<x;_++)b[_]={p:f[_],s:i[_]},d&&(b[_].orig_p=h[_],b[_][m+"End"]=p.ends[_],b[_][m+"Start"]=p.starts[_]),n.ids&&(b[_].id=String(n.ids[_]));return s(n,"marker")&&l(r,n,{vals:n.marker.color,containerStr:"marker",cLetter:"c"}),s(n,"marker.line")&&l(r,n,{vals:n.marker.line.color,containerStr:"marker.line",cLetter:"c"}),c(b,n),u(b,n),b}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../scatter/calc_selection":928,"./arrays_to_calcdata":647}],650:[function(r,n,i){"use strict";n.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],651:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib").isArrayOrTypedArray,s=r("../../constants/numerical").BADNUM,l=r("../../registry"),c=r("../../plots/cartesian/axes"),u=r("../../plots/cartesian/constraints").getAxisGroup,f=r("./sieve.js");function h(r,n,i,l,h){if(l.length){var w,T,k,A,M;switch(function(r,n){var i,s;for(i=0;i<n.length;i++){var l,c=n[i],u=c[0].trace,f="funnel"===u.type?u._base:u.base,h="h"===u.orientation?u.xcalendar:u.ycalendar,p="category"===r.type||"multicategory"===r.type?function(){return null}:r.d2c;if(o(f)){for(s=0;s<Math.min(f.length,c.length);s++)a(l=p(f[s],0,h))?(c[s].b=+l,c[s].hasB=1):c[s].b=0;for(;s<c.length;s++)c[s].b=0}else{var d=a(l=p(f,0,h));for(l=d?l:0,s=0;s<c.length;s++)c[s].b=l,d&&(c[s].hasB=1)}}}(i,l),h.mode){case"overlay":p(n,i,l,h);break;case"group":for(w=[],T=[],k=0;k<l.length;k++)void 0===(A=l[k])[0].trace.offset?T.push(A):w.push(A);T.length&&(M=new f(T,{posAxis:n,sepNegVal:!1,overlapNoMerge:!h.norm}),function(r,n,i,a){for(var o=r._fullLayout,s=i.positions,l=i.distinctPositions,c=i.minDiff,f=i.traces,h=f.length,p=s.length!==l.length,d=c*(1-a.gap),y=u(o,n._id)+f[0][0].trace.orientation,x=o._alignmentOpts[y]||{},b=0;b<h;b++){var _,w,T=f[b],k=T[0].trace,A=Object.keys((x[k.alignmentgroup]||{}).offsetGroups||{}).length,M=(_=A?d/A:p?d/h:d)*(1-(a.groupgap||0));w=A?((2*k._offsetIndex+1-A)*_-M)/2:p?((2*b+1-h)*_-M)/2:-M/2;var S=T[0].t;S.barwidth=M,S.poffset=w,S.bargroupwidth=d,S.bardelta=c}i.binWidth=f[0][0].t.barwidth/100,m(i),g(n,i),v(n,i,p)}(r,n,M,h),function(r,n){for(var i=r.traces,a=0;a<i.length;a++){var o=i[a];if(void 0===o[0].trace.base)for(var l=new f([o],{posAxis:n,sepNegVal:!0,overlapNoMerge:!0}),c=0;c<o.length;c++){var u=o[c];if(u.p!==s){var h=l.put(u.p,u.b+u.s);h&&(u.b=h)}}}}(M,n),h.norm?(x(M),b(i,M,h)):y(i,M)),w.length&&p(n,i,w,h);break;case"stack":case"relative":for(w=[],T=[],k=0;k<l.length;k++)void 0===(A=l[k])[0].trace.base?T.push(A):w.push(A);T.length&&function(r,n,i,a,o){var l=new f(a,{posAxis:n,sepNegVal:"relative"===o.mode,overlapNoMerge:!(o.norm||"stack"===o.mode||"relative"===o.mode)});d(n,l,o),function(r,n,i){var a,o,l,u,f,h,p=_(r),d=n.traces;for(u=0;u<d.length;u++)if("funnel"===(o=(a=d[u])[0].trace).type)for(f=0;f<a.length;f++)(h=a[f]).s!==s&&n.put(h.p,-.5*h.s);for(u=0;u<d.length;u++){l="funnel"===(o=(a=d[u])[0].trace).type;var m=[];for(f=0;f<a.length;f++)if((h=a[f]).s!==s){g=l?h.s:h.s+h.b;var g,v=n.put(h.p,g),y=v+g;h.b=v,h[p]=y,i.norm||(m.push(y),h.hasB&&m.push(v))}i.norm||(o._extremes[r._id]=c.findExtremes(r,m,{tozero:!0,padded:!0}))}}(i,l,o);for(var u=0;u<a.length;u++)for(var h=a[u],p=0;p<h.length;p++){var m=h[p];m.s!==s&&m.b+m.s===l.get(m.p,m.s)&&(m._outmost=!0)}o.norm&&b(i,l,o)}(0,n,i,T,h),w.length&&p(n,i,w,h)}!function(r,n){var i,o,s,l=_(n),c={},u=1/0,f=-1/0;for(i=0;i<r.length;i++)for(s=r[i],o=0;o<s.length;o++){var h=s[o].p;a(h)&&(u=Math.min(u,h),f=Math.max(f,h))}var p=1e4/(f-u),d=c.round=function(r){return String(Math.round(p*(r-u)))};for(i=0;i<r.length;i++){(s=r[i])[0].t.extents=c;var m=s[0].t.poffset,g=Array.isArray(m);for(o=0;o<s.length;o++){var v=s[o],y=v[l]-v.w/2;if(a(y)){var x=v[l]+v.w/2,b=d(v.p);c[b]?c[b]=[Math.min(y,c[b][0]),Math.max(x,c[b][1])]:c[b]=[y,x]}v.p0=v.p+(g?m[o]:m),v.p1=v.p0+v.w,v.s0=v.b,v.s1=v.s0+v.s}}}(l,n)}}function p(r,n,i,a){for(var o=0;o<i.length;o++){var s=new f([i[o]],{posAxis:r,sepNegVal:!1,overlapNoMerge:!a.norm});d(r,s,a),a.norm?(x(s),b(n,s,a)):y(n,s)}}function d(r,n,i){for(var a=n.minDiff,o=n.traces,s=a*(1-i.gap),l=s*(1-(i.groupgap||0)),c=-l/2,u=0;u<o.length;u++){var f=o[u][0].t;f.barwidth=l,f.poffset=c,f.bargroupwidth=s,f.bardelta=a}n.binWidth=o[0][0].t.barwidth/100,m(n),g(r,n),v(r,n)}function m(r){var n,i,s=r.traces;for(n=0;n<s.length;n++){var l,c=s[n],u=c[0],f=u.trace,h=u.t,p=f._offset||f.offset,d=h.poffset;if(o(p)){for(l=Array.prototype.slice.call(p,0,c.length),i=0;i<l.length;i++)a(l[i])||(l[i]=d);for(i=l.length;i<c.length;i++)l.push(d);h.poffset=l}else void 0!==p&&(h.poffset=p);var m=f._width||f.width,g=h.barwidth;if(o(m)){var v=Array.prototype.slice.call(m,0,c.length);for(i=0;i<v.length;i++)a(v[i])||(v[i]=g);for(i=v.length;i<c.length;i++)v.push(g);if(h.barwidth=v,void 0===p){for(l=[],i=0;i<c.length;i++)l.push(d+(g-v[i])/2);h.poffset=l}}else void 0!==m&&(h.barwidth=m,void 0===p&&(h.poffset=d+(g-m)/2))}}function g(r,n){for(var i=n.traces,a=_(r),o=0;o<i.length;o++)for(var s=i[o],l=s[0].t,c=l.poffset,u=Array.isArray(c),f=l.barwidth,h=Array.isArray(f),p=0;p<s.length;p++){var d=s[p],m=d.w=h?f[p]:f;d[a]=d.p+(u?c[p]:c)+m/2}}function v(r,n,i){var a=n.traces,o=n.minDiff/2;c.minDtick(r,n.minDiff,n.distinctPositions[0],i);for(var s=0;s<a.length;s++){var l,u,f,h,p=a[s],d=p[0],m=d.trace,g=[];for(h=0;h<p.length;h++)u=(l=p[h]).p-o,f=l.p+o,g.push(u,f);if(m.width||m.offset){var v=d.t,y=v.poffset,x=v.barwidth,b=Array.isArray(y),_=Array.isArray(x);for(h=0;h<p.length;h++){l=p[h];var w=b?y[h]:y,T=_?x[h]:x;f=(u=l.p+w)+T,g.push(u,f)}}m._extremes[r._id]=c.findExtremes(r,g,{padded:!1})}}function y(r,n){for(var i=n.traces,a=_(r),o=0;o<i.length;o++){for(var s=i[o],l=s[0].trace,u=[],f=!1,h=0;h<s.length;h++){var p=s[h],d=p.b,m=d+p.s;p[a]=m,u.push(m),p.hasB&&u.push(d),p.hasB&&p.b||(f=!0)}l._extremes[r._id]=c.findExtremes(r,u,{tozero:f,padded:!0})}}function x(r){for(var n=r.traces,i=0;i<n.length;i++)for(var a=n[i],o=0;o<a.length;o++){var l=a[o];l.s!==s&&r.put(l.p,l.b+l.s)}}function b(r,n,i){var o=n.traces,l=_(r),u="fraction"===i.norm?1:100,f=u/1e9,h=r.l2c(r.c2l(0)),p="stack"===i.mode?u:h;function d(n){return a(r.c2l(n))&&(n<h-f||n>p+f||!a(h))}for(var m=0;m<o.length;m++){for(var g=o[m],v=g[0].trace,y=[],x=!1,b=!1,w=0;w<g.length;w++){var T=g[w];if(T.s!==s){var k=Math.abs(u/n.get(T.p,T.s));T.b*=k,T.s*=k;var A=T.b,M=A+T.s;T[l]=M,y.push(M),b=b||d(M),T.hasB&&(y.push(A),b=b||d(A)),T.hasB&&T.b||(x=!0)}}v._extremes[r._id]=c.findExtremes(r,y,{tozero:x,padded:b})}}function _(r){return r._id.charAt(0)}n.exports={crossTraceCalc:function(r,n){for(var i=n.xaxis,a=n.yaxis,o=r._fullLayout,s=r._fullData,c=r.calcdata,u=[],f=[],p=0;p<s.length;p++){var d=s[p];if(!0===d.visible&&l.traceIs(d,"bar")&&d.xaxis===i._id&&d.yaxis===a._id&&("h"===d.orientation?u.push(c[p]):f.push(c[p]),d._computePh))for(var m=r.calcdata[p],g=0;g<m.length;g++)"function"==typeof m[g].ph0&&(m[g].ph0=m[g].ph0()),"function"==typeof m[g].ph1&&(m[g].ph1=m[g].ph1())}var v={xCat:"category"===i.type||"multicategory"===i.type,yCat:"category"===a.type||"multicategory"===a.type,mode:o.barmode,norm:o.barnorm,gap:o.bargap,groupgap:o.bargroupgap};h(r,i,a,f,v),h(r,a,i,u,v)},setGroupPositions:h}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axes":554,"../../plots/cartesian/constraints":562,"../../registry":638,"./sieve.js":661,"fast-isnumeric":190}],652:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/color"),s=r("../../registry"),l=r("../scatter/xy_defaults"),c=r("../scatter/period_defaults"),u=r("./style_defaults"),f=r("../../plots/cartesian/constraints").getAxisGroup,h=r("./attributes"),p=a.coerceFont;function d(r,n,i,a){var o=n.orientation,s=f(i,n[({v:"x",h:"y"})[o]+"axis"])+o,l=i._alignmentOpts||{},c=a("alignmentgroup"),u=l[s];u||(u=l[s]={});var h=u[c];h?h.traces.push(n):h=u[c]={traces:[n],alignmentIndex:Object.keys(u).length,offsetGroups:{}};var p=a("offsetgroup"),d=h.offsetGroups,m=d[p];p&&(m||(m=d[p]={offsetIndex:Object.keys(d).length}),n._offsetIndex=m.offsetIndex)}function m(r,n,i,o,s,l){var c=!1!==(l=l||{}).moduleHasSelected,u=!1!==l.moduleHasUnselected,f=!1!==l.moduleHasConstrain,h=!1!==l.moduleHasCliponaxis,d=!1!==l.moduleHasTextangle,m=!1!==l.moduleHasInsideanchor,g=!!l.hasPathbar,v=Array.isArray(s)||"auto"===s,y=v||"inside"===s,x=v||"outside"===s;if(y||x){var b=p(o,"textfont",i.font),_=a.extendFlat({},b),w=!(r.textfont&&r.textfont.color);if(w&&delete _.color,p(o,"insidetextfont",_),g){var T=a.extendFlat({},b);w&&delete T.color,p(o,"pathbar.textfont",T)}x&&p(o,"outsidetextfont",b),c&&o("selected.textfont.color"),u&&o("unselected.textfont.color"),f&&o("constraintext"),h&&o("cliponaxis"),d&&o("textangle"),o("texttemplate")}y&&m&&o("insidetextanchor")}n.exports={supplyDefaults:function(r,n,i,f){function p(i,o){return a.coerce(r,n,h,i,o)}if(l(r,n,f,p)){c(r,n,f,p),p("xhoverformat"),p("yhoverformat"),p("orientation",n.x&&!n.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var d=p("textposition");m(r,n,f,p,d,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),u(r,n,p,i,f);var g=(n.marker.line||{}).color,v=s.getComponentMethod("errorbars","supplyDefaults");v(r,n,g||o.defaultLine,{axis:"y"}),v(r,n,g||o.defaultLine,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(n,p)}else n.visible=!1},crossTraceDefaults:function(r,n){var i;function o(r){return a.coerce(i._input,i,h,r)}if("group"===n.barmode)for(var s=0;s<r.length;s++)"bar"===(i=r[s]).type&&(i._input,d(0,i,n,o))},handleGroupingDefaults:d,handleText:m}},{"../../components/color":366,"../../lib":503,"../../plots/cartesian/constraints":562,"../../registry":638,"../scatter/period_defaults":946,"../scatter/xy_defaults":953,"./attributes":648,"./style_defaults":663}],653:[function(r,n,i){"use strict";n.exports=function(r,n,i){return r.x="xVal"in n?n.xVal:n.x,r.y="yVal"in n?n.yVal:n.y,n.xa&&(r.xaxis=n.xa),n.ya&&(r.yaxis=n.ya),"h"===i.orientation?(r.label=r.y,r.value=r.x):(r.label=r.x,r.value=r.y),r}},{}],654:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("tinycolor2"),s=r("../../lib").isArrayOrTypedArray;i.coerceString=function(r,n,i){if("string"==typeof n){if(n||!r.noBlank)return n}else if(("number"==typeof n||!0===n)&&!r.strict)return String(n);return void 0!==i?i:r.dflt},i.coerceNumber=function(r,n,i){if(a(n)){n=+n;var o=r.min,s=r.max;if(!(void 0!==o&&n<o||void 0!==s&&n>s))return n}return void 0!==i?i:r.dflt},i.coerceColor=function(r,n,i){return o(n).isValid()?n:void 0!==i?i:r.dflt},i.coerceEnumerated=function(r,n,i){return r.coerceNumber&&(n=+n),-1!==r.values.indexOf(n)?n:void 0!==i?i:r.dflt},i.getValue=function(r,n){var i;return Array.isArray(r)?n<r.length&&(i=r[n]):i=r,i},i.getLineWidth=function(r,n){return 0<n.mlw?n.mlw:s(r.marker.line.width)?0:r.marker.line.width}},{"../../lib":503,"fast-isnumeric":190,tinycolor2:312}],655:[function(r,n,i){"use strict";var a=r("../../components/fx"),o=r("../../registry"),s=r("../../components/color"),l=r("../../lib").fillText,c=r("./helpers").getLineWidth,u=r("../../plots/cartesian/axes").hoverLabelText,f=r("../../constants/numerical").BADNUM;function h(r,n,i,o,s){var c,h,p,d,m,g,v,y=r.cd,x=y[0].trace,b=y[0].t,_="closest"===o,w="waterfall"===x.type,T=r.maxHoverDistance,k=r.maxSpikeDistance;"h"===x.orientation?(c=i,h=n,p="y",d="x",m=D,g=O):(c=n,h=i,p="x",d="y",g=D,m=O);var A=x[p+"period"];function M(r){return E(r,-1)}function S(r){return E(r,1)}function E(r,n){var i=r.w;return r[p]+n*i/2}function L(r){return r[p+"End"]-r[p+"Start"]}var C=_?M:A?function(r){return r.p-L(r)/2}:function(r){return Math.min(M(r),r.p-b.bardelta/2)},P=_?S:A?function(r){return r.p+L(r)/2}:function(r){return Math.max(S(r),r.p+b.bardelta/2)};function I(r,n,i){return s.finiteRange&&(i=0),a.inbox(r-c,n-c,i+Math.min(1,Math.abs(n-r)/v)-1)}function O(r){return I(C(r),P(r),T)}function z(r){var n=r[d];if(w){var i=Math.abs(r.rawS)||0;h>0?n+=i:h<0&&(n-=i)}return n}function D(r){var n=h,i=r.b,o=z(r);return a.inbox(i-n,o-n,T+(o-n)/(o-i)-1)}var R=r[p+"a"],F=r[d+"a"];v=Math.abs(R.r2c(R.range[1])-R.r2c(R.range[0]));var B=a.getDistanceFunction(o,m,g,function(r){return(m(r)+g(r))/2});if(a.getClosest(y,B,r),!1!==r.index&&y[r.index].p!==f){_||A||(C=function(r){return Math.min(M(r),r.p-b.bargroupwidth/2)},P=function(r){return Math.max(S(r),r.p+b.bargroupwidth/2)});var N,j,U,V=y[r.index],H=x.base?V.b+V.s:V.s;r[d+"0"]=r[d+"1"]=F.c2p(V[d],!0),r[d+"LabelVal"]=H;var q=b.extents[b.extents.round(V.p)];r[p+"0"]=R.c2p(_?C(V):q[0],!0),r[p+"1"]=R.c2p(_?P(V):q[1],!0);var G=void 0!==V.orig_p;return r[p+"LabelVal"]=G?V.orig_p:V.p,r.labelLabel=u(R,r[p+"LabelVal"],x[p+"hoverformat"]),r.valueLabel=u(F,r[d+"LabelVal"],x[d+"hoverformat"]),r.baseLabel=u(F,V.b,x[d+"hoverformat"]),r.spikeDistance=(N=h,j=V.b,U=z(V),(a.inbox(j-N,U-N,k+(U-N)/(U-j)-1)+I(M(V),S(V),k))/2),r[p+"Spike"]=R.c2p(V.p,!0),l(V,x,r),r.hovertemplate=x.hovertemplate,r}}function p(r,n){var i=n.mcc||r.marker.color,a=n.mlcc||r.marker.line.color,o=c(r,n);return s.opacity(i)?i:s.opacity(a)&&o?a:void 0}n.exports={hoverPoints:function(r,n,i,a,s){var l=h(r,n,i,a,s);if(l){var c=l.cd,u=c[0].trace,f=c[l.index];return l.color=p(u,f),o.getComponentMethod("errorbars","hoverInfo")(f,u,l),[l]}},hoverOnBars:h,getTraceColor:p}},{"../../components/color":366,"../../components/fx":406,"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"./helpers":654}],656:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc").crossTraceCalc,colorbar:r("../scatter/marker_colorbar"),arraysToCalcdata:r("./arrays_to_calcdata"),plot:r("./plot").plot,style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"bar",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":568,"../scatter/marker_colorbar":944,"./arrays_to_calcdata":647,"./attributes":648,"./calc":649,"./cross_trace_calc":651,"./defaults":652,"./event_data":653,"./hover":655,"./layout_attributes":657,"./layout_defaults":658,"./plot":659,"./select":660,"./style":662}],657:[function(r,n,i){"use strict";n.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],658:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../plots/cartesian/axes"),s=r("../../lib"),l=r("./layout_attributes");n.exports=function(r,n,i){function c(i,a){return s.coerce(r,n,l,i,a)}for(var u=!1,f=!1,h=!1,p={},d=c("barmode"),m=0;m<i.length;m++){var g=i[m];if(a.traceIs(g,"bar")&&g.visible){if(u=!0,"group"===d){var v=g.xaxis+g.yaxis;p[v]&&(h=!0),p[v]=!0}g.visible&&"histogram"===g.type&&"category"!==o.getFromId({_fullLayout:n},g["v"===g.orientation?"xaxis":"yaxis"]).type&&(f=!0)}}u?("overlay"!==d&&c("barnorm"),c("bargap",f&&!h?0:.2),c("bargroupgap")):delete n.barmode}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"./layout_attributes":657}],659:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=r("../../lib"),l=r("../../lib/svg_text_utils"),c=r("../../components/color"),u=r("../../components/drawing"),f=r("../../registry"),h=r("../../plots/cartesian/axes").tickText,p=r("./uniform_text"),d=p.recordMinTextSize,m=p.clearMinTextSize,g=r("./style"),v=r("./helpers"),y=r("./constants"),x=r("./attributes"),b=x.text,_=x.textposition,w=r("../../components/fx/helpers").appendArrayPointValue,T=y.TEXTPAD;function k(r){return r.id}function A(r,n,i,a){var o;return!n.uniformtext.mode&&M(i)?(a&&(o=a()),r.transition().duration(i.duration).ease(i.easing).each("end",function(){o&&o()}).each("interrupt",function(){o&&o()})):r}function M(r){return r&&r.duration>0}function S(r){return"auto"===r?0:r}function E(r,n){var i=Math.PI/180*n,a=Math.abs(Math.sin(i)),o=Math.abs(Math.cos(i));return{x:r.width*o+r.height*a,y:r.width*a+r.height*o}}function L(r,n,i,a,o,s){var l=!!s.isHorizontal,c=!!s.constrained,u=s.angle||0,f=s.anchor||"end",h="start"===f,p=((s.leftToRight||0)+1)/2,d=1-p,m=o.width,g=o.height,v=Math.abs(n-r),y=Math.abs(a-i),x=v>2*T&&y>2*T?T:0;v-=2*x,y-=2*x;var b=S(u);"auto"!==u||m<=v&&g<=y||!(m>v||g>y)||(m>y||g>v)&&m<g==v<y||(b+=90);var _=E(o,b),w=1;c&&(w=Math.min(1,v/_.x,y/_.y));var k=o.left*d+o.right*p,A=(o.top+o.bottom)/2,M=(r+T)*d+(n-T)*p,L=(i+a)/2,C=0,P=0;if(h||"end"===f){var I=(l?_.x:_.y)/2,O=l?r<n?1:-1:i<a?1:-1;l?h?(M=r+O*x,C=-O*I):(M=n-O*x,C=O*I):h?(L=i+O*x,P=-O*I):(L=a-O*x,P=O*I)}return{textX:k,textY:A,targetX:M,targetY:L,anchorX:C,anchorY:P,scale:w,rotate:b}}n.exports={plot:function(r,n,i,p,y,x){var C=n.xaxis,P=n.yaxis,I=r._fullLayout;y||(y={mode:I.barmode,norm:I.barmode,gap:I.bargap,groupgap:I.bargroupgap},m("bar",I));var O=s.makeTraceGroups(p,i,"trace bars").each(function(i){var f=a.select(this),p=i[0].trace,m="waterfall"===p.type,O="funnel"===p.type,z="bar"===p.type||O,D=0;m&&p.connector.visible&&"between"===p.connector.mode&&(D=p.connector.line.width/2);var R="h"===p.orientation,F=M(y),B=s.ensureSingle(f,"g","points"),N=function(r){if(r.ids)return k}(p),j=B.selectAll("g.point").data(s.identity,N);j.enter().append("g").classed("point",!0),j.exit().remove(),j.each(function(f,m){var k,M,O,B,N,j,U=a.select(this),V=(k=[],M=[],O=R?C:P,B=R?P:C,k[0]=O.c2p(f.s0,!0),M[0]=B.c2p(f.p0,!0),k[1]=O.c2p(f.s1,!0),M[1]=B.c2p(f.p1,!0),R?[k,M]:[M,k]),H=V[0][0],q=V[0][1],G=V[1][0],Y=V[1][1],W=0==(R?q-H:Y-G);if(W&&z&&v.getLineWidth(p,f)&&(W=!1),W||(W=!(o(H)&&o(q)&&o(G)&&o(Y))),f.isBlank=W,W&&(R?q=H:Y=G),D&&!W&&(R?(H-=(H<q?1:-1)*D,q+=(H<q?1:-1)*D):(G-=(G<Y?1:-1)*D,Y+=(G<Y?1:-1)*D)),"waterfall"===p.type){if(!W){var X=p[f.dir].marker;N=X.line.width,j=X.color}}else N=v.getLineWidth(p,f),j=f.mc||p.marker.color;function Z(r){var n=a.round(N/2%1,2);return 0===y.gap&&0===y.groupgap?a.round(Math.round(r)-n,2):r}if(!r._context.staticPlot){var J=1>c.opacity(j)||N>.01?Z:function(r,n,i){return i&&r===n?r:Math.abs(r-n)>=2?Z(r):r>n?Math.ceil(r):Math.floor(r)};H=J(H,q,R),q=J(q,H,R),G=J(G,Y,!R),Y=J(Y,G,!R)}var K=A(s.ensureSingle(U,"path"),I,y,x);if(K.style("vector-effect","non-scaling-stroke").attr("d",isNaN((q-H)*(Y-G))||W&&r._context.staticPlot?"M0,0Z":"M"+H+","+G+"V"+Y+"H"+q+"V"+G+"Z").call(u.setClipUrl,n.layerClipId,r),!I.uniformtext.mode&&F){var Q=u.makePointStyleFns(p);u.singlePointStyle(f,K,p,Q,r)}(function(r,n,i,a,o,c,f,p,m,y,x){var k,M,C,P,I,O,z,D,R,F,B,N,j,U,V,H,q,G,Y,W,X,Z,J,K,Q=n.xaxis,$=n.yaxis,tt=r._fullLayout;function te(n,i,a){return s.ensureSingle(n,"text").text(i).attr({class:"bartext bartext-"+K,"text-anchor":"middle","data-notex":1}).call(u.font,a).call(l.convertToTspans,r)}var tr=a[0].trace,tn="h"===tr.orientation,ti=(tp=(td=a[0].trace).texttemplate?function(r,n,i,a,o){var l,c=n[0].trace,u=s.castOption(c,i,"texttemplate");if(!u)return"";var f,p,d,m,g="waterfall"===c.type,v="funnel"===c.type;function y(r){return h(m,m.c2l(r),!0).text}"h"===c.orientation?(f="y",p=o,d="x",m=a):(f="x",p=a,d="y",m=o);var x=n[i],b={};b.label=x.p,b.labelLabel=b[f+"Label"]=(l=x.p,h(p,p.c2l(l),!0).text);var _=s.castOption(c,x.i,"text");(0===_||_)&&(b.text=_),b.value=x.s,b.valueLabel=b[d+"Label"]=y(x.s);var T={};w(T,c,x.i),g&&(b.delta=+x.rawS||x.s,b.deltaLabel=y(b.delta),b.final=x.v,b.finalLabel=y(b.final),b.initial=b.final-b.delta,b.initialLabel=y(b.initial)),v&&(b.value=x.s,b.valueLabel=y(b.value),b.percentInitial=x.begR,b.percentInitialLabel=s.formatPercent(x.begR),b.percentPrevious=x.difR,b.percentPreviousLabel=s.formatPercent(x.difR),b.percentTotal=x.sumR,b.percenTotalLabel=s.formatPercent(x.sumR));var k=s.castOption(c,x.i,"customdata");return k&&(b.customdata=k),s.texttemplateString(u,b,r._d3locale,T,b,c._meta||{})}(tt,a,o,Q,$):td.textinfo?function(r,n,i,a){var o=r[0].trace,l="h"===o.orientation,c="waterfall"===o.type,u="funnel"===o.type;function f(r){return h(l?i:a,+r,!0).text}var p,d=o.textinfo,m=r[n],g=d.split("+"),v=[],y=function(r){return -1!==g.indexOf(r)};if(y("label")&&v.push(h(l?a:i,r[n].p,!0).text),y("text")&&(0===(p=s.castOption(o,m.i,"text"))||p)&&v.push(p),c){var x=+m.rawS||m.s,b=m.v;y("initial")&&v.push(f(b-x)),y("delta")&&v.push(f(x)),y("final")&&v.push(f(b))}if(u){y("value")&&v.push(f(m.s));var _=0;y("percent initial")&&_++,y("percent previous")&&_++,y("percent total")&&_++;var w=_>1;y("percent initial")&&(p=s.formatPercent(m.begR),w&&(p+=" of initial"),v.push(p)),y("percent previous")&&(p=s.formatPercent(m.difR),w&&(p+=" of previous"),v.push(p)),y("percent total")&&(p=s.formatPercent(m.sumR),w&&(p+=" of total"),v.push(p))}return v.join("<br>")}(a,o,Q,$):v.getValue(td.text,o),v.coerceString(b,tp));tm=v.getValue(tr.textposition,o),K=v.coerceEnumerated(_,tm);var ta="stack"===y.mode||"relative"===y.mode,to=a[o],ts=!ta||to._outmost;if(!ti||"none"===K||(to.isBlank||c===f||p===m)&&("auto"===K||"inside"===K))return void i.select("text").remove();var tl=tt.font,tc=g.getBarColor(a[o],tr),tu=g.getInsideTextFont(tr,o,tl,tc),tf=g.getOutsideTextFont(tr,o,tl),th=i.datum();tn?"log"===Q.type&&th.s0<=0&&(c=Q.range[0]<Q.range[1]?0:Q._length):"log"===$.type&&th.s0<=0&&(p=$.range[0]<$.range[1]?$._length:0);var tp,td,tm,tg,tv,ty,tx,tb,t_=Math.abs(f-c)-2*T,tw=Math.abs(m-p)-2*T;if("outside"===K&&(ts||to.hasB||(K="inside")),"auto"===K){if(ts){K="inside",tg=te(i,ti,tb=s.ensureUniformFontSize(r,tu)),ty=(tv=u.bBox(tg.node())).width,tx=tv.height;var tT=ty<=t_&&tx<=tw,tk=ty<=tw&&tx<=t_,tA=tn?t_>=tw/tx*ty:tw>=t_/ty*tx;ty>0&&tx>0&&(tT||tk||tA)?K="inside":(K="outside",tg.remove(),tg=null)}else K="inside"}if(!tg){var tM=(tg=te(i,ti,tb=s.ensureUniformFontSize(r,"outside"===K?tf:tu))).attr("transform");if(tg.attr("transform",""),ty=(tv=u.bBox(tg.node())).width,tx=tv.height,tg.attr("transform",tM),ty<=0||tx<=0)return void tg.remove()}var tS,tE,tL=tr.textangle;"outside"===K?(tE="both"===tr.constraintext||"outside"===tr.constraintext,k=c,M=p,C=tv,O=!!(P={isHorizontal:tn,constrained:tE,angle:tL}).isHorizontal,z=!!P.constrained,D=P.angle||0,R=C.width,F=C.height,B=Math.abs(f-k),N=Math.abs(m-M),I=O?N>2*T?T:0:B>2*T?T:0,j=1,z&&(j=O?Math.min(1,N/F):Math.min(1,B/R)),V=E(C,U=S(D)),H=(O?V.x:V.y)/2,q=(C.left+C.right)/2,G=(C.top+C.bottom)/2,Y=(k+f)/2,W=(M+m)/2,X=0,Z=0,J=O?f<k?1:-1:M<m?1:-1,O?(Y=f-J*I,X=J*H):(W=m+J*I,Z=-J*H),tS={textX:q,textY:G,targetX:Y,targetY:W,anchorX:X,anchorY:Z,scale:j,rotate:U}):tS=L(c,f,p,m,tv,{isHorizontal:tn,constrained:tE="both"===tr.constraintext||"inside"===tr.constraintext,angle:tL,anchor:tr.insidetextanchor}),tS.fontSize=tb.size,d("histogram"===tr.type?"bar":tr.type,tS,tt),to.transform=tS,A(tg,tt,y,x).attr("transform",s.getTextTransform(tS))})(r,n,U,i,m,H,q,G,Y,y,x),n.layerClipId&&u.hideOutsideRangePoint(f,U.select("text"),C,P,p.xcalendar,p.ycalendar)});var U=!1===p.cliponaxis;u.setClipUrl(f,U?null:n.layerClipId,r)});f.getComponentMethod("errorbars","plot")(r,O,n,y)},toMoveInsideBar:L}},{"../../components/color":366,"../../components/drawing":388,"../../components/fx/helpers":402,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../registry":638,"./attributes":648,"./constants":650,"./helpers":654,"./style":662,"./uniform_text":664,"@plotly/d3":58,"fast-isnumeric":190}],660:[function(r,n,i){"use strict";n.exports=function(r,n){var i,a=r.cd,o=r.xaxis,s=r.yaxis,l=a[0].trace,c="funnel"===l.type,u="h"===l.orientation,f=[];if(!1===n)for(i=0;i<a.length;i++)a[i].selected=0;else for(i=0;i<a.length;i++){var h=a[i],p="ct"in h?h.ct:function(r,n,i,a,o){var s=n.c2p(a?r.s0:r.p0,!0),l=n.c2p(a?r.s1:r.p1,!0),c=i.c2p(a?r.p0:r.s0,!0),u=i.c2p(a?r.p1:r.s1,!0);return o?[(s+l)/2,(c+u)/2]:a?[l,(c+u)/2]:[(s+l)/2,u]}(h,o,s,u,c);n.contains(p,!1,i,r)?(f.push({pointNumber:i,x:o.c2d(h.x),y:s.c2d(h.y)}),h.selected=1):h.selected=0}return f}},{}],661:[function(r,n,i){"use strict";n.exports=s;var a=r("../../lib").distinctVals,o=r("../../constants/numerical").BADNUM;function s(r,n){this.traces=r,this.sepNegVal=n.sepNegVal,this.overlapNoMerge=n.overlapNoMerge;for(var i=1/0,s=[],l=0;l<r.length;l++){for(var c=r[l],u=0;u<c.length;u++){var f=c[u];f.p!==o&&s.push(f.p)}c[0]&&c[0].width1&&(i=Math.min(c[0].width1,i))}this.positions=s;var h=a(s);this.distinctPositions=h.vals,1===h.vals.length&&i!==1/0?this.minDiff=i:this.minDiff=Math.min(h.minDiff,i);var p=(n.posAxis||{}).type;"category"!==p&&"multicategory"!==p||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}s.prototype.put=function(r,n){var i=this.getLabel(r,n),a=this.bins[i]||0;return this.bins[i]=a+n,a},s.prototype.get=function(r,n){var i=this.getLabel(r,n);return this.bins[i]||0},s.prototype.getLabel=function(r,n){return(n<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?r:Math.round(r/this.binWidth))}},{"../../constants/numerical":479,"../../lib":503}],662:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/color"),s=r("../../components/drawing"),l=r("../../lib"),c=r("../../registry"),u=r("./uniform_text").resizeText,f=r("./attributes"),h=f.textfont,p=f.insidetextfont,d=f.outsidetextfont,m=r("./helpers");function g(r,n,i){s.pointStyle(r.selectAll("path"),n,i),v(r,n,i)}function v(r,n,i){r.selectAll("text").each(function(r){var o=a.select(this),c=l.ensureUniformFontSize(i,y(o,r,n,i));s.font(o,c)})}function y(r,n,i,a){var o=a._fullLayout.font,s=i.textfont;if(r.classed("bartext-inside")){var l=T(n,i);s=b(i,n.i,o,l)}else r.classed("bartext-outside")&&(s=_(i,n.i,o));return s}function x(r,n,i){return w(h,r.textfont,n,i)}function b(r,n,i,a){var s=x(r,n,i);return(void 0===r._input.textfont||void 0===r._input.textfont.color||Array.isArray(r.textfont.color)&&void 0===r.textfont.color[n])&&(s={color:o.contrast(a),family:s.family,size:s.size}),w(p,r.insidetextfont,n,s)}function _(r,n,i){var a=x(r,n,i);return w(d,r.outsidetextfont,n,a)}function w(r,n,i,a){n=n||{};var o=m.getValue(n.family,i),s=m.getValue(n.size,i),l=m.getValue(n.color,i);return{family:m.coerceString(r.family,o,a.family),size:m.coerceNumber(r.size,s,a.size),color:m.coerceColor(r.color,l,a.color)}}function T(r,n){return"waterfall"===n.type?n[r.dir].marker.color:r.mcc||r.mc||n.marker.color}n.exports={style:function(r){var n=a.select(r).selectAll("g.barlayer").selectAll("g.trace");u(r,n,"bar");var i=n.size(),o=r._fullLayout;n.style("opacity",function(r){return r[0].trace.opacity}).each(function(r){("stack"===o.barmode&&i>1||0===o.bargap&&0===o.bargroupgap&&!r[0].trace.marker.line.width)&&a.select(this).attr("shape-rendering","crispEdges")}),n.selectAll("g.points").each(function(n){g(a.select(this),n[0].trace,r)}),c.getComponentMethod("errorbars","style")(n)},styleTextPoints:v,styleOnSelect:function(r,n,i){var o=n[0].trace;o.selectedpoints?(s.selectedPointStyle(i.selectAll("path"),o),function(r,n,i){r.each(function(r){var o,c=a.select(this);if(r.selected){o=l.ensureUniformFontSize(i,y(c,r,n,i));var u=n.selected.textfont&&n.selected.textfont.color;u&&(o.color=u),s.font(c,o)}else s.selectedTextStyle(c,n)})}(i.selectAll("text"),o,r)):(g(i,o,r),c.getComponentMethod("errorbars","style")(i))},getInsideTextFont:b,getOutsideTextFont:_,getBarColor:T,resizeText:u}},{"../../components/color":366,"../../components/drawing":388,"../../lib":503,"../../registry":638,"./attributes":648,"./helpers":654,"./uniform_text":664,"@plotly/d3":58}],663:[function(r,n,i){"use strict";var a=r("../../components/color"),o=r("../../components/colorscale/helpers").hasColorscale,s=r("../../components/colorscale/defaults"),l=r("../../lib").coercePattern;n.exports=function(r,n,i,c,u){var f=i("marker.color",c),h=o(r,"marker");h&&s(r,n,u,i,{prefix:"marker.",cLetter:"c"}),i("marker.line.color",a.defaultLine),o(r,"marker.line")&&s(r,n,u,i,{prefix:"marker.line.",cLetter:"c"}),i("marker.line.width"),i("marker.opacity"),l(i,"marker.pattern",f,h),i("selected.marker.color"),i("unselected.marker.color")}},{"../../components/color":366,"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503}],664:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib");function s(r){return"_"+r+"Text_minsize"}n.exports={recordMinTextSize:function(r,n,i){if(i.uniformtext.mode){var a=s(r),o=i.uniformtext.minsize,l=n.scale*n.fontSize;n.hide=l<o,i[a]=i[a]||1/0,n.hide||(i[a]=Math.min(i[a],Math.max(l,o)))}},clearMinTextSize:function(r,n){n[s(r)]=void 0},resizeText:function(r,n,i){var s=r._fullLayout,l=s["_"+i+"Text_minsize"];if(l){var c,u="hide"===s.uniformtext.mode;switch(i){case"funnelarea":case"pie":case"sunburst":c="g.slice";break;case"treemap":case"icicle":c="g.slice, g.pathbar";break;default:c="g.points > g.point"}n.selectAll(c).each(function(r){var n=r.transform;n&&(n.scale=u&&n.hide?0:l/n.fontSize,a.select(this).select("text").attr("transform",o.getTextTransform(n)))})}}}},{"../../lib":503,"@plotly/d3":58}],665:[function(r,n,i){"use strict";var a=r("../../plots/template_attributes").hovertemplateAttrs,o=r("../../lib/extend").extendFlat,s=r("../scatterpolar/attributes"),l=r("../bar/attributes");n.exports={r:s.r,theta:s.theta,r0:s.r0,dr:s.dr,theta0:s.theta0,dtheta:s.dtheta,thetaunit:s.thetaunit,base:o({},l.base,{}),offset:o({},l.offset,{}),width:o({},l.width,{}),text:o({},l.text,{}),hovertext:o({},l.hovertext,{}),marker:l.marker,hoverinfo:s.hoverinfo,hovertemplate:a(),selected:l.selected,unselected:l.unselected}},{"../../lib/extend":493,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatterpolar/attributes":1e3}],666:[function(r,n,i){"use strict";var a=r("../../components/colorscale/helpers").hasColorscale,o=r("../../components/colorscale/calc"),s=r("../bar/arrays_to_calcdata"),l=r("../bar/cross_trace_calc").setGroupPositions,c=r("../scatter/calc_selection"),u=r("../../registry").traceIs,f=r("../../lib").extendFlat;n.exports={calc:function(r,n){for(var i=r._fullLayout,l=n.subplot,u=i[l].radialaxis,f=i[l].angularaxis,h=u.makeCalcdata(n,"r"),p=f.makeCalcdata(n,"theta"),d=n._length,m=Array(d),g=0;g<d;g++)m[g]={p:p[g],s:h[g]};function v(r){var i=n[r];void 0!==i&&(n["_"+r]=Array.isArray(i)?f.makeCalcdata(n,r):f.d2c(i,n.thetaunit))}return"linear"===f.type&&(v("width"),v("offset")),a(n,"marker")&&o(r,n,{vals:n.marker.color,containerStr:"marker",cLetter:"c"}),a(n,"marker.line")&&o(r,n,{vals:n.marker.line.color,containerStr:"marker.line",cLetter:"c"}),s(m,n),c(m,n),m},crossTraceCalc:function(r,n,i){for(var a=r.calcdata,o=[],s=0;s<a.length;s++){var c=a[s],h=c[0].trace;!0===h.visible&&u(h,"bar")&&h.subplot===i&&o.push(c)}var p=f({},n.radialaxis,{_id:"x"});l(r,n.angularaxis,p,o,{mode:n.barmode,norm:n.barnorm,gap:n.bargap,groupgap:n.bargroupgap})}}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"../../lib":503,"../../registry":638,"../bar/arrays_to_calcdata":647,"../bar/cross_trace_calc":651,"../scatter/calc_selection":928}],667:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatterpolar/defaults").handleRThetaDefaults,s=r("../bar/style_defaults"),l=r("./attributes");n.exports=function(r,n,i,c){function u(i,o){return a.coerce(r,n,l,i,o)}o(r,n,c,u)?(u("thetaunit"),u("base"),u("offset"),u("width"),u("text"),u("hovertext"),u("hovertemplate"),s(r,n,u,i,c),a.coerceSelectionMarkerOpacity(n,u)):n.visible=!1}},{"../../lib":503,"../bar/style_defaults":663,"../scatterpolar/defaults":1002,"./attributes":665}],668:[function(r,n,i){"use strict";var a=r("../../components/fx"),o=r("../../lib"),s=r("../bar/hover").getTraceColor,l=o.fillText,c=r("../scatterpolar/hover").makeHoverPointText,u=r("../../plots/polar/helpers").isPtInsidePolygon;n.exports=function(r,n,i){var f=r.cd,h=f[0].trace,p=r.subplot,d=p.radialAxis,m=p.angularAxis,g=p.vangles,v=g?u:o.isPtInsideSector,y=r.maxHoverDistance,x=m._period||2*Math.PI,b=Math.abs(d.g2p(Math.sqrt(n*n+i*i))),_=Math.atan2(i,n);if(d.range[0]>d.range[1]&&(_+=Math.PI),a.getClosest(f,function(r){return v(b,_,[r.rp0,r.rp1],[r.thetag0,r.thetag1],g)?y+Math.min(1,Math.abs(r.thetag1-r.thetag0)/x)-1+(r.rp1-b)/(r.rp1-r.rp0)-1:1/0},r),!1!==r.index){var w=f[r.index];r.x0=r.x1=w.ct[0],r.y0=r.y1=w.ct[1];var T=o.extendFlat({},w,{r:w.s,theta:w.p});return l(w,h,r),c(T,h,p,r),r.hovertemplate=h.hovertemplate,r.color=s(h,w),r.xLabelVal=r.yLabelVal=void 0,w.s<0&&(r.idealAlign="left"),[r]}}},{"../../components/fx":406,"../../lib":503,"../../plots/polar/helpers":621,"../bar/hover":655,"../scatterpolar/hover":1004}],669:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"barpolar",basePlotModule:r("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("../scatterpolar/format_labels"),style:r("../bar/style").style,styleOnSelect:r("../bar/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../bar/select"),meta:{}}},{"../../plots/polar":622,"../bar/select":660,"../bar/style":662,"../scatter/marker_colorbar":944,"../scatterpolar/format_labels":1003,"./attributes":665,"./calc":666,"./defaults":667,"./hover":668,"./layout_attributes":670,"./layout_defaults":671,"./plot":672}],670:[function(r,n,i){"use strict";n.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],671:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n,i){var s,l={};function c(i,l){return a.coerce(r[s]||{},n[s],o,i,l)}for(var u=0;u<i.length;u++){var f=i[u];"barpolar"===f.type&&!0===f.visible&&(l[s=f.subplot]||(c("barmode"),c("bargap"),l[s]=1))}}},{"../../lib":503,"./layout_attributes":670}],672:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("fast-isnumeric"),s=r("../../lib"),l=r("../../components/drawing"),c=r("../../plots/polar/helpers");n.exports=function(r,n,i){var u,f,h=n.xaxis,p=n.yaxis,d=n.radialAxis,m=n.angularAxis,g=(u=n.cxx,f=n.cyy,n.vangles?function(r,i,a,o){s.angleDelta(a,o)>0?(l=a,h=o):(l=o,h=a);var l,h,p=[c.findEnclosingVertexAngles(l,n.vangles)[0],(l+h)/2,c.findEnclosingVertexAngles(h,n.vangles)[1]];return c.pathPolygonAnnulus(r,i,l,h,p,u,f)}:function(r,n,i,a){return s.pathAnnulus(r,n,i,a,u,f)}),v=n.layers.frontplot.select("g.barlayer");s.makeTraceGroups(v,i,"trace bars").each(function(){var i=a.select(this),c=s.ensureSingle(i,"g","points").selectAll("g.point").data(s.identity);c.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),c.exit().remove(),c.each(function(r){var n,i=a.select(this),l=r.rp0=d.c2p(r.s0),c=r.rp1=d.c2p(r.s1),u=r.thetag0=m.c2g(r.p0),f=r.thetag1=m.c2g(r.p1);if(o(l)&&o(c)&&o(u)&&o(f)&&l!==c&&u!==f){var v=d.c2g(r.s1),y=(u+f)/2;r.ct=[h.c2p(v*Math.cos(y)),p.c2p(v*Math.sin(y))],n=g(l,c,u,f)}else n="M0,0Z";s.ensureSingle(i,"path").attr("d",n)}),l.setClipUrl(i,n._hasClipOnAxisFalse?n.clipIds.forTraces:null,r)})}},{"../../components/drawing":388,"../../lib":503,"../../plots/polar/helpers":621,"@plotly/d3":58,"fast-isnumeric":190}],673:[function(r,n,i){"use strict";var a=r("../scatter/attributes"),o=r("../bar/attributes"),s=r("../../components/color/attributes"),l=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,c=r("../../plots/template_attributes").hovertemplateAttrs,u=r("../../lib/extend").extendFlat,f=a.marker,h=f.line;n.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:l("x"),yhoverformat:l("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:u({},f.symbol,{arrayOk:!1,editType:"plot"}),opacity:u({},f.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:u({},f.size,{arrayOk:!1,editType:"calc"}),color:u({},f.color,{arrayOk:!1,editType:"style"}),line:{color:u({},h.color,{arrayOk:!1,dflt:s.defaultLine,editType:"style"}),width:u({},h.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:o.offsetgroup,alignmentgroup:o.alignmentgroup,selected:{marker:a.selected.marker,editType:"style"},unselected:{marker:a.unselected.marker,editType:"style"},text:u({},a.text,{}),hovertext:u({},a.hovertext,{}),hovertemplate:c({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":365,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatter/attributes":926}],674:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../plots/cartesian/axes"),s=r("../../plots/cartesian/align_period"),l=r("../../lib"),c=r("../../constants/numerical").BADNUM,u=l._;n.exports=function(r,n){var i,f,b,_,w,T,k,A=r._fullLayout,M=o.getFromId(r,n.xaxis||"x"),S=o.getFromId(r,n.yaxis||"y"),E=[],L="violin"===n.type?"_numViolins":"_numBoxes";"h"===n.orientation?(b=M,_="x",w=S,T="y",k=!!n.yperiodalignment):(b=S,_="y",w=M,T="x",k=!!n.xperiodalignment);var C,P,I,O,z,D,R=function(r,n,i,o){var c,u=n+"0" in r,f="d"+n in r;if(n in r||u&&f){var h=i.makeCalcdata(r,n);return[s(r,i,n,h).vals,h]}c=u?r[n+"0"]:"name"in r&&("category"===i.type||a(r.name)&&-1!==["linear","log"].indexOf(i.type)||l.isDateTime(r.name)&&"date"===i.type)?r.name:o;for(var p="multicategory"===i.type?i.r2c_just_indices(c):i.d2c(c,0,r[n+"calendar"]),d=r._length,m=Array(d),g=0;g<d;g++)m[g]=p;return[m]}(n,T,w,A[L]),F=R[0],B=R[1],N=l.distinctVals(F,w),j=N.vals,U=N.minDiff/2,V="all"===(n.boxpoints||n.points)?l.identity:function(r){return r.v<C.lf||r.v>C.uf};if(n._hasPreCompStats){var H=n[_],q=function(r){return b.d2c((n[r]||[])[i])},G=1/0,Y=-1/0;for(i=0;i<n._length;i++){var W=F[i];if(a(W)){if((C={}).pos=C[T]=W,k&&B&&(C.orig_p=B[i]),C.q1=q("q1"),C.med=q("median"),C.q3=q("q3"),P=[],H&&l.isArrayOrTypedArray(H[i]))for(f=0;f<H[i].length;f++)(D=b.d2c(H[i][f]))!==c&&(h(z={v:D,i:[i,f]},n,[i,f]),P.push(z));if(C.pts=P.sort(p),O=(I=C[_]=P.map(d)).length,C.med!==c&&C.q1!==c&&C.q3!==c&&C.med>=C.q1&&C.q3>=C.med){var X,Z=q("lowerfence");C.lf=Z!==c&&Z<=C.q1?Z:m(C,I,O);var J=q("upperfence");C.uf=J!==c&&J>=C.q3?J:g(C,I,O);var K=q("mean");C.mean=K!==c?K:O?l.mean(I,O):(C.q1+C.q3)/2;var Q=q("sd");C.sd=K!==c&&Q>=0?Q:O?l.stdev(I,O,C.mean):C.q3-C.q1,C.lo=v(C),C.uo=y(C);var $=q("notchspan");$=$!==c&&$>0?$:x(C,O),C.ln=C.med-$,C.un=C.med+$;var tt=C.lf,te=C.uf;n.boxpoints&&I.length&&(tt=Math.min(tt,I[0]),te=Math.max(te,I[O-1])),n.notched&&(tt=Math.min(tt,C.ln),te=Math.max(te,C.un)),C.min=tt,C.max=te}else l.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+C.q1,"median = "+C.med,"q3 = "+C.q3].join("\n")),X=C.med!==c?C.med:C.q1!==c?C.q3!==c?(C.q1+C.q3)/2:C.q1:C.q3!==c?C.q3:0,C.med=X,C.q1=C.q3=X,C.lf=C.uf=X,C.mean=C.sd=X,C.ln=C.un=X,C.min=C.max=X;G=Math.min(G,C.min),Y=Math.max(Y,C.max),C.pts2=P.filter(V),E.push(C)}}n._extremes[b._id]=o.findExtremes(b,[G,Y],{padded:!0})}else{var tr=b.makeCalcdata(n,_),tn=function(r,n){for(var i=r.length,a=Array(i+1),o=0;o<i;o++)a[o]=r[o]-n;return a[i]=r[i-1]+n,a}(j,U),ti=j.length,ta=function(r){for(var n=Array(r),i=0;i<r;i++)n[i]=[];return n}(ti);for(i=0;i<n._length;i++)if(a(D=tr[i])){var to=l.findBin(F[i],tn);to>=0&&to<ti&&(h(z={v:D,i:i},n,i),ta[to].push(z))}var ts=1/0,tl=-1/0,tc=n.quartilemethod,tu="exclusive"===tc,tf="inclusive"===tc;for(i=0;i<ti;i++)if(ta[i].length>0){((C={}).pos=C[T]=j[i],P=C.pts=ta[i].sort(p),O=(I=C[_]=P.map(d)).length,C.min=I[0],C.max=I[O-1],C.mean=l.mean(I,O),C.sd=l.stdev(I,O,C.mean),C.med=l.interp(I,.5),O%2&&(tu||tf))?(tu?(th=I.slice(0,O/2),tp=I.slice(O/2+1)):tf&&(th=I.slice(0,O/2+1),tp=I.slice(O/2)),C.q1=l.interp(th,.5),C.q3=l.interp(tp,.5)):(C.q1=l.interp(I,.25),C.q3=l.interp(I,.75)),C.lf=m(C,I,O),C.uf=g(C,I,O),C.lo=v(C),C.uo=y(C);var th,tp,td=x(C,O);C.ln=C.med-td,C.un=C.med+td,ts=Math.min(ts,C.ln),tl=Math.max(tl,C.un),C.pts2=P.filter(V),E.push(C)}n._extremes[b._id]=o.findExtremes(b,n.notched?tr.concat([ts,tl]):tr,{padded:!0})}return function(r,n){if(l.isArrayOrTypedArray(n.selectedpoints))for(var i=0;i<r.length;i++){for(var a=r[i].pts||[],o={},s=0;s<a.length;s++)o[a[s].i]=s;l.tagSelected(a,n,o)}}(E,n),E.length>0?(E[0].t={num:A[L],dPos:U,posLetter:T,valLetter:_,labels:{med:u(r,"median:"),min:u(r,"min:"),q1:u(r,"q1:"),q3:u(r,"q3:"),max:u(r,"max:"),mean:"sd"===n.boxmean?u(r,"mean \xb1 :"):u(r,"mean:"),lf:u(r,"lower fence:"),uf:u(r,"upper fence:")}},A[L]++,E):[{t:{empty:!0}}]};var f={text:"tx",hovertext:"htx"};function h(r,n,i){for(var a in f)l.isArrayOrTypedArray(n[a])&&(Array.isArray(i)?l.isArrayOrTypedArray(n[a][i[0]])&&(r[f[a]]=n[a][i[0]][i[1]]):r[f[a]]=n[a][i])}function p(r,n){return r.v-n.v}function d(r){return r.v}function m(r,n,i){return 0===i?r.q1:Math.min(r.q1,n[Math.min(l.findBin(2.5*r.q1-1.5*r.q3,n,!0)+1,i-1)])}function g(r,n,i){return 0===i?r.q3:Math.max(r.q3,n[Math.max(l.findBin(2.5*r.q3-1.5*r.q1,n),0)])}function v(r){return 4*r.q1-3*r.q3}function y(r){return 4*r.q3-3*r.q1}function x(r,n){return 0===n?0:1.57*(r.q3-r.q1)/Math.sqrt(n)}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"fast-isnumeric":190}],675:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../lib"),s=r("../../plots/cartesian/constraints").getAxisGroup,l=["v","h"];function c(r,n,i,l){var c,u,f,h=n.calcdata,p=n._fullLayout,d=l._id,m=d.charAt(0),g=[],v=0;for(c=0;c<i.length;c++)for(f=h[i[c]],u=0;u<f.length;u++)g.push(l.c2l(f[u].pos,!0)),v+=(f[u].pts2||[]).length;if(g.length){var y=o.distinctVals(g);"category"!==l.type&&"multicategory"!==l.type||(y.minDiff=1);var x=y.minDiff/2;a.minDtick(l,y.minDiff,y.vals[0],!0);var b=p["violin"===r?"_numViolins":"_numBoxes"],_="group"===p[r+"mode"]&&b>1,w=1-p[r+"gap"],T=1-p[r+"groupgap"];for(c=0;c<i.length;c++){var k,A,M,S,E,L,C=(f=h[i[c]])[0].trace,P=f[0].t,I=C.width,O=C.side;if(I)k=A=S=I/2,M=0;else if(k=x,_){var z=s(p,l._id)+C.orientation,D=Object.keys(((p._alignmentOpts[z]||{})[C.alignmentgroup]||{}).offsetGroups||{}).length,R=D||b;A=k*w*T/R,M=2*k*(((D?C._offsetIndex:P.num)+.5)/R-.5)*w,S=k*w/R}else A=k*w*T,M=0,S=k;P.dPos=k,P.bPos=M,P.bdPos=A,P.wHover=S;var F,B,N,j,U,V,H=M+A,q=!!I;if("positive"===O?(E=k*(I?1:.5),F=H,L=F=M):"negative"===O?(E=F=M,L=k*(I?1:.5),B=H):(E=L=k,F=B=H),(C.boxpoints||C.points)&&v>0){var G=C.pointpos,Y=C.jitter,W=C.marker.size/2,X=0;G+Y>=0&&((X=H*(G+Y))>E?(q=!0,U=W,N=X):X>F&&(U=W,N=E)),X<=E&&(N=E);var Z=0;G-Y<=0&&((Z=-H*(G-Y))>L?(q=!0,V=W,j=Z):Z>B&&(V=W,j=L)),Z<=L&&(j=L)}else N=E,j=L;var J=Array(f.length);for(u=0;u<f.length;u++)J[u]=f[u].pos;C._extremes[d]=a.findExtremes(l,J,{padded:q,vpadminus:j,vpadplus:N,vpadLinearized:!0,ppadminus:{x:V,y:U}[m],ppadplus:{x:U,y:V}[m]})}}}n.exports={crossTraceCalc:function(r,n){for(var i=r.calcdata,a=n.xaxis,o=n.yaxis,s=0;s<l.length;s++){for(var u=l[s],f="h"===u?o:a,h=[],p=0;p<i.length;p++){var d=i[p],m=d[0].t,g=d[0].trace;!0!==g.visible||"box"!==g.type&&"candlestick"!==g.type||m.empty||(g.orientation||"v")!==u||g.xaxis!==a._id||g.yaxis!==o._id||h.push(p)}c("box",r,h,f)}},setPositionOffset:c}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../plots/cartesian/constraints":562}],676:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../registry"),s=r("../../components/color"),l=r("../scatter/period_defaults"),c=r("../bar/defaults").handleGroupingDefaults,u=r("../../plots/cartesian/axis_autotype"),f=r("./attributes");function h(r,n,i,s){function l(r){var n=0;return r&&r.length&&(n+=1,a.isArrayOrTypedArray(r[0])&&r[0].length&&(n+=1)),n}function c(n){return a.validate(r[n],f[n])}var h,p=i("y"),d=i("x");if("box"===n.type){var m=i("q1"),g=i("median"),v=i("q3");n._hasPreCompStats=m&&m.length&&g&&g.length&&v&&v.length,h=Math.min(a.minRowLength(m),a.minRowLength(g),a.minRowLength(v))}var y,x,b=l(p),_=l(d),w=b&&a.minRowLength(p),T=_&&a.minRowLength(d),k=s.calendar,A={autotypenumbers:s.autotypenumbers};if(n._hasPreCompStats)switch(String(_)+String(b)){case"00":var M=c("x0")||c("dx");y=(c("y0")||c("dy"))&&!M?"h":"v",x=h;break;case"10":y="v",x=Math.min(h,T);break;case"20":y="h",x=Math.min(h,d.length);break;case"01":y="h",x=Math.min(h,w);break;case"02":y="v",x=Math.min(h,p.length);break;case"12":y="v",x=Math.min(h,T,p.length);break;case"21":y="h",x=Math.min(h,d.length,w);break;case"11":x=0;break;case"22":var S,E=!1;for(S=0;S<d.length;S++)if("category"===u(d[S],k,A)){E=!0;break}if(E)y="v",x=Math.min(h,T,p.length);else{for(S=0;S<p.length;S++)if("category"===u(p[S],k,A)){E=!0;break}E?(y="h",x=Math.min(h,d.length,w)):(y="v",x=Math.min(h,T,p.length))}}else b>0?(y="v",x=_>0?Math.min(T,w):Math.min(w)):_>0?(y="h",x=Math.min(T)):x=0;if(x){n._length=x;var L=i("orientation",y);n._hasPreCompStats?"v"===L&&0===_?(i("x0",0),i("dx",1)):"h"===L&&0===b&&(i("y0",0),i("dy",1)):"v"===L&&0===_?i("x0"):"h"===L&&0===b&&i("y0"),o.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x","y"],s)}else n.visible=!1}function p(r,n,i,o){var s=o.prefix,l=a.coerce2(r,n,f,"marker.outliercolor"),c=i("marker.line.outliercolor"),u="outliers";n._hasPreCompStats?u="all":(l||c)&&(u="suspectedoutliers");var h=i(s+"points",u);h?(i("jitter","all"===h?.3:0),i("pointpos","all"===h?-1.5:0),i("marker.symbol"),i("marker.opacity"),i("marker.size"),i("marker.color",n.line.color),i("marker.line.color"),i("marker.line.width"),"suspectedoutliers"===h&&(i("marker.line.outliercolor",n.marker.color),i("marker.line.outlierwidth")),i("selected.marker.color"),i("unselected.marker.color"),i("selected.marker.size"),i("unselected.marker.size"),i("text"),i("hovertext")):delete n.marker;var p=i("hoveron");"all"!==p&&-1===p.indexOf("points")||i("hovertemplate"),a.coerceSelectionMarkerOpacity(n,i)}n.exports={supplyDefaults:function(r,n,i,o){function c(i,o){return a.coerce(r,n,f,i,o)}if(h(r,n,c,o),!1!==n.visible){l(r,n,o,c),c("xhoverformat"),c("yhoverformat");var u=n._hasPreCompStats;u&&(c("lowerfence"),c("upperfence")),c("line.color",(r.marker||{}).color||i),c("line.width"),c("fillcolor",s.addOpacity(n.line.color,.5));var d=!1;if(u){var m=c("mean"),g=c("sd");m&&m.length&&(d=!0,g&&g.length&&(d="sd"))}c("boxmean",d),c("whiskerwidth"),c("width"),c("quartilemethod");var v=!1;if(u){var y=c("notchspan");y&&y.length&&(v=!0)}else a.validate(r.notchwidth,f.notchwidth)&&(v=!0);c("notched",v)&&c("notchwidth"),p(r,n,c,{prefix:"box"})}},crossTraceDefaults:function(r,n){var i,o;function s(r){return a.coerce(o._input,o,f,r)}for(var l=0;l<r.length;l++){var u=(o=r[l]).type;"box"!==u&&"violin"!==u||(i=o._input,"group"===n[u+"mode"]&&c(i,o,n,s))}},handleSampleDefaults:h,handlePointsDefaults:p}},{"../../components/color":366,"../../lib":503,"../../plots/cartesian/axis_autotype":555,"../../registry":638,"../bar/defaults":652,"../scatter/period_defaults":946,"./attributes":673}],677:[function(r,n,i){"use strict";n.exports=function(r,n){return n.hoverOnBox&&(r.hoverOnBox=n.hoverOnBox),"xVal"in n&&(r.x=n.xVal),"yVal"in n&&(r.y=n.yVal),n.xa&&(r.xaxis=n.xa),n.ya&&(r.yaxis=n.ya),r}},{}],678:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../lib"),s=r("../../components/fx"),l=r("../../components/color"),c=o.fillText;function u(r,n,i,c){var u,f,h,p,d,m,g,v,y,x,b,_,w,T,k=r.cd,A=r.xa,M=r.ya,S=k[0].trace,E=k[0].t,L="violin"===S.type,C=[],P=E.bdPos,I=E.wHover,O=function(r){return h.c2l(r.pos)+E.bPos-h.c2l(m)};L&&"both"!==S.side?("positive"===S.side&&(y=function(r){var n=O(r);return s.inbox(n,n+I,x)},_=P,w=0),"negative"===S.side&&(y=function(r){var n=O(r);return s.inbox(n-I,n,x)},_=0,w=P)):(y=function(r){var n=O(r);return s.inbox(n-I,n+I,x)},_=w=P),T=L?function(r){return s.inbox(r.span[0]-d,r.span[1]-d,x)}:function(r){return s.inbox(r.min-d,r.max-d,x)},"h"===S.orientation?(d=n,m=i,g=T,v=y,u="y",h=M,f="x",p=A):(d=i,m=n,g=y,v=T,u="x",h=A,f="y",p=M);var z=Math.min(1,P/Math.abs(h.r2c(h.range[1])-h.r2c(h.range[0])));function D(r){return(g(r)+v(r))/2}x=r.maxHoverDistance-z,b=r.maxSpikeDistance-z;var R=s.getDistanceFunction(c,g,v,D);if(s.getClosest(k,R,r),!1===r.index)return[];var F=k[r.index],B=S.line.color,N=(S.marker||{}).color;l.opacity(B)&&S.line.width?r.color=B:l.opacity(N)&&S.boxpoints?r.color=N:r.color=S.fillcolor,r[u+"0"]=h.c2p(F.pos+E.bPos-w,!0),r[u+"1"]=h.c2p(F.pos+E.bPos+_,!0),r[u+"LabelVal"]=void 0!==F.orig_p?F.orig_p:F.pos;var j=u+"Spike";r.spikeDistance=D(F)*b/x,r[j]=h.c2p(F.pos,!0);var U={},V=["med","q1","q3","min","max"];(S.boxmean||(S.meanline||{}).visible)&&V.push("mean"),(S.boxpoints||S.points)&&V.push("lf","uf");for(var H=0;H<V.length;H++){var q=V[H];if(q in F&&!(F[q]in U)){U[F[q]]=!0;var G=F[q],Y=p.c2p(G,!0),W=o.extendFlat({},r);W.attr=q,W[f+"0"]=W[f+"1"]=Y,W[f+"LabelVal"]=G,W[f+"Label"]=(E.labels?E.labels[q]+" ":"")+a.hoverLabelText(p,G,S[f+"hoverformat"]),W.hoverOnBox=!0,"mean"===q&&"sd"in F&&"sd"===S.boxmean&&(W[f+"err"]=F.sd),r.name="",r.spikeDistance=void 0,r[j]=void 0,W.hovertemplate=!1,C.push(W)}}return C}function f(r,n,i){for(var a,l,u,f=r.cd,h=r.xa,p=r.ya,d=f[0].trace,m=h.c2p(n),g=p.c2p(i),v=s.quadrature(function(r){var n=Math.max(3,r.mrc||0);return Math.max(Math.abs(h.c2p(r.x)-m)-n,1-3/n)},function(r){var n=Math.max(3,r.mrc||0);return Math.max(Math.abs(p.c2p(r.y)-g)-n,1-3/n)}),y=!1,x=0;x<f.length;x++){l=f[x];for(var b=0;b<(l.pts||[]).length;b++){var _=v(u=l.pts[b]);_<=r.distance&&(r.distance=_,y=[x,b])}}if(!y)return!1;u=(l=f[y[0]]).pts[y[1]];var w=h.c2p(u.x,!0),T=p.c2p(u.y,!0),k=u.mrc||1;a=o.extendFlat({},r,{index:u.i,color:(d.marker||{}).color,name:d.name,x0:w-k,x1:w+k,y0:T-k,y1:T+k,spikeDistance:r.distance,hovertemplate:d.hovertemplate});var A,M=l.orig_p,S=void 0!==M?M:l.pos;return"h"===d.orientation?(A=p,a.xLabelVal=u.x,a.yLabelVal=S):(A=h,a.xLabelVal=S,a.yLabelVal=u.y),a[A._id.charAt(0)+"Spike"]=A.c2p(l.pos,!0),c(u,d,a),a}n.exports={hoverPoints:function(r,n,i,a){var o,s=r.cd[0].trace.hoveron,l=[];return -1!==s.indexOf("boxes")&&(l=l.concat(u(r,n,i,a))),-1!==s.indexOf("points")&&(o=f(r,n,i)),"closest"===a?o?[o]:l:(o&&l.push(o),l)},hoverOnBoxes:u,hoverOnPoints:f}},{"../../components/color":366,"../../components/fx":406,"../../lib":503,"../../plots/cartesian/axes":554}],679:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults").supplyLayoutDefaults,calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc").crossTraceCalc,plot:r("./plot").plot,style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"box",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"./attributes":673,"./calc":674,"./cross_trace_calc":675,"./defaults":676,"./event_data":677,"./hover":678,"./layout_attributes":680,"./layout_defaults":681,"./plot":682,"./select":683,"./style":684}],680:[function(r,n,i){"use strict";n.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],681:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("./layout_attributes");function l(r,n,i,o,s){for(var l=s+"Layout",c=!1,u=0;u<i.length;u++){var f=i[u];if(a.traceIs(f,l)){c=!0;break}}c&&(o(s+"mode"),o(s+"gap"),o(s+"groupgap"))}n.exports={supplyLayoutDefaults:function(r,n,i){l(0,0,i,function(i,a){return o.coerce(r,n,s,i,a)},"box")},_supply:l}},{"../../lib":503,"../../registry":638,"./layout_attributes":680}],682:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../components/drawing");function l(r,n,i,s){var l,c,u="h"===i.orientation,f=n.val,h=n.pos,p=!!h.rangebreaks,d=s.bPos,m=s.wdPos||0,g=s.bPosPxOffset||0,v=i.whiskerwidth||0,y=i.notched||!1,x=y?1-2*i.notchwidth:1;Array.isArray(s.bdPos)?(l=s.bdPos[0],c=s.bdPos[1]):(l=s.bdPos,c=s.bdPos);var b=r.selectAll("path.box").data("violin"!==i.type||i.box.visible?o.identity:[]);b.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),b.exit().remove(),b.each(function(r){if(r.empty)return"M0,0Z";var n=h.c2l(r.pos+d,!0),s=h.l2p(n-l)+g,b=h.l2p(n+c)+g,_=p?(s+b)/2:h.l2p(n)+g,w=i.whiskerwidth,T=p?s*w+(1-w)*_:h.l2p(n-m)+g,k=p?b*w+(1-w)*_:h.l2p(n+m)+g,A=h.l2p(n-l*x)+g,M=h.l2p(n+c*x)+g,S=f.c2p(r.q1,!0),E=f.c2p(r.q3,!0),L=o.constrain(f.c2p(r.med,!0),Math.min(S,E)+1,Math.max(S,E)-1),C=void 0===r.lf||!1===i.boxpoints,P=f.c2p(C?r.min:r.lf,!0),I=f.c2p(C?r.max:r.uf,!0),O=f.c2p(r.ln,!0),z=f.c2p(r.un,!0);u?a.select(this).attr("d","M"+L+","+A+"V"+M+"M"+S+","+s+"V"+b+(y?"H"+O+"L"+L+","+M+"L"+z+","+b:"")+"H"+E+"V"+s+(y?"H"+z+"L"+L+","+A+"L"+O+","+s:"")+"ZM"+S+","+_+"H"+P+"M"+E+","+_+"H"+I+(0===v?"":"M"+P+","+T+"V"+k+"M"+I+","+T+"V"+k)):a.select(this).attr("d","M"+A+","+L+"H"+M+"M"+s+","+S+"H"+b+(y?"V"+O+"L"+M+","+L+"L"+b+","+z:"")+"V"+E+"H"+s+(y?"V"+z+"L"+A+","+L+"L"+s+","+O:"")+"ZM"+_+","+S+"V"+P+"M"+_+","+E+"V"+I+(0===v?"":"M"+T+","+P+"H"+k+"M"+T+","+I+"H"+k))})}function c(r,n,i,a){var l=n.x,c=n.y,u=a.bdPos,f=a.bPos,h=i.boxpoints||i.points;o.seedPseudoRandom();var p=r.selectAll("g.points").data(h?function(r){return r.forEach(function(r){r.t=a,r.trace=i}),r}:[]);p.enter().append("g").attr("class","points"),p.exit().remove();var d=p.selectAll("path").data(function(r){var n,a,s=r.pts2,l=Math.max((r.max-r.min)/10,r.q3-r.q1),c=1e-9*l,p=.01*l,d=[],m=0;if(i.jitter){if(0===l)for(m=1,d=Array(s.length),n=0;n<s.length;n++)d[n]=1;else for(n=0;n<s.length;n++){var g=Math.max(0,n-5),v=s[g].v,y=Math.min(s.length-1,n+5),x=s[y].v;"all"!==h&&(s[n].v<r.lf?x=Math.min(x,r.lf):v=Math.max(v,r.uf));var b=Math.sqrt(p*(y-g)/(x-v+c))||0;b=o.constrain(Math.abs(b),0,1),d.push(b),m=Math.max(b,m)}a=2*i.jitter/(m||1)}for(n=0;n<s.length;n++){var _=s[n],w=_.v,T=i.jitter?a*d[n]*(o.pseudoRandom()-.5):0,k=r.pos+f+u*(i.pointpos+T);"h"===i.orientation?(_.y=k,_.x=w):(_.x=k,_.y=w),"suspectedoutliers"===h&&w<r.uo&&w>r.lo&&(_.so=!0)}return s});d.enter().append("path").classed("point",!0),d.exit().remove(),d.call(s.translatePoints,l,c)}function u(r,n,i,s){var l,c,u=n.val,f=n.pos,h=!!f.rangebreaks,p=s.bPos,d=s.bPosPxOffset||0,m=i.boxmean||(i.meanline||{}).visible;Array.isArray(s.bdPos)?(l=s.bdPos[0],c=s.bdPos[1]):(l=s.bdPos,c=s.bdPos);var g=r.selectAll("path.mean").data("box"===i.type&&i.boxmean||"violin"===i.type&&i.box.visible&&i.meanline.visible?o.identity:[]);g.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),g.exit().remove(),g.each(function(r){var n=f.c2l(r.pos+p,!0),o=f.l2p(n-l)+d,s=f.l2p(n+c)+d,g=h?(o+s)/2:f.l2p(n)+d,v=u.c2p(r.mean,!0),y=u.c2p(r.mean-r.sd,!0),x=u.c2p(r.mean+r.sd,!0);"h"===i.orientation?a.select(this).attr("d","M"+v+","+o+"V"+s+("sd"===m?"m0,0L"+y+","+g+"L"+v+","+o+"L"+x+","+g+"Z":"")):a.select(this).attr("d","M"+o+","+v+"H"+s+("sd"===m?"m0,0L"+g+","+y+"L"+o+","+v+"L"+g+","+x+"Z":""))})}n.exports={plot:function(r,n,i,s){var f=n.xaxis,h=n.yaxis;o.makeTraceGroups(s,i,"trace boxes").each(function(r){var n,i,o=a.select(this),s=r[0],p=s.t,d=s.trace;(p.wdPos=p.bdPos*d.whiskerwidth,!0!==d.visible||p.empty)?o.remove():("h"===d.orientation?(n=h,i=f):(n=f,i=h),l(o,{pos:n,val:i},d,p),c(o,{x:f,y:h},d,p),u(o,{pos:n,val:i},d,p))})},plotBoxAndWhiskers:l,plotPoints:c,plotBoxMean:u}},{"../../components/drawing":388,"../../lib":503,"@plotly/d3":58}],683:[function(r,n,i){"use strict";n.exports=function(r,n){var i,a,o=r.cd,s=r.xaxis,l=r.yaxis,c=[];if(!1===n)for(i=0;i<o.length;i++)for(a=0;a<(o[i].pts||[]).length;a++)o[i].pts[a].selected=0;else for(i=0;i<o.length;i++)for(a=0;a<(o[i].pts||[]).length;a++){var u=o[i].pts[a],f=s.c2p(u.x),h=l.c2p(u.y);n.contains([f,h],null,u.i,r)?(c.push({pointNumber:u.i,x:s.c2d(u.x),y:l.c2d(u.y)}),u.selected=1):u.selected=0}return c}},{}],684:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/color"),s=r("../../components/drawing");n.exports={style:function(r,n,i){var l=i||a.select(r).selectAll("g.trace.boxes");l.style("opacity",function(r){return r[0].trace.opacity}),l.each(function(n){var i=a.select(this),l=n[0].trace,c=l.line.width;function u(r,n,i,a){r.style("stroke-width",n+"px").call(o.stroke,i).call(o.fill,a)}var f=i.selectAll("path.box");if("candlestick"===l.type)f.each(function(r){if(!r.empty){var n=a.select(this),i=l[r.dir];u(n,i.line.width,i.line.color,i.fillcolor),n.style("opacity",l.selectedpoints&&!r.selected?.3:1)}});else{u(f,c,l.line.color,l.fillcolor),i.selectAll("path.mean").style({"stroke-width":c,"stroke-dasharray":2*c+"px,"+c+"px"}).call(o.stroke,l.line.color);var h=i.selectAll("path.point");s.pointStyle(h,l,r)}})},styleOnSelect:function(r,n,i){var a=n[0].trace,o=i.selectAll("path.point");a.selectedpoints?s.selectedPointStyle(o,a):s.pointStyle(o,a,r)}}},{"../../components/color":366,"../../components/drawing":388,"@plotly/d3":58}],685:[function(r,n,i){"use strict";var a=r("../../lib").extendFlat,o=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,s=r("../ohlc/attributes"),l=r("../box/attributes");function c(r){return{line:{color:a({},l.line.color,{dflt:r}),width:l.line.width,editType:"style"},fillcolor:l.fillcolor,editType:"style"}}n.exports={xperiod:s.xperiod,xperiod0:s.xperiod0,xperiodalignment:s.xperiodalignment,xhoverformat:o("x"),yhoverformat:o("y"),x:s.x,open:s.open,high:s.high,low:s.low,close:s.close,line:{width:a({},l.line.width,{}),editType:"style"},increasing:c(s.increasing.line.color.dflt),decreasing:c(s.decreasing.line.color.dflt),text:s.text,hovertext:s.hovertext,whiskerwidth:a({},l.whiskerwidth,{dflt:0}),hoverlabel:s.hoverlabel}},{"../../lib":503,"../../plots/cartesian/axis_format_attributes":557,"../box/attributes":673,"../ohlc/attributes":872}],686:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("../../plots/cartesian/align_period"),l=r("../ohlc/calc").calcCommon;function c(r,n,i,a){return{min:i,q1:Math.min(r,a),med:a,q3:Math.max(r,a),max:n}}n.exports=function(r,n){var i=r._fullLayout,u=o.getFromId(r,n.xaxis),f=o.getFromId(r,n.yaxis),h=u.makeCalcdata(n,"x"),p=s(n,u,"x",h).vals,d=l(r,n,h,p,f,c);return d.length?(a.extendFlat(d[0].t,{num:i._numBoxes,dPos:a.distinctVals(p).minDiff/2,posLetter:"x",valLetter:"y"}),i._numBoxes++,d):[{t:{empty:!0}}]}},{"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../ohlc/calc":873}],687:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/color"),s=r("../ohlc/ohlc_defaults"),l=r("../scatter/period_defaults"),c=r("./attributes");function u(r,n,i,a){var s=i(a+".line.color");i(a+".line.width",n.line.width),i(a+".fillcolor",o.addOpacity(s,.5))}n.exports=function(r,n,i,o){function f(i,o){return a.coerce(r,n,c,i,o)}s(r,n,f,o)?(l(r,n,o,f,{x:!0}),f("xhoverformat"),f("yhoverformat"),f("line.width"),u(r,n,f,"increasing"),u(r,n,f,"decreasing"),f("text"),f("hovertext"),f("whiskerwidth"),o._requestRangeslider[n.xaxis]=!0):n.visible=!1}},{"../../components/color":366,"../../lib":503,"../ohlc/ohlc_defaults":877,"../scatter/period_defaults":946,"./attributes":685}],688:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"candlestick",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:r("./attributes"),layoutAttributes:r("../box/layout_attributes"),supplyLayoutDefaults:r("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:r("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("../box/plot").plot,layerName:"boxlayer",style:r("../box/style").style,hoverPoints:r("../ohlc/hover").hoverPoints,selectPoints:r("../ohlc/select")}},{"../../plots/cartesian":568,"../box/cross_trace_calc":675,"../box/layout_attributes":680,"../box/layout_defaults":681,"../box/plot":682,"../box/style":684,"../ohlc/hover":875,"../ohlc/select":879,"./attributes":685,"./calc":686,"./defaults":687}],689:[function(r,n,i){"use strict";var a=r("./axis_defaults"),o=r("../../plot_api/plot_template");n.exports=function(r,n,i,s,l){s("a")||(s("da"),s("a0")),s("b")||(s("db"),s("b0")),["aaxis","baxis"].forEach(function(s){var c=s.charAt(0),u=r[s]||{},f=o.newContainer(n,s);a(u,f,{tickfont:"x",id:c+"axis",letter:c,font:n.font,name:s,data:r[c],calendar:n.calendar,dfltColor:l,bgColor:i.paper_bgcolor,autotypenumbersDflt:i.autotypenumbers,fullLayout:i}),f._categories=f._categories||[],r[s]||"-"===u.type||(r[s]={type:u.type})})}},{"../../plot_api/plot_template":543,"./axis_defaults":694}],690:[function(r,n,i){"use strict";var a=r("../../lib").isArrayOrTypedArray;n.exports=function(r){return function r(n,i){if(!a(n)||i>=10)return null;for(var o=1/0,s=-1/0,l=n.length,c=0;c<l;c++){var u=n[c];if(a(u)){var f=r(u,i+1);f&&(o=Math.min(f[0],o),s=Math.max(f[1],s))}else o=Math.min(u,o),s=Math.max(u,s)}return[o,s]}(r,0)}},{"../../lib":503}],691:[function(r,n,i){"use strict";var a=r("../../plots/font_attributes"),o=r("./axis_attributes"),s=r("../../components/color/attributes"),l=a({editType:"calc"});l.family.dflt='"Open Sans", verdana, arial, sans-serif',l.size.dflt=12,l.color.dflt=s.defaultLine,n.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:o,baxis:o,font:l,color:{valType:"color",dflt:s.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":365,"../../plots/font_attributes":585,"./axis_attributes":693}],692:[function(r,n,i){"use strict";var a=r("../../lib").isArrayOrTypedArray;n.exports=function(r,n,i,o){var s,l,c,u,f,h,p,d,m,g,v,y,x,b=a(i)?"a":"b",_=("a"===b?r.aaxis:r.baxis).smoothing,w="a"===b?r.a2i:r.b2j,T="a"===b?i:o,k="a"===b?o:i,A="a"===b?n.a.length:n.b.length,M="a"===b?n.b.length:n.a.length,S=Math.floor("a"===b?r.b2j(k):r.a2i(k)),E="a"===b?function(n){return r.evalxy([],n,S)}:function(n){return r.evalxy([],S,n)};_&&(c=Math.max(0,Math.min(M-2,S)),u=S-c,l="a"===b?function(n,i){return r.dxydi([],n,c,i,u)}:function(n,i){return r.dxydj([],c,n,u,i)});var L=w(T[0]),C=w(T[1]),P=L<C?1:-1,I=1e-8*(C-L),O=P>0?Math.floor:Math.ceil,z=P>0?Math.ceil:Math.floor,D=P>0?Math.min:Math.max,R=P>0?Math.max:Math.min,F=O(L+I),B=z(C-I),N=[[p=E(L)]];for(s=F;s*P<B*P;s+=P)f=[],v=R(L,s),x=(y=D(C,s+P))-v,h=Math.max(0,Math.min(A-2,Math.floor(.5*(v+y)))),d=E(y),_&&(m=l(h,v-h),g=l(h,y-h),f.push([p[0]+m[0]/3*x,p[1]+m[1]/3*x]),f.push([d[0]-g[0]/3*x,d[1]-g[1]/3*x])),f.push(d),N.push(f),p=d;return N}},{"../../lib":503}],693:[function(r,n,i){"use strict";var a=r("../../plots/font_attributes"),o=r("../../components/color/attributes"),s=r("../../plots/cartesian/layout_attributes"),l=r("../../plots/cartesian/axis_format_attributes").descriptionWithDates,c=r("../../plot_api/edit_types").overrideAll;n.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:a({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:s.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:a({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:l("tick label")},tickformatstops:c(s.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:o.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:o.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:a({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":365,"../../plot_api/edit_types":536,"../../plots/cartesian/axis_format_attributes":557,"../../plots/cartesian/layout_attributes":569,"../../plots/font_attributes":585}],694:[function(r,n,i){"use strict";var a=r("./attributes"),o=r("../../components/color").addOpacity,s=r("../../registry"),l=r("../../lib"),c=r("../../plots/cartesian/tick_value_defaults"),u=r("../../plots/cartesian/tick_label_defaults"),f=r("../../plots/cartesian/prefix_suffix_defaults"),h=r("../../plots/cartesian/category_order_defaults"),p=r("../../plots/cartesian/set_convert"),d=r("../../plots/cartesian/axis_autotype");n.exports=function(r,n,i){var m=i.letter,g=i.font||{},v=a[m+"axis"];function y(i,a){return l.coerce(r,n,v,i,a)}function x(i,a){return l.coerce2(r,n,v,i,a)}i.name&&(n._name=i.name,n._id=i.name),y("autotypenumbers",i.autotypenumbersDflt);var b=y("type");"-"===b&&(i.data&&function(r,n){if("-"===r.type){var i=r._id.charAt(0),a=r[i+"calendar"];r.type=d(n,a,{autotypenumbers:r.autotypenumbers})}}(n,i.data),"-"===n.type?n.type="linear":b=r.type=n.type),y("smoothing"),y("cheatertype"),y("showticklabels"),y("labelprefix",m+" = "),y("labelsuffix"),y("showtickprefix"),y("showticksuffix"),y("separatethousands"),y("tickformat"),y("exponentformat"),y("minexponent"),y("showexponent"),y("categoryorder"),y("tickmode"),y("tickvals"),y("ticktext"),y("tick0"),y("dtick"),"array"===n.tickmode&&(y("arraytick0"),y("arraydtick")),y("labelpadding"),n._hovertitle=m,"date"===b&&s.getComponentMethod("calendars","handleDefaults")(r,n,"calendar",i.calendar),p(n,i.fullLayout),n.c2p=l.identity;var _=y("color",i.dfltColor),w=_===r.color?_:g.color;y("title.text")&&(l.coerceFont(y,"title.font",{family:g.family,size:l.bigFont(g.size),color:w}),y("title.offset")),y("tickangle"),y("autorange",!n.isValidRange(r.range))&&y("rangemode"),y("range"),n.cleanRange(),y("fixedrange"),c(r,n,y,b),f(r,n,y,b,i),u(r,n,y,b,i),h(r,n,y,{data:i.data,dataAttr:m});var T=x("gridcolor",o(_,.3)),k=x("gridwidth"),A=y("showgrid");A||(delete n.gridcolor,delete n.gridwidth);var M=x("startlinecolor",_),S=x("startlinewidth",k);y("startline",n.showgrid||!!M||!!S)||(delete n.startlinecolor,delete n.startlinewidth);var E=x("endlinecolor",_),L=x("endlinewidth",k);return y("endline",n.showgrid||!!E||!!L)||(delete n.endlinecolor,delete n.endlinewidth),A?(y("minorgridcount"),y("minorgridwidth",k),y("minorgridcolor",o(T,.06)),n.minorgridcount||(delete n.minorgridwidth,delete n.minorgridcolor)):(delete n.gridcolor,delete n.gridWidth),"none"===n.showticklabels&&(delete n.tickfont,delete n.tickangle,delete n.showexponent,delete n.exponentformat,delete n.minexponent,delete n.tickformat,delete n.showticksuffix,delete n.showtickprefix),n.showticksuffix||delete n.ticksuffix,n.showtickprefix||delete n.tickprefix,y("tickmode"),n}},{"../../components/color":366,"../../lib":503,"../../plots/cartesian/axis_autotype":555,"../../plots/cartesian/category_order_defaults":559,"../../plots/cartesian/prefix_suffix_defaults":573,"../../plots/cartesian/set_convert":576,"../../plots/cartesian/tick_label_defaults":578,"../../plots/cartesian/tick_value_defaults":580,"../../registry":638,"./attributes":691}],695:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../lib").isArray1D,s=r("./cheater_basis"),l=r("./array_minmax"),c=r("./calc_gridlines"),u=r("./calc_labels"),f=r("./calc_clippath"),h=r("../heatmap/clean_2d_array"),p=r("./smooth_fill_2d_array"),d=r("../heatmap/convert_column_xyz"),m=r("./set_convert");n.exports=function(r,n){var i=a.getFromId(r,n.xaxis),g=a.getFromId(r,n.yaxis),v=n.aaxis,y=n.baxis,x=n.x,b=n.y,_=[];x&&o(x)&&_.push("x"),b&&o(b)&&_.push("y"),_.length&&d(n,v,y,"a","b",_);var w=n._a=n._a||n.a,T=n._b=n._b||n.b;x=n._x||n.x,b=n._y||n.y;var k={};n._cheater&&(x=s("index"===v.cheatertype?w.length:w,"index"===y.cheatertype?T.length:T,n.cheaterslope)),n._x=x=h(x),n._y=b=h(b),p(x,w,T),p(b,w,T),m(n),n.setScale();var A=l(x),M=l(b),S=.5*(A[1]-A[0]),E=.5*(A[1]+A[0]),L=.5*(M[1]-M[0]),C=.5*(M[1]+M[0]);return A=[E-1.3*S,E+1.3*S],M=[C-1.3*L,C+1.3*L],n._extremes[i._id]=a.findExtremes(i,A,{padded:!0}),n._extremes[g._id]=a.findExtremes(g,M,{padded:!0}),c(n,"a","b"),c(n,"b","a"),u(n,v),u(n,y),k.clipsegments=f(n._xctrl,n._yctrl,v,y),k.x=x,k.y=b,k.a=w,k.b=T,[k]}},{"../../lib":503,"../../plots/cartesian/axes":554,"../heatmap/clean_2d_array":794,"../heatmap/convert_column_xyz":796,"./array_minmax":690,"./calc_clippath":696,"./calc_gridlines":697,"./calc_labels":698,"./cheater_basis":700,"./set_convert":713,"./smooth_fill_2d_array":714}],696:[function(r,n,i){"use strict";n.exports=function(r,n,i,a){var o,s,l,c=[],u=!!i.smoothing,f=!!a.smoothing,h=r[0].length-1,p=r.length-1;for(o=0,s=[],l=[];o<=h;o++)s[o]=r[0][o],l[o]=n[0][o];for(c.push({x:s,y:l,bicubic:u}),o=0,s=[],l=[];o<=p;o++)s[o]=r[o][h],l[o]=n[o][h];for(c.push({x:s,y:l,bicubic:f}),o=h,s=[],l=[];o>=0;o--)s[h-o]=r[p][o],l[h-o]=n[p][o];for(c.push({x:s,y:l,bicubic:u}),o=p,s=[],l=[];o>=0;o--)s[p-o]=r[o][0],l[p-o]=n[o][0];return c.push({x:s,y:l,bicubic:f}),c}},{}],697:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../lib/extend").extendFlat;n.exports=function(r,n,i){var s,l,c,u,f,h,p,d,m,g,v,y,x,b,_=r["_"+n],w=r[n+"axis"],T=w._gridlines=[],k=w._minorgridlines=[],A=w._boundarylines=[],M=r["_"+i],S=r[i+"axis"];"array"===w.tickmode&&(w.tickvals=_.slice());var E=r._xctrl,L=r._yctrl,C=E[0].length,P=E.length,I=r._a.length,O=r._b.length;a.prepTicks(w),"array"===w.tickmode&&delete w.tickvals;var z=w.smoothing?3:1;function D(a){var o,s,l,c,u,f,h,p,m,g,v,y,x=[],b=[],_={};if("b"===n)for(l=Math.floor(Math.max(0,Math.min(O-2,s=r.b2j(a)))),c=s-l,_.length=O,_.crossLength=I,_.xy=function(n){return r.evalxy([],n,s)},_.dxy=function(n,i){return r.dxydi([],n,l,i,c)},o=0;o<I;o++)f=Math.min(I-2,o),h=o-f,p=r.evalxy([],o,s),S.smoothing&&o>0&&(m=r.dxydi([],o-1,l,0,c),x.push(u[0]+m[0]/3),b.push(u[1]+m[1]/3),g=r.dxydi([],o-1,l,1,c),x.push(p[0]-g[0]/3),b.push(p[1]-g[1]/3)),x.push(p[0]),b.push(p[1]),u=p;else for(f=Math.floor(Math.max(0,Math.min(I-2,o=r.a2i(a)))),h=o-f,_.length=I,_.crossLength=O,_.xy=function(n){return r.evalxy([],o,n)},_.dxy=function(n,i){return r.dxydj([],f,n,h,i)},s=0;s<O;s++)l=Math.min(O-2,s),c=s-l,p=r.evalxy([],o,s),S.smoothing&&s>0&&(v=r.dxydj([],f,s-1,h,0),x.push(u[0]+v[0]/3),b.push(u[1]+v[1]/3),y=r.dxydj([],f,s-1,h,1),x.push(p[0]-y[0]/3),b.push(p[1]-y[1]/3)),x.push(p[0]),b.push(p[1]),u=p;return _.axisLetter=n,_.axis=w,_.crossAxis=S,_.value=a,_.constvar=i,_.index=d,_.x=x,_.y=b,_.smoothing=S.smoothing,_}function R(a){var o,s,l,c,u,f=[],h=[],p={};if(p.length=_.length,p.crossLength=M.length,"b"===n)for(l=Math.max(0,Math.min(O-2,a)),u=Math.min(1,Math.max(0,a-l)),p.xy=function(n){return r.evalxy([],n,a)},p.dxy=function(n,i){return r.dxydi([],n,l,i,u)},o=0;o<C;o++)f[o]=E[a*z][o],h[o]=L[a*z][o];else for(s=Math.max(0,Math.min(I-2,a)),c=Math.min(1,Math.max(0,a-s)),p.xy=function(n){return r.evalxy([],a,n)},p.dxy=function(n,i){return r.dxydj([],s,n,c,i)},o=0;o<P;o++)f[o]=E[o][a*z],h[o]=L[o][a*z];return p.axisLetter=n,p.axis=w,p.crossAxis=S,p.value=_[a],p.constvar=i,p.index=a,p.x=f,p.y=h,p.smoothing=S.smoothing,p}if("array"===w.tickmode){for(u=5e-15,h=(f=[Math.floor((_.length-1-w.arraytick0)/w.arraydtick*(1+u)),Math.ceil(-w.arraytick0/w.arraydtick/(1+u))].sort(function(r,n){return r-n}))[0]-1,p=f[1]+1,d=h;d<p;d++)(l=w.arraytick0+w.arraydtick*d)<0||l>_.length-1||T.push(o(R(l),{color:w.gridcolor,width:w.gridwidth}));for(d=h;d<p;d++)if(v=Math.min((c=w.arraytick0+w.arraydtick*d)+w.arraydtick,_.length-1),!(c<0||c>_.length-1||v<0||v>_.length-1))for(y=_[c],x=_[v],s=0;s<w.minorgridcount;s++)(b=v-c)<=0||(g=y+(x-y)*(s+1)/(w.minorgridcount+1)*(w.arraydtick/b))<_[0]||g>_[_.length-1]||k.push(o(D(g),{color:w.minorgridcolor,width:w.minorgridwidth}));w.startline&&A.push(o(R(0),{color:w.startlinecolor,width:w.startlinewidth})),w.endline&&A.push(o(R(_.length-1),{color:w.endlinecolor,width:w.endlinewidth}))}else{for(u=5e-15,h=(f=[Math.floor((_[_.length-1]-w.tick0)/w.dtick*(1+u)),Math.ceil((_[0]-w.tick0)/w.dtick/(1+u))].sort(function(r,n){return r-n}))[0],p=f[1],d=h;d<=p;d++)m=w.tick0+w.dtick*d,T.push(o(D(m),{color:w.gridcolor,width:w.gridwidth}));for(d=h-1;d<p+1;d++)for(m=w.tick0+w.dtick*d,s=0;s<w.minorgridcount;s++)(g=m+w.dtick*(s+1)/(w.minorgridcount+1))<_[0]||g>_[_.length-1]||k.push(o(D(g),{color:w.minorgridcolor,width:w.minorgridwidth}));w.startline&&A.push(o(D(_[0]),{color:w.startlinecolor,width:w.startlinewidth})),w.endline&&A.push(o(D(_[_.length-1]),{color:w.endlinecolor,width:w.endlinewidth}))}}},{"../../lib/extend":493,"../../plots/cartesian/axes":554}],698:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../lib/extend").extendFlat;n.exports=function(r,n){var i,s,l,c=n._labels=[],u=n._gridlines;for(i=0;i<u.length;i++)l=u[i],-1!==["start","both"].indexOf(n.showticklabels)&&(o(s=a.tickText(n,l.value),{prefix:void 0,suffix:void 0,endAnchor:!0,xy:l.xy(0),dxy:l.dxy(0,0),axis:l.axis,length:l.crossAxis.length,font:l.axis.tickfont,isFirst:0===i,isLast:i===u.length-1}),c.push(s)),-1!==["end","both"].indexOf(n.showticklabels)&&(o(s=a.tickText(n,l.value),{endAnchor:!1,xy:l.xy(l.crossLength-1),dxy:l.dxy(l.crossLength-2,1),axis:l.axis,length:l.crossAxis.length,font:l.axis.tickfont,isFirst:0===i,isLast:i===u.length-1}),c.push(s))}},{"../../lib/extend":493,"../../plots/cartesian/axes":554}],699:[function(r,n,i){"use strict";n.exports=function(r,n,i,a){var o=r[0]-n[0],s=r[1]-n[1],l=i[0]-n[0],c=i[1]-n[1],u=Math.pow(o*o+s*s,.25),f=Math.pow(l*l+c*c,.25),h=(f*f*o-u*u*l)*a,p=(f*f*s-u*u*c)*a,d=f*(u+f)*3,m=u*(u+f)*3;return[[n[0]+(d&&h/d),n[1]+(d&&p/d)],[n[0]-(m&&h/m),n[1]-(m&&p/m)]]}},{}],700:[function(r,n,i){"use strict";var a=r("../../lib").isArrayOrTypedArray;n.exports=function(r,n,i){var o,s,l,c,u,f,h=[],p=a(r)?r.length:r,d=a(n)?n.length:n,m=a(r)?r:null,g=a(n)?n:null;m&&(l=(m.length-1)/(m[m.length-1]-m[0])/(p-1)),g&&(c=(g.length-1)/(g[g.length-1]-g[0])/(d-1));var v=1/0,y=-1/0;for(s=0;s<d;s++)for(h[s]=[],u=g?(g[s]-g[0])*c:s/(d-1),o=0;o<p;o++)v=Math.min(f=(m?(m[o]-m[0])*l:o/(p-1))-u*i,v),y=Math.max(f,y),h[s][o]=f;var x=1/(y-v),b=-v*x;for(s=0;s<d;s++)for(o=0;o<p;o++)h[s][o]=x*h[s][o]+b;return h}},{"../../lib":503}],701:[function(r,n,i){"use strict";var a=r("./catmull_rom"),o=r("../../lib").ensureArray;function s(r,n,i){var a=-.5*i[0]+1.5*n[0],o=-.5*i[1]+1.5*n[1];return[(2*a+r[0])/3,(2*o+r[1])/3]}n.exports=function(r,n,i,l,c,u){var f,h,p,d,m,g,v,y,x,b,_=i[0].length,w=i.length,T=c?3*_-2:_,k=u?3*w-2:w;for(r=o(r,k),n=o(n,k),p=0;p<k;p++)r[p]=o(r[p],T),n[p]=o(n[p],T);for(h=0,d=0;h<w;h++,d+=u?3:1)for(m=r[d],g=n[d],v=i[h],y=l[h],f=0,p=0;f<_;f++,p+=c?3:1)m[p]=v[f],g[p]=y[f];if(c)for(h=0,d=0;h<w;h++,d+=u?3:1){for(f=1,p=3;f<_-1;f++,p+=3)x=a([i[h][f-1],l[h][f-1]],[i[h][f],l[h][f]],[i[h][f+1],l[h][f+1]],c),r[d][p-1]=x[0][0],n[d][p-1]=x[0][1],r[d][p+1]=x[1][0],n[d][p+1]=x[1][1];b=s([r[d][0],n[d][0]],[r[d][2],n[d][2]],[r[d][3],n[d][3]]),r[d][1]=b[0],n[d][1]=b[1],b=s([r[d][T-1],n[d][T-1]],[r[d][T-3],n[d][T-3]],[r[d][T-4],n[d][T-4]]),r[d][T-2]=b[0],n[d][T-2]=b[1]}if(u)for(p=0;p<T;p++){for(d=3;d<k-3;d+=3)x=a([r[d-3][p],n[d-3][p]],[r[d][p],n[d][p]],[r[d+3][p],n[d+3][p]],u),r[d-1][p]=x[0][0],n[d-1][p]=x[0][1],r[d+1][p]=x[1][0],n[d+1][p]=x[1][1];b=s([r[0][p],n[0][p]],[r[2][p],n[2][p]],[r[3][p],n[3][p]]),r[1][p]=b[0],n[1][p]=b[1],b=s([r[k-1][p],n[k-1][p]],[r[k-3][p],n[k-3][p]],[r[k-4][p],n[k-4][p]]),r[k-2][p]=b[0],n[k-2][p]=b[1]}if(c&&u)for(d=1;d<k;d+=(d+1)%3==0?2:1){for(p=3;p<T-3;p+=3)x=a([r[d][p-3],n[d][p-3]],[r[d][p],n[d][p]],[r[d][p+3],n[d][p+3]],c),r[d][p-1]=.5*(r[d][p-1]+x[0][0]),n[d][p-1]=.5*(n[d][p-1]+x[0][1]),r[d][p+1]=.5*(r[d][p+1]+x[1][0]),n[d][p+1]=.5*(n[d][p+1]+x[1][1]);b=s([r[d][0],n[d][0]],[r[d][2],n[d][2]],[r[d][3],n[d][3]]),r[d][1]=.5*(r[d][1]+b[0]),n[d][1]=.5*(n[d][1]+b[1]),b=s([r[d][T-1],n[d][T-1]],[r[d][T-3],n[d][T-3]],[r[d][T-4],n[d][T-4]]),r[d][T-2]=.5*(r[d][T-2]+b[0]),n[d][T-2]=.5*(n[d][T-2]+b[1])}return[r,n]}},{"../../lib":503,"./catmull_rom":699}],702:[function(r,n,i){"use strict";n.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],703:[function(r,n,i){"use strict";n.exports=function(r,n,i){return n&&i?function(n,i,a,o,s){n||(n=[]),i*=3,a*=3;var l,c,u,f,h,p,d=o*o,m=1-o,g=m*m,v=m*o*2,y=-3*g,x=3*(g-v),b=3*(v-d),_=3*d,w=s*s,T=w*s,k=1-s,A=k*k,M=A*k;for(p=0;p<r.length;p++)l=y*(h=r[p])[a][i]+x*h[a][i+1]+b*h[a][i+2]+_*h[a][i+3],c=y*h[a+1][i]+x*h[a+1][i+1]+b*h[a+1][i+2]+_*h[a+1][i+3],u=y*h[a+2][i]+x*h[a+2][i+1]+b*h[a+2][i+2]+_*h[a+2][i+3],f=y*h[a+3][i]+x*h[a+3][i+1]+b*h[a+3][i+2]+_*h[a+3][i+3],n[p]=M*l+3*(A*s*c+k*w*u)+T*f;return n}:n?function(n,i,a,o,s){n||(n=[]),i*=3;var l,c,u,f,h=o*o,p=1-o,d=p*p,m=p*o*2,g=-3*d,v=3*(d-m),y=3*(m-h),x=3*h,b=1-s;for(u=0;u<r.length;u++)l=g*(f=r[u])[a][i]+v*f[a][i+1]+y*f[a][i+2]+x*f[a][i+3],c=g*f[a+1][i]+v*f[a+1][i+1]+y*f[a+1][i+2]+x*f[a+1][i+3],n[u]=b*l+s*c;return n}:i?function(n,i,a,o,s){n||(n=[]),a*=3;var l,c,u,f,h,p,d=s*s,m=d*s,g=1-s,v=g*g,y=v*g;for(h=0;h<r.length;h++)l=(p=r[h])[a][i+1]-p[a][i],c=p[a+1][i+1]-p[a+1][i],u=p[a+2][i+1]-p[a+2][i],f=p[a+3][i+1]-p[a+3][i],n[h]=y*l+3*(v*s*c+g*d*u)+m*f;return n}:function(n,i,a,o,s){n||(n=[]);var l,c,u,f,h=1-s;for(u=0;u<r.length;u++)l=(f=r[u])[a][i+1]-f[a][i],c=f[a+1][i+1]-f[a+1][i],n[u]=h*l+s*c;return n}}},{}],704:[function(r,n,i){"use strict";n.exports=function(r,n,i){return n&&i?function(n,i,a,o,s){n||(n=[]),i*=3,a*=3;var l,c,u,f,h,p,d=o*o,m=d*o,g=1-o,v=g*g,y=v*g,x=s*s,b=1-s,_=b*b,w=b*s*2,T=-3*_,k=3*(_-w),A=3*(w-x),M=3*x;for(p=0;p<r.length;p++)l=T*(h=r[p])[a][i]+k*h[a+1][i]+A*h[a+2][i]+M*h[a+3][i],c=T*h[a][i+1]+k*h[a+1][i+1]+A*h[a+2][i+1]+M*h[a+3][i+1],u=T*h[a][i+2]+k*h[a+1][i+2]+A*h[a+2][i+2]+M*h[a+3][i+2],f=T*h[a][i+3]+k*h[a+1][i+3]+A*h[a+2][i+3]+M*h[a+3][i+3],n[p]=y*l+3*(v*o*c+g*d*u)+m*f;return n}:n?function(n,i,a,o,s){n||(n=[]),i*=3;var l,c,u,f,h,p,d=s*s,m=d*s,g=1-s,v=g*g,y=v*g;for(h=0;h<r.length;h++)l=(p=r[h])[a+1][i]-p[a][i],c=p[a+1][i+1]-p[a][i+1],u=p[a+1][i+2]-p[a][i+2],f=p[a+1][i+3]-p[a][i+3],n[h]=y*l+3*(v*s*c+g*d*u)+m*f;return n}:i?function(n,i,a,o,s){n||(n=[]),a*=3;var l,c,u,f,h=1-o,p=s*s,d=1-s,m=d*d,g=d*s*2,v=-3*m,y=3*(m-g),x=3*(g-p),b=3*p;for(u=0;u<r.length;u++)l=v*(f=r[u])[a][i]+y*f[a+1][i]+x*f[a+2][i]+b*f[a+3][i],c=v*f[a][i+1]+y*f[a+1][i+1]+x*f[a+2][i+1]+b*f[a+3][i+1],n[u]=h*l+o*c;return n}:function(n,i,a,o,s){n||(n=[]);var l,c,u,f,h=1-o;for(u=0;u<r.length;u++)l=(f=r[u])[a+1][i]-f[a][i],c=f[a+1][i+1]-f[a][i+1],n[u]=h*l+o*c;return n}}},{}],705:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o){var s=n-2,l=i-2;return a&&o?function(n,i,a){n||(n=[]);var o,c,u,f,h,p,d=Math.max(0,Math.min(Math.floor(i),s)),m=Math.max(0,Math.min(Math.floor(a),l)),g=Math.max(0,Math.min(1,i-d)),v=Math.max(0,Math.min(1,a-m));d*=3,m*=3;var y=g*g,x=y*g,b=1-g,_=b*b,w=_*b,T=v*v,k=T*v,A=1-v,M=A*A,S=M*A;for(p=0;p<r.length;p++)o=w*(h=r[p])[m][d]+3*(_*g*h[m][d+1]+b*y*h[m][d+2])+x*h[m][d+3],c=w*h[m+1][d]+3*(_*g*h[m+1][d+1]+b*y*h[m+1][d+2])+x*h[m+1][d+3],u=w*h[m+2][d]+3*(_*g*h[m+2][d+1]+b*y*h[m+2][d+2])+x*h[m+2][d+3],f=w*h[m+3][d]+3*(_*g*h[m+3][d+1]+b*y*h[m+3][d+2])+x*h[m+3][d+3],n[p]=S*o+3*(M*v*c+A*T*u)+k*f;return n}:a?function(n,i,a){n||(n=[]);var o,c,u,f,h,p,d=Math.max(0,Math.min(Math.floor(i),s)),m=Math.max(0,Math.min(Math.floor(a),l)),g=Math.max(0,Math.min(1,i-d)),v=Math.max(0,Math.min(1,a-m));d*=3;var y=g*g,x=y*g,b=1-g,_=b*b,w=_*b,T=1-v;for(h=0;h<r.length;h++)o=T*(p=r[h])[m][d]+v*p[m+1][d],c=T*p[m][d+1]+v*p[m+1][d+1],u=T*p[m][d+2]+v*p[m+1][d+1],f=T*p[m][d+3]+v*p[m+1][d+1],n[h]=w*o+3*(_*g*c+b*y*u)+x*f;return n}:o?function(n,i,a){n||(n=[]);var o,c,u,f,h,p,d=Math.max(0,Math.min(Math.floor(i),s)),m=Math.max(0,Math.min(Math.floor(a),l)),g=Math.max(0,Math.min(1,i-d)),v=Math.max(0,Math.min(1,a-m));m*=3;var y=v*v,x=y*v,b=1-v,_=b*b,w=_*b,T=1-g;for(h=0;h<r.length;h++)o=T*(p=r[h])[m][d]+g*p[m][d+1],c=T*p[m+1][d]+g*p[m+1][d+1],u=T*p[m+2][d]+g*p[m+2][d+1],f=T*p[m+3][d]+g*p[m+3][d+1],n[h]=w*o+3*(_*v*c+b*y*u)+x*f;return n}:function(n,i,a){n||(n=[]);var o,c,u,f,h=Math.max(0,Math.min(Math.floor(i),s)),p=Math.max(0,Math.min(Math.floor(a),l)),d=Math.max(0,Math.min(1,i-h)),m=Math.max(0,Math.min(1,a-p)),g=1-m,v=1-d;for(u=0;u<r.length;u++)o=v*(f=r[u])[p][h]+d*f[p][h+1],c=v*f[p+1][h]+d*f[p+1][h+1],n[u]=g*o+m*c;return n}}},{}],706:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./xy_defaults"),s=r("./ab_defaults"),l=r("./attributes"),c=r("../../components/color/attributes");n.exports=function(r,n,i,u){function f(i,o){return a.coerce(r,n,l,i,o)}n._clipPathId="clip"+n.uid+"carpet";var h=f("color",c.defaultLine);(a.coerceFont(f,"font"),f("carpet"),s(r,n,u,f,h),n.a&&n.b)?(n.a.length<3&&(n.aaxis.smoothing=0),n.b.length<3&&(n.baxis.smoothing=0),o(r,n,f)||(n.visible=!1),n._cheater&&f("cheaterslope")):n.visible=!1}},{"../../components/color/attributes":365,"../../lib":503,"./ab_defaults":689,"./attributes":691,"./xy_defaults":715}],707:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),plot:r("./plot"),calc:r("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":568,"./attributes":691,"./calc":695,"./defaults":706,"./plot":712}],708:[function(r,n,i){"use strict";n.exports=function(r,n){for(var i,a=r._fullData.length,o=0;o<a;o++){var s=r._fullData[o];if(s.index!==n.index&&"carpet"===s.type&&(i||(i=s),s.carpet===n.carpet))return s}return i}},{}],709:[function(r,n,i){"use strict";n.exports=function(r,n,i){if(0===r.length)return"";var a,o=[],s=i?3:1;for(a=0;a<r.length;a+=s)o.push(r[a]+","+n[a]),i&&a<r.length-s&&(o.push("C"),o.push([r[a+1]+","+n[a+1],r[a+2]+","+n[a+2]+" "].join(" ")));return o.join(i?"":"L")}},{}],710:[function(r,n,i){"use strict";var a=r("../../lib").isArrayOrTypedArray;n.exports=function(r,n,i){var o;for(a(r)?r.length>n.length&&(r=r.slice(0,n.length)):r=[],o=0;o<n.length;o++)r[o]=i(n[o]);return r}},{"../../lib":503}],711:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o,s){var l=o[0]*r.dpdx(n),c=o[1]*r.dpdy(i),u=1,f=1;if(s){var h=Math.sqrt(o[0]*o[0]+o[1]*o[1]),p=Math.sqrt(s[0]*s[0]+s[1]*s[1]);f=Math.max(0,(o[0]*s[0]+o[1]*s[1])/h/p)}var d=180*Math.atan2(c,l)/Math.PI;return d<-90?(d+=180,u=-u):d>90&&(d-=180,u=-u),{angle:d,flip:u,p:r.c2p(a,n,i),offsetMultplier:f}}},{}],712:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/drawing"),s=r("./map_1d_array"),l=r("./makepath"),c=r("./orient_text"),u=r("../../lib/svg_text_utils"),f=r("../../lib"),h=f.strRotate,p=f.strTranslate,d=r("../../constants/alignment");function m(r,n,i,o,c,u){var f="const-"+c+"-lines",h=i.selectAll("."+f).data(u);h.enter().append("path").classed(f,!0).style("vector-effect","non-scaling-stroke"),h.each(function(i){var o=i.x,c=i.y,u="M"+l(s([],o,r.c2p),s([],c,n.c2p),i.smoothing);a.select(this).attr("d",u).style("stroke-width",i.width).style("stroke",i.color).style("fill","none")}),h.exit().remove()}function g(r,n,i,s,l,f,d,m){var g=f.selectAll("text."+m).data(d);g.enter().append("text").classed(m,!0);var v=0,y={};return g.each(function(l,f){if("auto"===l.axis.tickangle)d=c(s,n,i,l.xy,l.dxy);else{var d,m=(l.axis.tickangle+180)*Math.PI/180;d=c(s,n,i,l.xy,[Math.cos(m),Math.sin(m)])}f||(y={angle:d.angle,flip:d.flip});var g=(l.endAnchor?-1:1)*d.flip,x=a.select(this).attr({"text-anchor":g>0?"start":"end","data-notex":1}).call(o.font,l.font).text(l.text).call(u.convertToTspans,r),b=o.bBox(this);x.attr("transform",p(d.p[0],d.p[1])+h(d.angle)+p(l.axis.labelpadding*g,.3*b.height)),v=Math.max(v,b.width+l.axis.labelpadding)}),g.exit().remove(),y.maxExtent=v,y}n.exports=function(r,n,i,o){var u=n.xaxis,h=n.yaxis,p=r._fullLayout._clips;f.makeTraceGroups(o,i,"trace").each(function(n){var i,o,d,v,y,b,_,w,T=a.select(this),k=n[0],A=k.trace,M=A.aaxis,S=A.baxis,E=f.ensureSingle(T,"g","minorlayer"),L=f.ensureSingle(T,"g","majorlayer"),C=f.ensureSingle(T,"g","boundarylayer"),P=f.ensureSingle(T,"g","labellayer");T.style("opacity",A.opacity),m(u,h,L,M,"a",M._gridlines),m(u,h,L,S,"b",S._gridlines),m(u,h,E,M,"a",M._minorgridlines),m(u,h,E,S,"b",S._minorgridlines),m(u,h,C,M,"a-boundary",M._boundarylines),m(u,h,C,S,"b-boundary",S._boundarylines);var I=g(r,u,h,A,k,P,M._labels,"a-label"),O=g(r,u,h,A,k,P,S._labels,"b-label");y=f.aggNums(Math.min,null,A.a),b=f.aggNums(Math.max,null,A.a),_=f.aggNums(Math.min,null,A.b),w=f.aggNums(Math.max,null,A.b),i=.5*(y+b),o=_,d=A.ab2xy(i,o,!0),v=A.dxyda_rough(i,o),void 0===I.angle&&f.extendFlat(I,c(A,u,h,d,A.dxydb_rough(i,o))),x(r,P,A,k,d,v,A.aaxis,u,h,I,"a-title"),i=y,o=.5*(_+w),d=A.ab2xy(i,o,!0),v=A.dxydb_rough(i,o),void 0===O.angle&&f.extendFlat(O,c(A,u,h,d,A.dxyda_rough(i,o))),x(r,P,A,k,d,v,A.baxis,u,h,O,"b-title"),function(r,n,i,a,o){var c,u,h=i.select("#"+r._clipPathId);h.size()||(h=i.append("clipPath").classed("carpetclip",!0));var p=f.ensureSingle(h,"path","carpetboundary"),d=n.clipsegments,m=[];for(u=0;u<d.length;u++)m.push(l(s([],(c=d[u]).x,a.c2p),s([],c.y,o.c2p),c.bicubic));var g="M"+m.join("L")+"Z";h.attr("id",r._clipPathId),p.attr("d",g)}(A,k,p,u,h)})};var v=d.LINE_SPACING,y=(1-d.MID_SHIFT)/v+1;function x(r,n,i,s,l,f,d,m,g,x,b){var _=[];d.title.text&&_.push(d.title.text);var w=n.selectAll("text."+b).data(_),T=x.maxExtent;w.enter().append("text").classed(b,!0),w.each(function(){var n=c(i,m,g,l,f);-1===["start","both"].indexOf(d.showticklabels)&&(T=0);var s=d.title.font.size;T+=s+d.title.offset;var b=(x.angle+(x.flip<0?180:0)-n.angle+450)%360,_=a.select(this);_.text(d.title.text).call(u.convertToTspans,r),b>90&&b<270&&(T=(-u.lineCount(_)+y)*v*s-T),_.attr("transform",p(n.p[0],n.p[1])+h(n.angle)+p(0,T)).attr("text-anchor","middle").call(o.font,d.title.font)}),w.exit().remove()}},{"../../components/drawing":388,"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"./makepath":709,"./map_1d_array":710,"./orient_text":711,"@plotly/d3":58}],713:[function(r,n,i){"use strict";var a=r("./constants"),o=r("../../lib/search").findBin,s=r("./compute_control_points"),l=r("./create_spline_evaluator"),c=r("./create_i_derivative_evaluator"),u=r("./create_j_derivative_evaluator");n.exports=function(r){var n=r._a,i=r._b,f=n.length,h=i.length,p=r.aaxis,d=r.baxis,m=n[0],g=n[f-1],v=i[0],y=i[h-1],x=n[n.length-1]-n[0],b=i[i.length-1]-i[0],_=x*a.RELATIVE_CULL_TOLERANCE,w=b*a.RELATIVE_CULL_TOLERANCE;m-=_,g+=_,v-=w,y+=w,r.isVisible=function(r,n){return r>m&&r<g&&n>v&&n<y},r.isOccluded=function(r,n){return r<m||r>g||n<v||n>y},r.setScale=function(){var n=r._x,i=r._y,a=s(r._xctrl,r._yctrl,n,i,p.smoothing,d.smoothing);r._xctrl=a[0],r._yctrl=a[1],r.evalxy=l([r._xctrl,r._yctrl],f,h,p.smoothing,d.smoothing),r.dxydi=c([r._xctrl,r._yctrl],p.smoothing,d.smoothing),r.dxydj=u([r._xctrl,r._yctrl],p.smoothing,d.smoothing)},r.i2a=function(r){var i=Math.max(0,Math.floor(r[0]),f-2),a=r[0]-i;return(1-a)*n[i]+a*n[i+1]},r.j2b=function(r){var n=Math.max(0,Math.floor(r[1]),f-2),a=r[1]-n;return(1-a)*i[n]+a*i[n+1]},r.ij2ab=function(n){return[r.i2a(n[0]),r.j2b(n[1])]},r.a2i=function(r){var i=Math.max(0,Math.min(o(r,n),f-2)),a=n[i],s=n[i+1];return Math.max(0,Math.min(f-1,i+(r-a)/(s-a)))},r.b2j=function(r){var n=Math.max(0,Math.min(o(r,i),h-2)),a=i[n],s=i[n+1];return Math.max(0,Math.min(h-1,n+(r-a)/(s-a)))},r.ab2ij=function(n){return[r.a2i(n[0]),r.b2j(n[1])]},r.i2c=function(n,i){return r.evalxy([],n,i)},r.ab2xy=function(a,o,s){if(!s&&(a<n[0]||a>n[f-1]|o<i[0]||o>i[h-1]))return[!1,!1];var l=r.a2i(a),c=r.b2j(o),u=r.evalxy([],l,c);if(s){var p,d,m,g,v=0,y=0,x=[];a<n[0]?(p=0,d=0,v=(a-n[0])/(n[1]-n[0])):a>n[f-1]?(p=f-2,d=1,v=(a-n[f-1])/(n[f-1]-n[f-2])):d=l-(p=Math.max(0,Math.min(f-2,Math.floor(l)))),o<i[0]?(m=0,g=0,y=(o-i[0])/(i[1]-i[0])):o>i[h-1]?(m=h-2,g=1,y=(o-i[h-1])/(i[h-1]-i[h-2])):g=c-(m=Math.max(0,Math.min(h-2,Math.floor(c)))),v&&(r.dxydi(x,p,m,d,g),u[0]+=x[0]*v,u[1]+=x[1]*v),y&&(r.dxydj(x,p,m,d,g),u[0]+=x[0]*y,u[1]+=x[1]*y)}return u},r.c2p=function(r,n,i){return[n.c2p(r[0]),i.c2p(r[1])]},r.p2x=function(r,n,i){return[n.p2c(r[0]),i.p2c(r[1])]},r.dadi=function(r){var i=Math.max(0,Math.min(n.length-2,r));return n[i+1]-n[i]},r.dbdj=function(r){var n=Math.max(0,Math.min(i.length-2,r));return i[n+1]-i[n]},r.dxyda=function(n,i,a,o){var s=r.dxydi(null,n,i,a,o),l=r.dadi(n,a);return[s[0]/l,s[1]/l]},r.dxydb=function(n,i,a,o){var s=r.dxydj(null,n,i,a,o),l=r.dbdj(i,o);return[s[0]/l,s[1]/l]},r.dxyda_rough=function(n,i,a){var o=x*(a||.1),s=r.ab2xy(n+o,i,!0),l=r.ab2xy(n-o,i,!0);return[.5*(s[0]-l[0])/o,.5*(s[1]-l[1])/o]},r.dxydb_rough=function(n,i,a){var o=b*(a||.1),s=r.ab2xy(n,i+o,!0),l=r.ab2xy(n,i-o,!0);return[.5*(s[0]-l[0])/o,.5*(s[1]-l[1])/o]},r.dpdx=function(r){return r._m},r.dpdy=function(r){return r._m}}},{"../../lib/search":523,"./compute_control_points":701,"./constants":702,"./create_i_derivative_evaluator":703,"./create_j_derivative_evaluator":704,"./create_spline_evaluator":705}],714:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n,i){var o,s,l,c,u,f,h,p,d,m,g,v,y,x,b=[],_=[],w=r[0].length,T=r.length,k=0;for(o=0;o<w;o++)for(s=0;s<T;s++)void 0===r[s][o]&&(b.push(o),_.push(s),r[s][o]=function(n,i){var a,o=0,s=0;return n>0&&void 0!==(a=r[i][n-1])&&(s++,o+=a),n<w-1&&void 0!==(a=r[i][n+1])&&(s++,o+=a),i>0&&void 0!==(a=r[i-1][n])&&(s++,o+=a),i<T-1&&void 0!==(a=r[i+1][n])&&(s++,o+=a),o/Math.max(1,s)}(o,s)),k=Math.max(k,Math.abs(r[s][o]));if(!b.length)return r;var A=0,M=0,S=b.length;do{for(A=0,l=0;l<S;l++){o=b[l],s=_[l];var E,L,C,P,I,O,z=0,D=0;0===o?(C=n[I=Math.min(w-1,2)],P=n[1],E=r[s][I],D+=(L=r[s][1])+(L-E)*(n[0]-P)/(P-C),z++):o===w-1&&(C=n[I=Math.max(0,w-3)],P=n[w-2],E=r[s][I],D+=(L=r[s][w-2])+(L-E)*(n[w-1]-P)/(P-C),z++),(0===o||o===w-1)&&s>0&&s<T-1&&(c=i[s+1]-i[s],D+=((u=i[s]-i[s-1])*r[s+1][o]+c*r[s-1][o])/(u+c),z++),0===s?(C=i[O=Math.min(T-1,2)],P=i[1],E=r[O][o],D+=(L=r[1][o])+(L-E)*(i[0]-P)/(P-C),z++):s===T-1&&(C=i[O=Math.max(0,T-3)],P=i[T-2],E=r[O][o],D+=(L=r[T-2][o])+(L-E)*(i[T-1]-P)/(P-C),z++),(0===s||s===T-1)&&o>0&&o<w-1&&(c=n[o+1]-n[o],D+=((u=n[o]-n[o-1])*r[s][o+1]+c*r[s][o-1])/(u+c),z++),z?D/=z:(f=n[o+1]-n[o],h=n[o]-n[o-1],g=(p=i[s+1]-i[s])*(d=i[s]-i[s-1])*(p+d),D=((m=f*h*(f+h))*(d*r[s+1][o]+p*r[s-1][o])+g*(h*r[s][o+1]+f*r[s][o-1]))/(g*(h+f)+m*(d+p))),A+=(y=(v=D-r[s][o])/k)*y,x=z?0:.85,r[s][o]+=v*(1+x)}A=Math.sqrt(A)}while(M++<100&&A>1e-5);return a.log("Smoother converged to",A,"after",M,"iterations"),r}},{"../../lib":503}],715:[function(r,n,i){"use strict";var a=r("../../lib").isArray1D;n.exports=function(r,n,i){var o=i("x"),s=o&&o.length,l=i("y"),c=l&&l.length;if(!s&&!c)return!1;if(n._cheater=!o,s&&!a(o)||c&&!a(l))n._length=null;else{var u=s?o.length:1/0;c&&(u=Math.min(u,l.length)),n.a&&n.a.length&&(u=Math.min(u,n.a.length)),n.b&&n.b.length&&(u=Math.min(u,n.b.length)),n._length=u}return!0}},{"../../lib":503}],716:[function(r,n,i){"use strict";var a=r("../../plots/template_attributes").hovertemplateAttrs,o=r("../scattergeo/attributes"),s=r("../../components/colorscale/attributes"),l=r("../../plots/attributes"),c=r("../../components/color/attributes").defaultLine,u=r("../../lib/extend").extendFlat,f=o.marker.line;n.exports=u({locations:{valType:"data_array",editType:"calc"},locationmode:o.locationmode,z:{valType:"data_array",editType:"calc"},geojson:u({},o.geojson,{}),featureidkey:o.featureidkey,text:u({},o.text,{}),hovertext:u({},o.hovertext,{}),marker:{line:{color:u({},f.color,{dflt:c}),width:u({},f.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:o.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:o.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:u({},l.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:a(),showlegend:u({},l.showlegend,{dflt:!1})},s("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":365,"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scattergeo/attributes":968}],717:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../constants/numerical").BADNUM,s=r("../../components/colorscale/calc"),l=r("../scatter/arrays_to_calcdata"),c=r("../scatter/calc_selection");function u(r){return r&&"string"==typeof r}n.exports=function(r,n){var i,f=n._length,h=Array(f);i=n.geojson?function(r){return u(r)||a(r)}:u;for(var p=0;p<f;p++){var d=h[p]={},m=n.locations[p],g=n.z[p];i(m)&&a(g)?(d.loc=m,d.z=g):(d.loc=null,d.z=o),d.index=p}return l(h,n),s(r,n,{vals:n.z,containerStr:"",cLetter:"z"}),c(h,n),h}},{"../../components/colorscale/calc":374,"../../constants/numerical":479,"../scatter/arrays_to_calcdata":925,"../scatter/calc_selection":928,"fast-isnumeric":190}],718:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/colorscale/defaults"),s=r("./attributes");n.exports=function(r,n,i,l){function c(i,o){return a.coerce(r,n,s,i,o)}var u=c("locations"),f=c("z");if(u&&u.length&&a.isArrayOrTypedArray(f)&&f.length){n._length=Math.min(u.length,f.length);var h,p=c("geojson");("string"==typeof p&&""!==p||a.isPlainObject(p))&&(h="geojson-id"),"geojson-id"===c("locationmode",h)&&c("featureidkey"),c("text"),c("hovertext"),c("hovertemplate"),c("marker.line.width")&&c("marker.line.color"),c("marker.opacity"),o(r,n,l,c,{prefix:"",cLetter:"z"}),a.coerceSelectionMarkerOpacity(n,c)}else n.visible=!1}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":716}],719:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o){r.location=n.location,r.z=n.z;var s=a[o];return s.fIn&&s.fIn.properties&&(r.properties=s.fIn.properties),r.ct=s.ct,r}},{}],720:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("./attributes"),s=r("../../lib").fillText;n.exports=function(r,n,i){var l,c,u,f,h=r.cd,p=h[0].trace,d=r.subplot,m=[n,i],g=[n+360,i];for(c=0;c<h.length;c++)if(f=!1,(l=h[c])._polygons){for(u=0;u<l._polygons.length;u++)l._polygons[u].contains(m)&&(f=!f),l._polygons[u].contains(g)&&(f=!f);if(f)break}if(f&&l)return r.x0=r.x1=r.xa.c2p(l.ct),r.y0=r.y1=r.ya.c2p(l.ct),r.index=l.index,r.location=l.loc,r.z=l.z,r.zLabel=a.tickText(d.mockAxis,d.mockAxis.c2l(l.z),"hover").text,r.hovertemplate=l.hovertemplate,function(r,n,i){if(!n.hovertemplate){var a=i.hi||n.hoverinfo,l=String(i.loc),c="all"===a?o.hoverinfo.flags:a.split("+"),u=-1!==c.indexOf("name"),f=-1!==c.indexOf("location"),h=-1!==c.indexOf("z"),p=-1!==c.indexOf("text"),d=[];!u&&f?r.nameOverride=l:(u&&(r.nameOverride=n.name),f&&d.push(l)),h&&d.push(r.zLabel),p&&s(i,n,d),r.extraText=d.join("<br>")}}(r,p,l),[r]}},{"../../lib":503,"../../plots/cartesian/axes":554,"./attributes":716}],721:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),calc:r("./calc"),calcGeoJSON:r("./plot").calcGeoJSON,plot:r("./plot").plot,style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"choropleth",basePlotModule:r("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":589,"../heatmap/colorbar":795,"./attributes":716,"./calc":717,"./defaults":718,"./event_data":719,"./hover":720,"./plot":722,"./select":723,"./style":724}],722:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../lib/geo_location_utils"),l=r("../../lib/topojson_utils").getTopojsonFeatures,c=r("../../plots/cartesian/autorange").findExtremes,u=r("./style").style;n.exports={calcGeoJSON:function(r,n){for(var i=r[0].trace,a=n[i.geo],o=a._subplot,u=i.locationmode,f=i._length,h="geojson-id"===u?s.extractTraceFeature(r):l(i,o.topojson),p=[],d=[],m=0;m<f;m++){var g=r[m],v="geojson-id"===u?g.fOut:s.locationToFeature(u,g.loc,h);if(v){g.geojson=v,g.ct=v.properties.ct,g._polygons=s.feature2polygons(v);var y=s.computeBbox(v);p.push(y[0],y[2]),d.push(y[1],y[3])}else g.geojson=null}if("geojson"===a.fitbounds&&"geojson-id"===u){var x=s.computeBbox(s.getTraceGeojson(i));p=[x[0],x[2]],d=[x[1],x[3]]}var b={padded:!0};i._extremes.lon=c(a.lonaxis._ax,p,b),i._extremes.lat=c(a.lataxis._ax,d,b)},plot:function(r,n,i){var s=n.layers.backplot.select(".choroplethlayer");o.makeTraceGroups(s,i,"trace choropleth").each(function(n){var i=a.select(this).selectAll("path.choroplethlocation").data(o.identity);i.enter().append("path").classed("choroplethlocation",!0),i.exit().remove(),u(r,n)})}}},{"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/topojson_utils":532,"../../plots/cartesian/autorange":553,"./style":724,"@plotly/d3":58}],723:[function(r,n,i){"use strict";n.exports=function(r,n){var i,a,o,s,l,c=r.cd,u=r.xaxis,f=r.yaxis,h=[];if(!1===n)for(i=0;i<c.length;i++)c[i].selected=0;else for(i=0;i<c.length;i++)(o=(a=c[i]).ct)&&(s=u.c2p(o),l=f.c2p(o),n.contains([s,l],null,i,r)?(h.push({pointNumber:i,lon:o[0],lat:o[1]}),a.selected=1):a.selected=0);return h}},{}],724:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/color"),s=r("../../components/drawing"),l=r("../../components/colorscale");function c(r,n){var i=n[0].trace,c=n[0].node3.selectAll(".choroplethlocation"),u=i.marker||{},f=u.line||{},h=l.makeColorScaleFuncFromTrace(i);c.each(function(r){a.select(this).attr("fill",h(r.z)).call(o.stroke,r.mlc||f.color).call(s.dashLine,"",r.mlw||f.width||0).style("opacity",u.opacity)}),s.selectedPointStyle(c,i,r)}n.exports={style:function(r,n){n&&c(r,n)},styleOnSelect:function(r,n){var i=n[0].node3,a=n[0].trace;a.selectedpoints?s.selectedPointStyle(i.selectAll(".choroplethlocation"),a,r):c(r,n)}}},{"../../components/color":366,"../../components/colorscale":378,"../../components/drawing":388,"@plotly/d3":58}],725:[function(r,n,i){"use strict";var a=r("../choropleth/attributes"),o=r("../../components/colorscale/attributes"),s=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../../plots/attributes"),c=r("../../lib/extend").extendFlat;n.exports=c({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:c({},a.featureidkey,{}),below:{valType:"string",editType:"plot"},text:a.text,hovertext:a.hovertext,marker:{line:{color:c({},a.marker.line.color,{editType:"plot"}),width:c({},a.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:c({},a.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:c({},a.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:c({},a.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:a.hoverinfo,hovertemplate:s({},{keys:["properties"]}),showlegend:c({},l.showlegend,{dflt:!1})},o("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../choropleth/attributes":716}],726:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../../components/colorscale"),l=r("../../components/drawing"),c=r("../../lib/geojson_utils").makeBlank,u=r("../../lib/geo_location_utils");function f(r){var n,i=r[0].trace,a=i._opts;if(i.selectedpoints){for(var s=l.makeSelectedPointStyleFns(i),c=0;c<r.length;c++){var u=r[c];u.fOut&&(u.fOut.properties.mo2=s.selectedOpacityFn(u))}n={type:"identity",property:"mo2"}}else n=o.isArrayOrTypedArray(i.marker.opacity)?{type:"identity",property:"mo"}:i.marker.opacity;return o.extendFlat(a.fill.paint,{"fill-opacity":n}),o.extendFlat(a.line.paint,{"line-opacity":n}),a}n.exports={convert:function(r){var n=r[0].trace,i=!0===n.visible&&0!==n._length,l={layout:{visibility:"none"},paint:{}},h={layout:{visibility:"none"},paint:{}},p=n._opts={fill:l,line:h,geojson:c()};if(!i)return p;var d=u.extractTraceFeature(r);if(!d)return p;var m,g,v,y=s.makeColorScaleFuncFromTrace(n),x=n.marker,b=x.line||{};o.isArrayOrTypedArray(x.opacity)&&(m=function(r){var n=r.mo;return a(n)?+o.constrain(n,0,1):0}),o.isArrayOrTypedArray(b.color)&&(g=function(r){return r.mlc}),o.isArrayOrTypedArray(b.width)&&(v=function(r){return r.mlw});for(var _=0;_<r.length;_++){var w=r[_],T=w.fOut;if(T){var k=T.properties;k.fc=y(w.z),m&&(k.mo=m(w)),g&&(k.mlc=g(w)),v&&(k.mlw=v(w)),w.ct=k.ct,w._polygons=u.feature2polygons(T)}}var A=m?{type:"identity",property:"mo"}:x.opacity;return o.extendFlat(l.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":A}),o.extendFlat(h.paint,{"line-color":g?{type:"identity",property:"mlc"}:b.color,"line-width":v?{type:"identity",property:"mlw"}:b.width,"line-opacity":A}),l.layout.visibility="visible",h.layout.visibility="visible",p.geojson={type:"FeatureCollection",features:d},f(r),p},convertOnSelect:f}},{"../../components/colorscale":378,"../../components/drawing":388,"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/geojson_utils":497,"fast-isnumeric":190}],727:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/colorscale/defaults"),s=r("./attributes");n.exports=function(r,n,i,l){function c(i,o){return a.coerce(r,n,s,i,o)}var u=c("locations"),f=c("z"),h=c("geojson");a.isArrayOrTypedArray(u)&&u.length&&a.isArrayOrTypedArray(f)&&f.length&&("string"==typeof h&&""!==h||a.isPlainObject(h))?(c("featureidkey"),n._length=Math.min(u.length,f.length),c("below"),c("text"),c("hovertext"),c("hovertemplate"),c("marker.line.width")&&c("marker.line.color"),c("marker.opacity"),o(r,n,l,c,{prefix:"",cLetter:"z"}),a.coerceSelectionMarkerOpacity(n,c)):n.visible=!1}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":725}],728:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),calc:r("../choropleth/calc"),plot:r("./plot"),hoverPoints:r("../choropleth/hover"),eventData:r("../choropleth/event_data"),selectPoints:r("../choropleth/select"),styleOnSelect:function(r,n){n&&n[0].trace._glTrace.updateOnSelect(n)},getBelow:function(r,n){for(var i=n.getMapLayers(),a=i.length-2;a>=0;a--){var o=i[a].id;if("string"==typeof o&&0===o.indexOf("water")){for(var s=a+1;s<i.length;s++)if("string"==typeof(o=i[s].id)&&-1===o.indexOf("plotly-"))return o}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:r("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":613,"../choropleth/calc":717,"../choropleth/event_data":719,"../choropleth/hover":720,"../choropleth/select":723,"../heatmap/colorbar":795,"./attributes":725,"./defaults":727,"./plot":729}],729:[function(r,n,i){"use strict";var a=r("./convert").convert,o=r("./convert").convertOnSelect,s=r("../../plots/mapbox/constants").traceLayerPrefix;function l(r,n){this.type="choroplethmapbox",this.subplot=r,this.uid=n,this.sourceId="source-"+n,this.layerList=[["fill",s+n+"-fill"],["line",s+n+"-line"]],this.below=null}var c=l.prototype;c.update=function(r){this._update(a(r))},c.updateOnSelect=function(r){this._update(o(r))},c._update=function(r){var n=this.subplot,i=this.layerList,a=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(r.geojson),a!==this.below&&(this._removeLayers(),this._addLayers(r,a),this.below=a);for(var o=0;o<i.length;o++){var s=i[o],l=s[0],c=s[1],u=r[l];n.setOptions(c,"setLayoutProperty",u.layout),"visible"===u.layout.visibility&&n.setOptions(c,"setPaintProperty",u.paint)}},c._addLayers=function(r,n){for(var i=this.subplot,a=this.layerList,o=this.sourceId,s=0;s<a.length;s++){var l=a[s],c=l[0],u=r[c];i.addLayer({type:c,id:l[1],source:o,layout:u.layout,paint:u.paint},n)}},c._removeLayers=function(){for(var r=this.subplot.map,n=this.layerList,i=n.length-1;i>=0;i--)r.removeLayer(n[i][1])},c.dispose=function(){var r=this.subplot.map;this._removeLayers(),r.removeSource(this.sourceId)},n.exports=function(r,n){var i=n[0].trace,o=new l(r,i.uid),s=o.sourceId,c=a(n),u=o.below=r.belowLookup["trace-"+i.uid];return r.map.addSource(s,{type:"geojson",data:c.geojson}),o._addLayers(c,u),n[0].trace._glTrace=o,o}},{"../../plots/mapbox/constants":611,"./convert":726}],730:[function(r,n,i){"use strict";var a=r("../../components/colorscale/attributes"),o=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,s=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../mesh3d/attributes"),c=r("../../plots/attributes"),u=r("../../lib/extend").extendFlat,f={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:s({editType:"calc"},{keys:["norm"]}),uhoverformat:o("u",1),vhoverformat:o("v",1),whoverformat:o("w",1),xhoverformat:o("x"),yhoverformat:o("y"),zhoverformat:o("z"),showlegend:u({},c.showlegend,{dflt:!1})};u(f,a("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(r){f[r]=l[r]}),f.hoverinfo=u({},c.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),f.transforms=void 0,n.exports=f},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../mesh3d/attributes":867}],731:[function(r,n,i){"use strict";var a=r("../../components/colorscale/calc");n.exports=function(r,n){for(var i=n.u,o=n.v,s=n.w,l=Math.min(n.x.length,n.y.length,n.z.length,i.length,o.length,s.length),c=-1/0,u=1/0,f=0;f<l;f++){var h=i[f],p=o[f],d=s[f],m=Math.sqrt(h*h+p*p+d*d);c=Math.max(c,m),u=Math.min(u,m)}n._len=l,n._normMax=c,a(r,n,{vals:[u,c],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374}],732:[function(r,n,i){"use strict";var a=r("../../../stackgl_modules").gl_cone3d,o=r("../../../stackgl_modules").gl_cone3d.createConeMesh,s=r("../../lib").simpleMap,l=r("../../lib/gl_format_color").parseColorScale,c=r("../../components/colorscale").extractOpts,u=r("../../plots/gl3d/zip3");function f(r,n){this.scene=r,this.uid=n,this.mesh=null,this.data=null}var h=f.prototype;h.handlePick=function(r){if(r.object===this.mesh){var n=r.index=r.data.index,i=this.data.x[n],a=this.data.y[n],o=this.data.z[n],s=this.data.u[n],l=this.data.v[n],c=this.data.w[n];r.traceCoordinate=[i,a,o,s,l,c,Math.sqrt(s*s+l*l+c*c)];var u=this.data.hovertext||this.data.text;return Array.isArray(u)&&void 0!==u[n]?r.textLabel=u[n]:u&&(r.textLabel=u),!0}};var p={xaxis:0,yaxis:1,zaxis:2},d={tip:1,tail:0,cm:.25,center:.5},m={tip:1,tail:1,cm:.75,center:.5};function g(r,n){var i=r.fullSceneLayout,o=r.dataScale,f={};function h(r,n){var a=i[n],l=o[p[n]];return s(r,function(r){return a.d2l(r)*l})}f.vectors=u(h(n.u,"xaxis"),h(n.v,"yaxis"),h(n.w,"zaxis"),n._len),f.positions=u(h(n.x,"xaxis"),h(n.y,"yaxis"),h(n.z,"zaxis"),n._len);var g=c(n);f.colormap=l(n),f.vertexIntensityBounds=[g.min/n._normMax,g.max/n._normMax],f.coneOffset=d[n.anchor],"scaled"===n.sizemode?f.coneSize=n.sizeref||.5:f.coneSize=n.sizeref&&n._normMax?n.sizeref/n._normMax:.5;var v=a(f),y=n.lightposition;return v.lightPosition=[y.x,y.y,y.z],v.ambient=n.lighting.ambient,v.diffuse=n.lighting.diffuse,v.specular=n.lighting.specular,v.roughness=n.lighting.roughness,v.fresnel=n.lighting.fresnel,v.opacity=n.opacity,n._pad=m[n.anchor]*v.vectorScale*v.coneScale*n._normMax,v}h.update=function(r){this.data=r;var n=g(this.scene,r);this.mesh.update(n)},h.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},n.exports=function(r,n){var i=o(r.glplot.gl,g(r,n)),a=new f(r,n.uid);return a.mesh=i,a.data=n,i._trace=a,r.glplot.add(i),a}},{"../../../stackgl_modules":1120,"../../components/colorscale":378,"../../lib":503,"../../lib/gl_format_color":499,"../../plots/gl3d/zip3":609}],733:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/colorscale/defaults"),s=r("./attributes");n.exports=function(r,n,i,l){function c(i,o){return a.coerce(r,n,s,i,o)}var u=c("u"),f=c("v"),h=c("w"),p=c("x"),d=c("y"),m=c("z");u&&u.length&&f&&f.length&&h&&h.length&&p&&p.length&&d&&d.length&&m&&m.length?(c("sizeref"),c("sizemode"),c("anchor"),c("lighting.ambient"),c("lighting.diffuse"),c("lighting.specular"),c("lighting.roughness"),c("lighting.fresnel"),c("lightposition.x"),c("lightposition.y"),c("lightposition.z"),o(r,n,l,c,{prefix:"",cLetter:"c"}),c("text"),c("hovertext"),c("hovertemplate"),c("uhoverformat"),c("vhoverformat"),c("whoverformat"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),n._length=null):n.visible=!1}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":730}],734:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"cone",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:r("./calc"),plot:r("./convert"),eventData:function(r,n){return r.norm=n.traceCoordinate[6],r},meta:{}}},{"../../plots/gl3d":598,"./attributes":730,"./calc":731,"./convert":732,"./defaults":733}],735:[function(r,n,i){"use strict";var a=r("../heatmap/attributes"),o=r("../scatter/attributes"),s=r("../../plots/cartesian/axis_format_attributes"),l=s.axisHoverFormat,c=s.descriptionOnlyNumbers,u=r("../../components/colorscale/attributes"),f=r("../../components/drawing/attributes").dash,h=r("../../plots/font_attributes"),p=r("../../lib/extend").extendFlat,d=r("../../constants/filter_ops"),m=d.COMPARISON_OPS2,g=d.INTERVAL_OPS,v=o.line;n.exports=p({z:a.z,x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:o.xperiod0,yperiod0:o.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,text:a.text,hovertext:a.hovertext,transpose:a.transpose,xtype:a.xtype,ytype:a.ytype,xhoverformat:l("x"),yhoverformat:l("y"),zhoverformat:l("z",1),hovertemplate:a.hovertemplate,texttemplate:p({},a.texttemplate,{}),textfont:p({},a.textfont,{}),hoverongaps:a.hoverongaps,connectgaps:p({},a.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:h({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:c("contour label")},operation:{valType:"enumerated",values:[].concat(m).concat(g),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:p({},v.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:f,smoothing:p({},v.smoothing,{}),editType:"plot"}},u("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../constants/filter_ops":475,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../heatmap/attributes":792,"../scatter/attributes":926}],736:[function(r,n,i){"use strict";var a=r("../../components/colorscale"),o=r("../heatmap/calc"),s=r("./set_contours"),l=r("./end_plus");n.exports=function(r,n){var i=o(r,n),c=i[0].z;s(n,c);var u,f=n.contours,h=a.extractOpts(n);if("heatmap"===f.coloring&&h.auto&&!1===n.autocontour){var p=f.start,d=l(f),m=f.size||1,g=Math.floor((d-p)/m)+1;isFinite(m)||(m=1,g=1);var v=p-m/2;u=[v,v+g*m]}else u=c;return a.calc(r,n,{vals:u,cLetter:"z"}),i}},{"../../components/colorscale":378,"../heatmap/calc":793,"./end_plus":746,"./set_contours":754}],737:[function(r,n,i){"use strict";n.exports=function(r,n){var i,a=r[0],o=a.z;switch(n.type){case"levels":var s=Math.min(o[0][0],o[0][1]);for(i=0;i<r.length;i++){var l=r[i];l.prefixBoundary=!l.edgepaths.length&&(s>l.level||l.starts.length&&s===l.level)}break;case"constraint":if(a.prefixBoundary=!1,a.edgepaths.length)return;var c=a.x.length,u=a.y.length,f=-1/0,h=1/0;for(i=0;i<u;i++)h=Math.min(h=Math.min(h,o[i][0]),o[i][c-1]),f=Math.max(f=Math.max(f,o[i][0]),o[i][c-1]);for(i=1;i<c-1;i++)h=Math.min(h=Math.min(h,o[0][i]),o[u-1][i]),f=Math.max(f=Math.max(f,o[0][i]),o[u-1][i]);var p,d,m=n.value;switch(n._operation){case">":m>f&&(a.prefixBoundary=!0);break;case"<":(m<h||a.starts.length&&m===h)&&(a.prefixBoundary=!0);break;case"[]":p=Math.min(m[0],m[1]),((d=Math.max(m[0],m[1]))<h||p>f||a.starts.length&&d===h)&&(a.prefixBoundary=!0);break;case"][":p=Math.min(m[0],m[1]),d=Math.max(m[0],m[1]),p<h&&d>f&&(a.prefixBoundary=!0)}}}},{}],738:[function(r,n,i){"use strict";var a=r("../../components/colorscale"),o=r("./make_color_map"),s=r("./end_plus");n.exports={min:"zmin",max:"zmax",calc:function(r,n,i){var l=n.contours,c=n.line,u=l.size||1,f=l.coloring,h=o(n,{isColorbar:!0});if("heatmap"===f){var p=a.extractOpts(n);i._fillgradient=p.reversescale?a.flipScale(p.colorscale):p.colorscale,i._zrange=[p.min,p.max]}else"fill"===f&&(i._fillcolor=h);i._line={color:"lines"===f?h:c.color,width:!1!==l.showlines?c.width:0,dash:c.dash},i._levels={start:l.start,end:s(l),size:u}}}},{"../../components/colorscale":378,"./end_plus":746,"./make_color_map":751}],739:[function(r,n,i){"use strict";n.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],740:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("./label_defaults"),s=r("../../components/color"),l=s.addOpacity,c=s.opacity,u=r("../../constants/filter_ops"),f=u.CONSTRAINT_REDUCTION,h=u.COMPARISON_OPS2;n.exports=function(r,n,i,s,u,p){var d,m,g,v,y=n.contours,x=i("contours.operation");y._operation=f[x],-1===h.indexOf(y.operation)?(i("contours.value",[0,1]),Array.isArray(y.value)?y.value.length>2?y.value=y.value.slice(2):0===y.length?y.value=[0,1]:y.length<2?(d=parseFloat(y.value[0]),y.value=[d,d+1]):y.value=[parseFloat(y.value[0]),parseFloat(y.value[1])]:a(y.value)&&(d=parseFloat(y.value),y.value=[d,d+1])):(i("contours.value",0),a(y.value)||(Array.isArray(y.value)?y.value=parseFloat(y.value[0]):y.value=0)),"="===x?m=y.showlines=!0:(m=i("contours.showlines"),v=i("fillcolor",l((r.line||{}).color||u,.5))),m&&(g=i("line.color",v&&c(v)?l(n.fillcolor,1):u),i("line.width",2),i("line.dash")),i("line.smoothing"),o(i,s,g,p)}},{"../../components/color":366,"../../constants/filter_ops":475,"./label_defaults":750,"fast-isnumeric":190}],741:[function(r,n,i){"use strict";var a=r("../../constants/filter_ops"),o=r("fast-isnumeric");function s(r,n){var i,s=Array.isArray(n);function l(r){return o(r)?+r:null}return -1!==a.COMPARISON_OPS2.indexOf(r)?i=l(s?n[0]:n):-1!==a.INTERVAL_OPS.indexOf(r)?i=s?[l(n[0]),l(n[1])]:[l(n),l(n)]:-1!==a.SET_OPS.indexOf(r)&&(i=s?n.map(l):[l(n)]),i}function l(r){return function(n){var i=Math.min((n=s(r,n))[0],n[1]),a=Math.max(n[0],n[1]);return{start:i,end:a,size:a-i}}}function c(r){return function(n){return{start:n=s(r,n),end:1/0,size:1/0}}}n.exports={"[]":l("[]"),"][":l("]["),">":c(">"),"<":c("<"),"=":c("=")}},{"../../constants/filter_ops":475,"fast-isnumeric":190}],742:[function(r,n,i){"use strict";n.exports=function(r,n,i,a){var o=a("contours.start"),s=a("contours.end"),l=i("contours.size");((!1===o||!1===s?n.autocontour=!0:i("autocontour",!1))||!l)&&i("ncontours")}},{}],743:[function(r,n,i){"use strict";var a=r("../../lib");function o(r){return a.extendFlat({},r,{edgepaths:a.extendDeep([],r.edgepaths),paths:a.extendDeep([],r.paths),starts:a.extendDeep([],r.starts)})}n.exports=function(r,n){var i,s,l,c=function(r){return r.reverse()},u=function(r){return r};switch(n){case"=":case"<":return r;case">":for(1!==r.length&&a.warn("Contour data invalid for the specified inequality operation."),s=r[0],i=0;i<s.edgepaths.length;i++)s.edgepaths[i]=c(s.edgepaths[i]);for(i=0;i<s.paths.length;i++)s.paths[i]=c(s.paths[i]);for(i=0;i<s.starts.length;i++)s.starts[i]=c(s.starts[i]);return r;case"][":var f=c;c=u,u=f;case"[]":for(2!==r.length&&a.warn("Contour data invalid for the specified inequality range operation."),s=o(r[0]),l=o(r[1]),i=0;i<s.edgepaths.length;i++)s.edgepaths[i]=c(s.edgepaths[i]);for(i=0;i<s.paths.length;i++)s.paths[i]=c(s.paths[i]);for(i=0;i<s.starts.length;i++)s.starts[i]=c(s.starts[i]);for(;l.edgepaths.length;)s.edgepaths.push(u(l.edgepaths.shift()));for(;l.paths.length;)s.paths.push(u(l.paths.shift()));for(;l.starts.length;)s.starts.push(u(l.starts.shift()));return[s]}}},{"../../lib":503}],744:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../heatmap/xyz_defaults"),s=r("../scatter/period_defaults"),l=r("./constraint_defaults"),c=r("./contours_defaults"),u=r("./style_defaults"),f=r("../heatmap/label_defaults"),h=r("./attributes");n.exports=function(r,n,i,p){function d(i,o){return a.coerce(r,n,h,i,o)}if(o(r,n,d,p)){s(r,n,p,d),d("xhoverformat"),d("yhoverformat"),d("text"),d("hovertext"),d("hoverongaps"),d("hovertemplate");var m="constraint"===d("contours.type");d("connectgaps",a.isArray1D(n.z)),m?l(r,n,d,p,i):(c(r,n,d,function(i){return a.coerce2(r,n,h,i)}),u(r,n,d,p)),n.contours&&"heatmap"===n.contours.coloring&&f(d,p)}else n.visible=!1}},{"../../lib":503,"../heatmap/label_defaults":802,"../heatmap/xyz_defaults":807,"../scatter/period_defaults":946,"./attributes":735,"./constraint_defaults":740,"./contours_defaults":742,"./style_defaults":756}],745:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./constraint_mapping"),s=r("./end_plus");n.exports=function(r,n,i){for(var l="constraint"===r.type?o[r._operation](r.value):r,c=l.size,u=[],f=s(l),h=i.trace._carpetTrace,p=h?{xaxis:h.aaxis,yaxis:h.baxis,x:i.a,y:i.b}:{xaxis:n.xaxis,yaxis:n.yaxis,x:i.x,y:i.y},d=l.start;d<f;d+=c)if(u.push(a.extendFlat({level:d,crossings:{},starts:[],edgepaths:[],paths:[],z:i.z,smoothing:i.trace.line.smoothing},p)),u.length>1e3){a.warn("Too many contours, clipping at 1000",r);break}return u}},{"../../lib":503,"./constraint_mapping":741,"./end_plus":746}],746:[function(r,n,i){"use strict";n.exports=function(r){return r.end+r.size/1e6}},{}],747:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./constants");function s(r,n,i,a){return Math.abs(r[0]-n[0])<i&&Math.abs(r[1]-n[1])<a}function l(r,n,i,l,u){var f,h,p,d,m=n.join(","),g=r.crossings[m],v=(h=0,p=0,(f=g)>20&&i?208===f||1114===f?h=0===n[0]?1:-1:p=0===n[1]?1:-1:-1!==o.BOTTOMSTART.indexOf(f)?p=1:-1!==o.LEFTSTART.indexOf(f)?h=1:-1!==o.TOPSTART.indexOf(f)?p=-1:h=-1,[h,p]),y=[c(r,n,[-v[0],-v[1]])],x=r.z.length,b=r.z[0].length,_=n.slice(),w=v.slice();for(d=0;d<1e4;d++){if(g>20?(g=o.CHOOSESADDLE[g][0>(v[0]||v[1])?0:1],r.crossings[m]=o.SADDLEREMAINDER[g]):delete r.crossings[m],!(v=o.NEWDELTA[g])){a.log("Found bad marching index:",g,n,r.level);break}y.push(c(r,n,v)),n[0]+=v[0],n[1]+=v[1],m=n.join(","),s(y[y.length-1],y[y.length-2],l,u)&&y.pop();var T=v[0]&&(n[0]<0||n[0]>b-2)||v[1]&&(n[1]<0||n[1]>x-2);if(n[0]===_[0]&&n[1]===_[1]&&v[0]===w[0]&&v[1]===w[1]||i&&T)break;g=r.crossings[m]}1e4===d&&a.log("Infinite loop in contour?");var k,A,M,S,E,L,C,P,I,O,z,D,R,F,B,N=s(y[0],y[y.length-1],l,u),j=0,U=.2*r.smoothing,V=[],H=0;for(d=1;d<y.length;d++)D=y[d],R=y[d-1],F=void 0,B=void 0,j+=C=Math.sqrt((F=D[2]-R[2])*F+(B=D[3]-R[3])*B),V.push(C);var q=j/V.length*U;function G(r){return y[r%y.length]}for(d=y.length-2;d>=H;d--)if((k=V[d])<q){for(M=0,A=d-1;A>=H&&k+V[A]<q;A--)k+=V[A];if(N&&d===y.length-2)for(M=0;M<A&&k+V[M]<q;M++)k+=V[M];E=d-A+M+1,L=Math.floor((d+A+M+2)/2),S=N||d!==y.length-2?N||-1!==A?E%2?G(L):[(G(L)[0]+G(L+1)[0])/2,(G(L)[1]+G(L+1)[1])/2]:y[0]:y[y.length-1],y.splice(A+1,d-A+1,S),d=A+1,M&&(H=M),N&&(d===y.length-2?y[M]=y[y.length-1]:0===d&&(y[y.length-1]=y[0]))}for(y.splice(0,H),d=0;d<y.length;d++)y[d].length=2;if(!(y.length<2)){if(N)y.pop(),r.paths.push(y);else{i||a.log("Unclosed interior contour?",r.level,_.join(","),y.join("L"));var Y=!1;for(P=0;P<r.edgepaths.length;P++)if(O=r.edgepaths[P],!Y&&s(O[0],y[y.length-1],l,u)){y.pop(),Y=!0;var W=!1;for(I=0;I<r.edgepaths.length;I++)if(s((z=r.edgepaths[I])[z.length-1],y[0],l,u)){W=!0,y.shift(),r.edgepaths.splice(P,1),I===P?r.paths.push(y.concat(z)):(I>P&&I--,r.edgepaths[I]=z.concat(y,O));break}W||(r.edgepaths[P]=y.concat(O))}for(P=0;P<r.edgepaths.length&&!Y;P++)s((O=r.edgepaths[P])[O.length-1],y[0],l,u)&&(y.shift(),r.edgepaths[P]=O.concat(y),Y=!0);Y||r.edgepaths.push(y)}}}function c(r,n,i){var a=n[0]+Math.max(i[0],0),o=n[1]+Math.max(i[1],0),s=r.z[o][a],l=r.xaxis,c=r.yaxis;if(i[1]){var u=(r.level-s)/(r.z[o][a+1]-s),f=(1!==u?(1-u)*l.c2l(r.x[a]):0)+(0!==u?u*l.c2l(r.x[a+1]):0);return[l.c2p(l.l2c(f),!0),c.c2p(r.y[o],!0),a+u,o]}var h=(r.level-s)/(r.z[o+1][a]-s),p=(1!==h?(1-h)*c.c2l(r.y[o]):0)+(0!==h?h*c.c2l(r.y[o+1]):0);return[l.c2p(r.x[a],!0),c.c2p(c.l2c(p),!0),a,o+h]}n.exports=function(r,n,i){var o,s,c,u;for(n=n||.01,i=i||.01,s=0;s<r.length;s++){for(c=r[s],u=0;u<c.starts.length;u++)l(c,c.starts[u],"edge",n,i);for(o=0;Object.keys(c.crossings).length&&o<1e4;)o++,l(c,Object.keys(c.crossings)[0].split(",").map(Number),void 0,n,i);1e4===o&&a.log("Infinite loop in contour?")}}},{"../../lib":503,"./constants":739}],748:[function(r,n,i){"use strict";var a=r("../../components/color"),o=r("../heatmap/hover");n.exports=function(r,n,i,s,l){l||(l={}),l.isContour=!0;var c=o(r,n,i,s,l);return c&&c.forEach(function(r){var n=r.trace;"constraint"===n.contours.type&&(n.fillcolor&&a.opacity(n.fillcolor)?r.color=a.addOpacity(n.fillcolor,1):n.contours.showlines&&a.opacity(n.line.color)&&(r.color=a.addOpacity(n.line.color,1)))}),c}},{"../../components/color":366,"../heatmap/hover":799}],749:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot").plot,style:r("./style"),colorbar:r("./colorbar"),hoverPoints:r("./hover"),moduleType:"trace",name:"contour",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":568,"./attributes":735,"./calc":736,"./colorbar":738,"./defaults":744,"./hover":748,"./plot":753,"./style":755}],750:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n,i,o){if(o||(o={}),r("contours.showlabels")){var s=n.font;a.coerceFont(r,"contours.labelfont",{family:s.family,size:s.size,color:i}),r("contours.labelformat")}!1!==o.hasHover&&r("zhoverformat")}},{"../../lib":503}],751:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/colorscale"),s=r("./end_plus");n.exports=function(r){var n=r.contours,i=n.start,l=s(n),c=n.size||1,u=Math.floor((l-i)/c)+1,f="lines"===n.coloring?0:1,h=o.extractOpts(r);isFinite(c)||(c=1,u=1);var p,d,m=h.reversescale?o.flipScale(h.colorscale):h.colorscale,g=m.length,v=Array(g),y=Array(g);if("heatmap"===n.coloring){var x=h.min,b=h.max;for(d=0;d<g;d++)p=m[d],v[d]=p[0]*(b-x)+x,y[d]=p[1];var _=a.extent([x,b,n.start,n.start+c*(u-1)]),w=_[x<b?0:1],T=_[x<b?1:0];w!==x&&(v.splice(0,0,w),y.splice(0,0,y[0])),T!==b&&(v.push(T),y.push(y[y.length-1]))}else for(d=0;d<g;d++)p=m[d],v[d]=(p[0]*(u+f-1)-f/2)*c+i,y[d]=p[1];return o.makeColorScaleFunc({domain:v,range:y},{noNumericCheck:!0})}},{"../../components/colorscale":378,"./end_plus":746,"@plotly/d3":58}],752:[function(r,n,i){"use strict";var a=r("./constants");n.exports=function(r){var n,i,o,s,l,c,u,f,h,p=r[0].z,d=p.length,m=p[0].length,g=2===d||2===m;for(i=0;i<d-1;i++)for(s=[],0===i&&(s=s.concat(a.BOTTOMSTART)),i===d-2&&(s=s.concat(a.TOPSTART)),n=0;n<m-1;n++)for(o=s.slice(),0===n&&(o=o.concat(a.LEFTSTART)),n===m-2&&(o=o.concat(a.RIGHTSTART)),l=n+","+i,c=[[p[i][n],p[i][n+1]],[p[i+1][n],p[i+1][n+1]]],h=0;h<r.length;h++)(u=function(r,n){var i=(n[0][0]>r?0:1)+(n[0][1]>r?0:2)+(n[1][1]>r?0:4)+(n[1][0]>r?0:8);return 5===i||10===i?r>(n[0][0]+n[0][1]+n[1][0]+n[1][1])/4?5===i?713:1114:5===i?104:208:15===i?0:i}((f=r[h]).level,c))&&(f.crossings[l]=u,-1!==o.indexOf(u)&&(f.starts.push([n,i]),g&&-1!==o.indexOf(u,o.indexOf(u)+1)&&f.starts.push([n,i])))}},{"./constants":739}],753:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../components/drawing"),l=r("../../components/colorscale"),c=r("../../lib/svg_text_utils"),u=r("../../plots/cartesian/axes"),f=r("../../plots/cartesian/set_convert"),h=r("../heatmap/plot"),p=r("./make_crossings"),d=r("./find_all_paths"),m=r("./empty_pathinfo"),g=r("./convert_to_constraints"),v=r("./close_boundaries"),y=r("./constants"),x=y.LABELOPTIMIZER;function b(r,n){var i,a,l,c,u,f,h="",p=0,d=r.edgepaths.map(function(r,n){return n}),m=!0;function g(r){return .01>Math.abs(r[0]-n[2][0])}for(;d.length;){for(f=s.smoothopen(r.edgepaths[p],r.smoothing),h+=m?f:f.replace(/^M/,"L"),d.splice(d.indexOf(p),1),i=r.edgepaths[p][r.edgepaths[p].length-1],c=-1,l=0;l<4;l++){if(!i){o.log("Missing end?",p,r);break}for(.01>Math.abs(i[1]-n[0][1])&&!g(i)?a=n[1]:.01>Math.abs(i[0]-n[0][0])?a=n[0]:.01>Math.abs(i[1]-n[2][1])?a=n[3]:g(i)&&(a=n[2]),u=0;u<r.edgepaths.length;u++){var v=r.edgepaths[u][0];.01>Math.abs(i[0]-a[0])?.01>Math.abs(i[0]-v[0])&&(v[1]-i[1])*(a[1]-v[1])>=0&&(a=v,c=u):.01>Math.abs(i[1]-a[1])?.01>Math.abs(i[1]-v[1])&&(v[0]-i[0])*(a[0]-v[0])>=0&&(a=v,c=u):o.log("endpt to newendpt is not vert. or horz.",i,a,v)}if(i=a,c>=0)break;h+="L"+a}if(c===r.edgepaths.length){o.log("unclosed perimeter path");break}p=c,(m=-1===d.indexOf(p))&&(p=d[0],h+="Z")}for(p=0;p<r.paths.length;p++)h+=s.smoothclosed(r.paths[p],r.smoothing);return h}i.plot=function(r,n,l,c){var u=n.xaxis,f=n.yaxis;o.makeTraceGroups(c,l,"contour").each(function(l){var c,x,_,w,T,k=a.select(this),A=l[0],M=A.trace,S=A.x,E=A.y,L=M.contours,C=m(L,n,A),P=o.ensureSingle(k,"g","heatmapcoloring"),I=[];"heatmap"===L.coloring&&(I=[l]),h(r,n,I,P),p(C),d(C);var O=u.c2p(S[0],!0),z=u.c2p(S[S.length-1],!0),D=f.c2p(E[0],!0),R=f.c2p(E[E.length-1],!0),F=[[O,R],[z,R],[z,D],[O,D]],B=C;"constraint"===L.type&&(B=g(C,L._operation)),(c=o.ensureSingle(k,"g","contourbg").selectAll("path").data("fill"===L.coloring?[0]:[])).enter().append("path"),c.exit().remove(),c.attr("d","M"+F.join("L")+"Z").style("stroke","none"),x=B,_="fill"===L.coloring||"constraint"===L.type&&"="!==L._operation,w="M"+F.join("L")+"Z",_&&v(x,L),(T=o.ensureSingle(k,"g","contourfill").selectAll("path").data(_?x:[])).enter().append("path"),T.exit().remove(),T.each(function(r){var n=(r.prefixBoundary?w:"")+b(r,F);n?a.select(this).attr("d",n).style("stroke","none"):a.select(this).remove()}),function(r,n,l,c,u){var f=o.ensureSingle(r,"g","contourlines"),h=!1!==u.showlines,p=u.showlabels,d=h&&p,m=i.createLines(f,h||p,n),g=i.createLineClip(f,d,l,c.trace.uid),v=r.selectAll("g.contourlabels").data(p?[0]:[]);if(v.exit().remove(),v.enter().append("g").classed("contourlabels",!0),p){var x=[],b=[];o.clearLocationCache();var _=i.labelFormatter(l,c),w=s.tester.append("text").attr("data-notex",1).call(s.font,u.labelfont),T=n[0].xaxis,k=n[0].yaxis,A=T._length,M=k._length,S=T.range,E=k.range,L=o.aggNums(Math.min,null,c.x),C=o.aggNums(Math.max,null,c.x),P=o.aggNums(Math.min,null,c.y),I=o.aggNums(Math.max,null,c.y),O=Math.max(T.c2p(L,!0),0),z=Math.min(T.c2p(C,!0),A),D=Math.max(k.c2p(I,!0),0),R=Math.min(k.c2p(P,!0),M),F={};S[0]<S[1]?(F.left=O,F.right=z):(F.left=z,F.right=O),E[0]<E[1]?(F.top=D,F.bottom=R):(F.top=R,F.bottom=D),F.middle=(F.top+F.bottom)/2,F.center=(F.left+F.right)/2,x.push([[F.left,F.top],[F.right,F.top],[F.right,F.bottom],[F.left,F.bottom]]);var B=Math.sqrt(A*A+M*M),N=y.LABELDISTANCE*B/Math.max(1,n.length/y.LABELINCREASE);m.each(function(r){var n=i.calcTextOpts(r.level,_,w,l);a.select(this).selectAll("path").each(function(){var r=o.getVisibleSegment(this,F,n.height/2);if(r&&!(r.len<(n.width+n.height)*y.LABELMIN))for(var a=Math.min(Math.ceil(r.len/N),y.LABELMAX),s=0;s<a;s++){var l=i.findBestTextLocation(this,r,n,b,F);if(!l)break;i.addLabelData(l,n,b,x)}})}),w.remove(),i.drawLabels(v,b,l,g,d?x:null)}p&&!h&&m.remove()}(k,C,r,A,L),function(r,n,i,a,l){var c=a.trace,u=i._fullLayout._clips,f="clip"+c.uid,h=u.selectAll("#"+f).data(c.connectgaps?[]:[0]);if(h.enter().append("clipPath").classed("contourclip",!0).attr("id",f),h.exit().remove(),!1===c.connectgaps){var m={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:n.xaxis,yaxis:n.yaxis,x:a.x,y:a.y,z:function(r){var n,i,a=r.trace._emptypoints,o=[],s=r.z.length,l=r.z[0].length,c=[];for(n=0;n<l;n++)c.push(1);for(n=0;n<s;n++)o.push(c.slice());for(n=0;n<a.length;n++)o[(i=a[n])[0]][i[1]]=0;return r.zmask=o,o}(a),smoothing:0};p([m]),d([m]),v([m],{type:"levels"}),o.ensureSingle(h,"path","").attr("d",(m.prefixBoundary?"M"+l.join("L")+"Z":"")+b(m,l))}else f=null;s.setClipUrl(r,f,i)}(k,n,r,A,F)})},i.createLines=function(r,n,i){var a=i[0].smoothing,o=r.selectAll("g.contourlevel").data(n?i:[]);if(o.exit().remove(),o.enter().append("g").classed("contourlevel",!0),n){var l=o.selectAll("path.openline").data(function(r){return r.pedgepaths||r.edgepaths});l.exit().remove(),l.enter().append("path").classed("openline",!0),l.attr("d",function(r){return s.smoothopen(r,a)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var c=o.selectAll("path.closedline").data(function(r){return r.ppaths||r.paths});c.exit().remove(),c.enter().append("path").classed("closedline",!0),c.attr("d",function(r){return s.smoothclosed(r,a)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return o},i.createLineClip=function(r,n,i,a){var o=n?"clipline"+a:null,l=i._fullLayout._clips.selectAll("#"+o).data(n?[0]:[]);return l.exit().remove(),l.enter().append("clipPath").classed("contourlineclip",!0).attr("id",o),s.setClipUrl(r,o,i),l},i.labelFormatter=function(r,n){var i=r._fullLayout,a=n.trace,o=a.contours,s={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(o.labelformat)s.tickformat=o.labelformat,f(s,i);else{var c=l.extractOpts(a);if(c&&c.colorbar&&c.colorbar._axis)s=c.colorbar._axis;else{if("constraint"===o.type){var h=o.value;Array.isArray(h)?s.range=[h[0],h[h.length-1]]:s.range=[h,h]}else s.range=[o.start,o.end],s.nticks=(o.end-o.start)/o.size;s.range[0]===s.range[1]&&(s.range[1]+=s.range[0]||1),s.nticks||(s.nticks=1e3),f(s,i),u.prepTicks(s),s._tmin=null,s._tmax=null}}return function(r){return u.tickText(s,r).text}},i.calcTextOpts=function(r,n,i,a){var o=n(r);i.text(o).call(c.convertToTspans,a);var l=i.node(),u=s.bBox(l,!0);return{text:o,width:u.width,height:u.height,fontSize:+l.style["font-size"].replace("px",""),level:r,dy:(u.top+u.bottom)/2}},i.findBestTextLocation=function(r,n,i,a,s){var l,c,u,f,h,p=i.width;n.isClosed?(c=n.len/x.INITIALSEARCHPOINTS,l=n.min+c/2,u=n.max):(c=(n.len-p)/(x.INITIALSEARCHPOINTS+1),l=n.min+c+p/2,u=n.max-(c+p)/2);for(var d=1/0,m=0;m<x.ITERATIONS;m++){for(var g=l;g<u;g+=c){var v=o.getTextLocation(r,n.total,g,p),y=function(r,n,i,a){var s=n.width/2,l=n.height/2,c=r.x,u=r.y,f=r.theta,h=Math.cos(f)*s,p=Math.sin(f)*s,d=(c>a.center?a.right-c:c-a.left)/(h+Math.abs(Math.sin(f)*l)),m=(u>a.middle?a.bottom-u:u-a.top)/(Math.abs(p)+Math.cos(f)*l);if(d<1||m<1)return 1/0;var g=x.EDGECOST*(1/(d-1)+1/(m-1));g+=x.ANGLECOST*f*f;for(var v=c-h,y=u-p,b=c+h,_=u+p,w=0;w<i.length;w++){var T=i[w],k=Math.cos(T.theta)*T.width/2,A=Math.sin(T.theta)*T.width/2,M=2*o.segmentDistance(v,y,b,_,T.x-k,T.y-A,T.x+k,T.y+A)/(n.height+T.height),S=T.level===n.level,E=S?x.SAMELEVELDISTANCE:1;if(M<=E)return 1/0;g+=x.NEIGHBORCOST*(S?x.SAMELEVELFACTOR:1)/(M-E)}return g}(v,i,a,s);y<d&&(d=y,h=v,f=g)}if(d>2*x.MAXCOST)break;m&&(c/=2),u=(l=f-c/2)+1.5*c}if(d<=x.MAXCOST)return h},i.addLabelData=function(r,n,i,a){var o=n.fontSize,s=n.width+o/3,l=Math.max(0,n.height-o/3),c=r.x,u=r.y,f=r.theta,h=Math.sin(f),p=Math.cos(f),d=function(r,n){return[c+r*p-n*h,u+r*h+n*p]},m=[d(-s/2,-l/2),d(-s/2,l/2),d(s/2,l/2),d(s/2,-l/2)];i.push({text:n.text,x:c,y:u,dy:n.dy,theta:f,level:n.level,width:s,height:l}),a.push(m)},i.drawLabels=function(r,n,i,s,l){var u=r.selectAll("text").data(n,function(r){return r.text+","+r.x+","+r.y+","+r.theta});if(u.exit().remove(),u.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(r){var n=r.x+Math.sin(r.theta)*r.dy,o=r.y-Math.cos(r.theta)*r.dy;a.select(this).text(r.text).attr({x:n,y:o,transform:"rotate("+180*r.theta/Math.PI+" "+n+" "+o+")"}).call(c.convertToTspans,i)}),l){for(var f="",h=0;h<l.length;h++)f+="M"+l[h].join("L")+"Z";o.ensureSingle(s,"path","").attr("d",f)}}},{"../../components/colorscale":378,"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../plots/cartesian/set_convert":576,"../heatmap/plot":804,"./close_boundaries":737,"./constants":739,"./convert_to_constraints":743,"./empty_pathinfo":745,"./find_all_paths":747,"./make_crossings":752,"@plotly/d3":58}],754:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../lib");function s(r,n,i){var o={type:"linear",range:[r,n]};return a.autoTicks(o,(n-r)/(i||15)),o}n.exports=function(r,n){var i=r.contours;if(r.autocontour){var l=r.zmin,c=r.zmax;(r.zauto||void 0===l)&&(l=o.aggNums(Math.min,null,n)),(r.zauto||void 0===c)&&(c=o.aggNums(Math.max,null,n));var u=s(l,c,r.ncontours);i.size=u.dtick,i.start=a.tickFirst(u),u.range.reverse(),i.end=a.tickFirst(u),i.start===l&&(i.start+=i.size),i.end===c&&(i.end-=i.size),i.start>i.end&&(i.start=i.end=(i.start+i.end)/2),r._input.contours||(r._input.contours={}),o.extendFlat(r._input.contours,{start:i.start,end:i.end,size:i.size}),r._input.autocontour=!0}else if("constraint"!==i.type){var f,h=i.start,p=i.end,d=r._input.contours;h>p&&(i.start=d.start=p,p=i.end=d.end=h,h=i.start),i.size>0||(f=h===p?1:s(h,p,r.ncontours).dtick,d.size=i.size=f)}}},{"../../lib":503,"../../plots/cartesian/axes":554}],755:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/drawing"),s=r("../heatmap/style"),l=r("./make_color_map");n.exports=function(r){var n=a.select(r).selectAll("g.contour");n.style("opacity",function(r){return r[0].trace.opacity}),n.each(function(r){var n,i=a.select(this),s=r[0].trace,c=s.contours,u=s.line,f=c.size||1,h=c.start,p="constraint"===c.type,d=!p&&"lines"===c.coloring,m=!p&&"fill"===c.coloring,g=d||m?l(s):null;i.selectAll("g.contourlevel").each(function(r){a.select(this).selectAll("path").call(o.lineGroupStyle,u.width,d?g(r.level):u.color,u.dash)});var v=c.labelfont;(i.selectAll("g.contourlabels text").each(function(r){o.font(a.select(this),{family:v.family,size:v.size,color:v.color||(d?g(r.level):u.color)})}),p)?i.selectAll("g.contourfill path").style("fill",s.fillcolor):m&&(i.selectAll("g.contourfill path").style("fill",function(r){return void 0===n&&(n=r.level),g(r.level+.5*f)}),void 0===n&&(n=h),i.selectAll("g.contourbg path").style("fill",g(n-.5*f)))}),s(r)}},{"../../components/drawing":388,"../heatmap/style":805,"./make_color_map":751,"@plotly/d3":58}],756:[function(r,n,i){"use strict";var a=r("../../components/colorscale/defaults"),o=r("./label_defaults");n.exports=function(r,n,i,s,l){var c,u=i("contours.coloring"),f="";"fill"===u&&(c=i("contours.showlines")),!1!==c&&("lines"!==u&&(f=i("line.color","#000")),i("line.width",.5),i("line.dash")),"none"!==u&&(!0!==r.showlegend&&(n.showlegend=!1),n._dfltShowLegend=!1,a(r,n,s,i,{prefix:"",cLetter:"z"})),i("line.smoothing"),o(i,s,f,l)}},{"../../components/colorscale/defaults":376,"./label_defaults":750}],757:[function(r,n,i){"use strict";var a=r("../heatmap/attributes"),o=r("../contour/attributes"),s=r("../../components/colorscale/attributes"),l=r("../../lib/extend").extendFlat,c=o.contours;n.exports=l({carpet:{valType:"string",editType:"calc"},z:a.z,a:a.x,a0:a.x0,da:a.dx,b:a.y,b0:a.y0,db:a.dy,text:a.text,hovertext:a.hovertext,transpose:a.transpose,atype:a.xtype,btype:a.ytype,fillcolor:o.fillcolor,autocontour:o.autocontour,ncontours:o.ncontours,contours:{type:c.type,start:c.start,end:c.end,size:c.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:c.showlines,showlabels:c.showlabels,labelfont:c.labelfont,labelformat:c.labelformat,operation:c.operation,value:c.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:o.line.color,width:o.line.width,dash:o.line.dash,smoothing:o.line.smoothing,editType:"plot"},transforms:void 0},s("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../contour/attributes":735,"../heatmap/attributes":792}],758:[function(r,n,i){"use strict";var a=r("../../components/colorscale/calc"),o=r("../../lib"),s=r("../heatmap/convert_column_xyz"),l=r("../heatmap/clean_2d_array"),c=r("../heatmap/interp2d"),u=r("../heatmap/find_empties"),f=r("../heatmap/make_bound_array"),h=r("./defaults"),p=r("../carpet/lookup_carpetid"),d=r("../contour/set_contours");n.exports=function(r,n){var i=n._carpetTrace=p(r,n);if(i&&i.visible&&"legendonly"!==i.visible){if(!n.a||!n.b){var m,g,v,y,x,b,_,w,T,k,A,M,S,E,L,C=r.data[i.index],P=r.data[n.index];P.a||(P.a=C.a),P.b||(P.b=C.b),h(P,n,n._defaultColor,r._fullLayout)}var I=(T=(w=n._carpetTrace).aaxis,k=w.baxis,T._minDtick=0,k._minDtick=0,o.isArray1D(n.z)&&s(n,T,k,"a","b",["z"]),m=n._a=n._a||n.a,y=n._b=n._b||n.b,m=m?T.makeCalcdata(n,"_a"):[],y=y?k.makeCalcdata(n,"_b"):[],g=n.a0||0,v=n.da||1,x=n.b0||0,b=n.db||1,_=n._z=l(n._z||n.z,n.transpose),n._emptypoints=u(_),c(_,n._emptypoints),A=o.maxRowLength(_),M="scaled"===n.xtype?"":m,S=f(n,M,g,v,A,T),E="scaled"===n.ytype?"":y,L=f(n,E,x,b,_.length,k),"levels"===n.contours.type&&"none"!==n.contours.coloring&&a(r,n,{vals:_,containerStr:"",cLetter:"z"}),[{a:S,b:L,z:_}]);return d(n,n._z),I}}},{"../../components/colorscale/calc":374,"../../lib":503,"../carpet/lookup_carpetid":708,"../contour/set_contours":754,"../heatmap/clean_2d_array":794,"../heatmap/convert_column_xyz":796,"../heatmap/find_empties":798,"../heatmap/interp2d":801,"../heatmap/make_bound_array":803,"./defaults":759}],759:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../heatmap/xyz_defaults"),s=r("./attributes"),l=r("../contour/constraint_defaults"),c=r("../contour/contours_defaults"),u=r("../contour/style_defaults");n.exports=function(r,n,i,f){function h(i,o){return a.coerce(r,n,s,i,o)}if(h("carpet"),r.a&&r.b){if(!o(r,n,h,f,"a","b"))return void(n.visible=!1);h("text"),"constraint"===h("contours.type")?l(r,n,h,f,i,{hasHover:!1}):(c(r,n,h,function(i){return a.coerce2(r,n,s,i)}),u(r,n,h,f,{hasHover:!1}))}else n._defaultColor=i,n._length=null}},{"../../lib":503,"../contour/constraint_defaults":740,"../contour/contours_defaults":742,"../contour/style_defaults":756,"../heatmap/xyz_defaults":807,"./attributes":757}],760:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../contour/colorbar"),calc:r("./calc"),plot:r("./plot"),style:r("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":568,"../contour/colorbar":738,"../contour/style":755,"./attributes":757,"./calc":758,"./defaults":759,"./plot":761}],761:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../carpet/map_1d_array"),s=r("../carpet/makepath"),l=r("../../components/drawing"),c=r("../../lib"),u=r("../contour/make_crossings"),f=r("../contour/find_all_paths"),h=r("../contour/plot"),p=r("../contour/constants"),d=r("../contour/convert_to_constraints"),m=r("../contour/empty_pathinfo"),g=r("../contour/close_boundaries"),v=r("../carpet/lookup_carpetid"),y=r("../carpet/axis_aligned_line");function x(r,n,i){var a=r.getPointAtLength(n),o=r.getPointAtLength(i),s=o.x-a.x,l=o.y-a.y,c=Math.sqrt(s*s+l*l);return[s/c,l/c]}function b(r){var n=Math.sqrt(r[0]*r[0]+r[1]*r[1]);return[r[0]/n,r[1]/n]}function _(r,n){var i=Math.abs(r[0]*n[0]+r[1]*n[1]);return Math.sqrt(1-i*i)/i}n.exports=function(r,n,i,w){var T=n.xaxis,k=n.yaxis;c.makeTraceGroups(w,i,"contour").each(function(i){var w=a.select(this),A=i[0],M=A.trace,S=M._carpetTrace=v(r,M),E=r.calcdata[S.index][0];if(S.visible&&"legendonly"!==S.visible){var L,C,P,I=A.a,O=A.b,z=M.contours,D=m(z,n,A),R="constraint"===z.type,F=z._operation,B=R?"="===F?"lines":"fill":z.coloring,N=[[I[0],O[O.length-1]],[I[I.length-1],O[O.length-1]],[I[I.length-1],O[0]],[I[0],O[0]]];u(D),f(D,1e-8*(I[I.length-1]-I[0]),1e-8*(O[O.length-1]-O[0]));var j,U,V,H,q=D;"constraint"===z.type&&(q=d(D,F)),function(r,n){var i,a,o,s,l,c,u,f,h;for(i=0;i<r.length;i++){for(l=(s=r[i]).pedgepaths=[],c=s.ppaths=[],a=0;a<s.edgepaths.length;a++){for(h=s.edgepaths[a],u=[],o=0;o<h.length;o++)u[o]=n(h[o]);l.push(u)}for(a=0;a<s.paths.length;a++){for(h=s.paths[a],f=[],o=0;o<h.length;o++)f[o]=n(h[o]);c.push(f)}}}(D,W);var G=[];for(H=E.clipsegments.length-1;H>=0;H--)U=o([],(j=E.clipsegments[H]).x,T.c2p),V=o([],j.y,k.c2p),U.reverse(),V.reverse(),G.push(s(U,V,j.bicubic));var Y="M"+G.join("L")+"Z";(function(r,n,i,a,l,u){var f,h,p=c.ensureSingle(r,"g","contourbg").selectAll("path").data("fill"!==u||l?[]:[0]);p.enter().append("path"),p.exit().remove();var d=[];for(h=0;h<n.length;h++)d.push(s(o([],(f=n[h]).x,i.c2p),o([],f.y,a.c2p),f.bicubic));p.attr("d","M"+d.join("L")+"Z").style("stroke","none")})(w,E.clipsegments,T,k,R,B),L=q,(C="fill"===B)&&g(L,M.contours),(P=c.ensureSingle(w,"g","contourfill").selectAll("path").data(C?L:[])).enter().append("path"),P.exit().remove(),P.each(function(r){var n=(r.prefixBoundary?Y:"")+function(r,n,i,a,o,s,u,f){var h,p,d,m,g,v,x,b="",_=n.edgepaths.map(function(r,n){return n}),w=!0,T=1e-4*Math.abs(i[0][0]-i[2][0]),k=1e-4*Math.abs(i[0][1]-i[2][1]);function A(r){return Math.abs(r[1]-i[0][1])<k}function M(r){return Math.abs(r[1]-i[2][1])<k}function S(r){return Math.abs(r[0]-i[0][0])<T}function E(r){return Math.abs(r[0]-i[2][0])<T}function L(r,n){var i,a,l,c,h="";for(A(r)&&!E(r)||M(r)&&!S(r)?(c=o.aaxis,l=y(o,s,[r[0],n[0]],.5*(r[1]+n[1]))):(c=o.baxis,l=y(o,s,.5*(r[0]+n[0]),[r[1],n[1]])),i=1;i<l.length;i++)for(h+=c.smoothing?"C":"L",a=0;a<l[i].length;a++){var p=l[i][a];h+=[u.c2p(p[0]),f.c2p(p[1])]+" "}return h}for(h=0,p=null;_.length;){var C=n.edgepaths[h][0];for(p&&(b+=L(p,C)),x=l.smoothopen(n.edgepaths[h].map(a),n.smoothing),b+=w?x:x.replace(/^M/,"L"),_.splice(_.indexOf(h),1),p=n.edgepaths[h][n.edgepaths[h].length-1],g=-1,m=0;m<4;m++){if(!p){c.log("Missing end?",h,n);break}for(A(p)&&!E(p)?d=i[1]:S(p)?d=i[0]:M(p)?d=i[3]:E(p)&&(d=i[2]),v=0;v<n.edgepaths.length;v++){var P=n.edgepaths[v][0];Math.abs(p[0]-d[0])<T?Math.abs(p[0]-P[0])<T&&(P[1]-p[1])*(d[1]-P[1])>=0&&(d=P,g=v):Math.abs(p[1]-d[1])<k?Math.abs(p[1]-P[1])<k&&(P[0]-p[0])*(d[0]-P[0])>=0&&(d=P,g=v):c.log("endpt to newendpt is not vert. or horz.",p,d,P)}if(g>=0)break;b+=L(p,d),p=d}if(g===n.edgepaths.length){c.log("unclosed perimeter path");break}h=g,(w=-1===_.indexOf(h))&&(h=_[0],b+=L(p,d)+"Z",p=null)}for(h=0;h<n.paths.length;h++)b+=l.smoothclosed(n.paths[h].map(a),n.smoothing);return b}(0,r,N,W,S,E,T,k);n?a.select(this).attr("d",n).style("stroke","none"):a.select(this).remove()}),function(r,n,i,o,s,u,f){var d=c.ensureSingle(r,"g","contourlines"),m=!1!==s.showlines,g=s.showlabels,v=m&&g,y=h.createLines(d,m||g,n),w=h.createLineClip(d,v,i,o.trace.uid),T=r.selectAll("g.contourlabels").data(g?[0]:[]);if(T.exit().remove(),T.enter().append("g").classed("contourlabels",!0),g){var k=u.xaxis,A=u.yaxis,M=k._length,S=A._length,E=[[[0,0],[M,0],[M,S],[0,S]]],L=[];c.clearLocationCache();var C=h.labelFormatter(i,o),P=l.tester.append("text").attr("data-notex",1).call(l.font,s.labelfont),I={left:0,right:M,center:M/2,top:0,bottom:S,middle:S/2},O=Math.sqrt(M*M+S*S),z=p.LABELDISTANCE*O/Math.max(1,n.length/p.LABELINCREASE);y.each(function(r){var n=h.calcTextOpts(r.level,C,P,i);a.select(this).selectAll("path").each(function(i){var a=c.getVisibleSegment(this,I,n.height/2);if(a&&(function(r,n,i,a,o,s){for(var l,c=0;c<i.pedgepaths.length;c++)n===i.pedgepaths[c]&&(l=i.edgepaths[c]);if(l){var u=o.a[0],f=o.a[o.a.length-1],h=o.b[0],p=o.b[o.b.length-1],d=x(r,0,1),m=x(r,a.total,a.total-1),g=y(l[0],d),v=a.total-y(l[l.length-1],m);a.min<g&&(a.min=g),a.max>v&&(a.max=v),a.len=a.max-a.min}function y(r,n){var i=0;return(.1>Math.abs(r[0]-u)||.1>Math.abs(r[0]-f))&&(i=Math.max(i,s*_(n,b(o.dxydb_rough(r[0],r[1],.1)))/2)),(.1>Math.abs(r[1]-h)||.1>Math.abs(r[1]-p))&&(i=Math.max(i,s*_(n,b(o.dxyda_rough(r[0],r[1],.1)))/2)),i}}(this,i,r,a,f,n.height),!(a.len<(n.width+n.height)*p.LABELMIN)))for(var o=Math.min(Math.ceil(a.len/z),p.LABELMAX),s=0;s<o;s++){var l=h.findBestTextLocation(this,a,n,L,I);if(!l)break;h.addLabelData(l,n,L,E)}})}),P.remove(),h.drawLabels(T,L,i,w,v?E:null)}g&&!m&&y.remove()}(w,D,r,A,z,n,S),l.setClipUrl(w,S._clipPathId,r)}function W(r){var n=S.ab2xy(r[0],r[1],!0);return[T.c2p(n[0]),k.c2p(n[1])]}})}},{"../../components/drawing":388,"../../lib":503,"../carpet/axis_aligned_line":692,"../carpet/lookup_carpetid":708,"../carpet/makepath":709,"../carpet/map_1d_array":710,"../contour/close_boundaries":737,"../contour/constants":739,"../contour/convert_to_constraints":743,"../contour/empty_pathinfo":745,"../contour/find_all_paths":747,"../contour/make_crossings":752,"../contour/plot":753,"@plotly/d3":58}],762:[function(r,n,i){"use strict";var a=r("../../components/colorscale/attributes"),o=r("../../plots/template_attributes").hovertemplateAttrs,s=r("../../plots/attributes"),l=r("../scattermapbox/attributes"),c=r("../../lib/extend").extendFlat;n.exports=c({lon:l.lon,lat:l.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:l.text,hovertext:l.hovertext,hoverinfo:c({},s.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:o(),showlegend:c({},s.showlegend,{dflt:!1})},a("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scattermapbox/attributes":991}],763:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib").isArrayOrTypedArray,s=r("../../constants/numerical").BADNUM,l=r("../../components/colorscale/calc"),c=r("../../lib")._;n.exports=function(r,n){for(var i=n._length,u=Array(i),f=n.z,h=o(f)&&f.length,p=0;p<i;p++){var d=u[p]={},m=n.lon[p],g=n.lat[p];if(d.lonlat=a(m)&&a(g)?[+m,+g]:[s,s],h){var v=f[p];d.z=a(v)?v:s}}return l(r,n,{vals:h?f:[0,1],containerStr:"",cLetter:"z"}),i&&(u[0].t={labels:{lat:c(r,"lat:")+" ",lon:c(r,"lon:")+" "}}),u}},{"../../components/colorscale/calc":374,"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],764:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../../components/color"),l=r("../../components/colorscale"),c=r("../../constants/numerical").BADNUM,u=r("../../lib/geojson_utils").makeBlank;n.exports=function(r){var n=r[0].trace,i=!0===n.visible&&0!==n._length,f=n._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:u()};if(!i)return f;var h,p=[],d=n.z,m=n.radius,g=o.isArrayOrTypedArray(d)&&d.length,v=o.isArrayOrTypedArray(m);for(h=0;h<r.length;h++){var y=r[h],x=y.lonlat;if(x[0]!==c){var b={};if(g){var _=y.z;b.z=_!==c?_:0}v&&(b.r=a(m[h])&&m[h]>0?+m[h]:0),p.push({type:"Feature",geometry:{type:"Point",coordinates:x},properties:b})}}var w=l.extractOpts(n),T=w.reversescale?l.flipScale(w.colorscale):w.colorscale,k=T[0][1],A=["interpolate",["linear"],["heatmap-density"],0,1>s.opacity(k)?k:s.addOpacity(k,0)];for(h=1;h<T.length;h++)A.push(T[h][0],T[h][1]);var M=["interpolate",["linear"],["get","z"],w.min,0,w.max,1];return o.extendFlat(f.heatmap.paint,{"heatmap-weight":g?M:1/(w.max-w.min),"heatmap-color":A,"heatmap-radius":v?{type:"identity",property:"r"}:n.radius,"heatmap-opacity":n.opacity}),f.geojson={type:"FeatureCollection",features:p},f.heatmap.layout.visibility="visible",f}},{"../../components/color":366,"../../components/colorscale":378,"../../constants/numerical":479,"../../lib":503,"../../lib/geojson_utils":497,"fast-isnumeric":190}],765:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/colorscale/defaults"),s=r("./attributes");n.exports=function(r,n,i,l){function c(i,o){return a.coerce(r,n,s,i,o)}var u=c("lon")||[],f=c("lat")||[],h=Math.min(u.length,f.length);h?(n._length=h,c("z"),c("radius"),c("below"),c("text"),c("hovertext"),c("hovertemplate"),o(r,n,l,c,{prefix:"",cLetter:"z"})):n.visible=!1}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":762}],766:[function(r,n,i){"use strict";n.exports=function(r,n){return r.lon=n.lon,r.lat=n.lat,r.z=n.z,r}},{}],767:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../scattermapbox/hover").hoverPoints,s=r("../scattermapbox/hover").getExtraText;n.exports=function(r,n,i){var l=o(r,n,i);if(l){var c=l[0],u=c.cd,f=u[0].trace,h=u[c.index];if(delete c.color,"z"in h){var p=c.subplot.mockAxis;c.z=h.z,c.zLabel=a.tickText(p,p.c2l(h.z),"hover").text}return c.extraText=s(f,h,u[0].t.labels),[c]}}},{"../../plots/cartesian/axes":554,"../scattermapbox/hover":996}],768:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),formatLabels:r("../scattermapbox/format_labels"),calc:r("./calc"),plot:r("./plot"),hoverPoints:r("./hover"),eventData:r("./event_data"),getBelow:function(r,n){for(var i=n.getMapLayers(),a=0;a<i.length;a++){var o=i[a],s=o.id;if("symbol"===o.type&&"string"==typeof s&&-1===s.indexOf("plotly-"))return s}},moduleType:"trace",name:"densitymapbox",basePlotModule:r("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":613,"../heatmap/colorbar":795,"../scattermapbox/format_labels":995,"./attributes":762,"./calc":763,"./defaults":765,"./event_data":766,"./hover":767,"./plot":769}],769:[function(r,n,i){"use strict";var a=r("./convert"),o=r("../../plots/mapbox/constants").traceLayerPrefix;function s(r,n){this.type="densitymapbox",this.subplot=r,this.uid=n,this.sourceId="source-"+n,this.layerList=[["heatmap",o+n+"-heatmap"]],this.below=null}var l=s.prototype;l.update=function(r){var n=this.subplot,i=this.layerList,o=a(r),s=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(o.geojson),s!==this.below&&(this._removeLayers(),this._addLayers(o,s),this.below=s);for(var l=0;l<i.length;l++){var c=i[l],u=c[0],f=c[1],h=o[u];n.setOptions(f,"setLayoutProperty",h.layout),"visible"===h.layout.visibility&&n.setOptions(f,"setPaintProperty",h.paint)}},l._addLayers=function(r,n){for(var i=this.subplot,a=this.layerList,o=this.sourceId,s=0;s<a.length;s++){var l=a[s],c=l[0],u=r[c];i.addLayer({type:c,id:l[1],source:o,layout:u.layout,paint:u.paint},n)}},l._removeLayers=function(){for(var r=this.subplot.map,n=this.layerList,i=n.length-1;i>=0;i--)r.removeLayer(n[i][1])},l.dispose=function(){var r=this.subplot.map;this._removeLayers(),r.removeSource(this.sourceId)},n.exports=function(r,n){var i=n[0].trace,o=new s(r,i.uid),l=o.sourceId,c=a(n),u=o.below=r.belowLookup["trace-"+i.uid];return r.map.addSource(l,{type:"geojson",data:c.geojson}),o._addLayers(c,u),o}},{"../../plots/mapbox/constants":611,"./convert":764}],770:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n){for(var i=0;i<r.length;i++)r[i].i=i;a.mergeArray(n.text,r,"tx"),a.mergeArray(n.hovertext,r,"htx");var o=n.marker;if(o){a.mergeArray(o.opacity,r,"mo"),a.mergeArray(o.color,r,"mc");var s=o.line;s&&(a.mergeArray(s.color,r,"mlc"),a.mergeArrayCastPositive(s.width,r,"mlw"))}}},{"../../lib":503}],771:[function(r,n,i){"use strict";var a,o=r("../bar/attributes"),s=r("../scatter/attributes").line,l=r("../../plots/attributes"),c=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,u=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../plots/template_attributes").texttemplateAttrs,h=r("./constants"),p=r("../../lib/extend").extendFlat,d=r("../../components/color");n.exports={x:o.x,x0:o.x0,dx:o.dx,y:o.y,y0:o.y0,dy:o.dy,xperiod:o.xperiod,yperiod:o.yperiod,xperiod0:o.xperiod0,yperiod0:o.yperiod0,xperiodalignment:o.xperiodalignment,yperiodalignment:o.yperiodalignment,xhoverformat:c("x"),yhoverformat:c("y"),hovertext:o.hovertext,hovertemplate:u({},{keys:h.eventDataKeys}),hoverinfo:p({},l.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:f({editType:"plot"},{keys:h.eventDataKeys.concat(["label","value"])}),text:o.text,textposition:o.textposition,insidetextanchor:p({},o.insidetextanchor,{dflt:"middle"}),textangle:p({},o.textangle,{dflt:0}),textfont:o.textfont,insidetextfont:o.insidetextfont,outsidetextfont:o.outsidetextfont,constraintext:o.constraintext,cliponaxis:o.cliponaxis,orientation:p({},o.orientation,{}),offset:p({},o.offset,{arrayOk:!1}),width:p({},o.width,{arrayOk:!1}),marker:(a=p({},o.marker),delete a.pattern,a),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:p({},s.color,{dflt:d.defaultLine}),width:p({},s.width,{dflt:0,editType:"plot"}),dash:s.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:o.offsetgroup,alignmentgroup:o.alignmentgroup}},{"../../components/color":366,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatter/attributes":926,"./constants":773}],772:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../plots/cartesian/align_period"),s=r("./arrays_to_calcdata"),l=r("../scatter/calc_selection"),c=r("../../constants/numerical").BADNUM;function u(r){return r===c?0:r}n.exports=function(r,n){var i,f,h,p,d,m,g,v,y=a.getFromId(r,n.xaxis||"x"),x=a.getFromId(r,n.yaxis||"y");"h"===n.orientation?(i=y.makeCalcdata(n,"x"),h=x.makeCalcdata(n,"y"),p=o(n,x,"y",h),d=!!n.yperiodalignment,m="y"):(i=x.makeCalcdata(n,"y"),h=y.makeCalcdata(n,"x"),p=o(n,y,"x",h),d=!!n.xperiodalignment,m="x");var b,_=Math.min((f=p.vals).length,i.length),w=Array(_);for(n._base=[],g=0;g<_;g++){i[g]<0&&(i[g]=c);var T=!1;i[g]!==c&&g+1<_&&i[g+1]!==c&&(T=!0),v=w[g]={p:f[g],s:i[g],cNext:T},n._base[g]=-.5*v.s,d&&(w[g].orig_p=h[g],w[g][m+"End"]=p.ends[g],w[g][m+"Start"]=p.starts[g]),n.ids&&(v.id=String(n.ids[g])),0===g&&(w[0].vTotal=0),w[0].vTotal+=u(v.s),v.begR=u(v.s)/u(w[0].s)}for(g=0;g<_;g++)(v=w[g]).s!==c&&(v.sumR=v.s/w[0].vTotal,v.difR=void 0!==b?v.s/b:1,b=v.s);return s(w,n),l(w,n),w}},{"../../constants/numerical":479,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../scatter/calc_selection":928,"./arrays_to_calcdata":770}],773:[function(r,n,i){"use strict";n.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],774:[function(r,n,i){"use strict";var a=r("../bar/cross_trace_calc").setGroupPositions;n.exports=function(r,n){var i,o,s=r._fullLayout,l=r._fullData,c=r.calcdata,u=n.xaxis,f=n.yaxis,h=[],p=[],d=[];for(o=0;o<l.length;o++){var m=l[o],g="h"===m.orientation;!0===m.visible&&m.xaxis===u._id&&m.yaxis===f._id&&"funnel"===m.type&&(i=c[o],g?d.push(i):p.push(i),h.push(i))}var v={mode:s.funnelmode,norm:s.funnelnorm,gap:s.funnelgap,groupgap:s.funnelgroupgap};for(a(r,u,f,p,v),a(r,f,u,d,v),o=0;o<h.length;o++){i=h[o];for(var y=0;y<i.length;y++)y+1<i.length&&(i[y].nextP0=i[y+1].p0,i[y].nextS0=i[y+1].s0,i[y].nextP1=i[y+1].p1,i[y].nextS1=i[y+1].s1)}}},{"../bar/cross_trace_calc":651}],775:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../bar/defaults").handleGroupingDefaults,s=r("../bar/defaults").handleText,l=r("../scatter/xy_defaults"),c=r("../scatter/period_defaults"),u=r("./attributes"),f=r("../../components/color");n.exports={supplyDefaults:function(r,n,i,o){function h(i,o){return a.coerce(r,n,u,i,o)}if(l(r,n,o,h)){c(r,n,o,h),h("xhoverformat"),h("yhoverformat"),h("orientation",n.y&&!n.x?"v":"h"),h("offset"),h("width");var p,d=h("text");h("hovertext"),h("hovertemplate");var m=h("textposition");s(r,n,o,h,m,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===n.textposition||n.texttemplate||h("textinfo",Array.isArray(d)?"text+value":"value");var g=h("marker.color",i);h("marker.line.color",f.defaultLine),h("marker.line.width"),h("connector.visible")&&(h("connector.fillcolor",(p=a.isArrayOrTypedArray(g)?"#000":g,f.addOpacity(p,.5*f.opacity(p)))),h("connector.line.width")&&(h("connector.line.color"),h("connector.line.dash")))}else n.visible=!1},crossTraceDefaults:function(r,n){var i;function s(r){return a.coerce(i._input,i,u,r)}if("group"===n.funnelmode)for(var l=0;l<r.length;l++)o((i=r[l])._input,i,n,s)}}},{"../../components/color":366,"../../lib":503,"../bar/defaults":652,"../scatter/period_defaults":946,"../scatter/xy_defaults":953,"./attributes":771}],776:[function(r,n,i){"use strict";n.exports=function(r,n){return r.x="xVal"in n?n.xVal:n.x,r.y="yVal"in n?n.yVal:n.y,"percentInitial"in n&&(r.percentInitial=n.percentInitial),"percentPrevious"in n&&(r.percentPrevious=n.percentPrevious),"percentTotal"in n&&(r.percentTotal=n.percentTotal),n.xa&&(r.xaxis=n.xa),n.ya&&(r.yaxis=n.ya),r}},{}],777:[function(r,n,i){"use strict";var a=r("../../components/color").opacity,o=r("../bar/hover").hoverOnBars,s=r("../../lib").formatPercent;n.exports=function(r,n,i,l,c){var u=o(r,n,i,l,c);if(u){var f,h,p,d,m=u.cd,g=m[0].trace,v="h"===g.orientation,y=m[u.index];u[(v?"x":"y")+"LabelVal"]=y.s,u.percentInitial=y.begR,u.percentInitialLabel=s(y.begR,1),u.percentPrevious=y.difR,u.percentPreviousLabel=s(y.difR,1),u.percentTotal=y.sumR,u.percentTotalLabel=s(y.sumR,1);var x=y.hi||g.hoverinfo,b=[];if(x&&"none"!==x&&"skip"!==x){var _="all"===x,w=x.split("+"),T=function(r){return _||-1!==w.indexOf(r)};T("percent initial")&&b.push(u.percentInitialLabel+" of initial"),T("percent previous")&&b.push(u.percentPreviousLabel+" of previous"),T("percent total")&&b.push(u.percentTotalLabel+" of total")}return u.extraText=b.join("<br>"),u.color=(f=g.marker,h=y.mc||f.color,p=y.mlc||f.line.color,d=y.mlw||f.line.width,a(h)?h:a(p)&&d?p:void 0),[u]}}},{"../../components/color":366,"../../lib":503,"../bar/hover":655}],778:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc"),plot:r("./plot"),style:r("./style").style,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../bar/select":660,"./attributes":771,"./calc":772,"./cross_trace_calc":774,"./defaults":775,"./event_data":776,"./hover":777,"./layout_attributes":779,"./layout_defaults":780,"./plot":781,"./style":782}],779:[function(r,n,i){"use strict";n.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],780:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n,i){var s=!1;function l(i,s){return a.coerce(r,n,o,i,s)}for(var c=0;c<i.length;c++){var u=i[c];if(u.visible&&"funnel"===u.type){s=!0;break}}s&&(l("funnelmode"),l("funnelgap",.2),l("funnelgroupgap"))}},{"../../lib":503,"./layout_attributes":779}],781:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../components/drawing"),l=r("../../constants/numerical").BADNUM,c=r("../bar/plot"),u=r("../bar/uniform_text").clearMinTextSize;function f(r,n,i,a){var o=[],s=[],l=a?n:i,c=a?i:n;return o[0]=l.c2p(r.s0,!0),s[0]=c.c2p(r.p0,!0),o[1]=l.c2p(r.s1,!0),s[1]=c.c2p(r.p1,!0),o[2]=l.c2p(r.nextS0,!0),s[2]=c.c2p(r.nextP0,!0),o[3]=l.c2p(r.nextS1,!0),s[3]=c.c2p(r.nextP1,!0),a?[o,s]:[s,o]}n.exports=function(r,n,i,h){var p=r._fullLayout;u("funnel",p),function(r,n,i,c){var u=n.xaxis,h=n.yaxis;o.makeTraceGroups(c,i,"trace bars").each(function(i){var c=a.select(this),p=i[0].trace,d=o.ensureSingle(c,"g","regions");if(p.connector&&p.connector.visible){var m="h"===p.orientation,g=d.selectAll("g.region").data(o.identity);g.enter().append("g").classed("region",!0),g.exit().remove();var v=g.size();g.each(function(i,c){if(c===v-1||i.cNext){var p=f(i,u,h,m),d=p[0],g=p[1],y="";d[0]!==l&&g[0]!==l&&d[1]!==l&&g[1]!==l&&d[2]!==l&&g[2]!==l&&d[3]!==l&&g[3]!==l&&(y+=m?"M"+d[0]+","+g[1]+"L"+d[2]+","+g[2]+"H"+d[3]+"L"+d[1]+","+g[1]+"Z":"M"+d[1]+","+g[1]+"L"+d[2]+","+g[3]+"V"+g[2]+"L"+d[1]+","+g[0]+"Z"),""===y&&(y="M0,0Z"),o.ensureSingle(a.select(this),"path").attr("d",y).call(s.setClipUrl,n.layerClipId,r)}})}else d.remove()})}(r,n,i,h),function(r,n,i,l){var c=n.xaxis,u=n.yaxis;o.makeTraceGroups(l,i,"trace bars").each(function(i){var l=a.select(this),h=i[0].trace,p=o.ensureSingle(l,"g","lines");if(h.connector&&h.connector.visible&&h.connector.line.width){var d="h"===h.orientation,m=p.selectAll("g.line").data(o.identity);m.enter().append("g").classed("line",!0),m.exit().remove();var g=m.size();m.each(function(i,l){if(l===g-1||i.cNext){var h=f(i,c,u,d),p=h[0],m=h[1],v="";void 0!==p[3]&&void 0!==m[3]&&(d?v+="M"+p[0]+","+m[1]+"L"+p[2]+","+m[2]+("M"+p[1]+","+m[1]+"L"+p[3])+","+m[2]:v+="M"+p[1]+","+m[1]+"L"+p[2]+","+m[3]+("M"+p[1]+","+m[0]+"L"+p[2])+","+m[2]),""===v&&(v="M0,0Z"),o.ensureSingle(a.select(this),"path").attr("d",v).call(s.setClipUrl,n.layerClipId,r)}})}else p.remove()})}(r,n,i,h),c.plot(r,n,i,h,{mode:p.funnelmode,norm:p.funnelmode,gap:p.funnelgap,groupgap:p.funnelgroupgap})}},{"../../components/drawing":388,"../../constants/numerical":479,"../../lib":503,"../bar/plot":659,"../bar/uniform_text":664,"@plotly/d3":58}],782:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/drawing"),s=r("../../components/color"),l=r("../../constants/interactions").DESELECTDIM,c=r("../bar/style"),u=r("../bar/uniform_text").resizeText,f=c.styleTextPoints;n.exports={style:function(r,n,i){var c=i||a.select(r).selectAll("g.funnellayer").selectAll("g.trace");u(r,c,"funnel"),c.style("opacity",function(r){return r[0].trace.opacity}),c.each(function(n){var i=a.select(this),c=n[0].trace;i.selectAll(".point > path").each(function(r){if(!r.isBlank){var n=c.marker;a.select(this).call(s.fill,r.mc||n.color).call(s.stroke,r.mlc||n.line.color).call(o.dashLine,n.line.dash,r.mlw||n.line.width).style("opacity",c.selectedpoints&&!r.selected?l:1)}}),f(i,c,r),i.selectAll(".regions").each(function(){a.select(this).selectAll("path").style("stroke-width",0).call(s.fill,c.connector.fillcolor)}),i.selectAll(".lines").each(function(){var r=c.connector.line;o.lineGroupStyle(a.select(this).selectAll("path"),r.width,r.color,r.dash)})})}}},{"../../components/color":366,"../../components/drawing":388,"../../constants/interactions":478,"../bar/style":662,"../bar/uniform_text":664,"@plotly/d3":58}],783:[function(r,n,i){"use strict";var a=r("../pie/attributes"),o=r("../../plots/attributes"),s=r("../../plots/domain").attributes,l=r("../../plots/template_attributes").hovertemplateAttrs,c=r("../../plots/template_attributes").texttemplateAttrs,u=r("../../lib/extend").extendFlat;n.exports={labels:a.labels,label0:a.label0,dlabel:a.dlabel,values:a.values,marker:{colors:a.marker.colors,line:{color:u({},a.marker.line.color,{dflt:null}),width:u({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:a.text,hovertext:a.hovertext,scalegroup:u({},a.scalegroup,{}),textinfo:u({},a.textinfo,{flags:["label","text","value","percent"]}),texttemplate:c({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:u({},o.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:l({},{keys:["label","color","value","text","percent"]}),textposition:u({},a.textposition,{values:["inside","none"],dflt:"inside"}),textfont:a.textfont,insidetextfont:a.insidetextfont,title:{text:a.title.text,font:a.title.font,position:u({},a.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:s({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":900}],784:[function(r,n,i){"use strict";var a=r("../../plots/plots");i.name="funnelarea",i.plot=function(r,n,o,s){a.plotBasePlot(i.name,r,n,o,s)},i.clean=function(r,n,o,s){a.cleanBasePlot(i.name,r,n,o,s)}},{"../../plots/plots":619}],785:[function(r,n,i){"use strict";var a=r("../pie/calc");n.exports={calc:function(r,n){return a.calc(r,n)},crossTraceCalc:function(r){a.crossTraceCalc(r,{type:"funnelarea"})}}},{"../pie/calc":902}],786:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("../../plots/domain").defaults,l=r("../bar/defaults").handleText,c=r("../pie/defaults").handleLabelsAndValues;n.exports=function(r,n,i,u){function f(i,s){return a.coerce(r,n,o,i,s)}var h=c(f("labels"),f("values")),p=h.len;if(n._hasLabels=h.hasLabels,n._hasValues=h.hasValues,!n._hasLabels&&n._hasValues&&(f("label0"),f("dlabel")),p){n._length=p,f("marker.line.width")&&f("marker.line.color",u.paper_bgcolor),f("marker.colors"),f("scalegroup");var d,m=f("text"),g=f("texttemplate");if(g||(d=f("textinfo",Array.isArray(m)?"text+percent":"percent")),f("hovertext"),f("hovertemplate"),g||d&&"none"!==d){var v=f("textposition");l(r,n,u,f,v,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}s(n,u,f),f("title.text")&&(f("title.position"),a.coerceFont(f,"title.font",u.font)),f("aspectratio"),f("baseratio")}else n.visible=!1}},{"../../lib":503,"../../plots/domain":584,"../bar/defaults":652,"../pie/defaults":903,"./attributes":783}],787:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"funnelarea",basePlotModule:r("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),style:r("./style"),styleOne:r("../pie/style_one"),meta:{}}},{"../pie/style_one":911,"./attributes":783,"./base_plot":784,"./calc":785,"./defaults":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(r,n,i){"use strict";var a=r("../pie/layout_attributes").hiddenlabels;n.exports={hiddenlabels:a,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":907}],789:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n){function i(i,s){return a.coerce(r,n,o,i,s)}i("hiddenlabels"),i("funnelareacolorway",n.colorway),i("extendfunnelareacolors")}},{"../../lib":503,"./layout_attributes":788}],790:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/drawing"),s=r("../../lib"),l=s.strScale,c=s.strTranslate,u=r("../../lib/svg_text_utils"),f=r("../bar/plot").toMoveInsideBar,h=r("../bar/uniform_text"),p=h.recordMinTextSize,d=h.clearMinTextSize,m=r("../pie/helpers"),g=r("../pie/plot"),v=g.attachFxHandlers,y=g.determineInsideTextFont,x=g.layoutAreas,b=g.prerenderTitles,_=g.positionTitleOutside,w=g.formatSliceLabel;function T(r,n){return"l"+(n[0]-r[0])+","+(n[1]-r[1])}n.exports=function(r,n){var i=r._fullLayout;d("funnelarea",i),b(n,r),x(n,i._size),s.makeTraceGroups(i._funnelarealayer,n,"trace").each(function(n){var h=a.select(this),d=n[0],g=d.trace;(function(r){if(r.length){var n,i,a=r[0],o=a.trace,s=o.aspectratio,l=o.baseratio;l>.999&&(l=.999);var c,u,f,h=Math.pow(l,2),p=a.vTotal,d=p*h/(1-h)/p,m=[];for(m.push(L()),u=r.length-1;u>-1;u--)if(!(f=r[u]).hidden){var g=f.v/p;d+=g,m.push(L())}var v=1/0,y=-1/0;for(u=0;u<m.length;u++)v=Math.min(v,(c=m[u])[1]),y=Math.max(y,c[1]);for(u=0;u<m.length;u++)m[u][1]-=(y+v)/2;var x=m[m.length-1][0],b=a.r,_=(y-v)/2,w=b/x,T=b/_*s;for(a.r=T*_,u=0;u<m.length;u++)m[u][0]*=w,m[u][1]*=T;var k=[-(c=m[0])[0],c[1]],A=[c[0],c[1]],M=0;for(u=r.length-1;u>-1;u--)if(!(f=r[u]).hidden){var S=m[M+=1][0],E=m[M][1];f.TL=[-S,E],f.TR=[S,E],f.BL=k,f.BR=A,f.pxmid=(n=f.TR,i=f.BR,[.5*(n[0]+i[0]),.5*(n[1]+i[1])]),k=f.TL,A=f.TR}}function L(){var r,n={x:r=Math.sqrt(d),y:-r};return[n.x,n.y]}})(n),h.each(function(){var h=a.select(this).selectAll("g.slice").data(n);h.enter().append("g").classed("slice",!0),h.exit().remove(),h.each(function(l,c){if(l.hidden)a.select(this).selectAll("path,g").remove();else{l.pointNumber=l.i,l.curveNumber=g.index;var h=d.cx,x=d.cy,b=a.select(this),_=b.selectAll("path.surface").data([l]);_.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),b.call(v,r,n);var k="M"+(h+l.TR[0])+","+(x+l.TR[1])+T(l.TR,l.BR)+T(l.BR,l.BL)+T(l.BL,l.TL)+"Z";_.attr("d",k),w(r,l,d);var A=m.castOption(g.textposition,l.pts),M=b.selectAll("g.slicetext").data(l.text&&"none"!==A?[0]:[]);M.enter().append("g").classed("slicetext",!0),M.exit().remove(),M.each(function(){var d=s.ensureSingle(a.select(this),"text","",function(r){r.attr("data-notex",1)}),m=s.ensureUniformFontSize(r,y(g,l,i.font));d.text(l.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(o.font,m).call(u.convertToTspans,r);var v,b=o.bBox(d.node()),_=Math.min(l.BL[1],l.BR[1])+x,w=Math.max(l.TL[1],l.TR[1])+x;(v=f(Math.max(l.TL[0],l.BL[0])+h,Math.min(l.TR[0],l.BR[0])+h,_,w,b,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=m.size,p(g.type,v,i),n[c].transform=v,d.attr("transform",s.getTextTransform(v))})}});var x=a.select(this).selectAll("g.titletext").data(g.title.text?[0]:[]);x.enter().append("g").classed("titletext",!0),x.exit().remove(),x.each(function(){var n=s.ensureSingle(a.select(this),"text","",function(r){r.attr("data-notex",1)}),f=g.title.text;g._meta&&(f=s.templateString(f,g._meta)),n.text(f).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(o.font,g.title.font).call(u.convertToTspans,r);var h=_(d,i._size);n.attr("transform",c(h.x,h.y)+l(Math.min(1,h.scale))+c(h.tx,h.ty))})})})}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../bar/plot":659,"../bar/uniform_text":664,"../pie/helpers":905,"../pie/plot":909,"@plotly/d3":58}],791:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../pie/style_one"),s=r("../bar/uniform_text").resizeText;n.exports=function(r){var n=r._fullLayout._funnelarealayer.selectAll(".trace");s(r,n,"funnelarea"),n.each(function(r){var n=r[0].trace,i=a.select(this);i.style({opacity:n.opacity}),i.selectAll("path.surface").each(function(r){a.select(this).call(o,r,n)})})}},{"../bar/uniform_text":664,"../pie/style_one":911,"@plotly/d3":58}],792:[function(r,n,i){"use strict";var a=r("../scatter/attributes"),o=r("../../plots/attributes"),s=r("../../plots/font_attributes"),l=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,c=r("../../plots/template_attributes").hovertemplateAttrs,u=r("../../plots/template_attributes").texttemplateAttrs,f=r("../../components/colorscale/attributes"),h=r("../../lib/extend").extendFlat;n.exports=h({z:{valType:"data_array",editType:"calc"},x:h({},a.x,{impliedEdits:{xtype:"array"}}),x0:h({},a.x0,{impliedEdits:{xtype:"scaled"}}),dx:h({},a.dx,{impliedEdits:{xtype:"scaled"}}),y:h({},a.y,{impliedEdits:{ytype:"array"}}),y0:h({},a.y0,{impliedEdits:{ytype:"scaled"}}),dy:h({},a.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:h({},a.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:h({},a.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:h({},a.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:h({},a.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:h({},a.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:h({},a.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:l("x"),yhoverformat:l("y"),zhoverformat:l("z",1),hovertemplate:c(),texttemplate:u({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:s({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:h({},o.showlegend,{dflt:!1})},{transforms:void 0},f("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"../scatter/attributes":926}],793:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("../../plots/cartesian/axes"),l=r("../../plots/cartesian/align_period"),c=r("../histogram2d/calc"),u=r("../../components/colorscale/calc"),f=r("./convert_column_xyz"),h=r("./clean_2d_array"),p=r("./interp2d"),d=r("./find_empties"),m=r("./make_bound_array"),g=r("../../constants/numerical").BADNUM;function v(r){for(var n=[],i=r.length,a=0;a<i;a++){var o=r[a];o!==g&&n.push(o)}return n}n.exports=function(r,n){var i,y,x,b,_,w,T,k,A,M,S,E=s.getFromId(r,n.xaxis||"x"),L=s.getFromId(r,n.yaxis||"y"),C=a.traceIs(n,"contour"),P=a.traceIs(n,"histogram"),I=a.traceIs(n,"gl2d"),O=C?"best":n.zsmooth;if(E._minDtick=0,L._minDtick=0,P)b=(S=c(r,n)).orig_x,i=S.x,y=S.x0,x=S.dx,k=S.orig_y,_=S.y,w=S.y0,T=S.dy,A=S.z;else{var z=n.z;o.isArray1D(z)?(f(n,E,L,"x","y",["z"]),i=n._x,_=n._y,z=n._z):(b=n.x?E.makeCalcdata(n,"x"):[],k=n.y?L.makeCalcdata(n,"y"):[],i=l(n,E,"x",b).vals,_=l(n,L,"y",k).vals,n._x=i,n._y=_),y=n.x0,x=n.dx,w=n.y0,T=n.dy,A=h(z,n,E,L)}function D(r){O=n._input.zsmooth=n.zsmooth=!1,o.warn('cannot use zsmooth: "fast": '+r)}if((E.rangebreaks||L.rangebreaks)&&(A=function(r,n,i){for(var a=[],o=-1,s=0;s<i.length;s++)if(n[s]!==g){a[++o]=[];for(var l=0;l<i[s].length;l++)r[l]!==g&&a[o].push(i[s][l])}return a}(i,_,A),P||(i=v(i),_=v(_),n._x=i,n._y=_)),!P&&(C||n.connectgaps)&&(n._emptypoints=d(A),p(A,n._emptypoints)),"fast"===O){if("log"===E.type||"log"===L.type)D("log axis found");else if(!P){if(i.length){var R=(i[i.length-1]-i[0])/(i.length-1),F=Math.abs(R/100);for(M=0;M<i.length-1;M++)if(Math.abs(i[M+1]-i[M]-R)>F){D("x scale is not linear");break}}if(_.length&&"fast"===O){var B=(_[_.length-1]-_[0])/(_.length-1),N=Math.abs(B/100);for(M=0;M<_.length-1;M++)if(Math.abs(_[M+1]-_[M]-B)>N){D("y scale is not linear");break}}}}var j=o.maxRowLength(A),U="scaled"===n.xtype?"":i,V=m(n,U,y,x,j,E),H="scaled"===n.ytype?"":_,q=m(n,H,w,T,A.length,L);I||(n._extremes[E._id]=s.findExtremes(E,V),n._extremes[L._id]=s.findExtremes(L,q));var G={x:V,y:q,z:A,text:n._text||n.text,hovertext:n._hovertext||n.hovertext};if(n.xperiodalignment&&b&&(G.orig_x=b),n.yperiodalignment&&k&&(G.orig_y=k),U&&U.length===V.length-1&&(G.xCenter=U),H&&H.length===q.length-1&&(G.yCenter=H),P&&(G.xRanges=S.xRanges,G.yRanges=S.yRanges,G.pts=S.pts),C||u(r,n,{vals:A,cLetter:"z"}),C&&n.contours&&"heatmap"===n.contours.coloring){var Y={type:"contour"===n.type?"heatmap":"histogram2d",xcalendar:n.xcalendar,ycalendar:n.ycalendar};G.xfill=m(Y,U,y,x,j,E),G.yfill=m(Y,H,w,T,A.length,L)}return[G]}},{"../../components/colorscale/calc":374,"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../../registry":638,"../histogram2d/calc":826,"./clean_2d_array":794,"./convert_column_xyz":796,"./find_empties":798,"./interp2d":801,"./make_bound_array":803}],794:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../../constants/numerical").BADNUM;n.exports=function(r,n,i,l){if(n&&n.transpose){for(u=0,d=0;d<r.length;d++)u=Math.max(u,r[d].length);if(0===u)return!1;h=function(r){return r.length},p=function(r,n,i){return(r[i]||[])[n]}}else u=r.length,h=function(r,n){return r[n].length},p=function(r,n,i){return(r[n]||[])[i]};function c(r){if(n&&"carpet"!==n.type&&"contourcarpet"!==n.type&&r&&"category"===r.type&&n["_"+r._id.charAt(0)].length){var i=r._id.charAt(0),a={},l=n["_"+i+"CategoryMap"]||n[i];for(d=0;d<l.length;d++)a[l[d]]=d;return function(n){var i=a[r._categories[n]];return i+1?i:s}}return o.identity}var u,f,h,p,d,m,g,v,y=c(i),x=c(l);l&&"category"===l.type&&(u=l._categories.length);var b=Array(u);for(d=0;d<u;d++)for(f=i&&"category"===i.type?i._categories.length:h(r,d),b[d]=Array(f),m=0;m<f;m++)b[d][m]=function(r){if(a(r))return+r}((g=x(d),v=y(m),g===s||v===s?s:p(r,g,v)));return b}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],795:[function(r,n,i){"use strict";n.exports={min:"zmin",max:"zmax"}},{}],796:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../constants/numerical").BADNUM,s=r("../../plots/cartesian/align_period");n.exports=function(r,n,i,l,c,u){var f=r._length,h=n.makeCalcdata(r,l),p=i.makeCalcdata(r,c);h=s(r,n,l,h).vals,p=s(r,i,c,p).vals;var d,m,g,v,y=r.text,x=void 0!==y&&a.isArray1D(y),b=r.hovertext,_=void 0!==b&&a.isArray1D(b),w=a.distinctVals(h),T=w.vals,k=a.distinctVals(p),A=k.vals,M=[],S=A.length,E=T.length;for(d=0;d<u.length;d++)M[d]=a.init2dArray(S,E);x&&(g=a.init2dArray(S,E)),_&&(v=a.init2dArray(S,E));var L=a.init2dArray(S,E);for(d=0;d<f;d++)if(h[d]!==o&&p[d]!==o){var C=a.findBin(h[d]+w.minDiff/2,T),P=a.findBin(p[d]+k.minDiff/2,A);for(m=0;m<u.length;m++){var I=r[u[m]];M[m][P][C]=I[d],L[P][C]=d}x&&(g[P][C]=y[d]),_&&(v[P][C]=b[d])}for(r["_"+l]=T,r["_"+c]=A,m=0;m<u.length;m++)r["_"+u[m]]=M[m];x&&(r._text=g),_&&(r._hovertext=v),n&&"category"===n.type&&(r["_"+l+"CategoryMap"]=T.map(function(r){return n._categories[r]})),i&&"category"===i.type&&(r["_"+c+"CategoryMap"]=A.map(function(r){return i._categories[r]})),r._after2before=L}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551}],797:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./xyz_defaults"),s=r("./label_defaults"),l=r("../scatter/period_defaults"),c=r("./style_defaults"),u=r("../../components/colorscale/defaults"),f=r("./attributes");n.exports=function(r,n,i,h){function p(i,o){return a.coerce(r,n,f,i,o)}o(r,n,p,h)?(l(r,n,h,p),p("xhoverformat"),p("yhoverformat"),p("text"),p("hovertext"),p("hovertemplate"),s(p,h),c(r,n,p,h),p("hoverongaps"),p("connectgaps",a.isArray1D(n.z)&&!1!==n.zsmooth),u(r,n,h,p,{prefix:"",cLetter:"z"})):n.visible=!1}},{"../../components/colorscale/defaults":376,"../../lib":503,"../scatter/period_defaults":946,"./attributes":792,"./label_defaults":802,"./style_defaults":806,"./xyz_defaults":807}],798:[function(r,n,i){"use strict";var a=r("../../lib").maxRowLength;n.exports=function(r){var n,i,o,s,l,c,u,f,h=[],p={},d=[],m=r[0],g=[],v=[0,0,0],y=a(r);for(i=0;i<r.length;i++)for(n=g,g=m,m=r[i+1]||[],o=0;o<y;o++)void 0===g[o]&&((c=(void 0!==g[o-1]?1:0)+(void 0!==g[o+1]?1:0)+(void 0!==n[o]?1:0)+(void 0!==m[o]?1:0))?(0===i&&c++,0===o&&c++,i===r.length-1&&c++,o===g.length-1&&c++,c<4&&(p[[i,o]]=[i,o,c]),h.push([i,o,c])):d.push([i,o]));for(;d.length;){for(u={},f=!1,l=d.length-1;l>=0;l--)(c=((p[[(i=(s=d[l])[0])-1,o=s[1]]]||v)[2]+(p[[i+1,o]]||v)[2]+(p[[i,o-1]]||v)[2]+(p[[i,o+1]]||v)[2])/20)&&(u[s]=[i,o,c],d.splice(l,1),f=!0);if(!f)throw"findEmpties iterated with no new neighbors";for(s in u)p[s]=u[s],h.push(u[s])}return h.sort(function(r,n){return n[2]-r[2]})}},{"../../lib":503}],799:[function(r,n,i){"use strict";var a=r("../../components/fx"),o=r("../../lib"),s=r("../../plots/cartesian/axes"),l=r("../../components/colorscale").extractOpts;n.exports=function(r,n,i,c,u){u||(u={});var f,h,p,d,m=u.isContour,g=r.cd[0],v=g.trace,y=r.xa,x=r.ya,b=g.x,_=g.y,w=g.z,T=g.xCenter,k=g.yCenter,A=g.zmask,M=v.zhoverformat,S=b,E=_;if(!1!==r.index){try{p=Math.round(r.index[1]),d=Math.round(r.index[0])}catch(n){return void o.error("Error hovering on heatmap, pointNumber must be [row,col], found:",r.index)}if(p<0||p>=w[0].length||d<0||d>w.length)return}else{if(a.inbox(n-b[0],n-b[b.length-1],0)>0||a.inbox(i-_[0],i-_[_.length-1],0)>0)return;if(m){for(S=[2*b[0]-b[1]],L=1;L<b.length;L++)S.push((b[L]+b[L-1])/2);for(S.push([2*b[b.length-1]-b[b.length-2]]),E=[2*_[0]-_[1]],L=1;L<_.length;L++)E.push((_[L]+_[L-1])/2);E.push([2*_[_.length-1]-_[_.length-2]])}p=Math.max(0,Math.min(S.length-2,o.findBin(n,S))),d=Math.max(0,Math.min(E.length-2,o.findBin(i,E)))}var L,C,P,I=y.c2p(b[p]),O=y.c2p(b[p+1]),z=x.c2p(_[d]),D=x.c2p(_[d+1]);m?(C=g.orig_x||b,P=g.orig_y||_,O=I,f=C[p],D=z,h=P[d]):(C=g.orig_x||T||b,P=g.orig_y||k||_,f=T?C[p]:(C[p]+C[p+1])/2,h=k?P[d]:(P[d]+P[d+1])/2,y&&"category"===y.type&&(f=b[p]),x&&"category"===x.type&&(h=_[d]),v.zsmooth&&(I=O=y.c2p(f),z=D=x.c2p(h)));var R=w[d][p];if(A&&!A[d][p]&&(R=void 0),void 0!==R||v.hoverongaps){Array.isArray(g.hovertext)&&Array.isArray(g.hovertext[d])?F=g.hovertext[d][p]:Array.isArray(g.text)&&Array.isArray(g.text[d])&&(F=g.text[d][p]);var F,B=l(v),N={type:"linear",range:[B.min,B.max],hoverformat:M,_separators:y._separators,_numFormat:y._numFormat},j=s.tickText(N,R,"hover").text;return[o.extendFlat(r,{index:v._after2before?v._after2before[d][p]:[d,p],distance:r.maxHoverDistance,spikeDistance:r.maxSpikeDistance,x0:I,x1:O,y0:z,y1:D,xLabelVal:f,yLabelVal:h,zLabelVal:R,zLabel:j,text:F})]}}},{"../../components/colorscale":378,"../../components/fx":406,"../../lib":503,"../../plots/cartesian/axes":554}],800:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),colorbar:r("./colorbar"),style:r("./style"),hoverPoints:r("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":568,"./attributes":792,"./calc":793,"./colorbar":795,"./defaults":797,"./hover":799,"./plot":804,"./style":805}],801:[function(r,n,i){"use strict";var a=r("../../lib"),o=[[-1,0],[1,0],[0,-1],[0,1]];function s(r,n,i){var a,s,l,c,u,f,h,p,d,m,g,v,y,x=0;for(c=0;c<n.length;c++){for(s=(a=n[c])[0],l=a[1],g=r[s][l],m=0,d=0,u=0;u<4;u++)(h=r[s+(f=o[u])[0]])&&void 0!==(p=h[l+f[1]])&&(0===m?v=y=p:(v=Math.min(v,p),y=Math.max(y,p)),d++,m+=p);if(0===d)throw"iterateInterp2d order is wrong: no defined neighbors";r[s][l]=m/d,void 0===g?d<4&&(x=1):(r[s][l]=(1+i)*r[s][l]-i*g,y>v&&(x=Math.max(x,Math.abs(r[s][l]-g)/(y-v))))}return x}n.exports=function(r,n){var i,o=1;for(s(r,n),i=0;i<n.length&&!(n[i][2]<4);i++);for(n=n.slice(i),i=0;i<100&&o>.01;i++)o=s(r,n,.5-.25*Math.min(1,.5*o));return o>.01&&a.log("interp2d didn't converge quickly",o),r}},{"../../lib":503}],802:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n){r("texttemplate");var i=a.extendFlat({},n.font,{color:"auto",size:"auto"});a.coerceFont(r,"textfont",i)}},{"../../lib":503}],803:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib").isArrayOrTypedArray;n.exports=function(r,n,i,s,l,c){var u,f,h,p=[],d=a.traceIs(r,"contour"),m=a.traceIs(r,"histogram"),g=a.traceIs(r,"gl2d");if(o(n)&&n.length>1&&!m&&"category"!==c.type){var v=n.length;if(!(v<=l))return d?n.slice(0,l):n.slice(0,l+1);if(d||g)p=n.slice(0,l);else if(1===l)p=[n[0]-.5,n[0]+.5];else{for(p=[1.5*n[0]-.5*n[1]],h=1;h<v;h++)p.push(.5*(n[h-1]+n[h]));p.push(1.5*n[v-1]-.5*n[v-2])}if(v<l){var y=p[p.length-1],x=y-p[p.length-2];for(h=v;h<l;h++)y+=x,p.push(y)}}else{var b=r[c._id.charAt(0)+"calendar"];for(u=m?c.r2c(i,0,b):o(n)&&1===n.length?n[0]:void 0===i?0:("log"===c.type?c.d2c:c.r2c)(i,0,b),f=s||1,h=d||g?0:-.5;h<l;h++)p.push(u+f*h)}return p}},{"../../lib":503,"../../registry":638}],804:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("tinycolor2"),s=r("../../registry"),l=r("../../components/drawing"),c=r("../../plots/cartesian/axes"),u=r("../../lib"),f=r("../../lib/svg_text_utils"),h=r("../scatter/format_labels"),p=r("../../components/color"),d=r("../../components/colorscale").extractOpts,m=r("../../components/colorscale").makeColorScaleFuncFromTrace,g=r("../../constants/xmlns_namespaces"),v=r("../../constants/alignment").LINE_SPACING;function y(r){return r.selectAll("g.heatmap-label")}function x(r){y(r).remove()}function b(r,n){var i=n.length-2,a=u.constrain(u.findBin(r,n),0,i),o=n[a],s=n[a+1],l=u.constrain(a+(r-o)/(s-o)-.5,0,i),c=Math.round(l),f=Math.abs(l-c);return l&&l!==i&&f?{bin0:c,frac:f,bin1:Math.round(c+f/(l-c))}:{bin0:c,bin1:c,frac:0}}function _(r,n){var i=n.length-1,a=u.constrain(u.findBin(r,n),0,i),o=n[a],s=(r-o)/(n[a+1]-o)||0;return s<=0?{bin0:a,bin1:a,frac:0}:s<.5?{bin0:a,bin1:a+1,frac:s}:{bin0:a+1,bin1:a,frac:1-s}}function w(r,n,i){r[n]=i[0],r[n+1]=i[1],r[n+2]=i[2],r[n+3]=Math.round(255*i[3])}n.exports=function(r,n,i,T){var k=n.xaxis,A=n.yaxis;u.makeTraceGroups(T,i,"hm").each(function(n){var i,T,M,S,E,L,C,P,I=a.select(this),O=n[0],z=O.trace,D=z.xgap||0,R=z.ygap||0,F=O.z,B=O.x,N=O.y,j=O.xCenter,U=O.yCenter,V=s.traceIs(z,"contour"),H=V?"best":z.zsmooth,q=F.length,G=u.maxRowLength(F),Y=!1,W=!1;for(L=0;void 0===i&&L<B.length-1;)i=k.c2p(B[L]),L++;for(L=B.length-1;void 0===T&&L>0;)T=k.c2p(B[L]),L--;for(T<i&&(M=T,T=i,i=M,Y=!0),L=0;void 0===S&&L<N.length-1;)S=A.c2p(N[L]),L++;for(L=N.length-1;void 0===E&&L>0;)E=A.c2p(N[L]),L--;if(E<S&&(M=S,S=E,E=M,W=!0),V&&(j=B,U=N,B=O.xfill,N=O.yfill),"fast"!==H){var X="best"===H?0:.5;i=Math.max(-X*k._length,i),T=Math.min((1+X)*k._length,T),S=Math.max(-X*A._length,S),E=Math.min((1+X)*A._length,E)}var Z,J,K=Math.round(T-i),Q=Math.round(E-S);if(K<=0||Q<=0)return I.selectAll("image").data([]).exit().remove(),void x(I);"fast"===H?(Z=G,J=q):(Z=K,J=Q);var $=document.createElement("canvas");$.width=Z,$.height=J;var tt,te,tr=$.getContext("2d"),tn=m(z,{noNumericCheck:!0,returnArray:!0});"fast"===H?(tt=Y?function(r){return G-1-r}:u.identity,te=W?function(r){return q-1-r}:u.identity):(tt=function(r){return u.constrain(Math.round(k.c2p(B[r])-i),0,K)},te=function(r){return u.constrain(Math.round(A.c2p(N[r])-S),0,Q)});var ti,ta,to,ts,tl=te(0),tc=[tl,tl],tu=Y?0:1,tf=W?0:1,th=0,tp=0,td=0,tm=0;function tg(r,n){if(void 0!==r){var i=tn(r);return i[0]=Math.round(i[0]),i[1]=Math.round(i[1]),i[2]=Math.round(i[2]),th+=n,tp+=i[0]*n,td+=i[1]*n,tm+=i[2]*n,i}return[0,0,0,0]}if(H){var tv,ty=0;try{tv=new Uint8Array(K*Q*4)}catch(r){tv=Array(K*Q*4)}if("best"===H){var tx,tb,t_,tw=j||B,tT=U||N,tk=Array(tw.length),tA=Array(tT.length),tM=Array(K),tS=j?_:b,tE=U?_:b;for(L=0;L<tw.length;L++)tk[L]=Math.round(k.c2p(tw[L])-i);for(L=0;L<tT.length;L++)tA[L]=Math.round(A.c2p(tT[L])-S);for(L=0;L<K;L++)tM[L]=tS(L,tk);for(C=0;C<Q;C++)for(tb=F[(tx=tE(C,tA)).bin0],t_=F[tx.bin1],L=0;L<K;L++,ty+=4)w(tv,ty,ts=function(r,n,i,a){var o=r[i.bin0];if(void 0===o)return tg(void 0,1);var s=r[i.bin1],l=n[i.bin0],c=n[i.bin1];return tg(o+i.frac*(s-o||0)+a.frac*((l-o||0)+i.frac*(void 0===s?void 0===c?0:void 0===l?2*(c-o):2*(2*c-l-o)/3:void 0===c?void 0===l?0:2*(2*o-s-l)/3:void 0===l?2*(2*c-s-o)/3:c+o-s-l)))}(tb,t_,tM[L],tx))}else for(C=0;C<q;C++)for(to=F[C],tc=te(C),L=0;L<K;L++)ts=tg(to[L],1),w(tv,ty=4*(tc*K+tt(L)),ts);var tL=tr.createImageData(K,Q);try{tL.data.set(tv)}catch(r){var tC=tL.data,tP=tC.length;for(C=0;C<tP;C++)tC[C]=tv[C]}tr.putImageData(tL,0,0)}else{var tI=Math.floor(D/2),tO=Math.floor(R/2);for(C=0;C<q;C++)if(to=F[C],tc.reverse(),tc[tf]=te(C+1),tc[0]!==tc[1]&&void 0!==tc[0]&&void 0!==tc[1])for(ti=[ta=tt(0),ta],L=0;L<G;L++)ti.reverse(),ti[tu]=tt(L+1),ti[0]!==ti[1]&&void 0!==ti[0]&&void 0!==ti[1]&&(ts=tg(to[L],(ti[1]-ti[0])*(tc[1]-tc[0])),tr.fillStyle="rgba("+ts.join(",")+")",tr.fillRect(ti[0]+tI,tc[0]+tO,ti[1]-ti[0]-D,tc[1]-tc[0]-R))}var tz=o("rgb("+(tp=Math.round(tp/th))+","+(td=Math.round(td/th))+","+(tm=Math.round(tm/th))+")");r._hmpixcount=(r._hmpixcount||0)+th,r._hmlumcount=(r._hmlumcount||0)+th*tz.getLuminance();var tD=I.selectAll("image").data(n);tD.enter().append("svg:image").attr({xmlns:g.svg,preserveAspectRatio:"none"}),tD.attr({height:Q,width:K,x:i,y:S,"xlink:href":$.toDataURL("image/png")}),x(I);var tR=z.texttemplate;if(tR){var tF=d(z),tB={type:"linear",range:[tF.min,tF.max],_separators:k._separators,_numFormat:k._numFormat},tN="histogram2dcontour"===z.type,tj="contour"===z.type,tU=tj?q-1:q,tV=tj?1:0,tH=tj?G-1:G,tq=[];for(L=tj?1:0;L<tU;L++){if(tj)tY=O.y[L];else if(tN){if(0===L||L===q-1)continue;tY=O.y[L]}else if(O.yCenter)tY=O.yCenter[L];else{if(L+1===q&&void 0===O.y[L+1])continue;tY=(O.y[L]+O.y[L+1])/2}var tG=Math.round(A.c2p(tY));if(!(0>tG||tG>A._length))for(C=tV;C<tH;C++){if(tj)tW=O.x[C];else if(tN){if(0===C||C===G-1)continue;tW=O.x[C]}else if(O.xCenter)tW=O.xCenter[C];else{if(C+1===G&&void 0===O.x[C+1])continue;tW=(O.x[C]+O.x[C+1])/2}var tY,tW,tX=Math.round(k.c2p(tW));if(!(0>tX||tX>k._length)){var tZ=h({x:tW,y:tY},z,r._fullLayout);tZ.x=tW,tZ.y=tY;var tJ=O.z[L][C];void 0===tJ?(tZ.z="",tZ.zLabel=""):(tZ.z=tJ,tZ.zLabel=c.tickText(tB,tJ,"hover").text);var tK=O.text&&O.text[L]&&O.text[L][C];void 0!==tK&&!1!==tK||(tK=""),tZ.text=tK;var tQ=u.texttemplateString(tR,tZ,r._fullLayout._d3locale,tZ,z._meta||{});if(tQ){var t$=tQ.split("<br>"),t0=t$.length,t1=0;for(P=0;P<t0;P++)t1=Math.max(t1,t$[P].length);tq.push({l:t0,c:t1,t:tQ,x:tX,y:tG,z:tJ})}}}}var t2=z.textfont,t3=t2.family,t5=t2.size;if(!t5||"auto"===t5){var t4=1/0,t6=1/0,t8=0,t9=0;for(P=0;P<tq.length;P++){var t7=tq[P];if(t8=Math.max(t8,t7.l),t9=Math.max(t9,t7.c),P<tq.length-1){var et=tq[P+1],ee=Math.abs(et.x-t7.x),er=Math.abs(et.y-t7.y);ee&&(t4=Math.min(t4,ee)),er&&(t6=Math.min(t6,er))}}isFinite(t4)&&isFinite(t6)?(t4-=D,t6-=R,t4/=t9,t6/=t8,t4/=v/2,t6/=v,t5=Math.min(Math.floor(t4),Math.floor(t6))):t5=12}if(t5<=0||!isFinite(t5))return;y(I).data(tq).enter().append("g").classed("heatmap-label",1).append("text").attr("text-anchor","middle").each(function(n){var i=a.select(this),o=t2.color;o&&"auto"!==o||(o=p.contrast("rgba("+tn(n.z).join()+")")),i.attr("data-notex",1).call(f.positionText,n.x,n.y-t5*(n.l*v/2-1)).call(l.font,t3,t5,o).text(n.t).call(f.convertToTspans,r)})}})}},{"../../components/color":366,"../../components/colorscale":378,"../../components/drawing":388,"../../constants/alignment":471,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../registry":638,"../scatter/format_labels":935,"@plotly/d3":58,tinycolor2:312}],805:[function(r,n,i){"use strict";var a=r("@plotly/d3");n.exports=function(r){a.select(r).selectAll(".hm image").style("opacity",function(r){return r.trace.opacity})}},{"@plotly/d3":58}],806:[function(r,n,i){"use strict";n.exports=function(r,n,i){!1===i("zsmooth")&&(i("xgap"),i("ygap")),i("zhoverformat")}},{}],807:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../../registry");function l(r,n){var i=n(r);return"scaled"===(i?n(r+"type","array"):"scaled")&&(n(r+"0"),n("d"+r)),i}n.exports=function(r,n,i,c,u,f){var h,p,d=i("z");if(u=u||"x",f=f||"y",void 0===d||!d.length)return 0;if(o.isArray1D(r.z)){h=i(u),p=i(f);var m=o.minRowLength(h),g=o.minRowLength(p);if(0===m||0===g)return 0;n._length=Math.min(m,g,d.length)}else{if(h=l(u,i),p=l(f,i),!function(r){for(var n,i=!0,s=!1,l=!1,c=0;c<r.length;c++){if(n=r[c],!o.isArrayOrTypedArray(n)){i=!1;break}n.length>0&&(s=!0);for(var u=0;u<n.length;u++)if(a(n[u])){l=!0;break}}return i&&s&&l}(d))return 0;i("transpose"),n._length=null}return"heatmapgl"===r.type||s.getComponentMethod("calendars","handleTraceDefaults")(r,n,[u,f],c),!0}},{"../../lib":503,"../../registry":638,"fast-isnumeric":190}],808:[function(r,n,i){"use strict";for(var a=r("../heatmap/attributes"),o=r("../../components/colorscale/attributes"),s=r("../../lib/extend").extendFlat,l=r("../../plot_api/edit_types").overrideAll,c=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],u={},f=0;f<c.length;f++){var h=c[f];u[h]=a[h]}u.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},s(u,o("",{cLetter:"z",autoColorDflt:!1})),n.exports=l(u,"calc","nested")},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../heatmap/attributes":792}],809:[function(r,n,i){"use strict";var a=r("../../../stackgl_modules").gl_heatmap2d,o=r("../../plots/cartesian/axes"),s=r("../../lib/str2rgbarray");function l(r,n){this.scene=r,this.uid=n,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=a(r.glplot,this.options),this.heatmap._trace=this}var c=l.prototype;c.handlePick=function(r){var n=this.options,i=n.shape,a=r.pointId,o=a%i[0],s=Math.floor(a/i[0]);return{trace:this,dataCoord:r.dataCoord,traceCoord:[n.x[o],n.y[s],n.z[a]],textLabel:this.textLabels[a],name:this.name,pointIndex:[s,o],hoverinfo:this.hoverinfo}},c.update=function(r,n){var i=n[0];this.index=r.index,this.name=r.name,this.hoverinfo=r.hoverinfo;var a=i.z;this.options.z=[].concat.apply([],a);var l=a[0].length,c=a.length;this.options.shape=[l,c],this.options.x=i.x,this.options.y=i.y,this.options.zsmooth=r.zsmooth;var u=function(r){for(var n=r.colorscale,i=r.zmin,a=r.zmax,o=n.length,l=Array(o),c=Array(4*o),u=0;u<o;u++){var f=n[u],h=s(f[1]);l[u]=i+f[0]*(a-i);for(var p=0;p<4;p++)c[4*u+p]=h[p]}return{colorLevels:l,colorValues:c}}(r);this.options.colorLevels=u.colorLevels,this.options.colorValues=u.colorValues,this.textLabels=[].concat.apply([],r.text),this.heatmap.update(this.options);var f,h,p=this.scene.xaxis,d=this.scene.yaxis;!1===r.zsmooth&&(f={ppad:i.x[1]-i.x[0]},h={ppad:i.y[1]-i.y[0]}),r._extremes[p._id]=o.findExtremes(p,i.x,f),r._extremes[d._id]=o.findExtremes(d,i.y,h)},c.dispose=function(){this.heatmap.dispose()},n.exports=function(r,n,i){var a=new l(r,n.uid);return a.update(n,i),a}},{"../../../stackgl_modules":1120,"../../lib/str2rgbarray":528,"../../plots/cartesian/axes":554}],810:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../heatmap/xyz_defaults"),s=r("../../components/colorscale/defaults"),l=r("./attributes");n.exports=function(r,n,i,c){function u(i,o){return a.coerce(r,n,l,i,o)}o(r,n,u,c)?(u("text"),u("zsmooth"),s(r,n,c,u,{prefix:"",cLetter:"z"})):n.visible=!1}},{"../../components/colorscale/defaults":376,"../../lib":503,"../heatmap/xyz_defaults":807,"./attributes":808}],811:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../heatmap/colorbar"),calc:r("../heatmap/calc"),plot:r("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:r("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":596,"../heatmap/calc":793,"../heatmap/colorbar":795,"./attributes":808,"./convert":809,"./defaults":810}],812:[function(r,n,i){"use strict";var a=r("../bar/attributes"),o=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,s=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../../plots/template_attributes").texttemplateAttrs,c=r("../../plots/font_attributes"),u=r("./bin_attributes"),f=r("./constants"),h=r("../../lib/extend").extendFlat;n.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:o("x"),yhoverformat:o("y"),text:h({},a.text,{}),hovertext:h({},a.hovertext,{}),orientation:a.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:u("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:u("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:s({},{keys:f.eventDataKeys}),texttemplate:l({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:h({},a.textposition,{arrayOk:!1}),textfont:c({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:c({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:c({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:a.insidetextanchor,textangle:a.textangle,cliponaxis:a.cliponaxis,constraintext:a.constraintext,marker:a.marker,offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,_deprecated:{bardir:a._deprecated.bardir}}},{"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"../bar/attributes":648,"./bin_attributes":814,"./constants":818}],813:[function(r,n,i){"use strict";n.exports=function(r,n){for(var i=r.length,a=0,o=0;o<i;o++)n[o]?(r[o]/=n[o],a+=r[o]):r[o]=null;return a}},{}],814:[function(r,n,i){"use strict";n.exports=function(r,n){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],815:[function(r,n,i){"use strict";var a=r("fast-isnumeric");n.exports={count:function(r,n,i){return i[r]++,1},sum:function(r,n,i,o){var s=o[n];return a(s)?(s=Number(s),i[r]+=s,s):0},avg:function(r,n,i,o,s){var l=o[n];return a(l)&&(l=Number(l),i[r]+=l,s[r]++),0},min:function(r,n,i,o){var s=o[n];if(a(s)){if(s=Number(s),!a(i[r]))return i[r]=s,s;if(i[r]>s){var l=s-i[r];return i[r]=s,l}}return 0},max:function(r,n,i,o){var s=o[n];if(a(s)){if(s=Number(s),!a(i[r]))return i[r]=s,s;if(i[r]<s){var l=s-i[r];return i[r]=s,l}}return 0}}},{"fast-isnumeric":190}],816:[function(r,n,i){"use strict";var a=r("../../constants/numerical"),o=a.ONEAVGYEAR,s=a.ONEAVGMONTH,l=a.ONEDAY,c=a.ONEHOUR,u=a.ONEMIN,f=a.ONESEC,h=r("../../plots/cartesian/axes").tickIncrement;function p(r,n,i,a){if(r*n<=0)return 1/0;for(var s=Math.abs(n-r),c="date"===i.type,u=d(s,c),f=0;f<10;f++){var h=d(80*u,c);if(u===h||!function(r,n,i,a,s,c){if(a&&r>l){var u=m(n,s,c),f=m(i,s,c),h=r===o?0:1;return u[h]!==f[h]}return Math.floor(i/r)-Math.floor(n/r)>.1}(h,r,n,c,i,a))break;u=h}return u}function d(r,n){return n&&r>f?r>l?r>1.1*o?o:r>1.1*s?s:l:r>c?c:r>u?u:f:Math.pow(10,Math.floor(Math.log(r)/Math.LN10))}function m(r,n,i){var a=n.c2d(r,o,i).split("-");return""===a[0]&&(a.unshift(),a[0]="-"+a[0]),a}n.exports=function(r,n,i,a,s){var c,u,f=-1.1*n,d=-.1*n,m=r-d,g=i[0],v=i[1],y=Math.min(p(g+d,g+m,a,s),p(v+d,v+m,a,s)),x=Math.min(p(g+f,g+d,a,s),p(v+f,v+d,a,s));if(y>x&&x<Math.abs(v-g)/4e3?(c=y,u=!1):(c=Math.min(y,x),u=!0),"date"===a.type&&c>l){var b=c===o?1:6,_=c===o?"M12":"M1";return function(n,i){var l=a.c2d(n,o,s),c=l.indexOf("-",b);c>0&&(l=l.substr(0,c));var f=a.d2c(l,0,s);if(f<n){var p=h(f,_,!1,s);(f+p)/2<n+r&&(f=p)}return i&&u?h(f,_,!0,s):f}}return function(n,i){var a=c*Math.round(n/c);return a+c/10<n&&a+.9*c<n+r&&(a+=c),i&&u&&(a-=c),a}}},{"../../constants/numerical":479,"../../plots/cartesian/axes":554}],817:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../../registry"),l=r("../../plots/cartesian/axes"),c=r("../bar/arrays_to_calcdata"),u=r("./bin_functions"),f=r("./norm_functions"),h=r("./average"),p=r("./bin_label_vals");function d(r,n,i,c,u){var f,h,p,m,g,v,y,x=c+"bins",b=r._fullLayout,_=n["_"+c+"bingroup"],w=b._histogramBinOpts[_],T="overlay"===b.barmode,k=function(r){return i.r2c(r,0,m)},A=function(r){return i.c2r(r,0,m)},M="date"===i.type?function(r){return r||0===r?o.cleanDate(r,null,m):null}:function(r){return a(r)?Number(r):null};function S(r,n,i){n[r+"Found"]?(n[r]=M(n[r]),null===n[r]&&(n[r]=i[r])):(v[r]=n[r]=i[r],o.nestedProperty(h[0],x+"."+r).set(i[r]))}if(n["_"+c+"autoBinFinished"])delete n["_"+c+"autoBinFinished"];else{h=w.traces;var E=[],L=!0,C=!1,P=!1;for(f=0;f<h.length;f++)if((p=h[f]).visible){var I=w.dirs[f];g=p["_"+I+"pos0"]=i.makeCalcdata(p,I),E=o.concat(E,g),delete p["_"+c+"autoBinFinished"],!0===n.visible&&(L?L=!1:(delete p._autoBin,p["_"+c+"autoBinFinished"]=1),s.traceIs(p,"2dMap")&&(C=!0),"histogram2dcontour"===p.type&&(P=!0))}m=h[0][c+"calendar"];var O=l.autoBin(E,i,w.nbins,C,m,w.sizeFound&&w.size);if(v=(h[0]._autoBin={})[w.dirs[0]]={},P&&(w.size||(O.start=A(l.tickIncrement(k(O.start),O.size,!0,m))),void 0===w.end&&(O.end=A(l.tickIncrement(k(O.end),O.size,!1,m)))),T&&!s.traceIs(n,"2dMap")&&0===O._dataSpan&&"category"!==i.type&&"multicategory"!==i.type){if(u)return[O,g,!0];O=function(r,n,i,a,s){var l,c,u,f=r._fullLayout,h=function(r,n){for(var i=n.xaxis,a=n.yaxis,o=n.orientation,s=[],l=r._fullData,c=0;c<l.length;c++){var u=l[c];"histogram"===u.type&&!0===u.visible&&u.orientation===o&&u.xaxis===i&&u.yaxis===a&&s.push(u)}return s}(r,n),p=!1,m=1/0,g=[n];for(l=0;l<h.length;l++)if((c=h[l])===n)p=!0;else if(p){var v=d(r,c,i,a,!0),y=v[0],x=v[2];c["_"+a+"autoBinFinished"]=1,c["_"+a+"pos0"]=v[1],x?g.push(c):m=Math.min(m,y.size)}else m=Math.min(m,(u=f._histogramBinOpts[c["_"+a+"bingroup"]]).size||c[s].size);var b=Array(g.length);for(l=0;l<g.length;l++)for(var _=g[l]["_"+a+"pos0"],w=0;w<_.length;w++)if(void 0!==_[w]){b[l]=_[w];break}for(isFinite(m)||(m=o.distinctVals(b).minDiff),l=0;l<g.length;l++){var T=(c=g[l])[a+"calendar"],k={start:i.c2r(b[l]-m/2,0,T),end:i.c2r(b[l]+m/2,0,T),size:m};c._input[s]=c[s]=k,(u=f._histogramBinOpts[c["_"+a+"bingroup"]])&&o.extendFlat(u,k)}return n[s]}(r,n,i,c,x)}(y=p.cumulative||{}).enabled&&"include"!==y.currentbin&&("decreasing"===y.direction?O.start=A(l.tickIncrement(k(O.start),O.size,!0,m)):O.end=A(l.tickIncrement(k(O.end),O.size,!1,m))),w.size=O.size,w.sizeFound||(v.size=O.size,o.nestedProperty(h[0],x+".size").set(O.size)),S("start",w,O),S("end",w,O)}g=n["_"+c+"pos0"],delete n["_"+c+"pos0"];var z=n._input[x]||{},D=o.extendFlat({},w),R=w.start,F=i.r2l(z.start),B=void 0!==F;if((w.startFound||B)&&F!==i.r2l(R)){var N=B?F:o.aggNums(Math.min,null,g),j={type:"category"===i.type||"multicategory"===i.type?"linear":i.type,r2l:i.r2l,dtick:w.size,tick0:R,calendar:m,range:[N,l.tickIncrement(N,w.size,!1,m)].map(i.l2r)},U=l.tickFirst(j);U>i.r2l(N)&&(U=l.tickIncrement(U,w.size,!0,m)),D.start=i.l2r(U),B||o.nestedProperty(n,x+".start").set(D.start)}var V=w.end,H=i.r2l(z.end),q=void 0!==H;if((w.endFound||q)&&H!==i.r2l(V)){var G=q?H:o.aggNums(Math.max,null,g);D.end=i.l2r(G),q||o.nestedProperty(n,x+".start").set(D.end)}var Y="autobin"+c;return!1===n._input[Y]&&(n._input[x]=o.extendFlat({},n[x]||{}),delete n._input[Y],delete n[Y]),[D,g]}n.exports={calc:function(r,n){var i,s,m,g,v=[],y=[],x=l.getFromId(r,"h"===n.orientation?n.yaxis:n.xaxis),b="h"===n.orientation?"y":"x",_={x:"y",y:"x"}[b],w=n[b+"calendar"],T=n.cumulative,k=d(r,n,x,b),A=k[0],M=k[1],S="string"==typeof A.size,E=[],L=S?E:A,C=[],P=[],I=[],O=0,z=n.histnorm,D=n.histfunc,R=-1!==z.indexOf("density");T.enabled&&R&&(z=z.replace(/ ?density$/,""),R=!1);var F,B="max"===D||"min"===D?null:0,N=u.count,j=f[z],U=!1,V=function(r){return x.r2c(r,0,w)};for(o.isArrayOrTypedArray(n[_])&&"count"!==D&&(F=n[_],U="avg"===D,N=u[D]),i=V(A.start),m=V(A.end)+(i-l.tickIncrement(i,A.size,!1,w))/1e6;i<m&&v.length<1e6&&(s=l.tickIncrement(i,A.size,!1,w),v.push((i+s)/2),y.push(B),I.push([]),E.push(i),R&&C.push(1/(s-i)),U&&P.push(0),!(s<=i));)i=s;E.push(i),S||"date"!==x.type||(L={start:V(L.start),end:V(L.end),size:L.size}),r._fullLayout._roundFnOpts||(r._fullLayout._roundFnOpts={});var H=n["_"+b+"bingroup"],q={leftGap:1/0,rightGap:1/0};H&&(r._fullLayout._roundFnOpts[H]||(r._fullLayout._roundFnOpts[H]=q),q=r._fullLayout._roundFnOpts[H]);var G,Y=y.length,W=!0,X=q.leftGap,Z=q.rightGap,J={};for(i=0;i<M.length;i++){var K=M[i];(g=o.findBin(K,L))>=0&&g<Y&&(O+=N(g,i,y,F,P),W&&I[g].length&&K!==M[I[g][0]]&&(W=!1),I[g].push(i),J[i]=g,X=Math.min(X,K-E[g]),Z=Math.min(Z,E[g+1]-K))}q.leftGap=X,q.rightGap=Z,W||(G=function(n,i){return function(){var a=r._fullLayout._roundFnOpts[H];return p(a.leftGap,a.rightGap,E,x,w)(n,i)}}),U&&(O=h(y,P)),j&&j(y,O,C),T.enabled&&function(r,n,i){var a,o,s;function l(n){s=r[n],r[n]/=2}function c(n){o=r[n],r[n]=s+o/2,s+=o}if("half"===i){if("increasing"===n)for(l(0),a=1;a<r.length;a++)c(a);else for(l(r.length-1),a=r.length-2;a>=0;a--)c(a)}else if("increasing"===n){for(a=1;a<r.length;a++)r[a]+=r[a-1];"exclude"===i&&(r.unshift(0),r.pop())}else{for(a=r.length-2;a>=0;a--)r[a]+=r[a+1];"exclude"===i&&(r.push(0),r.shift())}}(y,T.direction,T.currentbin);var Q=Math.min(v.length,y.length),$=[],tt=0,te=Q-1;for(i=0;i<Q;i++)if(y[i]){tt=i;break}for(i=Q-1;i>=tt;i--)if(y[i]){te=i;break}for(i=tt;i<=te;i++)if(a(v[i])&&a(y[i])){var tr={p:v[i],s:y[i],b:0};T.enabled||(tr.pts=I[i],W?tr.ph0=tr.ph1=I[i].length?M[I[i][0]]:v[i]:(n._computePh=!0,tr.ph0=G(E[i]),tr.ph1=G(E[i+1],!0))),$.push(tr)}return 1===$.length&&($[0].width1=l.tickIncrement($[0].p,A.size,!1,w)-$[0].p),c($,n),o.isArrayOrTypedArray(n.selectedpoints)&&o.tagSelected($,n,J),$},calcAllAutoBins:d}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"../bar/arrays_to_calcdata":647,"./average":813,"./bin_functions":815,"./bin_label_vals":816,"./norm_functions":824,"fast-isnumeric":190}],818:[function(r,n,i){"use strict";n.exports={eventDataKeys:["binNumber"]}},{}],819:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axis_ids"),s=r("../../registry").traceIs,l=r("../bar/defaults").handleGroupingDefaults,c=a.nestedProperty,u=r("../../plots/cartesian/constraints").getAxisGroup,f=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],h=["x","y"];n.exports=function(r,n){var i,p,d,m,g,v,y,x=n._histogramBinOpts={},b=[],_={},w=[];function T(r,n){return a.coerce(i._input,i,i._module.attributes,r,n)}function k(r){return"v"===r.orientation?"x":"y"}function A(r,i,s){var l=r.uid+"__"+s;i||(i=l);var c=o.getFromTrace({_fullLayout:n},r,s).type,u=r[s+"calendar"]||"",f=x[i],h=!0;f&&(c===f.axType&&u===f.calendar?(h=!1,f.traces.push(r),f.dirs.push(s)):(i=l,c!==f.axType&&a.warn(["Attempted to group the bins of trace",r.index,"set on a","type:"+c,"axis","with bins on","type:"+f.axType,"axis."].join(" ")),u!==f.calendar&&a.warn(["Attempted to group the bins of trace",r.index,"set with a",u,"calendar","with bins",f.calendar?"on a "+f.calendar+" calendar":"w/o a set calendar"].join(" ")))),h&&(x[i]={traces:[r],dirs:[s],axType:c,calendar:r[s+"calendar"]||""}),r["_"+s+"bingroup"]=i}for(g=0;g<r.length;g++)s(i=r[g],"histogram")&&(b.push(i),delete i._xautoBinFinished,delete i._yautoBinFinished,s(i,"2dMap")||l(i._input,i,n,T));var M=n._alignmentOpts||{};for(g=0;g<b.length;g++){if(i=b[g],d="",!s(i,"2dMap")){if(m=k(i),"group"===n.barmode&&i.alignmentgroup){var S=u(n,i[m+"axis"])+i.orientation;(M[S]||{})[i.alignmentgroup]&&(d=S)}d||"overlay"===n.barmode||(d=u(n,i.xaxis)+u(n,i.yaxis)+k(i))}d?(_[d]||(_[d]=[]),_[d].push(i)):w.push(i)}for(d in _)if(1!==(p=_[d]).length){var E=!1;for(p.length&&(i=p[0],E=T("bingroup")),d=E||d,g=0;g<p.length;g++){var L=(i=p[g])._input.bingroup;L&&L!==d&&a.warn(["Trace",i.index,"must match","within bingroup",d+".","Ignoring its bingroup:",L,"setting."].join(" ")),i.bingroup=d,A(i,d,k(i))}}else w.push(p[0]);for(g=0;g<w.length;g++){i=w[g];var C=T("bingroup");if(s(i,"2dMap"))for(y=0;y<2;y++){var P=T((m=h[y])+"bingroup",C?C+"__"+m:null);A(i,P,m)}else A(i,C,k(i))}for(d in x){var I=x[d];for(p=I.traces,v=0;v<f.length;v++){var O,z,D=f[v],R=D.name;if("nbins"!==R||!I.sizeFound){for(g=0;g<p.length;g++){if(i=p[g],m=I.dirs[g],O=D.aStr[m],void 0!==c(i._input,O).get()){I[R]=T(O),I[R+"Found"]=!0;break}(z=(i._autoBin||{})[m]||{})[R]&&c(i,O).set(z[R])}if("start"===R||"end"===R)for(;g<p.length;g++)(i=p[g])["_"+m+"bingroup"]&&T(O,(z=(i._autoBin||{})[m]||{})[R]);"nbins"!==R||I.sizeFound||I.nbinsFound||(i=p[0],I[R]=T(O))}}}}},{"../../lib":503,"../../plots/cartesian/axis_ids":558,"../../plots/cartesian/constraints":562,"../../registry":638,"../bar/defaults":652}],820:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("../../components/color"),l=r("../bar/defaults").handleText,c=r("../bar/style_defaults"),u=r("./attributes");n.exports=function(r,n,i,f){function h(i,a){return o.coerce(r,n,u,i,a)}var p=h("x"),d=h("y");h("cumulative.enabled")&&(h("cumulative.direction"),h("cumulative.currentbin")),h("text");var m=h("textposition");l(r,n,f,h,m,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),h("hovertext"),h("hovertemplate"),h("xhoverformat"),h("yhoverformat");var g=h("orientation",d&&!p?"h":"v"),v="v"===g?"x":"y",y=p&&d?Math.min(o.minRowLength(p)&&o.minRowLength(d)):o.minRowLength(n[v]||[]);if(y){n._length=y,a.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x","y"],f),n["v"===g?"y":"x"]&&h("histfunc"),h("histnorm"),h("autobin"+v),c(r,n,h,i,f),o.coerceSelectionMarkerOpacity(n,h);var x=(n.marker.line||{}).color,b=a.getComponentMethod("errorbars","supplyDefaults");b(r,n,x||s.defaultLine,{axis:"y"}),b(r,n,x||s.defaultLine,{axis:"x",inherit:"y"})}else n.visible=!1}},{"../../components/color":366,"../../lib":503,"../../registry":638,"../bar/defaults":652,"../bar/style_defaults":663,"./attributes":812}],821:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o){if(r.x="xVal"in n?n.xVal:n.x,r.y="yVal"in n?n.yVal:n.y,"zLabelVal"in n&&(r.z=n.zLabelVal),n.xa&&(r.xaxis=n.xa),n.ya&&(r.yaxis=n.ya),!(i.cumulative||{}).enabled){var s,l=Array.isArray(o)?a[0].pts[o[0]][o[1]]:a[o].pts;if(r.pointNumbers=l,r.binNumber=r.pointNumber,delete r.pointNumber,delete r.pointIndex,i._indexToPoints){s=[];for(var c=0;c<l.length;c++)s=s.concat(i._indexToPoints[l[c]])}else s=l;r.pointIndices=s}return r}},{}],822:[function(r,n,i){"use strict";var a=r("../bar/hover").hoverPoints,o=r("../../plots/cartesian/axes").hoverLabelText;n.exports=function(r,n,i,s,l){var c=a(r,n,i,s,l);if(c){var u=(r=c[0]).cd[r.index],f=r.cd[0].trace;if(!f.cumulative.enabled){var h="h"===f.orientation?"y":"x";r[h+"Label"]=o(r[h+"a"],[u.ph0,u.ph1],f[h+"hoverformat"])}return c}}},{"../../plots/cartesian/axes":554,"../bar/hover":655}],823:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),layoutAttributes:r("../bar/layout_attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("./cross_trace_defaults"),supplyLayoutDefaults:r("../bar/layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("../bar/cross_trace_calc").crossTraceCalc,plot:r("../bar/plot").plot,layerName:"barlayer",style:r("../bar/style").style,styleOnSelect:r("../bar/style").styleOnSelect,colorbar:r("../scatter/marker_colorbar"),hoverPoints:r("./hover"),selectPoints:r("../bar/select"),eventData:r("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":568,"../bar/cross_trace_calc":651,"../bar/layout_attributes":657,"../bar/layout_defaults":658,"../bar/plot":659,"../bar/select":660,"../bar/style":662,"../scatter/marker_colorbar":944,"./attributes":812,"./calc":817,"./cross_trace_defaults":819,"./defaults":820,"./event_data":821,"./hover":822}],824:[function(r,n,i){"use strict";n.exports={percent:function(r,n){for(var i=r.length,a=100/n,o=0;o<i;o++)r[o]*=a},probability:function(r,n){for(var i=r.length,a=0;a<i;a++)r[a]/=n},density:function(r,n,i,a){var o=r.length;a=a||1;for(var s=0;s<o;s++)r[s]*=i[s]*a},"probability density":function(r,n,i,a){var o=r.length;a&&(n/=a);for(var s=0;s<o;s++)r[s]*=i[s]/n}}},{}],825:[function(r,n,i){"use strict";var a=r("../histogram/attributes"),o=r("../histogram/bin_attributes"),s=r("../heatmap/attributes"),l=r("../../plots/attributes"),c=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,u=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../plots/template_attributes").texttemplateAttrs,h=r("../../components/colorscale/attributes"),p=r("../../lib/extend").extendFlat;n.exports=p({x:a.x,y:a.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:o("x"),nbinsy:a.nbinsy,ybins:o("y"),autobinx:a.autobinx,autobiny:a.autobiny,bingroup:p({},a.bingroup,{}),xbingroup:p({},a.bingroup,{}),ybingroup:p({},a.bingroup,{}),xgap:s.xgap,ygap:s.ygap,zsmooth:s.zsmooth,xhoverformat:c("x"),yhoverformat:c("y"),zhoverformat:c("z",1),hovertemplate:u({},{keys:"z"}),texttemplate:f({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:s.textfont,showlegend:p({},l.showlegend,{dflt:!1})},h("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../heatmap/attributes":792,"../histogram/attributes":812,"../histogram/bin_attributes":814}],826:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("../histogram/bin_functions"),l=r("../histogram/norm_functions"),c=r("../histogram/average"),u=r("../histogram/bin_label_vals"),f=r("../histogram/calc").calcAllAutoBins;function h(r,n,i,a){var o,s=Array(r);if(a)for(o=0;o<r;o++)s[o]=1/(n[o+1]-n[o]);else{var l=1/i;for(o=0;o<r;o++)s[o]=l}return s}function p(r,n){return{start:r(n.start),end:r(n.end),size:n.size}}function d(r,n,i,a,o,s){var l,c=r.length-1,f=Array(c),h=u(i,a,r,o,s);for(l=0;l<c;l++){var p=(n||[])[l];f[l]=void 0===p?[h(r[l]),h(r[l+1],!0)]:[p,p]}return f}n.exports=function(r,n){var i,u,m,g,v,y=o.getFromId(r,n.xaxis),x=o.getFromId(r,n.yaxis),b=n.xcalendar,_=n.ycalendar,w=function(r){return y.r2c(r,0,b)},T=function(r){return x.r2c(r,0,_)},k=f(r,n,y,"x"),A=k[0],M=k[1],S=f(r,n,x,"y"),E=S[0],L=S[1],C=n._length;M.length>C&&M.splice(C,M.length-C),L.length>C&&L.splice(C,L.length-C);var P=[],I=[],O=[],z="string"==typeof A.size,D="string"==typeof E.size,R=[],F=[],B=z?R:A,N=D?F:E,j=0,U=[],V=[],H=n.histnorm,q=n.histfunc,G=-1!==H.indexOf("density"),Y="max"===q||"min"===q?null:0,W=s.count,X=l[H],Z=!1,J=[],K=[],Q="z"in n?n.z:"marker"in n&&Array.isArray(n.marker.color)?n.marker.color:"";Q&&"count"!==q&&(Z="avg"===q,W=s[q]);var $=A.size,tt=w(A.start),te=w(A.end)+(tt-o.tickIncrement(tt,$,!1,b))/1e6;for(u=tt;u<te;u=o.tickIncrement(u,$,!1,b))I.push(Y),R.push(u),Z&&O.push(0);R.push(u);var tr,tn=I.length,ti=(u-tt)/tn,ta=(tr=tt+ti/2,y.c2r(tr,0,b)),to=E.size,ts=T(E.start),tl=T(E.end)+(ts-o.tickIncrement(ts,to,!1,_))/1e6;for(u=ts;u<tl;u=o.tickIncrement(u,to,!1,_)){P.push(I.slice()),F.push(u);var tc=Array(tn);for(m=0;m<tn;m++)tc[m]=[];V.push(tc),Z&&U.push(O.slice())}F.push(u);var tu=P.length,tf=(u-ts)/tu,th=(i=ts+tf/2,x.c2r(i,0,_));G&&(J=h(I.length,B,ti,z),K=h(P.length,N,tf,D)),z||"date"!==y.type||(B=p(w,B)),D||"date"!==x.type||(N=p(T,N));var tp=!0,td=!0,tm=Array(tn),tg=Array(tu),tv=1/0,ty=1/0,tx=1/0,tb=1/0;for(u=0;u<C;u++){var t_=M[u],tw=L[u];g=a.findBin(t_,B),v=a.findBin(tw,N),g>=0&&g<tn&&v>=0&&v<tu&&(j+=W(g,u,P[v],Q,U[v]),V[v][g].push(u),tp&&(void 0===tm[g]?tm[g]=t_:tm[g]!==t_&&(tp=!1)),td&&(void 0===tg[v]?tg[v]=tw:tg[v]!==tw&&(td=!1)),tv=Math.min(tv,t_-R[g]),ty=Math.min(ty,R[g+1]-t_),tx=Math.min(tx,tw-F[v]),tb=Math.min(tb,F[v+1]-tw))}if(Z)for(v=0;v<tu;v++)j+=c(P[v],U[v]);if(X)for(v=0;v<tu;v++)X(P[v],j,J,K[v]);return{x:M,xRanges:d(R,tp&&tm,tv,ty,y,b),x0:ta,dx:ti,y:L,yRanges:d(F,td&&tg,tx,tb,x,_),y0:th,dy:tf,z:P,pts:V}}},{"../../lib":503,"../../plots/cartesian/axes":554,"../histogram/average":813,"../histogram/bin_functions":815,"../histogram/bin_label_vals":816,"../histogram/calc":817,"../histogram/norm_functions":824}],827:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./sample_defaults"),s=r("../heatmap/style_defaults"),l=r("../../components/colorscale/defaults"),c=r("../heatmap/label_defaults"),u=r("./attributes");n.exports=function(r,n,i,f){function h(i,o){return a.coerce(r,n,u,i,o)}o(r,n,h,f),!1!==n.visible&&(s(r,n,h,f),l(r,n,f,h,{prefix:"",cLetter:"z"}),h("hovertemplate"),c(h,f),h("xhoverformat"),h("yhoverformat"))}},{"../../components/colorscale/defaults":376,"../../lib":503,"../heatmap/label_defaults":802,"../heatmap/style_defaults":806,"./attributes":825,"./sample_defaults":830}],828:[function(r,n,i){"use strict";var a=r("../heatmap/hover"),o=r("../../plots/cartesian/axes").hoverLabelText;n.exports=function(r,n,i,s,l){var c=a(r,n,i,s,l);if(c){var u=(r=c[0]).index,f=u[0],h=u[1],p=r.cd[0],d=p.trace,m=p.xRanges[h],g=p.yRanges[f];return r.xLabel=o(r.xa,[m[0],m[1]],d.xhoverformat),r.yLabel=o(r.ya,[g[0],g[1]],d.yhoverformat),c}}},{"../../plots/cartesian/axes":554,"../heatmap/hover":799}],829:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../histogram/cross_trace_defaults"),calc:r("../heatmap/calc"),plot:r("../heatmap/plot"),layerName:"heatmaplayer",colorbar:r("../heatmap/colorbar"),style:r("../heatmap/style"),hoverPoints:r("./hover"),eventData:r("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":568,"../heatmap/calc":793,"../heatmap/colorbar":795,"../heatmap/plot":804,"../heatmap/style":805,"../histogram/cross_trace_defaults":819,"../histogram/event_data":821,"./attributes":825,"./defaults":827,"./hover":828}],830:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib");n.exports=function(r,n,i,s){var l=i("x"),c=i("y"),u=o.minRowLength(l),f=o.minRowLength(c);u&&f?(n._length=Math.min(u,f),a.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x","y"],s),(i("z")||i("marker.color"))&&i("histfunc"),i("histnorm"),i("autobinx"),i("autobiny")):n.visible=!1}},{"../../lib":503,"../../registry":638}],831:[function(r,n,i){"use strict";var a=r("../histogram2d/attributes"),o=r("../contour/attributes"),s=r("../../components/colorscale/attributes"),l=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,c=r("../../lib/extend").extendFlat;n.exports=c({x:a.x,y:a.y,z:a.z,marker:a.marker,histnorm:a.histnorm,histfunc:a.histfunc,nbinsx:a.nbinsx,xbins:a.xbins,nbinsy:a.nbinsy,ybins:a.ybins,autobinx:a.autobinx,autobiny:a.autobiny,bingroup:a.bingroup,xbingroup:a.xbingroup,ybingroup:a.ybingroup,autocontour:o.autocontour,ncontours:o.ncontours,contours:o.contours,line:{color:o.line.color,width:c({},o.line.width,{dflt:.5}),dash:o.line.dash,smoothing:o.line.smoothing,editType:"plot"},xhoverformat:l("x"),yhoverformat:l("y"),zhoverformat:l("z",1),hovertemplate:a.hovertemplate,texttemplate:o.texttemplate,textfont:o.textfont},s("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../contour/attributes":735,"../histogram2d/attributes":825}],832:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../histogram2d/sample_defaults"),s=r("../contour/contours_defaults"),l=r("../contour/style_defaults"),c=r("../heatmap/label_defaults"),u=r("./attributes");n.exports=function(r,n,i,f){function h(i,o){return a.coerce(r,n,u,i,o)}o(r,n,h,f),!1!==n.visible&&(s(r,n,h,function(i){return a.coerce2(r,n,u,i)}),l(r,n,h,f),h("xhoverformat"),h("yhoverformat"),h("hovertemplate"),n.contours&&"heatmap"===n.contours.coloring&&c(h,f))}},{"../../lib":503,"../contour/contours_defaults":742,"../contour/style_defaults":756,"../heatmap/label_defaults":802,"../histogram2d/sample_defaults":830,"./attributes":831}],833:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../histogram/cross_trace_defaults"),calc:r("../contour/calc"),plot:r("../contour/plot").plot,layerName:"contourlayer",style:r("../contour/style"),colorbar:r("../contour/colorbar"),hoverPoints:r("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":568,"../contour/calc":736,"../contour/colorbar":738,"../contour/hover":748,"../contour/plot":753,"../contour/style":755,"../histogram/cross_trace_defaults":819,"./attributes":831,"./defaults":832}],834:[function(r,n,i){"use strict";var a=r("../../plots/template_attributes").hovertemplateAttrs,o=r("../../plots/template_attributes").texttemplateAttrs,s=r("../../components/colorscale/attributes"),l=r("../../plots/domain").attributes,c=r("../pie/attributes"),u=r("../sunburst/attributes"),f=r("../treemap/attributes"),h=r("../treemap/constants"),p=r("../../lib/extend").extendFlat;n.exports={labels:u.labels,parents:u.parents,values:u.values,branchvalues:u.branchvalues,count:u.count,level:u.level,maxdepth:u.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:f.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:p({colors:u.marker.colors,line:u.marker.line,editType:"calc"},s("marker",{colorAttr:"colors",anim:!1})),leaf:u.leaf,pathbar:f.pathbar,text:c.text,textinfo:u.textinfo,texttemplate:o({editType:"plot"},{keys:h.eventDataKeys.concat(["label","value"])}),hovertext:c.hovertext,hoverinfo:u.hoverinfo,hovertemplate:a({},{keys:h.eventDataKeys}),textfont:c.textfont,insidetextfont:c.insidetextfont,outsidetextfont:f.outsidetextfont,textposition:f.textposition,sort:c.sort,root:u.root,domain:l({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":900,"../sunburst/attributes":1045,"../treemap/attributes":1071,"../treemap/constants":1074}],835:[function(r,n,i){"use strict";var a=r("../../plots/plots");i.name="icicle",i.plot=function(r,n,o,s){a.plotBasePlot(i.name,r,n,o,s)},i.clean=function(r,n,o,s){a.cleanBasePlot(i.name,r,n,o,s)}},{"../../plots/plots":619}],836:[function(r,n,i){"use strict";var a=r("../sunburst/calc");i.calc=function(r,n){return a.calc(r,n)},i.crossTraceCalc=function(r){return a._runCrossTraceCalc("icicle",r)}},{"../sunburst/calc":1047}],837:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("../../components/color"),l=r("../../plots/domain").defaults,c=r("../bar/defaults").handleText,u=r("../bar/constants").TEXTPAD,f=r("../../components/colorscale"),h=f.hasColorscale,p=f.handleDefaults;n.exports=function(r,n,i,f){function d(i,s){return a.coerce(r,n,o,i,s)}var m=d("labels"),g=d("parents");if(m&&m.length&&g&&g.length){var v=d("values");d(v&&v.length?"branchvalues":"count"),d("level"),d("maxdepth"),d("tiling.orientation"),d("tiling.flip"),d("tiling.pad");var y=d("text");d("texttemplate"),n.texttemplate||d("textinfo",Array.isArray(y)?"text+label":"label"),d("hovertext"),d("hovertemplate");var x=d("pathbar.visible");c(r,n,f,d,"auto",{hasPathbar:x,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),d("textposition"),d("marker.line.width")&&d("marker.line.color",f.paper_bgcolor),d("marker.colors");var b=n._hasColorscale=h(r,"marker","colors")||(r.marker||{}).coloraxis;b&&p(r,n,f,d,{prefix:"marker.",cLetter:"c"}),d("leaf.opacity",b?1:.7),n._hovered={marker:{line:{width:2,color:s.contrast(f.paper_bgcolor)}}},x&&(d("pathbar.thickness",n.pathbar.textfont.size+2*u),d("pathbar.side"),d("pathbar.edgeshape")),d("sort"),d("root.color"),l(n,f,d),n._length=null}else n.visible=!1}},{"../../components/color":366,"../../components/colorscale":378,"../../lib":503,"../../plots/domain":584,"../bar/constants":650,"../bar/defaults":652,"./attributes":834}],838:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../components/drawing"),l=r("../../lib/svg_text_utils"),c=r("./partition"),u=r("./style").styleOne,f=r("../treemap/constants"),h=r("../sunburst/helpers"),p=r("../sunburst/fx"),d=r("../sunburst/plot").formatSliceLabel;n.exports=function(r,n,i,m,g){var v=g.width,y=g.height,x=g.viewX,b=g.viewY,_=g.pathSlice,w=g.toMoveInsideSlice,T=g.strTransform,k=g.hasTransition,A=g.handleSlicesExit,M=g.makeUpdateSliceInterpolator,S=g.makeUpdateTextInterpolator,E=g.prevEntry,L=r._fullLayout,C=n[0].trace,P=-1!==C.textposition.indexOf("left"),I=-1!==C.textposition.indexOf("right"),O=-1!==C.textposition.indexOf("bottom"),z=c(i,[v,y],{flipX:C.tiling.flip.indexOf("x")>-1,flipY:C.tiling.flip.indexOf("y")>-1,orientation:C.tiling.orientation,pad:{inner:C.tiling.pad},maxDepth:C._maxDepth}).descendants(),D=1/0,R=-1/0;z.forEach(function(r){var n=r.depth;n>=C._maxDepth?(r.x0=r.x1=(r.x0+r.x1)/2,r.y0=r.y1=(r.y0+r.y1)/2):(D=Math.min(D,n),R=Math.max(R,n))}),m=m.data(z,h.getPtId),C._maxVisibleLayers=isFinite(R)?R-D+1:0,m.enter().append("g").classed("slice",!0),A(m,!1,{},[v,y],_),m.order();var F=null;if(k&&E){var B=h.getPtId(E);m.each(function(r){null===F&&h.getPtId(r)===B&&(F={x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1})})}var N=function(){return F||{x0:0,x1:v,y0:0,y1:y}},j=m;return k&&(j=j.transition().each("end",function(){var n=a.select(this);h.setSliceCursor(n,r,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),j.each(function(c){c._x0=x(c.x0),c._x1=x(c.x1),c._y0=b(c.y0),c._y1=b(c.y1),c._hoverX=x(c.x1-C.tiling.pad),c._hoverY=b(O?c.y1-C.tiling.pad/2:c.y0+C.tiling.pad/2);var m=a.select(this),g=o.ensureSingle(m,"path","surface",function(r){r.style("pointer-events","all")});k?g.transition().attrTween("d",function(r){var n=M(r,!1,N(),[v,y],{orientation:C.tiling.orientation,flipX:C.tiling.flip.indexOf("x")>-1,flipY:C.tiling.flip.indexOf("y")>-1});return function(r){return _(n(r))}}):g.attr("d",_),m.call(p,i,r,n,{styleOne:u,eventDataKeys:f.eventDataKeys,transitionTime:f.CLICK_TRANSITION_TIME,transitionEasing:f.CLICK_TRANSITION_EASING}).call(h.setSliceCursor,r,{isTransitioning:r._transitioning}),g.call(u,c,C,{hovered:!1}),c.x0===c.x1||c.y0===c.y1?c._text="":c._text=d(c,i,C,n,L)||"";var A=o.ensureSingle(m,"g","slicetext"),E=o.ensureSingle(A,"text","",function(r){r.attr("data-notex",1)}),z=o.ensureUniformFontSize(r,h.determineTextFont(C,c,L.font));E.text(c._text||" ").classed("slicetext",!0).attr("text-anchor",I?"end":P?"start":"middle").call(s.font,z).call(l.convertToTspans,r),c.textBB=s.bBox(E.node()),c.transform=w(c,{fontSize:z.size}),c.transform.fontSize=z.size,k?E.transition().attrTween("transform",function(r){var n=S(r,!1,N(),[v,y]);return function(r){return T(n(r))}}):E.attr("transform",T(c))}),F}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../sunburst/fx":1050,"../sunburst/helpers":1051,"../sunburst/plot":1055,"../treemap/constants":1074,"./partition":842,"./style":844,"@plotly/d3":58}],839:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"icicle",basePlotModule:r("./base_plot"),categories:[],animatable:!0,attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),style:r("./style").style,colorbar:r("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":944,"./attributes":834,"./base_plot":835,"./calc":836,"./defaults":837,"./layout_attributes":840,"./layout_defaults":841,"./plot":843,"./style":844}],840:[function(r,n,i){"use strict";n.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],841:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n){function i(i,s){return a.coerce(r,n,o,i,s)}i("iciclecolorway",n.colorway),i("extendiciclecolors")}},{"../../lib":503,"./layout_attributes":840}],842:[function(r,n,i){"use strict";var a=r("d3-hierarchy"),o=r("../treemap/flip_tree");n.exports=function(r,n,i){var s=i.flipX,l=i.flipY,c="h"===i.orientation,u=i.maxDepth,f=n[0],h=n[1];u&&(f=(r.height+1)*n[0]/Math.min(r.height+1,u),h=(r.height+1)*n[1]/Math.min(r.height+1,u));var p=a.partition().padding(i.pad.inner).size(c?[n[1],f]:[n[0],h])(r);return(c||s||l)&&o(p,n,{swapXY:c,flipX:s,flipY:l}),p}},{"../treemap/flip_tree":1079,"d3-hierarchy":115}],843:[function(r,n,i){"use strict";var a=r("../treemap/draw"),o=r("./draw_descendants");n.exports=function(r,n,i,s){return a(r,n,i,s,{type:"icicle",drawDescendants:o})}},{"../treemap/draw":1076,"./draw_descendants":838}],844:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/color"),s=r("../../lib"),l=r("../bar/uniform_text").resizeText;function c(r,n,i){var a=n.data.data,l=!n.children,c=a.i,u=s.castOption(i,c,"marker.line.color")||o.defaultLine,f=s.castOption(i,c,"marker.line.width")||0;r.style("stroke-width",f).call(o.fill,a.color).call(o.stroke,u).style("opacity",l?i.leaf.opacity:null)}n.exports={style:function(r){var n=r._fullLayout._iciclelayer.selectAll(".trace");l(r,n,"icicle"),n.each(function(r){var n=a.select(this),i=r[0].trace;n.style("opacity",i.opacity),n.selectAll("path.surface").each(function(r){a.select(this).call(c,r,i)})})},styleOne:c}},{"../../components/color":366,"../../lib":503,"../bar/uniform_text":664,"@plotly/d3":58}],845:[function(r,n,i){"use strict";for(var a=r("../../plots/attributes"),o=r("../../plots/template_attributes").hovertemplateAttrs,s=r("../../lib/extend").extendFlat,l=r("./constants").colormodel,c=["rgb","rgba","rgba256","hsl","hsla"],u=[],f=[],h=0;h<c.length;h++){var p=l[c[h]];u.push("For the `"+c[h]+"` colormodel, it is ["+(p.zminDflt||p.min).join(", ")+"]."),f.push("For the `"+c[h]+"` colormodel, it is ["+(p.zmaxDflt||p.max).join(", ")+"].")}n.exports=s({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:c,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:s({},a.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:o({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"./constants":847}],846:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./constants"),s=r("fast-isnumeric"),l=r("../../plots/cartesian/axes"),c=r("../../lib").maxRowLength,u=r("./helpers").getImageSize;n.exports=function(r,n){if(n._hasZ)f=n.z.length,h=c(n.z);else if(n._hasSource){var i=u(n.source);f=i.height,h=i.width}var f,h,p,d=l.getFromId(r,n.xaxis||"x"),m=l.getFromId(r,n.yaxis||"y"),g=d.d2c(n.x0)-n.dx/2,v=m.d2c(n.y0)-n.dy/2,y=[g,g+h*n.dx],x=[v,v+f*n.dy];if(d&&"log"===d.type)for(p=0;p<h;p++)y.push(g+p*n.dx);if(m&&"log"===m.type)for(p=0;p<f;p++)x.push(v+p*n.dy);return n._extremes[d._id]=l.findExtremes(d,y),n._extremes[m._id]=l.findExtremes(m,x),n._scaler=function(r){var n=o.colormodel[r.colormodel],i=(n.colormodel||r.colormodel).length;r._sArray=[];for(var l=0;l<i;l++)n.min[l]!==r.zmin[l]||n.max[l]!==r.zmax[l]?r._sArray.push(function(r,n,i,o){return function(s){return a.constrain((s-r)*n,i,o)}}(r.zmin[l],(n.max[l]-n.min[l])/(r.zmax[l]-r.zmin[l]),n.min[l],n.max[l])):r._sArray.push(function(r,n){return function(i){return a.constrain(i,r,n)}}(n.min[l],n.max[l]));return function(n){for(var a=n.slice(0,i),o=0;o<i;o++){var l=a[o];if(!s(l))return!1;a[o]=r._sArray[o](l)}return a}}(n),[{x0:g,y0:v,z:n.z,w:h,h:f}]}},{"../../lib":503,"../../plots/cartesian/axes":554,"./constants":847,"./helpers":850,"fast-isnumeric":190}],847:[function(r,n,i){"use strict";n.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(r){return r.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(r){return r.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(r){return r.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(r){var n=r.slice(0,3);return n[1]=n[1]+"%",n[2]=n[2]+"%",n},suffix:["\xb0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(r){var n=r.slice(0,4);return n[1]=n[1]+"%",n[2]=n[2]+"%",n},suffix:["\xb0","%","%",""]}},pixelatedStyle:"image-rendering: optimizeSpeed; image-rendering: -moz-crisp-edges; image-rendering: -o-crisp-edges; image-rendering: -webkit-optimize-contrast; image-rendering: optimize-contrast; image-rendering: crisp-edges; image-rendering: pixelated; "}},{}],848:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("./constants"),l=r("../../snapshot/helpers").IMAGE_URL_PREFIX;n.exports=function(r,n){function i(i,s){return a.coerce(r,n,o,i,s)}i("source"),n.source&&!n.source.match(l)&&delete n.source,n._hasSource=!!n.source;var c,u=i("z");(n._hasZ=!(void 0===u||!u.length||!u[0]||!u[0].length),n._hasZ||n._hasSource)?(i("x0"),i("y0"),i("dx"),i("dy"),n._hasZ?(i("colormodel","rgb"),i("zmin",(c=s.colormodel[n.colormodel]).zminDflt||c.min),i("zmax",c.zmaxDflt||c.max)):n._hasSource&&(n.colormodel="rgba256",c=s.colormodel[n.colormodel],n.zmin=c.zminDflt,n.zmax=c.zmaxDflt),i("zsmooth"),i("text"),i("hovertext"),i("hovertemplate"),n._length=null):n.visible=!1}},{"../../lib":503,"../../snapshot/helpers":642,"./attributes":845,"./constants":847}],849:[function(r,n,i){"use strict";n.exports=function(r,n){return"xVal"in n&&(r.x=n.xVal),"yVal"in n&&(r.y=n.yVal),n.xa&&(r.xaxis=n.xa),n.ya&&(r.yaxis=n.ya),r.color=n.color,r.colormodel=n.trace.colormodel,r.z||(r.z=n.color),r}},{}],850:[function(r,n,i){"use strict";var a=r("probe-image-size/sync"),o=r("../../snapshot/helpers").IMAGE_URL_PREFIX,s=r("buffer/").Buffer;i.getImageSize=function(r){return a(new s(r.replace(o,""),"base64"))}},{"../../snapshot/helpers":642,"buffer/":85,"probe-image-size/sync":276}],851:[function(r,n,i){"use strict";var a=r("../../components/fx"),o=r("../../lib"),s=r("./constants");n.exports=function(r,n,i){var l=r.cd[0],c=l.trace,u=r.xa,f=r.ya;if(!(a.inbox(n-l.x0,n-(l.x0+l.w*c.dx),0)>0||a.inbox(i-l.y0,i-(l.y0+l.h*c.dy),0)>0)){var h,p=Math.floor((n-l.x0)/c.dx),d=Math.floor(Math.abs(i-l.y0)/c.dy);if(c._hasZ?h=l.z[d][p]:c._hasSource&&(h=c._canvas.el.getContext("2d").getImageData(p,d,1,1).data),h){var m,g=l.hi||c.hoverinfo;if(g){var v=g.split("+");-1!==v.indexOf("all")&&(v=["color"]),-1!==v.indexOf("color")&&(m=!0)}var y,x=s.colormodel[c.colormodel],b=x.colormodel||c.colormodel,_=b.length,w=c._scaler(h),T=x.suffix,k=[];(c.hovertemplate||m)&&(k.push("["+[w[0]+T[0],w[1]+T[1],w[2]+T[2]].join(", ")),4===_&&k.push(", "+w[3]+T[3]),k.push("]"),k=k.join(""),r.extraText=b.toUpperCase()+": "+k),Array.isArray(c.hovertext)&&Array.isArray(c.hovertext[d])?y=c.hovertext[d][p]:Array.isArray(c.text)&&Array.isArray(c.text[d])&&(y=c.text[d][p]);var A=f.c2p(l.y0+(d+.5)*c.dy),M=l.x0+(p+.5)*c.dx,S=l.y0+(d+.5)*c.dy,E="["+h.slice(0,c.colormodel.length).join(", ")+"]";return[o.extendFlat(r,{index:[d,p],x0:u.c2p(l.x0+p*c.dx),x1:u.c2p(l.x0+(p+1)*c.dx),y0:A,y1:A,color:w,xVal:M,xLabelVal:M,yVal:S,yLabelVal:S,zLabelVal:E,text:y,hovertemplateLabels:{zLabel:E,colorLabel:k,"color[0]Label":w[0]+T[0],"color[1]Label":w[1]+T[1],"color[2]Label":w[2]+T[2],"color[3]Label":w[3]+T[3]}})]}}}},{"../../components/fx":406,"../../lib":503,"./constants":847}],852:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),style:r("./style"),hoverPoints:r("./hover"),eventData:r("./event_data"),moduleType:"trace",name:"image",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":568,"./attributes":845,"./calc":846,"./defaults":848,"./event_data":849,"./hover":851,"./plot":853,"./style":854}],853:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=o.strTranslate,l=r("../../constants/xmlns_namespaces"),c=r("./constants"),u=o.isIOS()||o.isSafari()||o.isIE();n.exports=function(r,n,i,f){var h=n.xaxis,p=n.yaxis,d=!(u||r._context._exportedPlot);o.makeTraceGroups(f,i,"im").each(function(n){var i=a.select(this),u=n[0],f=u.trace,m=("fast"===f.zsmooth||!1===f.zsmooth&&d)&&!f._hasZ&&f._hasSource&&"linear"===h.type&&"linear"===p.type;f._realImage=m;var g,v,y,x,b,_,w=u.z,T=u.x0,k=u.y0,A=u.w,M=u.h,S=f.dx,E=f.dy;for(_=0;void 0===g&&_<A;)g=h.c2p(T+_*S),_++;for(_=A;void 0===v&&_>0;)v=h.c2p(T+_*S),_--;for(_=0;void 0===x&&_<M;)x=p.c2p(k+_*E),_++;for(_=M;void 0===b&&_>0;)b=p.c2p(k+_*E),_--;v<g&&(y=v,v=g,g=y),b<x&&(y=x,x=b,b=y),m||(g=Math.max(-.5*h._length,g),v=Math.min(1.5*h._length,v),x=Math.max(-.5*p._length,x),b=Math.min(1.5*p._length,b));var L=Math.round(v-g),C=Math.round(b-x);if(L<=0||C<=0)i.selectAll("image").data([]).exit().remove();else{var P=i.selectAll("image").data([n]);P.enter().append("svg:image").attr({xmlns:l.svg,preserveAspectRatio:"none"}),P.exit().remove();var I=!1===f.zsmooth?c.pixelatedStyle:"";if(m){var O=o.simpleMap(h.range,h.r2l),z=o.simpleMap(p.range,p.r2l),D=O[1]<O[0],R=z[1]>z[0];if(D||R){var F=g+L/2,B=x+C/2;I+="transform:"+s(F+"px",B+"px")+"scale("+(D?-1:1)+","+(R?-1:1)+")"+s(-F+"px",-B+"px")+";"}}P.attr("style",I);var N=new Promise(function(r){if(f._hasZ)r();else if(f._hasSource){if(f._canvas&&f._canvas.el.width===A&&f._canvas.el.height===M&&f._canvas.source===f.source)r();else{var n=document.createElement("canvas");n.width=A,n.height=M;var i=n.getContext("2d");f._image=f._image||new Image;var a=f._image;a.onload=function(){i.drawImage(a,0,0),f._canvas={el:n,source:f.source},r()},a.setAttribute("src",f.source)}}}).then(function(){var r;if(f._hasZ)r=j(function(r,n){return w[n][r]}).toDataURL("image/png");else if(f._hasSource){if(m)r=f.source;else{var n=f._canvas.el.getContext("2d").getImageData(0,0,A,M).data;r=j(function(r,i){var a=4*(i*A+r);return[n[a],n[a+1],n[a+2],n[a+3]]}).toDataURL("image/png")}}P.attr({"xlink:href":r,height:C,width:L,x:g,y:x})});r._promises.push(N)}function j(r){var n=document.createElement("canvas");n.width=L,n.height=C;var i,a=n.getContext("2d"),s=function(r){return o.constrain(Math.round(h.c2p(T+r*S)-g),0,L)},l=function(r){return o.constrain(Math.round(p.c2p(k+r*E)-x),0,C)},d=c.colormodel[f.colormodel],m=d.colormodel||f.colormodel,v=d.fmt;for(_=0;_<u.w;_++){var y=s(_),b=s(_+1);if(b!==y&&!isNaN(b)&&!isNaN(y))for(var w=0;w<u.h;w++){var A=l(w),M=l(w+1);M===A||isNaN(M)||isNaN(A)||!r(_,w)||(i=f._scaler(r(_,w)),a.fillStyle=i?m+"("+v(i).join(",")+")":"rgba(0,0,0,0)",a.fillRect(y,A,b-y,M-A))}}return n}})}},{"../../constants/xmlns_namespaces":480,"../../lib":503,"./constants":847,"@plotly/d3":58}],854:[function(r,n,i){"use strict";var a=r("@plotly/d3");n.exports=function(r){a.select(r).selectAll(".im image").style("opacity",function(r){return r[0].trace.opacity})}},{"@plotly/d3":58}],855:[function(r,n,i){"use strict";var a=r("../../lib/extend").extendFlat,o=r("../../lib/extend").extendDeep,s=r("../../plot_api/edit_types").overrideAll,l=r("../../plots/font_attributes"),c=r("../../components/color/attributes"),u=r("../../plots/domain").attributes,f=r("../../plots/cartesian/layout_attributes"),h=r("../../plot_api/plot_template").templatedArray,p=r("../../constants/delta.js"),d=r("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,m=l({editType:"plot",colorEditType:"plot"}),g={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:c.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},v={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},y=h("step",o({},g,{range:v}));n.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:u({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:a({},m,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:d("value")},font:a({},m,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:d("value")},increasing:{symbol:{valType:"string",dflt:p.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:p.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:p.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:p.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:a({},m,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:o({},g,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:c.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:s({range:v,visible:a({},f.visible,{dflt:!0}),tickmode:f.tickmode,nticks:f.nticks,tick0:f.tick0,dtick:f.dtick,tickvals:f.tickvals,ticktext:f.ticktext,ticks:a({},f.ticks,{dflt:"outside"}),ticklen:f.ticklen,tickwidth:f.tickwidth,tickcolor:f.tickcolor,showticklabels:f.showticklabels,tickfont:l({}),tickangle:f.tickangle,tickformat:f.tickformat,tickformatstops:f.tickformatstops,tickprefix:f.tickprefix,showtickprefix:f.showtickprefix,ticksuffix:f.ticksuffix,showticksuffix:f.showticksuffix,separatethousands:f.separatethousands,exponentformat:f.exponentformat,minexponent:f.minexponent,showexponent:f.showexponent,editType:"plot"},"plot"),steps:y,threshold:{line:{color:a({},g.line.color,{}),width:a({},g.line.width,{dflt:1}),editType:"plot"},thickness:a({},g.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":365,"../../constants/delta.js":473,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_format_attributes":557,"../../plots/cartesian/layout_attributes":569,"../../plots/domain":584,"../../plots/font_attributes":585}],856:[function(r,n,i){"use strict";var a=r("../../plots/plots");i.name="indicator",i.plot=function(r,n,o,s){a.plotBasePlot(i.name,r,n,o,s)},i.clean=function(r,n,o,s){a.cleanBasePlot(i.name,r,n,o,s)}},{"../../plots/plots":619}],857:[function(r,n,i){"use strict";n.exports={calc:function(r,n){var i=[],a=n.value;"number"!=typeof n._lastValue&&(n._lastValue=n.value);var o=n._lastValue,s=o;return n._hasDelta&&"number"==typeof n.delta.reference&&(s=n.delta.reference),i[0]={y:a,lastY:o,delta:a-s,relativeDelta:(a-s)/s},i}}},{}],858:[function(r,n,i){"use strict";n.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],859:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("../../plots/domain").defaults,l=r("../../plot_api/plot_template"),c=r("../../plots/array_container_defaults"),u=r("./constants.js"),f=r("../../plots/cartesian/tick_value_defaults"),h=r("../../plots/cartesian/tick_mark_defaults"),p=r("../../plots/cartesian/tick_label_defaults"),d=r("../../plots/cartesian/prefix_suffix_defaults");function m(r,n){function i(i,s){return a.coerce(r,n,o.gauge.steps,i,s)}i("color"),i("line.color"),i("line.width"),i("range"),i("thickness")}n.exports={supplyDefaults:function(r,n,i,g){function v(i,s){return a.coerce(r,n,o,i,s)}s(n,g,v),v("mode"),n._hasNumber=-1!==n.mode.indexOf("number"),n._hasDelta=-1!==n.mode.indexOf("delta"),n._hasGauge=-1!==n.mode.indexOf("gauge");var y=v("value");n._range=[0,"number"==typeof y?1.5*y:1];var x,b,_,w,T,k,A=[,,];function M(r,n){return a.coerce(_,w,o.gauge,r,n)}function S(r,n){return a.coerce(T,k,o.gauge.axis,r,n)}if(n._hasNumber&&(v("number.valueformat"),v("number.font.color",g.font.color),v("number.font.family",g.font.family),v("number.font.size"),void 0===n.number.font.size&&(n.number.font.size=u.defaultNumberFontSize,A[0]=!0),v("number.prefix"),v("number.suffix"),x=n.number.font.size),n._hasDelta&&(v("delta.font.color",g.font.color),v("delta.font.family",g.font.family),v("delta.font.size"),void 0===n.delta.font.size&&(n.delta.font.size=(n._hasNumber?.5:1)*(x||u.defaultNumberFontSize),A[1]=!0),v("delta.reference",n.value),v("delta.relative"),v("delta.valueformat",n.delta.relative?"2%":""),v("delta.increasing.symbol"),v("delta.increasing.color"),v("delta.decreasing.symbol"),v("delta.decreasing.color"),v("delta.position"),b=n.delta.font.size),n._scaleNumbers=(!n._hasNumber||A[0])&&(!n._hasDelta||A[1])||!1,v("title.font.color",g.font.color),v("title.font.family",g.font.family),v("title.font.size",.25*(x||b||u.defaultNumberFontSize)),v("title.text"),n._hasGauge){(_=r.gauge)||(_={}),w=l.newContainer(n,"gauge"),M("shape"),(n._isBullet="bullet"===n.gauge.shape)||v("title.align","center"),(n._isAngular="angular"===n.gauge.shape)||v("align","center"),M("bgcolor",g.paper_bgcolor),M("borderwidth"),M("bordercolor"),M("bar.color"),M("bar.line.color"),M("bar.line.width"),M("bar.thickness",u.valueThickness*("bullet"===n.gauge.shape?.5:1)),c(_,w,{name:"steps",handleItemDefaults:m}),M("threshold.value"),M("threshold.thickness"),M("threshold.line.width"),M("threshold.line.color"),T={},_&&(T=_.axis||{}),k=l.newContainer(w,"axis"),S("visible"),n._range=S("range",n._range);var E={outerTicks:!0};f(T,k,S,"linear"),d(T,k,S,"linear",E),p(T,k,S,"linear",E),h(T,k,S,E)}else v("title.align","center"),v("align","center"),n._isAngular=n._isBullet=!1;n._length=null}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/array_container_defaults":549,"../../plots/cartesian/prefix_suffix_defaults":573,"../../plots/cartesian/tick_label_defaults":578,"../../plots/cartesian/tick_mark_defaults":579,"../../plots/cartesian/tick_value_defaults":580,"../../plots/domain":584,"./attributes":855,"./constants.js":858}],860:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"indicator",basePlotModule:r("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,calc:r("./calc").calc,plot:r("./plot"),meta:{}}},{"./attributes":855,"./base_plot":856,"./calc":857,"./defaults":859,"./plot":861}],861:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("d3-interpolate").interpolate,s=r("d3-interpolate").interpolateNumber,l=r("../../lib"),c=l.strScale,u=l.strTranslate,f=l.rad2deg,h=r("../../constants/alignment").MID_SHIFT,p=r("../../components/drawing"),d=r("./constants"),m=r("../../lib/svg_text_utils"),g=r("../../plots/cartesian/axes"),v=r("../../plots/cartesian/axis_defaults"),y=r("../../plots/cartesian/position_defaults"),x=r("../../plots/cartesian/layout_attributes"),b=r("../../components/color"),_={left:"start",center:"middle",right:"end"},w={left:0,center:.5,right:1},T=/[yzafpn\xb5mkMGTPEZY]/;function k(r){return r&&r.duration>0}function A(r){r.each(function(r){b.stroke(a.select(this),r.line.color)}).each(function(r){b.fill(a.select(this),r.color)}).style("stroke-width",function(r){return r.line.width})}function M(r,n,i){var a=r._fullLayout,o=l.extendFlat({type:"linear",ticks:"outside",range:i,showline:!0},n),s={type:"linear",_id:"x"+n._id},c={letter:"x",font:a.font,noHover:!0,noTickson:!0};function u(r,n){return l.coerce(o,s,x,r,n)}return v(o,s,u,c,a),y(o,s,u,c),s}function S(r,n,i){return[Math.min(n/r.width,i/r.height),r,n+"x"+i]}function E(r,n,i,o){var s=document.createElementNS("http://www.w3.org/2000/svg","text"),l=a.select(s);return l.text(r).attr("x",0).attr("y",0).attr("text-anchor",i).attr("data-unformatted",r).call(m.convertToTspans,o).call(p.font,n),p.bBox(l.node())}function L(r,n,i,a,o,s){var c="_cache"+n;r[c]&&r[c].key===o||(r[c]={key:o,value:i});var u=l.aggNums(s,null,[r[c].value,a],2);return r[c].value=u,u}n.exports=function(r,n,i,v){var y,x=r._fullLayout;k(i)&&v&&(y=v()),l.makeTraceGroups(x._indicatorlayer,n,"trace").each(function(n){var v,C,P,I,O,z=n[0].trace,D=a.select(this),R=z._hasGauge,F=z._isAngular,B=z._isBullet,N=z.domain,j={w:x._size.w*(N.x[1]-N.x[0]),h:x._size.h*(N.y[1]-N.y[0]),l:x._size.l+x._size.w*N.x[0],r:x._size.r+x._size.w*(1-N.x[1]),t:x._size.t+x._size.h*(1-N.y[1]),b:x._size.b+x._size.h*N.y[0]},U=j.l+j.w/2,V=j.t+j.h/2,H=Math.min(j.w/2,j.h),q=d.innerRadius*H,G=z.align||"center";if(C=V,R){if(F&&(v=U,C=V+H/2,P=function(r){var n;return[(n=.9*q)/Math.sqrt(r.width/2*(r.width/2)+r.height*r.height),r,n]}),B){var Y=d.bulletPadding,W=1-d.bulletNumberDomainSize+Y;v=j.l+(W+(1-W)*w[G])*j.w,P=function(r){return S(r,(d.bulletNumberDomainSize-Y)*j.w,j.h)}}}else v=j.l+w[G]*j.w,P=function(r){return S(r,j.w,j.h)};(function(r,n,i,o){var f,h,d,v=i[0].trace,y=o.numbersX,x=o.numbersY,A=v.align||"center",S=_[A],C=o.transitionOpts,P=o.onComplete,I=l.ensureSingle(n,"g","numbers"),O=[];v._hasNumber&&O.push("number"),v._hasDelta&&(O.push("delta"),"left"===v.delta.position&&O.reverse());var z=I.selectAll("text").data(O);function D(n,i,a,o){if(!n.match("s")||a>=0==o>=0||i(a).slice(-1).match(T)||i(o).slice(-1).match(T))return i;var s=M(r,{tickformat:n.slice().replace("s","f").replace(/\d+/,function(r){return parseInt(r)-1})});return function(r){return 1>Math.abs(r)?g.tickText(s,r).text:i(r)}}z.enter().append("text"),z.attr("text-anchor",function(){return S}).attr("class",function(r){return r}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),z.exit().remove();var R,F=v.mode+v.align;if(v._hasDelta&&(R=function(){var n=M(r,{tickformat:v.delta.valueformat},v._range);n.setScale(),g.prepTicks(n);var o=function(r){return g.tickText(n,r).text},l=function(r){return v.delta.relative?r.relativeDelta:r.delta},c=function(r,n){return 0===r||"number"!=typeof r||isNaN(r)?"-":(r>0?v.delta.increasing.symbol:v.delta.decreasing.symbol)+n(r)},u=function(r){return r.delta>=0?v.delta.increasing.color:v.delta.decreasing.color};void 0===v._deltaLastValue&&(v._deltaLastValue=l(i[0]));var f=I.select("text.delta");function d(){f.text(c(l(i[0]),o)).call(b.fill,u(i[0])).call(m.convertToTspans,r)}return f.call(p.font,v.delta.font).call(b.fill,u({delta:v._deltaLastValue})),k(C)?f.transition().duration(C.duration).ease(C.easing).tween("text",function(){var r=a.select(this),n=l(i[0]),f=v._deltaLastValue,h=D(v.delta.valueformat,o,f,n),p=s(f,n);return v._deltaLastValue=n,function(n){r.text(c(p(n),h)),r.call(b.fill,u({delta:p(n)}))}}).each("end",function(){d(),P&&P()}).each("interrupt",function(){d(),P&&P()}):d(),h=E(c(l(i[0]),o),v.delta.font,S,r),f}(),F+=v.delta.position+v.delta.font.size+v.delta.font.family+v.delta.valueformat+(v.delta.increasing.symbol+v.delta.decreasing.symbol),d=h),v._hasNumber&&(function(){var n=M(r,{tickformat:v.number.valueformat},v._range);n.setScale(),g.prepTicks(n);var o=function(r){return g.tickText(n,r).text},l=v.number.suffix,c=v.number.prefix,u=I.select("text.number");function h(){var n="number"==typeof i[0].y?c+o(i[0].y)+l:"-";u.text(n).call(p.font,v.number.font).call(m.convertToTspans,r)}k(C)?u.transition().duration(C.duration).ease(C.easing).each("end",function(){h(),P&&P()}).each("interrupt",function(){h(),P&&P()}).attrTween("text",function(){var r=a.select(this),n=s(i[0].lastY,i[0].y);v._lastValue=i[0].y;var u=D(v.number.valueformat,o,i[0].lastY,i[0].y);return function(i){r.text(c+u(n(i))+l)}}):h(),f=E(c+o(i[0].y)+l,v.number.font,S,r)}(),F+=v.number.font.size+v.number.font.family+v.number.valueformat+v.number.suffix+v.number.prefix,d=f),v._hasDelta&&v._hasNumber){var B,N,j=[(f.left+f.right)/2,(f.top+f.bottom)/2],U=[(h.left+h.right)/2,(h.top+h.bottom)/2],V=.75*v.delta.font.size;"left"===v.delta.position&&(B=L(v,"deltaPos",0,-1*(f.width*w[v.align]+h.width*(1-w[v.align])+V),F,Math.min),N=j[1]-U[1],d={width:f.width+h.width+V,height:Math.max(f.height,h.height),left:h.left+B,right:f.right,top:Math.min(f.top,h.top+N),bottom:Math.max(f.bottom,h.bottom+N)}),"right"===v.delta.position&&(B=L(v,"deltaPos",0,f.width*(1-w[v.align])+h.width*w[v.align]+V,F,Math.max),N=j[1]-U[1],d={width:f.width+h.width+V,height:Math.max(f.height,h.height),left:f.left,right:h.right+B,top:Math.min(f.top,h.top+N),bottom:Math.max(f.bottom,h.bottom+N)}),"bottom"===v.delta.position&&(B=null,N=h.height,d={width:Math.max(f.width,h.width),height:f.height+h.height,left:Math.min(f.left,h.left),right:Math.max(f.right,h.right),top:f.bottom-f.height,bottom:f.bottom+h.height}),"top"===v.delta.position&&(B=null,N=f.top,d={width:Math.max(f.width,h.width),height:f.height+h.height,left:Math.min(f.left,h.left),right:Math.max(f.right,h.right),top:f.bottom-f.height-h.height,bottom:f.bottom}),R.attr({dx:B,dy:N})}(v._hasNumber||v._hasDelta)&&I.attr("transform",function(){var r=o.numbersScaler(d);F+=r[2];var n,i=L(v,"numbersScale",1,r[0],F,Math.min);v._scaleNumbers||(i=1),n=v._isAngular?x-i*d.bottom:x-i*(d.top+d.bottom)/2,v._numbersTop=i*d.top+n;var a=d[A];"center"===A&&(a=(d.left+d.right)/2);var s=y-i*a;return u(s=L(v,"numbersTranslate",0,s,F,Math.max),n)+c(i)})})(r,D,n,{numbersX:v,numbersY:C,numbersScaler:P,transitionOpts:i,onComplete:y}),R&&(I={range:z.gauge.axis.range,color:z.gauge.bgcolor,line:{color:z.gauge.bordercolor,width:0},thickness:1},O={range:z.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:z.gauge.bordercolor,width:z.gauge.borderwidth},thickness:1});var X=D.selectAll("g.angular").data(F?n:[]);X.exit().remove();var Z=D.selectAll("g.angularaxis").data(F?n:[]);Z.exit().remove(),F&&function(r,n,i,s){var l,c,p,d,m,v=i[0].trace,y=s.size,x=s.radius,b=s.innerRadius,_=s.gaugeBg,w=s.gaugeOutline,T=[y.l+y.w/2,y.t+y.h/2+x/2],S=s.gauge,E=s.layer,L=s.transitionOpts,C=s.onComplete,P=Math.PI/2;function I(r){var n=v.gauge.axis.range[0],i=(r-n)/(v.gauge.axis.range[1]-n)*Math.PI-P;return i<-P?-P:i>P?P:i}function O(r){return a.svg.arc().innerRadius((b+x)/2-r/2*(x-b)).outerRadius((b+x)/2+r/2*(x-b)).startAngle(-P)}function z(r){r.attr("d",function(r){return O(r.thickness).startAngle(I(r.range[0])).endAngle(I(r.range[1]))()})}S.enter().append("g").classed("angular",!0),S.attr("transform",u(T[0],T[1])),E.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),E.selectAll("g.xangularaxistick,path,text").remove(),(p=M(r,v.gauge.axis)).type="linear",p.range=v.gauge.axis.range,p._id="xangularaxis",p.ticklabeloverflow="allow",p.setScale();var D=function(r){return(p.range[0]-r.x)/(p.range[1]-p.range[0])*Math.PI+Math.PI},R={},F=g.makeLabelFns(p,0).labelStandoff;R.xFn=function(r){return Math.cos(D(r))*F},R.yFn=function(r){var n=D(r),i=Math.sin(n)>0?.2:1;return-Math.sin(n)*(F+r.fontSize*i)+r.fontSize*h*Math.abs(Math.cos(n))},R.anchorFn=function(r){var n=Math.cos(D(r));return .1>Math.abs(n)?"middle":n>0?"start":"end"},R.heightFn=function(r,n,i){return -.5*(1+Math.sin(D(r)))*i};var B=function(r){return u(T[0]+x*Math.cos(r),T[1]-x*Math.sin(r))};if(d=g.calcTicks(p),m=g.getTickSigns(p)[2],p.visible){m="inside"===p.ticks?-1:1;var N=(p.linewidth||1)/2;g.drawTicks(r,p,{vals:d,layer:E,path:"M"+m*N+",0h"+m*p.ticklen,transFn:function(r){var n=D(r);return B(n)+"rotate("+-f(n)+")"}}),g.drawLabels(r,p,{vals:d,layer:E,transFn:function(r){return B(D(r))},labelFns:R})}var j=[_].concat(v.gauge.steps),U=S.selectAll("g.bg-arc").data(j);U.enter().append("g").classed("bg-arc",!0).append("path"),U.select("path").call(z).call(A),U.exit().remove();var V=O(v.gauge.bar.thickness),H=S.selectAll("g.value-arc").data([v.gauge.bar]);H.enter().append("g").classed("value-arc",!0).append("path");var q=H.select("path");k(L)?(q.transition().duration(L.duration).ease(L.easing).each("end",function(){C&&C()}).each("interrupt",function(){C&&C()}).attrTween("d",(l=I(i[0].lastY),c=I(i[0].y),function(){var r=o(l,c);return function(n){return V.endAngle(r(n))()}})),v._lastValue=i[0].y):q.attr("d","number"==typeof i[0].y?V.endAngle(I(i[0].y)):"M0,0Z"),q.call(A),H.exit().remove(),j=[];var G=v.gauge.threshold.value;(G||0===G)&&j.push({range:[G,G],color:v.gauge.threshold.color,line:{color:v.gauge.threshold.line.color,width:v.gauge.threshold.line.width},thickness:v.gauge.threshold.thickness});var Y=S.selectAll("g.threshold-arc").data(j);Y.enter().append("g").classed("threshold-arc",!0).append("path"),Y.select("path").call(z).call(A),Y.exit().remove();var W=S.selectAll("g.gauge-outline").data([w]);W.enter().append("g").classed("gauge-outline",!0).append("path"),W.select("path").call(z).call(A),W.exit().remove()}(r,0,n,{radius:H,innerRadius:q,gauge:X,layer:Z,size:j,gaugeBg:I,gaugeOutline:O,transitionOpts:i,onComplete:y});var J=D.selectAll("g.bullet").data(B?n:[]);J.exit().remove();var K=D.selectAll("g.bulletaxis").data(B?n:[]);K.exit().remove(),B&&function(r,n,i,a){var o,s,l,c,f,h=i[0].trace,p=a.gauge,m=a.layer,v=a.gaugeBg,y=a.gaugeOutline,x=a.size,_=h.domain,w=a.transitionOpts,T=a.onComplete;p.enter().append("g").classed("bullet",!0),p.attr("transform",u(x.l,x.t)),m.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),m.selectAll("g.xbulletaxistick,path,text").remove();var S=x.h,E=h.gauge.bar.thickness*S,L=_.x[0],C=_.x[0]+(_.x[1]-_.x[0])*(h._hasNumber||h._hasDelta?1-d.bulletNumberDomainSize:1);function P(r){r.attr("width",function(r){return Math.max(0,o.c2p(r.range[1])-o.c2p(r.range[0]))}).attr("x",function(r){return o.c2p(r.range[0])}).attr("y",function(r){return .5*(1-r.thickness)*S}).attr("height",function(r){return r.thickness*S})}(o=M(r,h.gauge.axis))._id="xbulletaxis",o.domain=[L,C],o.setScale(),s=g.calcTicks(o),l=g.makeTransTickFn(o),c=g.getTickSigns(o)[2],f=x.t+x.h,o.visible&&(g.drawTicks(r,o,{vals:"inside"===o.ticks?g.clipEnds(o,s):s,layer:m,path:g.makeTickPath(o,f,c),transFn:l}),g.drawLabels(r,o,{vals:s,layer:m,transFn:l,labelFns:g.makeLabelFns(o,f)}));var I=[v].concat(h.gauge.steps),O=p.selectAll("g.bg-bullet").data(I);O.enter().append("g").classed("bg-bullet",!0).append("rect"),O.select("rect").call(P).call(A),O.exit().remove();var z=p.selectAll("g.value-bullet").data([h.gauge.bar]);z.enter().append("g").classed("value-bullet",!0).append("rect"),z.select("rect").attr("height",E).attr("y",(S-E)/2).call(A),k(w)?z.select("rect").transition().duration(w.duration).ease(w.easing).each("end",function(){T&&T()}).each("interrupt",function(){T&&T()}).attr("width",Math.max(0,o.c2p(Math.min(h.gauge.axis.range[1],i[0].y)))):z.select("rect").attr("width","number"==typeof i[0].y?Math.max(0,o.c2p(Math.min(h.gauge.axis.range[1],i[0].y))):0),z.exit().remove();var D=i.filter(function(){return h.gauge.threshold.value||0===h.gauge.threshold.value}),R=p.selectAll("g.threshold-bullet").data(D);R.enter().append("g").classed("threshold-bullet",!0).append("line"),R.select("line").attr("x1",o.c2p(h.gauge.threshold.value)).attr("x2",o.c2p(h.gauge.threshold.value)).attr("y1",(1-h.gauge.threshold.thickness)/2*S).attr("y2",(1-(1-h.gauge.threshold.thickness)/2)*S).call(b.stroke,h.gauge.threshold.line.color).style("stroke-width",h.gauge.threshold.line.width),R.exit().remove();var F=p.selectAll("g.gauge-outline").data([y]);F.enter().append("g").classed("gauge-outline",!0).append("rect"),F.select("rect").call(P).call(A),F.exit().remove()}(r,0,n,{gauge:J,layer:K,size:j,gaugeBg:I,gaugeOutline:O,transitionOpts:i,onComplete:y});var Q=D.selectAll("text.title").data(n);Q.exit().remove(),Q.enter().append("text").classed("title",!0),Q.attr("text-anchor",function(){return B?_.right:_[z.title.align]}).text(z.title.text).call(p.font,z.title.font).call(m.convertToTspans,r),Q.attr("transform",function(){var r,n=j.l+j.w*w[z.title.align],i=d.titlePadding,a=p.bBox(Q.node());return R?(F&&(r=z.gauge.axis.visible?p.bBox(Z.node()).top-i-a.bottom:j.t+j.h/2-H/2-a.bottom-i),B&&(r=C-(a.top+a.bottom)/2,n=j.l-d.bulletPadding*j.w)):r=z._numbersTop-i-a.bottom,u(n,r)})})}},{"../../components/color":366,"../../components/drawing":388,"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_defaults":556,"../../plots/cartesian/layout_attributes":569,"../../plots/cartesian/position_defaults":572,"./constants":858,"@plotly/d3":58,"d3-interpolate":116}],862:[function(r,n,i){"use strict";var a=r("../../components/colorscale/attributes"),o=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,s=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../mesh3d/attributes"),c=r("../../plots/attributes"),u=r("../../lib/extend").extendFlat,f=r("../../plot_api/edit_types").overrideAll,h=n.exports=f(u({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:s(),xhoverformat:o("x"),yhoverformat:o("y"),zhoverformat:o("z"),valuehoverformat:o("value",1),showlegend:u({},c.showlegend,{dflt:!1})},a("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:l.opacity,lightposition:l.lightposition,lighting:l.lighting,flatshading:l.flatshading,contour:l.contour,hoverinfo:u({},c.hoverinfo)}),"calc","nested");h.flatshading.dflt=!0,h.lighting.facenormalsepsilon.dflt=0,h.x.editType=h.y.editType=h.z.editType=h.value.editType="calc+clearAxisTypes",h.transforms=void 0},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../mesh3d/attributes":867}],863:[function(r,n,i){"use strict";var a=r("../../components/colorscale/calc"),o=r("../streamtube/calc").processGrid,s=r("../streamtube/calc").filter;n.exports=function(r,n){n._len=Math.min(n.x.length,n.y.length,n.z.length,n.value.length),n._x=s(n.x,n._len),n._y=s(n.y,n._len),n._z=s(n.z,n._len),n._value=s(n.value,n._len);var i=o(n);n._gridFill=i.fill,n._Xs=i.Xs,n._Ys=i.Ys,n._Zs=i.Zs,n._len=i.len;for(var l=1/0,c=-1/0,u=0;u<n._len;u++){var f=n._value[u];l=Math.min(l,f),c=Math.max(c,f)}n._minValues=l,n._maxValues=c,n._vMin=void 0===n.isomin||null===n.isomin?l:n.isomin,n._vMax=void 0===n.isomax||null===n.isomin?c:n.isomax,a(r,n,{vals:[n._vMin,n._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374,"../streamtube/calc":1041}],864:[function(r,n,i){"use strict";var a=r("../../../stackgl_modules").gl_mesh3d,o=r("../../lib/gl_format_color").parseColorScale,s=r("../../lib/str2rgbarray"),l=r("../../components/colorscale").extractOpts,c=r("../../plots/gl3d/zip3"),u=function(r,n){for(var i=n.length-1;i>0;i--){var a=Math.min(n[i],n[i-1]),o=Math.max(n[i],n[i-1]);if(o>a&&a<r&&r<=o)return{id:i,distRatio:(o-r)/(o-a)}}return{id:0,distRatio:0}};function f(r,n,i){this.scene=r,this.uid=i,this.mesh=n,this.name="",this.data=null,this.showContour=!1}var h=f.prototype;h.handlePick=function(r){if(r.object===this.mesh){var n=r.data.index,i=this.data._meshX[n],a=this.data._meshY[n],o=this.data._meshZ[n],s=this.data._Ys.length,l=this.data._Zs.length,c=u(i,this.data._Xs).id,f=u(a,this.data._Ys).id,h=u(o,this.data._Zs).id,p=r.index=h+l*f+l*s*c;r.traceCoordinate=[this.data._meshX[p],this.data._meshY[p],this.data._meshZ[p],this.data._value[p]];var d=this.data.hovertext||this.data.text;return Array.isArray(d)&&void 0!==d[p]?r.textLabel=d[p]:d&&(r.textLabel=d),!0}},h.update=function(r){var n=this.scene,i=n.fullSceneLayout;function a(r,n,i,a){return n.map(function(n){return r.d2l(n,0,a)*i})}this.data=d(r);var u={positions:c(a(i.xaxis,r._meshX,n.dataScale[0],r.xcalendar),a(i.yaxis,r._meshY,n.dataScale[1],r.ycalendar),a(i.zaxis,r._meshZ,n.dataScale[2],r.zcalendar)),cells:c(r._meshI,r._meshJ,r._meshK),lightPosition:[r.lightposition.x,r.lightposition.y,r.lightposition.z],ambient:r.lighting.ambient,diffuse:r.lighting.diffuse,specular:r.lighting.specular,roughness:r.lighting.roughness,fresnel:r.lighting.fresnel,vertexNormalsEpsilon:r.lighting.vertexnormalsepsilon,faceNormalsEpsilon:r.lighting.facenormalsepsilon,opacity:r.opacity,contourEnable:r.contour.show,contourColor:s(r.contour.color).slice(0,3),contourWidth:r.contour.width,useFacetNormals:r.flatshading},f=l(r);u.vertexIntensity=r._meshIntensity,u.vertexIntensityBounds=[f.min,f.max],u.colormap=o(r),this.mesh.update(u)},h.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var p=["xyz","xzy","yxz","yzx","zxy","zyx"];function d(r){r._meshI=[],r._meshJ=[],r._meshK=[];var n,i,a,o,s,l,c,f=r.surface.show,h=r.spaceframe.show,d=r.surface.fill,m=r.spaceframe.fill,g=!1,v=!1,y=0,x=r._Xs,b=r._Ys,_=r._Zs,w=x.length,T=b.length,k=_.length,A=p.indexOf(r._gridFill.replace(/-/g,"").replace(/\+/g,"")),M=function(r,n,i){switch(A){case 5:return i+k*n+k*T*r;case 4:return i+k*r+k*w*n;case 3:return n+T*i+T*k*r;case 2:return n+T*r+T*w*i;case 1:return r+w*i+w*k*n;default:return r+w*n+w*T*i}},S=r._minValues,E=r._maxValues,L=r._vMin,C=r._vMax;function P(){a=[],o=[],s=[],l=[],i=n=0}function I(r,i,c,u){return a.push(r),o.push(i),s.push(c),l.push(u),++n-1}function O(r,n,i){for(var a=[],o=0;o<r.length;o++)a[o]=r[o]*(1-i)+i*n[o];return a}function z(r,n){return"all"===r||null===r||r.indexOf(n)>-1}function D(u,f,h){i=n;var p,d,m,g=[f],v=[h];if(c>=1)g=[f],v=[h];else if(c>0){var x,b,_,w,T,k,A,M,S,E,L,C,P,z=(x=f,b=h,M=O(k=function(r,n,i){for(var a=[],o=0;o<r.length;o++)a[o]=(r[o]+n[o]+i[o])/3;return a}(_=x[0],w=x[1],T=x[2]),_,A=Math.sqrt(1-c)),S=O(k,w,A),E=O(k,T,A),{xyzv:[[_,w,S],[S,M,_],[w,T,E],[E,S,w],[T,_,M],[M,E,T]],abc:[[L=b[0],C=b[1],-1],[-1,-1,L],[C,P=b[2],-1],[-1,-1,C],[P,L,-1],[-1,-1,P]]});g=z.xyzv,v=z.abc}for(var D=0;D<g.length;D++){f=g[D],h=v[D];for(var R=[],F=0;F<3;F++){var B=f[F][0],N=f[F][1],j=f[F][2],U=f[F][3],V=h[F]>-1?h[F]:function(r,n,c){for(var u=l.length,f=i;f<u;f++)if(r===a[f]&&n===o[f]&&c===s[f])return f;return -1}(B,N,j);R[F]=V>-1?V:I(B,N,j,null===u?U:u)}p=R[0],d=R[1],m=R[2],r._meshI.push(p),r._meshJ.push(d),r._meshK.push(m),++y}}function R(r,n,i,a){var o=r[3];o<i&&(o=i),o>a&&(o=a);for(var s=(r[3]-o)/(r[3]-n[3]+1e-9),l=[],c=0;c<4;c++)l[c]=(1-s)*r[c]+s*n[c];return l}function F(r){var n=.001*(C-L);return r>=L-n&&r<=C+n}function B(n){for(var i=[],a=0;a<4;a++){var o=n[a];i.push([r._x[o],r._y[o],r._z[o],r._value[o]])}return i}function N(r,n,i,a,o,s){s||(s=1),i=[-1,-1,-1];var l,c,u,f=!1,h=[(l=n[0][3])>=a&&l<=o,(c=n[1][3])>=a&&c<=o,(u=n[2][3])>=a&&u<=o];if(!h[0]&&!h[1]&&!h[2])return!1;var p=function(r,n,i){return F(n[0][3])&&F(n[1][3])&&F(n[2][3])?(D(r,n,i),!0):s<3&&N(r,n,i,L,C,++s)};if(h[0]&&h[1]&&h[2])return p(r,n,i)||f;var d=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(s){if(h[s[0]]&&h[s[1]]&&!h[s[2]]){var l=n[s[0]],c=n[s[1]],u=n[s[2]],m=R(u,l,a,o),g=R(u,c,a,o);f=p(r,[g,m,l],[-1,-1,i[s[0]]])||f,f=p(r,[l,c,g],[i[s[0]],i[s[1]],-1])||f,d=!0}}),d||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(s){if(h[s[0]]&&!h[s[1]]&&!h[s[2]]){var l=n[s[0]],c=n[s[1]],u=n[s[2]],m=R(c,l,a,o);f=p(r,[R(u,l,a,o),m,l],[-1,-1,i[s[0]]])||f,d=!0}}),f}function j(r,n,i,a){var o,s,l,c,u,f=!1,h=B(n),p=[(o=h[0][3])>=i&&o<=a,(s=h[1][3])>=i&&s<=a,(l=h[2][3])>=i&&l<=a,(c=h[3][3])>=i&&c<=a];if(!(p[0]||p[1]||p[2]||p[3]))return f;if(p[0]&&p[1]&&p[2]&&p[3])return v&&((u=function(i,a,o){D(r,[h[i],h[a],h[o]],[n[i],n[a],n[o]])})(0,1,2),u(3,0,1),u(2,3,0),u(1,2,3)),f;var d=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(o){if(p[o[0]]&&p[o[1]]&&p[o[2]]&&!p[o[3]]){var s=h[o[0]],l=h[o[1]],c=h[o[2]],u=h[o[3]];f=v?D(r,[s,l,c],[n[o[0]],n[o[1]],n[o[2]]])||f:D(null,[R(u,s,i,a),R(u,l,i,a),R(u,c,i,a)],[-1,-1,-1])||f,d=!0}}),d||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(o){if(p[o[0]]&&p[o[1]]&&!p[o[2]]&&!p[o[3]]){var s,l,c,u=h[o[0]],m=h[o[1]],g=h[o[2]],y=h[o[3]],x=R(g,u,i,a),b=R(g,m,i,a),_=R(y,m,i,a),w=R(y,u,i,a);v?(f=D(r,[u,w,x],[n[o[0]],-1,-1])||f,f=D(r,[m,b,_],[n[o[1]],-1,-1])||f):(s=[x,b,_,w],l=[-1,-1,-1,-1],(c=function(r,n,i){D(null,[s[r],s[n],s[i]],[l[r],l[n],l[i]])})(0,1,2),c(2,3,0)),d=!0}}),d||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(o){if(p[o[0]]&&!p[o[1]]&&!p[o[2]]&&!p[o[3]]){var s=h[o[0]],l=h[o[1]],c=h[o[2]],u=h[o[3]],m=R(l,s,i,a),g=R(c,s,i,a),y=R(u,s,i,a);v?(f=D(r,[s,m,g],[n[o[0]],-1,-1])||f,f=D(r,[s,g,y],[n[o[0]],-1,-1])||f,f=D(r,[s,y,m],[n[o[0]],-1,-1])||f):f=D(null,[m,g,y],[-1,-1,-1])||f,d=!0}})),f}function U(r,n,i,a,o,s,l,c,u,f,h){var p=!1;return g&&(z(r,"A")&&(p=j(null,[n,i,a,s],f,h)||p),z(r,"B")&&(p=j(null,[i,a,o,u],f,h)||p),z(r,"C")&&(p=j(null,[i,s,l,u],f,h)||p),z(r,"D")&&(p=j(null,[a,s,c,u],f,h)||p),z(r,"E")&&(p=j(null,[i,a,s,u],f,h)||p)),v&&(p=j(r,[i,a,s,u],f,h)||p),p}function V(r,n,i,a,o,s,l,c){return[!0===c[0]||N(r,B([n,i,a]),[n,i,a],s,l),!0===c[1]||N(r,B([a,o,n]),[a,o,n],s,l)]}function H(r,n,i,a,o,s,l,c,u){return c?V(r,n,i,o,a,s,l,u):V(r,i,o,a,n,s,l,u)}function q(r,n,i,a,o,s,l){var c,u,f,h,p=!1,d=function(){p=N(r,[c,u,f],[-1,-1,-1],o,s)||p,p=N(r,[f,h,c],[-1,-1,-1],o,s)||p},m=l[0],g=l[1],v=l[2];return m&&(c=O(B([M(n,i-0,a-0)])[0],B([M(n-1,i-0,a-0)])[0],m),u=O(B([M(n,i-0,a-1)])[0],B([M(n-1,i-0,a-1)])[0],m),f=O(B([M(n,i-1,a-1)])[0],B([M(n-1,i-1,a-1)])[0],m),h=O(B([M(n,i-1,a-0)])[0],B([M(n-1,i-1,a-0)])[0],m),d()),g&&(c=O(B([M(n-0,i,a-0)])[0],B([M(n-0,i-1,a-0)])[0],g),u=O(B([M(n-0,i,a-1)])[0],B([M(n-0,i-1,a-1)])[0],g),f=O(B([M(n-1,i,a-1)])[0],B([M(n-1,i-1,a-1)])[0],g),h=O(B([M(n-1,i,a-0)])[0],B([M(n-1,i-1,a-0)])[0],g),d()),v&&(c=O(B([M(n-0,i-0,a)])[0],B([M(n-0,i-0,a-1)])[0],v),u=O(B([M(n-0,i-1,a)])[0],B([M(n-0,i-1,a-1)])[0],v),f=O(B([M(n-1,i-1,a)])[0],B([M(n-1,i-1,a-1)])[0],v),h=O(B([M(n-1,i-0,a)])[0],B([M(n-1,i-0,a-1)])[0],v),d()),p}function G(r,n,i,a,o){for(var s=[],l=0,c=0;c<n.length;c++)for(var u=n[c],f=1;f<k;f++)for(var h=1;h<T;h++)s.push(H(r,M(u,h-1,f-1),M(u,h-1,f),M(u,h,f-1),M(u,h,f),i,a,(u+h+f)%2,o&&o[l]?o[l]:[])),l++;return s}function Y(r,n,i,a,o){for(var s=[],l=0,c=0;c<n.length;c++)for(var u=n[c],f=1;f<w;f++)for(var h=1;h<k;h++)s.push(H(r,M(f-1,u,h-1),M(f,u,h-1),M(f-1,u,h),M(f,u,h),i,a,(f+u+h)%2,o&&o[l]?o[l]:[])),l++;return s}function W(r,n,i,a,o){for(var s=[],l=0,c=0;c<n.length;c++)for(var u=n[c],f=1;f<T;f++)for(var h=1;h<w;h++)s.push(H(r,M(h-1,f-1,u),M(h-1,f,u),M(h,f-1,u),M(h,f,u),i,a,(h+f+u)%2,o&&o[l]?o[l]:[])),l++;return s}function X(r,n,i){for(var a=1;a<k;a++)for(var o=1;o<T;o++)for(var s=1;s<w;s++)!function(r,n,i,a,o,s,l,c,u,f,h,p){var d=r;p?(g&&"even"===r&&(d=null),U(d,n,i,a,o,s,l,c,u,f,h)):(g&&"odd"===r&&(d=null),U(d,u,c,l,s,o,a,i,n,f,h))}(r,M(s-1,o-1,a-1),M(s-1,o-1,a),M(s-1,o,a-1),M(s-1,o,a),M(s,o-1,a-1),M(s,o-1,a),M(s,o,a-1),M(s,o,a),n,i,(s+o+a)%2)}return function(){if(P(),function(){for(var n=0;n<w;n++)for(var i=0;i<T;i++)for(var a=0;a<k;a++){var o=M(n,i,a);I(r._x[o],r._y[o],r._z[o],r._value[o])}}(),h&&m&&(c=m,v=!0,X(null,L,C),v=!1),f&&d){c=d;for(var n=r.surface.pattern,i=r.surface.count,p=0;p<i;p++){var A,O,z=1===i?.5:p/(i-1),D=(1-z)*L+z*C,R=Math.abs(D-S)>Math.abs(D-E)?[S,D]:[D,E];A=R[0],O=R[1],g=!0,X(n,A,O),g=!1}}var F=[[Math.min(L,E),Math.max(L,E)],[Math.min(S,C),Math.max(S,C)]];["x","y","z"].forEach(function(n){for(var i=[],a=0;a<F.length;a++){var o=0,s=F[a][0],l=F[a][1],f=r.slices[n];if(f.show&&f.fill){c=f.fill;var h=[],p=[],d=[];if(f.locations.length)for(var m=0;m<f.locations.length;m++){var g=u(f.locations[m],"x"===n?x:"y"===n?b:_);0===g.distRatio?h.push(g.id):g.id>0&&(p.push(g.id),"x"===n?d.push([g.distRatio,0,0]):"y"===n?d.push([0,g.distRatio,0]):d.push([0,0,g.distRatio]))}else h=function(r,n){for(var i=[],a=1;a<n;a++)i.push(a);return i}(0,"x"===n?w-1:"y"===n?T-1:k-1);p.length>0&&(i[o]="x"===n?function(r,n,i,a,o,s){for(var l=[],c=0,u=0;u<n.length;u++)for(var f=n[u],h=1;h<k;h++)for(var p=1;p<T;p++)l.push(q(null,f,p,h,i,a,o[u],s&&s[c]&&s[c])),c++;return l}(0,p,s,l,d,i[o]):"y"===n?function(r,n,i,a,o,s){for(var l=[],c=0,u=0;u<n.length;u++)for(var f=n[u],h=1;h<w;h++)for(var p=1;p<k;p++)l.push(q(null,h,f,p,i,a,o[u],s&&s[c]&&s[c])),c++;return l}(0,p,s,l,d,i[o]):function(r,n,i,a,o,s){for(var l=[],c=0,u=0;u<n.length;u++)for(var f=n[u],h=1;h<T;h++)for(var p=1;p<w;p++)l.push(q(null,p,h,f,i,a,o[u],s&&s[c]&&s[c])),c++;return l}(0,p,s,l,d,i[o]),o++),h.length>0&&(i[o]="x"===n?G(null,h,s,l,i[o]):"y"===n?Y(null,h,s,l,i[o]):W(null,h,s,l,i[o]),o++)}var v=r.caps[n];v.show&&v.fill&&(c=v.fill,i[o]="x"===n?G(null,[0,w-1],s,l,i[o]):"y"===n?Y(null,[0,T-1],s,l,i[o]):W(null,[0,k-1],s,l,i[o]),o++)}}),0===y&&P(),r._meshX=a,r._meshY=o,r._meshZ=s,r._meshIntensity=l,r._Xs=x,r._Ys=b,r._Zs=_}(),r}n.exports={findNearestOnAxis:u,generateIsoMeshes:d,createIsosurfaceTrace:function(r,n){var i=a({gl:r.glplot.gl}),o=new f(r,i,n.uid);return i._trace=o,o.update(n),r.glplot.add(i),o}}},{"../../../stackgl_modules":1120,"../../components/colorscale":378,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/gl3d/zip3":609}],865:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../registry"),s=r("./attributes"),l=r("../../components/colorscale/defaults");function c(r,n,i,a,s){var c=s("isomin"),u=s("isomax");null!=u&&null!=c&&c>u&&(n.isomin=null,n.isomax=null);var f=s("x"),h=s("y"),p=s("z"),d=s("value");f&&f.length&&h&&h.length&&p&&p.length&&d&&d.length?(o.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x","y","z"],a),s("valuehoverformat"),["x","y","z"].forEach(function(r){s(r+"hoverformat");var n="caps."+r;s(n+".show")&&s(n+".fill");var i="slices."+r;s(i+".show")&&(s(i+".fill"),s(i+".locations"))}),s("spaceframe.show")&&s("spaceframe.fill"),s("surface.show")&&(s("surface.count"),s("surface.fill"),s("surface.pattern")),s("contour.show")&&(s("contour.color"),s("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(r){s(r)}),l(r,n,a,s,{prefix:"",cLetter:"c"}),n._length=null):n.visible=!1}n.exports={supplyDefaults:function(r,n,i,o){c(r,n,i,o,function(i,o){return a.coerce(r,n,s,i,o)})},supplyIsoDefaults:c}},{"../../components/colorscale/defaults":376,"../../lib":503,"../../registry":638,"./attributes":862}],866:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,calc:r("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:r("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":598,"./attributes":862,"./calc":863,"./convert":864,"./defaults":865}],867:[function(r,n,i){"use strict";var a=r("../../components/colorscale/attributes"),o=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,s=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../surface/attributes"),c=r("../../plots/attributes"),u=r("../../lib/extend").extendFlat;n.exports=u({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:s({editType:"calc"}),xhoverformat:o("x"),yhoverformat:o("y"),zhoverformat:o("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},a("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:l.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:u({},l.contours.x.show,{}),color:l.contours.x.color,width:l.contours.x.width,editType:"calc"},lightposition:{x:u({},l.lightposition.x,{dflt:1e5}),y:u({},l.lightposition.y,{dflt:1e5}),z:u({},l.lightposition.z,{dflt:0}),editType:"calc"},lighting:u({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},l.lighting),hoverinfo:u({},c.hoverinfo,{editType:"calc"}),showlegend:u({},c.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../surface/attributes":1057}],868:[function(r,n,i){"use strict";var a=r("../../components/colorscale/calc");n.exports=function(r,n){n.intensity&&a(r,n,{vals:n.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374}],869:[function(r,n,i){"use strict";var a=r("../../../stackgl_modules").gl_mesh3d,o=r("../../../stackgl_modules").delaunay_triangulate,s=r("../../../stackgl_modules").alpha_shape,l=r("../../../stackgl_modules").convex_hull,c=r("../../lib/gl_format_color").parseColorScale,u=r("../../lib/str2rgbarray"),f=r("../../components/colorscale").extractOpts,h=r("../../plots/gl3d/zip3");function p(r,n,i){this.scene=r,this.uid=i,this.mesh=n,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var d=p.prototype;function m(r){for(var n=[],i=r.length,a=0;a<i;a++)n[a]=u(r[a]);return n}function g(r,n,i,a){for(var o=[],s=n.length,l=0;l<s;l++)o[l]=r.d2l(n[l],0,a)*i;return o}function v(r){for(var n=[],i=r.length,a=0;a<i;a++)n[a]=Math.round(r[a]);return n}function y(r,n){for(var i=r.length,a=0;a<i;a++)if(r[a]<=-.5||r[a]>=n-.5)return!1;return!0}d.handlePick=function(r){if(r.object===this.mesh){var n=r.index=r.data.index;r.data._cellCenter?r.traceCoordinate=r.data.dataCoordinate:r.traceCoordinate=[this.data.x[n],this.data.y[n],this.data.z[n]];var i=this.data.hovertext||this.data.text;return Array.isArray(i)&&void 0!==i[n]?r.textLabel=i[n]:i&&(r.textLabel=i),!0}},d.update=function(r){var n=this.scene,i=n.fullSceneLayout;this.data=r;var a,p=r.x.length,d=h(g(i.xaxis,r.x,n.dataScale[0],r.xcalendar),g(i.yaxis,r.y,n.dataScale[1],r.ycalendar),g(i.zaxis,r.z,n.dataScale[2],r.zcalendar));if(r.i&&r.j&&r.k){if(r.i.length!==r.j.length||r.j.length!==r.k.length||!y(r.i,p)||!y(r.j,p)||!y(r.k,p))return;a=h(v(r.i),v(r.j),v(r.k))}else a=0===r.alphahull?l(d):r.alphahull>0?s(r.alphahull,d):function(r,n){for(var i=["x","y","z"].indexOf(r),a=[],s=n.length,l=0;l<s;l++)a[l]=[n[l][(i+1)%3],n[l][(i+2)%3]];return o(a)}(r.delaunayaxis,d);var x={positions:d,cells:a,lightPosition:[r.lightposition.x,r.lightposition.y,r.lightposition.z],ambient:r.lighting.ambient,diffuse:r.lighting.diffuse,specular:r.lighting.specular,roughness:r.lighting.roughness,fresnel:r.lighting.fresnel,vertexNormalsEpsilon:r.lighting.vertexnormalsepsilon,faceNormalsEpsilon:r.lighting.facenormalsepsilon,opacity:r.opacity,contourEnable:r.contour.show,contourColor:u(r.contour.color).slice(0,3),contourWidth:r.contour.width,useFacetNormals:r.flatshading};if(r.intensity){var b=f(r);this.color="#fff";var _=r.intensitymode;x[_+"Intensity"]=r.intensity,x[_+"IntensityBounds"]=[b.min,b.max],x.colormap=c(r)}else r.vertexcolor?(this.color=r.vertexcolor[0],x.vertexColors=m(r.vertexcolor)):r.facecolor?(this.color=r.facecolor[0],x.cellColors=m(r.facecolor)):(this.color=r.color,x.meshColor=u(r.color));this.mesh.update(x)},d.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},n.exports=function(r,n){var i=a({gl:r.glplot.gl}),o=new p(r,i,n.uid);return i._trace=o,o.update(n),r.glplot.add(i),o}},{"../../../stackgl_modules":1120,"../../components/colorscale":378,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/gl3d/zip3":609}],870:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("../../components/colorscale/defaults"),l=r("./attributes");n.exports=function(r,n,i,c){function u(i,a){return o.coerce(r,n,l,i,a)}function f(r){var n=r.map(function(r){var n=u(r);return n&&o.isArrayOrTypedArray(n)?n:null});return n.every(function(r){return r&&r.length===n[0].length})&&n}f(["x","y","z"])?(f(["i","j","k"]),(!n.i||n.j&&n.k)&&(!n.j||n.k&&n.i)&&(!n.k||n.i&&n.j)?(a.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x","y","z"],c),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(r){u(r)}),u("contour.show")&&(u("contour.color"),u("contour.width")),"intensity"in r?(u("intensity"),u("intensitymode"),s(r,n,c,u,{prefix:"",cLetter:"c"})):(n.showscale=!1,"facecolor"in r?u("facecolor"):"vertexcolor"in r?u("vertexcolor"):u("color",i)),u("text"),u("hovertext"),u("hovertemplate"),u("xhoverformat"),u("yhoverformat"),u("zhoverformat"),n._length=null):n.visible=!1):n.visible=!1}},{"../../components/colorscale/defaults":376,"../../lib":503,"../../registry":638,"./attributes":867}],871:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:r("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":598,"./attributes":867,"./calc":868,"./convert":869,"./defaults":870}],872:[function(r,n,i){"use strict";var a=r("../../lib").extendFlat,o=r("../scatter/attributes"),s=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,l=r("../../components/drawing/attributes").dash,c=r("../../components/fx/attributes"),u=r("../../constants/delta.js"),f=u.INCREASING.COLOR,h=u.DECREASING.COLOR,p=o.line;function d(r){return{line:{color:a({},p.color,{dflt:r}),width:p.width,dash:l,editType:"style"},editType:"style"}}n.exports={xperiod:o.xperiod,xperiod0:o.xperiod0,xperiodalignment:o.xperiodalignment,xhoverformat:s("x"),yhoverformat:s("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:a({},p.width,{}),dash:a({},l,{}),editType:"style"},increasing:d(f),decreasing:d(h),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:a({},c.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":387,"../../components/fx/attributes":397,"../../constants/delta.js":473,"../../lib":503,"../../plots/cartesian/axis_format_attributes":557,"../scatter/attributes":926}],873:[function(r,n,i){"use strict";var a=r("../../lib"),o=a._,s=r("../../plots/cartesian/axes"),l=r("../../plots/cartesian/align_period"),c=r("../../constants/numerical").BADNUM;function u(r,n,i,a){return{o:r,h:n,l:i,c:a}}function f(r,n,i,l,u,f){for(var h=u.makeCalcdata(n,"open"),p=u.makeCalcdata(n,"high"),d=u.makeCalcdata(n,"low"),m=u.makeCalcdata(n,"close"),g=Array.isArray(n.text),v=Array.isArray(n.hovertext),y=!0,x=null,b=!!n.xperiodalignment,_=[],w=0;w<l.length;w++){var T=l[w],k=h[w],A=p[w],M=d[w],S=m[w];if(T!==c&&k!==c&&A!==c&&M!==c&&S!==c){S===k?null!==x&&S!==x&&(y=S>x):y=S>k,x=S;var E=f(k,A,M,S);E.pos=T,E.yc=(k+S)/2,E.i=w,E.dir=y?"increasing":"decreasing",E.x=E.pos,E.y=[M,A],b&&(E.orig_p=i[w]),g&&(E.tx=n.text[w]),v&&(E.htx=n.hovertext[w]),_.push(E)}else _.push({pos:T,empty:!0})}return n._extremes[u._id]=s.findExtremes(u,a.concat(d,p),{padded:!0}),_.length&&(_[0].t={labels:{open:o(r,"open:")+" ",high:o(r,"high:")+" ",low:o(r,"low:")+" ",close:o(r,"close:")+" "}}),_}n.exports={calc:function(r,n){var i=s.getFromId(r,n.xaxis),o=s.getFromId(r,n.yaxis),c=function(r,n,i){var o=i._minDiff;if(!o){var s,c=r._fullData,u=[];for(o=1/0,s=0;s<c.length;s++){var f=c[s];if("ohlc"===f.type&&!0===f.visible&&f.xaxis===n._id){u.push(f);var h=n.makeCalcdata(f,"x");f._origX=h;var p=l(i,n,"x",h).vals;f._xcalc=p;var d=a.distinctVals(p).minDiff;d&&isFinite(d)&&(o=Math.min(o,d))}}for(o===1/0&&(o=1),s=0;s<u.length;s++)u[s]._minDiff=o}return o*i.tickwidth}(r,i,n),h=n._minDiff;n._minDiff=null;var p=n._origX;n._origX=null;var d=n._xcalc;n._xcalc=null;var m=f(r,n,p,d,o,u);return n._extremes[i._id]=s.findExtremes(i,d,{vpad:h/2}),m.length?(a.extendFlat(m[0].t,{wHover:h/2,tickLen:c}),m):[{t:{empty:!0}}]},calcCommon:f}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554}],874:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./ohlc_defaults"),s=r("../scatter/period_defaults"),l=r("./attributes");function c(r,n,i,a){i(a+".line.color"),i(a+".line.width",n.line.width),i(a+".line.dash",n.line.dash)}n.exports=function(r,n,i,u){function f(i,o){return a.coerce(r,n,l,i,o)}o(r,n,f,u)?(s(r,n,u,f,{x:!0}),f("xhoverformat"),f("yhoverformat"),f("line.width"),f("line.dash"),c(r,n,f,"increasing"),c(r,n,f,"decreasing"),f("text"),f("hovertext"),f("tickwidth"),u._requestRangeslider[n.xaxis]=!0):n.visible=!1}},{"../../lib":503,"../scatter/period_defaults":946,"./attributes":872,"./ohlc_defaults":877}],875:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../lib"),s=r("../../components/fx"),l=r("../../components/color"),c=r("../../lib").fillText,u=r("../../constants/delta.js"),f={increasing:u.INCREASING.SYMBOL,decreasing:u.DECREASING.SYMBOL};function h(r,n,i,a){var o,c,u=r.cd,f=r.xa,h=u[0].trace,p=u[0].t,d=h.type,m="ohlc"===d?"l":"min",g="ohlc"===d?"h":"max",v=p.bPos||0,y=p.bdPos||p.tickLen,x=p.wHover,b=Math.min(1,y/Math.abs(f.r2c(f.range[1])-f.r2c(f.range[0])));function _(r){var i=r.pos+v-n;return s.inbox(i-x,i+x,o)}function w(r){var n=r[m],a=r[g];return n===a||s.inbox(n-i,a-i,o)}function T(r){return(_(r)+w(r))/2}o=r.maxHoverDistance-b,c=r.maxSpikeDistance-b;var k=s.getDistanceFunction(a,_,w,T);if(s.getClosest(u,k,r),!1===r.index)return null;var A=u[r.index];if(A.empty)return null;var M=h[A.dir],S=M.line.color;return l.opacity(S)&&M.line.width?r.color=S:r.color=M.fillcolor,r.x0=f.c2p(A.pos+v-y,!0),r.x1=f.c2p(A.pos+v+y,!0),r.xLabelVal=void 0!==A.orig_p?A.orig_p:A.pos,r.spikeDistance=T(A)*c/o,r.xSpike=f.c2p(A.pos,!0),r}function p(r,n,i,s){var l=r.cd,c=r.ya,u=l[0].trace,f=l[0].t,p=[],d=h(r,n,i,s);if(!d)return[];var m=l[d.index].hi||u.hoverinfo,g=m.split("+");if(!("all"===m||-1!==g.indexOf("y")))return[];for(var v=["high","open","close","low"],y={},x=0;x<v.length;x++){var b,_=v[x],w=u[_][d.index],T=c.c2p(w,!0);w in y?(b=y[w]).yLabel+="<br>"+f.labels[_]+a.hoverLabelText(c,w,u.yhoverformat):((b=o.extendFlat({},d)).y0=b.y1=T,b.yLabelVal=w,b.yLabel=f.labels[_]+a.hoverLabelText(c,w,u.yhoverformat),b.name="",p.push(b),y[w]=b)}return p}function d(r,n,i,o){var s=r.cd,l=r.ya,u=s[0].trace,p=s[0].t,d=h(r,n,i,o);if(!d)return[];var m=s[d.index],g=d.index=m.i,v=m.dir;function y(r){return p.labels[r]+a.hoverLabelText(l,u[r][g],u.yhoverformat)}var x=m.hi||u.hoverinfo,b=x.split("+"),_="all"===x,w=_||-1!==b.indexOf("y"),T=_||-1!==b.indexOf("text"),k=w?[y("open"),y("high"),y("low"),y("close")+"  "+f[v]]:[];return T&&c(m,u,k),d.extraText=k.join("<br>"),d.y0=d.y1=l.c2p(m.yc,!0),[d]}n.exports={hoverPoints:function(r,n,i,a){return r.cd[0].trace.hoverlabel.split?p(r,n,i,a):d(r,n,i,a)},hoverSplit:p,hoverOnPoints:d}},{"../../components/color":366,"../../components/fx":406,"../../constants/delta.js":473,"../../lib":503,"../../plots/cartesian/axes":554}],876:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"ohlc",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc").calc,plot:r("./plot"),style:r("./style"),hoverPoints:r("./hover").hoverPoints,selectPoints:r("./select")}},{"../../plots/cartesian":568,"./attributes":872,"./calc":873,"./defaults":874,"./hover":875,"./plot":878,"./select":879,"./style":880}],877:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib");n.exports=function(r,n,i,s){var l=i("x"),c=i("open"),u=i("high"),f=i("low"),h=i("close");if(i("hoverlabel.split"),a.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x"],s),c&&u&&f&&h){var p=Math.min(c.length,u.length,f.length,h.length);return l&&(p=Math.min(p,o.minRowLength(l))),n._length=p,p}}},{"../../lib":503,"../../registry":638}],878:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib");n.exports=function(r,n,i,s){var l=n.yaxis,c=n.xaxis,u=!!c.rangebreaks;o.makeTraceGroups(s,i,"trace ohlc").each(function(r){var n=a.select(this),i=r[0],s=i.t;if(!0!==i.trace.visible||s.empty)n.remove();else{var f=s.tickLen,h=n.selectAll("path").data(o.identity);h.enter().append("path"),h.exit().remove(),h.attr("d",function(r){if(r.empty)return"M0,0Z";var n=c.c2p(r.pos-f,!0),i=c.c2p(r.pos+f,!0),a=u?(n+i)/2:c.c2p(r.pos,!0);return"M"+n+","+l.c2p(r.o,!0)+"H"+a+"M"+a+","+l.c2p(r.h,!0)+"V"+l.c2p(r.l,!0)+"M"+i+","+l.c2p(r.c,!0)+"H"+a})}})}},{"../../lib":503,"@plotly/d3":58}],879:[function(r,n,i){"use strict";n.exports=function(r,n){var i,a=r.cd,o=r.xaxis,s=r.yaxis,l=[],c=a[0].t.bPos||0;if(!1===n)for(i=0;i<a.length;i++)a[i].selected=0;else for(i=0;i<a.length;i++){var u=a[i];n.contains([o.c2p(u.pos+c),s.c2p(u.yc)],null,u.i,r)?(l.push({pointNumber:u.i,x:o.c2d(u.pos),y:s.c2d(u.yc)}),u.selected=1):u.selected=0}return l}},{}],880:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/drawing"),s=r("../../components/color");n.exports=function(r,n,i){var l=i||a.select(r).selectAll("g.ohlclayer").selectAll("g.trace");l.style("opacity",function(r){return r[0].trace.opacity}),l.each(function(r){var n=r[0].trace;a.select(this).selectAll("path").each(function(r){if(!r.empty){var i=n[r.dir].line;a.select(this).style("fill","none").call(s.stroke,i.color).call(o.dashLine,i.dash,i.width).style("opacity",n.selectedpoints&&!r.selected?.3:1)}})})}},{"../../components/color":366,"../../components/drawing":388,"@plotly/d3":58}],881:[function(r,n,i){"use strict";var a=r("../../lib/extend").extendFlat,o=r("../../plots/attributes"),s=r("../../plots/font_attributes"),l=r("../../components/colorscale/attributes"),c=r("../../plots/template_attributes").hovertemplateAttrs,u=r("../../plots/domain").attributes,f=a({editType:"calc"},l("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:c({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});n.exports={domain:u({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:a({},o.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:c({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:s({editType:"calc"}),tickfont:s({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:f,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/font_attributes":585,"../../plots/template_attributes":633}],882:[function(r,n,i){"use strict";var a=r("../../plots/get_data").getModuleCalcData,o=r("./plot");i.name="parcats",i.plot=function(r,n,i,s){var l=a(r.calcdata,"parcats");l.length&&o(r,l[0],i,s)},i.clean=function(r,n,i,a){var o=a._has&&a._has("parcats"),s=n._has&&n._has("parcats");o&&!s&&a._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":593,"./plot":887}],883:[function(r,n,i){"use strict";var a=r("../../lib/gup").wrap,o=r("../../components/colorscale/helpers").hasColorscale,s=r("../../components/colorscale/calc"),l=r("../../lib/filter_unique.js"),c=r("../../components/drawing"),u=r("../../lib"),f=r("fast-isnumeric");n.exports=function(r,n){var i,h,p=u.filterVisible(n.dimensions);if(0===p.length)return[];var d,m,g,v=p.map(function(r){var n;if("trace"===r.categoryorder)n=null;else if("array"===r.categoryorder)n=r.categoryarray;else{n=l(r.values);for(var i=!0,a=0;a<n.length;a++)if(!f(n[a])){i=!1;break}n.sort(i?u.sorterAsc:void 0),"category descending"===r.categoryorder&&(n=n.reverse())}return function(r,n){n=null==n?[]:n.map(function(r){return r});var i={},a={},o=[];n.forEach(function(r,n){i[r]=0,a[r]=n});for(var s=0;s<r.length;s++){var l,c=r[s];void 0===i[c]?(i[c]=1,l=n.push(c)-1,a[c]=l):(i[c]++,l=a[c]),o.push(l)}var u=n.map(function(r){return i[r]});return{uniqueValues:n,uniqueCounts:u,inds:o}}(r.values,n)});d=u.isArrayOrTypedArray(n.counts)?n.counts:[n.counts],function(r){var n;if(function(r){for(var n=Array(r.length),i=0;i<r.length;i++){if(r[i]<0||r[i]>=r.length||void 0!==n[r[i]])return!1;n[r[i]]=!0}return!0}(r.map(function(r){return r.displayindex})))for(n=0;n<r.length;n++)r[n]._displayindex=r[n].displayindex;else for(n=0;n<r.length;n++)r[n]._displayindex=n}(p),p.forEach(function(r,n){!function(r,n){r._categoryarray=n.uniqueValues,null===r.ticktext||void 0===r.ticktext?r._ticktext=[]:r._ticktext=r.ticktext.slice();for(var i=r._ticktext.length;i<n.uniqueValues.length;i++)r._ticktext.push(n.uniqueValues[i])}(r,v[n])});var y,x=n.line;x?(o(n,"line")&&s(r,n,{vals:n.line.color,containerStr:"line",cLetter:"c"}),y=c.tryColorscale(x)):y=u.identity;var b,_,w,T,k,A=p[0].values.length,M={},S=v.map(function(r){return r.inds});for(g=0,b=0;b<A;b++){var E,L,C,P=[];for(_=0;_<S.length;_++)P.push(S[_][b]);m=d[b%d.length],g+=m;var I=(w=b,T=void 0,k=void 0,u.isArrayOrTypedArray(x.color)?k=T=x.color[w%x.color.length]:T=x.color,{color:y(T),rawColor:k}),O=P+"-"+I.rawColor;void 0===M[O]&&(M[O]={categoryInds:P,color:I.color,rawColor:I.rawColor,valueInds:[],count:0}),E=M[O],L=b,C=m,E.valueInds.push(L),E.count+=C}var z=p.map(function(r,n){var i;return i=r._index,{dimensionInd:n,containerInd:i,displayInd:r._displayindex,dimensionLabel:r.label,count:g,categories:[],dragX:null}});for(b=0;b<A;b++)for(m=d[b%d.length],_=0;_<z.length;_++){var D,R,F,B=z[_].containerInd,N=v[_].inds[b],j=z[_].categories;if(void 0===j[N]){var U=n.dimensions[B]._categoryarray[N],V=n.dimensions[B]._ticktext[N];j[N]={dimensionInd:_,categoryInd:N,categoryValue:U,displayInd:N,categoryLabel:V,valueInds:[],count:0,dragY:null}}D=j[N],R=b,F=m,D.valueInds.push(R),D.count+=F}return a((i=g,h=z.map(function(r){return r.categories.length}).reduce(function(r,n){return Math.max(r,n)}),{dimensions:z,paths:M,trace:void 0,maxCats:h,count:i}))}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"../../components/drawing":388,"../../lib":503,"../../lib/filter_unique.js":494,"../../lib/gup":500,"fast-isnumeric":190}],884:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/colorscale/helpers").hasColorscale,s=r("../../components/colorscale/defaults"),l=r("../../plots/domain").defaults,c=r("../../plots/array_container_defaults"),u=r("./attributes"),f=r("../parcoords/merge_length");function h(r,n){function i(i,o){return a.coerce(r,n,u.dimensions,i,o)}var o=i("values"),s=i("visible");if(o&&o.length||(s=n.visible=!1),s){i("label"),i("displayindex",n._index);var l,c=r.categoryarray,f=Array.isArray(c)&&c.length>0;f&&(l="array");var h=i("categoryorder",l);"array"===h?(i("categoryarray"),i("ticktext")):(delete r.categoryarray,delete r.ticktext),f||"array"!==h||(n.categoryorder="trace")}}n.exports=function(r,n,i,p){function d(i,o){return a.coerce(r,n,u,i,o)}var m=c(r,n,{name:"dimensions",handleItemDefaults:h}),g=function(r,n,i,l,c){c("line.shape"),c("line.hovertemplate");var u=c("line.color",l.colorway[0]);if(o(r,"line")&&a.isArrayOrTypedArray(u)){if(u.length)return c("line.colorscale"),s(r,n,l,c,{prefix:"line.",cLetter:"c"}),u.length;n.line.color=i}return 1/0}(r,n,i,p,d);l(n,p,d),Array.isArray(m)&&m.length||(n.visible=!1),f(n,m,"values",g),d("hoveron"),d("hovertemplate"),d("arrangement"),d("bundlecolors"),d("sortpaths"),d("counts");var v={family:p.font.family,size:Math.round(p.font.size),color:p.font.color};a.coerceFont(d,"labelfont",v);var y={family:p.font.family,size:Math.round(p.font.size/1.2),color:p.font.color};a.coerceFont(d,"tickfont",y)}},{"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/domain":584,"../parcoords/merge_length":897,"./attributes":881}],885:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:r("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":881,"./base_plot":882,"./calc":883,"./defaults":884,"./plot":887}],886:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("d3-interpolate").interpolateNumber,s=r("../../plot_api/plot_api"),l=r("../../components/fx"),c=r("../../lib"),u=c.strTranslate,f=r("../../components/drawing"),h=r("tinycolor2"),p=r("../../lib/svg_text_utils");function d(r){return r.key}function m(r){var n=r.parcatsViewModel.dimensions.length,i=r.parcatsViewModel.dimensions[n-1].model.dimensionInd;return r.model.dimensionInd===i}function g(r,n){return r.model.rawColor>n.model.rawColor?1:r.model.rawColor<n.model.rawColor?-1:0}function v(r){if(!r.parcatsViewModel.dragDimension&&-1===r.parcatsViewModel.hoverinfoItems.indexOf("skip")){c.raiseToTop(this),T(a.select(this));var n=x(r),i=b(r);if(r.parcatsViewModel.graphDiv.emit("plotly_hover",{points:n,event:a.event,constraints:i}),-1===r.parcatsViewModel.hoverinfoItems.indexOf("none")){var o,s,u,f=a.mouse(this)[0],p=r.parcatsViewModel.graphDiv,d=r.parcatsViewModel.trace,m=p._fullLayout,g=m._paperdiv.node().getBoundingClientRect(),v=r.parcatsViewModel.graphDiv.getBoundingClientRect();for(u=0;u<r.leftXs.length-1;u++)if(r.leftXs[u]+r.dimWidths[u]-2<=f&&f<=r.leftXs[u+1]+2){var y=r.parcatsViewModel.dimensions[u],_=r.parcatsViewModel.dimensions[u+1];o=(y.x+y.width+_.x)/2,s=(r.topYs[u]+r.topYs[u+1]+r.height)/2;break}var w=r.parcatsViewModel.x+o,k=r.parcatsViewModel.y+s,A=h.mostReadable(r.model.color,["black","white"]),M=r.model.count,S=M/r.parcatsViewModel.model.count,E={countLabel:M,probabilityLabel:S.toFixed(3)},L=[];-1!==r.parcatsViewModel.hoverinfoItems.indexOf("count")&&L.push(["Count:",E.countLabel].join(" ")),-1!==r.parcatsViewModel.hoverinfoItems.indexOf("probability")&&L.push(["P:",E.probabilityLabel].join(" "));var C=L.join("<br>"),P=a.mouse(p)[0];l.loneHover({trace:d,x:w-g.left+v.left,y:k-g.top+v.top,text:C,color:r.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:A,idealAlign:P<w?"right":"left",hovertemplate:(d.line||{}).hovertemplate,hovertemplateLabels:E,eventData:[{data:d._input,fullData:d,count:M,probability:S}]},{container:m._hoverlayer.node(),outerContainer:m._paper.node(),gd:p})}}}function y(r){if(!r.parcatsViewModel.dragDimension&&(w(a.select(this)),l.loneUnhover(r.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),r.parcatsViewModel.pathSelection.sort(g),-1===r.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var n=x(r),i=b(r);r.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:n,event:a.event,constraints:i})}}function x(r){for(var n=[],i=D(r.parcatsViewModel),a=0;a<r.model.valueInds.length;a++){var o=r.model.valueInds[a];n.push({curveNumber:i,pointNumber:o})}return n}function b(r){for(var n={},i=r.parcatsViewModel.model.dimensions,a=0;a<i.length;a++){var o=i[a],s=o.categories[r.model.categoryInds[a]];n[o.containerInd]=s.categoryValue}return void 0!==r.model.rawColor&&(n.color=r.model.rawColor),n}function _(r){if(-1===r.parcatsViewModel.hoverinfoItems.indexOf("skip")){var n=x(r),i=b(r);r.parcatsViewModel.graphDiv.emit("plotly_click",{points:n,event:a.event,constraints:i})}}function w(r){r.attr("fill",function(r){return r.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function T(r){r.attr("fill-opacity",.8).attr("stroke",function(r){return h.mostReadable(r.model.color,["black","white"])}).attr("stroke-width",.3)}function k(r){r.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function A(r){r.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function M(r){var n=r.parcatsViewModel.pathSelection,i=r.categoryViewModel.model.dimensionInd,a=r.categoryViewModel.model.categoryInd;return n.filter(function(n){return n.model.categoryInds[i]===a&&n.model.color===r.color})}function S(r,n,i){var o=a.select(r).datum(),s=o.categoryViewModel.model,l=o.parcatsViewModel.graphDiv,c=a.select(r.parentNode).selectAll("rect.bandrect"),u=[];c.each(function(r){M(r).each(function(r){Array.prototype.push.apply(u,x(r))})});var f={};f[s.dimensionInd]=s.categoryValue,l.emit(n,{points:u,event:i,constraints:f})}function E(r,n,i){var o=a.select(r).datum(),s=o.categoryViewModel.model,l=o.parcatsViewModel.graphDiv,c=M(o),u=[];c.each(function(r){Array.prototype.push.apply(u,x(r))});var f={};f[s.dimensionInd]=s.categoryValue,void 0!==o.rawColor&&(f.color=o.rawColor),l.emit(n,{points:u,event:i,constraints:f})}function L(r,n,i){r._fullLayout._calcInverseTransform(r);var o,s,l=r._fullLayout._invScaleX,c=r._fullLayout._invScaleY,u=a.select(i.parentNode).select("rect.catrect"),f=u.node().getBoundingClientRect(),h=u.datum(),p=h.parcatsViewModel,d=p.model.dimensions[h.model.dimensionInd],m=p.trace,g=f.top+f.height/2;p.dimensions.length>1&&d.displayInd===p.dimensions.length-1?(o=f.left,s="left"):(o=f.left+f.width,s="right");var v=h.model.count,y=h.model.categoryLabel,x=v/h.parcatsViewModel.model.count,b={countLabel:v,categoryLabel:y,probabilityLabel:x.toFixed(3)},_=[];-1!==h.parcatsViewModel.hoverinfoItems.indexOf("count")&&_.push(["Count:",b.countLabel].join(" ")),-1!==h.parcatsViewModel.hoverinfoItems.indexOf("probability")&&_.push(["P("+b.categoryLabel+"):",b.probabilityLabel].join(" "));var w=_.join("<br>");return{trace:m,x:l*(o-n.left),y:c*(g-n.top),text:w,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:s,hovertemplate:m.hovertemplate,hovertemplateLabels:b,eventData:[{data:m._input,fullData:m,count:v,category:y,probability:x}]}}function C(r){if(!r.parcatsViewModel.dragDimension&&-1===r.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!(a.mouse(this)[1]<-1)){var n,i,o,s,u=r.parcatsViewModel.graphDiv,f=u._fullLayout,p=f._paperdiv.node().getBoundingClientRect(),d=r.parcatsViewModel.hoveron;"color"===d?(T(i=M(n=a.select(this).datum())),i.each(function(){c.raiseToTop(this)}),a.select(this.parentNode).selectAll("rect.bandrect").filter(function(r){return r.color===n.color}).each(function(){c.raiseToTop(this),a.select(this).attr("stroke","black").attr("stroke-width",1.5)}),E(this,"plotly_hover",a.event)):(a.select(this.parentNode).selectAll("rect.bandrect").each(function(r){var n=M(r);T(n),n.each(function(){c.raiseToTop(this)})}),a.select(this.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5),S(this,"plotly_hover",a.event)),-1===r.parcatsViewModel.hoverinfoItems.indexOf("none")&&("category"===d?s=L(u,p,this):"color"===d?s=function(r,n,i){r._fullLayout._calcInverseTransform(r);var o,s,l=r._fullLayout._invScaleX,c=r._fullLayout._invScaleY,u=i.getBoundingClientRect(),f=a.select(i).datum(),p=f.categoryViewModel,d=p.parcatsViewModel,m=d.model.dimensions[p.model.dimensionInd],g=d.trace,v=u.y+u.height/2;d.dimensions.length>1&&m.displayInd===d.dimensions.length-1?(o=u.left,s="left"):(o=u.left+u.width,s="right");var y=p.model.categoryLabel,x=f.parcatsViewModel.model.count,b=0;f.categoryViewModel.bands.forEach(function(r){r.color===f.color&&(b+=r.count)});var _=p.model.count,w=0;d.pathSelection.each(function(r){r.model.color===f.color&&(w+=r.model.count)});var T=b/x,k=b/w,A=b/_,M={countLabel:x,categoryLabel:y,probabilityLabel:T.toFixed(3)},S=[];-1!==p.parcatsViewModel.hoverinfoItems.indexOf("count")&&S.push(["Count:",M.countLabel].join(" ")),-1!==p.parcatsViewModel.hoverinfoItems.indexOf("probability")&&(S.push("P(color  "+y+"): "+M.probabilityLabel),S.push("P("+y+" | color): "+k.toFixed(3)),S.push("P(color | "+y+"): "+A.toFixed(3)));var E=S.join("<br>"),L=h.mostReadable(f.color,["black","white"]);return{trace:g,x:l*(o-n.left),y:c*(v-n.top),text:E,color:f.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:L,fontSize:10,idealAlign:s,hovertemplate:g.hovertemplate,hovertemplateLabels:M,eventData:[{data:g._input,fullData:g,category:y,count:x,probability:T,categorycount:_,colorcount:w,bandcolorcount:b}]}}(u,p,this):"dimension"===d&&(o=[],a.select(this.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){o.push(L(u,p,this))}),s=o),s&&l.loneHover(s,{container:f._hoverlayer.node(),outerContainer:f._paper.node(),gd:u}))}}function P(r){var n=r.parcatsViewModel;n.dragDimension||(w(n.pathSelection),k(n.dimensionSelection.selectAll("g.category")),A(n.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),l.loneUnhover(n.graphDiv._fullLayout._hoverlayer.node()),n.pathSelection.sort(g),-1!==n.hoverinfoItems.indexOf("skip"))||("color"===r.parcatsViewModel.hoveron?E(this,"plotly_unhover",a.event):S(this,"plotly_unhover",a.event))}function I(r){"fixed"!==r.parcatsViewModel.arrangement&&(r.dragDimensionDisplayInd=r.model.displayInd,r.initialDragDimensionDisplayInds=r.parcatsViewModel.model.dimensions.map(function(r){return r.displayInd}),r.dragHasMoved=!1,r.dragCategoryDisplayInd=null,a.select(this).selectAll("g.category").select("rect.catrect").each(function(n){var i=a.mouse(this)[0],o=a.mouse(this)[1];-2<=i&&i<=n.width+2&&-2<=o&&o<=n.height+2&&(r.dragCategoryDisplayInd=n.model.displayInd,r.initialDragCategoryDisplayInds=r.model.categories.map(function(r){return r.displayInd}),n.model.dragY=n.y,c.raiseToTop(this.parentNode),a.select(this.parentNode).selectAll("rect.bandrect").each(function(n){n.y<o&&o<=n.y+n.height&&(r.potentialClickBand=this)}))}),r.parcatsViewModel.dragDimension=r,l.loneUnhover(r.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function O(r){if("fixed"!==r.parcatsViewModel.arrangement&&(r.dragHasMoved=!0,null!==r.dragDimensionDisplayInd)){var n=r.dragDimensionDisplayInd,i=r.parcatsViewModel.dimensions[n];if(null!==r.dragCategoryDisplayInd){var o=i.categories[r.dragCategoryDisplayInd];o.model.dragY+=a.event.dy;var s=o.model.dragY,l=o.model.displayInd,c=i.categories,u=c[l-1],f=c[l+1];void 0!==u&&s<u.y+u.height/2&&(o.model.displayInd=u.model.displayInd,u.model.displayInd=l),void 0!==f&&s+o.height>f.y+f.height/2&&(o.model.displayInd=f.model.displayInd,f.model.displayInd=l),r.dragCategoryDisplayInd=o.model.displayInd}if(null===r.dragCategoryDisplayInd||"freeform"===r.parcatsViewModel.arrangement){i.model.dragX=a.event.x;var h=r.parcatsViewModel.dimensions[n-1],p=r.parcatsViewModel.dimensions[n+1];void 0!==h&&i.model.dragX<h.x+h.width&&(i.model.displayInd=h.model.displayInd,h.model.displayInd=n),void 0!==p&&i.model.dragX+i.width>p.x&&(i.model.displayInd=p.model.displayInd,p.model.displayInd=r.dragDimensionDisplayInd),r.dragDimensionDisplayInd=i.model.displayInd}U(r.parcatsViewModel),j(r.parcatsViewModel),F(r.parcatsViewModel),R(r.parcatsViewModel)}}function z(r){if("fixed"!==r.parcatsViewModel.arrangement&&null!==r.dragDimensionDisplayInd){a.select(this).selectAll("text").attr("font-weight","normal");var n={},i=D(r.parcatsViewModel),o=r.parcatsViewModel.model.dimensions.map(function(r){return r.displayInd}),l=r.initialDragDimensionDisplayInds.some(function(r,n){return r!==o[n]});l&&o.forEach(function(i,a){n["dimensions["+r.parcatsViewModel.model.dimensions[a].containerInd+"].displayindex"]=i});var c=!1;if(null!==r.dragCategoryDisplayInd){var u=r.model.categories.map(function(r){return r.displayInd});if(c=r.initialDragCategoryDisplayInds.some(function(r,n){return r!==u[n]})){var f=r.model.categories.slice().sort(function(r,n){return r.displayInd-n.displayInd}),h=f.map(function(r){return r.categoryValue}),p=f.map(function(r){return r.categoryLabel});n["dimensions["+r.model.containerInd+"].categoryarray"]=[h],n["dimensions["+r.model.containerInd+"].ticktext"]=[p],n["dimensions["+r.model.containerInd+"].categoryorder"]="array"}}-1===r.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!r.dragHasMoved&&r.potentialClickBand&&("color"===r.parcatsViewModel.hoveron?E(r.potentialClickBand,"plotly_click",a.event.sourceEvent):S(r.potentialClickBand,"plotly_click",a.event.sourceEvent)),r.model.dragX=null,null!==r.dragCategoryDisplayInd&&(r.parcatsViewModel.dimensions[r.dragDimensionDisplayInd].categories[r.dragCategoryDisplayInd].model.dragY=null,r.dragCategoryDisplayInd=null),r.dragDimensionDisplayInd=null,r.parcatsViewModel.dragDimension=null,r.dragHasMoved=null,r.potentialClickBand=null,U(r.parcatsViewModel),j(r.parcatsViewModel),a.transition().duration(300).ease("cubic-in-out").each(function(){F(r.parcatsViewModel,!0),R(r.parcatsViewModel,!0)}).each("end",function(){(l||c)&&s.restyle(r.parcatsViewModel.graphDiv,n,[i])})}}function D(r){for(var n,i=r.graphDiv._fullData,a=0;a<i.length;a++)if(r.key===i[a].uid){n=a;break}return n}function R(r,n){var i;void 0===n&&(n=!1),r.pathSelection.data(function(r){return r.paths},d),(i=r.pathSelection,n?i.transition():i).attr("d",function(r){return r.svgD})}function F(r,n){function i(r){return n?r.transition():r}void 0===n&&(n=!1),r.dimensionSelection.data(function(r){return r.dimensions},d);var o=r.dimensionSelection.selectAll("g.category").data(function(r){return r.categories},d);i(r.dimensionSelection).attr("transform",function(r){return u(r.x,0)}),i(o).attr("transform",function(r){return u(0,r.y)}),o.select(".dimlabel").text(function(r,n){return 0===n?r.parcatsViewModel.model.dimensions[r.model.dimensionInd].dimensionLabel:null}),o.select(".catlabel").attr("text-anchor",function(r){return m(r)?"start":"end"}).attr("x",function(r){return m(r)?r.width+5:-5}).each(function(r){var n,i;m(r)?(n=r.width+5,i="start"):(n=-5,i="end"),a.select(this).selectAll("tspan").attr("x",n).attr("text-anchor",i)});var s=o.selectAll("rect.bandrect").data(function(r){return r.bands},d),l=s.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(r){return r.color}).attr("fill-opacity",0);s.attr("fill",function(r){return r.color}).attr("width",function(r){return r.width}).attr("height",function(r){return r.height}).attr("y",function(r){return r.y}),A(l),s.each(function(){c.raiseToTop(this)}),s.exit().remove()}function B(r,n,i){var a,o=i[0],s=n.margin||{l:80,r:80,t:100,b:80},l=o.trace,c=l.domain,u=n.width,f=n.height,h=Math.floor(u*(c.x[1]-c.x[0])),p=Math.floor(f*(c.y[1]-c.y[0])),d=c.x[0]*u+s.l,m=n.height-c.y[1]*n.height+s.t,g=l.line.shape;a="all"===l.hoverinfo?["count","probability"]:(l.hoverinfo||"").split("+");var v={trace:l,key:l.uid,model:o,x:d,y:m,width:h,height:p,hoveron:l.hoveron,hoverinfoItems:a,arrangement:l.arrangement,bundlecolors:l.bundlecolors,sortpaths:l.sortpaths,labelfont:l.labelfont,categorylabelfont:l.tickfont,pathShape:g,dragDimension:null,margin:s,paths:[],dimensions:[],graphDiv:r,traceSelection:null,pathSelection:null,dimensionSelection:null};return o.dimensions&&(U(v),j(v)),v}function N(r,n,i,a,s){var l,c,u=[],f=[];for(c=0;c<i.length-1;c++)u.push((l=o(i[c]+r[c],r[c+1]))(s)),f.push(l(1-s));var h="M "+r[0]+","+n[0];for(h+="l"+i[0]+",0 ",c=1;c<i.length;c++)h+="C"+u[c-1]+","+n[c-1]+" "+f[c-1]+","+n[c]+" "+r[c]+","+n[c]+"l"+i[c]+",0 ";for(h+="l0,"+a+" l -"+i[i.length-1]+",0 ",c=i.length-2;c>=0;c--)h+="C"+f[c]+","+(n[c+1]+a)+" "+u[c]+","+(n[c]+a)+" "+(r[c]+i[c])+","+(n[c]+a)+"l-"+i[c]+",0 ";return h+"Z"}function j(r){var n=r.dimensions,i=r.model,a=n.map(function(r){return r.categories.map(function(r){return r.y})}),o=r.model.dimensions.map(function(r){return r.categories.map(function(r){return r.displayInd})}),s=r.model.dimensions.map(function(r){return r.displayInd}),l=r.dimensions.map(function(r){return r.model.dimensionInd}),c=n.map(function(r){return r.x}),u=n.map(function(r){return r.width}),f=[];for(var h in i.paths)i.paths.hasOwnProperty(h)&&f.push(i.paths[h]);function p(r){var n=r.categoryInds.map(function(r,n){return o[n][r]});return l.map(function(r){return n[r]})}f.sort(function(n,i){var a=p(n),o=p(i);return"backward"===r.sortpaths&&(a.reverse(),o.reverse()),a.push(n.valueInds[0]),o.push(i.valueInds[0]),r.bundlecolors&&(a.unshift(n.rawColor),o.unshift(i.rawColor)),a<o?-1:a>o?1:0});for(var d=Array(f.length),m=n[0].model.count,g=n[0].categories.map(function(r){return r.height}).reduce(function(r,n){return r+n}),v=0;v<f.length;v++){var y,x=f[v];y=m>0?x.count/m*g:0;for(var b,_=Array(a.length),w=0;w<x.categoryInds.length;w++){var T=x.categoryInds[w],k=o[w][T],A=s[w];_[A]=a[A][k],a[A][k]+=y;var M=r.dimensions[A].categories[k],S=M.bands.length,E=M.bands[S-1];if(void 0===E||x.rawColor!==E.rawColor){var L=void 0===E?0:E.y+E.height;M.bands.push({key:L,color:x.color,rawColor:x.rawColor,height:y,width:M.width,count:x.count,y:L,categoryViewModel:M,parcatsViewModel:r})}else{var C=M.bands[S-1];C.height+=y,C.count+=x.count}}b="hspline"===r.pathShape?N(c,_,u,y,.5):N(c,_,u,y,0),d[v]={key:x.valueInds[0],model:x,height:y,leftXs:c,topYs:_,dimWidths:u,svgD:b,parcatsViewModel:r}}r.paths=d}function U(r){var n=r.model.dimensions.map(function(r){return{displayInd:r.displayInd,dimensionInd:r.dimensionInd}});n.sort(function(r,n){return r.displayInd-n.displayInd});var i=[];for(var a in n){var o=n[a].dimensionInd,s=r.model.dimensions[o];i.push(function(r,n){var i,a=r.model.dimensions.length,o=n.displayInd;i=40+(a>1?(r.width-80-16)/(a-1):0)*o;var s,l,c,u,f,h=[],p=r.model.maxCats,d=n.categories.length,m=n.count,g=r.height-8*(p-1),v=8*(p-d)/2,y=n.categories.map(function(r){return{displayInd:r.displayInd,categoryInd:r.categoryInd}});for(y.sort(function(r,n){return r.displayInd-n.displayInd}),f=0;f<d;f++)u=y[f].categoryInd,l=n.categories[u],s=m>0?l.count/m*g:0,c={key:l.valueInds[0],model:l,width:16,height:s,y:null!==l.dragY?l.dragY:v,bands:[],parcatsViewModel:r},v=v+s+8,h.push(c);return{key:n.dimensionInd,x:null!==n.dragX?n.dragX:i,y:0,width:16,model:n,categories:h,parcatsViewModel:r,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}(r,s))}r.dimensions=i}n.exports=function(r,n,i,o){var s,l,h,x,b,T,M,S,E,L,D,R;s=i.map(B.bind(0,r,o)),(l=n.selectAll("g.parcatslayer").data([null])).enter().append("g").attr("class","parcatslayer").style("pointer-events","all"),x=(h=l.selectAll("g.trace.parcats").data(s,d)).enter().append("g").attr("class","trace parcats"),h.attr("transform",function(r){return u(r.x,r.y)}),x.append("g").attr("class","paths"),(b=h.select("g.paths").selectAll("path.path").data(function(r){return r.paths},d)).attr("fill",function(r){return r.model.color}),w(T=b.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(r){return r.model.color}).attr("fill-opacity",0)),b.attr("d",function(r){return r.svgD}),T.empty()||b.sort(g),b.exit().remove(),b.on("mouseover",v).on("mouseout",y).on("click",_),x.append("g").attr("class","dimensions"),(M=h.select("g.dimensions").selectAll("g.dimension").data(function(r){return r.dimensions},d)).enter().append("g").attr("class","dimension"),M.attr("transform",function(r){return u(r.x,0)}),M.exit().remove(),E=(S=M.selectAll("g.category").data(function(r){return r.categories},d)).enter().append("g").attr("class","category"),S.attr("transform",function(r){return u(0,r.y)}),E.append("rect").attr("class","catrect").attr("pointer-events","none"),S.select("rect.catrect").attr("fill","none").attr("width",function(r){return r.width}).attr("height",function(r){return r.height}),k(E),(L=S.selectAll("rect.bandrect").data(function(r){return r.bands},d)).each(function(){c.raiseToTop(this)}),L.attr("fill",function(r){return r.color}),D=L.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(r){return r.color}).attr("fill-opacity",0),L.attr("fill",function(r){return r.color}).attr("width",function(r){return r.width}).attr("height",function(r){return r.height}).attr("y",function(r){return r.y}).attr("cursor",function(r){return"fixed"===r.parcatsViewModel.arrangement?"default":"perpendicular"===r.parcatsViewModel.arrangement?"ns-resize":"move"}),A(D),L.exit().remove(),E.append("text").attr("class","catlabel").attr("pointer-events","none"),R=r._fullLayout.paper_bgcolor,S.select("text.catlabel").attr("text-anchor",function(r){return m(r)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",p.makeTextShadow(R)).style("fill","rgb(0, 0, 0)").attr("x",function(r){return m(r)?r.width+5:-5}).attr("y",function(r){return r.height/2}).text(function(r){return r.model.categoryLabel}).each(function(n){f.font(a.select(this),n.parcatsViewModel.categorylabelfont),p.convertToTspans(a.select(this),r)}),E.append("text").attr("class","dimlabel"),S.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(r){return"fixed"===r.parcatsViewModel.arrangement?"default":"ew-resize"}).attr("x",function(r){return r.width/2}).attr("y",-5).text(function(r,n){return 0===n?r.parcatsViewModel.model.dimensions[r.model.dimensionInd].dimensionLabel:null}).each(function(r){f.font(a.select(this),r.parcatsViewModel.labelfont)}),S.selectAll("rect.bandrect").on("mouseover",C).on("mouseout",P),S.exit().remove(),M.call(a.behavior.drag().origin(function(r){return{x:r.x,y:0}}).on("dragstart",I).on("drag",O).on("dragend",z)),h.each(function(r){r.traceSelection=a.select(this),r.pathSelection=a.select(this).selectAll("g.paths").selectAll("path.path"),r.dimensionSelection=a.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),h.exit().remove()}},{"../../components/drawing":388,"../../components/fx":406,"../../lib":503,"../../lib/svg_text_utils":529,"../../plot_api/plot_api":540,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:312}],887:[function(r,n,i){"use strict";var a=r("./parcats");n.exports=function(r,n,i,o){var s=r._fullLayout,l=s._paper,c=s._size;a(r,l,n,{width:c.w,height:c.h,margin:{t:c.t,r:c.r,b:c.b,l:c.l}},i,o)}},{"./parcats":886}],888:[function(r,n,i){"use strict";var a=r("../../components/colorscale/attributes"),o=r("../../plots/cartesian/layout_attributes"),s=r("../../plots/font_attributes"),l=r("../../plots/domain").attributes,c=r("../../lib/extend").extendFlat,u=r("../../plot_api/plot_template").templatedArray;n.exports={domain:l({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:s({editType:"plot"}),tickfont:s({editType:"plot"}),rangefont:s({editType:"plot"}),dimensions:u("dimension",{label:{valType:"string",editType:"plot"},tickvals:c({},o.tickvals,{editType:"plot"}),ticktext:c({},o.ticktext,{editType:"plot"}),tickformat:c({},o.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:c({editType:"calc"},a("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../plots/cartesian/layout_attributes":569,"../../plots/domain":584,"../../plots/font_attributes":585}],889:[function(r,n,i){"use strict";var a=r("./constants"),o=r("@plotly/d3"),s=r("../../lib/gup").keyFun,l=r("../../lib/gup").repeat,c=r("../../lib").sorterAsc,u=r("../../lib").strTranslate,f=a.bar.snapRatio,h=a.bar.snapClose;function p(r,n,i,a){if(function(r,n){for(var i=0;i<n.length;i++)if(r>=n[i][0]&&r<=n[i][1])return!0;return!1}(i,a))return i;var o=r?-1:1,s=0,l=n.length-1;if(o<0){var c=s;s=l,l=c}for(var u=n[s],p=u,d=s;o*d<o*l;d+=o){var m=d+o,g=n[m];if(o*i<o*(u*(1-h)+g*h))return u*(1-f)+p*f;if(o*i<o*g||m===l)return g*(1-f)+u*f;p=u,u=g}}function d(r){r.attr("x",-a.bar.captureWidth/2).attr("width",a.bar.captureWidth)}function m(r){r.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function g(r){if(!r.brush.filterSpecified)return"0,"+r.height;for(var n,i,a,o=v(r.brush.filter.getConsolidated(),r.height),s=[0],l=o.length?o[0][0]:null,c=0;c<o.length;c++)i=(n=o[c])[1]-n[0],s.push(l),s.push(i),(a=c+1)<o.length&&(l=o[a][0]-n[1]);return s.push(r.height),s}function v(r,n){return r.map(function(r){return r.map(function(r){return Math.max(0,r*n)}).sort(c)})}function y(){o.select(document.body).style("cursor",null)}function x(r){r.attr("stroke-dasharray",g)}function b(r,n){var i=o.select(r).selectAll(".highlight, .highlight-shadow");x(n?i.transition().duration(a.bar.snapDuration).each("end",n):i)}function _(r,n){var i,o=r.brush,s=NaN,l={};if(o.filterSpecified){var c=r.height,u=o.filter.getConsolidated(),f=v(u,c),h=NaN,p=NaN,d=NaN;for(i=0;i<=f.length;i++){var m=f[i];if(m&&m[0]<=n&&n<=m[1]){h=i;break}if(p=i?i-1:NaN,m&&m[0]>n){d=i;break}}if(isNaN(s=h)&&(s=isNaN(p)||isNaN(d)?isNaN(p)?d:p:n-f[p][1]<f[d][0]-n?p:d),!isNaN(s)){var g=f[s],y=function(r,n){var i=a.bar.handleHeight;if(!(n>r[1]+i||n<r[0]-i))return n>=.9*r[1]+.1*r[0]?"n":n<=.9*r[0]+.1*r[1]?"s":"ns"}(g,n);y&&(l.interval=u[s],l.intervalPix=g,l.region=y)}}if(r.ordinal&&!l.region){var x=r.unitTickvals,b=r.unitToPaddedPx.invert(n);for(i=0;i<x.length;i++){var _=[.25*x[Math.max(i-1,0)]+.75*x[i],.25*x[Math.min(i+1,x.length-1)]+.75*x[i]];if(b>=_[0]&&b<=_[1]){l.clickableOrdinalRange=_;break}}}return l}function w(r,n){o.event.sourceEvent.stopPropagation();var i=n.height-o.mouse(r)[1]-2*a.verticalPadding,s=n.brush.svgBrush;s.wasDragged=!0,s._dragging=!0,s.grabbingBar?s.newExtent=[i-s.grabPoint,i+s.barLength-s.grabPoint].map(n.unitToPaddedPx.invert):s.newExtent=[s.startExtent,n.unitToPaddedPx.invert(i)].sort(c),n.brush.filterSpecified=!0,s.extent=s.stayingIntervals.concat([s.newExtent]),s.brushCallback(n),b(r.parentNode)}function T(r,n){var i=_(n,n.height-o.mouse(r)[1]-2*a.verticalPadding),s="crosshair";i.clickableOrdinalRange?s="pointer":i.region&&(s=i.region+"-resize"),o.select(document.body).style("cursor",s)}function k(r){r.on("mousemove",function(r){o.event.preventDefault(),r.parent.inBrushDrag||T(this,r)}).on("mouseleave",function(r){r.parent.inBrushDrag||y()}).call(o.behavior.drag().on("dragstart",function(r){!function(r,n){o.event.sourceEvent.stopPropagation();var i=n.height-o.mouse(r)[1]-2*a.verticalPadding,s=n.unitToPaddedPx.invert(i),l=n.brush,c=_(n,i),u=c.interval,f=l.svgBrush;if(f.wasDragged=!1,f.grabbingBar="ns"===c.region,f.grabbingBar){var h=u.map(n.unitToPaddedPx);f.grabPoint=i-h[0]-a.verticalPadding,f.barLength=h[1]-h[0]}f.clickableOrdinalRange=c.clickableOrdinalRange,f.stayingIntervals=n.multiselect&&l.filterSpecified?l.filter.getConsolidated():[],u&&(f.stayingIntervals=f.stayingIntervals.filter(function(r){return r[0]!==u[0]&&r[1]!==u[1]})),f.startExtent=c.region?u["s"===c.region?1:0]:s,n.parent.inBrushDrag=!0,f.brushStartCallback()}(this,r)}).on("drag",function(r){w(this,r)}).on("dragend",function(r){!function(r,n){var i=n.brush,a=i.filter,s=i.svgBrush;s._dragging||(T(r,n),w(r,n),n.brush.svgBrush.wasDragged=!1),s._dragging=!1,o.event.sourceEvent.stopPropagation();var l=s.grabbingBar;if(s.grabbingBar=!1,s.grabLocation=void 0,n.parent.inBrushDrag=!1,y(),!s.wasDragged)return s.wasDragged=void 0,s.clickableOrdinalRange?i.filterSpecified&&n.multiselect?s.extent.push(s.clickableOrdinalRange):(s.extent=[s.clickableOrdinalRange],i.filterSpecified=!0):l?(s.extent=s.stayingIntervals,0===s.extent.length&&M(i)):M(i),s.brushCallback(n),b(r.parentNode),void s.brushEndCallback(i.filterSpecified?a.getConsolidated():[]);var c=function(){a.set(a.getConsolidated())};if(n.ordinal){var u=n.unitTickvals;u[u.length-1]<u[0]&&u.reverse(),s.newExtent=[p(0,u,s.newExtent[0],s.stayingIntervals),p(1,u,s.newExtent[1],s.stayingIntervals)];var f=s.newExtent[1]>s.newExtent[0];s.extent=s.stayingIntervals.concat(f?[s.newExtent]:[]),s.extent.length||M(i),s.brushCallback(n),f?b(r.parentNode,c):(c(),b(r.parentNode))}else c();s.brushEndCallback(i.filterSpecified?a.getConsolidated():[])}(this,r)}))}function A(r,n){return r[0]-n[0]}function M(r){r.filterSpecified=!1,r.svgBrush.extent=[[-1/0,1/0]]}function S(r){for(var n,i=r.slice(),a=[],o=i.shift();o;){for(n=o.slice();(o=i.shift())&&o[0]<=n[1];)n[1]=Math.max(n[1],o[1]);a.push(n)}return 1===a.length&&a[0][0]>a[0][1]&&(a=[]),a}n.exports={makeBrush:function(r,n,i,a,o,s){var l,u,f,h=(f=[],{set:function(r){1===(f=r.map(function(r){return r.slice().sort(c)}).sort(A)).length&&f[0][0]===-1/0&&f[0][1]===1/0&&(f=[[0,-1]]),l=S(f),u=f.reduce(function(r,n){return[Math.min(r[0],n[0]),Math.max(r[1],n[1])]},[1/0,-1/0])},get:function(){return f.slice()},getConsolidated:function(){return l},getBounds:function(){return u}});return h.set(i),{filter:h,filterSpecified:n,svgBrush:{extent:[],brushStartCallback:a,brushCallback:function(r){var n=r.brush,i=n.svgBrush.extent.map(function(r){return r.slice()}).slice();n.filter.set(i),o()},brushEndCallback:s}}},ensureAxisBrush:function(r,n){var i,o,c,f=r.selectAll("."+a.cn.axisBrush).data(l,s);f.enter().append("g").classed(a.cn.axisBrush,!0),(i=f.selectAll(".background").data(l)).enter().append("rect").classed("background",!0).call(d).call(m).style("pointer-events","auto").attr("transform",u(0,a.verticalPadding)),i.call(k).attr("height",function(r){return r.height-a.verticalPadding}),(o=f.selectAll(".highlight-shadow").data(l)).enter().append("line").classed("highlight-shadow",!0).attr("x",-a.bar.width/2).attr("stroke-width",a.bar.width+a.bar.strokeWidth).attr("stroke",n).attr("opacity",a.bar.strokeOpacity).attr("stroke-linecap","butt"),o.attr("y1",function(r){return r.height}).call(x),(c=f.selectAll(".highlight").data(l)).enter().append("line").classed("highlight",!0).attr("x",-a.bar.width/2).attr("stroke-width",a.bar.width-a.bar.strokeWidth).attr("stroke",a.bar.fillColor).attr("opacity",a.bar.fillOpacity).attr("stroke-linecap","butt"),c.attr("y1",function(r){return r.height}).call(x)},cleanRanges:function(r,n){if(Array.isArray(r[0])?(r=r.map(function(r){return r.sort(c)}),r=n.multiselect?S(r.sort(A)):[r[0]]):r=[r.sort(c)],n.tickvals){var i=n.tickvals.slice().sort(c);if(!(r=r.map(function(r){var n=[p(0,i,r[0],[]),p(1,i,r[1],[])];if(n[1]>n[0])return n}).filter(function(r){return r})).length)return}return r.length>1?r:r[0]}}},{"../../lib":503,"../../lib/gup":500,"./constants":892,"@plotly/d3":58}],890:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../plots/get_data").getModuleCalcData,s=r("./plot"),l=r("../../constants/xmlns_namespaces");i.name="parcoords",i.plot=function(r){var n=o(r.calcdata,"parcoords")[0];n.length&&s(r,n)},i.clean=function(r,n,i,a){var o=a._has&&a._has("parcoords"),s=n._has&&n._has("parcoords");o&&!s&&(a._paperdiv.selectAll(".parcoords").remove(),a._glimages.selectAll("*").remove())},i.toSVG=function(r){var n=r._fullLayout._glimages,i=a.select(r).selectAll(".svg-container");i.filter(function(r,n){return n===i.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var r=this.toDataURL("image/png");n.append("svg:image").attr({xmlns:l.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){a.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":480,"../../plots/get_data":593,"./plot":899,"@plotly/d3":58}],891:[function(r,n,i){"use strict";var a=r("../../lib").isArrayOrTypedArray,o=r("../../components/colorscale"),s=r("../../lib/gup").wrap;n.exports=function(r,n){var i,l;return o.hasColorscale(n,"line")&&a(n.line.color)?(i=n.line.color,l=o.extractOpts(n.line).colorscale,o.calc(r,n,{vals:i,containerStr:"line",cLetter:"c"})):(i=function(r){for(var n=Array(r),i=0;i<r;i++)n[i]=.5;return n}(n._length),l=[[0,n.line.color],[1,n.line.color]]),s({lineColor:i,cscale:l})}},{"../../components/colorscale":378,"../../lib":503,"../../lib/gup":500}],892:[function(r,n,i){"use strict";n.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],893:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/colorscale/helpers").hasColorscale,s=r("../../components/colorscale/defaults"),l=r("../../plots/domain").defaults,c=r("../../plots/array_container_defaults"),u=r("../../plots/cartesian/axes"),f=r("./attributes"),h=r("./axisbrush"),p=r("./constants").maxDimensionCount,d=r("./merge_length");function m(r,n,i,o){function s(i,o){return a.coerce(r,n,f.dimensions,i,o)}var l=s("values"),c=s("visible");if(l&&l.length||(c=n.visible=!1),c){s("label"),s("tickvals"),s("ticktext"),s("tickformat");var p=s("range");n._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:p},u.setConvert(n._ax,o.layout),s("multiselect");var d=s("constraintrange");d&&(n.constraintrange=h.cleanRanges(d,n))}}n.exports=function(r,n,i,u){function h(i,o){return a.coerce(r,n,f,i,o)}var g=r.dimensions;Array.isArray(g)&&g.length>p&&(a.log("parcoords traces support up to "+p+" dimensions at the moment"),g.splice(p));var v=c(r,n,{name:"dimensions",layout:u,handleItemDefaults:m}),y=function(r,n,i,l,c){var u=c("line.color",i);if(o(r,"line")&&a.isArrayOrTypedArray(u)){if(u.length)return c("line.colorscale"),s(r,n,l,c,{prefix:"line.",cLetter:"c"}),u.length;n.line.color=i}return 1/0}(r,n,i,u,h);l(n,u,h),Array.isArray(v)&&v.length||(n.visible=!1),d(n,v,"values",y);var x={family:u.font.family,size:Math.round(u.font.size/1.2),color:u.font.color};a.coerceFont(h,"labelfont",x),a.coerceFont(h,"tickfont",x),a.coerceFont(h,"rangefont",x),h("labelangle"),h("labelside")}},{"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"../../plots/domain":584,"./attributes":888,"./axisbrush":889,"./constants":892,"./merge_length":897}],894:[function(r,n,i){"use strict";var a=r("../../lib").isTypedArray;i.convertTypedArray=function(r){return a(r)?Array.prototype.slice.call(r):r},i.isOrdinal=function(r){return!!r.tickvals},i.isVisible=function(r){return r.visible||!("visible"in r)}},{"../../lib":503}],895:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:r("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":888,"./base_plot":890,"./calc":891,"./defaults":893,"./plot":899}],896:[function(r,n,i){"use strict";var a=r("glslify"),o=a(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\nuniform sampler2D maskTexture, palette;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(maskTexture,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]),s=a(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),l=r("./constants").maxDimensionCount,c=r("../../lib"),u=new Uint8Array(4),f=new Uint8Array(4),h={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function p(r,n,i,a,o){var s=r._gl;s.enable(s.SCISSOR_TEST),s.scissor(n,i,a,o),r.clear({color:[0,0,0,0],depth:1})}function d(r,n){return(r>>>8*n)%256/255}function m(r){var n="0"+r;return n.substr(n.length-2)}function g(r){return r<l?"p"+m(r+1)+"_"+m(r+4):"colors"}function v(r){var n=Math.max(0,Math.floor(2047*r[0]),0),i=Math.min(2047,Math.ceil(2047*r[1]),2047);return[Math.min(n,i),Math.max(n,i)]}n.exports=function(r,n){var i,a,m,y,x=n.context,b=n.pick,_=n.regl,w=_._gl,T=w.getParameter(w.ALIASED_LINE_WIDTH_RANGE),k=Math.max(T[0],Math.min(T[1],n.viewModel.plotGlPixelRatio)),A={currentRafs:{},drawCompleted:!0,clearOnly:!1},M=function(r){for(var n={},i=0;i<=l;i+=4)n[g(i)]=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return n}(_),S=_.texture(h),E=[];C(n);var L=_({profile:!1,blend:{enable:x,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!x,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:_.prop("scissorX"),y:_.prop("scissorY"),width:_.prop("scissorWidth"),height:_.prop("scissorHeight")}},viewport:{x:_.prop("viewportX"),y:_.prop("viewportY"),width:_.prop("viewportWidth"),height:_.prop("viewportHeight")},dither:!1,vert:o,frag:s,primitive:"lines",lineWidth:k,attributes:M,uniforms:{resolution:_.prop("resolution"),viewBoxPos:_.prop("viewBoxPos"),viewBoxSize:_.prop("viewBoxSize"),dim0A:_.prop("dim0A"),dim1A:_.prop("dim1A"),dim0B:_.prop("dim0B"),dim1B:_.prop("dim1B"),dim0C:_.prop("dim0C"),dim1C:_.prop("dim1C"),dim0D:_.prop("dim0D"),dim1D:_.prop("dim1D"),loA:_.prop("loA"),hiA:_.prop("hiA"),loB:_.prop("loB"),hiB:_.prop("hiB"),loC:_.prop("loC"),hiC:_.prop("hiC"),loD:_.prop("loD"),hiD:_.prop("hiD"),palette:S,contextColor:_.prop("contextColor"),maskTexture:_.prop("maskTexture"),drwLayer:_.prop("drwLayer"),maskHeight:_.prop("maskHeight")},offset:_.prop("offset"),count:_.prop("count")});function C(r){i=r.model,m=(a=r.viewModel.dimensions.slice())[0]?a[0].values.length:0;var n=i.lines,o=b?n.color.map(function(r,i){return i/n.color.length}):n.color,s=function(r,n,i){for(var a=Array(r*(l+4)),o=0,s=0;s<r;s++){for(var c=0;c<l;c++)a[o++]=c<n.length?n[c].paddedUnitValues[s]:.5;a[o++]=d(s,2),a[o++]=d(s,1),a[o++]=d(s,0),a[o++]=Math.max(1e-6,Math.min(.999999,i[s]))}return a}(m,a,o);(function(r,n,i){for(var a=0;a<=l;a+=4)r[g(a)](function(r,n,i){for(var a=Array(8*n),o=0,s=0;s<n;s++)for(var l=0;l<2;l++)for(var c=0;c<4;c++){var u=4*r+c,f=i[64*s+u];63===u&&0===l&&(f*=-1),a[o++]=f}return a}(a/4,n,i))})(M,m,s),x||b||(S=_.texture(c.extendFlat({data:function(r,n){for(var i=Array(256),a=0;a<256;a++)i[a]=r(a/255).concat(255);return i}(i.unitToColor,0)},h)))}return{render:function(r,n,o){var s,l,f,h=r.length,d=1/0,g=-1/0;for(s=0;s<h;s++)r[s].dim0.canvasX<d&&(d=r[s].dim0.canvasX,l=s),r[s].dim1.canvasX>g&&(g=r[s].dim1.canvasX,f=s);0===h&&p(_,0,0,i.canvasWidth,i.canvasHeight);var w=function(r){var n,i,o,s=[[],[]];for(o=0;o<64;o++){var l=!r&&o<a.length?a[o].brush.filter.getBounds():[-1/0,1/0];s[0][o]=l[0],s[1][o]=l[1]}var c=Array(16384);for(n=0;n<16384;n++)c[n]=255;if(!r)for(n=0;n<a.length;n++){var u=n%8,f=(n-u)/8,h=Math.pow(2,u),p=a[n].brush.filter.get();if(!(p.length<2)){var d=v(p[0])[1];for(i=1;i<p.length;i++){var m=v(p[i]);for(o=d+1;o<m[0];o++)c[8*o+f]&=~h;d=Math.max(d,m[1])}}}var g={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:c};return y?y(g):y=_.texture(g),{maskTexture:y,maskHeight:2048,loA:s[0].slice(0,16),loB:s[0].slice(16,32),loC:s[0].slice(32,48),loD:s[0].slice(48,64),hiA:s[1].slice(0,16),hiB:s[1].slice(16,32),hiC:s[1].slice(32,48),hiD:s[1].slice(48,64)}}(x);for(s=0;s<h;s++){var T=r[s],k=T.dim0.crossfilterDimensionIndex,M=T.dim1.crossfilterDimensionIndex,S=T.canvasX,C=T.canvasY,P=S+T.panelSizeX,I=T.plotGlPixelRatio;if(n||!E[k]||E[k][0]!==S||E[k][1]!==P){E[k]=[S,P];var O=function(r,n,i,a,o,s,l,u,f,h,p,d,m,g){for(var v=[[],[]],y=0;y<64;y++)v[0][y]=y===o?1:0,v[1][y]=y===s?1:0;l*=g,u*=g,f*=g,h*=g;var x=r.lines.canvasOverdrag*g,b=r.domain,_=r.canvasWidth*g,w=r.canvasHeight*g,T=r.pad.l*g,k=r.pad.b*g,A=r.layoutHeight*g,M=r.layoutWidth*g,S=r.deselectedLines.color;return c.extendFlat({key:p,resolution:[_,w],viewBoxPos:[l+x,u],viewBoxSize:[f,h],i0:o,i1:s,dim0A:v[0].slice(0,16),dim0B:v[0].slice(16,32),dim0C:v[0].slice(32,48),dim0D:v[0].slice(48,64),dim1A:v[1].slice(0,16),dim1B:v[1].slice(16,32),dim1C:v[1].slice(32,48),dim1D:v[1].slice(48,64),drwLayer:d,contextColor:[S[0]/255,S[1]/255,S[2]/255,S[3]<1?S[3]:Math.max(1/255,Math.pow(1/r.lines.color.length,1/3))],scissorX:(a===n?0:l+x)+(T-x)+M*b.x[0],scissorWidth:(a===i?_-l+x:f+.5)+(a===n?l+x:0),scissorY:u+k+A*b.y[0],scissorHeight:h,viewportX:T-x+M*b.x[0],viewportY:k+A*b.y[0],viewportWidth:_,viewportHeight:w},m)}(i,l,f,s,k,M,S,C,T.panelSizeX,T.panelSizeY,T.dim0.crossfilterDimensionIndex,x?0:b?2:1,w,I);A.clearOnly=o,function(r,n,i,a,o,s){var l=s.key;i.drawCompleted||(function(r){r.read({x:0,y:0,width:1,height:1,data:u})}(r),i.drawCompleted=!0),function c(u){var f=Math.min(a,o-u*a);0===u&&(window.cancelAnimationFrame(i.currentRafs[l]),delete i.currentRafs[l],p(r,s.scissorX,s.scissorY,s.scissorWidth,s.viewBoxSize[1])),i.clearOnly||(s.count=2*f,s.offset=2*u*a,n(s),u*a+f<o&&(i.currentRafs[l]=window.requestAnimationFrame(function(){c(u+1)})),i.drawCompleted=!1)}(0)}(_,L,A,n?i.lines.blockLineCount:m,m,O)}}},readPixel:function(r,n){return _.read({x:r,y:n,width:1,height:1,data:f}),f},readPixels:function(r,n,i,a){var o=new Uint8Array(4*i*a);return _.read({x:r,y:n,width:i,height:a,data:o}),o},destroy:function(){for(var n in r.style["pointer-events"]="none",S.destroy(),y&&y.destroy(),M)M[n].destroy()},update:C}}},{"../../lib":503,"./constants":892,glslify:227}],897:[function(r,n,i){"use strict";n.exports=function(r,n,i,a){var o,s;for(a||(a=1/0),o=0;o<n.length;o++)(s=n[o]).visible&&(a=Math.min(a,s[i].length));for(a===1/0&&(a=0),r._length=a,o=0;o<n.length;o++)(s=n[o]).visible&&(s._length=a);return a}},{}],898:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=o.numberFormat,l=r("color-rgba"),c=r("../../plots/cartesian/axes"),u=o.strRotate,f=o.strTranslate,h=r("../../lib/svg_text_utils"),p=r("../../components/drawing"),d=r("../../components/colorscale"),m=r("../../lib/gup"),g=m.keyFun,v=m.repeat,y=m.unwrap,x=r("./helpers"),b=r("./constants"),_=r("./axisbrush"),w=r("./lines");function T(r,n,i){return o.aggNums(r,null,n,i)}function k(r,n){return M(T(Math.min,r,n),T(Math.max,r,n))}function A(r){var n=r.range;return n?M(n[0],n[1]):k(r.values,r._length)}function M(r,n){return!isNaN(r)&&isFinite(r)||(r=0),!isNaN(n)&&isFinite(n)||(n=0),r===n&&(0===r?(r-=1,n+=1):(r*=.9,n*=1.1)),[r,n]}function S(r){return r.dimensions.some(function(r){return r.brush.filterSpecified})}function E(r,n,i){var s,c,u,f=y(n),h=f.trace,p=x.convertTypedArray(f.lineColor),m=h.line,g={color:l(b.deselectedLineColor)},v=d.extractOpts(m),_=v.reversescale?d.flipScale(f.cscale):f.cscale,w=h.domain,T=h.dimensions,k=r.width,M=h.labelangle,S=h.labelside,E=h.labelfont,L=h.tickfont,C=h.rangefont,P=o.extendDeepNoArrays({},m,{color:p.map(a.scale.linear().domain(A({values:p,range:[v.min,v.max],_length:h._length}))),blockLineCount:b.blockLineCount,canvasOverdrag:b.overdrag*b.canvasPixelRatio}),I=Math.floor(k*(w.x[1]-w.x[0])),O=Math.floor(r.height*(w.y[1]-w.y[0])),z=r.margin||{l:80,r:80,t:100,b:80};return{key:i,colCount:T.filter(x.isVisible).length,dimensions:T,tickDistance:b.tickDistance,unitToColor:(s=_.map(function(r){return r[0]}),c=_.map(function(r){var n=l(r[1]);return a.rgb("rgb("+n[0]+","+n[1]+","+n[2]+")")}),u="rgb".split("").map(function(r){return a.scale.linear().clamp(!0).domain(s).range(c.map(function(n){return n[r]}))}),function(r){return u.map(function(n){return n(r)})}),lines:P,deselectedLines:g,labelAngle:M,labelSide:S,labelFont:E,tickFont:L,rangeFont:C,layoutWidth:k,layoutHeight:r.height,domain:w,translateX:w.x[0]*k,translateY:r.height-w.y[1]*r.height,pad:z,canvasWidth:I*b.canvasPixelRatio+2*P.canvasOverdrag,canvasHeight:O*b.canvasPixelRatio,width:I,height:O,canvasPixelRatio:b.canvasPixelRatio}}function L(r,n,i){var l,c=i.width,u=i.height,f=i.dimensions,h=i.canvasPixelRatio,p=function(r){return c*r/Math.max(1,i.colCount-1)},d=b.verticalPadding/u,m=(l=b.verticalPadding,a.scale.linear().range([l,u-l])),g={key:i.key,xScale:p,model:i,inBrushDrag:!1},v={};return g.dimensions=f.filter(x.isVisible).map(function(l,c){var f,y,w,T,k,M=a.scale.linear().domain(A(l)).range([d,1-d]),E=v[l.label];v[l.label]=(E||0)+1;var L=l.label+(E?"__"+E:""),C=l.constraintrange,P=C&&C.length;P&&!Array.isArray(C[0])&&(C=[C]);var I=P?C.map(function(r){return r.map(M)}):[[-1/0,1/0]],O=l.values;O.length>l._length&&(O=O.slice(0,l._length));var z,D=l.tickvals;function R(r,n){return{val:r,text:z[n]}}function F(r,n){return r.val-n.val}if(Array.isArray(D)&&D.length){Array.isArray(z=l.ticktext)&&z.length?z.length>D.length?z=z.slice(0,D.length):D.length>z.length&&(D=D.slice(0,z.length)):z=D.map(s(l.tickformat));for(var B=1;B<D.length;B++)if(D[B]<D[B-1]){for(var N=D.map(R).sort(F),j=0;j<D.length;j++)D[j]=N[j].val,z[j]=N[j].text;break}}else D=void 0;return O=x.convertTypedArray(O),{key:L,label:l.label,tickFormat:l.tickformat,tickvals:D,ticktext:z,ordinal:x.isOrdinal(l),multiselect:l.multiselect,xIndex:c,crossfilterDimensionIndex:c,visibleIndex:l._index,height:u,values:O,paddedUnitValues:O.map(M),unitTickvals:D&&D.map(M),xScale:p,x:p(c),canvasX:p(c)*h,unitToPaddedPx:m,domainScale:(f=b.verticalPadding,y=D,w=z,k=A(l),y?a.scale.ordinal().domain(y.map((T=s(l.tickformat),w?function(r,n){var i=w[n];return null==i?T(r):i}:T))).range(y.map(function(r){return u-f+(r-k[0])/(k[1]-k[0])*(2*f-u)})):a.scale.linear().domain(k).range([u-f,f])),ordinalScale:function(r){if(r.tickvals){var n=A(r);return a.scale.ordinal().domain(r.tickvals).range(r.tickvals.map(function(r){return(r-n[0])/(n[1]-n[0])}))}}(l),parent:g,model:i,brush:_.makeBrush(r,P,I,function(){r.linePickActive(!1)},function(){g.focusLayer&&g.focusLayer.render(g.panels,!0);var n=S(g);!r.contextShown()&&n?(g.contextLayer&&g.contextLayer.render(g.panels,!0),r.contextShown(!0)):r.contextShown()&&!n&&(g.contextLayer&&g.contextLayer.render(g.panels,!0,!0),r.contextShown(!1))},function(i){if(g.focusLayer.render(g.panels,!0),g.pickLayer&&g.pickLayer.render(g.panels,!0),r.linePickActive(!0),n&&n.filterChanged){var a=M.invert,s=i.map(function(r){return r.map(a).sort(o.sorterAsc)}).sort(function(r,n){return r[0]-n[0]});n.filterChanged(g.key,l._index,s)}})}}),g}function C(r){r.classed(b.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function P(r,n){var i=r*Math.PI/180;return{dir:"top"===n?1:-1,dx:Math.sin(i),dy:Math.cos(i),degrees:r}}function I(r,n,i){for(var a=n.panels||(n.panels=[]),o=r.data(),s=0;s<o.length-1;s++){var l=a[s]||(a[s]={}),c=o[s],u=o[s+1];l.dim0=c,l.dim1=u,l.canvasX=c.canvasX,l.panelSizeX=u.canvasX-c.canvasX,l.panelSizeY=n.model.canvasHeight,l.y=0,l.canvasY=0,l.plotGlPixelRatio=i}}function O(r,n){return c.tickText(r._ax,n,!1).text}function z(r,n){if(r.ordinal)return"";var i=r.domainScale.domain(),a=i[n?i.length-1:0];return O(r.model.dimensions[r.visibleIndex],a)}n.exports=function(r,n,i,s){var l=r._fullLayout,d=l._toppaper,m=l._glcontainer,T=r._context.plotGlPixelRatio,A=r._fullLayout.paper_bgcolor;!function(r){for(var n=0;n<r.length;n++)for(var i=0;i<r[n].length;i++)for(var a=r[n][i].trace,o=a.dimensions,s=0;s<o.length;s++){var l=o[s].values,u=o[s]._ax;u&&(u.range?u.range=M(u.range[0],u.range[1]):u.range=k(l,a._length),u.dtick||(u.dtick=.01*(Math.abs(u.range[1]-u.range[0])||1)),u.tickformat=o[s].tickformat,c.calcTicks(u),u.cleanRange())}}(n);var D,R,F=(D=!0,R=!1,{linePickActive:function(r){return arguments.length?D=!!r:D},contextShown:function(r){return arguments.length?R=!!r:R}}),B=n.filter(function(r){return y(r).trace.visible}).map(E.bind(0,i)).map(L.bind(0,F,s));m.each(function(r,n){return o.extendFlat(r,B[n])});var N=m.selectAll(".gl-canvas").each(function(r){r.viewModel=B[0],r.viewModel.plotGlPixelRatio=T,r.viewModel.paperColor=A,r.model=r.viewModel?r.viewModel.model:null}),j=null;N.filter(function(r){return r.pick}).style("pointer-events","auto").on("mousemove",function(r){if(F.linePickActive()&&r.lineLayer&&s&&s.hover){var n=a.event,i=this.width,o=this.height,l=a.mouse(this),c=l[0],u=l[1];if(!(c<0)&&!(u<0)&&!(c>=i)&&!(u>=o)){var f=r.lineLayer.readPixel(c,o-1-u),h=0!==f[3],p=h?f[2]+256*(f[1]+256*f[0]):null,d={x:c,y:u,clientX:n.clientX,clientY:n.clientY,dataIndex:r.model.key,curveNumber:p};p!==j&&(h?s.hover(d):s.unhover&&s.unhover(d),j=p)}}}),N.style("opacity",function(r){return r.pick?0:1}),d.style("background","rgba(255, 255, 255, 0)");var U=d.selectAll("."+b.cn.parcoords).data(B,g);U.exit().remove(),U.enter().append("g").classed(b.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),U.attr("transform",function(r){return f(r.model.translateX,r.model.translateY)});var V=U.selectAll("."+b.cn.parcoordsControlView).data(v,g);V.enter().append("g").classed(b.cn.parcoordsControlView,!0),V.attr("transform",function(r){return f(r.model.pad.l,r.model.pad.t)});var H=V.selectAll("."+b.cn.yAxis).data(function(r){return r.dimensions},g);H.enter().append("g").classed(b.cn.yAxis,!0),V.each(function(r){I(H,r,T)}),N.each(function(r){if(r.viewModel){!r.lineLayer||s?r.lineLayer=w(this,r):r.lineLayer.update(r),(r.key||0===r.key)&&(r.viewModel[r.key]=r.lineLayer);var n=!r.context||s;r.lineLayer.render(r.viewModel.panels,n)}}),H.attr("transform",function(r){return f(r.xScale(r.xIndex),0)}),H.call(a.behavior.drag().origin(function(r){return r}).on("drag",function(r){var n=r.parent;F.linePickActive(!1),r.x=Math.max(-b.overdrag,Math.min(r.model.width+b.overdrag,a.event.x)),r.canvasX=r.x*r.model.canvasPixelRatio,H.sort(function(r,n){return r.x-n.x}).each(function(n,i){n.xIndex=i,n.x=r===n?n.x:n.xScale(n.xIndex),n.canvasX=n.x*n.model.canvasPixelRatio}),I(H,n,T),H.filter(function(n){return 0!==Math.abs(r.xIndex-n.xIndex)}).attr("transform",function(r){return f(r.xScale(r.xIndex),0)}),a.select(this).attr("transform",f(r.x,0)),H.each(function(i,a,o){o===r.parent.key&&(n.dimensions[a]=i)}),n.contextLayer&&n.contextLayer.render(n.panels,!1,!S(n)),n.focusLayer.render&&n.focusLayer.render(n.panels)}).on("dragend",function(r){var n=r.parent;r.x=r.xScale(r.xIndex),r.canvasX=r.x*r.model.canvasPixelRatio,I(H,n,T),a.select(this).attr("transform",function(r){return f(r.x,0)}),n.contextLayer&&n.contextLayer.render(n.panels,!1,!S(n)),n.focusLayer&&n.focusLayer.render(n.panels),n.pickLayer&&n.pickLayer.render(n.panels,!0),F.linePickActive(!0),s&&s.axesMoved&&s.axesMoved(n.key,n.dimensions.map(function(r){return r.crossfilterDimensionIndex}))})),H.exit().remove();var q=H.selectAll("."+b.cn.axisOverlays).data(v,g);q.enter().append("g").classed(b.cn.axisOverlays,!0),q.selectAll("."+b.cn.axis).remove();var G=q.selectAll("."+b.cn.axis).data(v,g);G.enter().append("g").classed(b.cn.axis,!0),G.each(function(r){var n=r.model.height/r.model.tickDistance,i=r.domainScale,o=i.domain();a.select(this).call(a.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(n,r.tickFormat).tickValues(r.ordinal?o:null).tickFormat(function(n){return x.isOrdinal(r)?n:O(r.model.dimensions[r.visibleIndex],n)}).scale(i)),p.font(G.selectAll("text"),r.model.tickFont)}),G.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),G.selectAll("text").style("text-shadow",h.makeTextShadow(A)).style("cursor","default");var Y=q.selectAll("."+b.cn.axisHeading).data(v,g);Y.enter().append("g").classed(b.cn.axisHeading,!0);var W=Y.selectAll("."+b.cn.axisTitle).data(v,g);W.enter().append("text").classed(b.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),W.text(function(r){return r.label}).each(function(n){var i=a.select(this);p.font(i,n.model.labelFont),h.convertToTspans(i,r)}).attr("transform",function(r){var n=P(r.model.labelAngle,r.model.labelSide),i=b.axisTitleOffset;return(n.dir>0?"":f(0,2*i+r.model.height))+u(n.degrees)+f(-i*n.dx,-i*n.dy)}).attr("text-anchor",function(r){var n=P(r.model.labelAngle,r.model.labelSide);return 2*Math.abs(n.dx)>Math.abs(n.dy)?n.dir*n.dx<0?"start":"end":"middle"});var X=q.selectAll("."+b.cn.axisExtent).data(v,g);X.enter().append("g").classed(b.cn.axisExtent,!0);var Z=X.selectAll("."+b.cn.axisExtentTop).data(v,g);Z.enter().append("g").classed(b.cn.axisExtentTop,!0),Z.attr("transform",f(0,-b.axisExtentOffset));var J=Z.selectAll("."+b.cn.axisExtentTopText).data(v,g);J.enter().append("text").classed(b.cn.axisExtentTopText,!0).call(C),J.text(function(r){return z(r,!0)}).each(function(r){p.font(a.select(this),r.model.rangeFont)});var K=X.selectAll("."+b.cn.axisExtentBottom).data(v,g);K.enter().append("g").classed(b.cn.axisExtentBottom,!0),K.attr("transform",function(r){return f(0,r.model.height+b.axisExtentOffset)});var Q=K.selectAll("."+b.cn.axisExtentBottomText).data(v,g);Q.enter().append("text").classed(b.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(C),Q.text(function(r){return z(r,!1)}).each(function(r){p.font(a.select(this),r.model.rangeFont)}),_.ensureAxisBrush(q,A)}},{"../../components/colorscale":378,"../../components/drawing":388,"../../lib":503,"../../lib/gup":500,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"./axisbrush":889,"./constants":892,"./helpers":894,"./lines":896,"@plotly/d3":58,"color-rgba":91}],899:[function(r,n,i){"use strict";var a=r("./parcoords"),o=r("../../lib/prepare_regl"),s=r("./helpers").isVisible;function l(r,n,i){var a=n.indexOf(i),o=r.indexOf(a);return -1===o&&(o+=n.length),o}n.exports=function(r,n){var i=r._fullLayout;if(o(r)){var c={},u={},f={},h={},p=i._size;n.forEach(function(n,i){var a=n[0].trace;f[i]=a.index;var o=h[i]=a._fullInput.index;c[i]=r.data[o].dimensions,u[i]=r.data[o].dimensions.slice()}),a(r,n,{width:p.w,height:p.h,margin:{t:p.t,r:p.r,b:p.b,l:p.l}},{filterChanged:function(n,a,o){var s=u[n][a],l=o.map(function(r){return r.slice()}),c="dimensions["+a+"].constraintrange",p=i._tracePreGUI[r._fullData[f[n]]._fullInput.uid];if(void 0===p[c]){var d=s.constraintrange;p[c]=d||null}var m=r._fullData[f[n]].dimensions[a];l.length?(1===l.length&&(l=l[0]),s.constraintrange=l,m.constraintrange=l.slice(),l=[l]):(delete s.constraintrange,delete m.constraintrange,l=null);var g={};g[c]=l,r.emit("plotly_restyle",[g,[h[n]]])},hover:function(n){r.emit("plotly_hover",n)},unhover:function(n){r.emit("plotly_unhover",n)},axesMoved:function(n,i){var a,o=(a=u[n].filter(s),function(r,n){return l(i,a,r)-l(i,a,n)});c[n].sort(o),u[n].filter(function(r){return!s(r)}).sort(function(r){return u[n].indexOf(r)}).forEach(function(r){c[n].splice(c[n].indexOf(r),1),c[n].splice(u[n].indexOf(r),0,r)}),r.emit("plotly_restyle",[{dimensions:[c[n]]},[h[n]]])}})}}},{"../../lib/prepare_regl":516,"./helpers":894,"./parcoords":898}],900:[function(r,n,i){"use strict";var a=r("../../plots/attributes"),o=r("../../plots/domain").attributes,s=r("../../plots/font_attributes"),l=r("../../components/color/attributes"),c=r("../../plots/template_attributes").hovertemplateAttrs,u=r("../../plots/template_attributes").texttemplateAttrs,f=r("../../lib/extend").extendFlat,h=s({editType:"plot",arrayOk:!0,colorEditType:"plot"});n.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:l.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:f({},a.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:c({},{keys:["label","color","value","percent","text"]}),texttemplate:u({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:f({},h,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:f({},h,{}),outsidetextfont:f({},h,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:f({},h,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:o({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:f({},h,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":365,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/font_attributes":585,"../../plots/template_attributes":633}],901:[function(r,n,i){"use strict";var a=r("../../plots/plots");i.name="pie",i.plot=function(r,n,o,s){a.plotBasePlot(i.name,r,n,o,s)},i.clean=function(r,n,o,s){a.cleanBasePlot(i.name,r,n,o,s)}},{"../../plots/plots":619}],902:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("tinycolor2"),s=r("../../components/color"),l={};function c(r){return function(n,i){return!!n&&!!(n=o(n)).isValid()&&(n=s.addOpacity(n,n.getAlpha()),r[i]||(r[i]=n),n)}}function u(r,n){var i,a=JSON.stringify(r),s=n[a];if(!s){for(s=r.slice(),i=0;i<r.length;i++)s.push(o(r[i]).lighten(20).toHexString());for(i=0;i<r.length;i++)s.push(o(r[i]).darken(20).toHexString());n[a]=s}return s}n.exports={calc:function(r,n){var i,o,s=[],l=r._fullLayout,u=l.hiddenlabels||[],f=n.labels,h=n.marker.colors||[],p=n.values,d=n._length,m=n._hasValues&&d;if(n.dlabel)for(f=Array(d),i=0;i<d;i++)f[i]=String(n.label0+i*n.dlabel);var g={},v=c(l["_"+n.type+"colormap"]),y=0,x=!1;for(i=0;i<d;i++){if(m){if(!a(b=p[i]))continue;b=+b}else b=1;void 0!==(_=f[i])&&""!==_||(_=i);var b,_,w,T=g[_=String(_)];void 0===T?(g[_]=s.length,(w=-1!==u.indexOf(_))||(y+=b),s.push({v:b,label:_,color:v(h[i],_),i:i,pts:[i],hidden:w})):(x=!0,(o=s[T]).v+=b,o.pts.push(i),o.hidden||(y+=b),!1===o.color&&h[i]&&(o.color=v(h[i],_)))}return s=s.filter(function(r){return r.v>=0}),("funnelarea"===n.type?x:n.sort)&&s.sort(function(r,n){return n.v-r.v}),s[0]&&(s[0].vTotal=y),s},crossTraceCalc:function(r,n){var i=(n||{}).type;i||(i="pie");var a=r._fullLayout,o=r.calcdata,s=a[i+"colorway"],c=a["_"+i+"colormap"];a["extend"+i+"colors"]&&(s=u(s,l));for(var f=0,h=0;h<o.length;h++){var p=o[h];if(p[0].trace.type===i)for(var d=0;d<p.length;d++){var m=p[d];!1===m.color&&(c[m.label]?m.color=c[m.label]:(c[m.label]=m.color=s[f%s.length],f++))}}},makePullColorFn:c,generateExtendedColors:u}},{"../../components/color":366,"fast-isnumeric":190,tinycolor2:312}],903:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("./attributes"),l=r("../../plots/domain").defaults,c=r("../bar/defaults").handleText;function u(r,n){var i=Array.isArray(r),s=o.isArrayOrTypedArray(n),l=Math.min(i?r.length:1/0,s?n.length:1/0);if(isFinite(l)||(l=0),l&&s){for(var c,u=0;u<l;u++){var f=n[u];if(a(f)&&f>0){c=!0;break}}c||(l=0)}return{hasLabels:i,hasValues:s,len:l}}n.exports={handleLabelsAndValues:u,supplyDefaults:function(r,n,i,a){function f(i,a){return o.coerce(r,n,s,i,a)}var h=u(f("labels"),f("values")),p=h.len;if(n._hasLabels=h.hasLabels,n._hasValues=h.hasValues,!n._hasLabels&&n._hasValues&&(f("label0"),f("dlabel")),p){n._length=p,f("marker.line.width")&&f("marker.line.color"),f("marker.colors"),f("scalegroup");var d,m=f("text"),g=f("texttemplate");if(g||(d=f("textinfo",Array.isArray(m)?"text+percent":"percent")),f("hovertext"),f("hovertemplate"),g||d&&"none"!==d){var v=f("textposition");c(r,n,a,f,v,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(v)||"auto"===v||"outside"===v)&&f("automargin"),("inside"===v||"auto"===v||Array.isArray(v))&&f("insidetextorientation")}l(n,a,f);var y=f("hole");if(f("title.text")){var x=f("title.position",y?"middle center":"top center");y||"middle center"!==x||(n.title.position="top center"),o.coerceFont(f,"title.font",a.font)}f("sort"),f("direction"),f("rotation"),f("pull")}else n.visible=!1}}},{"../../lib":503,"../../plots/domain":584,"../bar/defaults":652,"./attributes":900,"fast-isnumeric":190}],904:[function(r,n,i){"use strict";var a=r("../../components/fx/helpers").appendArrayMultiPointValues;n.exports=function(r,n){var i={curveNumber:n.index,pointNumbers:r.pts,data:n._input,fullData:n,label:r.label,color:r.color,value:r.v,percent:r.percent,text:r.text,bbox:r.bbox,v:r.v};return 1===r.pts.length&&(i.pointNumber=i.i=r.pts[0]),a(i,n,r.pts),"funnelarea"===n.type&&(delete i.v,delete i.i),i}},{"../../components/fx/helpers":402}],905:[function(r,n,i){"use strict";var a=r("../../lib");function o(r){return -1!==r.indexOf("e")?r.replace(/[.]?0+e/,"e"):-1!==r.indexOf(".")?r.replace(/[.]?0+$/,""):r}i.formatPiePercent=function(r,n){var i=o((100*r).toPrecision(3));return a.numSeparate(i,n)+"%"},i.formatPieValue=function(r,n){var i=o(r.toPrecision(10));return a.numSeparate(i,n)},i.getFirstFilled=function(r,n){if(Array.isArray(r))for(var i=0;i<n.length;i++){var a=r[n[i]];if(a||0===a||""===a)return a}},i.castOption=function(r,n){return Array.isArray(r)?i.getFirstFilled(r,n):r||void 0},i.getRotationAngle=function(r){return("auto"===r?0:r)*Math.PI/180}},{"../../lib":503}],906:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,supplyLayoutDefaults:r("./layout_defaults"),layoutAttributes:r("./layout_attributes"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot").plot,style:r("./style"),styleOne:r("./style_one"),moduleType:"trace",name:"pie",basePlotModule:r("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":900,"./base_plot":901,"./calc":902,"./defaults":903,"./layout_attributes":907,"./layout_defaults":908,"./plot":909,"./style":910,"./style_one":911}],907:[function(r,n,i){"use strict";n.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],908:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n){function i(i,s){return a.coerce(r,n,o,i,s)}i("hiddenlabels"),i("piecolorway",n.colorway),i("extendpiecolors")}},{"../../lib":503,"./layout_attributes":907}],909:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../plots/plots"),s=r("../../components/fx"),l=r("../../components/color"),c=r("../../components/drawing"),u=r("../../lib"),f=u.strScale,h=u.strTranslate,p=r("../../lib/svg_text_utils"),d=r("../bar/uniform_text"),m=d.recordMinTextSize,g=d.clearMinTextSize,v=r("../bar/constants").TEXTPAD,y=r("./helpers"),x=r("./event_data"),b=r("../../lib").isValidTextValue;function _(r,n,i){var o=i[0],l=o.cx,c=o.cy,f=o.trace,h="funnelarea"===f.type;"_hasHoverLabel"in f||(f._hasHoverLabel=!1),"_hasHoverEvent"in f||(f._hasHoverEvent=!1),r.on("mouseover",function(r){var i=n._fullLayout,p=n._fullData[f.index];if(!n._dragging&&!1!==i.hovermode){var d=p.hoverinfo;if(Array.isArray(d)&&(d=s.castHoverinfo({hoverinfo:[y.castOption(d,r.pts)],_module:f._module},i,0)),"all"===d&&(d="label+text+value+percent+name"),p.hovertemplate||"none"!==d&&"skip"!==d&&d){var m=r.rInscribed||0,g=l+r.pxmid[0]*(1-m),v=c+r.pxmid[1]*(1-m),b=i.separators,_=[];if(d&&-1!==d.indexOf("label")&&_.push(r.label),r.text=y.castOption(p.hovertext||p.text,r.pts),d&&-1!==d.indexOf("text")){var w=r.text;u.isValidTextValue(w)&&_.push(w)}r.value=r.v,r.valueLabel=y.formatPieValue(r.v,b),d&&-1!==d.indexOf("value")&&_.push(r.valueLabel),r.percent=r.v/o.vTotal,r.percentLabel=y.formatPiePercent(r.percent,b),d&&-1!==d.indexOf("percent")&&_.push(r.percentLabel);var T=p.hoverlabel,k=T.font,A=[];s.loneHover({trace:f,x0:g-m*o.r,x1:g+m*o.r,y:v,_x0:h?l+r.TL[0]:g-m*o.r,_x1:h?l+r.TR[0]:g+m*o.r,_y0:h?c+r.TL[1]:v-m*o.r,_y1:h?c+r.BL[1]:v+m*o.r,text:_.join("<br>"),name:p.hovertemplate||-1!==d.indexOf("name")?p.name:void 0,idealAlign:r.pxmid[0]<0?"left":"right",color:y.castOption(T.bgcolor,r.pts)||r.color,borderColor:y.castOption(T.bordercolor,r.pts),fontFamily:y.castOption(k.family,r.pts),fontSize:y.castOption(k.size,r.pts),fontColor:y.castOption(k.color,r.pts),nameLength:y.castOption(T.namelength,r.pts),textAlign:y.castOption(T.align,r.pts),hovertemplate:y.castOption(p.hovertemplate,r.pts),hovertemplateLabels:r,eventData:[x(r,p)]},{container:i._hoverlayer.node(),outerContainer:i._paper.node(),gd:n,inOut_bbox:A}),r.bbox=A[0],f._hasHoverLabel=!0}f._hasHoverEvent=!0,n.emit("plotly_hover",{points:[x(r,p)],event:a.event})}}),r.on("mouseout",function(r){var i=n._fullLayout,o=n._fullData[f.index],l=a.select(this).datum();f._hasHoverEvent&&(r.originalEvent=a.event,n.emit("plotly_unhover",{points:[x(l,o)],event:a.event}),f._hasHoverEvent=!1),f._hasHoverLabel&&(s.loneUnhover(i._hoverlayer.node()),f._hasHoverLabel=!1)}),r.on("click",function(r){var i=n._fullLayout,o=n._fullData[f.index];n._dragging||!1===i.hovermode||(n._hoverdata=[x(r,o)],s.click(n,a.event))})}function w(r,n,i){var a=y.castOption(r.insidetextfont.color,n.pts);!a&&r._input.textfont&&(a=y.castOption(r._input.textfont.color,n.pts));var o=y.castOption(r.insidetextfont.family,n.pts)||y.castOption(r.textfont.family,n.pts)||i.family,s=y.castOption(r.insidetextfont.size,n.pts)||y.castOption(r.textfont.size,n.pts)||i.size;return{color:a||l.contrast(n.color),family:o,size:s}}function T(r,n){for(var i,a,o=0;o<r.length;o++)if((a=(i=r[o][0]).trace).title.text){var s=a.title.text;a._meta&&(s=u.templateString(s,a._meta));var l=c.tester.append("text").attr("data-notex",1).text(s).call(c.font,a.title.font).call(p.convertToTspans,n),f=c.bBox(l.node(),!0);i.titleBox={width:f.width,height:f.height},l.remove()}}function k(r,n,i){var a=i.r||n.rpx1,o=n.rInscribed;if(n.startangle===n.stopangle)return{rCenter:1-o,scale:0,rotate:0,textPosAngle:0};var s,l=n.ring,c=1===l&&Math.abs(n.startangle-n.stopangle)===2*Math.PI,u=n.halfangle,f=n.midangle,h=i.trace.insidetextorientation,p="horizontal"===h,d="tangential"===h,m="radial"===h,g="auto"===h,v=[];if(!g){var y,x=function(i,o){if(c=n.startangle,u=n.stopangle,c>i&&i>u||c<i&&i<u){var c,u,f=Math.abs(i-n.startangle),h=Math.abs(i-n.stopangle),p=f<h?f:h;(s="tan"===o?M(r,a,l,p,0):A(r,a,l,p,Math.PI/2)).textPosAngle=i,v.push(s)}};if(p||d){for(y=4;y>=-4;y-=2)x(Math.PI*y,"tan");for(y=4;y>=-4;y-=2)x(Math.PI*(y+1),"tan")}if(p||m){for(y=4;y>=-4;y-=2)x(Math.PI*(y+1.5),"rad");for(y=4;y>=-4;y-=2)x(Math.PI*(y+.5),"rad")}}if(c||g||p){if((s={scale:o*a*2/Math.sqrt(r.width*r.width+r.height*r.height),rCenter:1-o,rotate:0}).textPosAngle=(n.startangle+n.stopangle)/2,s.scale>=1)return s;v.push(s)}(g||m)&&((s=A(r,a,l,u,f)).textPosAngle=(n.startangle+n.stopangle)/2,v.push(s)),(g||d)&&((s=M(r,a,l,u,f)).textPosAngle=(n.startangle+n.stopangle)/2,v.push(s));for(var b=0,_=0,w=0;w<v.length;w++){var T=v[w].scale;if(_<T&&(_=T,b=w),!g&&_>=1)break}return v[b]}function A(r,n,i,a,o){n=Math.max(0,n-2*v);var s=r.width/r.height,l=L(s,a,n,i);return{scale:2*l/r.height,rCenter:S(s,l/n),rotate:E(o)}}function M(r,n,i,a,o){n=Math.max(0,n-2*v);var s=r.height/r.width,l=L(s,a,n,i);return{scale:2*l/r.width,rCenter:S(s,l/n),rotate:E(o+Math.PI/2)}}function S(r,n){return Math.cos(n)-r*n}function E(r){return(180/Math.PI*r+720)%180-90}function L(r,n,i,a){var o=r+1/(2*Math.tan(n));return i*Math.min(1/(Math.sqrt(o*o+.5)+o),a/(Math.sqrt(r*r+a/2)+r))}function C(r,n){var i=n.pxmid[0],a=n.pxmid[1],o=r.width/2,s=r.height/2;return i<0&&(o*=-1),a<0&&(s*=-1),{scale:1,rCenter:1,rotate:0,x:o+Math.abs(s)*(o>0?1:-1)/2,y:s/(1+i*i/(a*a)),outside:!0}}function P(r,n){var i,a,o,s=r.trace,l={x:r.cx,y:r.cy},c={tx:0,ty:0};c.ty+=s.title.font.size,o=O(s),-1!==s.title.position.indexOf("top")?(l.y-=(1+o)*r.r,c.ty-=r.titleBox.height):-1!==s.title.position.indexOf("bottom")&&(l.y+=(1+o)*r.r);var u,f=r.r/(void 0===(u=r.trace.aspectratio)?1:u),h=n.w*(s.domain.x[1]-s.domain.x[0])/2;return -1!==s.title.position.indexOf("left")?(h+=f,l.x-=(1+o)*f,c.tx+=r.titleBox.width/2):-1!==s.title.position.indexOf("center")?h*=2:-1!==s.title.position.indexOf("right")&&(h+=f,l.x+=(1+o)*f,c.tx-=r.titleBox.width/2),i=h/r.titleBox.width,a=I(r,n)/r.titleBox.height,{x:l.x,y:l.y,scale:Math.min(i,a),tx:c.tx,ty:c.ty}}function I(r,n){var i=r.trace,a=n.h*(i.domain.y[1]-i.domain.y[0]);return Math.min(r.titleBox.height,a/2)}function O(r){var n,i=r.pull;if(!i)return 0;if(Array.isArray(i))for(i=0,n=0;n<r.pull.length;n++)r.pull[n]>i&&(i=r.pull[n]);return i}function z(r,n){for(var i=[],a=0;a<r.length;a++){var o=r[a][0],s=o.trace,l=s.domain,c=n.w*(l.x[1]-l.x[0]),u=n.h*(l.y[1]-l.y[0]);s.title.text&&"middle center"!==s.title.position&&(u-=I(o,n));var f=c/2,h=u/2;"funnelarea"!==s.type||s.scalegroup||(h/=s.aspectratio),o.r=Math.min(f,h)/(1+O(s)),o.cx=n.l+n.w*(s.domain.x[1]+s.domain.x[0])/2,o.cy=n.t+n.h*(1-s.domain.y[0])-u/2,s.title.text&&-1!==s.title.position.indexOf("bottom")&&(o.cy-=I(o,n)),s.scalegroup&&-1===i.indexOf(s.scalegroup)&&i.push(s.scalegroup)}!function(r,n){for(var i,a,o,s=0;s<n.length;s++){var l,c,u,f=1/0,h=n[s];for(a=0;a<r.length;a++)(o=(i=r[a][0]).trace).scalegroup===h&&("pie"===o.type?l=i.r*i.r:"funnelarea"===o.type&&(o.aspectratio>1?u=(c=i.r)/o.aspectratio:c=(u=i.r)*o.aspectratio,c*=(1+o.baseratio)/2,l=c*u),f=Math.min(f,l/i.vTotal));for(a=0;a<r.length;a++)if((o=(i=r[a][0]).trace).scalegroup===h){var p=f*i.vTotal;"funnelarea"===o.type&&(p/=(1+o.baseratio)/2,p/=o.aspectratio),i.r=Math.sqrt(p)}}}(r,i)}function D(r,n){return[r*Math.sin(n),-r*Math.cos(n)]}function R(r,n,i){var a=r._fullLayout,o=i.trace,s=o.texttemplate,l=o.textinfo;if(!s&&l&&"none"!==l){var c,f=l.split("+"),h=function(r){return -1!==f.indexOf(r)},p=h("label"),d=h("text"),m=h("value"),g=h("percent"),v=a.separators;if(c=p?[n.label]:[],d){var x=y.getFirstFilled(o.text,n.pts);b(x)&&c.push(x)}m&&c.push(y.formatPieValue(n.v,v)),g&&c.push(y.formatPiePercent(n.v/i.vTotal,v)),n.text=c.join("<br>")}if(s){var _=u.castOption(o,n.i,"texttemplate");if(_){var w={label:n.label,value:n.v,valueLabel:y.formatPieValue(n.v,a.separators),percent:n.v/i.vTotal,percentLabel:y.formatPiePercent(n.v/i.vTotal,a.separators),color:n.color,text:n.text,customdata:u.castOption(o,n.i,"customdata")},T=y.getFirstFilled(o.text,n.pts);(b(T)||""===T)&&(w.text=T),n.text=u.texttemplateString(_,w,r._fullLayout._d3locale,w,o._meta||{})}else n.text=""}}function F(r,n){var i=r.rotate*Math.PI/180,a=Math.cos(i),o=Math.sin(i),s=(n.left+n.right)/2,l=(n.top+n.bottom)/2;r.textX=s*a-l*o,r.textY=s*o+l*a,r.noCenter=!0}n.exports={plot:function(r,n){var i=r._fullLayout,s=i._size;g("pie",i),T(n,r),z(n,s);var d=u.makeTraceGroups(i._pielayer,n,"trace").each(function(n){var d=a.select(this),g=n[0],v=g.trace;(function(r){var n,i,a,o=r[0],s=o.r,l=o.trace,c=y.getRotationAngle(l.rotation),u=2*Math.PI/o.vTotal,f="px0",h="px1";if("counterclockwise"===l.direction){for(n=0;n<r.length&&r[n].hidden;n++);if(n===r.length)return;c+=u*r[n].v,u*=-1,f="px1",h="px0"}for(a=D(s,c),n=0;n<r.length;n++)(i=r[n]).hidden||(i[f]=a,i.startangle=c,c+=u*i.v/2,i.pxmid=D(s,c),i.midangle=c,c+=u*i.v/2,a=D(s,c),i.stopangle=c,i[h]=a,i.largeArc=i.v>o.vTotal/2?1:0,i.halfangle=Math.PI*Math.min(i.v/o.vTotal,.5),i.ring=1-l.hole,i.rInscribed=i.v!==o.vTotal||o.trace.hole?Math.min(1/(1+1/Math.sin(i.halfangle)),i.ring/2):1)})(n),d.attr("stroke-linejoin","round"),d.each(function(){var x=a.select(this).selectAll("g.slice").data(n);x.enter().append("g").classed("slice",!0),x.exit().remove();var b=[[[],[]],[[],[]]],T=!1;x.each(function(o,s){if(o.hidden)a.select(this).selectAll("path,g").remove();else{o.pointNumber=o.i,o.curveNumber=v.index,b[o.pxmid[1]<0?0:1][o.pxmid[0]<0?0:1].push(o);var l=g.cx,f=g.cy,h=a.select(this),d=h.selectAll("path.surface").data([o]);if(d.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),h.call(_,r,n),v.pull){var x=+y.castOption(v.pull,o.pts)||0;x>0&&(l+=x*o.pxmid[0],f+=x*o.pxmid[1])}o.cxFinal=l,o.cyFinal=f;var A=v.hole;if(o.v===g.vTotal){var M="M"+(l+o.px0[0])+","+(f+o.px0[1])+I(o.px0,o.pxmid,!0,1)+I(o.pxmid,o.px0,!0,1)+"Z";A?d.attr("d","M"+(l+A*o.px0[0])+","+(f+A*o.px0[1])+I(o.px0,o.pxmid,!1,A)+I(o.pxmid,o.px0,!1,A)+"Z"+M):d.attr("d",M)}else{var S=I(o.px0,o.px1,!0,1);if(A){var E=1-A;d.attr("d","M"+(l+A*o.px1[0])+","+(f+A*o.px1[1])+I(o.px1,o.px0,!1,A)+"l"+E*o.px0[0]+","+E*o.px0[1]+S+"Z")}else d.attr("d","M"+l+","+f+"l"+o.px0[0]+","+o.px0[1]+S+"Z")}R(r,o,g);var L=y.castOption(v.textposition,o.pts),P=h.selectAll("g.slicetext").data(o.text&&"none"!==L?[0]:[]);P.enter().append("g").classed("slicetext",!0),P.exit().remove(),P.each(function(){var h=u.ensureSingle(a.select(this),"text","",function(r){r.attr("data-notex",1)}),d=u.ensureUniformFontSize(r,"outside"===L?(x=i.font,{color:y.castOption(v.outsidetextfont.color,o.pts)||y.castOption(v.textfont.color,o.pts)||x.color,family:y.castOption(v.outsidetextfont.family,o.pts)||y.castOption(v.textfont.family,o.pts)||x.family,size:y.castOption(v.outsidetextfont.size,o.pts)||y.castOption(v.textfont.size,o.pts)||x.size}):w(v,o,i.font));h.text(o.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(c.font,d).call(p.convertToTspans,r);var x,b,_=c.bBox(h.node());if("outside"===L)b=C(_,o);else if(b=k(_,o,g),"auto"===L&&b.scale<1){var A=u.ensureUniformFontSize(r,v.outsidetextfont);h.call(c.font,A),b=C(_=c.bBox(h.node()),o)}var M=b.textPosAngle,S=void 0===M?o.pxmid:D(g.r,M);if(b.targetX=l+S[0]*b.rCenter+(b.x||0),b.targetY=f+S[1]*b.rCenter+(b.y||0),F(b,_),b.outside){var E=b.targetY;o.yLabelMin=E-_.height/2,o.yLabelMid=E,o.yLabelMax=E+_.height/2,o.labelExtraX=0,o.labelExtraY=0,T=!0}b.fontSize=d.size,m(v.type,b,i),n[s].transform=b,h.attr("transform",u.getTextTransform(b))})}function I(r,n,i,a){var s=a*(n[0]-r[0]),l=a*(n[1]-r[1]);return"a"+a*g.r+","+a*g.r+" 0 "+o.largeArc+(i?" 1 ":" 0 ")+s+","+l}});var A=a.select(this).selectAll("g.titletext").data(v.title.text?[0]:[]);if(A.enter().append("g").classed("titletext",!0),A.exit().remove(),A.each(function(){var n,i,o=u.ensureSingle(a.select(this),"text","",function(r){r.attr("data-notex",1)}),l=v.title.text;v._meta&&(l=u.templateString(l,v._meta)),o.text(l).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(c.font,v.title.font).call(p.convertToTspans,r),i="middle center"===v.title.position?(n=Math.sqrt(g.titleBox.width*g.titleBox.width+g.titleBox.height*g.titleBox.height),{x:g.cx,y:g.cy,scale:g.trace.hole*g.r*2/n,tx:0,ty:-g.titleBox.height/2+g.trace.title.font.size}):P(g,s),o.attr("transform",h(i.x,i.y)+f(Math.min(1,i.scale))+h(i.tx,i.ty))}),T&&function(r,n){var i,a,o,s,l,c,u,f,h,p,d,m,g;function v(r,n){return r.pxmid[1]-n.pxmid[1]}function x(r,n){return n.pxmid[1]-r.pxmid[1]}for(a=0;a<2;a++)for(o=a?v:x,l=a?Math.max:Math.min,u=a?1:-1,i=0;i<2;i++){for(s=i?Math.max:Math.min,c=i?1:-1,(f=r[a][i]).sort(o),p=(h=r[1-a][i]).concat(f),m=[],d=0;d<f.length;d++)void 0!==f[d].yLabelMid&&m.push(f[d]);for(g=!1,d=0;a&&d<h.length;d++)if(void 0!==h[d].yLabelMid){g=h[d];break}for(d=0;d<m.length;d++){var b=d&&m[d-1];g&&!d&&(b=g),function(r,i){i||(i={});var o,f,h,d,m=i.labelExtraY+(a?i.yLabelMax:i.yLabelMin),g=a?r.yLabelMin:r.yLabelMax,v=a?r.yLabelMax:r.yLabelMin,x=r.cyFinal+l(r.px0[1],r.px1[1]),b=m-g;if(b*u>0&&(r.labelExtraY=b),Array.isArray(n.pull))for(f=0;f<p.length;f++)(h=p[f])===r||(y.castOption(n.pull,r.pts)||0)>=(y.castOption(n.pull,h.pts)||0)||((r.pxmid[1]-h.pxmid[1])*u>0?(b=h.cyFinal+l(h.px0[1],h.px1[1])-g-r.labelExtraY)*u>0&&(r.labelExtraY+=b):(v+r.labelExtraY-x)*u>0&&(o=3*c*Math.abs(f-p.indexOf(r)),(d=h.cxFinal+s(h.px0[0],h.px1[0])+o-(r.cxFinal+r.pxmid[0])-r.labelExtraX)*c>0&&(r.labelExtraX+=d)))}(m[d],b)}}}(b,v),function(r,n){r.each(function(r){var i=a.select(this);if(r.labelExtraX||r.labelExtraY){var o=i.select("g.slicetext text");r.transform.targetX+=r.labelExtraX,r.transform.targetY+=r.labelExtraY,o.attr("transform",u.getTextTransform(r.transform));var s=r.cxFinal+r.pxmid[0],c="M"+s+","+(r.cyFinal+r.pxmid[1]),f=(r.yLabelMax-r.yLabelMin)*(r.pxmid[0]<0?-1:1)/4;if(r.labelExtraX){var h=r.labelExtraX*r.pxmid[1]/r.pxmid[0],p=r.yLabelMid+r.labelExtraY-(r.cyFinal+r.pxmid[1]);Math.abs(h)>Math.abs(p)?c+="l"+p*r.pxmid[0]/r.pxmid[1]+","+p+"H"+(s+r.labelExtraX+f):c+="l"+r.labelExtraX+","+h+"v"+(p-h)+"h"+f}else c+="V"+(r.yLabelMid+r.labelExtraY)+"h"+f;u.ensureSingle(i,"path","textline").call(l.stroke,n.outsidetextfont.color).attr({"stroke-width":Math.min(2,n.outsidetextfont.size/8),d:c,fill:"none"})}else i.select("path.textline").remove()})}(x,v),T&&v.automargin){var M=c.bBox(d.node()),S=v.domain,E=s.w*(S.x[1]-S.x[0]),L=s.h*(S.y[1]-S.y[0]),I=(.5*E-g.r)/s.w,O=(.5*L-g.r)/s.h;o.autoMargin(r,"pie."+v.uid+".automargin",{xl:S.x[0]-I,xr:S.x[1]+I,yb:S.y[0]-O,yt:S.y[1]+O,l:Math.max(g.cx-g.r-M.left,0),r:Math.max(M.right-(g.cx+g.r),0),b:Math.max(M.bottom-(g.cy+g.r),0),t:Math.max(g.cy-g.r-M.top,0),pad:5})}})});setTimeout(function(){d.selectAll("tspan").each(function(){var r=a.select(this);r.attr("dy")&&r.attr("dy",r.attr("dy"))})},0)},formatSliceLabel:R,transformInsideText:k,determineInsideTextFont:w,positionTitleOutside:P,prerenderTitles:T,layoutAreas:z,attachFxHandlers:_,computeTransform:F}},{"../../components/color":366,"../../components/drawing":388,"../../components/fx":406,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../bar/constants":650,"../bar/uniform_text":664,"./event_data":904,"./helpers":905,"@plotly/d3":58}],910:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("./style_one"),s=r("../bar/uniform_text").resizeText;n.exports=function(r){var n=r._fullLayout._pielayer.selectAll(".trace");s(r,n,"pie"),n.each(function(r){var n=r[0].trace,i=a.select(this);i.style({opacity:n.opacity}),i.selectAll("path.surface").each(function(r){a.select(this).call(o,r,n)})})}},{"../bar/uniform_text":664,"./style_one":911,"@plotly/d3":58}],911:[function(r,n,i){"use strict";var a=r("../../components/color"),o=r("./helpers").castOption;n.exports=function(r,n,i){var s=i.marker.line,l=o(s.color,n.pts)||a.defaultLine,c=o(s.width,n.pts)||0;r.style("stroke-width",c).call(a.fill,n.color).call(a.stroke,l)}},{"../../components/color":366,"./helpers":905}],912:[function(r,n,i){"use strict";var a=r("../scatter/attributes");n.exports={x:a.x,y:a.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:a.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":926}],913:[function(r,n,i){"use strict";var a=r("../../../stackgl_modules").gl_pointcloud2d,o=r("../../lib/str2rgbarray"),s=r("../../plots/cartesian/autorange").findExtremes,l=r("../scatter/get_trace_color");function c(r,n){this.scene=r,this.uid=n,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=a(r.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var u=c.prototype;u.handlePick=function(r){var n=this.idToIndex[r.pointId];return{trace:this,dataCoord:r.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*n],this.pickXYData[2*n+1]]:[this.pickXData[n],this.pickYData[n]],textLabel:Array.isArray(this.textLabels)?this.textLabels[n]:this.textLabels,color:this.color,name:this.name,pointIndex:n,hoverinfo:this.hoverinfo}},u.update=function(r){this.index=r.index,this.textLabels=r.text,this.name=r.name,this.hoverinfo=r.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(r),this.color=l(r,{})},u.updateFast=function(r){var n,i,a,l,c,u,f=this.xData=this.pickXData=r.x,h=this.yData=this.pickYData=r.y,p=this.pickXYData=r.xy,d=r.xbounds&&r.ybounds,m=r.indices,g=this.bounds;if(p){if(a=p,n=p.length>>>1,d)g[0]=r.xbounds[0],g[2]=r.xbounds[1],g[1]=r.ybounds[0],g[3]=r.ybounds[1];else for(u=0;u<n;u++)l=a[2*u],c=a[2*u+1],l<g[0]&&(g[0]=l),l>g[2]&&(g[2]=l),c<g[1]&&(g[1]=c),c>g[3]&&(g[3]=c);if(m)i=m;else for(i=new Int32Array(n),u=0;u<n;u++)i[u]=u}else for(n=f.length,a=new Float32Array(2*n),i=new Int32Array(n),u=0;u<n;u++)l=f[u],c=h[u],i[u]=u,a[2*u]=l,a[2*u+1]=c,l<g[0]&&(g[0]=l),l>g[2]&&(g[2]=l),c<g[1]&&(g[1]=c),c>g[3]&&(g[3]=c);this.idToIndex=i,this.pointcloudOptions.idToIndex=i,this.pointcloudOptions.positions=a;var v=o(r.marker.color),y=o(r.marker.border.color),x=r.opacity*r.marker.opacity;v[3]*=x,this.pointcloudOptions.color=v;var b=r.marker.blend;null===b&&(b=f.length<100||h.length<100),this.pointcloudOptions.blend=b,y[3]*=x,this.pointcloudOptions.borderColor=y;var _=r.marker.sizemin,w=Math.max(r.marker.sizemax,r.marker.sizemin);this.pointcloudOptions.sizeMin=_,this.pointcloudOptions.sizeMax=w,this.pointcloudOptions.areaRatio=r.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var T=this.scene.xaxis,k=this.scene.yaxis,A=w/2||.5;r._extremes[T._id]=s(T,[g[0],g[2]],{ppad:A}),r._extremes[k._id]=s(k,[g[1],g[3]],{ppad:A})},u.dispose=function(){this.pointcloud.dispose()},n.exports=function(r,n){var i=new c(r,n.uid);return i.update(n),i}},{"../../../stackgl_modules":1120,"../../lib/str2rgbarray":528,"../../plots/cartesian/autorange":553,"../scatter/get_trace_color":936}],914:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes");n.exports=function(r,n,i){function s(i,s){return a.coerce(r,n,o,i,s)}s("x"),s("y"),s("xbounds"),s("ybounds"),r.xy&&r.xy instanceof Float32Array&&(n.xy=r.xy),r.indices&&r.indices instanceof Int32Array&&(n.indices=r.indices),s("text"),s("marker.color",i),s("marker.opacity"),s("marker.blend"),s("marker.sizemin"),s("marker.sizemax"),s("marker.border.color",i),s("marker.border.arearatio"),n._length=null}},{"../../lib":503,"./attributes":912}],915:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("../scatter3d/calc"),plot:r("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:r("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":596,"../scatter3d/calc":955,"./attributes":912,"./convert":913,"./defaults":914}],916:[function(r,n,i){"use strict";var a=r("../../plots/font_attributes"),o=r("../../plots/attributes"),s=r("../../components/color/attributes"),l=r("../../components/fx/attributes"),c=r("../../plots/domain").attributes,u=r("../../plots/template_attributes").hovertemplateAttrs,f=r("../../components/colorscale/attributes"),h=r("../../plot_api/plot_template").templatedArray,p=r("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,d=r("../../lib/extend").extendFlat,m=r("../../plot_api/edit_types").overrideAll;(n.exports=m({hoverinfo:d({},o.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:l.hoverlabel,domain:c({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:p("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:a({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:s.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:l.hoverlabel,hovertemplate:u({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:s.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:l.hoverlabel,hovertemplate:u({},{keys:["value","label"]}),colorscales:h("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:d(f().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":365,"../../components/colorscale/attributes":373,"../../components/fx/attributes":397,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/domain":584,"../../plots/font_attributes":585,"../../plots/template_attributes":633}],917:[function(r,n,i){"use strict";var a=r("../../plot_api/edit_types").overrideAll,o=r("../../plots/get_data").getModuleCalcData,s=r("./plot"),l=r("../../components/fx/layout_attributes"),c=r("../../lib/setcursor"),u=r("../../components/dragelement"),f=r("../../plots/cartesian/select").prepSelect,h=r("../../lib"),p=r("../../registry");i.name="sankey",i.baseLayoutAttrOverrides=a({hoverlabel:l.hoverlabel},"plot","nested"),i.plot=function(r){var n=o(r.calcdata,"sankey")[0];s(r,n),i.updateFx(r)},i.clean=function(r,n,i,a){var o=a._has&&a._has("sankey"),s=n._has&&n._has("sankey");o&&!s&&(a._paperdiv.selectAll(".sankey").remove(),a._paperdiv.selectAll(".bgsankey").remove())},i.updateFx=function(r){for(var n=0;n<r._fullData.length;n++)(function(r,n){var i=r._fullData[n],a=r._fullLayout,o=a.dragmode,s="pan"===a.dragmode?"move":"crosshair",l=i._bgRect;if("pan"!==o&&"zoom"!==o){c(l,s);var d={_id:"x",c2p:h.identity,_offset:i._sankey.translateX,_length:i._sankey.width},m={_id:"y",c2p:h.identity,_offset:i._sankey.translateY,_length:i._sankey.height},g={gd:r,element:l.node(),plotinfo:{id:n,xaxis:d,yaxis:m,fillRangeItems:h.noop},subplot:n,xaxes:[d],yaxes:[m],doneFnCompleted:function(i){for(var a,o=r._fullData[n],s=o.node.groups.slice(),l=[],c=0;c<i.length;c++){var u=function(r){for(var n=o._sankey.graph.nodes,i=0;i<n.length;i++)if(n[i].pointNumber===r)return n[i]}(i[c].pointNumber);if(u){if(u.group){for(var f=0;f<u.childrenNodes.length;f++)l.push(u.childrenNodes[f].pointNumber);s[u.pointNumber-o.node._count]=!1}else l.push(u.pointNumber)}}a=s.filter(Boolean).concat([l]),p.call("_guiRestyle",r,{"node.groups":[a]},n)},prepFn:function(r,n,i){f(r,n,i,g,o)}};u.init(g)}})(r,n)}},{"../../components/dragelement":385,"../../components/fx/layout_attributes":407,"../../lib":503,"../../lib/setcursor":524,"../../plot_api/edit_types":536,"../../plots/cartesian/select":575,"../../plots/get_data":593,"../../registry":638,"./plot":922}],918:[function(r,n,i){"use strict";var a=r("strongly-connected-components"),o=r("../../lib"),s=r("../../lib/gup").wrap,l=o.isArrayOrTypedArray,c=o.isIndex,u=r("../../components/colorscale");n.exports=function(r,n){var i=function(r){var n,i=r.node,s=r.link,f=[],h=l(s.color),p=l(s.customdata),d={},m={},g=s.colorscales.length;for(n=0;n<g;n++){var v=s.colorscales[n],y=u.extractScale(v,{cLetter:"c"}),x=u.makeColorScaleFunc(y);m[v.label]=x}var b=0;for(n=0;n<s.value.length;n++)s.source[n]>b&&(b=s.source[n]),s.target[n]>b&&(b=s.target[n]);var _,w=b+1;r.node._count=w;var T=r.node.groups,k={};for(n=0;n<T.length;n++){var A=T[n];for(_=0;_<A.length;_++){var M=A[_],S=w+n;k.hasOwnProperty(M)?o.warn("Node "+M+" is already part of a group."):k[M]=S}}var E={source:[],target:[]};for(n=0;n<s.value.length;n++){var L=s.value[n],C=s.source[n],P=s.target[n];if(L>0&&c(C,w)&&c(P,w)&&(!k.hasOwnProperty(C)||!k.hasOwnProperty(P)||k[C]!==k[P])){k.hasOwnProperty(P)&&(P=k[P]),k.hasOwnProperty(C)&&(C=k[C]),P=+P,d[C=+C]=d[P]=!0;var I="";s.label&&s.label[n]&&(I=s.label[n]);var O=null;I&&m.hasOwnProperty(I)&&(O=m[I]),f.push({pointNumber:n,label:I,color:h?s.color[n]:s.color,customdata:p?s.customdata[n]:s.customdata,concentrationscale:O,source:C,target:P,value:+L}),E.source.push(C),E.target.push(P)}}var z=w+T.length,D=l(i.color),R=l(i.customdata),F=[];for(n=0;n<z;n++)if(d[n]){var B=i.label[n];F.push({group:n>w-1,childrenNodes:[],pointNumber:n,label:B,color:D?i.color[n]:i.color,customdata:R?i.customdata[n]:i.customdata})}var N=!1;return function(r,n,i){for(var s=o.init2dArray(r,0),l=0;l<Math.min(n.length,i.length);l++)if(o.isIndex(n[l],r)&&o.isIndex(i[l],r)){if(n[l]===i[l])return!0;s[n[l]].push(i[l])}return a(s).components.some(function(r){return r.length>1})}(z,E.source,E.target)&&(N=!0),{circular:N,links:f,nodes:F,groups:T,groupLookup:k}}(n);return s({circular:i.circular,_nodes:i.nodes,_links:i.links,_groups:i.groups,_groupLookup:i.groupLookup})}},{"../../components/colorscale":378,"../../lib":503,"../../lib/gup":500,"strongly-connected-components":306}],919:[function(r,n,i){"use strict";n.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],920:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("../../components/color"),l=r("tinycolor2"),c=r("../../plots/domain").defaults,u=r("../../components/fx/hoverlabel_defaults"),f=r("../../plot_api/plot_template"),h=r("../../plots/array_container_defaults");function p(r,n){function i(i,s){return a.coerce(r,n,o.link.colorscales,i,s)}i("label"),i("cmin"),i("cmax"),i("colorscale")}n.exports=function(r,n,i,d){function m(i,s){return a.coerce(r,n,o,i,s)}var g=a.extendDeep(d.hoverlabel,r.hoverlabel),v=r.node,y=f.newContainer(n,"node");function x(r,n){return a.coerce(v,y,o.node,r,n)}x("label"),x("groups"),x("x"),x("y"),x("pad"),x("thickness"),x("line.color"),x("line.width"),x("hoverinfo",r.hoverinfo),u(v,y,x,g),x("hovertemplate");var b=d.colorway;x("color",y.label.map(function(r,n){return s.addOpacity(b[n%b.length],.8)})),x("customdata");var _=r.link||{},w=f.newContainer(n,"link");function T(r,n){return a.coerce(_,w,o.link,r,n)}T("label"),T("source"),T("target"),T("value"),T("line.color"),T("line.width"),T("hoverinfo",r.hoverinfo),u(_,w,T,g),T("hovertemplate");var k,A=.333>l(d.paper_bgcolor).getLuminance()?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";T("color",a.repeat(A,w.value.length)),T("customdata"),h(_,w,{name:"colorscales",handleItemDefaults:p}),c(n,d,m),m("orientation"),m("valueformat"),m("valuesuffix"),y.x.length&&y.y.length&&(k="freeform"),m("arrangement",k),a.coerceFont(m,"textfont",a.extendFlat({},d.font)),n._length=null}},{"../../components/color":366,"../../components/fx/hoverlabel_defaults":404,"../../lib":503,"../../plot_api/plot_template":543,"../../plots/array_container_defaults":549,"../../plots/domain":584,"./attributes":916,tinycolor2:312}],921:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),moduleType:"trace",name:"sankey",basePlotModule:r("./base_plot"),selectPoints:r("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":916,"./base_plot":917,"./calc":918,"./defaults":920,"./plot":922,"./select.js":924}],922:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=o.numberFormat,l=r("./render"),c=r("../../components/fx"),u=r("../../components/color"),f=r("./constants").cn,h=o._;function p(r){return""!==r}function d(r,n){return r.filter(function(r){return r.key===n.traceId})}function m(r,n){a.select(r).select("path").style("fill-opacity",n),a.select(r).select("rect").style("fill-opacity",n)}function g(r){a.select(r).select("text.name").style("fill","black")}function v(r){return function(n){return -1!==r.node.sourceLinks.indexOf(n.link)||-1!==r.node.targetLinks.indexOf(n.link)}}function y(r){return function(n){return -1!==n.node.sourceLinks.indexOf(r.link)||-1!==n.node.targetLinks.indexOf(r.link)}}function x(r,n,i){n&&i&&d(i,n).selectAll("."+f.sankeyLink).filter(v(n)).call(_.bind(0,n,i,!1))}function b(r,n,i){n&&i&&d(i,n).selectAll("."+f.sankeyLink).filter(v(n)).call(w.bind(0,n,i,!1))}function _(r,n,i,a){var o=a.datum().link.label;a.style("fill-opacity",function(r){if(!r.link.concentrationscale)return .4}),o&&d(n,r).selectAll("."+f.sankeyLink).filter(function(r){return r.link.label===o}).style("fill-opacity",function(r){if(!r.link.concentrationscale)return .4}),i&&d(n,r).selectAll("."+f.sankeyNode).filter(y(r)).call(x)}function w(r,n,i,a){var o=a.datum().link.label;a.style("fill-opacity",function(r){return r.tinyColorAlpha}),o&&d(n,r).selectAll("."+f.sankeyLink).filter(function(r){return r.link.label===o}).style("fill-opacity",function(r){return r.tinyColorAlpha}),i&&d(n,r).selectAll(f.sankeyNode).filter(y(r)).call(b)}function T(r,n){var i=r.hoverlabel||{},a=o.nestedProperty(i,n).get();return!Array.isArray(a)&&a}n.exports=function(r,n){for(var i=r._fullLayout,o=i._paper,d=i._size,v=0;v<r._fullData.length;v++)if(r._fullData[v].visible&&r._fullData[v].type===f.sankey&&!r._fullData[v]._viewInitial){var y=r._fullData[v].node;r._fullData[v]._viewInitial={node:{groups:y.groups.slice(),x:y.x.slice(),y:y.y.slice()}}}var k=h(r,"source:")+" ",A=h(r,"target:")+" ",M=h(r,"concentration:")+" ",S=h(r,"incoming flow count:")+" ",E=h(r,"outgoing flow count:")+" ";l(r,o,n,{width:d.w,height:d.h,margin:{t:d.t,r:d.r,b:d.b,l:d.l}},{linkEvents:{hover:function(n,i,o){!1!==r._fullLayout.hovermode&&(a.select(n).call(_.bind(0,i,o,!0)),"skip"!==i.link.trace.link.hoverinfo&&(i.link.fullData=i.link.trace,r.emit("plotly_hover",{event:a.event,points:[i.link]})))},follow:function(n,o){if(!1!==r._fullLayout.hovermode){var l=o.link.trace.link;if("none"!==l.hoverinfo&&"skip"!==l.hoverinfo){for(var f=[],h=0,d=0;d<o.flow.links.length;d++){var v=o.flow.links[d];if("closest"!==r._fullLayout.hovermode||o.link.pointNumber===v.pointNumber){o.link.pointNumber===v.pointNumber&&(h=d),v.fullData=v.trace,l=o.link.trace.link;var y=function(r){r.circular?(n=(r.circularPathData.leftInnerExtent+r.circularPathData.rightInnerExtent)/2,i=r.circularPathData.verticalFullExtent):(n=(r.source.x1+r.target.x0)/2,i=(r.y0+r.y1)/2);var n,i,a=[n,i];return"v"===r.trace.orientation&&a.reverse(),a[0]+=o.parent.translateX,a[1]+=o.parent.translateY,a}(v),x={valueLabel:s(o.valueFormat)(v.value)+o.valueSuffix};f.push({x:y[0],y:y[1],name:x.valueLabel,text:[v.label||"",k+v.source.label,A+v.target.label,v.concentrationscale?M+s("%0.2f")(v.flow.labelConcentration):""].filter(p).join("<br>"),color:T(l,"bgcolor")||u.addOpacity(v.color,1),borderColor:T(l,"bordercolor"),fontFamily:T(l,"font.family"),fontSize:T(l,"font.size"),fontColor:T(l,"font.color"),nameLength:T(l,"namelength"),textAlign:T(l,"align"),idealAlign:a.event.x<y[0]?"right":"left",hovertemplate:l.hovertemplate,hovertemplateLabels:x,eventData:[v]})}}c.loneHover(f,{container:i._hoverlayer.node(),outerContainer:i._paper.node(),gd:r,anchorIndex:h}).each(function(){o.link.concentrationscale||m(this,.65),g(this)})}}},unhover:function(n,o,s){!1!==r._fullLayout.hovermode&&(a.select(n).call(w.bind(0,o,s,!0)),"skip"!==o.link.trace.link.hoverinfo&&(o.link.fullData=o.link.trace,r.emit("plotly_unhover",{event:a.event,points:[o.link]})),c.loneUnhover(i._hoverlayer.node()))},select:function(n,i){var o=i.link;o.originalEvent=a.event,r._hoverdata=[o],c.click(r,{target:!0})}},nodeEvents:{hover:function(n,i,o){!1!==r._fullLayout.hovermode&&(a.select(n).call(x,i,o),"skip"!==i.node.trace.node.hoverinfo&&(i.node.fullData=i.node.trace,r.emit("plotly_hover",{event:a.event,points:[i.node]})))},follow:function(n,o){if(!1!==r._fullLayout.hovermode){var l=o.node.trace.node;if("none"!==l.hoverinfo&&"skip"!==l.hoverinfo){var u=a.select(n).select("."+f.nodeRect),h=r._fullLayout._paperdiv.node().getBoundingClientRect(),d=u.node().getBoundingClientRect(),v=d.left-2-h.left,y=d.right+2-h.left,x=d.top+d.height/4-h.top,b={valueLabel:s(o.valueFormat)(o.node.value)+o.valueSuffix};o.node.fullData=o.node.trace,r._fullLayout._calcInverseTransform(r);var _=r._fullLayout._invScaleX,w=r._fullLayout._invScaleY,k=c.loneHover({x0:_*v,x1:_*y,y:w*x,name:s(o.valueFormat)(o.node.value)+o.valueSuffix,text:[o.node.label,S+o.node.targetLinks.length,E+o.node.sourceLinks.length].filter(p).join("<br>"),color:T(l,"bgcolor")||o.tinyColorHue,borderColor:T(l,"bordercolor"),fontFamily:T(l,"font.family"),fontSize:T(l,"font.size"),fontColor:T(l,"font.color"),nameLength:T(l,"namelength"),textAlign:T(l,"align"),idealAlign:"left",hovertemplate:l.hovertemplate,hovertemplateLabels:b,eventData:[o.node]},{container:i._hoverlayer.node(),outerContainer:i._paper.node(),gd:r});m(k,.85),g(k)}}},unhover:function(n,o,s){!1!==r._fullLayout.hovermode&&(a.select(n).call(b,o,s),"skip"!==o.node.trace.node.hoverinfo&&(o.node.fullData=o.node.trace,r.emit("plotly_unhover",{event:a.event,points:[o.node]})),c.loneUnhover(i._hoverlayer.node()))},select:function(n,i,o){var s=i.node;s.originalEvent=a.event,r._hoverdata=[s],a.select(n).call(b,i,o),c.click(r,{target:!0})}}})}},{"../../components/color":366,"../../components/fx":406,"../../lib":503,"./constants":919,"./render":923,"@plotly/d3":58}],923:[function(r,n,i){"use strict";var a=r("d3-force"),o=r("d3-interpolate").interpolateNumber,s=r("@plotly/d3"),l=r("@plotly/d3-sankey"),c=r("@plotly/d3-sankey-circular"),u=r("./constants"),f=r("tinycolor2"),h=r("../../components/color"),p=r("../../components/drawing"),d=r("../../lib"),m=d.strTranslate,g=d.strRotate,v=r("../../lib/gup"),y=v.keyFun,x=v.repeat,b=v.unwrap,_=r("../../lib/svg_text_utils"),w=r("../../registry"),T=r("../../constants/alignment"),k=T.CAP_SHIFT,A=T.LINE_SPACING;function M(r,n,i){var a,o=b(n),s=o.trace,h=s.domain,p="h"===s.orientation,m=s.node.pad,g=s.node.thickness,v=r.width*(h.x[1]-h.x[0]),y=r.height*(h.y[1]-h.y[0]),x=o._nodes,_=o._links,w=o.circular;(a=w?c.sankeyCircular().circularLinkGap(0):l.sankey()).iterations(u.sankeyIterations).size(p?[v,y]:[y,v]).nodeWidth(g).nodePadding(m).nodeId(function(r){return r.pointNumber}).nodes(x).links(_);var T,k,A,M=a();for(var S in a.nodePadding()<m&&d.warn("node.pad was reduced to ",a.nodePadding()," to fit within the figure."),o._groupLookup){var E,L=parseInt(o._groupLookup[S]);for(T=0;T<M.nodes.length;T++)if(M.nodes[T].pointNumber===L){E=M.nodes[T];break}if(E){var C={pointNumber:parseInt(S),x0:E.x0,x1:E.x1,y0:E.y0,y1:E.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};M.nodes.unshift(C),E.childrenNodes.unshift(C)}}if(function(){for(T=0;T<M.nodes.length;T++){var r,n,i=M.nodes[T],a={};for(k=0;k<i.targetLinks.length;k++)r=(n=i.targetLinks[k]).source.pointNumber+":"+n.target.pointNumber,a.hasOwnProperty(r)||(a[r]=[]),a[r].push(n);var o=Object.keys(a);for(k=0;k<o.length;k++){var s=a[r=o[k]],l=0,c={};for(A=0;A<s.length;A++)c[(n=s[A]).label]||(c[n.label]=0),c[n.label]+=n.value,l+=n.value;for(A=0;A<s.length;A++)(n=s[A]).flow={value:l,labelConcentration:c[n.label]/l,concentration:n.value/l,links:s},n.concentrationscale&&(n.color=f(n.concentrationscale(n.flow.labelConcentration)))}var u=0;for(k=0;k<i.sourceLinks.length;k++)u+=i.sourceLinks[k].value;for(k=0;k<i.sourceLinks.length;k++)(n=i.sourceLinks[k]).concentrationOut=n.value/u;var h=0;for(k=0;k<i.targetLinks.length;k++)h+=i.targetLinks[k].value;for(k=0;k<i.targetLinks.length;k++)(n=i.targetLinks[k]).concenrationIn=n.value/h}}(),s.node.x.length&&s.node.y.length){for(T=0;T<Math.min(s.node.x.length,s.node.y.length,M.nodes.length);T++)if(s.node.x[T]&&s.node.y[T]){var P=[s.node.x[T]*v,s.node.y[T]*y];M.nodes[T].x0=P[0]-g/2,M.nodes[T].x1=P[0]+g/2;var I=M.nodes[T].y1-M.nodes[T].y0;M.nodes[T].y0=P[1]-I/2,M.nodes[T].y1=P[1]+I/2}"snap"===s.arrangement&&function(r){r.forEach(function(r){var n,i,a,o=0,s=r.length;for(r.sort(function(r,n){return r.y0-n.y0}),a=0;a<s;++a)(n=r[a]).y0>=o||(i=o-n.y0)>1e-6&&(n.y0+=i,n.y1+=i),o=n.y1+m})}(function(r){var n,i,a=r.map(function(r,n){return{x0:r.x0,index:n}}).sort(function(r,n){return r.x0-n.x0}),o=[],s=-1,l=-1/0;for(T=0;T<a.length;T++){var c=r[a[T].index];c.x0>l+g&&(s+=1,n=c.x0),l=c.x0,o[s]||(o[s]=[]),o[s].push(c),i=n-c.x0,c.x0+=i,c.x1+=i}return o}(x=M.nodes)),a.update(M)}return{circular:w,key:i,trace:s,guid:d.randstr(),horizontal:p,width:v,height:y,nodePad:s.node.pad,nodeLineColor:s.node.line.color,nodeLineWidth:s.node.line.width,linkLineColor:s.link.line.color,linkLineWidth:s.link.line.width,valueFormat:s.valueformat,valueSuffix:s.valuesuffix,textFont:s.textfont,translateX:h.x[0]*r.width+r.margin.l,translateY:r.height-h.y[1]*r.height+r.margin.t,dragParallel:p?y:v,dragPerpendicular:p?v:y,arrangement:s.arrangement,sankey:a,graph:M,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function S(r,n,i){var a=f(n.color),o=n.source.label+"|"+n.target.label+"__"+i;return n.trace=r.trace,n.curveNumber=r.trace.index,{circular:r.circular,key:o,traceId:r.key,pointNumber:n.pointNumber,link:n,tinyColorHue:h.tinyRGB(a),tinyColorAlpha:a.getAlpha(),linkPath:E,linkLineColor:r.linkLineColor,linkLineWidth:r.linkLineWidth,valueFormat:r.valueFormat,valueSuffix:r.valueSuffix,sankey:r.sankey,parent:r,interactionState:r.interactionState,flow:n.flow}}function E(){return function(r){if(r.link.circular)return i=(n=r.link).width/2,a=n.circularPathData,"top"===n.circularLinkType?"M "+a.targetX+" "+(a.targetY+i)+" L"+a.rightInnerExtent+" "+(a.targetY+i)+"A"+(a.rightLargeArcRadius+i)+" "+(a.rightSmallArcRadius+i)+" 0 0 1 "+(a.rightFullExtent-i)+" "+(a.targetY-a.rightSmallArcRadius)+"L"+(a.rightFullExtent-i)+" "+a.verticalRightInnerExtent+"A"+(a.rightLargeArcRadius+i)+" "+(a.rightLargeArcRadius+i)+" 0 0 1 "+a.rightInnerExtent+" "+(a.verticalFullExtent-i)+"L"+a.leftInnerExtent+" "+(a.verticalFullExtent-i)+"A"+(a.leftLargeArcRadius+i)+" "+(a.leftLargeArcRadius+i)+" 0 0 1 "+(a.leftFullExtent+i)+" "+a.verticalLeftInnerExtent+"L"+(a.leftFullExtent+i)+" "+(a.sourceY-a.leftSmallArcRadius)+"A"+(a.leftLargeArcRadius+i)+" "+(a.leftSmallArcRadius+i)+" 0 0 1 "+a.leftInnerExtent+" "+(a.sourceY+i)+"L"+a.sourceX+" "+(a.sourceY+i)+"L"+a.sourceX+" "+(a.sourceY-i)+"L"+a.leftInnerExtent+" "+(a.sourceY-i)+"A"+(a.leftLargeArcRadius-i)+" "+(a.leftSmallArcRadius-i)+" 0 0 0 "+(a.leftFullExtent-i)+" "+(a.sourceY-a.leftSmallArcRadius)+"L"+(a.leftFullExtent-i)+" "+a.verticalLeftInnerExtent+"A"+(a.leftLargeArcRadius-i)+" "+(a.leftLargeArcRadius-i)+" 0 0 0 "+a.leftInnerExtent+" "+(a.verticalFullExtent+i)+"L"+a.rightInnerExtent+" "+(a.verticalFullExtent+i)+"A"+(a.rightLargeArcRadius-i)+" "+(a.rightLargeArcRadius-i)+" 0 0 0 "+(a.rightFullExtent+i)+" "+a.verticalRightInnerExtent+"L"+(a.rightFullExtent+i)+" "+(a.targetY-a.rightSmallArcRadius)+"A"+(a.rightLargeArcRadius-i)+" "+(a.rightSmallArcRadius-i)+" 0 0 0 "+a.rightInnerExtent+" "+(a.targetY-i)+"L"+a.targetX+" "+(a.targetY-i)+"Z":"M "+a.targetX+" "+(a.targetY-i)+" L"+a.rightInnerExtent+" "+(a.targetY-i)+"A"+(a.rightLargeArcRadius+i)+" "+(a.rightSmallArcRadius+i)+" 0 0 0 "+(a.rightFullExtent-i)+" "+(a.targetY+a.rightSmallArcRadius)+"L"+(a.rightFullExtent-i)+" "+a.verticalRightInnerExtent+"A"+(a.rightLargeArcRadius+i)+" "+(a.rightLargeArcRadius+i)+" 0 0 0 "+a.rightInnerExtent+" "+(a.verticalFullExtent+i)+"L"+a.leftInnerExtent+" "+(a.verticalFullExtent+i)+"A"+(a.leftLargeArcRadius+i)+" "+(a.leftLargeArcRadius+i)+" 0 0 0 "+(a.leftFullExtent+i)+" "+a.verticalLeftInnerExtent+"L"+(a.leftFullExtent+i)+" "+(a.sourceY+a.leftSmallArcRadius)+"A"+(a.leftLargeArcRadius+i)+" "+(a.leftSmallArcRadius+i)+" 0 0 0 "+a.leftInnerExtent+" "+(a.sourceY-i)+"L"+a.sourceX+" "+(a.sourceY-i)+"L"+a.sourceX+" "+(a.sourceY+i)+"L"+a.leftInnerExtent+" "+(a.sourceY+i)+"A"+(a.leftLargeArcRadius-i)+" "+(a.leftSmallArcRadius-i)+" 0 0 1 "+(a.leftFullExtent-i)+" "+(a.sourceY+a.leftSmallArcRadius)+"L"+(a.leftFullExtent-i)+" "+a.verticalLeftInnerExtent+"A"+(a.leftLargeArcRadius-i)+" "+(a.leftLargeArcRadius-i)+" 0 0 1 "+a.leftInnerExtent+" "+(a.verticalFullExtent-i)+"L"+a.rightInnerExtent+" "+(a.verticalFullExtent-i)+"A"+(a.rightLargeArcRadius-i)+" "+(a.rightLargeArcRadius-i)+" 0 0 1 "+(a.rightFullExtent+i)+" "+a.verticalRightInnerExtent+"L"+(a.rightFullExtent+i)+" "+(a.targetY+a.rightSmallArcRadius)+"A"+(a.rightLargeArcRadius-i)+" "+(a.rightSmallArcRadius-i)+" 0 0 1 "+a.rightInnerExtent+" "+(a.targetY+i)+"L"+a.targetX+" "+(a.targetY+i)+"Z";var n,i,a,s=r.link.source.x1,l=r.link.target.x0,c=o(s,l),u=c(.5),f=c(.5),h=r.link.y0-r.link.width/2,p=r.link.y0+r.link.width/2,d=r.link.y1-r.link.width/2,m=r.link.y1+r.link.width/2;return"M"+s+","+h+"C"+u+","+h+" "+f+","+d+" "+l+","+d+"L"+l+","+m+"C"+f+","+m+" "+u+","+p+" "+s+","+p+"Z"}}function L(r,n){var i=f(n.color),a=u.nodePadAcross,o=r.nodePad/2;n.dx=n.x1-n.x0,n.dy=n.y1-n.y0;var s=n.dx,l=Math.max(.5,n.dy),c="node_"+n.pointNumber;return n.group&&(c=d.randstr()),n.trace=r.trace,n.curveNumber=r.trace.index,{index:n.pointNumber,key:c,partOfGroup:n.partOfGroup||!1,group:n.group,traceId:r.key,trace:r.trace,node:n,nodePad:r.nodePad,nodeLineColor:r.nodeLineColor,nodeLineWidth:r.nodeLineWidth,textFont:r.textFont,size:r.horizontal?r.height:r.width,visibleWidth:Math.ceil(s),visibleHeight:l,zoneX:-a,zoneY:-o,zoneWidth:s+2*a,zoneHeight:l+2*o,labelY:r.horizontal?n.dy/2+1:n.dx/2+1,left:1===n.originalLayer,sizeAcross:r.width,forceLayouts:r.forceLayouts,horizontal:r.horizontal,darkBackground:128>=i.getBrightness(),tinyColorHue:h.tinyRGB(i),tinyColorAlpha:i.getAlpha(),valueFormat:r.valueFormat,valueSuffix:r.valueSuffix,sankey:r.sankey,graph:r.graph,arrangement:r.arrangement,uniqueNodeLabelPathId:[r.guid,r.key,c].join("_"),interactionState:r.interactionState,figure:r}}function C(r){r.attr("transform",function(r){return m(r.node.x0.toFixed(3),r.node.y0.toFixed(3))})}function P(r){r.call(C)}function I(r,n){r.call(P),n.attr("d",E())}function O(r){r.attr("width",function(r){return r.node.x1-r.node.x0}).attr("height",function(r){return r.visibleHeight})}function z(r){return r.link.width>1||r.linkLineWidth>0}function D(r){return m(r.translateX,r.translateY)+(r.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function R(r,n,i){r.on(".basic",null).on("mouseover.basic",function(r){r.interactionState.dragInProgress||r.partOfGroup||(i.hover(this,r,n),r.interactionState.hovered=[this,r])}).on("mousemove.basic",function(r){r.interactionState.dragInProgress||r.partOfGroup||(i.follow(this,r),r.interactionState.hovered=[this,r])}).on("mouseout.basic",function(r){r.interactionState.dragInProgress||r.partOfGroup||(i.unhover(this,r,n),r.interactionState.hovered=!1)}).on("click.basic",function(r){r.interactionState.hovered&&(i.unhover(this,r,n),r.interactionState.hovered=!1),r.interactionState.dragInProgress||r.partOfGroup||i.select(this,r,n)})}function F(r,n,i,o){var l=s.behavior.drag().origin(function(r){return{x:r.node.x0+r.visibleWidth/2,y:r.node.y0+r.visibleHeight/2}}).on("dragstart",function(s){if("fixed"!==s.arrangement&&(d.ensureSingle(o._fullLayout._infolayer,"g","dragcover",function(r){o._fullLayout._dragCover=r}),d.raiseToTop(this),s.interactionState.dragInProgress=s.node,N(s.node),s.interactionState.hovered&&(i.nodeEvents.unhover.apply(0,s.interactionState.hovered),s.interactionState.hovered=!1),"snap"===s.arrangement)){var l,c=s.traceId+"|"+s.key;s.forceLayouts[c]?s.forceLayouts[c].alpha(1):(function(r){for(var n=0;n<r.length;n++)r[n].y=(r[n].y0+r[n].y1)/2,r[n].x=(r[n].x0+r[n].x1)/2}(s.graph.nodes),l=s.graph.nodes.filter(function(r){return r.originalX===s.node.originalX}).filter(function(r){return!r.partOfGroup}),s.forceLayouts[c]=a.forceSimulation(l).alphaDecay(0).force("collide",a.forceCollide().radius(function(r){return r.dy/2+s.nodePad/2}).strength(1).iterations(u.forceIterations)).force("constrain",function(){for(var r=0,n=0;n<l.length;n++){var i=l[n];i===s.interactionState.dragInProgress?(i.x=i.lastDraggedX,i.y=i.lastDraggedY):(i.vx=(i.originalX-i.x)/u.forceTicksPerFrame,i.y=Math.min(s.size-i.dy/2,Math.max(i.dy/2,i.y))),r=Math.max(r,Math.abs(i.vx),Math.abs(i.vy))}!s.interactionState.dragInProgress&&r<.1&&s.forceLayouts[c].alpha()>0&&s.forceLayouts[c].alpha(0)}).stop()),window.requestAnimationFrame(function i(){var a;for(a=0;a<u.forceTicksPerFrame;a++)s.forceLayouts[c].tick();if(function(r){for(var n=0;n<r.length;n++)r[n].y0=r[n].y-r[n].dy/2,r[n].y1=r[n].y0+r[n].dy,r[n].x0=r[n].x-r[n].dx/2,r[n].x1=r[n].x0+r[n].dx}(s.graph.nodes),s.sankey.update(s.graph),I(r.filter(j(s)),n),s.forceLayouts[c].alpha()>0)window.requestAnimationFrame(i);else{var l=s.node.originalX;s.node.x0=l-s.visibleWidth/2,s.node.x1=l+s.visibleWidth/2,B(s,o)}})}}).on("drag",function(i){if("fixed"!==i.arrangement){var a=s.event.x,o=s.event.y;"snap"===i.arrangement?(i.node.x0=a-i.visibleWidth/2,i.node.x1=a+i.visibleWidth/2):("freeform"===i.arrangement&&(i.node.x0=a-i.visibleWidth/2,i.node.x1=a+i.visibleWidth/2),o=Math.max(0,Math.min(i.size-i.visibleHeight/2,o))),i.node.y0=o-i.visibleHeight/2,i.node.y1=o+i.visibleHeight/2,N(i.node),"snap"!==i.arrangement&&(i.sankey.update(i.graph),I(r.filter(j(i)),n))}}).on("dragend",function(r){if("fixed"!==r.arrangement){r.interactionState.dragInProgress=!1;for(var n=0;n<r.node.childrenNodes.length;n++)r.node.childrenNodes[n].x=r.node.x,r.node.childrenNodes[n].y=r.node.y;"snap"!==r.arrangement&&B(r,o)}});r.on(".drag",null).call(l)}function B(r,n){for(var i=[],a=[],o=0;o<r.graph.nodes.length;o++){var s=(r.graph.nodes[o].x0+r.graph.nodes[o].x1)/2,l=(r.graph.nodes[o].y0+r.graph.nodes[o].y1)/2;i.push(s/r.figure.width),a.push(l/r.figure.height)}w.call("_guiRestyle",n,{"node.x":[i],"node.y":[a]},r.trace.index).then(function(){n._fullLayout._dragCover&&n._fullLayout._dragCover.remove()})}function N(r){r.lastDraggedX=r.x0+r.dx/2,r.lastDraggedY=r.y0+r.dy/2}function j(r){return function(n){return n.node.originalX===r.node.originalX}}n.exports=function(r,n,i,a,o){var l=!1;d.ensureSingle(r._fullLayout._infolayer,"g","first-render",function(){l=!0});var c=r._fullLayout._dragCover,v=i.filter(function(r){return b(r).trace.visible}).map(M.bind(null,a)),w=n.selectAll("."+u.cn.sankey).data(v,y);w.exit().remove(),w.enter().append("g").classed(u.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",D),w.each(function(n,i){r._fullData[i]._sankey=n;var a="bgsankey-"+n.trace.uid+"-"+i;d.ensureSingle(r._fullLayout._draggers,"rect",a),r._fullData[i]._bgRect=s.select("."+a),r._fullData[i]._bgRect.style("pointer-events","all").attr("width",n.width).attr("height",n.height).attr("x",n.translateX).attr("y",n.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),w.transition().ease(u.ease).duration(u.duration).attr("transform",D);var T=w.selectAll("."+u.cn.sankeyLinks).data(x,y);T.enter().append("g").classed(u.cn.sankeyLinks,!0).style("fill","none");var P=T.selectAll("."+u.cn.sankeyLink).data(function(r){return r.graph.links.filter(function(r){return r.value}).map(S.bind(null,r))},y);P.enter().append("path").classed(u.cn.sankeyLink,!0).call(R,w,o.linkEvents),P.style("stroke",function(r){return z(r)?h.tinyRGB(f(r.linkLineColor)):r.tinyColorHue}).style("stroke-opacity",function(r){return z(r)?h.opacity(r.linkLineColor):r.tinyColorAlpha}).style("fill",function(r){return r.tinyColorHue}).style("fill-opacity",function(r){return r.tinyColorAlpha}).style("stroke-width",function(r){return z(r)?r.linkLineWidth:1}).attr("d",E()),P.style("opacity",function(){return r._context.staticPlot||l||c?1:0}).transition().ease(u.ease).duration(u.duration).style("opacity",1),P.exit().transition().ease(u.ease).duration(u.duration).style("opacity",0).remove();var I=w.selectAll("."+u.cn.sankeyNodeSet).data(x,y);I.enter().append("g").classed(u.cn.sankeyNodeSet,!0),I.style("cursor",function(r){switch(r.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var B=I.selectAll("."+u.cn.sankeyNode).data(function(r){var n=r.graph.nodes;return function(r){var n,i=[];for(n=0;n<r.length;n++)r[n].originalX=(r[n].x0+r[n].x1)/2,r[n].originalY=(r[n].y0+r[n].y1)/2,-1===i.indexOf(r[n].originalX)&&i.push(r[n].originalX);for(i.sort(function(r,n){return r-n}),n=0;n<r.length;n++)r[n].originalLayerIndex=i.indexOf(r[n].originalX),r[n].originalLayer=r[n].originalLayerIndex/(i.length-1)}(n),n.map(L.bind(null,r))},y);B.enter().append("g").classed(u.cn.sankeyNode,!0).call(C).style("opacity",function(n){return(r._context.staticPlot||l)&&!n.partOfGroup?1:0}),B.call(R,w,o.nodeEvents).call(F,P,o,r),B.transition().ease(u.ease).duration(u.duration).call(C).style("opacity",function(r){return r.partOfGroup?0:1}),B.exit().transition().ease(u.ease).duration(u.duration).style("opacity",0).remove();var N=B.selectAll("."+u.cn.nodeRect).data(x);N.enter().append("rect").classed(u.cn.nodeRect,!0).call(O),N.style("stroke-width",function(r){return r.nodeLineWidth}).style("stroke",function(r){return h.tinyRGB(f(r.nodeLineColor))}).style("stroke-opacity",function(r){return h.opacity(r.nodeLineColor)}).style("fill",function(r){return r.tinyColorHue}).style("fill-opacity",function(r){return r.tinyColorAlpha}),N.transition().ease(u.ease).duration(u.duration).call(O);var j=B.selectAll("."+u.cn.nodeLabel).data(x);j.enter().append("text").classed(u.cn.nodeLabel,!0).style("cursor","default"),j.attr("data-notex",1).text(function(r){return r.node.label}).each(function(n){var i=s.select(this);p.font(i,n.textFont),_.convertToTspans(i,r)}).style("text-shadow",_.makeTextShadow(r._fullLayout.paper_bgcolor)).attr("text-anchor",function(r){return r.horizontal&&r.left?"end":"start"}).attr("transform",function(r){var n=s.select(this),i=_.lineCount(n),a=r.textFont.size*((i-1)*A-k),o=r.nodeLineWidth/2+3,l=((r.horizontal?r.visibleHeight:r.visibleWidth)-a)/2;r.horizontal&&(r.left?o=-o:o+=r.visibleWidth);var c=r.horizontal?"":"scale(-1,1)"+g(90);return m(r.horizontal?o:l,r.horizontal?l:o)+c}),j.transition().ease(u.ease).duration(u.duration)}},{"../../components/color":366,"../../components/drawing":388,"../../constants/alignment":471,"../../lib":503,"../../lib/gup":500,"../../lib/svg_text_utils":529,"../../registry":638,"./constants":919,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:312}],924:[function(r,n,i){"use strict";n.exports=function(r,n){for(var i=[],a=r.cd[0].trace,o=a._sankey.graph.nodes,s=0;s<o.length;s++){var l=o[s];if(!l.partOfGroup){var c=[(l.x0+l.x1)/2,(l.y0+l.y1)/2];"v"===a.orientation&&c.reverse(),n&&n.contains(c,!1,s,r)&&i.push({pointNumber:l.pointNumber})}}return i}},{}],925:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n){for(var i=0;i<r.length;i++)r[i].i=i;a.mergeArray(n.text,r,"tx"),a.mergeArray(n.texttemplate,r,"txt"),a.mergeArray(n.hovertext,r,"htx"),a.mergeArray(n.customdata,r,"data"),a.mergeArray(n.textposition,r,"tp"),n.textfont&&(a.mergeArrayCastPositive(n.textfont.size,r,"ts"),a.mergeArray(n.textfont.color,r,"tc"),a.mergeArray(n.textfont.family,r,"tf"));var o=n.marker;if(o){a.mergeArrayCastPositive(o.size,r,"ms"),a.mergeArrayCastPositive(o.opacity,r,"mo"),a.mergeArray(o.symbol,r,"mx"),a.mergeArray(o.color,r,"mc");var s=o.line;o.line&&(a.mergeArray(s.color,r,"mlc"),a.mergeArrayCastPositive(s.width,r,"mlw"));var l=o.gradient;l&&"none"!==l.type&&(a.mergeArray(l.type,r,"mgt"),a.mergeArray(l.color,r,"mgc"))}}},{"../../lib":503}],926:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,o=r("../../plots/template_attributes").texttemplateAttrs,s=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../../components/colorscale/attributes"),c=r("../../plots/font_attributes"),u=r("../../components/drawing/attributes").dash,f=r("../../components/drawing"),h=r("./constants"),p=r("../../lib/extend").extendFlat;n.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:a("x"),yhoverformat:a("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:o({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:s({},{keys:h.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:p({},u,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:p({symbol:{valType:"enumerated",values:f.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:p({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},l("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},l("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:c({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":373,"../../components/drawing":388,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"./constants":930}],927:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../../plots/cartesian/axes"),l=r("../../plots/cartesian/align_period"),c=r("../../constants/numerical").BADNUM,u=r("./subtypes"),f=r("./colorscale_calc"),h=r("./arrays_to_calcdata"),p=r("./calc_selection");function d(r,n,i,a,o,l,c){var f=n._length,h=r._fullLayout,p=i._id,d=a._id,m=h._firstScatter[v(n)]===n.uid,g=(y(n,h,i,a)||{}).orientation,x=n.fill;i._minDtick=0,a._minDtick=0;var b={padded:!0},_={padded:!0};c&&(b.ppad=_.ppad=c);var w=f<2||o[0]!==o[f-1]||l[0]!==l[f-1];w&&("tozerox"===x||"tonextx"===x&&(m||"h"===g))?b.tozero=!0:(n.error_y||{}).visible||"tonexty"!==x&&"tozeroy"!==x&&(u.hasMarkers(n)||u.hasText(n))||(b.padded=!1,b.ppad=0),w&&("tozeroy"===x||"tonexty"===x&&(m||"v"===g))?_.tozero=!0:"tonextx"!==x&&"tozerox"!==x||(_.padded=!1),p&&(n._extremes[p]=s.findExtremes(i,o,b)),d&&(n._extremes[d]=s.findExtremes(a,l,_))}function m(r,n){if(u.hasMarkers(r)){var i,a=r.marker,l=1.6*(r.marker.sizeref||1);if(i="area"===r.marker.sizemode?function(r){return Math.max(Math.sqrt((r||0)/l),3)}:function(r){return Math.max((r||0)/l,3)},o.isArrayOrTypedArray(a.size)){var c={type:"linear"};s.setConvert(c);for(var f=c.makeCalcdata(r.marker,"size"),h=Array(n),p=0;p<n;p++)h[p]=i(f[p]);return h}return i(a.size)}}function g(r,n){var i=v(n),a=r._firstScatter;a[i]||(a[i]=n.uid)}function v(r){var n=r.stackgroup;return r.xaxis+r.yaxis+r.type+(n?"-"+n:"")}function y(r,n,i,a){var o=r.stackgroup;if(o){var s=n._scatterStackOpts[i._id+a._id][o],l="v"===s.orientation?a:i;return"linear"===l.type||"log"===l.type?s:void 0}}n.exports={calc:function(r,n){var i,u,v,x,b,_,w=r._fullLayout,T=s.getFromId(r,n.xaxis||"x"),k=s.getFromId(r,n.yaxis||"y"),A=T.makeCalcdata(n,"x"),M=k.makeCalcdata(n,"y"),S=l(n,T,"x",A),E=l(n,k,"y",M),L=S.vals,C=E.vals,P=n._length,I=Array(P),O=n.ids,z=y(n,w,T,k),D=!1;g(w,n);var R,F="x",B="y";z?(o.pushUnique(z.traceIndices,n._expandedIndex),(i="v"===z.orientation)?(B="s",R="x"):(F="s",R="y"),b="interpolate"===z.stackgaps):d(r,n,T,k,L,C,m(n,P));var N=!!n.xperiodalignment,j=!!n.yperiodalignment;for(u=0;u<P;u++){var U=I[u]={},V=a(L[u]),H=a(C[u]);V&&H?(U[F]=L[u],U[B]=C[u],N&&(U.orig_x=A[u],U.xEnd=S.ends[u],U.xStart=S.starts[u]),j&&(U.orig_y=M[u],U.yEnd=E.ends[u],U.yStart=E.starts[u])):z&&(i?V:H)?(U[R]=i?L[u]:C[u],U.gap=!0,b?(U.s=c,D=!0):U.s=0):U[F]=U[B]=c,O&&(U.id=String(O[u]))}if(h(I,n),f(r,n),p(I,n),z){for(u=0;u<I.length;)I[u][R]===c?I.splice(u,1):u++;if(o.sort(I,function(r,n){return r[R]-n[R]||r.i-n.i}),D){for(u=0;u<I.length-1&&I[u].gap;)u++;for((_=I[u].s)||(_=I[u].s=0),v=0;v<u;v++)I[v].s=_;for(x=I.length-1;x>u&&I[x].gap;)x--;for(_=I[x].s,v=I.length-1;v>x;v--)I[v].s=_;for(;u<x;)if(I[++u].gap){for(v=u+1;I[v].gap;)v++;for(var q=I[u-1][R],G=I[u-1].s,Y=(I[v].s-G)/(I[v][R]-q);u<v;)I[u].s=G+(I[u][R]-q)*Y,u++}}}return I},calcMarkerSize:m,calcAxisExpansion:d,setFirstScatter:g,getStackOpts:y}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"./arrays_to_calcdata":925,"./calc_selection":928,"./colorscale_calc":929,"./subtypes":951,"fast-isnumeric":190}],928:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n){a.isArrayOrTypedArray(n.selectedpoints)&&a.tagSelected(r,n)}},{"../../lib":503}],929:[function(r,n,i){"use strict";var a=r("../../components/colorscale/helpers").hasColorscale,o=r("../../components/colorscale/calc"),s=r("./subtypes");n.exports=function(r,n){s.hasLines(n)&&a(n,"line")&&o(r,n,{vals:n.line.color,containerStr:"line",cLetter:"c"}),s.hasMarkers(n)&&(a(n,"marker")&&o(r,n,{vals:n.marker.color,containerStr:"marker",cLetter:"c"}),a(n,"marker.line")&&o(r,n,{vals:n.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"./subtypes":951}],930:[function(r,n,i){"use strict";n.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],931:[function(r,n,i){"use strict";var a=r("./calc");function o(r,n,i,a,o,s,l){o[a]=!0;var c,u,f={i:null,gap:!0,s:0};if(f[l]=i,r.splice(n,0,f),n&&i===r[n-1][l]){var h=r[n-1];f.s=h.s,f.i=h.i,f.gap=h.gap}else s&&(f.s=(c=r[n-1],(u=r[n+1])?c?c.s+(u.s-c.s)*(i-c[l])/(u[l]-c[l]):u.s:c.s));n||(r[0].t=r[1].t,r[0].trace=r[1].trace,delete r[1].t,delete r[1].trace)}n.exports=function(r,n){var i=n.xaxis,s=n.yaxis,l=i._id+s._id,c=r._fullLayout._scatterStackOpts[l];if(c){var u,f,h,p,d,m,g,v,y,x,b,_,w,T,k,A=r.calcdata;for(var M in c){var S=(x=c[M]).traceIndices;if(S.length){for(b="interpolate"===x.stackgaps,_=x.groupnorm,"v"===x.orientation?(w="x",T="y"):(w="y",T="x"),k=Array(S.length),u=0;u<k.length;u++)k[u]=!1;var E=Array((m=A[S[0]]).length);for(u=0;u<m.length;u++)E[u]=m[u][w];for(u=1;u<S.length;u++){for(d=A[S[u]],f=h=0;f<d.length;f++){for(g=d[f][w];g>E[h]&&h<E.length;h++)o(d,f,E[h],u,k,b,w),f++;if(g!==E[h]){for(p=0;p<u;p++)o(A[S[p]],h,g,p,k,b,w);E.splice(h,0,g)}h++}for(;h<E.length;h++)o(d,f,E[h],u,k,b,w),f++}var L=E.length;for(f=0;f<m.length;f++){for(v=m[f][T]=m[f].s,u=1;u<S.length;u++)(d=A[S[u]])[0].trace._rawLength=d[0].trace._length,d[0].trace._length=L,v+=d[f].s,d[f][T]=v;if(_)for(y=("fraction"===_?v:v/100)||1,u=0;u<S.length;u++){var C=A[S[u]][f];C[T]/=y,C.sNorm=C.s/y}}for(u=0;u<S.length;u++){var P=(d=A[S[u]])[0].trace,I=a.calcMarkerSize(P,P._rawLength),O=Array.isArray(I);if(I&&k[u]||O){var z=I;for(I=Array(L),f=0;f<L;f++)I[f]=d[f].gap?0:O?z[d[f].i]:z}var D=Array(L),R=Array(L);for(f=0;f<L;f++)D[f]=d[f].x,R[f]=d[f].y;a.calcAxisExpansion(r,P,i,s,D,R,I),d[0].t.orientation=x.orientation}}}}}},{"./calc":927}],932:[function(r,n,i){"use strict";n.exports=function(r){for(var n=0;n<r.length;n++){var i=r[n];if("scatter"===i.type){var a=i.fill;if("none"!==a&&"toself"!==a&&(i.opacity=void 0,"tonexty"===a||"tonextx"===a))for(var o=n-1;o>=0;o--){var s=r[o];if("scatter"===s.type&&s.xaxis===i.xaxis&&s.yaxis===i.yaxis){s.opacity=void 0;break}}}}}},{}],933:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../registry"),s=r("./attributes"),l=r("./constants"),c=r("./subtypes"),u=r("./xy_defaults"),f=r("./period_defaults"),h=r("./stack_defaults"),p=r("./marker_defaults"),d=r("./line_defaults"),m=r("./line_shape_defaults"),g=r("./text_defaults"),v=r("./fillcolor_defaults");n.exports=function(r,n,i,y){function x(i,o){return a.coerce(r,n,s,i,o)}var b=u(r,n,y,x);if(b||(n.visible=!1),n.visible){f(r,n,y,x),x("xhoverformat"),x("yhoverformat");var _=h(r,n,y,x),w=!_&&b<l.PTS_LINESONLY?"lines+markers":"lines";x("text"),x("hovertext"),x("mode",w),c.hasLines(n)&&(d(r,n,i,y,x),m(r,n,x),x("connectgaps"),x("line.simplify")),c.hasMarkers(n)&&p(r,n,i,y,x,{gradient:!0}),c.hasText(n)&&(x("texttemplate"),g(r,n,y,x));var T=[];(c.hasMarkers(n)||c.hasText(n))&&(x("cliponaxis"),x("marker.maxdisplayed"),T.push("points")),x("fill",_?_.fillDflt:"none"),"none"!==n.fill&&(v(r,n,i,x),c.hasLines(n)||m(r,n,x));var k=(n.line||{}).color,A=(n.marker||{}).color;"tonext"!==n.fill&&"toself"!==n.fill||T.push("fills"),x("hoveron",T.join("+")||"points"),"fills"!==n.hoveron&&x("hovertemplate");var M=o.getComponentMethod("errorbars","supplyDefaults");M(r,n,k||A||i,{axis:"y"}),M(r,n,k||A||i,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(n,x)}}},{"../../lib":503,"../../registry":638,"./attributes":926,"./constants":930,"./fillcolor_defaults":934,"./line_defaults":939,"./line_shape_defaults":941,"./marker_defaults":945,"./period_defaults":946,"./stack_defaults":949,"./subtypes":951,"./text_defaults":952,"./xy_defaults":953}],934:[function(r,n,i){"use strict";var a=r("../../components/color"),o=r("../../lib").isArrayOrTypedArray;n.exports=function(r,n,i,s){var l=!1;if(n.marker){var c=n.marker.color,u=(n.marker.line||{}).color;c&&!o(c)?l=c:u&&!o(u)&&(l=u)}s("fillcolor",a.addOpacity((n.line||{}).color||l||i,.5))}},{"../../components/color":366,"../../lib":503}],935:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes");n.exports=function(r,n,i){var o={},s={_fullLayout:i},l=a.getFromTrace(s,n,"x"),c=a.getFromTrace(s,n,"y");return o.xLabel=a.tickText(l,l.c2l(r.x),!0).text,o.yLabel=a.tickText(c,c.c2l(r.y),!0).text,o}},{"../../plots/cartesian/axes":554}],936:[function(r,n,i){"use strict";var a=r("../../components/color"),o=r("./subtypes");n.exports=function(r,n){if("lines"===r.mode)return(i=r.line.color)&&a.opacity(i)?i:r.fillcolor;if("none"===r.mode)return r.fill?r.fillcolor:"";var i,s,l=n.mcc||(r.marker||{}).color,c=n.mlcc||((r.marker||{}).line||{}).color;return(s=l&&a.opacity(l)?l:c&&a.opacity(c)&&(n.mlw||((r.marker||{}).line||{}).width)?c:"")?.3>a.opacity(s)?a.addOpacity(s,.3):s:(i=(r.line||{}).color)&&a.opacity(i)&&o.hasLines(r)&&r.line.width?i:r.fillcolor}},{"../../components/color":366,"./subtypes":951}],937:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/fx"),s=r("../../registry"),l=r("./get_trace_color"),c=r("../../components/color"),u=a.fillText;n.exports=function(r,n,i,f){var h=r.cd,p=h[0].trace,d=r.xa,m=r.ya,g=d.c2p(n),v=m.c2p(i),y=[g,v],x=p.hoveron||"",b=-1!==p.mode.indexOf("markers")?3:.5,_=!!p.xperiodalignment,w=!!p.yperiodalignment;if(-1!==x.indexOf("points")){var T=function(r){var n=Math.max(b,r.mrc||0),i=d.c2p(r.x)-g,a=m.c2p(r.y)-v;return Math.max(Math.sqrt(i*i+a*a)-n,1-b/n)},k=o.getDistanceFunction(f,function(r){if(_){var n=d.c2p(r.xStart),i=d.c2p(r.xEnd);return g>=Math.min(n,i)&&g<=Math.max(n,i)?0:1/0}var a=Math.max(3,r.mrc||0),o=1-1/a,s=Math.abs(d.c2p(r.x)-g);return s<a?o*s/a:s-a+o},function(r){if(w){var n=m.c2p(r.yStart),i=m.c2p(r.yEnd);return v>=Math.min(n,i)&&v<=Math.max(n,i)?0:1/0}var a=Math.max(3,r.mrc||0),o=1-1/a,s=Math.abs(m.c2p(r.y)-v);return s<a?o*s/a:s-a+o},T);if(o.getClosest(h,k,r),!1!==r.index){var A=h[r.index],M=d.c2p(A.x,!0),S=m.c2p(A.y,!0),E=A.mrc||1;r.index=A.i;var L=h[0].t.orientation,C=L&&(A.sNorm||A.s),P="h"===L?C:void 0!==A.orig_x?A.orig_x:A.x,I="v"===L?C:void 0!==A.orig_y?A.orig_y:A.y;return a.extendFlat(r,{color:l(p,A),x0:M-E,x1:M+E,xLabelVal:P,y0:S-E,y1:S+E,yLabelVal:I,spikeDistance:T(A),hovertemplate:p.hovertemplate}),u(A,p,r),s.getComponentMethod("errorbars","hoverInfo")(A,p,r),[r]}}if(-1!==x.indexOf("fills")&&p._polygons){var O,z,D,R,F,B,N,j,U,V=p._polygons,H=[],q=!1,G=1/0,Y=-1/0,W=1/0,X=-1/0;for(O=0;O<V.length;O++)(D=V[O]).contains(y)&&(q=!q,H.push(D),W=Math.min(W,D.ymin),X=Math.max(X,D.ymax));if(q){var Z=((W=Math.max(W,0))+(X=Math.min(X,m._length)))/2;for(O=0;O<H.length;O++)for(R=H[O].pts,z=1;z<R.length;z++)(j=R[z-1][1])>Z!=(U=R[z][1])>=Z&&(B=R[z-1][0],N=R[z][0],U-j&&(G=Math.min(G,F=B+(N-B)*(Z-j)/(U-j)),Y=Math.max(Y,F)));G=Math.max(G,0),Y=Math.min(Y,d._length);var J=c.defaultLine;return c.opacity(p.fillcolor)?J=p.fillcolor:c.opacity((p.line||{}).color)&&(J=p.line.color),a.extendFlat(r,{distance:r.maxHoverDistance,x0:G,x1:Y,y0:Z,y1:Z,color:J,hovertemplate:!1}),delete r.index,p.text&&!Array.isArray(p.text)?r.text=String(p.text):r.text=p.name,[r]}}}},{"../../components/color":366,"../../components/fx":406,"../../lib":503,"../../registry":638,"./get_trace_color":936}],938:[function(r,n,i){"use strict";var a=r("./subtypes");n.exports={hasLines:a.hasLines,hasMarkers:a.hasMarkers,hasText:a.hasText,isBubble:a.isBubble,attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("./cross_trace_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./cross_trace_calc"),arraysToCalcdata:r("./arrays_to_calcdata"),plot:r("./plot"),colorbar:r("./marker_colorbar"),formatLabels:r("./format_labels"),style:r("./style").style,styleOnSelect:r("./style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"./arrays_to_calcdata":925,"./attributes":926,"./calc":927,"./cross_trace_calc":931,"./cross_trace_defaults":932,"./defaults":933,"./format_labels":935,"./hover":937,"./marker_colorbar":944,"./plot":947,"./select":948,"./style":950,"./subtypes":951}],939:[function(r,n,i){"use strict";var a=r("../../lib").isArrayOrTypedArray,o=r("../../components/colorscale/helpers").hasColorscale,s=r("../../components/colorscale/defaults");n.exports=function(r,n,i,l,c,u){var f=(r.marker||{}).color;(c("line.color",i),o(r,"line"))?s(r,n,l,c,{prefix:"line.",cLetter:"c"}):c("line.color",!a(f)&&f||i),c("line.width"),(u||{}).noDash||c("line.dash")}},{"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503}],940:[function(r,n,i){"use strict";var a=r("../../constants/numerical"),o=a.BADNUM,s=a.LOG_CLIP,l=s+.5,c=s-.5,u=r("../../lib"),f=u.segmentsIntersect,h=u.constrain,p=r("./constants");n.exports=function(r,n){var i,a,s,d,m,g,v,y,x,b,_,w,T,k,A,M,S,E,L=n.xaxis,C=n.yaxis,P="log"===L.type,I="log"===C.type,O=L._length,z=C._length,D=n.connectGaps,R=n.baseTolerance,F=n.shape,B="linear"===F,N=n.fill&&"none"!==n.fill,j=[],U=p.minTolerance,V=r.length,H=Array(V),q=0;function G(i){var a=r[i];if(!a)return!1;var s=n.linearized?L.l2p(a.x):L.c2p(a.x),u=n.linearized?C.l2p(a.y):C.c2p(a.y);if(s===o){if(P&&(s=L.c2p(a.x,!0)),s===o)return!1;I&&u===o&&(s*=Math.abs(L._m*z*(L._m>0?l:c)/(C._m*O*(C._m>0?l:c)))),s*=1e3}if(u===o){if(I&&(u=C.c2p(a.y,!0)),u===o)return!1;u*=1e3}return[s,u]}function Y(r,n,i,a){var o=i-r,s=a-n,l=.5-r,c=.5-n,u=o*o+s*s,f=o*l+s*c;if(f>0&&f<u){var h=l*s-c*o;if(h*h<u)return!0}}function W(r,n){var i=r[0]/O,a=r[1]/z,o=Math.max(0,-i,i-1,-a,a-1);return o&&void 0!==S&&Y(i,a,S,E)&&(o=0),o&&n&&Y(i,a,n[0]/O,n[1]/z)&&(o=0),(1+p.toleranceGrowth*o)*R}function X(r,n){var i=r[0]-n[0],a=r[1]-n[1];return Math.sqrt(i*i+a*a)}var Z,J,K,Q,$,tt,te,tr=p.maxScreensAway,tn=-O*tr,ti=O*(1+tr),ta=-z*tr,to=z*(1+tr),ts=[[tn,ta,ti,ta],[ti,ta,ti,to],[ti,to,tn,to],[tn,to,tn,ta]];function tl(r){if(r[0]<tn||r[0]>ti||r[1]<ta||r[1]>to)return[h(r[0],tn,ti),h(r[1],ta,to)]}function tc(r,n){return r[0]===n[0]&&(r[0]===tn||r[0]===ti)||r[1]===n[1]&&(r[1]===ta||r[1]===to)||void 0}function tu(r,n,i){return function(a,o){var s=tl(a),l=tl(o),c=[];if(s&&l&&tc(s,l))return c;s&&c.push(s),l&&c.push(l);var f=2*u.constrain((a[r]+o[r])/2,n,i)-((s||a)[r]+(l||o)[r]);return f&&((s&&l?f>0==s[r]>l[r]?s:l:s||l)[r]+=f),c}}function tf(r){var n=r[0],i=r[1],a=n===H[q-1][0],o=i===H[q-1][1];if(!a||!o){if(q>1){var s=n===H[q-2][0],l=i===H[q-2][1];a&&(n===tn||n===ti)&&s?l?q--:H[q-1]=r:o&&(i===ta||i===to)&&l?s?q--:H[q-1]=r:H[q++]=r}else H[q++]=r}}function th(r){H[q-1][0]!==r[0]&&H[q-1][1]!==r[1]&&tf([K,Q]),tf(r),$=null,K=Q=0}function tp(r){if(S=r[0]/O,E=r[1]/z,Z=r[0]<tn?tn:r[0]>ti?ti:0,J=r[1]<ta?ta:r[1]>to?to:0,Z||J){if(q){if($){var n,i,a,o=te($,r);o.length>1&&(th(o[0]),H[q++]=o[1])}else tt=te(H[q-1],r)[0],H[q++]=tt}else H[q++]=[Z||r[0],J||r[1]];var s=H[q-1];Z&&J&&(s[0]!==Z||s[1]!==J)?($&&(K!==Z&&Q!==J?tf(K&&Q?(n=$,i=r[0]-n[0],a=(r[1]-n[1])/i,(n[1]*r[0]-r[1]*n[0])/i>0?[a>0?tn:ti,to]:[a>0?ti:tn,ta]):[K||Z,Q||J]):K&&Q&&tf([K,Q])),tf([Z,J])):K-Z&&Q-J&&tf([Z||K,J||Q]),$=r,K=Z,Q=J}else $&&th(te($,r)[0]),H[q++]=r}for("linear"===F||"spline"===F?te=function(r,n){for(var i=[],a=0,o=0;o<4;o++){var s=ts[o],l=f(r[0],r[1],n[0],n[1],s[0],s[1],s[2],s[3]);l&&(!a||Math.abs(l.x-i[0][0])>1||Math.abs(l.y-i[0][1])>1)&&(l=[l.x,l.y],a&&X(l,r)<X(i[0],r)?i.unshift(l):i.push(l),a++)}return i}:"hv"===F||"vh"===F?te=function(r,n){var i=[],a=tl(r),o=tl(n);return a&&o&&tc(a,o)||(a&&i.push(a),o&&i.push(o)),i}:"hvh"===F?te=tu(0,tn,ti):"vhv"===F&&(te=tu(1,ta,to)),i=0;i<V;i++)if(a=G(i)){for(q=0,$=null,tp(a),i++;i<V;i++){if(!(d=G(i))){if(D)continue;break}if(B&&n.simplify){var td=G(i+1);if(b=X(d,a),N&&(0===q||q===V-1)||!(b<W(d,td)*U)){for(y=[(d[0]-a[0])/b,(d[1]-a[1])/b],m=a,_=b,w=k=A=0,v=!1,s=d,i++;i<r.length;i++){if(g=td,td=G(i+1),!g){if(D)continue;break}if(k=Math.min(k,M=(x=[g[0]-a[0],g[1]-a[1]])[0]*y[1]-x[1]*y[0]),(A=Math.max(A,M))-k>W(g,td))break;s=g,(T=x[0]*y[0]+x[1]*y[1])>_?(_=T,d=g,v=!1):T<w&&(w=T,m=g,v=!0)}if(v?(tp(d),s!==m&&tp(m)):(m!==a&&tp(m),s!==d&&tp(d)),tp(s),i>=r.length||!g)break;tp(g),a=g}}else tp(d)}$&&tf([K||$[0],Q||$[1]]),j.push(H.slice(0,q))}return j}},{"../../constants/numerical":479,"../../lib":503,"./constants":930}],941:[function(r,n,i){"use strict";n.exports=function(r,n,i){"spline"===i("line.shape")&&i("line.smoothing")}},{}],942:[function(r,n,i){"use strict";var a={tonextx:1,tonexty:1,tonext:1};n.exports=function(r,n,i){var o,s,l,c,u,f={},h=!1,p=-1,d=0,m=-1;for(s=0;s<i.length;s++)(l=(o=i[s][0].trace).stackgroup||"")?l in f?u=f[l]:(u=f[l]=d,d++):o.fill in a&&m>=0?u=m:(u=m=d,d++),u<p&&(h=!0),o._groupIndex=p=u;var g=i.slice();h&&g.sort(function(r,n){var i=r[0].trace,a=n[0].trace;return i._groupIndex-a._groupIndex||i.index-a.index});var v={};for(s=0;s<g.length;s++)l=(o=g[s][0].trace).stackgroup||"",!0===o.visible?(o._nexttrace=null,o.fill in a&&(c=v[l],o._prevtrace=c||null,c&&(c._nexttrace=o)),o._ownfill=o.fill&&("tozero"===o.fill.substr(0,6)||"toself"===o.fill||"to"===o.fill.substr(0,2)&&!o._prevtrace),v[l]=o):o._prevtrace=o._nexttrace=o._ownfill=null;return g}},{}],943:[function(r,n,i){"use strict";var a=r("fast-isnumeric");n.exports=function(r,n){n||(n=2);var i=r.marker,o=i.sizeref||1,s=i.sizemin||0,l="area"===i.sizemode?function(r){return Math.sqrt(r/o)}:function(r){return r/o};return function(r){var i=l(r/n);return a(i)&&i>0?Math.max(i,s):0}}},{"fast-isnumeric":190}],944:[function(r,n,i){"use strict";n.exports={container:"marker",min:"cmin",max:"cmax"}},{}],945:[function(r,n,i){"use strict";var a=r("../../components/color"),o=r("../../components/colorscale/helpers").hasColorscale,s=r("../../components/colorscale/defaults"),l=r("./subtypes");n.exports=function(r,n,i,c,u,f){var h=l.isBubble(r),p=(r.line||{}).color;f=f||{},p&&(i=p),u("marker.symbol"),u("marker.opacity",h?.7:1),u("marker.size"),u("marker.color",i),o(r,"marker")&&s(r,n,c,u,{prefix:"marker.",cLetter:"c"}),f.noSelect||(u("selected.marker.color"),u("unselected.marker.color"),u("selected.marker.size"),u("unselected.marker.size")),f.noLine||(u("marker.line.color",p&&!Array.isArray(p)&&n.marker.color!==p?p:h?a.background:a.defaultLine),o(r,"marker.line")&&s(r,n,c,u,{prefix:"marker.line.",cLetter:"c"}),u("marker.line.width",h?1:0)),h&&(u("marker.sizeref"),u("marker.sizemin"),u("marker.sizemode")),f.gradient&&"none"!==u("marker.gradient.type")&&u("marker.gradient.color")}},{"../../components/color":366,"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"./subtypes":951}],946:[function(r,n,i){"use strict";var a=r("../../lib").dateTick0,o=r("../../constants/numerical").ONEWEEK;function s(r,n){return a(n,r%o==0?1:0)}n.exports=function(r,n,i,a,o){if(o||(o={x:!0,y:!0}),o.x){var l=a("xperiod");l&&(a("xperiod0",s(l,n.xcalendar)),a("xperiodalignment"))}if(o.y){var c=a("yperiod");c&&(a("yperiod0",s(c,n.ycalendar)),a("yperiodalignment"))}}},{"../../constants/numerical":479,"../../lib":503}],947:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../registry"),s=r("../../lib"),l=s.ensureSingle,c=s.identity,u=r("../../components/drawing"),f=r("./subtypes"),h=r("./line_points"),p=r("./link_traces"),d=r("../../lib/polygon").tester;function m(r,n,i,p,m,g,v){!function(r,n,i,o,l){var c=i.xaxis,u=i.yaxis,h=a.extent(s.simpleMap(c.range,c.r2c)),p=a.extent(s.simpleMap(u.range,u.r2c)),d=o[0].trace;if(f.hasMarkers(d)){var m=d.marker.maxdisplayed;if(0!==m){var g=o.filter(function(r){return r.x>=h[0]&&r.x<=h[1]&&r.y>=p[0]&&r.y<=p[1]}),v=Math.ceil(g.length/m),y=0;l.forEach(function(r,i){var a=r[0].trace;f.hasMarkers(a)&&a.marker.maxdisplayed>0&&i<n&&y++});var x=Math.round(y*v/3+Math.floor(y/3)*v/7.1);o.forEach(function(r){delete r.vis}),g.forEach(function(r,n){0===Math.round((n+x)%v)&&(r.vis=!0)})}}}(0,n,i,p,m);var y=!!v&&v.duration>0;function x(r){return y?r.transition():r}var b=i.xaxis,_=i.yaxis,w=p[0].trace,T=w.line,k=a.select(g),A=l(k,"g","errorbars"),M=l(k,"g","lines"),S=l(k,"g","points"),E=l(k,"g","text");if(o.getComponentMethod("errorbars","plot")(r,A,i,v),!0===w.visible){x(k).style("opacity",w.opacity);var L=w.fill.charAt(w.fill.length-1);"x"!==L&&"y"!==L&&(L=""),p[0][i.isRangePlot?"nodeRangePlot3":"node3"]=k;var C,P,I,O,z,D="",R=[],F=w._prevtrace;F&&(D=F._prevRevpath||"",I=F._nextFill,R=F._polygons);var B,N,j,U,V,H,q="",G="",Y=[],W=s.noop;if(P=w._ownFill,f.hasLines(w)||"none"!==w.fill){for(I&&I.datum(p),-1!==["hv","vh","hvh","vhv"].indexOf(T.shape)?(B=u.steps(T.shape),N=u.steps(T.shape.split("").reverse().join(""))):B=N="spline"===T.shape?function(r){var n=r[r.length-1];return r.length>1&&r[0][0]===n[0]&&r[0][1]===n[1]?u.smoothclosed(r.slice(1),T.smoothing):u.smoothopen(r,T.smoothing)}:function(r){return"M"+r.join("L")},Y=h(p,{xaxis:b,yaxis:_,connectGaps:w.connectgaps,baseTolerance:Math.max(T.width||1,3)/4,shape:T.shape,simplify:T.simplify,fill:w.fill}),H=w._polygons=Array(Y.length),C=0;C<Y.length;C++)w._polygons[C]=d(Y[C]);Y.length&&(j=Y[0][0],V=(U=Y[Y.length-1])[U.length-1]),W=function(r){return function(n){if(O=B(n),z=N(n.reverse()),q?L?(q+="L"+O.substr(1),G=z+"L"+G.substr(1)):(q+="Z"+O,G=z+"Z"+G):(q=O,G=z),f.hasLines(w)&&n.length>1){var i=a.select(this);if(i.datum(p),r)x(i.style("opacity",0).attr("d",O).call(u.lineGroupStyle)).style("opacity",1);else{var o=x(i);o.attr("d",O),u.singleLineStyle(p,o)}}}}}var X=M.selectAll(".js-line").data(Y);x(X.exit()).style("opacity",0).remove(),X.each(W(!1)),X.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(u.lineGroupStyle).each(W(!0)),u.setClipUrl(X,i.layerClipId,r),Y.length?(P?(P.datum(p),j&&V&&(L?("y"===L?j[1]=V[1]=_.c2p(0,!0):"x"===L&&(j[0]=V[0]=b.c2p(0,!0)),x(P).attr("d","M"+V+"L"+j+"L"+q.substr(1)).call(u.singleFillStyle)):x(P).attr("d",q+"Z").call(u.singleFillStyle))):I&&("tonext"===w.fill.substr(0,6)&&q&&D?("tonext"===w.fill?x(I).attr("d",q+"Z"+D+"Z").call(u.singleFillStyle):x(I).attr("d",q+"L"+D.substr(1)+"Z").call(u.singleFillStyle),w._polygons=w._polygons.concat(R)):(J(I),w._polygons=null)),w._prevRevpath=G,w._prevPolygons=H):(P?J(P):I&&J(I),w._polygons=w._prevRevpath=w._prevPolygons=null),S.datum(p),E.datum(p),function(n,o,s){var l,h=s[0].trace,p=f.hasMarkers(h),d=f.hasText(h),m=function(r){if(r.ids)return tt}(h),g=te,v=te;if(p||d){var w=c,T=h.stackgroup,k=T&&"infer zero"===r._fullLayout._scatterStackOpts[b._id+_._id][T].stackgaps;h.marker.maxdisplayed||h._needsCull?w=k?Q:K:T&&!k&&(w=$),p&&(g=w),d&&(v=w)}var A,M=(l=n.selectAll("path.point").data(g,m)).enter().append("path").classed("point",!0);y&&M.call(u.pointStyle,h,r).call(u.translatePoints,b,_).style("opacity",0).transition().style("opacity",1),l.order(),p&&(A=u.makePointStyleFns(h)),l.each(function(n){var o=a.select(this),s=x(o);u.translatePoint(n,s,b,_)?(u.singlePointStyle(n,s,h,A,r),i.layerClipId&&u.hideOutsideRangePoint(n,s,b,_,h.xcalendar,h.ycalendar),h.customdata&&o.classed("plotly-customdata",null!==n.data&&void 0!==n.data)):s.remove()}),y?l.exit().transition().style("opacity",0).remove():l.exit().remove(),(l=o.selectAll("g").data(v,m)).enter().append("g").classed("textpoint",!0).append("text"),l.order(),l.each(function(r){var n=a.select(this),o=x(n.select("text"));u.translatePoint(r,o,b,_)?i.layerClipId&&u.hideOutsideRangePoint(r,n,b,_,h.xcalendar,h.ycalendar):n.remove()}),l.selectAll("text").call(u.textPointStyle,h,r).each(function(r){var n=b.c2p(r.x),i=_.c2p(r.y);a.select(this).selectAll("tspan.line").each(function(){x(a.select(this)).attr({x:n,y:i})})}),l.exit().remove()}(S,E,p);var Z=!1===w.cliponaxis?null:i.layerClipId;u.setClipUrl(S,Z,r),u.setClipUrl(E,Z,r)}function J(r){x(r).attr("d","M0,0Z")}function K(r){return r.filter(function(r){return!r.gap&&r.vis})}function Q(r){return r.filter(function(r){return r.vis})}function $(r){return r.filter(function(r){return!r.gap})}function tt(r){return r.id}function te(){return!1}}n.exports=function(r,n,i,o,s,f){var h,d,g=!s,v=!!s&&s.duration>0,y=p(r,n,i);((h=o.selectAll("g.trace").data(y,function(r){return r[0].trace.uid})).enter().append("g").attr("class",function(r){return"trace scatter trace"+r[0].trace.uid}).style("stroke-miterlimit",2),h.order(),function(r,n,i){n.each(function(n){var o=l(a.select(this),"g","fills");u.setClipUrl(o,i.layerClipId,r);var s=n[0].trace,f=[];s._ownfill&&f.push("_ownFill"),s._nexttrace&&f.push("_nextFill");var h=o.selectAll("g").data(f,c);h.enter().append("g"),h.exit().each(function(r){s[r]=null}).remove(),h.order().each(function(r){s[r]=l(a.select(this),"path","js-fill")})})}(r,h,n),v)?(f&&(d=f()),a.transition().duration(s.duration).ease(s.easing).each("end",function(){d&&d()}).each("interrupt",function(){d&&d()}).each(function(){o.selectAll("g.trace").each(function(i,a){m(r,a,n,i,y,this,s)})})):h.each(function(i,a){m(r,a,n,i,y,this,s)}),g&&h.exit().remove(),o.selectAll("path:not([d])").remove()}},{"../../components/drawing":388,"../../lib":503,"../../lib/polygon":515,"../../registry":638,"./line_points":940,"./link_traces":942,"./subtypes":951,"@plotly/d3":58}],948:[function(r,n,i){"use strict";var a=r("./subtypes");n.exports=function(r,n){var i,o,s,l,c=r.cd,u=r.xaxis,f=r.yaxis,h=[],p=c[0].trace;if(!a.hasMarkers(p)&&!a.hasText(p))return[];if(!1===n)for(i=0;i<c.length;i++)c[i].selected=0;else for(i=0;i<c.length;i++)o=c[i],s=u.c2p(o.x),l=f.c2p(o.y),null!==o.i&&n.contains([s,l],!1,i,r)?(h.push({pointNumber:o.i,x:u.c2d(o.x),y:f.c2d(o.y)}),o.selected=1):o.selected=0;return h}},{"./subtypes":951}],949:[function(r,n,i){"use strict";var a=["orientation","groupnorm","stackgaps"];n.exports=function(r,n,i,o){var s=i._scatterStackOpts,l=o("stackgroup");if(l){var c=n.xaxis+n.yaxis,u=s[c];u||(u=s[c]={});var f=u[l],h=!1;f?f.traces.push(n):(f=u[l]={traceIndices:[],traces:[n]},h=!0);for(var p={orientation:n.x&&!n.y?"h":"v"},d=0;d<a.length;d++){var m=a[d],g=m+"Found";if(!f[g]){var v=void 0!==r[m],y="orientation"===m;if((v||h)&&(f[m]=o(m,p[m]),y&&(f.fillDflt="h"===f[m]?"tonextx":"tonexty"),v&&(f[g]=!0,!h&&(delete f.traces[0][m],y))))for(var x=0;x<f.traces.length-1;x++){var b=f.traces[x];b._input.fill!==b.fill&&(b.fill=f.fillDflt)}}}return f}}},{}],950:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/drawing"),s=r("../../registry");function l(r,n,i){o.pointStyle(r.selectAll("path.point"),n,i)}function c(r,n,i){o.textPointStyle(r.selectAll("text"),n,i)}n.exports={style:function(r){var n=a.select(r).selectAll("g.trace.scatter");n.style("opacity",function(r){return r[0].trace.opacity}),n.selectAll("g.points").each(function(n){l(a.select(this),n.trace||n[0].trace,r)}),n.selectAll("g.text").each(function(n){c(a.select(this),n.trace||n[0].trace,r)}),n.selectAll("g.trace path.js-line").call(o.lineGroupStyle),n.selectAll("g.trace path.js-fill").call(o.fillGroupStyle),s.getComponentMethod("errorbars","style")(n)},stylePoints:l,styleText:c,styleOnSelect:function(r,n,i){var a=n[0].trace;a.selectedpoints?(o.selectedPointStyle(i.selectAll("path.point"),a),o.selectedTextStyle(i.selectAll("text"),a)):(l(i,a,r),c(i,a,r))}}},{"../../components/drawing":388,"../../registry":638,"@plotly/d3":58}],951:[function(r,n,i){"use strict";var a=r("../../lib");n.exports={hasLines:function(r){return r.visible&&r.mode&&-1!==r.mode.indexOf("lines")},hasMarkers:function(r){return r.visible&&(r.mode&&-1!==r.mode.indexOf("markers")||"splom"===r.type)},hasText:function(r){return r.visible&&r.mode&&-1!==r.mode.indexOf("text")},isBubble:function(r){return a.isPlainObject(r.marker)&&a.isArrayOrTypedArray(r.marker.size)}}},{"../../lib":503}],952:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n,i,o,s){s=s||{},o("textposition"),a.coerceFont(o,"textfont",i.font),s.noSelect||(o("selected.textfont.color"),o("unselected.textfont.color"))}},{"../../lib":503}],953:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../registry");n.exports=function(r,n,i,s){var l,c=s("x"),u=s("y");if(o.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x","y"],i),c){var f=a.minRowLength(c);u?l=Math.min(f,a.minRowLength(u)):(l=f,s("y0"),s("dy"))}else{if(!u)return 0;l=a.minRowLength(u),s("x0"),s("dx")}return n._length=l,l}},{"../../lib":503,"../../registry":638}],954:[function(r,n,i){"use strict";var a=r("../scatter/attributes"),o=r("../../components/colorscale/attributes"),s=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,l=r("../../plots/template_attributes").hovertemplateAttrs,c=r("../../plots/template_attributes").texttemplateAttrs,u=r("../../plots/attributes"),f=r("../../constants/gl3d_dashes"),h=r("../../constants/gl3d_markers"),p=r("../../lib/extend").extendFlat,d=r("../../plot_api/edit_types").overrideAll,m=r("../../lib/sort_object_keys"),g=a.line,v=a.marker,y=v.line,x=p({width:g.width,dash:{valType:"enumerated",values:m(f),dflt:"solid"}},o("line")),b=n.exports=d({x:a.x,y:a.y,z:{valType:"data_array"},text:p({},a.text,{}),texttemplate:c({},{}),hovertext:p({},a.hovertext,{}),hovertemplate:l(),xhoverformat:s("x"),yhoverformat:s("y"),zhoverformat:s("z"),mode:p({},a.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:a.connectgaps,line:x,marker:p({symbol:{valType:"enumerated",values:m(h),dflt:"circle",arrayOk:!0},size:p({},v.size,{dflt:8}),sizeref:v.sizeref,sizemin:v.sizemin,sizemode:v.sizemode,opacity:p({},v.opacity,{arrayOk:!1}),colorbar:v.colorbar,line:p({width:p({},y.width,{arrayOk:!1})},o("marker.line"))},o("marker")),textposition:p({},a.textposition,{dflt:"top center"}),textfont:{color:a.textfont.color,size:a.textfont.size,family:p({},a.textfont.family,{arrayOk:!1})},opacity:u.opacity,hoverinfo:p({},u.hoverinfo)},"calc","nested");b.x.editType=b.y.editType=b.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":373,"../../constants/gl3d_dashes":476,"../../constants/gl3d_markers":477,"../../lib/extend":493,"../../lib/sort_object_keys":526,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../scatter/attributes":926}],955:[function(r,n,i){"use strict";var a=r("../scatter/arrays_to_calcdata"),o=r("../scatter/colorscale_calc");n.exports=function(r,n){var i=[{x:!1,y:!1,trace:n,t:{}}];return a(i,n),o(r,n),i}},{"../scatter/arrays_to_calcdata":925,"../scatter/colorscale_calc":929}],956:[function(r,n,i){"use strict";var a=r("../../registry");function o(r,n,i,o){if(!n||!n.visible)return null;for(var s=a.getComponentMethod("errorbars","makeComputeError")(n),l=Array(r.length),c=0;c<r.length;c++){var u=s(+r[c],c);if("log"===o.type){var f=o.c2l(r[c]),h=r[c]-u[0],p=r[c]+u[1];if(l[c]=[(o.c2l(h,!0)-f)*i,(o.c2l(p,!0)-f)*i],h>0){var d=o.c2l(h);o._lowerLogErrorBound||(o._lowerLogErrorBound=d),o._lowerErrorBound=Math.min(o._lowerLogErrorBound,d)}}else l[c]=[-u[0]*i,u[1]*i]}return l}n.exports=function(r,n,i){var a=[o(r.x,r.error_x,n[0],i.xaxis),o(r.y,r.error_y,n[1],i.yaxis),o(r.z,r.error_z,n[2],i.zaxis)],s=function(r){for(var n=0;n<r.length;n++)if(r[n])return r[n].length;return 0}(a);if(0===s)return null;for(var l=Array(s),c=0;c<s;c++){for(var u=[[0,0,0],[0,0,0]],f=0;f<3;f++)if(a[f])for(var h=0;h<2;h++)u[h][f]=a[f][c][h];l[c]=u}return l}},{"../../registry":638}],957:[function(r,n,i){"use strict";var a=r("../../../stackgl_modules").gl_line3d,o=r("../../../stackgl_modules").gl_scatter3d,s=r("../../../stackgl_modules").gl_error3d,l=r("../../../stackgl_modules").gl_mesh3d,c=r("../../../stackgl_modules").delaunay_triangulate,u=r("../../lib"),f=r("../../lib/str2rgbarray"),h=r("../../lib/gl_format_color").formatColor,p=r("../scatter/make_bubble_size_func"),d=r("../../constants/gl3d_dashes"),m=r("../../constants/gl3d_markers"),g=r("../../plots/cartesian/axes"),v=r("../../components/fx/helpers").appendArrayPointValue,y=r("./calc_errors");function x(r,n){this.scene=r,this.uid=n,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var b=x.prototype;function _(r){return null==r?0:r.indexOf("left")>-1?-1:r.indexOf("right")>-1?1:0}function w(r){return null==r?0:r.indexOf("top")>-1?-1:r.indexOf("bottom")>-1?1:0}function T(r,n){return n(4*r)}function k(r){return m[r]}function A(r,n,i,a,o){var s=null;if(u.isArrayOrTypedArray(r)){s=[];for(var l=0;l<n;l++)void 0===r[l]?s[l]=a:s[l]=i(r[l],o)}else s=i(r,u.identity);return s}function M(r){if(u.isArrayOrTypedArray(r)){var n=r[0];return u.isArrayOrTypedArray(n)&&(r=n),"rgb("+r.slice(0,3).map(function(r){return Math.round(255*r)})+")"}return null}function S(r){return u.isArrayOrTypedArray(r)?4===r.length&&"number"==typeof r[0]?M(r):r.map(M):null}b.handlePick=function(r){if(r.object&&(r.object===this.linePlot||r.object===this.delaunayMesh||r.object===this.textMarkers||r.object===this.scatterPlot)){var n=r.index=r.data.index;return r.object.highlight&&r.object.highlight(null),this.scatterPlot&&(r.object=this.scatterPlot,this.scatterPlot.highlight(r.data)),r.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[n]||0===this.textLabels[n])&&(r.textLabel=this.textLabels[n]):r.textLabel=this.textLabels),r.traceCoordinate=[this.data.x[n],this.data.y[n],this.data.z[n]],!0}},b.update=function(r){var n,i,m,x,b=this.scene.glplot.gl,M=d.solid;this.data=r;var E=function(r,n){var i,a,o,s,l,c,d=[],m=r.fullSceneLayout,x=r.dataScale,b=m.xaxis,M=m.yaxis,S=m.zaxis,E=n.marker,L=n.line,C=n.x||[],P=n.y||[],I=n.z||[],O=C.length,z=n.xcalendar,D=n.ycalendar,R=n.zcalendar;for(l=0;l<O;l++)i=b.d2l(C[l],0,z)*x[0],a=M.d2l(P[l],0,D)*x[1],o=S.d2l(I[l],0,R)*x[2],d[l]=[i,a,o];if(Array.isArray(n.text))c=n.text;else if(void 0!==n.text)for(c=Array(O),l=0;l<O;l++)c[l]=n.text;function F(r,n){var i=m[r];return g.tickText(i,i.d2l(n),!0).text}var B=n.texttemplate;if(B){var N=r.fullLayout._d3locale,j=Array.isArray(B),U=j?Math.min(B.length,O):O,V=j?function(r){return B[r]}:function(){return B};for(c=Array(U),l=0;l<U;l++){var H={x:C[l],y:P[l],z:I[l]},q={xLabel:F("xaxis",C[l]),yLabel:F("yaxis",P[l]),zLabel:F("zaxis",I[l])},G={};v(G,n,l);var Y=n._meta||{};c[l]=u.texttemplateString(V(l),q,N,G,H,Y)}}if(s={position:d,mode:n.mode,text:c},"line"in n&&(s.lineColor=h(L,1,O),s.lineWidth=L.width,s.lineDashes=L.dash),"marker"in n){var W=p(n);s.scatterColor=h(E,1,O),s.scatterSize=A(E.size,O,T,20,W),s.scatterMarker=A(E.symbol,O,k,""),s.scatterLineWidth=E.line.width,s.scatterLineColor=h(E.line,1,O),s.scatterAngle=0}"textposition"in n&&(s.textOffset=function(r){var n=[0,0];if(Array.isArray(r))for(var i=0;i<r.length;i++)n[i]=[0,0],r[i]&&(n[i][0]=_(r[i]),n[i][1]=w(r[i]));else n[0]=_(r),n[1]=w(r);return n}(n.textposition),s.textColor=h(n.textfont,1,O),s.textSize=A(n.textfont.size,O,u.identity,12),s.textFont=n.textfont.family,s.textAngle=0);var X=["x","y","z"];for(s.project=[!1,!1,!1],s.projectScale=[1,1,1],s.projectOpacity=[1,1,1],l=0;l<3;++l){var Z=n.projection[X[l]];(s.project[l]=Z.show)&&(s.projectOpacity[l]=Z.opacity,s.projectScale[l]=Z.scale)}s.errorBounds=y(n,x,m);var J=function(r){for(var n=[0,0,0],i=[[0,0,0],[0,0,0],[0,0,0]],a=[1,1,1],o=0;o<3;o++){var s=r[o];s&&!1!==s.copy_zstyle&&!1!==r[2].visible&&(s=r[2]),s&&s.visible&&(n[o]=s.width/2,i[o]=f(s.color),a[o]=s.thickness)}return{capSize:n,color:i,lineWidth:a}}([n.error_x,n.error_y,n.error_z]);return s.errorColor=J.color,s.errorLineWidth=J.lineWidth,s.errorCapSize=J.capSize,s.delaunayAxis=n.surfaceaxis,s.delaunayColor=f(n.surfacecolor),s}(this.scene,r);"mode"in E&&(this.mode=E.mode),"lineDashes"in E&&E.lineDashes in d&&(M=d[E.lineDashes]),this.color=S(E.scatterColor)||S(E.lineColor),this.dataPoints=E.position,n={gl:this.scene.glplot.gl,position:E.position,color:E.lineColor,lineWidth:E.lineWidth||1,dashes:M[0],dashScale:M[1],opacity:r.opacity,connectGaps:r.connectgaps},-1!==this.mode.indexOf("lines")?this.linePlot?this.linePlot.update(n):(this.linePlot=a(n),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var L=r.opacity;if(r.marker&&r.marker.opacity&&(L*=r.marker.opacity),i={gl:this.scene.glplot.gl,position:E.position,color:E.scatterColor,size:E.scatterSize,glyph:E.scatterMarker,opacity:L,orthographic:!0,lineWidth:E.scatterLineWidth,lineColor:E.scatterLineColor,project:E.project,projectScale:E.projectScale,projectOpacity:E.projectOpacity},-1!==this.mode.indexOf("markers")?this.scatterPlot?this.scatterPlot.update(i):(this.scatterPlot=o(i),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),x={gl:this.scene.glplot.gl,position:E.position,glyph:E.text,color:E.textColor,size:E.textSize,angle:E.textAngle,alignment:E.textOffset,font:E.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:r.opacity},this.textLabels=r.hovertext||r.text,-1!==this.mode.indexOf("text")?this.textMarkers?this.textMarkers.update(x):(this.textMarkers=o(x),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),m={gl:this.scene.glplot.gl,position:E.position,color:E.errorColor,error:E.errorBounds,lineWidth:E.errorLineWidth,capSize:E.errorCapSize,opacity:r.opacity},this.errorBars?E.errorBounds?this.errorBars.update(m):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):E.errorBounds&&(this.errorBars=s(m),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),E.delaunayAxis>=0){var C=function(r,n,i){var a,o=(i+1)%3,s=(i+2)%3,l=[],u=[];for(a=0;a<r.length;++a){var f=r[a];!isNaN(f[o])&&isFinite(f[o])&&!isNaN(f[s])&&isFinite(f[s])&&(l.push([f[o],f[s]]),u.push(a))}var h=c(l);for(a=0;a<h.length;++a)for(var p=h[a],d=0;d<p.length;++d)p[d]=u[p[d]];return{positions:r,cells:h,meshColor:n}}(E.position,E.delaunayColor,E.delaunayAxis);C.opacity=r.opacity,this.delaunayMesh?this.delaunayMesh.update(C):(C.gl=b,this.delaunayMesh=l(C),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},b.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},n.exports=function(r,n){var i=new x(r,n.uid);return i.update(n),i}},{"../../../stackgl_modules":1120,"../../components/fx/helpers":402,"../../constants/gl3d_dashes":476,"../../constants/gl3d_markers":477,"../../lib":503,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/cartesian/axes":554,"../scatter/make_bubble_size_func":943,"./calc_errors":956}],958:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("../scatter/subtypes"),l=r("../scatter/marker_defaults"),c=r("../scatter/line_defaults"),u=r("../scatter/text_defaults"),f=r("./attributes");n.exports=function(r,n,i,h){function p(i,a){return o.coerce(r,n,f,i,a)}if(d=0,m=p("x"),g=p("y"),v=p("z"),a.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x","y","z"],h),m&&g&&v&&(d=Math.min(m.length,g.length,v.length),n._length=n._xlength=n._ylength=n._zlength=d),d){p("text"),p("hovertext"),p("hovertemplate"),p("xhoverformat"),p("yhoverformat"),p("zhoverformat"),p("mode"),s.hasLines(n)&&(p("connectgaps"),c(r,n,i,h,p)),s.hasMarkers(n)&&l(r,n,i,h,p,{noSelect:!0}),s.hasText(n)&&(p("texttemplate"),u(r,n,h,p,{noSelect:!0}));var d,m,g,v,y=(n.line||{}).color,x=(n.marker||{}).color;p("surfaceaxis")>=0&&p("surfacecolor",y||x);for(var b=["x","y","z"],_=0;_<3;++_){var w="projection."+b[_];p(w+".show")&&(p(w+".opacity"),p(w+".scale"))}var T=a.getComponentMethod("errorbars","supplyDefaults");T(r,n,y||x||i,{axis:"z"}),T(r,n,y||x||i,{axis:"y",inherit:"z"}),T(r,n,y||x||i,{axis:"x",inherit:"z"})}else n.visible=!1}},{"../../lib":503,"../../registry":638,"../scatter/line_defaults":939,"../scatter/marker_defaults":945,"../scatter/subtypes":951,"../scatter/text_defaults":952,"./attributes":954}],959:[function(r,n,i){"use strict";n.exports={plot:r("./convert"),attributes:r("./attributes"),markerSymbols:r("../../constants/gl3d_markers"),supplyDefaults:r("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:r("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":477,"../../plots/gl3d":598,"./attributes":954,"./calc":955,"./convert":957,"./defaults":958}],960:[function(r,n,i){"use strict";var a=r("../scatter/attributes"),o=r("../../plots/attributes"),s=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../../plots/template_attributes").texttemplateAttrs,c=r("../../components/colorscale/attributes"),u=r("../../lib/extend").extendFlat,f=a.marker,h=a.line,p=f.line;n.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:u({},a.mode,{dflt:"markers"}),text:u({},a.text,{}),texttemplate:l({editType:"plot"},{keys:["a","b","text"]}),hovertext:u({},a.hovertext,{}),line:{color:h.color,width:h.width,dash:h.dash,shape:u({},h.shape,{values:["linear","spline"]}),smoothing:h.smoothing,editType:"calc"},connectgaps:a.connectgaps,fill:u({},a.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:a.fillcolor,marker:u({symbol:f.symbol,opacity:f.opacity,maxdisplayed:f.maxdisplayed,size:f.size,sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,line:u({width:p.width,editType:"calc"},c("marker.line")),gradient:f.gradient,editType:"calc"},c("marker")),textfont:a.textfont,textposition:a.textposition,selected:a.selected,unselected:a.unselected,hoverinfo:u({},o.hoverinfo,{flags:["a","b","text","name"]}),hoveron:a.hoveron,hovertemplate:s()}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":926}],961:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../scatter/colorscale_calc"),s=r("../scatter/arrays_to_calcdata"),l=r("../scatter/calc_selection"),c=r("../scatter/calc").calcMarkerSize,u=r("../carpet/lookup_carpetid");n.exports=function(r,n){var i=n._carpetTrace=u(r,n);if(i&&i.visible&&"legendonly"!==i.visible){n.xaxis=i.xaxis,n.yaxis=i.yaxis;var f,h,p,d=n._length,m=Array(d),g=!1;for(f=0;f<d;f++)if(h=n.a[f],p=n.b[f],a(h)&&a(p)){var v=i.ab2xy(+h,+p,!0),y=i.isVisible(+h,+p);y||(g=!0),m[f]={x:v[0],y:v[1],a:h,b:p,vis:y}}else m[f]={x:!1,y:!1};return n._needsCull=g,m[0].carpet=i,m[0].trace=n,c(n,d),o(r,n),s(m,n),l(m,n),m}}},{"../carpet/lookup_carpetid":708,"../scatter/arrays_to_calcdata":925,"../scatter/calc":927,"../scatter/calc_selection":928,"../scatter/colorscale_calc":929,"fast-isnumeric":190}],962:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/constants"),s=r("../scatter/subtypes"),l=r("../scatter/marker_defaults"),c=r("../scatter/line_defaults"),u=r("../scatter/line_shape_defaults"),f=r("../scatter/text_defaults"),h=r("../scatter/fillcolor_defaults"),p=r("./attributes");n.exports=function(r,n,i,d){function m(i,o){return a.coerce(r,n,p,i,o)}m("carpet"),n.xaxis="x",n.yaxis="y";var g=m("a"),v=m("b"),y=Math.min(g.length,v.length);if(y){n._length=y,m("text"),m("texttemplate"),m("hovertext"),m("mode",y<o.PTS_LINESONLY?"lines+markers":"lines"),s.hasLines(n)&&(c(r,n,i,d,m),u(r,n,m),m("connectgaps")),s.hasMarkers(n)&&l(r,n,i,d,m,{gradient:!0}),s.hasText(n)&&f(r,n,d,m);var x=[];(s.hasMarkers(n)||s.hasText(n))&&(m("marker.maxdisplayed"),x.push("points")),m("fill"),"none"!==n.fill&&(h(r,n,i,m),s.hasLines(n)||u(r,n,m)),"tonext"!==n.fill&&"toself"!==n.fill||x.push("fills"),"fills"!==m("hoveron",x.join("+")||"points")&&m("hovertemplate"),a.coerceSelectionMarkerOpacity(n,m)}else n.visible=!1}},{"../../lib":503,"../scatter/constants":930,"../scatter/fillcolor_defaults":934,"../scatter/line_defaults":939,"../scatter/line_shape_defaults":941,"../scatter/marker_defaults":945,"../scatter/subtypes":951,"../scatter/text_defaults":952,"./attributes":960}],963:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o){var s=a[o];return r.a=s.a,r.b=s.b,r.y=s.y,r}},{}],964:[function(r,n,i){"use strict";n.exports=function(r,n){var i={},a=n._carpet,o=a.ab2ij([r.a,r.b]),s=Math.floor(o[0]),l=o[0]-s,c=Math.floor(o[1]),u=o[1]-c,f=a.evalxy([],s,c,l,u);return i.yLabel=f[1].toFixed(3),i}},{}],965:[function(r,n,i){"use strict";var a=r("../scatter/hover"),o=r("../../lib").fillText;n.exports=function(r,n,i,s){var l=a(r,n,i,s);if(l&&!1!==l[0].index){var c=l[0];if(void 0===c.index){var u=1-c.y0/r.ya._length,f=r.xa._length,h=f*u/2,p=f-h;return c.x0=Math.max(Math.min(c.x0,p),h),c.x1=Math.max(Math.min(c.x1,p),h),l}var d=c.cd[c.index];c.a=d.a,c.b=d.b,c.xLabelVal=void 0,c.yLabelVal=void 0;var m=c.trace,g=m._carpet,v=m._module.formatLabels(d,m);c.yLabel=v.yLabel,delete c.text;var y=[];if(!m.hovertemplate){var x=(d.hi||m.hoverinfo).split("+");-1!==x.indexOf("all")&&(x=["a","b","text"]),-1!==x.indexOf("a")&&b(g.aaxis,d.a),-1!==x.indexOf("b")&&b(g.baxis,d.b),y.push("y: "+c.yLabel),-1!==x.indexOf("text")&&o(d,m,y),c.extraText=y.join("<br>")}return l}function b(r,n){var i;i=r.labelprefix&&r.labelprefix.length>0?r.labelprefix.replace(/ = $/,""):r._hovertitle,y.push(i+": "+n.toFixed(3)+r.labelsuffix)}}},{"../../lib":503,"../scatter/hover":937}],966:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../scatter/select"),eventData:r("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:r("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../scatter/marker_colorbar":944,"../scatter/select":948,"../scatter/style":950,"./attributes":960,"./calc":961,"./defaults":962,"./event_data":963,"./format_labels":964,"./hover":965,"./plot":967}],967:[function(r,n,i){"use strict";var a=r("../scatter/plot"),o=r("../../plots/cartesian/axes"),s=r("../../components/drawing");n.exports=function(r,n,i,l){var c,u,f,h=i[0][0].carpet,p={xaxis:o.getFromId(r,h.xaxis||"x"),yaxis:o.getFromId(r,h.yaxis||"y"),plot:n.plot};for(a(r,p,i,l),c=0;c<i.length;c++)u=i[c][0].trace,f=l.selectAll("g.trace"+u.uid+" .js-line"),s.setClipUrl(f,i[c][0].carpet._clipPathId,r)}},{"../../components/drawing":388,"../../plots/cartesian/axes":554,"../scatter/plot":947}],968:[function(r,n,i){"use strict";var a=r("../../plots/template_attributes").hovertemplateAttrs,o=r("../../plots/template_attributes").texttemplateAttrs,s=r("../scatter/attributes"),l=r("../../plots/attributes"),c=r("../../components/colorscale/attributes"),u=r("../../components/drawing/attributes").dash,f=r("../../lib/extend").extendFlat,h=r("../../plot_api/edit_types").overrideAll,p=s.marker,d=s.line,m=p.line;n.exports=h({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:f({},s.mode,{dflt:"markers"}),text:f({},s.text,{}),texttemplate:o({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:f({},s.hovertext,{}),textfont:s.textfont,textposition:s.textposition,line:{color:d.color,width:d.width,dash:u},connectgaps:s.connectgaps,marker:f({symbol:p.symbol,opacity:p.opacity,size:p.size,sizeref:p.sizeref,sizemin:p.sizemin,sizemode:p.sizemode,colorbar:p.colorbar,line:f({width:m.width},c("marker.line")),gradient:p.gradient},c("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:s.fillcolor,selected:s.selected,unselected:s.unselected,hoverinfo:f({},l.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:a()},"calc","nested")},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":926}],969:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../constants/numerical").BADNUM,s=r("../scatter/colorscale_calc"),l=r("../scatter/arrays_to_calcdata"),c=r("../scatter/calc_selection"),u=r("../../lib")._;function f(r){return r&&"string"==typeof r}n.exports=function(r,n){var i,h=Array.isArray(n.locations),p=h?n.locations.length:n._length,d=Array(p);i=n.geojson?function(r){return f(r)||a(r)}:f;for(var m=0;m<p;m++){var g=d[m]={};if(h){var v=n.locations[m];g.loc=i(v)?v:null}else{var y=n.lon[m],x=n.lat[m];a(y)&&a(x)?g.lonlat=[+y,+x]:g.lonlat=[o,o]}}return l(d,n),s(r,n),c(d,n),p&&(d[0].t={labels:{lat:u(r,"lat:")+" ",lon:u(r,"lon:")+" "}}),d}},{"../../constants/numerical":479,"../../lib":503,"../scatter/arrays_to_calcdata":925,"../scatter/calc_selection":928,"../scatter/colorscale_calc":929,"fast-isnumeric":190}],970:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/subtypes"),s=r("../scatter/marker_defaults"),l=r("../scatter/line_defaults"),c=r("../scatter/text_defaults"),u=r("../scatter/fillcolor_defaults"),f=r("./attributes");n.exports=function(r,n,i,h){function p(i,o){return a.coerce(r,n,f,i,o)}var d,m=p("locations");if(m&&m.length){var g,v=p("geojson");("string"==typeof v&&""!==v||a.isPlainObject(v))&&(g="geojson-id"),"geojson-id"===p("locationmode",g)&&p("featureidkey"),d=m.length}else{var y=p("lon")||[],x=p("lat")||[];d=Math.min(y.length,x.length)}d?(n._length=d,p("text"),p("hovertext"),p("hovertemplate"),p("mode"),o.hasLines(n)&&(l(r,n,i,h,p),p("connectgaps")),o.hasMarkers(n)&&s(r,n,i,h,p,{gradient:!0}),o.hasText(n)&&(p("texttemplate"),c(r,n,h,p)),p("fill"),"none"!==n.fill&&u(r,n,i,p),a.coerceSelectionMarkerOpacity(n,p)):n.visible=!1}},{"../../lib":503,"../scatter/fillcolor_defaults":934,"../scatter/line_defaults":939,"../scatter/marker_defaults":945,"../scatter/subtypes":951,"../scatter/text_defaults":952,"./attributes":968}],971:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o){r.lon=n.lon,r.lat=n.lat,r.location=n.loc?n.loc:null;var s=a[o];return s.fIn&&s.fIn.properties&&(r.properties=s.fIn.properties),r}},{}],972:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes");n.exports=function(r,n,i){var o={},s=i[n.geo]._subplot.mockAxis,l=r.lonlat;return o.lonLabel=a.tickText(s,s.c2l(l[0]),!0).text,o.latLabel=a.tickText(s,s.c2l(l[1]),!0).text,o}},{"../../plots/cartesian/axes":554}],973:[function(r,n,i){"use strict";var a=r("../../components/fx"),o=r("../../constants/numerical").BADNUM,s=r("../scatter/get_trace_color"),l=r("../../lib").fillText,c=r("./attributes");n.exports=function(r,n,i){var u=r.cd,f=u[0].trace,h=r.xa,p=r.ya,d=r.subplot,m=d.projection.isLonLatOverEdges,g=d.project;if(a.getClosest(u,function(r){var a=r.lonlat;if(a[0]===o||m(a))return 1/0;var s=g(a),l=g([n,i]),c=Math.abs(s[0]-l[0]),u=Math.abs(s[1]-l[1]),f=Math.max(3,r.mrc||0);return Math.max(Math.sqrt(c*c+u*u)-f,1-3/f)},r),!1!==r.index){var v=u[r.index],y=v.lonlat,x=[h.c2p(y),p.c2p(y)],b=v.mrc||1;r.x0=x[0]-b,r.x1=x[0]+b,r.y0=x[1]-b,r.y1=x[1]+b,r.loc=v.loc,r.lon=y[0],r.lat=y[1];var _={};_[f.geo]={_subplot:d};var w=f._module.formatLabels(v,f,_);return r.lonLabel=w.lonLabel,r.latLabel=w.latLabel,r.color=s(f,v),r.extraText=function(r,n,i,a){if(!r.hovertemplate){var o=n.hi||r.hoverinfo,s="all"===o?c.hoverinfo.flags:o.split("+"),u=-1!==s.indexOf("location")&&Array.isArray(r.locations),f=-1!==s.indexOf("lon"),h=-1!==s.indexOf("lat"),p=-1!==s.indexOf("text"),d=[];return u?d.push(n.loc):f&&h?d.push("("+i.latLabel+"\xb0, "+i.lonLabel+"\xb0)"):f?d.push(a.lon+(i.lonLabel+"\xb0")):h&&d.push(a.lat+(i.latLabel+"\xb0")),p&&l(n,r,d),d.join("<br>")}}(f,v,r,u[0].t.labels),r.hovertemplate=f.hovertemplate,[r]}}},{"../../components/fx":406,"../../constants/numerical":479,"../../lib":503,"../scatter/get_trace_color":936,"./attributes":968}],974:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),calcGeoJSON:r("./plot").calcGeoJSON,plot:r("./plot").plot,style:r("./style"),styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:r("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":589,"../scatter/marker_colorbar":944,"../scatter/style":950,"./attributes":968,"./calc":969,"./defaults":970,"./event_data":971,"./format_labels":972,"./hover":973,"./plot":975,"./select":976,"./style":977}],975:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../lib/topojson_utils").getTopojsonFeatures,l=r("../../lib/geojson_utils"),c=r("../../lib/geo_location_utils"),u=r("../../plots/cartesian/autorange").findExtremes,f=r("../../constants/numerical").BADNUM,h=r("../scatter/calc").calcMarkerSize,p=r("../scatter/subtypes"),d=r("./style");n.exports={calcGeoJSON:function(r,n){var i,a,o=r[0].trace,l=n[o.geo],p=l._subplot,d=o._length;if(Array.isArray(o.locations)){var m=o.locationmode,g="geojson-id"===m?c.extractTraceFeature(r):s(o,p.topojson);for(i=0;i<d;i++){a=r[i];var v="geojson-id"===m?a.fOut:c.locationToFeature(m,a.loc,g);a.lonlat=v?v.properties.ct:[f,f]}}var y,x,b={padded:!0};if("geojson"===l.fitbounds&&"geojson-id"===o.locationmode){var _=c.computeBbox(c.getTraceGeojson(o));y=[_[0],_[2]],x=[_[1],_[3]]}else{for(y=Array(d),x=Array(d),i=0;i<d;i++)a=r[i],y[i]=a.lonlat[0],x[i]=a.lonlat[1];b.ppad=h(o,d)}o._extremes.lon=u(l.lonaxis._ax,y,b),o._extremes.lat=u(l.lataxis._ax,x,b)},plot:function(r,n,i){var s=n.layers.frontplot.select(".scatterlayer"),c=o.makeTraceGroups(s,i,"trace scattergeo");function u(r,n){r.lonlat[0]===f&&a.select(n).remove()}c.selectAll("*").remove(),c.each(function(n){var i=a.select(this),s=n[0].trace;if(p.hasLines(s)||"none"!==s.fill){var c=l.calcTraceToLineCoords(n),f="none"!==s.fill?l.makePolygon(c):l.makeLine(c);i.selectAll("path.js-line").data([{geojson:f,trace:s}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}p.hasMarkers(s)&&i.selectAll("path.point").data(o.identity).enter().append("path").classed("point",!0).each(function(r){u(r,this)}),p.hasText(s)&&i.selectAll("g").data(o.identity).enter().append("g").append("text").each(function(r){u(r,this)}),d(r,n)})}}},{"../../constants/numerical":479,"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/geojson_utils":497,"../../lib/topojson_utils":532,"../../plots/cartesian/autorange":553,"../scatter/calc":927,"../scatter/subtypes":951,"./style":977,"@plotly/d3":58}],976:[function(r,n,i){"use strict";var a=r("../scatter/subtypes"),o=r("../../constants/numerical").BADNUM;n.exports=function(r,n){var i,s,l,c,u,f=r.cd,h=r.xaxis,p=r.yaxis,d=[],m=f[0].trace;if(!a.hasMarkers(m)&&!a.hasText(m))return[];if(!1===n)for(u=0;u<f.length;u++)f[u].selected=0;else for(u=0;u<f.length;u++)(s=(i=f[u]).lonlat)[0]!==o&&(l=h.c2p(s),c=p.c2p(s),n.contains([l,c],null,u,r)?(d.push({pointNumber:u,lon:s[0],lat:s[1]}),i.selected=1):i.selected=0);return d}},{"../../constants/numerical":479,"../scatter/subtypes":951}],977:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/drawing"),s=r("../../components/color"),l=r("../scatter/style"),c=l.stylePoints,u=l.styleText;n.exports=function(r,n){var i,l;n&&(i=n[0].trace,(l=n[0].node3).style("opacity",n[0].trace.opacity),c(l,i,r),u(l,i,r),l.selectAll("path.js-line").style("fill","none").each(function(r){var n=a.select(this),i=r.trace,l=i.line||{};n.call(s.stroke,l.color).call(o.dashLine,l.dash||"",l.width||0),"none"!==i.fill&&n.call(s.fill,i.fillcolor)}))}},{"../../components/color":366,"../../components/drawing":388,"../scatter/style":950,"@plotly/d3":58}],978:[function(r,n,i){"use strict";var a=r("../../plots/attributes"),o=r("../scatter/attributes"),s=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,l=r("../../components/colorscale/attributes"),c=r("../../lib/sort_object_keys"),u=r("../../lib/extend").extendFlat,f=r("../../plot_api/edit_types").overrideAll,h=r("./constants").DASHES,p=o.line,d=o.marker,m=d.line,g=n.exports=f({x:o.x,x0:o.x0,dx:o.dx,y:o.y,y0:o.y0,dy:o.dy,xperiod:o.xperiod,yperiod:o.yperiod,xperiod0:o.xperiod0,yperiod0:o.yperiod0,xperiodalignment:o.xperiodalignment,yperiodalignment:o.yperiodalignment,xhoverformat:s("x"),yhoverformat:s("y"),text:o.text,hovertext:o.hovertext,textposition:o.textposition,textfont:o.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:p.color,width:p.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:c(h),dflt:"solid"}},marker:u({},l("marker"),{symbol:d.symbol,size:d.size,sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,opacity:d.opacity,colorbar:d.colorbar,line:u({},l("marker.line"),{width:m.width})}),connectgaps:o.connectgaps,fill:u({},o.fill,{dflt:"none"}),fillcolor:o.fillcolor,selected:{marker:o.selected.marker,textfont:o.selected.textfont},unselected:{marker:o.unselected.marker,textfont:o.unselected.textfont},opacity:a.opacity},"calc","nested");g.x.editType=g.y.editType=g.x0.editType=g.y0.editType="calc+clearAxisTypes",g.hovertemplate=o.hovertemplate,g.texttemplate=o.texttemplate},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../lib/sort_object_keys":526,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../scatter/attributes":926,"./constants":980}],979:[function(r,n,i){"use strict";var a=r("@plotly/point-cluster"),o=r("../../lib"),s=r("../../plots/cartesian/axis_ids"),l=r("../../plots/cartesian/autorange").findExtremes,c=r("../../plots/cartesian/align_period"),u=r("../scatter/calc"),f=u.calcMarkerSize,h=u.calcAxisExpansion,p=u.setFirstScatter,d=r("../scatter/colorscale_calc"),m=r("./convert"),g=r("./scene_update"),v=r("../../constants/numerical").BADNUM,y=r("./constants").TOO_MANY_POINTS;function x(r,n,i){var a=r._extremes[n._id],o=l(n,i._bnds,{padded:!0});a.min=a.min.concat(o.min),a.max=a.max.concat(o.max)}n.exports=function(r,n){var i,l=r._fullLayout,u=s.getFromId(r,n.xaxis),b=s.getFromId(r,n.yaxis),_=l._plots[n.xaxis+n.yaxis],w=n._length,T=w>=y,k=2*w,A={},M=u.makeCalcdata(n,"x"),S=b.makeCalcdata(n,"y"),E=c(n,u,"x",M),L=c(n,b,"y",S),C=E.vals,P=L.vals;n._x=C,n._y=P,n.xperiodalignment&&(n._origX=M,n._xStarts=E.starts,n._xEnds=E.ends),n.yperiodalignment&&(n._origY=S,n._yStarts=L.starts,n._yEnds=L.ends);var I=Array(k),O=Array(w);for(i=0;i<w;i++)I[2*i]=C[i]===v?NaN:C[i],I[2*i+1]=P[i]===v?NaN:P[i],O[i]=i;if("log"===u.type)for(i=0;i<k;i+=2)I[i]=u.c2l(I[i]);if("log"===b.type)for(i=1;i<k;i+=2)I[i]=b.c2l(I[i]);T&&"log"!==u.type&&"log"!==b.type?A.tree=a(I):A.ids=O,d(r,n);var z,D=function(r,n,i,a,s,l){var c=m.style(r,i);if(c.marker&&(c.marker.positions=a),c.line&&a.length>1&&o.extendFlat(c.line,m.linePositions(r,i,a)),c.errorX||c.errorY){var u=m.errorBarPositions(r,i,a,s,l);c.errorX&&o.extendFlat(c.errorX,u.x),c.errorY&&o.extendFlat(c.errorY,u.y)}return c.text&&(o.extendFlat(c.text,{positions:a},m.textPosition(r,i,c.text,c.marker)),o.extendFlat(c.textSel,{positions:a},m.textPosition(r,i,c.text,c.markerSel)),o.extendFlat(c.textUnsel,{positions:a},m.textPosition(r,i,c.text,c.markerUnsel))),c}(r,0,n,I,C,P),R=g(r,_);return p(l,n),T?D.marker&&(z=D.marker.sizeAvg||Math.max(D.marker.size,3)):z=f(n,w),h(r,n,u,b,C,P,z),D.errorX&&x(n,u,D.errorX),D.errorY&&x(n,b,D.errorY),D.fill&&!R.fill2d&&(R.fill2d=!0),D.marker&&!R.scatter2d&&(R.scatter2d=!0),D.line&&!R.line2d&&(R.line2d=!0),(D.errorX||D.errorY)&&!R.error2d&&(R.error2d=!0),D.text&&!R.glText&&(R.glText=!0),D.marker&&(D.marker.snap=w),R.lineOptions.push(D.line),R.errorXOptions.push(D.errorX),R.errorYOptions.push(D.errorY),R.fillOptions.push(D.fill),R.markerOptions.push(D.marker),R.markerSelectedOptions.push(D.markerSel),R.markerUnselectedOptions.push(D.markerUnsel),R.textOptions.push(D.text),R.textSelectedOptions.push(D.textSel),R.textUnselectedOptions.push(D.textUnsel),R.selectBatch.push([]),R.unselectBatch.push([]),A._scene=R,A.index=R.count,A.x=C,A.y=P,A.positions=I,R.count++,[{x:!1,y:!1,t:A,trace:n}]}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/autorange":553,"../../plots/cartesian/axis_ids":558,"../scatter/calc":927,"../scatter/colorscale_calc":929,"./constants":980,"./convert":981,"./scene_update":989,"@plotly/point-cluster":59}],980:[function(r,n,i){"use strict";n.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],981:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("svg-path-sdf"),s=r("color-normalize"),l=r("../../registry"),c=r("../../lib"),u=r("../../components/drawing"),f=r("../../plots/cartesian/axis_ids"),h=r("../../lib/gl_format_color").formatColor,p=r("../scatter/subtypes"),d=r("../scatter/make_bubble_size_func"),m=r("./helpers"),g=r("./constants"),v=r("../../constants/interactions").DESELECTDIM,y={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},x=r("../../components/fx/helpers").appendArrayPointValue;function b(r,n){var i,o=r._fullLayout,s=n._length,l=n.textfont,u=n.textposition,f=Array.isArray(u)?u:[u],h=l.color,p=l.size,d=l.family,m={},g=r._context.plotGlPixelRatio,v=n.texttemplate;if(v){m.text=[];var y=o._d3locale,b=Array.isArray(v),_=b?Math.min(v.length,s):s,w=b?function(r){return v[r]}:function(){return v};for(i=0;i<_;i++){var T={i:i},k=n._module.formatLabels(T,n,o),A={};x(A,n,i);var M=n._meta||{};m.text.push(c.texttemplateString(w(i),k,y,A,T,M))}}else Array.isArray(n.text)&&n.text.length<s?m.text=n.text.slice():m.text=n.text;if(Array.isArray(m.text))for(i=m.text.length;i<s;i++)m.text[i]="";for(m.opacity=n.opacity,m.font={},m.align=[],m.baseline=[],i=0;i<f.length;i++){var S=f[i].split(/\s+/);switch(S[1]){case"left":m.align.push("right");break;case"right":m.align.push("left");break;default:m.align.push(S[1])}switch(S[0]){case"top":m.baseline.push("bottom");break;case"bottom":m.baseline.push("top");break;default:m.baseline.push(S[0])}}if(Array.isArray(h))for(m.color=Array(s),i=0;i<s;i++)m.color[i]=h[i];else m.color=h;if(c.isArrayOrTypedArray(p)||Array.isArray(d))for(m.font=Array(s),i=0;i<s;i++){var E=m.font[i]={};E.size=(c.isTypedArray(p)?p[i]:Array.isArray(p)?a(p[i])?p[i]:0:p)*g,E.family=Array.isArray(d)?d[i]:d}else m.font={size:p*g,family:d};return m}function _(r){var n,i,a=r._length,o=r.marker,l={},u=c.isArrayOrTypedArray(o.symbol),f=c.isArrayOrTypedArray(o.color),p=c.isArrayOrTypedArray(o.line.color),g=c.isArrayOrTypedArray(o.opacity),v=c.isArrayOrTypedArray(o.size),y=c.isArrayOrTypedArray(o.line.width);if(u||(i=m.isOpenSymbol(o.symbol)),u||f||p||g){l.colors=Array(a),l.borderColors=Array(a);var x=h(o,o.opacity,a),b=h(o.line,o.opacity,a);if(!Array.isArray(b[0])){var _=b;for(b=Array(a),n=0;n<a;n++)b[n]=_}if(!Array.isArray(x[0])){var w=x;for(x=Array(a),n=0;n<a;n++)x[n]=w}for(l.colors=x,l.borderColors=b,n=0;n<a;n++){if(u){var T=o.symbol[n];i=m.isOpenSymbol(T)}i&&(b[n]=x[n].slice(),x[n]=x[n].slice(),x[n][3]=0)}l.opacity=r.opacity}else i?(l.color=s(o.color,"uint8"),l.color[3]=0,l.borderColor=s(o.color,"uint8")):(l.color=s(o.color,"uint8"),l.borderColor=s(o.line.color,"uint8")),l.opacity=r.opacity*o.opacity;if(u)for(l.markers=Array(a),n=0;n<a;n++)l.markers[n]=C(o.symbol[n]);else l.marker=C(o.symbol);var k,A=d(r,1);if(v||y){var M,S=l.sizes=Array(a),E=l.borderSizes=Array(a),L=0;if(v){for(n=0;n<a;n++)S[n]=A(o.size[n]),L+=S[n];M=L/a}else for(k=A(o.size),n=0;n<a;n++)S[n]=k;if(y)for(n=0;n<a;n++)E[n]=o.line.width[n];else for(k=o.line.width,n=0;n<a;n++)E[n]=k;l.sizeAvg=M}else l.size=A(o&&o.size||10),l.borderSizes=A(o.line.width);return l}function w(r,n){var i=r.marker,a={};return n&&(n.marker&&n.marker.symbol?a=_(c.extendFlat({},i,n.marker)):n.marker&&(n.marker.size&&(a.size=n.marker.size),n.marker.color&&(a.colors=n.marker.color),void 0!==n.marker.opacity&&(a.opacity=n.marker.opacity))),a}function T(r,n,i){var a={};if(!i)return a;if(i.textfont){var o={opacity:1,text:n.text,texttemplate:n.texttemplate,textposition:n.textposition,textfont:c.extendFlat({},n.textfont)};i.textfont&&c.extendFlat(o.textfont,i.textfont),a=b(r,o)}return a}function k(r,n,i){var a={capSize:2*n.width*i,lineWidth:n.thickness*i,color:n.color};return n.copy_ystyle&&(a=r.error_y),a}var A=g.SYMBOL_SDF_SIZE,M=g.SYMBOL_SIZE,S=g.SYMBOL_STROKE,E={},L=u.symbolFuncs[0](.05*M);function C(r){if("circle"===r)return null;var n,i=u.symbolNumber(r),a=u.symbolFuncs[i%100],s=!!u.symbolNoDot[i%100],l=!!u.symbolNoFill[i%100],c=m.isDotSymbol(r);return E[r]?E[r]:(n=o(c&&!s?a(1.1*M)+L:a(M),{w:A,h:A,viewBox:[-M,-M,M,M],stroke:l?S:-S}),E[r]=n,n||null)}n.exports={style:function(r,n){var i,a={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},o=r._context.plotGlPixelRatio;if(!0!==n.visible)return a;if(p.hasText(n)&&(a.text=b(r,n),a.textSel=T(r,n,n.selected),a.textUnsel=T(r,n,n.unselected)),p.hasMarkers(n)&&(a.marker=_(n),a.markerSel=w(n,n.selected),a.markerUnsel=w(n,n.unselected),!n.unselected&&c.isArrayOrTypedArray(n.marker.opacity))){var s=n.marker.opacity;for(a.markerUnsel.opacity=Array(s.length),i=0;i<s.length;i++)a.markerUnsel.opacity[i]=v*s[i]}if(p.hasLines(n)){a.line={overlay:!0,thickness:n.line.width*o,color:n.line.color,opacity:n.opacity};var l=(g.DASHES[n.line.dash]||[1]).slice();for(i=0;i<l.length;++i)l[i]*=n.line.width*o;a.line.dashes=l}return n.error_x&&n.error_x.visible&&(a.errorX=k(n,n.error_x,o)),n.error_y&&n.error_y.visible&&(a.errorY=k(n,n.error_y,o)),n.fill&&"none"!==n.fill&&(a.fill={closed:!0,fill:n.fillcolor,thickness:0}),a},markerStyle:_,markerSelection:w,linePositions:function(r,n,i){var a,o,s=i.length,l=s/2;if(p.hasLines(n)&&l){if("hv"===n.line.shape){for(a=[],o=0;o<l-1;o++)isNaN(i[2*o])||isNaN(i[2*o+1])?a.push(NaN,NaN,NaN,NaN):(a.push(i[2*o],i[2*o+1]),isNaN(i[2*o+2])||isNaN(i[2*o+3])?a.push(NaN,NaN):a.push(i[2*o+2],i[2*o+1]));a.push(i[s-2],i[s-1])}else if("hvh"===n.line.shape){for(a=[],o=0;o<l-1;o++)if(isNaN(i[2*o])||isNaN(i[2*o+1])||isNaN(i[2*o+2])||isNaN(i[2*o+3]))isNaN(i[2*o])||isNaN(i[2*o+1])?a.push(NaN,NaN):a.push(i[2*o],i[2*o+1]),a.push(NaN,NaN);else{var c=(i[2*o]+i[2*o+2])/2;a.push(i[2*o],i[2*o+1],c,i[2*o+1],c,i[2*o+3])}a.push(i[s-2],i[s-1])}else if("vhv"===n.line.shape){for(a=[],o=0;o<l-1;o++)if(isNaN(i[2*o])||isNaN(i[2*o+1])||isNaN(i[2*o+2])||isNaN(i[2*o+3]))isNaN(i[2*o])||isNaN(i[2*o+1])?a.push(NaN,NaN):a.push(i[2*o],i[2*o+1]),a.push(NaN,NaN);else{var u=(i[2*o+1]+i[2*o+3])/2;a.push(i[2*o],i[2*o+1],i[2*o],u,i[2*o+2],u)}a.push(i[s-2],i[s-1])}else if("vh"===n.line.shape){for(a=[],o=0;o<l-1;o++)isNaN(i[2*o])||isNaN(i[2*o+1])?a.push(NaN,NaN,NaN,NaN):(a.push(i[2*o],i[2*o+1]),isNaN(i[2*o+2])||isNaN(i[2*o+3])?a.push(NaN,NaN):a.push(i[2*o],i[2*o+3]));a.push(i[s-2],i[s-1])}else a=i}var f=!1;for(o=0;o<a.length;o++)if(isNaN(a[o])){f=!0;break}var h=f||a.length>g.TOO_MANY_POINTS||p.hasMarkers(n)?"rect":"round";if(f&&n.connectgaps){var d=a[0],m=a[1];for(o=0;o<a.length;o+=2)isNaN(a[o])||isNaN(a[o+1])?(a[o]=d,a[o+1]=m):(d=a[o],m=a[o+1])}return{join:h,positions:a}},errorBarPositions:function(r,n,i,o,s){var c=l.getComponentMethod("errorbars","makeComputeError"),u=f.getFromId(r,n.xaxis),h=f.getFromId(r,n.yaxis),p=i.length/2,d={};function m(r,o){var s=o._id.charAt(0),l=n["error_"+s];if(l&&l.visible&&("linear"===o.type||"log"===o.type)){for(var u=c(l),f={x:0,y:1}[s],h={x:[0,1,2,3],y:[2,3,0,1]}[s],m=new Float64Array(4*p),g=1/0,v=-1/0,y=0,x=0;y<p;y++,x+=4){var b=r[y];if(a(b)){var _=i[2*y+f],w=u(b,y),T=w[0],k=w[1];if(a(T)&&a(k)){var A=b-T,M=b+k;m[x+h[0]]=_-o.c2l(A),m[x+h[1]]=o.c2l(M)-_,m[x+h[2]]=0,m[x+h[3]]=0,g=Math.min(g,b-T),v=Math.max(v,b+k)}}}d[s]={positions:i,errors:m,_bnds:[g,v]}}}return m(o,u),m(s,h),d},textPosition:function(r,n,i,a){var o,s=n._length,l={};if(p.hasMarkers(n)){var c=i.font,u=i.align,f=i.baseline;for(l.offset=Array(s),o=0;o<s;o++){var h=a.sizes?a.sizes[o]:a.size,d=Array.isArray(c)?c[o].size:c.size,m=Array.isArray(u)?u.length>1?u[o]:u[0]:u,g=Array.isArray(f)?f.length>1?f[o]:f[0]:f,v=y[m],x=y[g],b=h?h/.8+1:0,_=-x*b-.5*x;l.offset[o]=[v*b/d,_/d]}}return l}}},{"../../components/drawing":388,"../../components/fx/helpers":402,"../../constants/interactions":478,"../../lib":503,"../../lib/gl_format_color":499,"../../plots/cartesian/axis_ids":558,"../../registry":638,"../scatter/make_bubble_size_func":943,"../scatter/subtypes":951,"./constants":980,"./helpers":985,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":310}],982:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../registry"),s=r("./helpers"),l=r("./attributes"),c=r("../scatter/constants"),u=r("../scatter/subtypes"),f=r("../scatter/xy_defaults"),h=r("../scatter/period_defaults"),p=r("../scatter/marker_defaults"),d=r("../scatter/line_defaults"),m=r("../scatter/fillcolor_defaults"),g=r("../scatter/text_defaults");n.exports=function(r,n,i,v){function y(i,o){return a.coerce(r,n,l,i,o)}var x=!!r.marker&&s.isOpenSymbol(r.marker.symbol),b=u.isBubble(r),_=f(r,n,v,y);if(_){h(r,n,v,y),y("xhoverformat"),y("yhoverformat");var w=_<c.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("hovertemplate"),y("mode",w),u.hasLines(n)&&(y("connectgaps"),d(r,n,i,v,y),y("line.shape")),u.hasMarkers(n)&&(p(r,n,i,v,y),y("marker.line.width",x||b?1:0)),u.hasText(n)&&(y("texttemplate"),g(r,n,v,y));var T=(n.line||{}).color,k=(n.marker||{}).color;y("fill"),"none"!==n.fill&&m(r,n,i,y);var A=o.getComponentMethod("errorbars","supplyDefaults");A(r,n,T||k||i,{axis:"y"}),A(r,n,T||k||i,{axis:"x",inherit:"y"}),a.coerceSelectionMarkerOpacity(n,y)}else n.visible=!1}},{"../../lib":503,"../../registry":638,"../scatter/constants":930,"../scatter/fillcolor_defaults":934,"../scatter/line_defaults":939,"../scatter/marker_defaults":945,"../scatter/period_defaults":946,"../scatter/subtypes":951,"../scatter/text_defaults":952,"../scatter/xy_defaults":953,"./attributes":978,"./helpers":985}],983:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/color"),s=r("../../constants/interactions").DESELECTDIM;n.exports={styleTextSelection:function(r){var n,i,l=r[0],c=l.trace,u=l.t,f=u._scene,h=u.index,p=f.selectBatch[h],d=f.unselectBatch[h],m=f.textOptions[h],g=f.textSelectedOptions[h]||{},v=f.textUnselectedOptions[h]||{},y=a.extendFlat({},m);if(p.length||d.length){var x=g.color,b=v.color,_=m.color,w=Array.isArray(_);for(y.color=Array(c._length),n=0;n<p.length;n++)i=p[n],y.color[i]=x||(w?_[i]:_);for(n=0;n<d.length;n++){i=d[n];var T=w?_[i]:_;y.color[i]=b||(x?T:o.addOpacity(T,s))}}f.glText[h].update(y)}}},{"../../components/color":366,"../../constants/interactions":478,"../../lib":503}],984:[function(r,n,i){"use strict";var a=r("../scatter/format_labels");n.exports=function(r,n,i){var o=r.i;return"x"in r||(r.x=n._x[o]),"y"in r||(r.y=n._y[o]),a(r,n,i)}},{"../scatter/format_labels":935}],985:[function(r,n,i){"use strict";var a=r("./constants");i.isOpenSymbol=function(r){return"string"==typeof r?a.OPEN_RE.test(r):r%200>100},i.isDotSymbol=function(r){return"string"==typeof r?a.DOT_RE.test(r):r>200}},{"./constants":980}],986:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("../scatter/get_trace_color");function l(r,n,i,l){var c=r.xa,u=r.ya,f=r.distance,h=r.dxy,p=r.index,d={pointNumber:p,x:n[p],y:i[p]};d.tx=Array.isArray(l.text)?l.text[p]:l.text,d.htx=Array.isArray(l.hovertext)?l.hovertext[p]:l.hovertext,d.data=Array.isArray(l.customdata)?l.customdata[p]:l.customdata,d.tp=Array.isArray(l.textposition)?l.textposition[p]:l.textposition;var m=l.textfont;m&&(d.ts=o.isArrayOrTypedArray(m.size)?m.size[p]:m.size,d.tc=Array.isArray(m.color)?m.color[p]:m.color,d.tf=Array.isArray(m.family)?m.family[p]:m.family);var g=l.marker;g&&(d.ms=o.isArrayOrTypedArray(g.size)?g.size[p]:g.size,d.mo=o.isArrayOrTypedArray(g.opacity)?g.opacity[p]:g.opacity,d.mx=o.isArrayOrTypedArray(g.symbol)?g.symbol[p]:g.symbol,d.mc=o.isArrayOrTypedArray(g.color)?g.color[p]:g.color);var v=g&&g.line;v&&(d.mlc=Array.isArray(v.color)?v.color[p]:v.color,d.mlw=o.isArrayOrTypedArray(v.width)?v.width[p]:v.width);var y=g&&g.gradient;y&&"none"!==y.type&&(d.mgt=Array.isArray(y.type)?y.type[p]:y.type,d.mgc=Array.isArray(y.color)?y.color[p]:y.color);var x=c.c2p(d.x,!0),b=u.c2p(d.y,!0),_=d.mrc||1,w=l.hoverlabel;w&&(d.hbg=Array.isArray(w.bgcolor)?w.bgcolor[p]:w.bgcolor,d.hbc=Array.isArray(w.bordercolor)?w.bordercolor[p]:w.bordercolor,d.hts=o.isArrayOrTypedArray(w.font.size)?w.font.size[p]:w.font.size,d.htc=Array.isArray(w.font.color)?w.font.color[p]:w.font.color,d.htf=Array.isArray(w.font.family)?w.font.family[p]:w.font.family,d.hnl=o.isArrayOrTypedArray(w.namelength)?w.namelength[p]:w.namelength);var T=l.hoverinfo;T&&(d.hi=Array.isArray(T)?T[p]:T);var k=l.hovertemplate;k&&(d.ht=Array.isArray(k)?k[p]:k);var A={};A[r.index]=d;var M=l._origX,S=l._origY,E=o.extendFlat({},r,{color:s(l,d),x0:x-_,x1:x+_,xLabelVal:M?M[p]:d.x,y0:b-_,y1:b+_,yLabelVal:S?S[p]:d.y,cd:A,distance:f,spikeDistance:h,hovertemplate:d.ht});return d.htx?E.text=d.htx:d.tx?E.text=d.tx:l.text&&(E.text=l.text),o.fillText(d,l,E),a.getComponentMethod("errorbars","hoverInfo")(d,l,E),E}n.exports={hoverPoints:function(r,n,i,a){var o,s,c,u,f,h,p,d,m,g,v=r.cd,y=v[0].t,x=v[0].trace,b=r.xa,_=r.ya,w=y.x,T=y.y,k=b.c2p(n),A=_.c2p(i),M=r.distance;if(y.tree){var S=b.p2c(k-M),E=b.p2c(k+M),L=_.p2c(A-M),C=_.p2c(A+M);o="x"===a?y.tree.range(Math.min(S,E),Math.min(_._rl[0],_._rl[1]),Math.max(S,E),Math.max(_._rl[0],_._rl[1])):y.tree.range(Math.min(S,E),Math.min(L,C),Math.max(S,E),Math.max(L,C))}else o=y.ids;var P=M;if("x"===a){var I=!!x.xperiodalignment,O=!!x.yperiodalignment;for(h=0;h<o.length;h++){if(u=w[s=o[h]],p=Math.abs(b.c2p(u)-k),I){var z=b.c2p(x._xStarts[s]),D=b.c2p(x._xEnds[s]);p=k>=Math.min(z,D)&&k<=Math.max(z,D)?0:1/0}if(p<P){if(P=p,f=T[s],d=_.c2p(f)-A,O){var R=_.c2p(x._yStarts[s]),F=_.c2p(x._yEnds[s]);d=A>=Math.min(R,F)&&A<=Math.max(R,F)?0:1/0}g=Math.sqrt(p*p+d*d),c=o[h]}}}else for(h=o.length-1;h>-1;h--)u=w[s=o[h]],f=T[s],(m=Math.sqrt((p=b.c2p(u)-k)*p+(d=_.c2p(f)-A)*d))<P&&(P=g=m,c=s);return r.index=c,r.distance=P,r.dxy=g,void 0===c?[r]:[l(r,w,T,x)]},calcHover:l}},{"../../lib":503,"../../registry":638,"../scatter/get_trace_color":936}],987:[function(r,n,i){"use strict";var a=r("./hover");n.exports={moduleType:"trace",name:"scattergl",basePlotModule:r("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../scatter/cross_trace_defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),hoverPoints:a.hoverPoints,selectPoints:r("./select"),meta:{}}},{"../../plots/cartesian":568,"../scatter/cross_trace_defaults":932,"../scatter/marker_colorbar":944,"./attributes":978,"./calc":979,"./defaults":982,"./format_labels":984,"./hover":986,"./plot":988,"./select":990}],988:[function(r,n,i){"use strict";var a=r("regl-scatter2d"),o=r("regl-line2d"),s=r("regl-error2d"),l=r("gl-text"),c=r("../../lib"),u=r("../../components/dragelement/helpers").selectMode,f=r("../../lib/prepare_regl"),h=r("../scatter/subtypes"),p=r("../scatter/link_traces"),d=r("./edit_style").styleTextSelection;n.exports=function(r,n,i){if(i.length){var m,g,v=r._fullLayout,y=n._scene,x=n.xaxis,b=n.yaxis;if(y){if(f(r,["ANGLE_instanced_arrays","OES_element_index_uint"])){var _,w,T,k,A,M,S,E,L,C,P=y.count,I=v._glcanvas.data()[0].regl;if(p(r,n,i),y.dirty){if(!0===y.error2d&&(y.error2d=s(I)),!0===y.line2d&&(y.line2d=o(I)),!0===y.scatter2d&&(y.scatter2d=a(I)),!0===y.fill2d&&(y.fill2d=o(I)),!0===y.glText)for(y.glText=Array(P),m=0;m<P;m++)y.glText[m]=new l(I);if(y.glText){if(P>y.glText.length){var O=P-y.glText.length;for(m=0;m<O;m++)y.glText.push(new l(I))}else if(P<y.glText.length){var z=y.glText.length-P;y.glText.splice(P,z).forEach(function(r){r.destroy()})}for(m=0;m<P;m++)y.glText[m].update(y.textOptions[m])}if(y.line2d&&(y.line2d.update(y.lineOptions),y.lineOptions=y.lineOptions.map(function(r){if(r&&r.positions){for(var n=r.positions,i=0;i<n.length&&(isNaN(n[i])||isNaN(n[i+1]));)i+=2;for(var a=n.length-2;a>i&&(isNaN(n[a])||isNaN(n[a+1]));)a-=2;r.positions=n.slice(i,a+2)}return r}),y.line2d.update(y.lineOptions)),y.error2d){var D=(y.errorXOptions||[]).concat(y.errorYOptions||[]);y.error2d.update(D)}y.scatter2d&&y.scatter2d.update(y.markerOptions),y.fillOrder=c.repeat(null,P),y.fill2d&&(y.fillOptions=y.fillOptions.map(function(r,n){var a=i[n];if(r&&a&&a[0]&&a[0].trace){var o,s,l=a[0],c=l.trace,u=l.t,f=y.lineOptions[n],h=[];c._ownfill&&h.push(n),c._nexttrace&&h.push(n+1),h.length&&(y.fillOrder[n]=h);var p,d,m=[],g=f&&f.positions||u.positions;if("tozeroy"===c.fill){for(p=0;p<g.length&&isNaN(g[p+1]);)p+=2;for(d=g.length-2;d>p&&isNaN(g[d+1]);)d-=2;0!==g[p+1]&&(m=[g[p],0]),m=m.concat(g.slice(p,d+2)),0!==g[d+1]&&(m=m.concat([g[d],0]))}else if("tozerox"===c.fill){for(p=0;p<g.length&&isNaN(g[p]);)p+=2;for(d=g.length-2;d>p&&isNaN(g[d]);)d-=2;0!==g[p]&&(m=[0,g[p+1]]),m=m.concat(g.slice(p,d+2)),0!==g[d]&&(m=m.concat([0,g[d+1]]))}else if("toself"===c.fill||"tonext"===c.fill){for(m=[],o=0,r.splitNull=!0,s=0;s<g.length;s+=2)(isNaN(g[s])||isNaN(g[s+1]))&&((m=m.concat(g.slice(o,s))).push(g[o],g[o+1]),m.push(null,null),o=s+2);m=m.concat(g.slice(o)),o&&m.push(g[o],g[o+1])}else{var v=c._nexttrace;if(v){var x=y.lineOptions[n+1];if(x){var b=x.positions;if("tonexty"===c.fill){for(m=g.slice(),n=Math.floor(b.length/2);n--;){var _=b[2*n],w=b[2*n+1];isNaN(_)||isNaN(w)||m.push(_,w)}r.fill=v.fillcolor}}}}if(c._prevtrace&&"tonext"===c._prevtrace.fill){var T=y.lineOptions[n-1].positions,k=m.length/2,A=[o=k];for(s=0;s<T.length;s+=2)(isNaN(T[s])||isNaN(T[s+1]))&&(A.push(s/2+k+1),o=s+2);m=m.concat(T),r.hole=A}return r.fillmode=c.fill,r.opacity=c.opacity,r.positions=m,r}}),y.fill2d.update(y.fillOptions))}var R=u(v.dragmode),F=v.clickmode.indexOf("select")>-1;for(m=0;m<P;m++){var B=i[m][0],N=B.trace,j=B.t,U=j.index,V=N._length,H=j.x,q=j.y;if(N.selectedpoints||R||F){if(R||(R=!0),N.selectedpoints){var G=y.selectBatch[U]=c.selIndices2selPoints(N),Y={};for(g=0;g<G.length;g++)Y[G[g]]=1;var W=[];for(g=0;g<V;g++)Y[g]||W.push(g);y.unselectBatch[U]=W}var X=j.xpx=Array(V),Z=j.ypx=Array(V);for(g=0;g<V;g++)X[g]=x.c2p(H[g]),Z[g]=b.c2p(q[g])}else j.xpx=j.ypx=null}if(R){if(y.select2d||(y.select2d=a(v._glcanvas.data()[1].regl)),y.scatter2d){var J=Array(P);for(m=0;m<P;m++)J[m]=y.selectBatch[m].length||y.unselectBatch[m].length?y.markerUnselectedOptions[m]:{};y.scatter2d.update(J)}y.select2d&&(y.select2d.update(y.markerOptions),y.select2d.update(y.markerSelectedOptions)),y.glText&&i.forEach(function(r){var n=((r||[])[0]||{}).trace||{};h.hasText(n)&&d(r)})}else y.scatter2d&&y.scatter2d.update(y.markerOptions);var K={viewport:(_=r._context.plotGlPixelRatio,w=v._size,T=v.width*_,k=v.height*_,A=w.l*_,M=w.b*_,S=w.r*_,E=w.t*_,L=w.w*_,C=w.h*_,[A+x.domain[0]*L,M+b.domain[0]*C,T-S-(1-x.domain[1])*L,k-E-(1-b.domain[1])*C]),range:[(x._rl||x.range)[0],(b._rl||b.range)[0],(x._rl||x.range)[1],(b._rl||b.range)[1]]},Q=c.repeat(K,y.count);y.fill2d&&y.fill2d.update(Q),y.line2d&&y.line2d.update(Q),y.error2d&&y.error2d.update(Q.concat(Q)),y.scatter2d&&y.scatter2d.update(Q),y.select2d&&y.select2d.update(Q),y.glText&&y.glText.forEach(function(r){r.update(K)})}else y.init()}}}},{"../../components/dragelement/helpers":384,"../../lib":503,"../../lib/prepare_regl":516,"../scatter/link_traces":942,"../scatter/subtypes":951,"./edit_style":983,"gl-text":225,"regl-error2d":279,"regl-line2d":280,"regl-scatter2d":281}],989:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n){var i=n._scene,o={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},s={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return n._scene||((i=n._scene={}).init=function(){a.extendFlat(i,s,o)},i.init(),i.update=function(r){var n=a.repeat(r,i.count);if(i.fill2d&&i.fill2d.update(n),i.scatter2d&&i.scatter2d.update(n),i.line2d&&i.line2d.update(n),i.error2d&&i.error2d.update(n.concat(n)),i.select2d&&i.select2d.update(n),i.glText)for(var o=0;o<i.count;o++)i.glText[o].update(r)},i.draw=function(){for(var r=i.count,n=i.fill2d,o=i.error2d,s=i.line2d,l=i.scatter2d,c=i.glText,u=i.select2d,f=i.selectBatch,h=i.unselectBatch,p=0;p<r;p++){if(n&&i.fillOrder[p]&&n.draw(i.fillOrder[p]),s&&i.lineOptions[p]&&s.draw(p),o&&(i.errorXOptions[p]&&o.draw(p),i.errorYOptions[p]&&o.draw(p+r)),l&&i.markerOptions[p]){if(h[p].length){var d=a.repeat([],i.count);d[p]=h[p],l.draw(d)}else f[p].length||l.draw(p)}c[p]&&i.textOptions[p]&&c[p].render()}u&&u.draw(f),i.dirty=!1},i.destroy=function(){i.fill2d&&i.fill2d.destroy&&i.fill2d.destroy(),i.scatter2d&&i.scatter2d.destroy&&i.scatter2d.destroy(),i.error2d&&i.error2d.destroy&&i.error2d.destroy(),i.line2d&&i.line2d.destroy&&i.line2d.destroy(),i.select2d&&i.select2d.destroy&&i.select2d.destroy(),i.glText&&i.glText.forEach(function(r){r.destroy&&r.destroy()}),i.lineOptions=null,i.fillOptions=null,i.markerOptions=null,i.markerSelectedOptions=null,i.markerUnselectedOptions=null,i.errorXOptions=null,i.errorYOptions=null,i.textOptions=null,i.textSelectedOptions=null,i.textUnselectedOptions=null,i.selectBatch=null,i.unselectBatch=null,n._scene=null}),i.dirty||a.extendFlat(i,o),i}},{"../../lib":503}],990:[function(r,n,i){"use strict";var a=r("../scatter/subtypes"),o=r("./edit_style").styleTextSelection;n.exports=function(r,n){var i=r.cd,s=r.xaxis,l=r.yaxis,c=[],u=i[0].trace,f=i[0].t,h=u._length,p=f.x,d=f.y,m=f._scene,g=f.index;if(!m)return c;var v=a.hasText(u),y=a.hasMarkers(u);if(!0!==u.visible||!y&&!v)return c;var x=[],b=[];if(!1!==n&&!n.degenerate)for(var _=0;_<h;_++)n.contains([f.xpx[_],f.ypx[_]],!1,_,r)?(x.push(_),c.push({pointNumber:_,x:s.c2d(p[_]),y:l.c2d(d[_])})):b.push(_);if(y){var w=m.scatter2d;if(x.length||b.length){if(!m.selectBatch[g].length&&!m.unselectBatch[g].length){var T=Array(m.count);T[g]=m.markerUnselectedOptions[g],w.update.apply(w,T)}}else{var k=Array(m.count);k[g]=m.markerOptions[g],w.update.apply(w,k)}}return m.selectBatch[g]=x,m.unselectBatch[g]=b,v&&o(i),c}},{"../scatter/subtypes":951,"./edit_style":983}],991:[function(r,n,i){"use strict";var a=r("../../plots/template_attributes").hovertemplateAttrs,o=r("../../plots/template_attributes").texttemplateAttrs,s=r("../scattergeo/attributes"),l=r("../scatter/attributes"),c=r("../../plots/mapbox/layout_attributes"),u=r("../../plots/attributes"),f=r("../../components/colorscale/attributes"),h=r("../../lib/extend").extendFlat,p=r("../../plot_api/edit_types").overrideAll,d=s.line,m=s.marker;n.exports=p({lon:s.lon,lat:s.lat,mode:h({},l.mode,{dflt:"markers"}),text:h({},l.text,{}),texttemplate:o({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:h({},l.hovertext,{}),line:{color:d.color,width:d.width},connectgaps:l.connectgaps,marker:h({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:m.opacity,size:m.size,sizeref:m.sizeref,sizemin:m.sizemin,sizemode:m.sizemode},f("marker")),fill:s.fill,fillcolor:l.fillcolor,textfont:c.layers.symbol.textfont,textposition:c.layers.symbol.textposition,below:{valType:"string"},selected:{marker:l.selected.marker},unselected:{marker:l.unselected.marker},hoverinfo:h({},u.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:a()},"calc","nested")},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/mapbox/layout_attributes":615,"../../plots/template_attributes":633,"../scatter/attributes":926,"../scattergeo/attributes":968}],992:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../lib"),s=r("../../constants/numerical").BADNUM,l=r("../../lib/geojson_utils"),c=r("../../components/colorscale"),u=r("../../components/drawing"),f=r("../scatter/make_bubble_size_func"),h=r("../scatter/subtypes"),p=r("../../plots/mapbox/convert_text_opts"),d=r("../../components/fx/helpers").appendArrayPointValue,m=r("../../lib/svg_text_utils").NEWLINES,g=r("../../lib/svg_text_utils").BR_TAG_ALL;function v(){return{geojson:l.makeBlank(),layout:{visibility:"none"},paint:{}}}function y(r,n){return o.isArrayOrTypedArray(r)?n?function(n){return a(r[n])?+r[n]:0}:function(n){return r[n]}:r?function(){return r}:x}function x(){return""}n.exports=function(r,n){var i,b=n[0].trace,_=!0===b.visible&&0!==b._length,w="none"!==b.fill,T=h.hasLines(b),k=h.hasMarkers(b),A=h.hasText(b),M=k&&"circle"===b.marker.symbol,S=k&&"circle"!==b.marker.symbol,E=v(),L=v(),C=v(),P=v(),I={fill:E,line:L,circle:C,symbol:P};if(!_)return I;if((w||T)&&(i=l.calcTraceToLineCoords(n)),w&&(E.geojson=l.makePolygon(i),E.layout.visibility="visible",o.extendFlat(E.paint,{"fill-color":b.fillcolor})),T&&(L.geojson=l.makeLine(i),L.layout.visibility="visible",o.extendFlat(L.paint,{"line-width":b.line.width,"line-color":b.line.color,"line-opacity":b.opacity})),M){var O=function(r){var n,i,l,h,p=r[0].trace,d=p.marker,m=p.selectedpoints,g=o.isArrayOrTypedArray(d.color),v=o.isArrayOrTypedArray(d.size),y=o.isArrayOrTypedArray(d.opacity);function x(r){return p.opacity*r}g&&(i=c.hasColorscale(p,"marker")?c.makeColorScaleFuncFromTrace(d):o.identity),v&&(l=f(p)),y&&(h=function(r){return x(a(r)?+o.constrain(r,0,1):0)});var b,_=[];for(n=0;n<r.length;n++){var w=r[n],T=w.lonlat;if(T[0]!==s){var k={};i&&(k.mcc=w.mcc=i(w.mc)),l&&(k.mrc=w.mrc=l(w.ms)),h&&(k.mo=h(w.mo)),m&&(k.selected=w.selected||0),_.push({type:"Feature",geometry:{type:"Point",coordinates:T},properties:k})}}if(m)for(b=u.makeSelectedPointStyleFns(p),n=0;n<_.length;n++){var A=_[n].properties;b.selectedOpacityFn&&(A.mo=x(b.selectedOpacityFn(A))),b.selectedColorFn&&(A.mcc=b.selectedColorFn(A)),b.selectedSizeFn&&(A.mrc=b.selectedSizeFn(A))}return{geojson:{type:"FeatureCollection",features:_},mcc:g||b&&b.selectedColorFn?{type:"identity",property:"mcc"}:d.color,mrc:v||b&&b.selectedSizeFn?{type:"identity",property:"mrc"}:d.size/2,mo:y||b&&b.selectedOpacityFn?{type:"identity",property:"mo"}:x(d.opacity)}}(n);C.geojson=O.geojson,C.layout.visibility="visible",o.extendFlat(C.paint,{"circle-color":O.mcc,"circle-radius":O.mrc,"circle-opacity":O.mo})}if((S||A)&&(P.geojson=function(r,n){for(var i=n._fullLayout,a=r[0].trace,l=a.marker||{},c=l.symbol,u=l.angle,f="circle"!==c?y(c):x,p="auto"!==u?y(u,!0):x,v=h.hasText(a)?y(a.text):x,b=[],_=0;_<r.length;_++){var w=r[_];if(w.lonlat[0]!==s){var T,k=a.texttemplate;if(k){var A=Array.isArray(k)?k[_]||"":k,M=a._module.formatLabels(w,a,i),S={};d(S,a,w.i);var E=a._meta||{};T=o.texttemplateString(A,M,i._d3locale,S,w,E)}else T=v(_);T&&(T=T.replace(m,"").replace(g,"\n")),b.push({type:"Feature",geometry:{type:"Point",coordinates:w.lonlat},properties:{symbol:f(_),angle:p(_),text:T}})}}return{type:"FeatureCollection",features:b}}(n,r),o.extendFlat(P.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),S&&(o.extendFlat(P.layout,{"icon-size":b.marker.size/10}),"angle"in b.marker&&"auto"!==b.marker.angle&&o.extendFlat(P.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),P.layout["icon-allow-overlap"]=b.marker.allowoverlap,o.extendFlat(P.paint,{"icon-opacity":b.opacity*b.marker.opacity,"icon-color":b.marker.color})),A)){var z=(b.marker||{}).size,D=p(b.textposition,z);o.extendFlat(P.layout,{"text-size":b.textfont.size,"text-anchor":D.anchor,"text-offset":D.offset}),o.extendFlat(P.paint,{"text-color":b.textfont.color,"text-opacity":b.opacity})}return I}},{"../../components/colorscale":378,"../../components/drawing":388,"../../components/fx/helpers":402,"../../constants/numerical":479,"../../lib":503,"../../lib/geojson_utils":497,"../../lib/svg_text_utils":529,"../../plots/mapbox/convert_text_opts":612,"../scatter/make_bubble_size_func":943,"../scatter/subtypes":951,"fast-isnumeric":190}],993:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/subtypes"),s=r("../scatter/marker_defaults"),l=r("../scatter/line_defaults"),c=r("../scatter/text_defaults"),u=r("../scatter/fillcolor_defaults"),f=r("./attributes");n.exports=function(r,n,i,h){function p(i,o){return a.coerce(r,n,f,i,o)}if(d=p("lon")||[],m=p("lat")||[],g=Math.min(d.length,m.length),n._length=g,g){if(p("text"),p("texttemplate"),p("hovertext"),p("hovertemplate"),p("mode"),p("below"),o.hasLines(n)&&(l(r,n,i,h,p,{noDash:!0}),p("connectgaps")),o.hasMarkers(n)){s(r,n,i,h,p,{noLine:!0}),p("marker.allowoverlap"),p("marker.angle");var d,m,g,v=n.marker;"circle"!==v.symbol&&(a.isArrayOrTypedArray(v.size)&&(v.size=v.size[0]),a.isArrayOrTypedArray(v.color)&&(v.color=v.color[0]))}o.hasText(n)&&c(r,n,h,p,{noSelect:!0}),p("fill"),"none"!==n.fill&&u(r,n,i,p),a.coerceSelectionMarkerOpacity(n,p)}else n.visible=!1}},{"../../lib":503,"../scatter/fillcolor_defaults":934,"../scatter/line_defaults":939,"../scatter/marker_defaults":945,"../scatter/subtypes":951,"../scatter/text_defaults":952,"./attributes":991}],994:[function(r,n,i){"use strict";n.exports=function(r,n){return r.lon=n.lon,r.lat=n.lat,r}},{}],995:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes");n.exports=function(r,n,i){var o={},s=i[n.subplot]._subplot.mockAxis,l=r.lonlat;return o.lonLabel=a.tickText(s,s.c2l(l[0]),!0).text,o.latLabel=a.tickText(s,s.c2l(l[1]),!0).text,o}},{"../../plots/cartesian/axes":554}],996:[function(r,n,i){"use strict";var a=r("../../components/fx"),o=r("../../lib"),s=r("../scatter/get_trace_color"),l=o.fillText,c=r("../../constants/numerical").BADNUM;function u(r,n,i){if(!r.hovertemplate){var a=(n.hi||r.hoverinfo).split("+"),o=-1!==a.indexOf("all"),s=-1!==a.indexOf("lon"),c=-1!==a.indexOf("lat"),u=n.lonlat,f=[];return o||s&&c?f.push("("+u[1]+"\xb0, "+u[0]+"\xb0)"):s?f.push(i.lon+(u[0]+"\xb0")):c&&f.push(i.lat+(u[1]+"\xb0")),(o||-1!==a.indexOf("text"))&&l(n,r,f),f.join("<br>")}}n.exports={hoverPoints:function(r,n,i){var l=r.cd,f=l[0].trace,h=r.xa,p=r.ya,d=r.subplot,m=360*(n>=0?Math.floor((n+180)/360):Math.ceil((n-180)/360)),g=n-m;if(a.getClosest(l,function(r){var n=r.lonlat;if(n[0]===c)return 1/0;var a=o.modHalf(n[0],360),s=n[1],l=d.project([a,s]),u=l.x-h.c2p([g,s]),f=l.y-p.c2p([a,i]),m=Math.max(3,r.mrc||0);return Math.max(Math.sqrt(u*u+f*f)-m,1-3/m)},r),!1!==r.index){var v=l[r.index],y=v.lonlat,x=[o.modHalf(y[0],360)+m,y[1]],b=h.c2p(x),_=p.c2p(x),w=v.mrc||1;r.x0=b-w,r.x1=b+w,r.y0=_-w,r.y1=_+w;var T={};T[f.subplot]={_subplot:d};var k=f._module.formatLabels(v,f,T);return r.lonLabel=k.lonLabel,r.latLabel=k.latLabel,r.color=s(f,v),r.extraText=u(f,v,l[0].t.labels),r.hovertemplate=f.hovertemplate,[r]}},getExtraText:u}},{"../../components/fx":406,"../../constants/numerical":479,"../../lib":503,"../scatter/get_trace_color":936}],997:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("../scattergeo/calc"),plot:r("./plot"),hoverPoints:r("./hover").hoverPoints,eventData:r("./event_data"),selectPoints:r("./select"),styleOnSelect:function(r,n){n&&n[0].trace._glTrace.update(n)},moduleType:"trace",name:"scattermapbox",basePlotModule:r("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":613,"../scatter/marker_colorbar":944,"../scattergeo/calc":969,"./attributes":991,"./defaults":993,"./event_data":994,"./format_labels":995,"./hover":996,"./plot":998,"./select":999}],998:[function(r,n,i){"use strict";var a=r("./convert"),o=r("../../plots/mapbox/constants").traceLayerPrefix,s=["fill","line","circle","symbol"];function l(r,n){this.type="scattermapbox",this.subplot=r,this.uid=n,this.sourceIds={fill:"source-"+n+"-fill",line:"source-"+n+"-line",circle:"source-"+n+"-circle",symbol:"source-"+n+"-symbol"},this.layerIds={fill:o+n+"-fill",line:o+n+"-line",circle:o+n+"-circle",symbol:o+n+"-symbol"},this.below=null}var c=l.prototype;c.addSource=function(r,n){this.subplot.map.addSource(this.sourceIds[r],{type:"geojson",data:n.geojson})},c.setSourceData=function(r,n){this.subplot.map.getSource(this.sourceIds[r]).setData(n.geojson)},c.addLayer=function(r,n,i){this.subplot.addLayer({type:r,id:this.layerIds[r],source:this.sourceIds[r],layout:n.layout,paint:n.paint},i)},c.update=function(r){var n,i,o,l=this.subplot,c=l.map,u=a(l.gd,r),f=l.belowLookup["trace-"+this.uid];if(f!==this.below){for(n=s.length-1;n>=0;n--)i=s[n],c.removeLayer(this.layerIds[i]);for(n=0;n<s.length;n++)o=u[i=s[n]],this.addLayer(i,o,f);this.below=f}for(n=0;n<s.length;n++)o=u[i=s[n]],l.setOptions(this.layerIds[i],"setLayoutProperty",o.layout),"visible"===o.layout.visibility&&(this.setSourceData(i,o),l.setOptions(this.layerIds[i],"setPaintProperty",o.paint));r[0].trace._glTrace=this},c.dispose=function(){for(var r=this.subplot.map,n=s.length-1;n>=0;n--){var i=s[n];r.removeLayer(this.layerIds[i]),r.removeSource(this.sourceIds[i])}},n.exports=function(r,n){for(var i=n[0].trace,o=new l(r,i.uid),c=a(r.gd,n),u=o.below=r.belowLookup["trace-"+i.uid],f=0;f<s.length;f++){var h=s[f],p=c[h];o.addSource(h,p),o.addLayer(h,p,u)}return n[0].trace._glTrace=o,o}},{"../../plots/mapbox/constants":611,"./convert":992}],999:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/subtypes"),s=r("../../constants/numerical").BADNUM;n.exports=function(r,n){var i,l=r.cd,c=r.xaxis,u=r.yaxis,f=[],h=l[0].trace;if(!o.hasMarkers(h))return[];if(!1===n)for(i=0;i<l.length;i++)l[i].selected=0;else for(i=0;i<l.length;i++){var p=l[i],d=p.lonlat;if(d[0]!==s){var m=[a.modHalf(d[0],360),d[1]],g=[c.c2p(m),u.c2p(m)];n.contains(g,null,i,r)?(f.push({pointNumber:i,lon:d[0],lat:d[1]}),p.selected=1):p.selected=0}}return f}},{"../../constants/numerical":479,"../../lib":503,"../scatter/subtypes":951}],1e3:[function(r,n,i){"use strict";var a=r("../../plots/template_attributes").hovertemplateAttrs,o=r("../../plots/template_attributes").texttemplateAttrs,s=r("../../lib/extend").extendFlat,l=r("../scatter/attributes"),c=r("../../plots/attributes"),u=l.line;n.exports={mode:l.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:l.text,texttemplate:o({editType:"plot"},{keys:["r","theta","text"]}),hovertext:l.hovertext,line:{color:u.color,width:u.width,dash:u.dash,shape:s({},u.shape,{values:["linear","spline"]}),smoothing:u.smoothing,editType:"calc"},connectgaps:l.connectgaps,marker:l.marker,cliponaxis:s({},l.cliponaxis,{dflt:!1}),textposition:l.textposition,textfont:l.textfont,fill:s({},l.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:l.fillcolor,hoverinfo:s({},c.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:l.hoveron,hovertemplate:a(),selected:l.selected,unselected:l.unselected}},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":926}],1001:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../constants/numerical").BADNUM,s=r("../../plots/cartesian/axes"),l=r("../scatter/colorscale_calc"),c=r("../scatter/arrays_to_calcdata"),u=r("../scatter/calc_selection"),f=r("../scatter/calc").calcMarkerSize;n.exports=function(r,n){for(var i=r._fullLayout,h=n.subplot,p=i[h].radialaxis,d=i[h].angularaxis,m=p.makeCalcdata(n,"r"),g=d.makeCalcdata(n,"theta"),v=n._length,y=Array(v),x=0;x<v;x++){var b=m[x],_=g[x],w=y[x]={};a(b)&&a(_)?(w.r=b,w.theta=_):w.r=o}var T=f(n,v);return n._extremes.x=s.findExtremes(p,m,{ppad:T}),l(r,n),c(y,n),u(y,n),y}},{"../../constants/numerical":479,"../../plots/cartesian/axes":554,"../scatter/arrays_to_calcdata":925,"../scatter/calc":927,"../scatter/calc_selection":928,"../scatter/colorscale_calc":929,"fast-isnumeric":190}],1002:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/subtypes"),s=r("../scatter/marker_defaults"),l=r("../scatter/line_defaults"),c=r("../scatter/line_shape_defaults"),u=r("../scatter/text_defaults"),f=r("../scatter/fillcolor_defaults"),h=r("../scatter/constants").PTS_LINESONLY,p=r("./attributes");function d(r,n,i,a){var o,s=a("r"),l=a("theta");if(s)l?o=Math.min(s.length,l.length):(o=s.length,a("theta0"),a("dtheta"));else{if(!l)return 0;o=n.theta.length,a("r0"),a("dr")}return n._length=o,o}n.exports={handleRThetaDefaults:d,supplyDefaults:function(r,n,i,m){function g(i,o){return a.coerce(r,n,p,i,o)}var v=d(r,n,m,g);if(v){g("thetaunit"),g("mode",v<h?"lines+markers":"lines"),g("text"),g("hovertext"),"fills"!==n.hoveron&&g("hovertemplate"),o.hasLines(n)&&(l(r,n,i,m,g),c(r,n,g),g("connectgaps")),o.hasMarkers(n)&&s(r,n,i,m,g,{gradient:!0}),o.hasText(n)&&(g("texttemplate"),u(r,n,m,g));var y=[];(o.hasMarkers(n)||o.hasText(n))&&(g("cliponaxis"),g("marker.maxdisplayed"),y.push("points")),g("fill"),"none"!==n.fill&&(f(r,n,i,g),o.hasLines(n)||c(r,n,g)),"tonext"!==n.fill&&"toself"!==n.fill||y.push("fills"),g("hoveron",y.join("+")||"points"),a.coerceSelectionMarkerOpacity(n,g)}else n.visible=!1}}},{"../../lib":503,"../scatter/constants":930,"../scatter/fillcolor_defaults":934,"../scatter/line_defaults":939,"../scatter/line_shape_defaults":941,"../scatter/marker_defaults":945,"../scatter/subtypes":951,"../scatter/text_defaults":952,"./attributes":1e3}],1003:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes");n.exports=function(r,n,i){var s,l,c={},u=i[n.subplot]._subplot;u?(s=u.radialAxis,l=u.angularAxis):(s=(u=i[n.subplot]).radialaxis,l=u.angularaxis);var f=s.c2l(r.r);c.rLabel=o.tickText(s,f,!0).text;var h="degrees"===l.thetaunit?a.rad2deg(r.theta):r.theta;return c.thetaLabel=o.tickText(l,h,!0).text,c}},{"../../lib":503,"../../plots/cartesian/axes":554}],1004:[function(r,n,i){"use strict";var a=r("../scatter/hover");function o(r,n,i,a){var o=i.radialAxis,s=i.angularAxis;o._hovertitle="r",s._hovertitle="";var l={};l[n.subplot]={_subplot:i};var c=n._module.formatLabels(r,n,l);a.rLabel=c.rLabel,a.thetaLabel=c.thetaLabel;var u=r.hi||n.hoverinfo,f=[];function h(r,n){f.push(r._hovertitle+": "+n)}if(!n.hovertemplate){var p=u.split("+");-1!==p.indexOf("all")&&(p=["r","theta","text"]),-1!==p.indexOf("r")&&h(o,a.rLabel),-1!==p.indexOf("theta")&&h(s,a.thetaLabel),-1!==p.indexOf("text")&&a.text&&(f.push(a.text),delete a.text),a.extraText=f.join("<br>")}}n.exports={hoverPoints:function(r,n,i,s){var l=a(r,n,i,s);if(l&&!1!==l[0].index){var c=l[0];if(void 0===c.index)return l;var u=r.subplot,f=c.cd[c.index],h=c.trace;if(u.isPtInside(f))return c.xLabelVal=void 0,c.yLabelVal=void 0,o(f,h,u,c),c.hovertemplate=h.hovertemplate,l}},makeHoverPointText:o}},{"../scatter/hover":937}],1005:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:r("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,selectPoints:r("../scatter/select"),meta:{}}},{"../../plots/polar":622,"../scatter/marker_colorbar":944,"../scatter/select":948,"../scatter/style":950,"./attributes":1e3,"./calc":1001,"./defaults":1002,"./format_labels":1003,"./hover":1004,"./plot":1006}],1006:[function(r,n,i){"use strict";var a=r("../scatter/plot"),o=r("../../constants/numerical").BADNUM;n.exports=function(r,n,i){for(var s=n.layers.frontplot.select("g.scatterlayer"),l={xaxis:n.xaxis,yaxis:n.yaxis,plot:n.framework,layerClipId:n._hasClipOnAxisFalse?n.clipIds.forTraces:null},c=n.radialAxis,u=n.angularAxis,f=0;f<i.length;f++)for(var h=i[f],p=0;p<h.length;p++){var d=h[p],m=d.r;if(m===o)d.x=d.y=o;else{var g=c.c2g(m),v=u.c2g(d.theta);d.x=g*Math.cos(v),d.y=g*Math.sin(v)}}a(r,l,i,s)}},{"../../constants/numerical":479,"../scatter/plot":947}],1007:[function(r,n,i){"use strict";var a=r("../scatterpolar/attributes"),o=r("../scattergl/attributes"),s=r("../../plots/template_attributes").texttemplateAttrs;n.exports={mode:a.mode,r:a.r,theta:a.theta,r0:a.r0,dr:a.dr,theta0:a.theta0,dtheta:a.dtheta,thetaunit:a.thetaunit,text:a.text,texttemplate:s({editType:"plot"},{keys:["r","theta","text"]}),hovertext:a.hovertext,hovertemplate:a.hovertemplate,line:o.line,connectgaps:o.connectgaps,marker:o.marker,fill:o.fill,fillcolor:o.fillcolor,textposition:o.textposition,textfont:o.textfont,hoverinfo:a.hoverinfo,selected:a.selected,unselected:a.unselected}},{"../../plots/template_attributes":633,"../scattergl/attributes":978,"../scatterpolar/attributes":1e3}],1008:[function(r,n,i){"use strict";var a=r("../scatter/colorscale_calc"),o=r("../scatter/calc").calcMarkerSize,s=r("../scattergl/convert"),l=r("../../plots/cartesian/axes"),c=r("../scattergl/constants").TOO_MANY_POINTS;n.exports=function(r,n){var i=r._fullLayout,u=n.subplot,f=i[u].radialaxis,h=i[u].angularaxis,p=n._r=f.makeCalcdata(n,"r"),d=n._theta=h.makeCalcdata(n,"theta"),m=n._length,g={};m<p.length&&(p=p.slice(0,m)),m<d.length&&(d=d.slice(0,m)),g.r=p,g.theta=d,a(r,n);var v,y=g.opts=s.style(r,n);return m<c?v=o(n,m):y.marker&&(v=2*(y.marker.sizeAvg||Math.max(y.marker.size,3))),n._extremes.x=l.findExtremes(f,p,{ppad:v}),[{x:!1,y:!1,t:g,trace:n}]}},{"../../plots/cartesian/axes":554,"../scatter/calc":927,"../scatter/colorscale_calc":929,"../scattergl/constants":980,"../scattergl/convert":981}],1009:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/subtypes"),s=r("../scatterpolar/defaults").handleRThetaDefaults,l=r("../scatter/marker_defaults"),c=r("../scatter/line_defaults"),u=r("../scatter/text_defaults"),f=r("../scatter/fillcolor_defaults"),h=r("../scatter/constants").PTS_LINESONLY,p=r("./attributes");n.exports=function(r,n,i,d){function m(i,o){return a.coerce(r,n,p,i,o)}var g=s(r,n,d,m);g?(m("thetaunit"),m("mode",g<h?"lines+markers":"lines"),m("text"),m("hovertext"),"fills"!==n.hoveron&&m("hovertemplate"),o.hasLines(n)&&(c(r,n,i,d,m),m("connectgaps")),o.hasMarkers(n)&&l(r,n,i,d,m),o.hasText(n)&&(m("texttemplate"),u(r,n,d,m)),m("fill"),"none"!==n.fill&&f(r,n,i,m),a.coerceSelectionMarkerOpacity(n,m)):n.visible=!1}},{"../../lib":503,"../scatter/constants":930,"../scatter/fillcolor_defaults":934,"../scatter/line_defaults":939,"../scatter/marker_defaults":945,"../scatter/subtypes":951,"../scatter/text_defaults":952,"../scatterpolar/defaults":1002,"./attributes":1007}],1010:[function(r,n,i){"use strict";var a=r("../scatterpolar/format_labels");n.exports=function(r,n,i){var o=r.i;return"r"in r||(r.r=n._r[o]),"theta"in r||(r.theta=n._theta[o]),a(r,n,i)}},{"../scatterpolar/format_labels":1003}],1011:[function(r,n,i){"use strict";var a=r("../scattergl/hover"),o=r("../scatterpolar/hover").makeHoverPointText;n.exports={hoverPoints:function(r,n,i,s){var l=r.cd[0].t,c=l.r,u=l.theta,f=a.hoverPoints(r,n,i,s);if(f&&!1!==f[0].index){var h=f[0];if(void 0===h.index)return f;var p=r.subplot,d=h.cd[h.index],m=h.trace;if(d.r=c[h.index],d.theta=u[h.index],p.isPtInside(d))return h.xLabelVal=void 0,h.yLabelVal=void 0,o(d,m,p,h),f}}}},{"../scattergl/hover":986,"../scatterpolar/hover":1004}],1012:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:r("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),hoverPoints:r("./hover").hoverPoints,selectPoints:r("../scattergl/select"),meta:{}}},{"../../plots/polar":622,"../scatter/marker_colorbar":944,"../scattergl/select":990,"./attributes":1007,"./calc":1008,"./defaults":1009,"./format_labels":1010,"./hover":1011,"./plot":1013}],1013:[function(r,n,i){"use strict";var a=r("@plotly/point-cluster"),o=r("fast-isnumeric"),s=r("../scattergl/plot"),l=r("../scattergl/scene_update"),c=r("../scattergl/convert"),u=r("../../lib"),f=r("../scattergl/constants").TOO_MANY_POINTS;n.exports=function(r,n,i){if(i.length){var h=n.radialAxis,p=n.angularAxis,d=l(r,n);return i.forEach(function(i){if(i&&i[0]&&i[0].trace){var s,l=i[0],m=l.trace,g=l.t,v=m._length,y=g.r,x=g.theta,b=g.opts,_=y.slice(),w=x.slice();for(s=0;s<y.length;s++)n.isPtInside({r:y[s],theta:x[s]})||(_[s]=NaN,w[s]=NaN);var T=Array(2*v),k=Array(v),A=Array(v);for(s=0;s<v;s++){var M,S,E=_[s];if(o(E)){var L=h.c2g(E),C=p.c2g(w[s],m.thetaunit);M=L*Math.cos(C),S=L*Math.sin(C)}else M=S=NaN;k[s]=T[2*s]=M,A[s]=T[2*s+1]=S}g.tree=a(T),b.marker&&v>=f&&(b.marker.cluster=g.tree),b.marker&&(b.markerSel.positions=b.markerUnsel.positions=b.marker.positions=T),b.line&&T.length>1&&u.extendFlat(b.line,c.linePositions(r,m,T)),b.text&&(u.extendFlat(b.text,{positions:T},c.textPosition(r,m,b.text,b.marker)),u.extendFlat(b.textSel,{positions:T},c.textPosition(r,m,b.text,b.markerSel)),u.extendFlat(b.textUnsel,{positions:T},c.textPosition(r,m,b.text,b.markerUnsel))),b.fill&&!d.fill2d&&(d.fill2d=!0),b.marker&&!d.scatter2d&&(d.scatter2d=!0),b.line&&!d.line2d&&(d.line2d=!0),b.text&&!d.glText&&(d.glText=!0),d.lineOptions.push(b.line),d.fillOptions.push(b.fill),d.markerOptions.push(b.marker),d.markerSelectedOptions.push(b.markerSel),d.markerUnselectedOptions.push(b.markerUnsel),d.textOptions.push(b.text),d.textSelectedOptions.push(b.textSel),d.textUnselectedOptions.push(b.textUnsel),d.selectBatch.push([]),d.unselectBatch.push([]),g.x=k,g.y=A,g.rawx=k,g.rawy=A,g.r=y,g.theta=x,g.positions=T,g._scene=d,g.index=d.count,d.count++}}),s(r,n,i)}}},{"../../lib":503,"../scattergl/constants":980,"../scattergl/convert":981,"../scattergl/plot":988,"../scattergl/scene_update":989,"@plotly/point-cluster":59,"fast-isnumeric":190}],1014:[function(r,n,i){"use strict";var a=r("../../plots/template_attributes").hovertemplateAttrs,o=r("../../plots/template_attributes").texttemplateAttrs,s=r("../../lib/extend").extendFlat,l=r("../scatter/attributes"),c=r("../../plots/attributes"),u=l.line;n.exports={mode:l.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:l.text,texttemplate:o({editType:"plot"},{keys:["real","imag","text"]}),hovertext:l.hovertext,line:{color:u.color,width:u.width,dash:u.dash,shape:s({},u.shape,{values:["linear","spline"]}),smoothing:u.smoothing,editType:"calc"},connectgaps:l.connectgaps,marker:l.marker,cliponaxis:s({},l.cliponaxis,{dflt:!1}),textposition:l.textposition,textfont:l.textfont,fill:s({},l.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:l.fillcolor,hoverinfo:s({},c.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:l.hoveron,hovertemplate:a(),selected:l.selected,unselected:l.unselected}},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":926}],1015:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../../constants/numerical").BADNUM,s=r("../scatter/colorscale_calc"),l=r("../scatter/arrays_to_calcdata"),c=r("../scatter/calc_selection"),u=r("../scatter/calc").calcMarkerSize;n.exports=function(r,n){for(var i=r._fullLayout,f=n.subplot,h=i[f].realaxis,p=i[f].imaginaryaxis,d=h.makeCalcdata(n,"real"),m=p.makeCalcdata(n,"imag"),g=n._length,v=Array(g),y=0;y<g;y++){var x=d[y],b=m[y],_=v[y]={};a(x)&&a(b)?(_.real=x,_.imag=b):_.real=o}return u(n,g),s(r,n),l(v,n),c(v,n),v}},{"../../constants/numerical":479,"../scatter/arrays_to_calcdata":925,"../scatter/calc":927,"../scatter/calc_selection":928,"../scatter/colorscale_calc":929,"fast-isnumeric":190}],1016:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/subtypes"),s=r("../scatter/marker_defaults"),l=r("../scatter/line_defaults"),c=r("../scatter/line_shape_defaults"),u=r("../scatter/text_defaults"),f=r("../scatter/fillcolor_defaults"),h=r("../scatter/constants").PTS_LINESONLY,p=r("./attributes");n.exports=function(r,n,i,d){function m(i,o){return a.coerce(r,n,p,i,o)}var g,v,y,x=(v=m("real"),y=m("imag"),v&&y&&(g=Math.min(v.length,y.length)),n._length=g,g);if(x){m("mode",x<h?"lines+markers":"lines"),m("text"),m("hovertext"),"fills"!==n.hoveron&&m("hovertemplate"),o.hasLines(n)&&(l(r,n,i,d,m),c(r,n,m),m("connectgaps")),o.hasMarkers(n)&&s(r,n,i,d,m,{gradient:!0}),o.hasText(n)&&(m("texttemplate"),u(r,n,d,m));var b=[];(o.hasMarkers(n)||o.hasText(n))&&(m("cliponaxis"),m("marker.maxdisplayed"),b.push("points")),m("fill"),"none"!==n.fill&&(f(r,n,i,m),o.hasLines(n)||c(r,n,m)),"tonext"!==n.fill&&"toself"!==n.fill||b.push("fills"),m("hoveron",b.join("+")||"points"),a.coerceSelectionMarkerOpacity(n,m)}else n.visible=!1}},{"../../lib":503,"../scatter/constants":930,"../scatter/fillcolor_defaults":934,"../scatter/line_defaults":939,"../scatter/line_shape_defaults":941,"../scatter/marker_defaults":945,"../scatter/subtypes":951,"../scatter/text_defaults":952,"./attributes":1014}],1017:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes");n.exports=function(r,n,i){var o={},s=i[n.subplot]._subplot;return o.realLabel=a.tickText(s.radialAxis,r.real,!0).text,o.imagLabel=a.tickText(s.angularAxis,r.imag,!0).text,o}},{"../../plots/cartesian/axes":554}],1018:[function(r,n,i){"use strict";var a=r("../scatter/hover");function o(r,n,i,a){var o=i.radialAxis,s=i.angularAxis;o._hovertitle="real",s._hovertitle="imag";var l={};l[n.subplot]={_subplot:i};var c=n._module.formatLabels(r,n,l);a.realLabel=c.realLabel,a.imagLabel=c.imagLabel;var u=r.hi||n.hoverinfo,f=[];function h(r,n){f.push(r._hovertitle+": "+n)}if(!n.hovertemplate){var p=u.split("+");-1!==p.indexOf("all")&&(p=["real","imag","text"]),-1!==p.indexOf("real")&&h(o,a.realLabel),-1!==p.indexOf("imag")&&h(s,a.imagLabel),-1!==p.indexOf("text")&&a.text&&(f.push(a.text),delete a.text),a.extraText=f.join("<br>")}}n.exports={hoverPoints:function(r,n,i,s){var l=a(r,n,i,s);if(l&&!1!==l[0].index){var c=l[0];if(void 0===c.index)return l;var u=r.subplot,f=c.cd[c.index],h=c.trace;if(u.isPtInside(f))return c.xLabelVal=void 0,c.yLabelVal=void 0,o(f,h,u,c),c.hovertemplate=h.hovertemplate,l}},makeHoverPointText:o}},{"../scatter/hover":937}],1019:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"scattersmith",basePlotModule:r("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover").hoverPoints,selectPoints:r("../scatter/select"),meta:{}}},{"../../plots/smith":629,"../scatter/marker_colorbar":944,"../scatter/select":948,"../scatter/style":950,"./attributes":1014,"./calc":1015,"./defaults":1016,"./format_labels":1017,"./hover":1018,"./plot":1020}],1020:[function(r,n,i){"use strict";var a=r("../scatter/plot"),o=r("../../constants/numerical").BADNUM,s=r("../../plots/smith/helpers").smith;n.exports=function(r,n,i){for(var l=n.layers.frontplot.select("g.scatterlayer"),c={xaxis:n.xaxis,yaxis:n.yaxis,plot:n.framework,layerClipId:n._hasClipOnAxisFalse?n.clipIds.forTraces:null},u=0;u<i.length;u++)for(var f=i[u],h=0;h<f.length;h++){var p=f[h],d=p.real;if(d===o)p.x=p.y=o;else{var m=s([d,p.imag]);p.x=m[0],p.y=m[1]}}a(r,c,i,l)}},{"../../constants/numerical":479,"../../plots/smith/helpers":628,"../scatter/plot":947}],1021:[function(r,n,i){"use strict";var a=r("../../plots/template_attributes").hovertemplateAttrs,o=r("../../plots/template_attributes").texttemplateAttrs,s=r("../scatter/attributes"),l=r("../../plots/attributes"),c=r("../../components/colorscale/attributes"),u=r("../../components/drawing/attributes").dash,f=r("../../lib/extend").extendFlat,h=s.marker,p=s.line,d=h.line;n.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:f({},s.mode,{dflt:"markers"}),text:f({},s.text,{}),texttemplate:o({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:f({},s.hovertext,{}),line:{color:p.color,width:p.width,dash:u,shape:f({},p.shape,{values:["linear","spline"]}),smoothing:p.smoothing,editType:"calc"},connectgaps:s.connectgaps,cliponaxis:s.cliponaxis,fill:f({},s.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:s.fillcolor,marker:f({symbol:h.symbol,opacity:h.opacity,maxdisplayed:h.maxdisplayed,size:h.size,sizeref:h.sizeref,sizemin:h.sizemin,sizemode:h.sizemode,line:f({width:d.width,editType:"calc"},c("marker.line")),gradient:h.gradient,editType:"calc"},c("marker")),textfont:s.textfont,textposition:s.textposition,selected:s.selected,unselected:s.unselected,hoverinfo:f({},l.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:s.hoveron,hovertemplate:a()}},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":926}],1022:[function(r,n,i){"use strict";var a=r("fast-isnumeric"),o=r("../scatter/colorscale_calc"),s=r("../scatter/arrays_to_calcdata"),l=r("../scatter/calc_selection"),c=r("../scatter/calc").calcMarkerSize,u=["a","b","c"],f={a:["b","c"],b:["a","c"],c:["a","b"]};n.exports=function(r,n){var i,h,p,d,m,g,v=r._fullLayout[n.subplot].sum,y=n.sum||v,x={a:n.a,b:n.b,c:n.c};for(i=0;i<u.length;i++)if(!x[p=u[i]]){for(m=x[f[p][0]],g=x[f[p][1]],d=Array(m.length),h=0;h<m.length;h++)d[h]=y-m[h]-g[h];x[p]=d}var b,_,w,T,k,A,M=n._length,S=Array(M);for(i=0;i<M;i++)b=x.a[i],_=x.b[i],w=x.c[i],a(b)&&a(_)&&a(w)?(1!=(T=v/((b=+b)+(_=+_)+(w=+w)))&&(b*=T,_*=T,w*=T),A=b,k=w-_,S[i]={x:k,y:A,a:b,b:_,c:w}):S[i]={x:!1,y:!1};return c(n,M),o(r,n),s(S,n),l(S,n),S}},{"../scatter/arrays_to_calcdata":925,"../scatter/calc":927,"../scatter/calc_selection":928,"../scatter/colorscale_calc":929,"fast-isnumeric":190}],1023:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/constants"),s=r("../scatter/subtypes"),l=r("../scatter/marker_defaults"),c=r("../scatter/line_defaults"),u=r("../scatter/line_shape_defaults"),f=r("../scatter/text_defaults"),h=r("../scatter/fillcolor_defaults"),p=r("./attributes");n.exports=function(r,n,i,d){function m(i,o){return a.coerce(r,n,p,i,o)}var g,v=m("a"),y=m("b"),x=m("c");if(v?(g=v.length,y?(g=Math.min(g,y.length),x&&(g=Math.min(g,x.length))):g=x?Math.min(g,x.length):0):y&&x&&(g=Math.min(y.length,x.length)),g){n._length=g,m("sum"),m("text"),m("hovertext"),"fills"!==n.hoveron&&m("hovertemplate"),m("mode",g<o.PTS_LINESONLY?"lines+markers":"lines"),s.hasLines(n)&&(c(r,n,i,d,m),u(r,n,m),m("connectgaps")),s.hasMarkers(n)&&l(r,n,i,d,m,{gradient:!0}),s.hasText(n)&&(m("texttemplate"),f(r,n,d,m));var b=[];(s.hasMarkers(n)||s.hasText(n))&&(m("cliponaxis"),m("marker.maxdisplayed"),b.push("points")),m("fill"),"none"!==n.fill&&(h(r,n,i,m),s.hasLines(n)||u(r,n,m)),"tonext"!==n.fill&&"toself"!==n.fill||b.push("fills"),m("hoveron",b.join("+")||"points"),a.coerceSelectionMarkerOpacity(n,m)}else n.visible=!1}},{"../../lib":503,"../scatter/constants":930,"../scatter/fillcolor_defaults":934,"../scatter/line_defaults":939,"../scatter/line_shape_defaults":941,"../scatter/marker_defaults":945,"../scatter/subtypes":951,"../scatter/text_defaults":952,"./attributes":1021}],1024:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o){if(n.xa&&(r.xaxis=n.xa),n.ya&&(r.yaxis=n.ya),a[o]){var s=a[o];r.a=s.a,r.b=s.b,r.c=s.c}else r.a=n.a,r.b=n.b,r.c=n.c;return r}},{}],1025:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes");n.exports=function(r,n,i){var o={},s=i[n.subplot]._subplot;return o.aLabel=a.tickText(s.aaxis,r.a,!0).text,o.bLabel=a.tickText(s.baxis,r.b,!0).text,o.cLabel=a.tickText(s.caxis,r.c,!0).text,o}},{"../../plots/cartesian/axes":554}],1026:[function(r,n,i){"use strict";var a=r("../scatter/hover");n.exports=function(r,n,i,o){var s=a(r,n,i,o);if(s&&!1!==s[0].index){var l=s[0];if(void 0===l.index){var c=1-l.y0/r.ya._length,u=r.xa._length,f=u*c/2,h=u-f;return l.x0=Math.max(Math.min(l.x0,h),f),l.x1=Math.max(Math.min(l.x1,h),f),s}var p=l.cd[l.index],d=l.trace,m=l.subplot;l.a=p.a,l.b=p.b,l.c=p.c,l.xLabelVal=void 0,l.yLabelVal=void 0;var g={};g[d.subplot]={_subplot:m};var v=d._module.formatLabels(p,d,g);l.aLabel=v.aLabel,l.bLabel=v.bLabel,l.cLabel=v.cLabel;var y=p.hi||d.hoverinfo,x=[];if(!d.hovertemplate){var b=y.split("+");-1!==b.indexOf("all")&&(b=["a","b","c"]),-1!==b.indexOf("a")&&_(m.aaxis,l.aLabel),-1!==b.indexOf("b")&&_(m.baxis,l.bLabel),-1!==b.indexOf("c")&&_(m.caxis,l.cLabel)}return l.extraText=x.join("<br>"),l.hovertemplate=d.hovertemplate,s}function _(r,n){x.push(r._hovertitle+": "+n)}}},{"../scatter/hover":937}],1027:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),formatLabels:r("./format_labels"),calc:r("./calc"),plot:r("./plot"),style:r("../scatter/style").style,styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../scatter/select"),eventData:r("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:r("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":634,"../scatter/marker_colorbar":944,"../scatter/select":948,"../scatter/style":950,"./attributes":1021,"./calc":1022,"./defaults":1023,"./event_data":1024,"./format_labels":1025,"./hover":1026,"./plot":1028}],1028:[function(r,n,i){"use strict";var a=r("../scatter/plot");n.exports=function(r,n,i){var o=n.plotContainer;o.select(".scatterlayer").selectAll("*").remove(),a(r,{xaxis:n.xaxis,yaxis:n.yaxis,plot:o,layerClipId:n._hasClipOnAxisFalse?n.clipIdRelative:null},i,n.layers.frontplot.select("g.scatterlayer"))}},{"../scatter/plot":947}],1029:[function(r,n,i){"use strict";var a=r("../scatter/attributes"),o=r("../../components/colorscale/attributes"),s=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,l=r("../../plots/template_attributes").hovertemplateAttrs,c=r("../scattergl/attributes"),u=r("../../plots/cartesian/constants").idRegex,f=r("../../plot_api/plot_template").templatedArray,h=r("../../lib/extend").extendFlat,p=a.marker,d=p.line,m=h(o("marker.line",{editTypeOverride:"calc"}),{width:h({},d.width,{editType:"calc"}),editType:"calc"}),g=h(o("marker"),{symbol:p.symbol,size:h({},p.size,{editType:"markerSize"}),sizeref:p.sizeref,sizemin:p.sizemin,sizemode:p.sizemode,opacity:p.opacity,colorbar:p.colorbar,line:m,editType:"calc"});function v(r){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:u[r],editType:"plot"}}}g.color.editType=g.cmin.editType=g.cmax.editType="style",n.exports={dimensions:f("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:h({},c.text,{}),hovertext:h({},c.hovertext,{}),hovertemplate:l(),xhoverformat:s("x"),yhoverformat:s("y"),marker:g,xaxes:v("x"),yaxes:v("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:c.selected.marker,editType:"calc"},unselected:{marker:c.unselected.marker,editType:"calc"},opacity:c.opacity}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_format_attributes":557,"../../plots/cartesian/constants":561,"../../plots/template_attributes":633,"../scatter/attributes":926,"../scattergl/attributes":978}],1030:[function(r,n,i){"use strict";var a=r("regl-line2d"),o=r("../../registry"),s=r("../../lib/prepare_regl"),l=r("../../plots/get_data").getModuleCalcData,c=r("../../plots/cartesian"),u=r("../../plots/cartesian/axis_ids").getFromId,f=r("../../plots/cartesian/axes").shouldShowZeroLine;function h(r){var n=r._fullLayout,i=n._glcanvas.data()[0].regl,o=n._splomGrid;o||(o=n._splomGrid=a(i)),o.update(function(r){var n,i=r._context.plotGlPixelRatio,a=r._fullLayout,o=a._size,s=[0,0,a.width*i,a.height*i],l={};function c(r,n,a,o,c,u){a*=i,o*=i,c*=i,u*=i;var f=n[r+"color"],h=n[r+"width"],p=String(f+h);p in l?l[p].data.push(NaN,NaN,a,o,c,u):l[p]={data:[a,o,c,u],join:"rect",thickness:h*i,color:f,viewport:s,range:s,overlay:!1}}for(n in a._splomSubplots){var u,h,p=a._plots[n],d=p.xaxis,m=p.yaxis,g=d._gridVals,v=m._gridVals,y=d._offset,x=d._length,b=m._length,_=o.b+m.domain[0]*o.h,w=-m._m,T=-w*m.r2l(m.range[0],m.calendar);if(d.showgrid)for(n=0;n<g.length;n++)u=y+d.l2p(g[n].x),c("grid",d,u,_,u,_+b);if(m.showgrid)for(n=0;n<v.length;n++)c("grid",m,y,h=_+T+w*v[n].x,y+x,h);f(r,d,m)&&(u=y+d.l2p(0),c("zeroline",d,u,_,u,_+b)),f(r,m,d)&&c("zeroline",m,y,h=_+T+0,y+x,h)}var k=[];for(n in l)k.push(l[n]);return k}(r))}n.exports={name:"splom",attr:c.attr,attrRegex:c.attrRegex,layoutAttributes:c.layoutAttributes,supplyLayoutDefaults:c.supplyLayoutDefaults,drawFramework:c.drawFramework,plot:function(r){var n=r._fullLayout,i=o.getModule("splom"),a=l(r.calcdata,i)[0];s(r,["ANGLE_instanced_arrays","OES_element_index_uint"])&&(n._hasOnlyLargeSploms&&h(r),i.plot(r,{},a))},drag:function(r){var n=r.calcdata,i=r._fullLayout;i._hasOnlyLargeSploms&&h(r);for(var a=0;a<n.length;a++){var o=n[a][0].trace,s=i._splomScenes[o.uid];"splom"===o.type&&s&&s.matrix&&function(r,n,i){for(var a=i.matrixOptions.data.length,o=n._visibleDims,s=i.viewOpts.ranges=Array(a),l=0;l<o.length;l++){var c=o[l],f=s[l]=[,,,,],h=u(r,n._diag[c][0]);h&&(f[0]=h.r2l(h.range[0]),f[2]=h.r2l(h.range[1]));var p=u(r,n._diag[c][1]);p&&(f[1]=p.r2l(p.range[0]),f[3]=p.r2l(p.range[1]))}i.selectBatch.length||i.unselectBatch.length?i.matrix.update({ranges:s},{ranges:s}):i.matrix.update({ranges:s})}(r,o,s)}},updateGrid:h,clean:function(r,n,i,a){var o,s={};if(a._splomScenes){for(o=0;o<r.length;o++){var l=r[o];"splom"===l.type&&(s[l.uid]=1)}for(o=0;o<i.length;o++){var u=i[o];if(!s[u.uid]){var f=a._splomScenes[u.uid];f&&f.destroy&&f.destroy(),a._splomScenes[u.uid]=null,delete a._splomScenes[u.uid]}}}0===Object.keys(a._splomScenes||{}).length&&delete a._splomScenes,a._splomGrid&&!n._hasOnlyLargeSploms&&a._hasOnlyLargeSploms&&(a._splomGrid.destroy(),a._splomGrid=null,delete a._splomGrid),c.clean(r,n,i,a)},updateFx:c.updateFx,toSVG:c.toSVG}},{"../../lib/prepare_regl":516,"../../plots/cartesian":568,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_ids":558,"../../plots/get_data":593,"../../registry":638,"regl-line2d":280}],1031:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axis_ids"),s=r("../scatter/calc").calcMarkerSize,l=r("../scatter/calc").calcAxisExpansion,c=r("../scatter/colorscale_calc"),u=r("../scattergl/convert").markerSelection,f=r("../scattergl/convert").markerStyle,h=r("./scene_update"),p=r("../../constants/numerical").BADNUM,d=r("../scattergl/constants").TOO_MANY_POINTS;n.exports=function(r,n){var i,m,g,v,y,x,b=n.dimensions,_=n._length,w={},T=w.cdata=[],k=w.data=[],A=n._visibleDims=[];function M(r,i){for(var o=r.makeCalcdata({v:i.values,vcalendar:n.calendar},"v"),s=0;s<o.length;s++)o[s]=o[s]===p?NaN:o[s];T.push(o),k.push("log"===r.type?a.simpleMap(o,r.c2l):o)}for(i=0;i<b.length;i++)if((g=b[i]).visible){if(v=o.getFromId(r,n._diag[i][0]),y=o.getFromId(r,n._diag[i][1]),v&&y&&v.type!==y.type){a.log("Skipping splom dimension "+i+" with conflicting axis types");continue}v?(M(v,g),y&&"category"===y.type&&(y._categories=v._categories.slice())):M(y,g),A.push(i)}for(c(r,n),a.extendFlat(w,f(n)),x=T.length*_>d?w.sizeAvg||Math.max(w.size,3):s(n,_),m=0;m<A.length;m++)g=b[i=A[m]],v=o.getFromId(r,n._diag[i][0])||{},y=o.getFromId(r,n._diag[i][1])||{},l(r,n,v,y,T[m],T[m],x);var S=h(r,n);return S.matrix||(S.matrix=!0),S.matrixOptions=w,S.selectedOptions=u(n,n.selected),S.unselectedOptions=u(n,n.unselected),[{x:!1,y:!1,t:{},trace:n}]}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axis_ids":558,"../scatter/calc":927,"../scatter/colorscale_calc":929,"../scattergl/constants":980,"../scattergl/convert":981,"./scene_update":1038}],1032:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/array_container_defaults"),s=r("./attributes"),l=r("../scatter/subtypes"),c=r("../scatter/marker_defaults"),u=r("../parcoords/merge_length"),f=r("../scattergl/helpers").isOpenSymbol;function h(r,n){function i(i,o){return a.coerce(r,n,s.dimensions,i,o)}i("label");var o=i("values");o&&o.length?i("visible"):n.visible=!1,i("axis.type"),i("axis.matches")}n.exports=function(r,n,i,p){function d(i,o){return a.coerce(r,n,s,i,o)}var m=o(r,n,{name:"dimensions",handleItemDefaults:h}),g=d("diagonal.visible"),v=d("showupperhalf"),y=d("showlowerhalf");if(u(n,m,"values")&&(g||v||y)){d("text"),d("hovertext"),d("hovertemplate"),d("xhoverformat"),d("yhoverformat"),c(r,n,i,p,d);var x=f(n.marker.symbol),b=l.isBubble(n);d("marker.line.width",x||b?1:0),function(r,n,i,a){var o,s,l=n.dimensions,c=l.length,u=n.showupperhalf,f=n.showlowerhalf,h=n.diagonal.visible,p=Array(c),d=Array(c);for(o=0;o<c;o++){var m=o?o+1:"";p[o]="x"+m,d[o]="y"+m}var g=a("xaxes",p),v=a("yaxes",d),y=n._diag=Array(c);n._xaxes={},n._yaxes={};var x=[],b=[];function _(r,a,o,s){if(r){var l=r.charAt(0),c=i._splomAxes[l];if(n["_"+l+"axes"][r]=1,s.push(r),!(r in c)){var u=c[r]={};o&&(u.label=o.label||"",o.visible&&o.axis&&(o.axis.type&&(u.type=o.axis.type),o.axis.matches&&(u.matches=a)))}}}var w=!h&&!f,T=!h&&!u;for(n._axesDim={},o=0;o<c;o++){var k=l[o],A=0===o,M=o===c-1,S=A&&w||M&&T?void 0:g[o],E=A&&T||M&&w?void 0:v[o];_(S,E,k,x),_(E,S,k,b),y[o]=[S,E],n._axesDim[S]=o,n._axesDim[E]=o}for(o=0;o<x.length;o++)for(s=0;s<b.length;s++){var L=x[o]+b[s];o>s&&u||o<s&&f?i._splomSubplots[L]=1:o!==s||!h&&f&&u||(i._splomSubplots[L]=1)}(!f||!h&&u&&f)&&(i._splomGridDflt.xside="bottom",i._splomGridDflt.yside="left")}(0,n,p,d),a.coerceSelectionMarkerOpacity(n,d)}else n.visible=!1}},{"../../lib":503,"../../plots/array_container_defaults":549,"../parcoords/merge_length":897,"../scatter/marker_defaults":945,"../scatter/subtypes":951,"../scattergl/helpers":985,"./attributes":1029}],1033:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/colorscale_calc"),s=r("../scattergl/convert").markerStyle;n.exports=function(r,n){var i=n.trace,l=r._fullLayout._splomScenes[i.uid];if(l){o(r,i),a.extendFlat(l.matrixOptions,s(i));var c=a.extendFlat({},l.matrixOptions,l.viewOpts);l.matrix.update(c,null)}}},{"../../lib":503,"../scatter/colorscale_calc":929,"../scattergl/convert":981}],1034:[function(r,n,i){"use strict";i.getDimIndex=function(r,n){for(var i=n._id,a={x:0,y:1}[i.charAt(0)],o=r._visibleDims,s=0;s<o.length;s++){var l=o[s];if(r._diag[l][a]===i)return s}return!1}},{}],1035:[function(r,n,i){"use strict";var a=r("./helpers"),o=r("../scattergl/hover").calcHover;n.exports={hoverPoints:function(r,n,i){var s=r.cd[0].trace,l=r.scene.matrixOptions.cdata,c=r.xa,u=r.ya,f=c.c2p(n),h=u.c2p(i),p=r.distance,d=a.getDimIndex(s,c),m=a.getDimIndex(s,u);if(!1===d||!1===m)return[r];for(var g,v,y=l[d],x=l[m],b=p,_=0;_<y.length;_++){var w=y[_],T=x[_],k=c.c2p(w)-f,A=u.c2p(T)-h,M=Math.sqrt(k*k+A*A);M<b&&(b=v=M,g=_)}return r.index=g,r.distance=b,r.dxy=v,void 0===g?[r]:[o(r,y,x,s)]}}},{"../scattergl/hover":986,"./helpers":1034}],1036:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../components/grid");n.exports={moduleType:"trace",name:"splom",basePlotModule:r("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:r("../scatter/marker_colorbar"),calc:r("./calc"),plot:r("./plot"),hoverPoints:r("./hover").hoverPoints,selectPoints:r("./select"),editStyle:r("./edit_style"),meta:{}},a.register(o)},{"../../components/grid":410,"../../registry":638,"../scatter/marker_colorbar":944,"./attributes":1029,"./base_plot":1030,"./calc":1031,"./defaults":1032,"./edit_style":1033,"./hover":1035,"./plot":1037,"./select":1039}],1037:[function(r,n,i){"use strict";var a=r("regl-splom"),o=r("../../lib"),s=r("../../plots/cartesian/axis_ids"),l=r("../../components/dragelement/helpers").selectMode;n.exports=function(r,n,i){if(i.length)for(var c=0;c<i.length;c++)!function(r,n){var i,c,u,f,h,p=r._fullLayout,d=p._size,m=n.trace,g=n.t,v=p._splomScenes[m.uid],y=v.matrixOptions,x=y.cdata,b=p._glcanvas.data()[0].regl,_=p.dragmode;if(0!==x.length){y.lower=m.showupperhalf,y.upper=m.showlowerhalf,y.diagonal=m.diagonal.visible;var w=m._visibleDims,T=x.length,k=v.viewOpts={};for(k.ranges=Array(T),k.domains=Array(T),h=0;h<w.length;h++){u=w[h];var A=k.ranges[h]=[,,,,],M=k.domains[h]=[,,,,];(i=s.getFromId(r,m._diag[u][0]))&&(A[0]=i._rl[0],A[2]=i._rl[1],M[0]=i.domain[0],M[2]=i.domain[1]),(c=s.getFromId(r,m._diag[u][1]))&&(A[1]=c._rl[0],A[3]=c._rl[1],M[1]=c.domain[0],M[3]=c.domain[1])}var S=r._context.plotGlPixelRatio,E=d.l*S,L=d.b*S,C=d.w*S,P=d.h*S;k.viewport=[E,L,C+E,P+L],!0===v.matrix&&(v.matrix=a(b));var I=p.clickmode.indexOf("select")>-1,O=!0;if(l(_)||m.selectedpoints||I){var z=m._length;if(m.selectedpoints){v.selectBatch=m.selectedpoints;var D=m.selectedpoints,R={};for(u=0;u<D.length;u++)R[D[u]]=!0;var F=[];for(u=0;u<z;u++)R[u]||F.push(u);v.unselectBatch=F}var B=g.xpx=Array(T),N=g.ypx=Array(T);for(h=0;h<w.length;h++){if(u=w[h],i=s.getFromId(r,m._diag[u][0]))for(B[h]=Array(z),f=0;f<z;f++)B[h][f]=i.c2p(x[h][f]);if(c=s.getFromId(r,m._diag[u][1]))for(N[h]=Array(z),f=0;f<z;f++)N[h][f]=c.c2p(x[h][f])}if(v.selectBatch.length||v.unselectBatch.length){var j=o.extendFlat({},y,v.unselectedOptions,k),U=o.extendFlat({},y,v.selectedOptions,k);v.matrix.update(j,U),O=!1}}else g.xpx=g.ypx=null;if(O){var V=o.extendFlat({},y,k);v.matrix.update(V,null)}}}(r,i[c][0])}},{"../../components/dragelement/helpers":384,"../../lib":503,"../../plots/cartesian/axis_ids":558,"regl-splom":282}],1038:[function(r,n,i){"use strict";var a=r("../../lib");n.exports=function(r,n){var i=r._fullLayout,o=n.uid,s=i._splomScenes;s||(s=i._splomScenes={});var l={dirty:!0,selectBatch:[],unselectBatch:[]},c=s[n.uid];return c||((c=s[o]=a.extendFlat({},l,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){c.matrix&&c.matrix.draw&&(c.selectBatch.length||c.unselectBatch.length?c.matrix.draw(c.unselectBatch,c.selectBatch):c.matrix.draw()),c.dirty=!1},c.destroy=function(){c.matrix&&c.matrix.destroy&&c.matrix.destroy(),c.matrixOptions=null,c.selectBatch=null,c.unselectBatch=null,c=null}),c.dirty||a.extendFlat(c,l),c}},{"../../lib":503}],1039:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../scatter/subtypes"),s=r("./helpers");n.exports=function(r,n){var i=r.cd,l=i[0].trace,c=i[0].t,u=r.scene,f=u.matrixOptions.cdata,h=r.xaxis,p=r.yaxis,d=[];if(!u)return d;var m=!o.hasMarkers(l)&&!o.hasText(l);if(!0!==l.visible||m)return d;var g=s.getDimIndex(l,h),v=s.getDimIndex(l,p);if(!1===g||!1===v)return d;var y=c.xpx[g],x=c.ypx[v],b=f[g],_=f[v],w=[],T=[];if(!1!==n&&!n.degenerate)for(var k=0;k<b.length;k++)n.contains([y[k],x[k]],null,k,r)?(w.push(k),d.push({pointNumber:k,x:b[k],y:_[k]})):T.push(k);var A=u.matrixOptions;return w.length||T.length?u.selectBatch.length||u.unselectBatch.length||u.matrix.update(u.unselectedOptions,a.extendFlat({},A,u.selectedOptions,u.viewOpts)):u.matrix.update(A,null),u.selectBatch=w,u.unselectBatch=T,d}},{"../../lib":503,"../scatter/subtypes":951,"./helpers":1034}],1040:[function(r,n,i){"use strict";var a=r("../../components/colorscale/attributes"),o=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,s=r("../../plots/template_attributes").hovertemplateAttrs,l=r("../mesh3d/attributes"),c=r("../../plots/attributes"),u=r("../../lib/extend").extendFlat,f={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:s({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:o("u",1),vhoverformat:o("v",1),whoverformat:o("w",1),xhoverformat:o("x"),yhoverformat:o("y"),zhoverformat:o("z"),showlegend:u({},c.showlegend,{dflt:!1})};u(f,a("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(r){f[r]=l[r]}),f.hoverinfo=u({},c.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),f.transforms=void 0,n.exports=f},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../mesh3d/attributes":867}],1041:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/colorscale/calc");function s(r){var n,i,o,s,c,u,f,h,p,d,m,g,v=r._x,y=r._y,x=r._z,b=r._len,_=-1/0,w=1/0,T=-1/0,k=1/0,A=-1/0,M=1/0,S="";for(b&&(f=v[0],p=y[0],m=x[0]),b>1&&(h=v[b-1],d=y[b-1],g=x[b-1]),n=0;n<b;n++)_=Math.max(_,v[n]),w=Math.min(w,v[n]),T=Math.max(T,y[n]),k=Math.min(k,y[n]),A=Math.max(A,x[n]),M=Math.min(M,x[n]),s||v[n]===f||(s=!0,S+="x"),c||y[n]===p||(c=!0,S+="y"),u||x[n]===m||(u=!0,S+="z");s||(S+="x"),c||(S+="y"),u||(S+="z");var E=l(r._x),L=l(r._y),C=l(r._z);S=(S=(S=S.replace("x",(f>h?"-":"+")+"x")).replace("y",(p>d?"-":"+")+"y")).replace("z",(m>g?"-":"+")+"z");var P=function(){b=0,E=[],L=[],C=[]};(!b||b<E.length*L.length*C.length)&&P();var I=function(r){return"x"===r?v:"y"===r?y:x},O=function(r){return"x"===r?E:"y"===r?L:C},z=function(r){return r[b-1]<r[0]?-1:1},D=I(S[1]),R=I(S[3]),F=I(S[5]),B=O(S[1]).length,N=O(S[3]).length,j=O(S[5]).length,U=!1,V=function(r,n,i){return B*(N*r+n)+i},H=z(I(S[1])),q=z(I(S[3])),G=z(I(S[5]));for(n=0;n<j-1;n++){for(i=0;i<N-1;i++){for(o=0;o<B-1;o++){var Y=V(n,i,o),W=V(n,i,o+1),X=V(n,i+1,o),Z=V(n+1,i,o);if(D[Y]*H<D[W]*H&&R[Y]*q<R[X]*q&&F[Y]*G<F[Z]*G||(U=!0),U)break}if(U)break}if(U)break}return U&&(a.warn("Encountered arbitrary coordinates! Unable to input data grid."),P()),{xMin:w,yMin:k,zMin:M,xMax:_,yMax:T,zMax:A,Xs:E,Ys:L,Zs:C,len:b,fill:S}}function l(r){return a.distinctVals(r).vals}function c(r,n){if(void 0===n&&(n=r.length),a.isTypedArray(r))return r.subarray(0,n);for(var i=[],o=0;o<n;o++)i[o]=+r[o];return i}n.exports={calc:function(r,n){n._len=Math.min(n.u.length,n.v.length,n.w.length,n.x.length,n.y.length,n.z.length),n._u=c(n.u,n._len),n._v=c(n.v,n._len),n._w=c(n.w,n._len),n._x=c(n.x,n._len),n._y=c(n.y,n._len),n._z=c(n.z,n._len);var i=s(n);n._gridFill=i.fill,n._Xs=i.Xs,n._Ys=i.Ys,n._Zs=i.Zs,n._len=i.len;var a,l,u,f=0;n.starts&&(a=c(n.starts.x||[]),l=c(n.starts.y||[]),u=c(n.starts.z||[]),f=Math.min(a.length,l.length,u.length)),n._startsX=a||[],n._startsY=l||[],n._startsZ=u||[];var h,p=0,d=1/0;for(h=0;h<n._len;h++){var m=n._u[h],g=n._v[h],v=n._w[h],y=Math.sqrt(m*m+g*g+v*v);p=Math.max(p,y),d=Math.min(d,y)}for(o(r,n,{vals:[d,p],containerStr:"",cLetter:"c"}),h=0;h<f;h++){var x=a[h];i.xMax=Math.max(i.xMax,x),i.xMin=Math.min(i.xMin,x);var b=l[h];i.yMax=Math.max(i.yMax,b),i.yMin=Math.min(i.yMin,b);var _=u[h];i.zMax=Math.max(i.zMax,_),i.zMin=Math.min(i.zMin,_)}n._slen=f,n._normMax=p,n._xbnds=[i.xMin,i.xMax],n._ybnds=[i.yMin,i.yMax],n._zbnds=[i.zMin,i.zMax]},filter:c,processGrid:s}},{"../../components/colorscale/calc":374,"../../lib":503}],1042:[function(r,n,i){"use strict";var a=r("../../../stackgl_modules").gl_streamtube3d,o=a.createTubeMesh,s=r("../../lib"),l=r("../../lib/gl_format_color").parseColorScale,c=r("../../components/colorscale").extractOpts,u=r("../../plots/gl3d/zip3"),f={xaxis:0,yaxis:1,zaxis:2};function h(r,n){this.scene=r,this.uid=n,this.mesh=null,this.data=null}var p=h.prototype;function d(r){var n=r.length;return n>2?r.slice(1,n-1):2===n?[(r[0]+r[1])/2]:r}function m(r){var n=r.length;return 1===n?[.5,.5]:[r[1]-r[0],r[n-1]-r[n-2]]}function g(r,n){var i=r.fullSceneLayout,o=r.dataScale,h=n._len,p={};function g(r,n){var a=i[n],l=o[f[n]];return s.simpleMap(r,function(r){return a.d2l(r)*l})}if(p.vectors=u(g(n._u,"xaxis"),g(n._v,"yaxis"),g(n._w,"zaxis"),h),!h)return{positions:[],cells:[]};var v=g(n._Xs,"xaxis"),y=g(n._Ys,"yaxis"),x=g(n._Zs,"zaxis");if(p.meshgrid=[v,y,x],p.gridFill=n._gridFill,n._slen)p.startingPositions=u(g(n._startsX,"xaxis"),g(n._startsY,"yaxis"),g(n._startsZ,"zaxis"));else{for(var b=y[0],_=d(v),w=d(x),T=Array(_.length*w.length),k=0,A=0;A<_.length;A++)for(var M=0;M<w.length;M++)T[k++]=[_[A],b,w[M]];p.startingPositions=T}p.colormap=l(n),p.tubeSize=n.sizeref,p.maxLength=n.maxdisplayed;var S=g(n._xbnds,"xaxis"),E=g(n._ybnds,"yaxis"),L=g(n._zbnds,"zaxis"),C=m(v),P=m(y),I=m(x),O=a(p,[[S[0]-C[0],E[0]-P[0],L[0]-I[0]],[S[1]+C[1],E[1]+P[1],L[1]+I[1]]]),z=c(n);O.vertexIntensityBounds=[z.min/n._normMax,z.max/n._normMax];var D=n.lightposition;return O.lightPosition=[D.x,D.y,D.z],O.ambient=n.lighting.ambient,O.diffuse=n.lighting.diffuse,O.specular=n.lighting.specular,O.roughness=n.lighting.roughness,O.fresnel=n.lighting.fresnel,O.opacity=n.opacity,n._pad=O.tubeScale*n.sizeref*2,O}p.handlePick=function(r){var n=this.scene.fullSceneLayout,i=this.scene.dataScale;function a(r,a){var o=n[a],s=i[f[a]];return o.l2c(r)/s}if(r.object===this.mesh){var o=r.data.position,s=r.data.velocity;return r.traceCoordinate=[a(o[0],"xaxis"),a(o[1],"yaxis"),a(o[2],"zaxis"),a(s[0],"xaxis"),a(s[1],"yaxis"),a(s[2],"zaxis"),r.data.intensity*this.data._normMax,r.data.divergence],r.textLabel=this.data.hovertext||this.data.text,!0}},p.update=function(r){this.data=r;var n=g(this.scene,r);this.mesh.update(n)},p.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},n.exports=function(r,n){var i=o(r.glplot.gl,g(r,n)),a=new h(r,n.uid);return a.mesh=i,a.data=n,i._trace=a,r.glplot.add(i),a}},{"../../../stackgl_modules":1120,"../../components/colorscale":378,"../../lib":503,"../../lib/gl_format_color":499,"../../plots/gl3d/zip3":609}],1043:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/colorscale/defaults"),s=r("./attributes");n.exports=function(r,n,i,l){function c(i,o){return a.coerce(r,n,s,i,o)}var u=c("u"),f=c("v"),h=c("w"),p=c("x"),d=c("y"),m=c("z");u&&u.length&&f&&f.length&&h&&h.length&&p&&p.length&&d&&d.length&&m&&m.length?(c("starts.x"),c("starts.y"),c("starts.z"),c("maxdisplayed"),c("sizeref"),c("lighting.ambient"),c("lighting.diffuse"),c("lighting.specular"),c("lighting.roughness"),c("lighting.fresnel"),c("lightposition.x"),c("lightposition.y"),c("lightposition.z"),o(r,n,l,c,{prefix:"",cLetter:"c"}),c("text"),c("hovertext"),c("hovertemplate"),c("uhoverformat"),c("vhoverformat"),c("whoverformat"),c("xhoverformat"),c("yhoverformat"),c("zhoverformat"),n._length=null):n.visible=!1}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":1040}],1044:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"streamtube",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:r("./attributes"),supplyDefaults:r("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:r("./calc").calc,plot:r("./convert"),eventData:function(r,n){return r.tubex=r.x,r.tubey=r.y,r.tubez=r.z,r.tubeu=n.traceCoordinate[3],r.tubev=n.traceCoordinate[4],r.tubew=n.traceCoordinate[5],r.norm=n.traceCoordinate[6],r.divergence=n.traceCoordinate[7],delete r.x,delete r.y,delete r.z,r},meta:{}}},{"../../plots/gl3d":598,"./attributes":1040,"./calc":1041,"./convert":1042,"./defaults":1043}],1045:[function(r,n,i){"use strict";var a=r("../../plots/attributes"),o=r("../../plots/template_attributes").hovertemplateAttrs,s=r("../../plots/template_attributes").texttemplateAttrs,l=r("../../components/colorscale/attributes"),c=r("../../plots/domain").attributes,u=r("../pie/attributes"),f=r("./constants"),h=r("../../lib/extend").extendFlat;n.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:h({colors:{valType:"data_array",editType:"calc"},line:{color:h({},u.marker.line.color,{dflt:null}),width:h({},u.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},l("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:u.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:s({editType:"plot"},{keys:f.eventDataKeys.concat(["label","value"])}),hovertext:u.hovertext,hoverinfo:h({},a.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:o({},{keys:f.eventDataKeys}),textfont:u.textfont,insidetextorientation:u.insidetextorientation,insidetextfont:u.insidetextfont,outsidetextfont:h({},u.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:u.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:c({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":900,"./constants":1048}],1046:[function(r,n,i){"use strict";var a=r("../../plots/plots");i.name="sunburst",i.plot=function(r,n,o,s){a.plotBasePlot(i.name,r,n,o,s)},i.clean=function(r,n,o,s){a.cleanBasePlot(i.name,r,n,o,s)}},{"../../plots/plots":619}],1047:[function(r,n,i){"use strict";var a=r("d3-hierarchy"),o=r("fast-isnumeric"),s=r("../../lib"),l=r("../../components/colorscale").makeColorScaleFuncFromTrace,c=r("../pie/calc").makePullColorFn,u=r("../pie/calc").generateExtendedColors,f=r("../../components/colorscale").calc,h=r("../../constants/numerical").ALMOST_EQUAL,p={},d={},m={};i.calc=function(r,n){var i,u,p,d,m=r._fullLayout,g=n.ids,v=s.isArrayOrTypedArray(g),y=n.labels,x=n.parents,b=n.values,_=s.isArrayOrTypedArray(b),w=[],T={},k={},A=function(r){return r||"number"==typeof r},M=function(r){return!_||o(b[r])&&b[r]>=0};v?(i=Math.min(g.length,x.length),u=function(r){return A(g[r])&&M(r)},p=function(r){return String(g[r])}):(i=Math.min(y.length,x.length),u=function(r){return A(y[r])&&M(r)},p=function(r){return String(y[r])}),_&&(i=Math.min(i,b.length));for(var S=0;S<i;S++)if(u(S)){var E=p(S),L=A(x[S])?String(x[S]):"",C={i:S,id:E,pid:L,label:A(y[S])?String(y[S]):""};_&&(C.v=+b[S]),w.push(C),T[L]?T[L].push(E):T[L]=[E],k[E]=1}if(T[""]){if(T[""].length>1){for(var P=s.randstr(),I=0;I<w.length;I++)""===w[I].pid&&(w[I].pid=P);w.unshift({hasMultipleRoots:!0,id:P,pid:"",label:""})}}else{var O,z=[];for(O in T)k[O]||z.push(O);if(1!==z.length)return s.warn(["Multiple implied roots, cannot build",n.type,"hierarchy of",n.name+".","These roots include:",z.join(", ")].join(" "));O=z[0],w.unshift({hasImpliedRoot:!0,id:O,pid:"",label:O})}try{d=a.stratify().id(function(r){return r.id}).parentId(function(r){return r.pid})(w)}catch(r){return s.warn(["Failed to build",n.type,"hierarchy of",n.name+".","Error:",r.message].join(" "))}var D=a.hierarchy(d),R=!1;if(_)switch(n.branchvalues){case"remainder":D.sum(function(r){return r.data.v});break;case"total":D.each(function(r){var i=r.data.data,a=i.v;if(r.children){var o=r.children.reduce(function(r,n){return r+n.data.data.v},0);if((i.hasImpliedRoot||i.hasMultipleRoots)&&(a=o),a<o*h)return R=!0,s.warn(["Total value for node",r.data.data.id,"of",n.name,"is smaller than the sum of its children.","\nparent value =",a,"\nchildren sum =",o].join(" "))}r.value=a})}else!function r(n,i,a){var o=0,s=n.children;if(s){for(var l=s.length,c=0;c<l;c++)o+=r(s[c],i,a);a.branches&&o++}else a.leaves&&o++;return n.value=n.data.data.value=o,i._values||(i._values=[]),i._values[n.data.data.i]=o,o}(D,n,{branches:-1!==n.count.indexOf("branches"),leaves:-1!==n.count.indexOf("leaves")});if(!R){n.sort&&D.sort(function(r,n){return n.value-r.value});var F,B,N=n.marker.colors||[],j=!!N.length;return n._hasColorscale?(j||(N=_?n.values:n._values),f(r,n,{vals:N,containerStr:"marker",cLetter:"c"}),B=l(n.marker)):F=c(m["_"+n.type+"colormap"]),D.each(function(r){var i=r.data.data;i.color=n._hasColorscale?B(N[i.i]):F(N[i.i],i.id)}),w[0].hierarchy=D,w}},i._runCrossTraceCalc=function(r,n){var i=n._fullLayout,a=n.calcdata,o=i[r+"colorway"],s=i["_"+r+"colormap"];i["extend"+r+"colors"]&&(o=u(o,"icicle"===r?m:"treemap"===r?d:p));var l,c=0;function f(r){var n=r.data.data,i=n.id;!1===n.color&&(s[i]?n.color=s[i]:r.parent?r.parent.parent?n.color=r.parent.data.data.color:(s[i]=n.color=o[c%o.length],c++):n.color=l)}for(var h=0;h<a.length;h++){var g=a[h][0];g.trace.type===r&&g.hierarchy&&(l=g.trace.root.color,g.hierarchy.each(f))}},i.crossTraceCalc=function(r){return i._runCrossTraceCalc("sunburst",r)}},{"../../components/colorscale":378,"../../constants/numerical":479,"../../lib":503,"../pie/calc":902,"d3-hierarchy":115,"fast-isnumeric":190}],1048:[function(r,n,i){"use strict";n.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1049:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("../../plots/domain").defaults,l=r("../bar/defaults").handleText,c=r("../../components/colorscale"),u=c.hasColorscale,f=c.handleDefaults;n.exports=function(r,n,i,c){function h(i,s){return a.coerce(r,n,o,i,s)}var p=h("labels"),d=h("parents");if(p&&p.length&&d&&d.length){var m=h("values");h(m&&m.length?"branchvalues":"count"),h("level"),h("maxdepth"),h("marker.line.width")&&h("marker.line.color",c.paper_bgcolor),h("marker.colors");var g=n._hasColorscale=u(r,"marker","colors")||(r.marker||{}).coloraxis;g&&f(r,n,c,h,{prefix:"marker.",cLetter:"c"}),h("leaf.opacity",g?1:.7);var v=h("text");h("texttemplate"),n.texttemplate||h("textinfo",Array.isArray(v)?"text+label":"label"),h("hovertext"),h("hovertemplate"),l(r,n,c,h,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),h("insidetextorientation"),h("sort"),h("rotation"),h("root.color"),s(n,c,h),n._length=null}else n.visible=!1}},{"../../components/colorscale":378,"../../lib":503,"../../plots/domain":584,"../bar/defaults":652,"./attributes":1045}],1050:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../registry"),s=r("../../components/fx/helpers").appendArrayPointValue,l=r("../../components/fx"),c=r("../../lib"),u=r("../../lib/events"),f=r("./helpers"),h=r("../pie/helpers").formatPieValue;function p(r,n,i){for(var a=r.data.data,o={curveNumber:n.index,pointNumber:a.i,data:n._input,fullData:n},l=0;l<i.length;l++){var c=i[l];c in r&&(o[c]=r[c])}return"parentString"in r&&!f.isHierarchyRoot(r)&&(o.parent=r.parentString),s(o,n,a.i),o}n.exports=function(r,n,i,s,d){var m=s[0],g=m.trace,v=m.hierarchy,y="sunburst"===g.type,x="treemap"===g.type||"icicle"===g.type;"_hasHoverLabel"in g||(g._hasHoverLabel=!1),"_hasHoverEvent"in g||(g._hasHoverEvent=!1),r.on("mouseover",function(o){var s=i._fullLayout;if(!i._dragging&&!1!==s.hovermode){var u,b=i._fullData[g.index],_=o.data.data,w=_.i,T=f.isHierarchyRoot(o),k=f.getParent(v,o),A=f.getValue(o),M=function(r){return c.castOption(b,w,r)},S=M("hovertemplate"),E=l.castHoverinfo(b,s,w),L=s.separators;if(S||E&&"none"!==E&&"skip"!==E){y&&(C=m.cx+o.pxmid[0]*(1-o.rInscribed),P=m.cy+o.pxmid[1]*(1-o.rInscribed)),x&&(C=o._hoverX,P=o._hoverY);var C,P,I,O={},z=[],D=[],R=function(r){return -1!==z.indexOf(r)};E&&(z="all"===E?b._module.attributes.hoverinfo.flags:E.split("+")),O.label=_.label,R("label")&&O.label&&D.push(O.label),_.hasOwnProperty("v")&&(O.value=_.v,O.valueLabel=h(O.value,L),R("value")&&D.push(O.valueLabel)),O.currentPath=o.currentPath=f.getPath(o.data),R("current path")&&!T&&D.push(O.currentPath);var F=[],B=function(){-1===F.indexOf(I)&&(D.push(I),F.push(I))};O.percentParent=o.percentParent=A/f.getValue(k),O.parent=o.parentString=f.getPtLabel(k),R("percent parent")&&(I=f.formatPercent(O.percentParent,L)+" of "+O.parent,B()),O.percentEntry=o.percentEntry=A/f.getValue(n),O.entry=o.entry=f.getPtLabel(n),!R("percent entry")||T||o.onPathbar||(I=f.formatPercent(O.percentEntry,L)+" of "+O.entry,B()),O.percentRoot=o.percentRoot=A/f.getValue(v),O.root=o.root=f.getPtLabel(v),R("percent root")&&!T&&(I=f.formatPercent(O.percentRoot,L)+" of "+O.root,B()),O.text=M("hovertext")||M("text"),R("text")&&(I=O.text,c.isValidTextValue(I)&&D.push(I)),u=[p(o,b,d.eventDataKeys)];var N={trace:b,y:P,_x0:o._x0,_x1:o._x1,_y0:o._y0,_y1:o._y1,text:D.join("<br>"),name:S||R("name")?b.name:void 0,color:M("hoverlabel.bgcolor")||_.color,borderColor:M("hoverlabel.bordercolor"),fontFamily:M("hoverlabel.font.family"),fontSize:M("hoverlabel.font.size"),fontColor:M("hoverlabel.font.color"),nameLength:M("hoverlabel.namelength"),textAlign:M("hoverlabel.align"),hovertemplate:S,hovertemplateLabels:O,eventData:u};y&&(N.x0=C-o.rInscribed*o.rpx1,N.x1=C+o.rInscribed*o.rpx1,N.idealAlign=o.pxmid[0]<0?"left":"right"),x&&(N.x=C,N.idealAlign=C<0?"left":"right");var j=[];l.loneHover(N,{container:s._hoverlayer.node(),outerContainer:s._paper.node(),gd:i,inOut_bbox:j}),u[0].bbox=j[0],g._hasHoverLabel=!0}if(x){var U=r.select("path.surface");d.styleOne(U,o,b,{hovered:!0})}g._hasHoverEvent=!0,i.emit("plotly_hover",{points:u||[p(o,b,d.eventDataKeys)],event:a.event})}}),r.on("mouseout",function(n){var o=i._fullLayout,s=i._fullData[g.index],c=a.select(this).datum();if(g._hasHoverEvent&&(n.originalEvent=a.event,i.emit("plotly_unhover",{points:[p(c,s,d.eventDataKeys)],event:a.event}),g._hasHoverEvent=!1),g._hasHoverLabel&&(l.loneUnhover(o._hoverlayer.node()),g._hasHoverLabel=!1),x){var u=r.select("path.surface");d.styleOne(u,c,s,{hovered:!1})}}),r.on("click",function(r){var n=i._fullLayout,s=i._fullData[g.index],c=y&&(f.isHierarchyRoot(r)||f.isLeaf(r)),h=f.getPtId(r),m=f.isEntry(r)?f.findEntryWithChild(v,h):f.findEntryWithLevel(v,h),x=f.getPtId(m),b={points:[p(r,s,d.eventDataKeys)],event:a.event};c||(b.nextLevel=x);var _=u.triggerHandler(i,"plotly_"+g.type+"click",b);if(!1!==_&&n.hovermode&&(i._hoverdata=[p(r,s,d.eventDataKeys)],l.click(i,a.event)),!c&&!1!==_&&!i._dragging&&!i._transitioning){o.call("_storeDirectGUIEdit",s,n._tracePreGUI[s.uid],{level:s.level});var w={data:[{level:x}],traces:[g.index]},T={frame:{redraw:!1,duration:d.transitionTime},transition:{duration:d.transitionTime,easing:d.transitionEasing},mode:"immediate",fromcurrent:!0};l.loneUnhover(n._hoverlayer.node()),o.call("animate",i,w,T)}})}},{"../../components/fx":406,"../../components/fx/helpers":402,"../../lib":503,"../../lib/events":492,"../../registry":638,"../pie/helpers":905,"./helpers":1051,"@plotly/d3":58}],1051:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/color"),s=r("../../lib/setcursor"),l=r("../pie/helpers");function c(r){return r.data.data.pid}i.findEntryWithLevel=function(r,n){var a;return n&&r.eachAfter(function(r){if(i.getPtId(r)===n)return a=r.copy()}),a||r},i.findEntryWithChild=function(r,n){var a;return r.eachAfter(function(r){for(var o=r.children||[],s=0;s<o.length;s++){var l=o[s];if(i.getPtId(l)===n)return a=r.copy()}}),a||r},i.isEntry=function(r){return!r.parent},i.isLeaf=function(r){return!r.children},i.getPtId=function(r){return r.data.data.id},i.getPtLabel=function(r){return r.data.data.label},i.getValue=function(r){return r.value},i.isHierarchyRoot=function(r){return""===c(r)},i.setSliceCursor=function(r,n,a){var o=a.isTransitioning;if(!o){var l=r.datum();o=a.hideOnRoot&&i.isHierarchyRoot(l)||a.hideOnLeaves&&i.isLeaf(l)}s(r,o?null:"pointer")},i.getInsideTextFontKey=function(r,n,i,o,s){var l=(s||{}).onPathbar?"pathbar.textfont":"insidetextfont",c=i.data.data.i;return a.castOption(n,c,l+"."+r)||a.castOption(n,c,"textfont."+r)||o.size},i.getOutsideTextFontKey=function(r,n,i,o){var s=i.data.data.i;return a.castOption(n,s,"outsidetextfont."+r)||a.castOption(n,s,"textfont."+r)||o.size},i.isOutsideText=function(r,n){return!r._hasColorscale&&i.isHierarchyRoot(n)},i.determineTextFont=function(r,n,s,l){var c,u,f,h;return i.isOutsideText(r,n)?{color:i.getOutsideTextFontKey("color",r,n,s),family:i.getOutsideTextFontKey("family",r,n,s),size:i.getOutsideTextFontKey("size",r,n,s)}:(c=(l||{}).onPathbar,f=(u=n.data.data).i,(h=a.castOption(r,f,(c?"pathbar.textfont":"insidetextfont")+".color"))||!r._input.textfont||(h=a.castOption(r._input,f,"textfont.color")),{color:h||o.contrast(u.color),family:i.getInsideTextFontKey("family",r,n,s,l),size:i.getInsideTextFontKey("size",r,n,s,l)})},i.hasTransition=function(r){return!!(r&&r.duration>0)},i.getMaxDepth=function(r){return r.maxdepth>=0?r.maxdepth:1/0},i.isHeader=function(r,n){return!(i.isLeaf(r)||r.depth===n._maxDepth-1)},i.getParent=function(r,n){return i.findEntryWithLevel(r,c(n))},i.listPath=function(r,n){var a=r.parent;if(!a)return[];var o=n?[a.data[n]]:[a];return i.listPath(a,n).concat(o)},i.getPath=function(r){return i.listPath(r,"label").join("/")+"/"},i.formatValue=l.formatPieValue,i.formatPercent=function(r,n){var i=a.formatPercent(r,0);return"0%"===i&&(i=l.formatPiePercent(r,n)),i}},{"../../components/color":366,"../../lib":503,"../../lib/setcursor":524,"../pie/helpers":905}],1052:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"sunburst",basePlotModule:r("./base_plot"),categories:[],animatable:!0,attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot").plot,style:r("./style").style,colorbar:r("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":944,"./attributes":1045,"./base_plot":1046,"./calc":1047,"./defaults":1049,"./layout_attributes":1053,"./layout_defaults":1054,"./plot":1055,"./style":1056}],1053:[function(r,n,i){"use strict";n.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1054:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n){function i(i,s){return a.coerce(r,n,o,i,s)}i("sunburstcolorway",n.colorway),i("extendsunburstcolors")}},{"../../lib":503,"./layout_attributes":1053}],1055:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("d3-hierarchy"),s=r("d3-interpolate").interpolate,l=r("../../components/drawing"),c=r("../../lib"),u=r("../../lib/svg_text_utils"),f=r("../bar/uniform_text"),h=f.recordMinTextSize,p=f.clearMinTextSize,d=r("../pie/plot"),m=r("../pie/helpers").getRotationAngle,g=d.computeTransform,v=d.transformInsideText,y=r("./style").styleOne,x=r("../bar/style").resizeText,b=r("./fx"),_=r("./constants"),w=r("./helpers");function T(r,n,f,p){var d=r._fullLayout,x=!d.uniformtext.mode&&w.hasTransition(p),T=a.select(f).selectAll("g.slice"),A=n[0],M=A.trace,S=A.hierarchy,E=w.findEntryWithLevel(S,M.level),L=w.getMaxDepth(M),C=d._size,P=M.domain,I=C.w*(P.x[1]-P.x[0]),O=C.h*(P.y[1]-P.y[0]),z=.5*Math.min(I,O),D=A.cx=C.l+C.w*(P.x[1]+P.x[0])/2,R=A.cy=C.t+C.h*(1-P.y[0])-O/2;if(!E)return T.remove();var F=null,B={};x&&T.each(function(r){B[w.getPtId(r)]={rpx0:r.rpx0,rpx1:r.rpx1,x0:r.x0,x1:r.x1,transform:r.transform},!F&&w.isEntry(r)&&(F=r)});var N=o.partition().size([2*Math.PI,E.height+1])(E).descendants(),j=E.height+1,U=0,V=L;A.hasMultipleRoots&&w.isHierarchyRoot(E)&&(N=N.slice(1),j-=1,U=1,V+=1),N=N.filter(function(r){return r.y1<=V});var H=m(M.rotation);H&&N.forEach(function(r){r.x0+=H,r.x1+=H});var q=Math.min(j,L),G=function(r){return(r-U)/q*z},Y=function(r,n){return[r*Math.cos(n),-r*Math.sin(n)]},W=function(r){return c.pathAnnulus(r.rpx0,r.rpx1,r.x0,r.x1,D,R)},X=function(r){return D+k(r)[0]*(r.transform.rCenter||0)+(r.transform.x||0)},Z=function(r){return R+k(r)[1]*(r.transform.rCenter||0)+(r.transform.y||0)};(T=T.data(N,w.getPtId)).enter().append("g").classed("slice",!0),x?T.exit().transition().each(function(){var r=a.select(this);r.select("path.surface").transition().attrTween("d",function(r){var n=function(r){var n,i=w.getPtId(r),a=B[i],o=B[w.getPtId(E)];if(o){var l=(r.x1>o.x1?2*Math.PI:0)+H;n=r.rpx1<o.rpx1?{x0:r.x0,x1:r.x1,rpx0:0,rpx1:0}:{x0:l,x1:l,rpx0:r.rpx0,rpx1:r.rpx1}}else{var c,u=w.getPtId(r.parent);T.each(function(r){if(w.getPtId(r)===u)return c=r});var f,h=c.children;h.forEach(function(r,n){if(w.getPtId(r)===i)return f=n});var p=h.length,d=s(c.x0,c.x1);n={rpx0:z,rpx1:z,x0:d(f/p),x1:d((f+1)/p)}}return s(a,n)}(r);return function(r){return W(n(r))}}),r.select("g.slicetext").attr("opacity",0)}).remove():T.exit().remove(),T.order();var J=null;if(x&&F){var K=w.getPtId(F);T.each(function(r){null===J&&w.getPtId(r)===K&&(J=r.x1)})}var Q=T;function $(r){var n=r.parent,i=B[w.getPtId(n)],a={};if(i){var o=n.children,l=o.indexOf(r),c=o.length,u=s(i.x0,i.x1);a.x0=u(l/c),a.x1=u(l/c)}else a.x0=a.x1=0;return a}x&&(Q=Q.transition().each("end",function(){var n=a.select(this);w.setSliceCursor(n,r,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Q.each(function(o){var f=a.select(this),p=c.ensureSingle(f,"path","surface",function(r){r.style("pointer-events","all")});o.rpx0=G(o.y0),o.rpx1=G(o.y1),o.xmid=(o.x0+o.x1)/2,o.pxmid=Y(o.rpx1,o.xmid),o.midangle=-(o.xmid-Math.PI/2),o.startangle=-(o.x0-Math.PI/2),o.stopangle=-(o.x1-Math.PI/2),o.halfangle=.5*Math.min(c.angleDelta(o.x0,o.x1)||Math.PI,Math.PI),o.ring=1-o.rpx0/o.rpx1,o.rInscribed=0===o.rpx0&&c.isFullCircle([o.x0,o.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(o.halfangle)),o.ring/2)),x?p.transition().attrTween("d",function(r){var n=function(r){var n,i=B[w.getPtId(r)],a={x0:r.x0,x1:r.x1,rpx0:r.rpx0,rpx1:r.rpx1};if(i)n=i;else if(F){if(r.parent){if(J){var o=(r.x1>J?2*Math.PI:0)+H;n={x0:o,x1:o}}else n={rpx0:z,rpx1:z},c.extendFlat(n,$(r))}else n={rpx0:0,rpx1:0}}else n={x0:H,x1:H};return s(n,a)}(r);return function(r){return W(n(r))}}):p.attr("d",W),f.call(b,E,r,n,{eventDataKeys:_.eventDataKeys,transitionTime:_.CLICK_TRANSITION_TIME,transitionEasing:_.CLICK_TRANSITION_EASING}).call(w.setSliceCursor,r,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:r._transitioning}),p.call(y,o,M);var m=c.ensureSingle(f,"g","slicetext"),T=c.ensureSingle(m,"text","",function(r){r.attr("data-notex",1)}),k=c.ensureUniformFontSize(r,w.determineTextFont(M,o,d.font));T.text(i.formatSliceLabel(o,E,M,n,d)).classed("slicetext",!0).attr("text-anchor","middle").call(l.font,k).call(u.convertToTspans,r);var S=l.bBox(T.node());o.transform=v(S,o,A),o.transform.targetX=X(o),o.transform.targetY=Z(o);var L=function(r,n){var i=r.transform;return g(i,n),i.fontSize=k.size,h(M.type,i,d),c.getTextTransform(i)};x?T.transition().attrTween("transform",function(r){var n=function(r){var n,i=B[w.getPtId(r)],a=r.transform;if(i)n=i;else if(n={rpx1:r.rpx1,transform:{textPosAngle:a.textPosAngle,scale:0,rotate:a.rotate,rCenter:a.rCenter,x:a.x,y:a.y}},F){if(r.parent){if(J){var o=r.x1>J?2*Math.PI:0;n.x0=n.x1=o}else c.extendFlat(n,$(r))}else n.x0=n.x1=H}else n.x0=n.x1=H;var l=s(n.transform.textPosAngle,r.transform.textPosAngle),u=s(n.rpx1,r.rpx1),f=s(n.x0,r.x0),p=s(n.x1,r.x1),m=s(n.transform.scale,a.scale),g=s(n.transform.rotate,a.rotate),v=0===a.rCenter?3:0===n.transform.rCenter?1/3:1,y=s(n.transform.rCenter,a.rCenter);return function(r){var n=u(r),i=f(r),o=p(r),s=y(Math.pow(r,v)),c={pxmid:Y(n,(i+o)/2),rpx1:n,transform:{textPosAngle:l(r),rCenter:s,x:a.x,y:a.y}};return h(M.type,a,d),{transform:{targetX:X(c),targetY:Z(c),scale:m(r),rotate:g(r),rCenter:s}}}}(r);return function(r){return L(n(r),S)}}):T.attr("transform",L(o,S))})}function k(r){var n,i;return[(n=r.rpx1)*Math.sin(i=r.transform.textPosAngle),-n*Math.cos(i)]}i.plot=function(r,n,i,o){var s,l,c=r._fullLayout,u=c._sunburstlayer,f=!i,h=!c.uniformtext.mode&&w.hasTransition(i);(p("sunburst",c),(s=u.selectAll("g.trace.sunburst").data(n,function(r){return r[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),s.order(),h)?(o&&(l=o()),a.transition().duration(i.duration).ease(i.easing).each("end",function(){l&&l()}).each("interrupt",function(){l&&l()}).each(function(){u.selectAll("g.trace").each(function(n){T(r,n,this,i)})})):(s.each(function(n){T(r,n,this,i)}),c.uniformtext.mode&&x(r,c._sunburstlayer.selectAll(".trace"),"sunburst")),f&&s.exit().remove()},i.formatSliceLabel=function(r,n,i,a,o){var s=i.texttemplate,l=i.textinfo;if(!(s||l&&"none"!==l))return"";var u=o.separators,f=a[0],h=r.data.data,p=f.hierarchy,d=w.isHierarchyRoot(r),m=w.getParent(p,r),g=w.getValue(r);if(!s){var v,y=l.split("+"),x=function(r){return -1!==y.indexOf(r)},b=[];if(x("label")&&h.label&&b.push(h.label),h.hasOwnProperty("v")&&x("value")&&b.push(w.formatValue(h.v,u)),!d){x("current path")&&b.push(w.getPath(r.data));var _=0;x("percent parent")&&_++,x("percent entry")&&_++,x("percent root")&&_++;var T=_>1;if(_){var k,A=function(r){v=w.formatPercent(k,u),T&&(v+=" of "+r),b.push(v)};x("percent parent")&&!d&&(k=g/w.getValue(m),A("parent")),x("percent entry")&&(k=g/w.getValue(n),A("entry")),x("percent root")&&(k=g/w.getValue(p),A("root"))}}return x("text")&&(v=c.castOption(i,h.i,"text"),c.isValidTextValue(v)&&b.push(v)),b.join("<br>")}var M=c.castOption(i,h.i,"texttemplate");if(!M)return"";var S={};h.label&&(S.label=h.label),h.hasOwnProperty("v")&&(S.value=h.v,S.valueLabel=w.formatValue(h.v,u)),S.currentPath=w.getPath(r.data),d||(S.percentParent=g/w.getValue(m),S.percentParentLabel=w.formatPercent(S.percentParent,u),S.parent=w.getPtLabel(m)),S.percentEntry=g/w.getValue(n),S.percentEntryLabel=w.formatPercent(S.percentEntry,u),S.entry=w.getPtLabel(n),S.percentRoot=g/w.getValue(p),S.percentRootLabel=w.formatPercent(S.percentRoot,u),S.root=w.getPtLabel(p),h.hasOwnProperty("color")&&(S.color=h.color);var E=c.castOption(i,h.i,"text");return(c.isValidTextValue(E)||""===E)&&(S.text=E),S.customdata=c.castOption(i,h.i,"customdata"),c.texttemplateString(M,S,o._d3locale,S,i._meta||{})}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../bar/style":662,"../bar/uniform_text":664,"../pie/helpers":905,"../pie/plot":909,"./constants":1048,"./fx":1050,"./helpers":1051,"./style":1056,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1056:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/color"),s=r("../../lib"),l=r("../bar/uniform_text").resizeText;function c(r,n,i){var a=n.data.data,l=!n.children,c=a.i,u=s.castOption(i,c,"marker.line.color")||o.defaultLine,f=s.castOption(i,c,"marker.line.width")||0;r.style("stroke-width",f).call(o.fill,a.color).call(o.stroke,u).style("opacity",l?i.leaf.opacity:null)}n.exports={style:function(r){var n=r._fullLayout._sunburstlayer.selectAll(".trace");l(r,n,"sunburst"),n.each(function(r){var n=a.select(this),i=r[0].trace;n.style("opacity",i.opacity),n.selectAll("path.surface").each(function(r){a.select(this).call(c,r,i)})})},styleOne:c}},{"../../components/color":366,"../../lib":503,"../bar/uniform_text":664,"@plotly/d3":58}],1057:[function(r,n,i){"use strict";var a=r("../../components/color"),o=r("../../components/colorscale/attributes"),s=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,l=r("../../plots/template_attributes").hovertemplateAttrs,c=r("../../plots/attributes"),u=r("../../lib/extend").extendFlat,f=r("../../plot_api/edit_types").overrideAll;function h(r){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:a.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:a.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var p=n.exports=f(u({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:l(),xhoverformat:s("x"),yhoverformat:s("y"),zhoverformat:s("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},o("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:h(),y:h(),z:h()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:u({},o.zauto,{}),zmin:u({},o.zmin,{}),zmax:u({},o.zmax,{})},hoverinfo:u({},c.hoverinfo),showlegend:u({},c.showlegend,{dflt:!1})}),"calc","nested");p.x.editType=p.y.editType=p.z.editType="calc+clearAxisTypes",p.transforms=void 0},{"../../components/color":366,"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633}],1058:[function(r,n,i){"use strict";var a=r("../../components/colorscale/calc");n.exports=function(r,n){n.surfacecolor?a(r,n,{vals:n.surfacecolor,containerStr:"",cLetter:"c"}):a(r,n,{vals:n.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374}],1059:[function(r,n,i){"use strict";var a=r("../../../stackgl_modules").gl_surface3d,o=r("../../../stackgl_modules").ndarray,s=r("../../../stackgl_modules").ndarray_linear_interpolate.d2,l=r("../heatmap/interp2d"),c=r("../heatmap/find_empties"),u=r("../../lib").isArrayOrTypedArray,f=r("../../lib/gl_format_color").parseColorScale,h=r("../../lib/str2rgbarray"),p=r("../../components/colorscale").extractOpts;function d(r,n,i){this.scene=r,this.uid=i,this.surface=n,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var m=d.prototype;m.getXat=function(r,n,i,a){var o=u(this.data.x)?u(this.data.x[0])?this.data.x[n][r]:this.data.x[r]:r;return void 0===i?o:a.d2l(o,0,i)},m.getYat=function(r,n,i,a){var o=u(this.data.y)?u(this.data.y[0])?this.data.y[n][r]:this.data.y[n]:n;return void 0===i?o:a.d2l(o,0,i)},m.getZat=function(r,n,i,a){var o=this.data.z[n][r];return null===o&&this.data.connectgaps&&this.data._interpolatedZ&&(o=this.data._interpolatedZ[n][r]),void 0===i?o:a.d2l(o,0,i)},m.handlePick=function(r){if(r.object===this.surface){var n=(r.data.index[0]-1)/this.dataScaleX-1,i=(r.data.index[1]-1)/this.dataScaleY-1,a=Math.max(Math.min(Math.round(n),this.data.z[0].length-1),0),o=Math.max(Math.min(Math.round(i),this.data._ylength-1),0);r.index=[a,o],r.traceCoordinate=[this.getXat(a,o),this.getYat(a,o),this.getZat(a,o)],r.dataCoordinate=[this.getXat(a,o,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(a,o,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(a,o,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var s=0;s<3;s++)null!=r.dataCoordinate[s]&&(r.dataCoordinate[s]*=this.scene.dataScale[s]);var l=this.data.hovertext||this.data.text;return Array.isArray(l)&&l[o]&&void 0!==l[o][a]?r.textLabel=l[o][a]:r.textLabel=l||"",r.data.dataCoordinate=r.dataCoordinate.slice(),this.surface.highlight(r.data),this.scene.glplot.spikes.position=r.dataCoordinate,!0}};var g=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function v(r){for(var n=[],i=0;i<g.length;i++){var a=g[i];n.push(function(r,n){if(r<n)return 0;for(var i=0;0===Math.floor(r%n);)r/=n,i++;return i}(r,a))}return n}function y(r,n,i){var a=i[8]+i[2]*n[0]+i[5]*n[1];return r[0]=(i[6]+i[0]*n[0]+i[3]*n[1])/a,r[1]=(i[7]+i[1]*n[0]+i[4]*n[1])/a,r}m.calcXnums=function(r){var n,i=[];for(n=1;n<r;n++){var a=this.getXat(n-1,0),o=this.getXat(n,0);i[n-1]=o!==a&&null!=a&&null!=o?Math.abs(o-a):0}var s=0;for(n=1;n<r;n++)s+=i[n-1];for(n=1;n<r;n++)0===i[n-1]?i[n-1]=1:i[n-1]=Math.round(s/i[n-1]);return i},m.calcYnums=function(r){var n,i=[];for(n=1;n<r;n++){var a=this.getYat(0,n-1),o=this.getYat(0,n);i[n-1]=o!==a&&null!=a&&null!=o?Math.abs(o-a):0}var s=0;for(n=1;n<r;n++)s+=i[n-1];for(n=1;n<r;n++)0===i[n-1]?i[n-1]=1:i[n-1]=Math.round(s/i[n-1]);return i},m.estimateScale=function(r,n){for(var i=1+function(r){if(0!==r.length){for(var n=1,i=0;i<r.length;i++)n=function(r,n){if(!(r<1||n<1)){for(var i=v(r),a=v(n),o=1,s=0;s<g.length;s++)o*=Math.pow(g[s],Math.max(i[s],a[s]));return o}}(n,r[i]);return n}}(0===n?this.calcXnums(r):this.calcYnums(r));i<120;)i*=2;for(;i>720;)i--,i/=function(r){for(var n=v(r),i=r,a=0;a<g.length;a++)if(n[a]>0){i=g[a];break}return i}(i),++i<120&&(i=720);var a=Math.round(i/r);return a>1?a:1},m.refineCoords=function(r){for(var n=this.dataScaleX,i=this.dataScaleY,a=r[0].shape[0],l=r[0].shape[1],c=0|Math.floor(r[0].shape[0]*n+1),u=0|Math.floor(r[0].shape[1]*i+1),f=1+a+1,h=1+l+1,p=o(new Float32Array(f*h),[f,h]),d=[1/n,0,0,0,1/i,0,0,0,1],m=0;m<r.length;++m){this.surface.padField(p,r[m]);var g=o(new Float32Array(c*u),[c,u]);(function(r,n,i,a){for(var o=[0,0],l=r.shape[0],c=r.shape[1],u=0;u<l;u++)for(var f=0;f<c;f++)i(o,[u,f],a),r.set(u,f,s(n,o[0],o[1]))})(g,p,y,d),r[m]=g}},m.setContourLevels=function(){var r,n,i,a=[[],[],[]],o=[!1,!1,!1],s=!1;for(r=0;r<3;++r)if(this.showContour[r]&&(s=!0,this.contourSize[r]>0&&null!==this.contourStart[r]&&null!==this.contourEnd[r]&&this.contourEnd[r]>this.contourStart[r]))for(o[r]=!0,n=this.contourStart[r];n<this.contourEnd[r];n+=this.contourSize[r])i=n*this.scene.dataScale[r],function(r,n){for(var i=!1,a=0;a<r.length;a++)if(n===r[a]){i=!0;break}!1===i&&r.push(n)}(a[r],i);if(s){var l=[[],[],[]];for(r=0;r<3;++r)this.showContour[r]&&(l[r]=o[r]?a[r]:this.scene.contourLevels[r]);this.surface.update({levels:l})}},m.update=function(r){var n,i,a,s,u,d,m=this.scene,g=m.fullSceneLayout,v=this.surface,y=f(r),x=m.dataScale,b=r.z[0].length,_=r._ylength,w=m.contourLevels;this.data=r;var T=[];for(a=0;a<3;a++)for(T[a]=[],s=0;s<b;s++)T[a][s]=[];for(s=0;s<b;s++)for(u=0;u<_;u++)T[0][s][u]=this.getXat(s,u,r.xcalendar,g.xaxis),T[1][s][u]=this.getYat(s,u,r.ycalendar,g.yaxis),T[2][s][u]=this.getZat(s,u,r.zcalendar,g.zaxis);if(r.connectgaps)for(r._emptypoints=c(T[2]),l(T[2],r._emptypoints),r._interpolatedZ=[],s=0;s<b;s++)for(r._interpolatedZ[s]=[],u=0;u<_;u++)r._interpolatedZ[s][u]=T[2][s][u];for(a=0;a<3;a++)for(s=0;s<b;s++)for(u=0;u<_;u++)null==(d=T[a][s][u])?T[a][s][u]=NaN:d=T[a][s][u]*=x[a];for(a=0;a<3;a++)for(s=0;s<b;s++)for(u=0;u<_;u++)null!=(d=T[a][s][u])&&(this.minValues[a]>d&&(this.minValues[a]=d),this.maxValues[a]<d&&(this.maxValues[a]=d));for(a=0;a<3;a++)this.objectOffset[a]=.5*(this.minValues[a]+this.maxValues[a]);for(a=0;a<3;a++)for(s=0;s<b;s++)for(u=0;u<_;u++)null!=(d=T[a][s][u])&&(T[a][s][u]-=this.objectOffset[a]);var k=[o(new Float32Array(b*_),[b,_]),o(new Float32Array(b*_),[b,_]),o(new Float32Array(b*_),[b,_])];for(a=0;a<3;a++)for(s=0;s<b;s++)for(u=0;u<_;u++)k[a].set(s,u,T[a][s][u]);T=[];var A={colormap:y,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!r.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:r.opacityscale,opacity:r.opacity},M=p(r);if(A.intensityBounds=[M.min,M.max],r.surfacecolor){var S=o(new Float32Array(b*_),[b,_]);for(s=0;s<b;s++)for(u=0;u<_;u++)S.set(s,u,r.surfacecolor[u][s]);k.push(S)}else A.intensityBounds[0]*=x[2],A.intensityBounds[1]*=x[2];(720<k[0].shape[0]||720<k[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(k[0].shape[0],0),this.dataScaleY=this.estimateScale(k[0].shape[1],1),1===this.dataScaleX&&1===this.dataScaleY||this.refineCoords(k)),r.surfacecolor&&(A.intensity=k.pop());var E=[!0,!0,!0],L=["x","y","z"];for(a=0;a<3;++a){var C=r.contours[L[a]];E[a]=C.highlight,A.showContour[a]=C.show||C.highlight,A.showContour[a]&&(A.contourProject[a]=[C.project.x,C.project.y,C.project.z],C.show?(this.showContour[a]=!0,A.levels[a]=w[a],v.highlightColor[a]=A.contourColor[a]=h(C.color),C.usecolormap?v.highlightTint[a]=A.contourTint[a]=0:v.highlightTint[a]=A.contourTint[a]=1,A.contourWidth[a]=C.width,this.contourStart[a]=C.start,this.contourEnd[a]=C.end,this.contourSize[a]=C.size):(this.showContour[a]=!1,this.contourStart[a]=null,this.contourEnd[a]=null,this.contourSize[a]=0),C.highlight&&(A.dynamicColor[a]=h(C.highlightcolor),A.dynamicWidth[a]=C.highlightwidth))}n=y[0].rgb,i=y[y.length-1].rgb,n[0]===i[0]&&n[1]===i[1]&&n[2]===i[2]&&n[3]===i[3]&&(A.vertexColor=!0),A.objectOffset=this.objectOffset,A.coords=k,v.update(A),v.visible=r.visible,v.enableDynamic=E,v.enableHighlight=E,v.snapToData=!0,"lighting"in r&&(v.ambientLight=r.lighting.ambient,v.diffuseLight=r.lighting.diffuse,v.specularLight=r.lighting.specular,v.roughness=r.lighting.roughness,v.fresnel=r.lighting.fresnel),"lightposition"in r&&(v.lightPosition=[r.lightposition.x,r.lightposition.y,r.lightposition.z])},m.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},n.exports=function(r,n){var i=a({gl:r.glplot.gl}),o=new d(r,i,n.uid);return i._trace=o,o.update(n),r.glplot.add(i),o}},{"../../../stackgl_modules":1120,"../../components/colorscale":378,"../../lib":503,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../heatmap/find_empties":798,"../heatmap/interp2d":801}],1060:[function(r,n,i){"use strict";var a=r("../../registry"),o=r("../../lib"),s=r("../../components/colorscale/defaults"),l=r("./attributes");function c(r,n,i,a){var o=a("opacityscale");"max"===o?n.opacityscale=[[0,.1],[1,1]]:"min"===o?n.opacityscale=[[0,1],[1,.1]]:"extremes"===o?n.opacityscale=function(r,n){for(var i=[],a=0;a<32;a++){var o=a/31,s=n+(1-n)*(1-Math.pow(Math.sin(1*o*Math.PI),2));i.push([o,Math.max(0,Math.min(1,s))])}return i}(0,.1):function(r){var n=0;if(!Array.isArray(r)||r.length<2||!r[0]||!r[r.length-1]||0!=+r[0][0]||1!=+r[r.length-1][0])return!1;for(var i=0;i<r.length;i++){var a=r[i];if(2!==a.length||+a[0]<n)return!1;n=+a[0]}return!0}(o)||(n.opacityscale=void 0)}function u(r,n,i){n in r&&!(i in r)&&(r[i]=r[n])}n.exports={supplyDefaults:function(r,n,i,f){function h(i,a){return o.coerce(r,n,l,i,a)}var p,d,m=h("x"),g=h("y"),v=h("z");if(!v||!v.length||m&&m.length<1||g&&g.length<1)n.visible=!1;else{n._xlength=Array.isArray(m)&&o.isArrayOrTypedArray(m[0])?v.length:v[0].length,n._ylength=v.length,a.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x","y","z"],f),h("text"),h("hovertext"),h("hovertemplate"),h("xhoverformat"),h("yhoverformat"),h("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(r){h(r)});var y=h("surfacecolor"),x=["x","y","z"];for(p=0;p<3;++p){var b="contours."+x[p],_=h(b+".show"),w=h(b+".highlight");if(_||w)for(d=0;d<3;++d)h(b+".project."+x[d]);_&&(h(b+".color"),h(b+".width"),h(b+".usecolormap")),w&&(h(b+".highlightcolor"),h(b+".highlightwidth")),h(b+".start"),h(b+".end"),h(b+".size")}y||(u(r,"zmin","cmin"),u(r,"zmax","cmax"),u(r,"zauto","cauto")),s(r,n,f,h,{prefix:"",cLetter:"c"}),c(r,n,f,h),n._length=null}},opacityscaleDefaults:c}},{"../../components/colorscale/defaults":376,"../../lib":503,"../../registry":638,"./attributes":1057}],1061:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:r("./calc"),plot:r("./convert"),moduleType:"trace",name:"surface",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":598,"./attributes":1057,"./calc":1058,"./convert":1059,"./defaults":1060}],1062:[function(r,n,i){"use strict";var a=r("../../components/annotations/attributes"),o=r("../../lib/extend").extendFlat,s=r("../../plot_api/edit_types").overrideAll,l=r("../../plots/font_attributes"),c=r("../../plots/domain").attributes,u=r("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(n.exports=s({domain:c({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:u("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:o({},a.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:o({},l({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:u("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:o({},a.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:o({},l({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":349,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/cartesian/axis_format_attributes":557,"../../plots/domain":584,"../../plots/font_attributes":585}],1063:[function(r,n,i){"use strict";var a=r("../../plots/get_data").getModuleCalcData,o=r("./plot");i.name="table",i.plot=function(r){var n=a(r.calcdata,"table")[0];n.length&&o(r,n)},i.clean=function(r,n,i,a){var o=a._has&&a._has("table"),s=n._has&&n._has("table");o&&!s&&a._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":593,"./plot":1070}],1064:[function(r,n,i){"use strict";var a=r("../../lib/gup").wrap;n.exports=function(){return a({})}},{"../../lib/gup":500}],1065:[function(r,n,i){"use strict";n.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1066:[function(r,n,i){"use strict";var a=r("./constants"),o=r("../../lib/extend").extendFlat,s=r("fast-isnumeric");function l(r){if(Array.isArray(r)){for(var n=0,i=0;i<r.length;i++)n=Math.max(n,l(r[i]));return n}return r}function c(r,n){return r+n}function u(r){var n,i=r.slice(),a=1/0,o=0;for(n=0;n<i.length;n++)Array.isArray(i[n])||(i[n]=[i[n]]),a=Math.min(a,i[n].length),o=Math.max(o,i[n].length);if(a!==o)for(n=0;n<i.length;n++){var s=o-i[n].length;s&&(i[n]=i[n].concat(f(s)))}return i}function f(r){for(var n=Array(r),i=0;i<r;i++)n[i]="";return n}function h(r){return r.calcdata.columns.reduce(function(n,i){return i.xIndex<r.xIndex?n+i.columnWidth:n},0)}function p(r,n){return Object.keys(r).map(function(i){return o({},r[i],{auxiliaryBlocks:n})})}function d(r,n){for(var i,a={},o=0,s=0,l={firstRowIndex:null,lastRowIndex:null,rows:[]},c=0,u=0,f=0;f<r.length;f++)i=r[f],l.rows.push({rowIndex:f,rowHeight:i}),((s+=i)>=n||f===r.length-1)&&(a[o]=l,l.key=u++,l.firstRowIndex=c,l.lastRowIndex=f,l={firstRowIndex:null,lastRowIndex:null,rows:[]},o+=s,c=f+1,s=0);return a}n.exports=function(r,n){var i=u(n.cells.values),m=function(r){return r.slice(n.header.values.length,r.length)},g=u(n.header.values);g.length&&!g[0].length&&(g[0]=[""],g=u(g));var v=g.concat(m(i).map(function(){return f((g[0]||[""]).length)})),y=n.domain,x=Math.floor(r._fullLayout._size.w*(y.x[1]-y.x[0])),b=Math.floor(r._fullLayout._size.h*(y.y[1]-y.y[0])),_=n.header.values.length?v[0].map(function(){return n.header.height}):[a.emptyHeaderHeight],w=i.length?i[0].map(function(){return n.cells.height}):[],T=_.reduce(c,0),k=d(w,b-T+a.uplift),A=p(d(_,T),[]),M=p(k,A),S={},E=n._fullInput.columnorder.concat(m(i.map(function(r,n){return n}))),L=v.map(function(r,i){var a=Array.isArray(n.columnwidth)?n.columnwidth[Math.min(i,n.columnwidth.length-1)]:n.columnwidth;return s(a)?Number(a):1}),C=L.reduce(c,0);L=L.map(function(r){return r/C*x});var P=Math.max(l(n.header.line.width),l(n.cells.line.width)),I={key:n.uid+r._context.staticPlot,translateX:y.x[0]*r._fullLayout._size.w,translateY:r._fullLayout._size.h*(1-y.y[1]),size:r._fullLayout._size,width:x,maxLineWidth:P,height:b,columnOrder:E,groupHeight:b,rowBlocks:M,headerRowBlocks:A,scrollY:0,cells:o({},n.cells,{values:i}),headerCells:o({},n.header,{values:v}),gdColumns:v.map(function(r){return r[0]}),gdColumnsOriginalOrder:v.map(function(r){return r[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:v.map(function(r,n){var i=S[r];return S[r]=(i||0)+1,{key:r+"__"+S[r],label:r,specIndex:n,xIndex:E[n],xScale:h,x:void 0,calcdata:void 0,columnWidth:L[n]}})};return I.columns.forEach(function(r){r.calcdata=I,r.x=h(r)}),I}},{"../../lib/extend":493,"./constants":1065,"fast-isnumeric":190}],1067:[function(r,n,i){"use strict";var a=r("../../lib/extend").extendFlat;i.splitToPanels=function(r){var n=[0,0],i=a({},r,{key:"header",type:"header",page:0,prevPages:n,currentRepaint:[null,null],dragHandle:!0,values:r.calcdata.headerCells.values[r.specIndex],rowBlocks:r.calcdata.headerRowBlocks,calcdata:a({},r.calcdata,{cells:r.calcdata.headerCells})});return[a({},r,{key:"cells1",type:"cells",page:0,prevPages:n,currentRepaint:[null,null],dragHandle:!1,values:r.calcdata.cells.values[r.specIndex],rowBlocks:r.calcdata.rowBlocks}),a({},r,{key:"cells2",type:"cells",page:1,prevPages:n,currentRepaint:[null,null],dragHandle:!1,values:r.calcdata.cells.values[r.specIndex],rowBlocks:r.calcdata.rowBlocks}),i]},i.splitToCells=function(r){var n,i,a,o=(i=(n=r.rowBlocks[r.page])?n.rows[0].rowIndex:0,a=n?i+n.rows.length:0,[i,a]);return(r.values||[]).slice(o[0],o[1]).map(function(n,i){return{keyWithinBlock:i+("string"==typeof n&&n.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:o[0]+i,column:r,calcdata:r.calcdata,page:r.page,rowBlocks:r.rowBlocks,value:n}})}},{"../../lib/extend":493}],1068:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("../../plots/domain").defaults;n.exports=function(r,n,i,l){function c(i,s){return a.coerce(r,n,o,i,s)}s(n,l,c),c("columnwidth"),c("header.values"),c("header.format"),c("header.align"),c("header.prefix"),c("header.suffix"),c("header.height"),c("header.line.width"),c("header.line.color"),c("header.fill.color"),a.coerceFont(c,"header.font",a.extendFlat({},l.font)),function(r,n){for(var i=r.columnorder||[],a=r.header.values.length,o=i.slice(0,a),s=o.slice().sort(function(r,n){return r-n}),l=o.map(function(r){return s.indexOf(r)}),c=l.length;c<a;c++)l.push(c);n("columnorder",l)}(n,c),c("cells.values"),c("cells.format"),c("cells.align"),c("cells.prefix"),c("cells.suffix"),c("cells.height"),c("cells.line.width"),c("cells.line.color"),c("cells.fill.color"),a.coerceFont(c,"cells.font",a.extendFlat({},l.font)),n._length=null}},{"../../lib":503,"../../plots/domain":584,"./attributes":1062}],1069:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("./calc"),plot:r("./plot"),moduleType:"trace",name:"table",basePlotModule:r("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1062,"./base_plot":1063,"./calc":1064,"./defaults":1068,"./plot":1070}],1070:[function(r,n,i){"use strict";var a=r("./constants"),o=r("@plotly/d3"),s=r("../../lib").numberFormat,l=r("../../lib/gup"),c=r("../../components/drawing"),u=r("../../lib/svg_text_utils"),f=r("../../lib").raiseToTop,h=r("../../lib").strTranslate,p=r("../../lib").cancelTransition,d=r("./data_preparation_helper"),m=r("./data_split_helpers"),g=r("../../components/color");function v(r){return Math.ceil(r.calcdata.maxLineWidth/2)}function y(r,n){return"clip"+r._fullLayout._uid+"_scrollAreaBottomClip_"+n.key}function x(r,n){return"clip"+r._fullLayout._uid+"_columnBoundaryClippath_"+n.calcdata.key+"_"+n.specIndex}function b(r){return[].concat.apply([],r.map(function(r){return r})).map(function(r){return r.__data__})}function _(r,n,i){var s=r.selectAll("."+a.cn.scrollbarKit).data(l.repeat,l.keyFun);s.enter().append("g").classed(a.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),s.each(function(r){var n,i=r.scrollbarState;i.totalHeight=F(n=r.rowBlocks,n.length-1)+(n.length?B(n[n.length-1],1/0):1),i.scrollableAreaHeight=r.groupHeight-L(r),i.currentlyVisibleHeight=Math.min(i.totalHeight,i.scrollableAreaHeight),i.ratio=i.currentlyVisibleHeight/i.totalHeight,i.barLength=Math.max(i.ratio*i.currentlyVisibleHeight,a.goldenRatio*a.scrollbarWidth),i.barWiggleRoom=i.currentlyVisibleHeight-i.barLength,i.wiggleRoom=Math.max(0,i.totalHeight-i.scrollableAreaHeight),i.topY=0===i.barWiggleRoom?0:r.scrollY/i.wiggleRoom*i.barWiggleRoom,i.bottomY=i.topY+i.barLength,i.dragMultiplier=i.wiggleRoom/i.barWiggleRoom}).attr("transform",function(r){return h(r.width+a.scrollbarWidth/2+a.scrollbarOffset,L(r))});var c=s.selectAll("."+a.cn.scrollbar).data(l.repeat,l.keyFun);c.enter().append("g").classed(a.cn.scrollbar,!0);var u=c.selectAll("."+a.cn.scrollbarSlider).data(l.repeat,l.keyFun);u.enter().append("g").classed(a.cn.scrollbarSlider,!0),u.attr("transform",function(r){return h(0,r.scrollbarState.topY||0)});var f=u.selectAll("."+a.cn.scrollbarGlyph).data(l.repeat,l.keyFun);f.enter().append("line").classed(a.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",a.scrollbarWidth).attr("stroke-linecap","round").attr("y1",a.scrollbarWidth/2),f.attr("y2",function(r){return r.scrollbarState.barLength-a.scrollbarWidth/2}).attr("stroke-opacity",function(r){return r.columnDragInProgress||!r.scrollbarState.barWiggleRoom||i?0:.4}),f.transition().delay(0).duration(0),f.transition().delay(a.scrollbarHideDelay).duration(a.scrollbarHideDuration).attr("stroke-opacity",0);var p=c.selectAll("."+a.cn.scrollbarCaptureZone).data(l.repeat,l.keyFun);p.enter().append("line").classed(a.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",a.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(i){var a=o.event.y,s=this.getBoundingClientRect(),l=i.scrollbarState,c=a-s.top,u=o.scale.linear().domain([0,l.scrollableAreaHeight]).range([0,l.totalHeight]).clamp(!0);l.topY<=c&&c<=l.bottomY||P(n,r,null,u(c-l.barLength/2))(i)}).call(o.behavior.drag().origin(function(r){return o.event.stopPropagation(),r.scrollbarState.scrollbarScrollInProgress=!0,r}).on("drag",P(n,r)).on("dragend",function(){})),p.attr("y2",function(r){return r.scrollbarState.scrollableAreaHeight}),n._context.staticPlot&&(f.remove(),p.remove())}function w(r,n,i,s){var u,f,h,p,d,v=((f=((u=i.selectAll("."+a.cn.columnCells).data(l.repeat,l.keyFun)).enter().append("g").classed(a.cn.columnCells,!0),u.exit().remove(),u).selectAll("."+a.cn.columnCell).data(m.splitToCells,function(r){return r.keyWithinBlock})).enter().append("g").classed(a.cn.columnCell,!0),f.exit().remove(),f);(function(r){r.each(function(r,n){var i=r.calcdata.cells.font,a=r.column.specIndex,o={size:A(i.size,a,n),color:A(i.color,a,n),family:A(i.family,a,n)};r.rowNumber=r.key,r.align=A(r.calcdata.cells.align,a,n),r.cellBorderWidth=A(r.calcdata.cells.line.width,a,n),r.font=o})})(v),function(r){r.attr("width",function(r){return r.column.columnWidth}).attr("stroke-width",function(r){return r.cellBorderWidth}).each(function(r){var n=o.select(this);g.stroke(n,A(r.calcdata.cells.line.color,r.column.specIndex,r.rowNumber)),g.fill(n,A(r.calcdata.cells.fill.color,r.column.specIndex,r.rowNumber))})}(((h=v.selectAll("."+a.cn.cellRect).data(l.repeat,function(r){return r.keyWithinBlock})).enter().append("rect").classed(a.cn.cellRect,!0),h));var y=((d=((p=v.selectAll("."+a.cn.cellTextHolder).data(l.repeat,function(r){return r.keyWithinBlock})).enter().append("g").classed(a.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),p).selectAll("."+a.cn.cellText).data(l.repeat,function(r){return r.keyWithinBlock})).enter().append("text").classed(a.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){o.event.stopPropagation()}),d);(function(r){r.each(function(r){c.font(o.select(this),r.font)})})(y),T(y,n,s,r),R(v)}function T(r,n,i,l){r.text(function(r){var n=r.column.specIndex,i=r.rowNumber,o=r.value,l="string"==typeof o,c=l&&o.match(/<br>/i),u=!l||c;r.mayHaveMarkup=l&&o.match(/[<&>]/);var f="string"==typeof o&&o.match(a.latexCheck);r.latex=f;var h,p,d=f?"":A(r.calcdata.cells.prefix,n,i)||"",m=f?"":A(r.calcdata.cells.suffix,n,i)||"",g=f?null:A(r.calcdata.cells.format,n,i)||null,v=d+(g?s(g)(r.value):r.value)+m;if(r.wrappingNeeded=!r.wrapped&&!u&&!f&&(h=k(v)),r.cellHeightMayIncrease=c||f||r.mayHaveMarkup||(void 0===h?k(v):h),r.needsConvertToTspans=r.mayHaveMarkup||r.wrappingNeeded||r.latex,r.wrappingNeeded){var y=(" "===a.wrapSplitCharacter?v.replace(/<a href=/gi,"<a_href="):v).split(a.wrapSplitCharacter),x=" "===a.wrapSplitCharacter?y.map(function(r){return r.replace(/<a_href=/gi,"<a href=")}):y;r.fragments=x.map(function(r){return{text:r,width:null}}),r.fragments.push({fragment:a.wrapSpacer,width:null}),p=x.join(a.lineBreaker)+a.lineBreaker+a.wrapSpacer}else delete r.fragments,p=v;return p}).attr("dy",function(r){return r.needsConvertToTspans?0:"0.75em"}).each(function(r){var s=o.select(this),c=r.wrappingNeeded?O:z;r.needsConvertToTspans?u.convertToTspans(s,l,c(i,this,n,l,r)):o.select(this.parentNode).attr("transform",function(r){return h(D(r),a.cellPad)}).attr("text-anchor",function(r){return({left:"start",center:"middle",right:"end"})[r.align]})})}function k(r){return -1!==r.indexOf(a.wrapSplitCharacter)}function A(r,n,i){if(Array.isArray(r)){var a=r[Math.min(n,r.length-1)];return Array.isArray(a)?a[Math.min(i,a.length-1)]:a}return r}function M(r,n,i){r.transition().ease(a.releaseTransitionEase).duration(a.releaseTransitionDuration).attr("transform",h(n.x,i))}function S(r){return"cells"===r.type}function E(r){return"header"===r.type}function L(r){return(r.rowBlocks.length?r.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(r,n){return r+B(n,1/0)},0)}function C(r,n,i){var a=b(n)[0];if(void 0!==a){var o=a.rowBlocks,s=a.calcdata,l=F(o,o.length),c=a.calcdata.groupHeight-L(a),u=s.scrollY=Math.max(0,Math.min(l-c,s.scrollY)),f=function(r,n,i){for(var a=[],o=0,s=0;s<r.length;s++){for(var l=r[s],c=l.rows,u=0,f=0;f<c.length;f++)u+=c[f].rowHeight;l.allRowsHeight=u,n<o+u&&n+i>o&&a.push(s),o+=u}return a}(o,u,c);1===f.length&&(f[0]===o.length-1?f.unshift(f[0]-1):f.push(f[0]+1)),f[0]%2&&f.reverse(),n.each(function(r,n){r.page=f[n],r.scrollY=u}),n.attr("transform",function(r){return h(0,F(r.rowBlocks,r.page)-r.scrollY)}),r&&(I(r,i,n,f,a.prevPages,a,0),I(r,i,n,f,a.prevPages,a,1),_(i,r))}}function P(r,n,i,s){return function(l){var c=l.calcdata?l.calcdata:l,u=n.filter(function(r){return c.key===r.key}),f=i||c.scrollbarState.dragMultiplier,h=c.scrollY;return c.scrollY=void 0===s?c.scrollY+f*o.event.dy:s,C(r,u.selectAll("."+a.cn.yColumn).selectAll("."+a.cn.columnBlock).filter(S),u),c.scrollY===h}}function I(r,n,i,a,o,s,l){a[l]!==o[l]&&(clearTimeout(s.currentRepaint[l]),s.currentRepaint[l]=setTimeout(function(){w(r,n,i.filter(function(r,n){return n===l&&a[n]!==o[n]}),i),o[l]=a[l]}))}function O(r,n,i,s){return function(){var l=o.select(n.parentNode);l.each(function(r){var n=r.fragments;l.selectAll("tspan.line").each(function(r,i){n[i].width=this.getComputedTextLength()});var i,o,s=n[n.length-1].width,c=n.slice(0,-1),u=[],f=0,h=r.column.columnWidth-2*a.cellPad;for(r.value="";c.length;)f+(o=(i=c.shift()).width+s)>h&&(r.value+=u.join(a.wrapSpacer)+a.lineBreaker,u=[],f=0),u.push(i.text),f+=o;f&&(r.value+=u.join(a.wrapSpacer)),r.wrapped=!0}),l.selectAll("tspan.line").remove(),T(l.select("."+a.cn.cellText),i,r,s),o.select(n.parentNode.parentNode).call(R)}}function z(r,n,i,s,l){return function(){if(!l.settledY){var c=o.select(n.parentNode),u=N(l),f=l.key-u.firstRowIndex,p=u.rows[f].rowHeight,d=Math.max(l.cellHeightMayIncrease?n.parentNode.getBoundingClientRect().height+2*a.cellPad:p,p);d-u.rows[f].rowHeight&&(u.rows[f].rowHeight=d,r.selectAll("."+a.cn.columnCell).call(R),C(null,r.filter(S),0),_(i,s,!0)),c.attr("transform",function(){var r=this.parentNode.getBoundingClientRect(),n=o.select(this.parentNode).select("."+a.cn.cellRect).node().getBoundingClientRect(),i=this.transform.baseVal.consolidate(),s=n.top-r.top+(i?i.matrix.f:a.cellPad);return h(D(l,o.select(this.parentNode).select("."+a.cn.cellTextHolder).node().getBoundingClientRect().width),s)}),l.settledY=!0}}}function D(r,n){switch(r.align){case"left":default:return a.cellPad;case"right":return r.column.columnWidth-(n||0)-a.cellPad;case"center":return(r.column.columnWidth-(n||0))/2}}function R(r){r.attr("transform",function(r){var n=r.rowBlocks[0].auxiliaryBlocks.reduce(function(r,n){return r+B(n,1/0)},0);return h(0,B(N(r),r.key)+n)}).selectAll("."+a.cn.cellRect).attr("height",function(r){var n,i;return(n=N(r),i=r.key,n.rows[i-n.firstRowIndex]).rowHeight})}function F(r,n){for(var i=0,a=n-1;a>=0;a--)i+=function(r){var n=r.allRowsHeight;if(void 0!==n)return n;for(var i=0,a=0;a<r.rows.length;a++)i+=r.rows[a].rowHeight;return r.allRowsHeight=i,i}(r[a]);return i}function B(r,n){for(var i=0,a=0;a<r.rows.length&&r.rows[a].rowIndex<n;a++)i+=r.rows[a].rowHeight;return i}function N(r){return r.rowBlocks[r.page]}n.exports=function(r,n){var i=!r._context.staticPlot,s=r._fullLayout._paper.selectAll("."+a.cn.table).data(n.map(function(n){return d(r,l.unwrap(n).trace)}),l.keyFun);s.exit().remove(),s.enter().append("g").classed(a.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),s.attr("width",function(r){return r.width+r.size.l+r.size.r}).attr("height",function(r){return r.height+r.size.t+r.size.b}).attr("transform",function(r){return h(r.translateX,r.translateY)});var u=s.selectAll("."+a.cn.tableControlView).data(l.repeat,l.keyFun),g=u.enter().append("g").classed(a.cn.tableControlView,!0).style("box-sizing","content-box");i&&g.on("mousemove",function(n){u.filter(function(r){return n===r}).call(_,r)}).on("onwheel"in document?"wheel":"mousewheel",function(n){n.scrollbarState.wheeling||(n.scrollbarState.wheeling=!0,P(r,u,null,n.scrollY+o.event.deltaY)(n)||(o.event.stopPropagation(),o.event.preventDefault()),n.scrollbarState.wheeling=!1)}).call(_,r,!0),u.attr("transform",function(r){return h(r.size.l,r.size.t)});var T=u.selectAll("."+a.cn.scrollBackground).data(l.repeat,l.keyFun);T.enter().append("rect").classed(a.cn.scrollBackground,!0).attr("fill","none"),T.attr("width",function(r){return r.width}).attr("height",function(r){return r.height}),u.each(function(n){c.setClipUrl(o.select(this),y(r,n),r)});var k=u.selectAll("."+a.cn.yColumn).data(function(r){return r.columns},l.keyFun);k.enter().append("g").classed(a.cn.yColumn,!0),k.exit().remove(),k.attr("transform",function(r){return h(r.x,0)}),i&&k.call(o.behavior.drag().origin(function(n){return M(o.select(this),n,-a.uplift),f(this),n.calcdata.columnDragInProgress=!0,_(u.filter(function(r){return n.calcdata.key===r.key}),r),n}).on("drag",function(r){var n=o.select(this),i=function(n){return(r===n?o.event.x:n.x)+n.columnWidth/2};r.x=Math.max(-a.overdrag,Math.min(r.calcdata.width+a.overdrag-r.columnWidth,o.event.x)),b(k).filter(function(n){return n.calcdata.key===r.calcdata.key}).sort(function(r,n){return i(r)-i(n)}).forEach(function(n,i){n.xIndex=i,n.x=r===n?n.x:n.xScale(n)}),k.filter(function(n){return r!==n}).transition().ease(a.transitionEase).duration(a.transitionDuration).attr("transform",function(r){return h(r.x,0)}),n.call(p).attr("transform",h(r.x,-a.uplift))}).on("dragend",function(n){var i,a,s=o.select(this),l=n.calcdata;n.x=n.xScale(n),n.calcdata.columnDragInProgress=!1,M(s,n,0),i=l.columns.map(function(r){return r.xIndex}),a=l.gdColumnsOriginalOrder,l.gdColumns.sort(function(r,n){return i[a.indexOf(r)]-i[a.indexOf(n)]}),l.columnorder=i,r.emit("plotly_restyle")})),k.each(function(n){c.setClipUrl(o.select(this),x(r,n),r)});var A=k.selectAll("."+a.cn.columnBlock).data(m.splitToPanels,l.keyFun);A.enter().append("g").classed(a.cn.columnBlock,!0).attr("id",function(r){return r.key}),A.style("cursor",function(r){return r.dragHandle?"ew-resize":r.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var L=A.filter(E),I=A.filter(S);i&&I.call(o.behavior.drag().origin(function(r){return o.event.stopPropagation(),r}).on("drag",P(r,u,-1)).on("dragend",function(){})),w(r,u,L,A),w(r,u,I,A);var O=u.selectAll("."+a.cn.scrollAreaClip).data(l.repeat,l.keyFun);O.enter().append("clipPath").classed(a.cn.scrollAreaClip,!0).attr("id",function(n){return y(r,n)});var z=O.selectAll("."+a.cn.scrollAreaClipRect).data(l.repeat,l.keyFun);z.enter().append("rect").classed(a.cn.scrollAreaClipRect,!0).attr("x",-a.overdrag).attr("y",-a.uplift).attr("fill","none"),z.attr("width",function(r){return r.width+2*a.overdrag}).attr("height",function(r){return r.height+a.uplift}),k.selectAll("."+a.cn.columnBoundary).data(l.repeat,l.keyFun).enter().append("g").classed(a.cn.columnBoundary,!0);var D=k.selectAll("."+a.cn.columnBoundaryClippath).data(l.repeat,l.keyFun);D.enter().append("clipPath").classed(a.cn.columnBoundaryClippath,!0),D.attr("id",function(n){return x(r,n)});var R=D.selectAll("."+a.cn.columnBoundaryRect).data(l.repeat,l.keyFun);R.enter().append("rect").classed(a.cn.columnBoundaryRect,!0).attr("fill","none"),R.attr("width",function(r){return r.columnWidth+2*v(r)}).attr("height",function(r){return r.calcdata.height+2*v(r)+a.uplift}).attr("x",function(r){return-v(r)}).attr("y",function(r){return-v(r)}),C(null,I,u)}},{"../../components/color":366,"../../components/drawing":388,"../../lib":503,"../../lib/gup":500,"../../lib/svg_text_utils":529,"./constants":1065,"./data_preparation_helper":1066,"./data_split_helpers":1067,"@plotly/d3":58}],1071:[function(r,n,i){"use strict";var a=r("../../plots/template_attributes").hovertemplateAttrs,o=r("../../plots/template_attributes").texttemplateAttrs,s=r("../../components/colorscale/attributes"),l=r("../../plots/domain").attributes,c=r("../pie/attributes"),u=r("../sunburst/attributes"),f=r("./constants"),h=r("../../lib/extend").extendFlat;n.exports={labels:u.labels,parents:u.parents,values:u.values,branchvalues:u.branchvalues,count:u.count,level:u.level,maxdepth:u.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:h({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:u.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:u.marker.line,editType:"calc"},s("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:h({},c.textfont,{}),editType:"calc"},text:c.text,textinfo:u.textinfo,texttemplate:o({editType:"plot"},{keys:f.eventDataKeys.concat(["label","value"])}),hovertext:c.hovertext,hoverinfo:u.hoverinfo,hovertemplate:a({},{keys:f.eventDataKeys}),textfont:c.textfont,insidetextfont:c.insidetextfont,outsidetextfont:h({},c.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:c.sort,root:u.root,domain:l({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":900,"../sunburst/attributes":1045,"./constants":1074}],1072:[function(r,n,i){"use strict";var a=r("../../plots/plots");i.name="treemap",i.plot=function(r,n,o,s){a.plotBasePlot(i.name,r,n,o,s)},i.clean=function(r,n,o,s){a.cleanBasePlot(i.name,r,n,o,s)}},{"../../plots/plots":619}],1073:[function(r,n,i){"use strict";var a=r("../sunburst/calc");i.calc=function(r,n){return a.calc(r,n)},i.crossTraceCalc=function(r){return a._runCrossTraceCalc("treemap",r)}},{"../sunburst/calc":1047}],1074:[function(r,n,i){"use strict";n.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1075:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("../../components/color"),l=r("../../plots/domain").defaults,c=r("../bar/defaults").handleText,u=r("../bar/constants").TEXTPAD,f=r("../../components/colorscale"),h=f.hasColorscale,p=f.handleDefaults;n.exports=function(r,n,i,f){function d(i,s){return a.coerce(r,n,o,i,s)}var m=d("labels"),g=d("parents");if(m&&m.length&&g&&g.length){var v=d("values");d(v&&v.length?"branchvalues":"count"),d("level"),d("maxdepth"),"squarify"===d("tiling.packing")&&d("tiling.squarifyratio"),d("tiling.flip"),d("tiling.pad");var y=d("text");d("texttemplate"),n.texttemplate||d("textinfo",Array.isArray(y)?"text+label":"label"),d("hovertext"),d("hovertemplate");var x=d("pathbar.visible");c(r,n,f,d,"auto",{hasPathbar:x,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),d("textposition");var b=-1!==n.textposition.indexOf("bottom");d("marker.line.width")&&d("marker.line.color",f.paper_bgcolor);var _=d("marker.colors");(n._hasColorscale=h(r,"marker","colors")||(r.marker||{}).coloraxis)?p(r,n,f,d,{prefix:"marker.",cLetter:"c"}):d("marker.depthfade",!(_||[]).length);var w=2*n.textfont.size;d("marker.pad.t",b?w/4:w),d("marker.pad.l",w/4),d("marker.pad.r",w/4),d("marker.pad.b",b?w:w/4),n._hovered={marker:{line:{width:2,color:s.contrast(f.paper_bgcolor)}}},x&&(d("pathbar.thickness",n.pathbar.textfont.size+2*u),d("pathbar.side"),d("pathbar.edgeshape")),d("sort"),d("root.color"),l(n,f,d),n._length=null}else n.visible=!1}},{"../../components/color":366,"../../components/colorscale":378,"../../lib":503,"../../plots/domain":584,"../bar/constants":650,"../bar/defaults":652,"./attributes":1071}],1076:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../sunburst/helpers"),s=r("../bar/uniform_text").clearMinTextSize,l=r("../bar/style").resizeText,c=r("./plot_one");n.exports=function(r,n,i,u,f){var h,p,d=f.type,m=f.drawDescendants,g=r._fullLayout,v=g["_"+d+"layer"],y=!i;(s(d,g),(h=v.selectAll("g.trace."+d).data(n,function(r){return r[0].trace.uid})).enter().append("g").classed("trace",!0).classed(d,!0),h.order(),!g.uniformtext.mode&&o.hasTransition(i))?(u&&(p=u()),a.transition().duration(i.duration).ease(i.easing).each("end",function(){p&&p()}).each("interrupt",function(){p&&p()}).each(function(){v.selectAll("g.trace").each(function(n){c(r,n,this,i,m)})})):(h.each(function(n){c(r,n,this,i,m)}),g.uniformtext.mode&&l(r,v.selectAll(".trace"),d)),y&&h.exit().remove()}},{"../bar/style":662,"../bar/uniform_text":664,"../sunburst/helpers":1051,"./plot_one":1085,"@plotly/d3":58}],1077:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../components/drawing"),l=r("../../lib/svg_text_utils"),c=r("./partition"),u=r("./style").styleOne,f=r("./constants"),h=r("../sunburst/helpers"),p=r("../sunburst/fx");n.exports=function(r,n,i,d,m){var g=m.barDifY,v=m.width,y=m.height,x=m.viewX,b=m.viewY,_=m.pathSlice,w=m.toMoveInsideSlice,T=m.strTransform,k=m.hasTransition,A=m.handleSlicesExit,M=m.makeUpdateSliceInterpolator,S=m.makeUpdateTextInterpolator,E={},L=r._fullLayout,C=n[0],P=C.trace,I=C.hierarchy,O=v/P._entryDepth,z=h.listPath(i.data,"id"),D=c(I.copy(),[v,y],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(D=D.filter(function(r){var n=z.indexOf(r.data.id);return -1!==n&&(r.x0=O*n,r.x1=O*(n+1),r.y0=g,r.y1=g+y,r.onPathbar=!0,!0)})).reverse(),(d=d.data(D,h.getPtId)).enter().append("g").classed("pathbar",!0),A(d,!0,E,[v,y],_),d.order();var R=d;k&&(R=R.transition().each("end",function(){var n=a.select(this);h.setSliceCursor(n,r,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),R.each(function(c){c._x0=x(c.x0),c._x1=x(c.x1),c._y0=b(c.y0),c._y1=b(c.y1),c._hoverX=x(c.x1-Math.min(v,y)/2),c._hoverY=b(c.y1-y/2);var d=a.select(this),m=o.ensureSingle(d,"path","surface",function(r){r.style("pointer-events","all")});k?m.transition().attrTween("d",function(r){var n=M(r,!0,E,[v,y]);return function(r){return _(n(r))}}):m.attr("d",_),d.call(p,i,r,n,{styleOne:u,eventDataKeys:f.eventDataKeys,transitionTime:f.CLICK_TRANSITION_TIME,transitionEasing:f.CLICK_TRANSITION_EASING}).call(h.setSliceCursor,r,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:r._transitioning}),m.call(u,c,P,{hovered:!1}),c._text=(h.getPtLabel(c)||"").split("<br>").join(" ")||"";var g=o.ensureSingle(d,"g","slicetext"),A=o.ensureSingle(g,"text","",function(r){r.attr("data-notex",1)}),C=o.ensureUniformFontSize(r,h.determineTextFont(P,c,L.font,{onPathbar:!0}));A.text(c._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(s.font,C).call(l.convertToTspans,r),c.textBB=s.bBox(A.node()),c.transform=w(c,{fontSize:C.size,onPathbar:!0}),c.transform.fontSize=C.size,k?A.transition().attrTween("transform",function(r){var n=S(r,!0,E,[v,y]);return function(r){return T(n(r))}}):A.attr("transform",T(c))})}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../sunburst/fx":1050,"../sunburst/helpers":1051,"./constants":1074,"./partition":1083,"./style":1086,"@plotly/d3":58}],1078:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../components/drawing"),l=r("../../lib/svg_text_utils"),c=r("./partition"),u=r("./style").styleOne,f=r("./constants"),h=r("../sunburst/helpers"),p=r("../sunburst/fx"),d=r("../sunburst/plot").formatSliceLabel;n.exports=function(r,n,i,m,g){var v=g.width,y=g.height,x=g.viewX,b=g.viewY,_=g.pathSlice,w=g.toMoveInsideSlice,T=g.strTransform,k=g.hasTransition,A=g.handleSlicesExit,M=g.makeUpdateSliceInterpolator,S=g.makeUpdateTextInterpolator,E=g.prevEntry,L=r._fullLayout,C=n[0].trace,P=-1!==C.textposition.indexOf("left"),I=-1!==C.textposition.indexOf("right"),O=-1!==C.textposition.indexOf("bottom"),z=!O&&!C.marker.pad.t||O&&!C.marker.pad.b,D=c(i,[v,y],{packing:C.tiling.packing,squarifyratio:C.tiling.squarifyratio,flipX:C.tiling.flip.indexOf("x")>-1,flipY:C.tiling.flip.indexOf("y")>-1,pad:{inner:C.tiling.pad,top:C.marker.pad.t,left:C.marker.pad.l,right:C.marker.pad.r,bottom:C.marker.pad.b}}).descendants(),R=1/0,F=-1/0;D.forEach(function(r){var n=r.depth;n>=C._maxDepth?(r.x0=r.x1=(r.x0+r.x1)/2,r.y0=r.y1=(r.y0+r.y1)/2):(R=Math.min(R,n),F=Math.max(F,n))}),m=m.data(D,h.getPtId),C._maxVisibleLayers=isFinite(F)?F-R+1:0,m.enter().append("g").classed("slice",!0),A(m,!1,{},[v,y],_),m.order();var B=null;if(k&&E){var N=h.getPtId(E);m.each(function(r){null===B&&h.getPtId(r)===N&&(B={x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1})})}var j=function(){return B||{x0:0,x1:v,y0:0,y1:y}},U=m;return k&&(U=U.transition().each("end",function(){var n=a.select(this);h.setSliceCursor(n,r,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),U.each(function(c){var m=h.isHeader(c,C);c._x0=x(c.x0),c._x1=x(c.x1),c._y0=b(c.y0),c._y1=b(c.y1),c._hoverX=x(c.x1-C.marker.pad.r),c._hoverY=b(O?c.y1-C.marker.pad.b/2:c.y0+C.marker.pad.t/2);var g=a.select(this),A=o.ensureSingle(g,"path","surface",function(r){r.style("pointer-events","all")});k?A.transition().attrTween("d",function(r){var n=M(r,!1,j(),[v,y]);return function(r){return _(n(r))}}):A.attr("d",_),g.call(p,i,r,n,{styleOne:u,eventDataKeys:f.eventDataKeys,transitionTime:f.CLICK_TRANSITION_TIME,transitionEasing:f.CLICK_TRANSITION_EASING}).call(h.setSliceCursor,r,{isTransitioning:r._transitioning}),A.call(u,c,C,{hovered:!1}),c.x0===c.x1||c.y0===c.y1?c._text="":c._text=m?z?"":h.getPtLabel(c)||"":d(c,i,C,n,L)||"";var E=o.ensureSingle(g,"g","slicetext"),D=o.ensureSingle(E,"text","",function(r){r.attr("data-notex",1)}),R=o.ensureUniformFontSize(r,h.determineTextFont(C,c,L.font));D.text(c._text||" ").classed("slicetext",!0).attr("text-anchor",I?"end":P||m?"start":"middle").call(s.font,R).call(l.convertToTspans,r),c.textBB=s.bBox(D.node()),c.transform=w(c,{fontSize:R.size,isHeader:m}),c.transform.fontSize=R.size,k?D.transition().attrTween("transform",function(r){var n=S(r,!1,j(),[v,y]);return function(r){return T(n(r))}}):D.attr("transform",T(c))}),B}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../sunburst/fx":1050,"../sunburst/helpers":1051,"../sunburst/plot":1055,"./constants":1074,"./partition":1083,"./style":1086,"@plotly/d3":58}],1079:[function(r,n,i){"use strict";n.exports=function r(n,i,a){a.swapXY&&(o=n.x0,n.x0=n.y0,n.y0=o,o=n.x1,n.x1=n.y1,n.y1=o),a.flipX&&(o=n.x0,n.x0=i[0]-n.x1,n.x1=i[0]-o),a.flipY&&(o=n.y0,n.y0=i[1]-n.y1,n.y1=i[1]-o);var o,s=n.children;if(s)for(var l=0;l<s.length;l++)r(s[l],i,a)}},{}],1080:[function(r,n,i){"use strict";n.exports={moduleType:"trace",name:"treemap",basePlotModule:r("./base_plot"),categories:[],animatable:!0,attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc").calc,crossTraceCalc:r("./calc").crossTraceCalc,plot:r("./plot"),style:r("./style").style,colorbar:r("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":944,"./attributes":1071,"./base_plot":1072,"./calc":1073,"./defaults":1075,"./layout_attributes":1081,"./layout_defaults":1082,"./plot":1084,"./style":1086}],1081:[function(r,n,i){"use strict";n.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1082:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n){function i(i,s){return a.coerce(r,n,o,i,s)}i("treemapcolorway",n.colorway),i("extendtreemapcolors")}},{"../../lib":503,"./layout_attributes":1081}],1083:[function(r,n,i){"use strict";var a=r("d3-hierarchy"),o=r("./flip_tree");n.exports=function(r,n,i){var s,l=i.flipX,c=i.flipY,u="dice-slice"===i.packing,f=i.pad[c?"bottom":"top"],h=i.pad[l?"right":"left"],p=i.pad[l?"left":"right"],d=i.pad[c?"top":"bottom"];u&&(s=h,h=f,f=s,s=p,p=d,d=s);var m=a.treemap().tile(function(r,n){switch(r){case"squarify":return a.treemapSquarify.ratio(n);case"binary":return a.treemapBinary;case"dice":return a.treemapDice;case"slice":return a.treemapSlice;default:return a.treemapSliceDice}}(i.packing,i.squarifyratio)).paddingInner(i.pad.inner).paddingLeft(h).paddingRight(p).paddingTop(f).paddingBottom(d).size(u?[n[1],n[0]]:n)(r);return(u||l||c)&&o(m,n,{swapXY:u,flipX:l,flipY:c}),m}},{"./flip_tree":1079,"d3-hierarchy":115}],1084:[function(r,n,i){"use strict";var a=r("./draw"),o=r("./draw_descendants");n.exports=function(r,n,i,s){return a(r,n,i,s,{type:"treemap",drawDescendants:o})}},{"./draw":1076,"./draw_descendants":1078}],1085:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("d3-interpolate").interpolate,s=r("../sunburst/helpers"),l=r("../../lib"),c=r("../bar/constants").TEXTPAD,u=r("../bar/plot").toMoveInsideBar,f=r("../bar/uniform_text").recordMinTextSize,h=r("./constants"),p=r("./draw_ancestors");function d(r){return s.isHierarchyRoot(r)?"":s.getPtId(r)}n.exports=function(r,n,i,m,g){var v=r._fullLayout,y=n[0],x=y.trace,b="icicle"===x.type,_=y.hierarchy,w=s.findEntryWithLevel(_,x.level),T=a.select(i),k=T.selectAll("g.pathbar"),A=T.selectAll("g.slice");if(!w)return k.remove(),void A.remove();var M=s.isHierarchyRoot(w),S=!v.uniformtext.mode&&s.hasTransition(m),E=s.getMaxDepth(x),L=v._size,C=x.domain,P=L.w*(C.x[1]-C.x[0]),I=L.h*(C.y[1]-C.y[0]),O=x.pathbar.thickness,z=x.marker.line.width+h.gapWithPathbar,D=x.pathbar.visible?x.pathbar.side.indexOf("bottom")>-1?I+z:-(O+z):0,R={x0:P,x1:P,y0:D,y1:D+O},F=function(r,n,i){var a=x.tiling.pad,o=function(r){return r-a<=n.x0},s=function(r){return r+a>=n.x1},l=function(r){return r-a<=n.y0},c=function(r){return r+a>=n.y1};return r.x0===n.x0&&r.x1===n.x1&&r.y0===n.y0&&r.y1===n.y1?{x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1}:{x0:o(r.x0-a)?0:s(r.x0-a)?i[0]:r.x0,x1:o(r.x1+a)?0:s(r.x1+a)?i[0]:r.x1,y0:l(r.y0-a)?0:c(r.y0-a)?i[1]:r.y0,y1:l(r.y1+a)?0:c(r.y1+a)?i[1]:r.y1}},B=null,N={},j={},U=null,V=function(r,n){return n?N[d(r)]:j[d(r)]},H=function(r,n,i,a){if(n)return N[d(_)]||R;var o=j[x.level]||i;return r.data.depth-w.data.depth<E?F(r,o,a):{}};y.hasMultipleRoots&&M&&E++,x._maxDepth=E,x._backgroundColor=v.paper_bgcolor,x._entryDepth=w.data.depth,x._atRootLevel=M;var q=-P/2+L.l+L.w*(C.x[1]+C.x[0])/2,G=-I/2+L.t+L.h*(1-(C.y[1]+C.y[0])/2),Y=function(r){return q+r},W=function(r){return G+r},X=W(0),Z=Y(0),J=function(r){return Z+r},K=function(r){return X+r},Q=J(0),$=function(r){r.x=Math.max(Q,r.x)},tt=x.pathbar.edgeshape,te=function(r,n){var i=r.x0,a=r.x1,o=r.y0,s=r.y1,l=r.textBB,h=function(r){return -1!==x.textposition.indexOf(r)},p=h("bottom"),d=h("top")||n.isHeader&&!p?"start":p?"end":"middle",m=h("right"),g=h("left")||n.onPathbar?-1:m?1:0,y=x[b?"tiling":"marker"].pad;if(n.isHeader){if((i+=(b?y:y.l)-c)>=(a-=(b?y:y.r)-c)){var _,w=(i+a)/2;i=w,a=w}p?o<(_=s-(b?y:y.b))&&_<s&&(o=_):o<(_=o+(b?y:y.t))&&_<s&&(s=_)}var T=u(i,a,o,s,l,{isHorizontal:!1,constrained:!0,angle:0,anchor:d,leftToRight:g});return T.fontSize=n.fontSize,T.targetX=Y(T.targetX),T.targetY=W(T.targetY),isNaN(T.targetX)||isNaN(T.targetY)?{}:(i!==a&&o!==s&&f(x.type,T,v),{scale:T.scale,rotate:T.rotate,textX:T.textX,textY:T.textY,anchorX:T.anchorX,anchorY:T.anchorY,targetX:T.targetX,targetY:T.targetY})},tr=function(r,n){for(var i,a=0,o=r;!i&&a<E;)a++,(o=o.parent)?i=V(o,n):a=E;return i||{}},tn=function(r,n,i,a,s){var c,u=V(r,n);if(u)c=u;else if(n)c=R;else if(B){if(r.parent){var f=U||i;f&&!n?c=F(r,f,a):(c={},l.extendFlat(c,tr(r,n)))}else c=l.extendFlat({},r),b&&("h"===s.orientation?s.flipX?c.x0=r.x1:c.x1=0:s.flipY?c.y0=r.y1:c.y1=0)}else c={};return o(c,{x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1})},ti=function(r,n,i,a){var c=V(r,n),u={},h=H(r,n,i,a);l.extendFlat(u,{transform:te({x0:h.x0,x1:h.x1,y0:h.y0,y1:h.y1,textBB:r.textBB,_text:r._text},{isHeader:s.isHeader(r,x)})}),c?u=c:r.parent&&l.extendFlat(u,tr(r,n));var p=r.transform;return r.x0!==r.x1&&r.y0!==r.y1&&f(x.type,p,v),o(u,{transform:{scale:p.scale,rotate:p.rotate,textX:p.textX,textY:p.textY,anchorX:p.anchorX,anchorY:p.anchorY,targetX:p.targetX,targetY:p.targetY}})},ta=function(r,n,i,s,l){var c=s[0],u=s[1];S?r.exit().transition().each(function(){var r=a.select(this);r.select("path.surface").transition().attrTween("d",function(r){var i=function(r,n,i,a){var s,l=V(r,n);if(n)s=R;else{var c=V(w,n);s=c?F(r,c,a):{}}return o(l,s)}(r,n,0,[c,u]);return function(r){return l(i(r))}}),r.select("g.slicetext").attr("opacity",0)}).remove():r.exit().remove()},to=function(r){var n=r.transform;return r.x0!==r.x1&&r.y0!==r.y1&&f(x.type,n,v),l.getTextTransform({textX:n.textX,textY:n.textY,anchorX:n.anchorX,anchorY:n.anchorY,targetX:n.targetX,targetY:n.targetY,scale:n.scale,rotate:n.rotate})};S&&(k.each(function(r){N[d(r)]={x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1},r.transform&&(N[d(r)].transform={textX:r.transform.textX,textY:r.transform.textY,anchorX:r.transform.anchorX,anchorY:r.transform.anchorY,targetX:r.transform.targetX,targetY:r.transform.targetY,scale:r.transform.scale,rotate:r.transform.rotate})}),A.each(function(r){j[d(r)]={x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1},r.transform&&(j[d(r)].transform={textX:r.transform.textX,textY:r.transform.textY,anchorX:r.transform.anchorX,anchorY:r.transform.anchorY,targetX:r.transform.targetX,targetY:r.transform.targetY,scale:r.transform.scale,rotate:r.transform.rotate}),!B&&s.isEntry(r)&&(B=r)})),U=g(r,n,w,A,{width:P,height:I,viewX:Y,viewY:W,pathSlice:function(r){var n=Y(r.x0),i=Y(r.x1),a=W(r.y0),o=W(r.y1);return i-n&&o-a?"M"+n+","+(a+0)+"L"+(i-0)+","+a+"L"+i+","+(o-0)+"L"+(n+0)+","+o+"Z":""},toMoveInsideSlice:te,prevEntry:B,makeUpdateSliceInterpolator:tn,makeUpdateTextInterpolator:ti,handleSlicesExit:ta,hasTransition:S,strTransform:to}),x.pathbar.visible?p(r,n,w,k,{barDifY:D,width:P,height:O,viewX:J,viewY:K,pathSlice:function(r){var n=J(Math.max(Math.min(r.x0,r.x0),0)),i=J(Math.min(Math.max(r.x1,r.x1),P)),a=K(r.y0),o=K(r.y1),s=O/2,l={},c={};l.x=n,c.x=i,l.y=c.y=(a+o)/2;var u={x:n,y:a},f={x:i,y:a},h={x:i,y:o},p={x:n,y:o};return">"===tt?(u.x-=s,f.x-=s,h.x-=s,p.x-=s):"/"===tt?(h.x-=s,p.x-=s,l.x-=s/2,c.x-=s/2):"\\"===tt?(u.x-=s,f.x-=s,l.x-=s/2,c.x-=s/2):"<"===tt&&(l.x-=s,c.x-=s),$(u),$(p),$(l),$(f),$(h),$(c),"M"+u.x+","+u.y+"L"+f.x+","+f.y+"L"+c.x+","+c.y+"L"+h.x+","+h.y+"L"+p.x+","+p.y+"L"+l.x+","+l.y+"Z"},toMoveInsideSlice:te,makeUpdateSliceInterpolator:tn,makeUpdateTextInterpolator:ti,handleSlicesExit:ta,hasTransition:S,strTransform:to}):k.remove()}},{"../../lib":503,"../bar/constants":650,"../bar/plot":659,"../bar/uniform_text":664,"../sunburst/helpers":1051,"./constants":1074,"./draw_ancestors":1077,"@plotly/d3":58,"d3-interpolate":116}],1086:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/color"),s=r("../../lib"),l=r("../sunburst/helpers"),c=r("../bar/uniform_text").resizeText;function u(r,n,i,a){var c,u,f=(a||{}).hovered,h=n.data.data,p=h.i,d=h.color,m=l.isHierarchyRoot(n),g=1;if(f)c=i._hovered.marker.line.color,u=i._hovered.marker.line.width;else if(m&&d===i.root.color)g=100,c="rgba(0,0,0,0)",u=0;else if(c=s.castOption(i,p,"marker.line.color")||o.defaultLine,u=s.castOption(i,p,"marker.line.width")||0,!i._hasColorscale&&!n.onPathbar){var v=i.marker.depthfade;if(v){var y,x=o.combine(o.addOpacity(i._backgroundColor,.75),d);if(!0===v?y=isFinite(l.getMaxDepth(i))?l.isLeaf(n)?0:i._maxVisibleLayers-(n.data.depth-i._entryDepth):n.data.height+1:(y=n.data.depth-i._entryDepth,i._atRootLevel||y++),y>0)for(var b=0;b<y;b++){var _=.5*b/y;d=o.combine(o.addOpacity(x,_),d)}}}r.style("stroke-width",u).call(o.fill,d).call(o.stroke,c).style("opacity",g)}n.exports={style:function(r){var n=r._fullLayout._treemaplayer.selectAll(".trace");c(r,n,"treemap"),n.each(function(r){var n=a.select(this),i=r[0].trace;n.style("opacity",i.opacity),n.selectAll("path.surface").each(function(r){a.select(this).call(u,r,i,{hovered:!1})})})},styleOne:u}},{"../../components/color":366,"../../lib":503,"../bar/uniform_text":664,"../sunburst/helpers":1051,"@plotly/d3":58}],1087:[function(r,n,i){"use strict";var a=r("../box/attributes"),o=r("../../lib/extend").extendFlat,s=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat;n.exports={y:a.y,x:a.x,x0:a.x0,y0:a.y0,xhoverformat:s("x"),yhoverformat:s("y"),name:o({},a.name,{}),orientation:o({},a.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:a.fillcolor,points:o({},a.boxpoints,{}),jitter:o({},a.jitter,{}),pointpos:o({},a.pointpos,{}),width:o({},a.width,{}),marker:a.marker,text:a.text,hovertext:a.hovertext,hovertemplate:a.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup,selected:a.selected,unselected:a.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../box/attributes":673}],1088:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("../box/calc"),l=r("./helpers"),c=r("../../constants/numerical").BADNUM;n.exports=function(r,n){var i=s(r,n);if(i[0].t.empty)return i;for(var u=r._fullLayout,f=o.getFromId(r,n["h"===n.orientation?"xaxis":"yaxis"]),h=1/0,p=-1/0,d=0,m=0,g=0;g<i.length;g++){var v=i[g],y=v.pts.map(l.extractVal),x=v.bandwidth=function(r,n,i){var o=n.max-n.min;if(!o)return r.bandwidth?r.bandwidth:0;if(r.bandwidth)return Math.max(r.bandwidth,o/1e4);var s=i.length;return Math.max(1.059*Math.min(a.stdev(i,s-1,n.mean),(n.q3-n.q1)/1.349)*Math.pow(s,-.2),o/100)}(n,v,y),b=v.span=function(r,n,i,a){var s,l=r.spanmode,u=r.span||[],f=[n.min,n.max],h=[n.min-2*a,n.max+2*a];function p(a){var o=u[a],s="multicategory"===i.type?i.r2c(o):i.d2c(o,0,r[n.valLetter+"calendar"]);return s===c?h[a]:s}var d={type:"linear",range:s="soft"===l?h:"hard"===l?f:[p(0),p(1)]};return o.setConvert(d),d.cleanRange(),s}(n,v,f,x);if(v.min===v.max&&0===x)b=v.span=[v.min,v.max],v.density=[{v:1,t:b[0]}],v.bandwidth=x,d=Math.max(d,1);else{var _=b[1]-b[0],w=Math.ceil(_/(x/3)),T=_/w;if(!isFinite(T)||!isFinite(w))return a.error("Something went wrong with computing the violin span"),i[0].t.empty=!0,i;var k=l.makeKDE(v,n,y);v.density=Array(w);for(var A=0,M=b[0];M<b[1]+T/2;A++,M+=T){var S=k(M);v.density[A]={v:S,t:M},d=Math.max(d,S)}}m=Math.max(m,y.length),h=Math.min(h,b[0]),p=Math.max(p,b[1])}var E=o.findExtremes(f,[h,p],{padded:!0});if(n._extremes[f._id]=E,n.width)i[0].t.maxKDE=d;else{var L=u._violinScaleGroupStats,C=n.scalegroup,P=L[C];P?(P.maxKDE=Math.max(P.maxKDE,d),P.maxCount=Math.max(P.maxCount,m)):L[C]={maxKDE:d,maxCount:m}}return i[0].t.labels.kde=a._(r,"kde:"),i}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axes":554,"../box/calc":674,"./helpers":1091}],1089:[function(r,n,i){"use strict";var a=r("../box/cross_trace_calc").setPositionOffset,o=["v","h"];n.exports=function(r,n){for(var i=r.calcdata,s=n.xaxis,l=n.yaxis,c=0;c<o.length;c++){for(var u=o[c],f="h"===u?l:s,h=[],p=0;p<i.length;p++){var d=i[p],m=d[0].t,g=d[0].trace;!0!==g.visible||"violin"!==g.type||m.empty||g.orientation!==u||g.xaxis!==s._id||g.yaxis!==l._id||h.push(p)}a("violin",r,h,f)}}},{"../box/cross_trace_calc":675}],1090:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../components/color"),s=r("../box/defaults"),l=r("./attributes");n.exports=function(r,n,i,c){function u(i,o){return a.coerce(r,n,l,i,o)}function f(i,o){return a.coerce2(r,n,l,i,o)}if(s.handleSampleDefaults(r,n,u,c),!1!==n.visible){u("bandwidth"),u("side"),u("width")||(u("scalegroup",n.name),u("scalemode")),Array.isArray(u("span"))&&(h="manual"),u("spanmode",h);var h,p=u("line.color",(r.marker||{}).color||i),d=u("line.width"),m=u("fillcolor",o.addOpacity(n.line.color,.5));s.handlePointsDefaults(r,n,u,{prefix:""});var g=f("box.width"),v=f("box.fillcolor",m),y=f("box.line.color",p),x=f("box.line.width",d);u("box.visible",!!(g||v||y||x))||(n.box={visible:!1});var b=f("meanline.color",p),_=f("meanline.width",d);u("meanline.visible",!!(b||_))||(n.meanline={visible:!1})}}},{"../../components/color":366,"../../lib":503,"../box/defaults":676,"./attributes":1087}],1091:[function(r,n,i){"use strict";var a=r("../../lib");i.makeKDE=function(r,n,i){var a=i.length,o=r.bandwidth,s=1/(a*o);return function(r){for(var n,l=0,c=0;c<a;c++)l+=1/Math.sqrt(2*Math.PI)*Math.exp(-.5*(n=(r-i[c])/o)*n);return s*l}},i.getPositionOnKdePath=function(r,n,i){"h"===n.orientation?(o="y",s="x"):(o="x",s="y");var o,s,l=a.findPointOnPath(r.path,i,s,{pathLength:r.pathLength}),c=r.posCenterPx,u=l[o];return[u,"both"===n.side?2*c-u:c]},i.getKdeValue=function(r,n,a){var o=r.pts.map(i.extractVal);return i.makeKDE(r,n,o)(a)/r.posDensityScale},i.extractVal=function(r){return r.v}},{"../../lib":503}],1092:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../../plots/cartesian/axes"),s=r("../box/hover"),l=r("./helpers");n.exports=function(r,n,i,c,u){u||(u={});var f,h,p=u.hoverLayer,d=r.cd,m=d[0].trace,g=m.hoveron,v=-1!==g.indexOf("violins"),y=-1!==g.indexOf("kde"),x=[];if(v||y){var b=s.hoverOnBoxes(r,n,i,c);if(y&&b.length>0){var _,w,T,k,A,M=r.xa,S=r.ya;"h"===m.orientation?(A=n,_="y",T=S,w="x",k=M):(A=i,_="x",T=M,w="y",k=S);var E=d[r.index];if(A>=E.span[0]&&A<=E.span[1]){var L=a.extendFlat({},r),C=k.c2p(A,!0),P=l.getKdeValue(E,m,A),I=l.getPositionOnKdePath(E,m,C),O=T._offset,z=T._length;L[_+"0"]=I[0],L[_+"1"]=I[1],L[w+"0"]=L[w+"1"]=C,L[w+"Label"]=w+": "+o.hoverLabelText(k,A,m[w+"hoverformat"])+", "+d[0].t.labels.kde+" "+P.toFixed(3),L.spikeDistance=b[0].spikeDistance;var D=_+"Spike";L[D]=b[0][D],b[0].spikeDistance=void 0,b[0][D]=void 0,L.hovertemplate=!1,x.push(L),(h={stroke:r.color})[_+"1"]=a.constrain(O+I[0],O,O+z),h[_+"2"]=a.constrain(O+I[1],O,O+z),h[w+"1"]=h[w+"2"]=k._offset+C}}v&&(x=x.concat(b))}-1!==g.indexOf("points")&&(f=s.hoverOnPoints(r,n,i));var R=p.selectAll(".violinline-"+m.uid).data(h?[0]:[]);return R.enter().append("line").classed("violinline-"+m.uid,!0).attr("stroke-width",1.5),R.exit().remove(),R.attr(h),"closest"===c?f?[f]:x:(f&&x.push(f),x)}},{"../../lib":503,"../../plots/cartesian/axes":554,"../box/hover":678,"./helpers":1091}],1093:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults"),crossTraceDefaults:r("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc"),plot:r("./plot"),style:r("./style"),styleOnSelect:r("../scatter/style").styleOnSelect,hoverPoints:r("./hover"),selectPoints:r("../box/select"),moduleType:"trace",name:"violin",basePlotModule:r("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../box/defaults":676,"../box/select":683,"../scatter/style":950,"./attributes":1087,"./calc":1088,"./cross_trace_calc":1089,"./defaults":1090,"./hover":1092,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1096,"./style":1097}],1094:[function(r,n,i){"use strict";var a=r("../box/layout_attributes"),o=r("../../lib").extendFlat;n.exports={violinmode:o({},a.boxmode,{}),violingap:o({},a.boxgap,{}),violingroupgap:o({},a.boxgroupgap,{})}},{"../../lib":503,"../box/layout_attributes":680}],1095:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes"),s=r("../box/layout_defaults");n.exports=function(r,n,i){s._supply(r,n,i,function(i,s){return a.coerce(r,n,o,i,s)},"violin")}},{"../../lib":503,"../box/layout_defaults":681,"./layout_attributes":1094}],1096:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../components/drawing"),l=r("../box/plot"),c=r("../scatter/line_points"),u=r("./helpers");n.exports=function(r,n,i,f){var h=r._fullLayout,p=n.xaxis,d=n.yaxis;function m(r){var n=c(r,{xaxis:p,yaxis:d,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return s.smoothopen(n[0],1)}o.makeTraceGroups(f,i,"trace violins").each(function(r){var i=a.select(this),s=r[0],c=s.t,f=s.trace;if(!0!==f.visible||c.empty)i.remove();else{var g=c.bPos,v=c.bdPos,y=n[c.valLetter+"axis"],x=n[c.posLetter+"axis"],b="both"===f.side,_=b||"positive"===f.side,w=b||"negative"===f.side,T=i.selectAll("path.violin").data(o.identity);T.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),T.exit().remove(),T.each(function(r){var n,i,o,s,l,u,p,d,T=a.select(this),k=r.density,A=k.length,M=x.c2l(r.pos+g,!0),S=x.l2p(M);if(f.width)n=c.maxKDE/v;else{var E=h._violinScaleGroupStats[f.scalegroup];n="count"===f.scalemode?E.maxKDE/v*(E.maxCount/r.pts.length):E.maxKDE/v}if(_){for(p=Array(A),l=0;l<A;l++)(d=p[l]={})[c.posLetter]=M+k[l].v/n,d[c.valLetter]=y.c2l(k[l].t,!0);i=m(p)}if(w){for(p=Array(A),u=0,l=A-1;u<A;u++,l--)(d=p[u]={})[c.posLetter]=M-k[l].v/n,d[c.valLetter]=y.c2l(k[l].t,!0);o=m(p)}if(b)s=i+"L"+o.substr(1)+"Z";else{var L=[S,y.c2p(k[0].t)],C=[S,y.c2p(k[A-1].t)];"h"===f.orientation&&(L.reverse(),C.reverse()),s=_?"M"+L+"L"+i.substr(1)+"L"+C:"M"+C+"L"+o.substr(1)+"L"+L}T.attr("d",s),r.posCenterPx=S,r.posDensityScale=n*v,r.path=T.node(),r.pathLength=r.path.getTotalLength()/(b?2:1)});var k,A,M,S=f.box,E=S.width,L=(S.line||{}).width;b?(k=v*E,A=0):_?(k=[0,v*E/2],A=L*({x:1,y:-1})[c.posLetter]):(k=[v*E/2,0],A=L*({x:-1,y:1})[c.posLetter]),l.plotBoxAndWhiskers(i,{pos:x,val:y},f,{bPos:g,bdPos:k,bPosPxOffset:A}),l.plotBoxMean(i,{pos:x,val:y},f,{bPos:g,bdPos:k,bPosPxOffset:A}),!f.box.visible&&f.meanline.visible&&(M=o.identity);var C=i.selectAll("path.meanline").data(M||[]);C.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),C.exit().remove(),C.each(function(r){var n=y.c2p(r.mean,!0),i=u.getPositionOnKdePath(r,f,n);a.select(this).attr("d","h"===f.orientation?"M"+n+","+i[0]+"V"+i[1]:"M"+i[0]+","+n+"H"+i[1])}),l.plotPoints(i,{x:p,y:d},f,c)}})}},{"../../components/drawing":388,"../../lib":503,"../box/plot":682,"../scatter/line_points":940,"./helpers":1091,"@plotly/d3":58}],1097:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/color"),s=r("../scatter/style").stylePoints;n.exports=function(r){var n=a.select(r).selectAll("g.trace.violins");n.style("opacity",function(r){return r[0].trace.opacity}),n.each(function(n){var i=n[0].trace,l=a.select(this),c=i.box||{},u=c.line||{},f=i.meanline||{},h=f.width;l.selectAll("path.violin").style("stroke-width",i.line.width+"px").call(o.stroke,i.line.color).call(o.fill,i.fillcolor),l.selectAll("path.box").style("stroke-width",u.width+"px").call(o.stroke,u.color).call(o.fill,c.fillcolor);var p={"stroke-width":h+"px","stroke-dasharray":2*h+"px,"+h+"px"};l.selectAll("path.mean").style(p).call(o.stroke,f.color),l.selectAll("path.meanline").style(p).call(o.stroke,f.color),s(l,i,r)})}},{"../../components/color":366,"../scatter/style":950,"@plotly/d3":58}],1098:[function(r,n,i){"use strict";var a=r("../../components/colorscale/attributes"),o=r("../isosurface/attributes"),s=r("../surface/attributes"),l=r("../../plots/attributes"),c=r("../../lib/extend").extendFlat,u=r("../../plot_api/edit_types").overrideAll,f=n.exports=u(c({x:o.x,y:o.y,z:o.z,value:o.value,isomin:o.isomin,isomax:o.isomax,surface:o.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:o.slices,caps:o.caps,text:o.text,hovertext:o.hovertext,xhoverformat:o.xhoverformat,yhoverformat:o.yhoverformat,zhoverformat:o.zhoverformat,valuehoverformat:o.valuehoverformat,hovertemplate:o.hovertemplate},a("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:o.colorbar,opacity:o.opacity,opacityscale:s.opacityscale,lightposition:o.lightposition,lighting:o.lighting,flatshading:o.flatshading,contour:o.contour,hoverinfo:c({},l.hoverinfo),showlegend:c({},l.showlegend,{dflt:!1})}),"calc","nested");f.x.editType=f.y.editType=f.z.editType=f.value.editType="calc+clearAxisTypes",f.transforms=void 0},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../isosurface/attributes":862,"../surface/attributes":1057}],1099:[function(r,n,i){"use strict";var a=r("../../../stackgl_modules").gl_mesh3d,o=r("../../lib/gl_format_color").parseColorScale,s=r("../../lib/str2rgbarray"),l=r("../../components/colorscale").extractOpts,c=r("../../plots/gl3d/zip3"),u=r("../isosurface/convert").findNearestOnAxis,f=r("../isosurface/convert").generateIsoMeshes;function h(r,n,i){this.scene=r,this.uid=i,this.mesh=n,this.name="",this.data=null,this.showContour=!1}var p=h.prototype;p.handlePick=function(r){if(r.object===this.mesh){var n=r.data.index,i=this.data._meshX[n],a=this.data._meshY[n],o=this.data._meshZ[n],s=this.data._Ys.length,l=this.data._Zs.length,c=u(i,this.data._Xs).id,f=u(a,this.data._Ys).id,h=u(o,this.data._Zs).id,p=r.index=h+l*f+l*s*c;r.traceCoordinate=[this.data._meshX[p],this.data._meshY[p],this.data._meshZ[p],this.data._value[p]];var d=this.data.hovertext||this.data.text;return Array.isArray(d)&&void 0!==d[p]?r.textLabel=d[p]:d&&(r.textLabel=d),!0}},p.update=function(r){var n=this.scene,i=n.fullSceneLayout;function a(r,n,i,a){return n.map(function(n){return r.d2l(n,0,a)*i})}this.data=f(r);var u={positions:c(a(i.xaxis,r._meshX,n.dataScale[0],r.xcalendar),a(i.yaxis,r._meshY,n.dataScale[1],r.ycalendar),a(i.zaxis,r._meshZ,n.dataScale[2],r.zcalendar)),cells:c(r._meshI,r._meshJ,r._meshK),lightPosition:[r.lightposition.x,r.lightposition.y,r.lightposition.z],ambient:r.lighting.ambient,diffuse:r.lighting.diffuse,specular:r.lighting.specular,roughness:r.lighting.roughness,fresnel:r.lighting.fresnel,vertexNormalsEpsilon:r.lighting.vertexnormalsepsilon,faceNormalsEpsilon:r.lighting.facenormalsepsilon,opacity:r.opacity,opacityscale:r.opacityscale,contourEnable:r.contour.show,contourColor:s(r.contour.color).slice(0,3),contourWidth:r.contour.width,useFacetNormals:r.flatshading},h=l(r);u.vertexIntensity=r._meshIntensity,u.vertexIntensityBounds=[h.min,h.max],u.colormap=o(r),this.mesh.update(u)},p.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},n.exports=function(r,n){var i=a({gl:r.glplot.gl}),o=new h(r,i,n.uid);return i._trace=o,o.update(n),r.glplot.add(i),o}},{"../../../stackgl_modules":1120,"../../components/colorscale":378,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/gl3d/zip3":609,"../isosurface/convert":864}],1100:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./attributes"),s=r("../isosurface/defaults").supplyIsoDefaults,l=r("../surface/defaults").opacityscaleDefaults;n.exports=function(r,n,i,c){function u(i,s){return a.coerce(r,n,o,i,s)}s(r,n,i,c,u),l(r,n,c,u)}},{"../../lib":503,"../isosurface/defaults":865,"../surface/defaults":1060,"./attributes":1098}],1101:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),supplyDefaults:r("./defaults"),calc:r("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:r("./convert"),moduleType:"trace",name:"volume",basePlotModule:r("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":598,"../isosurface/calc":863,"./attributes":1098,"./convert":1099,"./defaults":1100}],1102:[function(r,n,i){"use strict";var a=r("../bar/attributes"),o=r("../scatter/attributes").line,s=r("../../plots/attributes"),l=r("../../plots/cartesian/axis_format_attributes").axisHoverFormat,c=r("../../plots/template_attributes").hovertemplateAttrs,u=r("../../plots/template_attributes").texttemplateAttrs,f=r("./constants"),h=r("../../lib/extend").extendFlat,p=r("../../components/color");function d(r){return{marker:{color:h({},a.marker.color,{arrayOk:!1,editType:"style"}),line:{color:h({},a.marker.line.color,{arrayOk:!1,editType:"style"}),width:h({},a.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}n.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:a.x,x0:a.x0,dx:a.dx,y:a.y,y0:a.y0,dy:a.dy,xperiod:a.xperiod,yperiod:a.yperiod,xperiod0:a.xperiod0,yperiod0:a.yperiod0,xperiodalignment:a.xperiodalignment,yperiodalignment:a.yperiodalignment,xhoverformat:l("x"),yhoverformat:l("y"),hovertext:a.hovertext,hovertemplate:c({},{keys:f.eventDataKeys}),hoverinfo:h({},s.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:u({editType:"plot"},{keys:f.eventDataKeys.concat(["label"])}),text:a.text,textposition:a.textposition,insidetextanchor:a.insidetextanchor,textangle:a.textangle,textfont:a.textfont,insidetextfont:a.insidetextfont,outsidetextfont:a.outsidetextfont,constraintext:a.constraintext,cliponaxis:a.cliponaxis,orientation:a.orientation,offset:a.offset,width:a.width,increasing:d(),decreasing:d(),totals:d(),connector:{line:{color:h({},o.color,{dflt:p.defaultLine}),width:h({},o.width,{editType:"plot"}),dash:o.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:a.offsetgroup,alignmentgroup:a.alignmentgroup}},{"../../components/color":366,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatter/attributes":926,"./constants":1104}],1103:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes"),o=r("../../plots/cartesian/align_period"),s=r("../../lib").mergeArray,l=r("../scatter/calc_selection"),c=r("../../constants/numerical").BADNUM;function u(r){return"a"===r||"absolute"===r}function f(r){return"t"===r||"total"===r}n.exports=function(r,n){var i,h,p,d,m,g,v=a.getFromId(r,n.xaxis||"x"),y=a.getFromId(r,n.yaxis||"y");"h"===n.orientation?(i=v.makeCalcdata(n,"x"),p=y.makeCalcdata(n,"y"),d=o(n,y,"y",p),m=!!n.yperiodalignment,g="y"):(i=y.makeCalcdata(n,"y"),p=v.makeCalcdata(n,"x"),d=o(n,v,"x",p),m=!!n.xperiodalignment,g="x"),h=d.vals;for(var x,b=Math.min(h.length,i.length),_=Array(b),w=0,T=!1,k=0;k<b;k++){var A=i[k]||0,M=!1;(i[k]!==c||f(n.measure[k])||u(n.measure[k]))&&k+1<b&&(i[k+1]!==c||f(n.measure[k+1])||u(n.measure[k+1]))&&(M=!0);var S=_[k]={i:k,p:h[k],s:A,rawS:A,cNext:M};u(n.measure[k])?(w=S.s,S.isSum=!0,S.dir="totals",S.s=w):f(n.measure[k])?(S.isSum=!0,S.dir="totals",S.s=w):(S.isSum=!1,S.dir=S.rawS<0?"decreasing":"increasing",x=S.s,S.s=w+x,w+=x),"totals"===S.dir&&(T=!0),m&&(_[k].orig_p=p[k],_[k][g+"End"]=d.ends[k],_[k][g+"Start"]=d.starts[k]),n.ids&&(S.id=String(n.ids[k])),S.v=(n.base||0)+w}return _.length&&(_[0].hasTotals=T),s(n.text,_,"tx"),s(n.hovertext,_,"htx"),l(_,n),_}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../scatter/calc_selection":928}],1104:[function(r,n,i){"use strict";n.exports={eventDataKeys:["initial","delta","final"]}},{}],1105:[function(r,n,i){"use strict";var a=r("../bar/cross_trace_calc").setGroupPositions;n.exports=function(r,n){var i,o,s=r._fullLayout,l=r._fullData,c=r.calcdata,u=n.xaxis,f=n.yaxis,h=[],p=[],d=[];for(o=0;o<l.length;o++){var m=l[o];!0===m.visible&&m.xaxis===u._id&&m.yaxis===f._id&&"waterfall"===m.type&&(i=c[o],"h"===m.orientation?d.push(i):p.push(i),h.push(i))}var g={mode:s.waterfallmode,norm:s.waterfallnorm,gap:s.waterfallgap,groupgap:s.waterfallgroupgap};for(a(r,u,f,p,g),a(r,f,u,d,g),o=0;o<h.length;o++){i=h[o];for(var v=0;v<i.length;v++){var y=i[v];!1===y.isSum&&(y.s0+=0===v?0:i[v-1].s),v+1<i.length&&(i[v].nextP0=i[v+1].p0,i[v].nextS0=i[v+1].s0)}}}},{"../bar/cross_trace_calc":651}],1106:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("../bar/defaults").handleGroupingDefaults,s=r("../bar/defaults").handleText,l=r("../scatter/xy_defaults"),c=r("../scatter/period_defaults"),u=r("./attributes"),f=r("../../components/color"),h=r("../../constants/delta.js"),p=h.INCREASING.COLOR,d=h.DECREASING.COLOR;function m(r,n,i){r(n+".marker.color",i),r(n+".marker.line.color",f.defaultLine),r(n+".marker.line.width")}n.exports={supplyDefaults:function(r,n,i,o){function f(i,o){return a.coerce(r,n,u,i,o)}if(l(r,n,o,f)){c(r,n,o,f),f("xhoverformat"),f("yhoverformat"),f("measure"),f("orientation",n.x&&!n.y?"h":"v"),f("base"),f("offset"),f("width"),f("text"),f("hovertext"),f("hovertemplate");var h=f("textposition");s(r,n,o,f,h,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"!==n.textposition&&(f("texttemplate"),n.texttemplate||f("textinfo")),m(f,"increasing",p),m(f,"decreasing",d),m(f,"totals","#4499FF"),f("connector.visible")&&(f("connector.mode"),f("connector.line.width")&&(f("connector.line.color"),f("connector.line.dash")))}else n.visible=!1},crossTraceDefaults:function(r,n){var i;function s(r){return a.coerce(i._input,i,u,r)}if("group"===n.waterfallmode)for(var l=0;l<r.length;l++)o((i=r[l])._input,i,n,s)}}},{"../../components/color":366,"../../constants/delta.js":473,"../../lib":503,"../bar/defaults":652,"../scatter/period_defaults":946,"../scatter/xy_defaults":953,"./attributes":1102}],1107:[function(r,n,i){"use strict";n.exports=function(r,n){return r.x="xVal"in n?n.xVal:n.x,r.y="yVal"in n?n.yVal:n.y,"initial"in n&&(r.initial=n.initial),"delta"in n&&(r.delta=n.delta),"final"in n&&(r.final=n.final),n.xa&&(r.xaxis=n.xa),n.ya&&(r.yaxis=n.ya),r}},{}],1108:[function(r,n,i){"use strict";var a=r("../../plots/cartesian/axes").hoverLabelText,o=r("../../components/color").opacity,s=r("../bar/hover").hoverOnBars,l=r("../../constants/delta.js"),c=l.INCREASING.SYMBOL,u=l.DECREASING.SYMBOL;n.exports=function(r,n,i,l,f){var h=s(r,n,i,l,f);if(h){var p,d,m,g,v=h.cd,y=v[0].trace,x="h"===y.orientation,b=x?"x":"y",_=x?r.xa:r.ya,w=v[h.index],T=w.isSum?w.b+w.s:w.rawS;if(!w.isSum){h.initial=w.b+w.s-T,h.delta=T,h.final=h.initial+h.delta;var k=C(Math.abs(h.delta));h.deltaLabel=T<0?"("+k+")":k,h.finalLabel=C(h.final),h.initialLabel=C(h.initial)}var A=w.hi||y.hoverinfo,M=[];if(A&&"none"!==A&&"skip"!==A){var S="all"===A,E=A.split("+"),L=function(r){return S||-1!==E.indexOf(r)};w.isSum||(!L("final")||L(x?"x":"y")||M.push(h.finalLabel),L("delta")&&(T<0?M.push(h.deltaLabel+" "+u):M.push(h.deltaLabel+" "+c)),L("initial")&&M.push("Initial: "+h.initialLabel))}return M.length&&(h.extraText=M.join("<br>")),h.color=(d=(p=y[w.dir].marker).color,m=p.line.color,g=p.line.width,o(d)?d:o(m)&&g?m:void 0),[h]}function C(r){return a(_,r,y[b+"hoverformat"])}}},{"../../components/color":366,"../../constants/delta.js":473,"../../plots/cartesian/axes":554,"../bar/hover":655}],1109:[function(r,n,i){"use strict";n.exports={attributes:r("./attributes"),layoutAttributes:r("./layout_attributes"),supplyDefaults:r("./defaults").supplyDefaults,crossTraceDefaults:r("./defaults").crossTraceDefaults,supplyLayoutDefaults:r("./layout_defaults"),calc:r("./calc"),crossTraceCalc:r("./cross_trace_calc"),plot:r("./plot"),style:r("./style").style,hoverPoints:r("./hover"),eventData:r("./event_data"),selectPoints:r("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:r("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../bar/select":660,"./attributes":1102,"./calc":1103,"./cross_trace_calc":1105,"./defaults":1106,"./event_data":1107,"./hover":1108,"./layout_attributes":1110,"./layout_defaults":1111,"./plot":1112,"./style":1113}],1110:[function(r,n,i){"use strict";n.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1111:[function(r,n,i){"use strict";var a=r("../../lib"),o=r("./layout_attributes");n.exports=function(r,n,i){var s=!1;function l(i,s){return a.coerce(r,n,o,i,s)}for(var c=0;c<i.length;c++){var u=i[c];if(u.visible&&"waterfall"===u.type){s=!0;break}}s&&(l("waterfallmode"),l("waterfallgap",.2),l("waterfallgroupgap"))}},{"../../lib":503,"./layout_attributes":1110}],1112:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../lib"),s=r("../../components/drawing"),l=r("../../constants/numerical").BADNUM,c=r("../bar/plot"),u=r("../bar/uniform_text").clearMinTextSize;n.exports=function(r,n,i,f){var h=r._fullLayout;u("waterfall",h),c.plot(r,n,i,f,{mode:h.waterfallmode,norm:h.waterfallmode,gap:h.waterfallgap,groupgap:h.waterfallgroupgap}),function(r,n,i,c){var u=n.xaxis,f=n.yaxis;o.makeTraceGroups(c,i,"trace bars").each(function(i){var c=a.select(this),h=i[0].trace,p=o.ensureSingle(c,"g","lines");if(h.connector&&h.connector.visible){var d="h"===h.orientation,m=h.connector.mode,g=p.selectAll("g.line").data(o.identity);g.enter().append("g").classed("line",!0),g.exit().remove();var v=g.size();g.each(function(i,c){if(c===v-1||i.cNext){var h,p,g,y,x=(h=[],p=[],g=d?u:f,y=d?f:u,h[0]=g.c2p(i.s0,!0),p[0]=y.c2p(i.p0,!0),h[1]=g.c2p(i.s1,!0),p[1]=y.c2p(i.p1,!0),h[2]=g.c2p(i.nextS0,!0),p[2]=y.c2p(i.nextP0,!0),d?[h,p]:[p,h]),b=x[0],_=x[1],w="";b[0]!==l&&_[0]!==l&&b[1]!==l&&_[1]!==l&&("spanning"===m&&!i.isSum&&c>0&&(w+=d?"M"+b[0]+","+_[1]+"V"+_[0]:"M"+b[1]+","+_[0]+"H"+b[0]),"between"!==m&&(i.isSum||c<v-1)&&(w+=d?"M"+b[1]+","+_[0]+"V"+_[1]:"M"+b[0]+","+_[1]+"H"+b[1]),b[2]!==l&&_[2]!==l&&(w+=d?"M"+b[1]+","+_[1]+"V"+_[2]:"M"+b[1]+","+_[1]+"H"+b[2])),""===w&&(w="M0,0Z"),o.ensureSingle(a.select(this),"path").attr("d",w).call(s.setClipUrl,n.layerClipId,r)}})}else p.remove()})}(r,n,i,f)}},{"../../components/drawing":388,"../../constants/numerical":479,"../../lib":503,"../bar/plot":659,"../bar/uniform_text":664,"@plotly/d3":58}],1113:[function(r,n,i){"use strict";var a=r("@plotly/d3"),o=r("../../components/drawing"),s=r("../../components/color"),l=r("../../constants/interactions").DESELECTDIM,c=r("../bar/style"),u=r("../bar/uniform_text").resizeText,f=c.styleTextPoints;n.exports={style:function(r,n,i){var c=i||a.select(r).selectAll("g.waterfalllayer").selectAll("g.trace");u(r,c,"waterfall"),c.style("opacity",function(r){return r[0].trace.opacity}),c.each(function(n){var i=a.select(this),c=n[0].trace;i.selectAll(".point > path").each(function(r){if(!r.isBlank){var n=c[r.dir].marker;a.select(this).call(s.fill,n.color).call(s.stroke,n.line.color).call(o.dashLine,n.line.dash,n.line.width).style("opacity",c.selectedpoints&&!r.selected?l:1)}}),f(i,c,r),i.selectAll(".lines").each(function(){var r=c.connector.line;o.lineGroupStyle(a.select(this).selectAll("path"),r.width,r.color,r.dash)})})}}},{"../../components/color":366,"../../components/drawing":388,"../../constants/interactions":478,"../bar/style":662,"../bar/uniform_text":664,"@plotly/d3":58}],1114:[function(r,n,i){"use strict";var a=r("../plots/cartesian/axes"),o=r("../lib"),s=r("../plot_api/plot_schema"),l=r("./helpers").pointsAccessorFunction,c=r("../constants/numerical").BADNUM;i.moduleType="transform",i.name="aggregate";var u=i.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},f=u.aggregations;function h(r,n,i,s){if(s.enabled){for(var l=s.target,u=o.nestedProperty(n,l),f=u.get(),h=function(r,n){var i=r.func,a=n.d2c,s=n.c2d;switch(i){case"count":return p;case"first":return d;case"last":return m;case"sum":return function(r,n){for(var i=0,o=0;o<n.length;o++){var l=a(r[n[o]]);l!==c&&(i+=l)}return s(i)};case"avg":return function(r,n){for(var i=0,o=0,l=0;l<n.length;l++){var u=a(r[n[l]]);u!==c&&(i+=u,o++)}return o?s(i/o):c};case"min":return function(r,n){for(var i=1/0,o=0;o<n.length;o++){var l=a(r[n[o]]);l!==c&&(i=Math.min(i,l))}return i===1/0?c:s(i)};case"max":return function(r,n){for(var i=-1/0,o=0;o<n.length;o++){var l=a(r[n[o]]);l!==c&&(i=Math.max(i,l))}return i===-1/0?c:s(i)};case"range":return function(r,n){for(var i=1/0,o=-1/0,l=0;l<n.length;l++){var u=a(r[n[l]]);u!==c&&(i=Math.min(i,u),o=Math.max(o,u))}return o===-1/0||i===1/0?c:s(o-i)};case"change":return function(r,n){var i=a(r[n[0]]),o=a(r[n[n.length-1]]);return i===c||o===c?c:s(o-i)};case"median":return function(r,n){for(var i=[],l=0;l<n.length;l++){var u=a(r[n[l]]);u!==c&&i.push(u)}if(!i.length)return c;i.sort(o.sorterAsc);var f=(i.length-1)/2;return s((i[Math.floor(f)]+i[Math.ceil(f)])/2)};case"mode":return function(r,n){for(var i={},o=0,l=c,u=0;u<n.length;u++){var f=a(r[n[u]]);if(f!==c){var h=i[f]=(i[f]||0)+1;h>o&&(o=h,l=f)}}return o?s(l):c};case"rms":return function(r,n){for(var i=0,o=0,l=0;l<n.length;l++){var u=a(r[n[l]]);u!==c&&(i+=u*u,o++)}return o?s(Math.sqrt(i/o)):c};case"stddev":return function(n,i){var o,s=0,l=0,u=1,f=c;for(o=0;o<i.length&&f===c;o++)f=a(n[i[o]]);if(f===c)return c;for(;o<i.length;o++){var h=a(n[i[o]]);if(h!==c){var p=h-f;s+=p,l+=p*p,u++}}var d="sample"===r.funcmode?u-1:u;return d?Math.sqrt((l-s*s/u)/d):0}}}(s,a.getDataConversions(r,n,l,f)),g=Array(i.length),v=0;v<i.length;v++)g[v]=h(f,i[v]);u.set(g),"count"===s.func&&o.pushUnique(n._arrayAttrs,l)}}function p(r,n){return n.length}function d(r,n){return r[n[0]]}function m(r,n){return r[n[n.length-1]]}i.supplyDefaults=function(r,n){var i,a={};function l(n,i){return o.coerce(r,a,u,n,i)}if(!l("enabled"))return a;var c=s.findArrayAttributes(n),h={};for(i=0;i<c.length;i++)h[c[i]]=1;var p=l("groups");if(!Array.isArray(p)){if(!h[p])return a.enabled=!1,a;h[p]=0}var d,m=r.aggregations||[],g=a.aggregations=Array(m.length);function v(r,n){return o.coerce(m[i],d,f,r,n)}for(i=0;i<m.length;i++){d={_index:i};var y=v("target"),x=v("func");v("enabled")&&y&&(h[y]||"count"===x&&void 0===h[y])?("stddev"===x&&v("funcmode"),h[y]=0,g[i]=d):g[i]={enabled:!1,_index:i}}for(i=0;i<c.length;i++)h[c[i]]&&g.push({target:c[i],func:f.func.dflt,enabled:!0,_index:-1});return a},i.calcTransform=function(r,n,i){if(i.enabled){var a=i.groups,s=o.getTargetArray(n,{target:a});if(s){var c,u,f,p,d={},m={},g=[],v=l(n.transforms,i),y=s.length;for(n._length&&(y=Math.min(y,n._length)),c=0;c<y;c++)void 0===(f=d[u=s[c]])?(d[u]=g.length,p=[c],g.push(p),m[d[u]]=v(c)):(g[f].push(c),m[d[u]]=(m[d[u]]||[]).concat(v(c)));i._indexToPoints=m;var x=i.aggregations;for(c=0;c<x.length;c++)h(r,n,g,x[c]);"string"==typeof a&&h(r,n,g,{target:a,func:"first",enabled:!0}),n._length=g.length}}}},{"../constants/numerical":479,"../lib":503,"../plot_api/plot_schema":542,"../plots/cartesian/axes":554,"./helpers":1117}],1115:[function(r,n,i){"use strict";var a=r("../lib"),o=r("../registry"),s=r("../plots/cartesian/axes"),l=r("./helpers").pointsAccessorFunction,c=r("../constants/filter_ops"),u=c.COMPARISON_OPS,f=c.INTERVAL_OPS,h=c.SET_OPS;i.moduleType="transform",i.name="filter",i.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(u).concat(f).concat(h),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},i.supplyDefaults=function(r){var n={};function s(o,s){return a.coerce(r,n,i.attributes,o,s)}if(s("enabled")){var l=s("target");if(a.isArrayOrTypedArray(l)&&0===l.length)return n.enabled=!1,n;s("preservegaps"),s("operation"),s("value");var c=o.getComponentMethod("calendars","handleDefaults");c(r,n,"valuecalendar",null),c(r,n,"targetcalendar",null)}return n},i.calcTransform=function(r,n,i){if(i.enabled){var o=a.getTargetArray(n,i);if(o){var c=i.target,p=o.length;n._length&&(p=Math.min(p,n._length));var d=i.targetcalendar,m=n._arrayAttrs,g=i.preservegaps;if("string"==typeof c){var v=a.nestedProperty(n,c+"calendar").get();v&&(d=v)}var y,x,b=function(r,n,i){var a=r.operation,o=r.value,s=Array.isArray(o);function l(r){return -1!==r.indexOf(a)}var c,p=function(i){return n(i,0,r.valuecalendar)},d=function(r){return n(r,0,i)};switch(l(u)?c=p(s?o[0]:o):l(f)?c=s?[p(o[0]),p(o[1])]:[p(o),p(o)]:l(h)&&(c=s?o.map(p):[p(o)]),a){case"=":return function(r){return d(r)===c};case"!=":return function(r){return d(r)!==c};case"<":return function(r){return d(r)<c};case"<=":return function(r){return d(r)<=c};case">":return function(r){return d(r)>c};case">=":return function(r){return d(r)>=c};case"[]":return function(r){var n=d(r);return n>=c[0]&&n<=c[1]};case"()":return function(r){var n=d(r);return n>c[0]&&n<c[1]};case"[)":return function(r){var n=d(r);return n>=c[0]&&n<c[1]};case"(]":return function(r){var n=d(r);return n>c[0]&&n<=c[1]};case"][":return function(r){var n=d(r);return n<=c[0]||n>=c[1]};case")(":return function(r){var n=d(r);return n<c[0]||n>c[1]};case"](":return function(r){var n=d(r);return n<=c[0]||n>c[1]};case")[":return function(r){var n=d(r);return n<c[0]||n>=c[1]};case"{}":return function(r){return -1!==c.indexOf(d(r))};case"}{":return function(r){return -1===c.indexOf(d(r))}}}(i,s.getDataToCoordFunc(r,n,c,o),d),_={},w={},T=0;g?(y=function(r){_[r.astr]=a.extendDeep([],r.get()),r.set(Array(p))},x=function(r,n){var i=_[r.astr][n];r.get()[n]=i}):(y=function(r){_[r.astr]=a.extendDeep([],r.get()),r.set([])},x=function(r,n){var i=_[r.astr][n];r.get().push(i)}),M(y);for(var k=l(n.transforms,i),A=0;A<p;A++)b(o[A])?(M(x,A),w[T++]=k(A)):g&&T++;i._indexToPoints=w,n._length=T}}function M(r,i){for(var o=0;o<m.length;o++)r(a.nestedProperty(n,m[o]),i)}}},{"../constants/filter_ops":475,"../lib":503,"../plots/cartesian/axes":554,"../registry":638,"./helpers":1117}],1116:[function(r,n,i){"use strict";var a=r("../lib"),o=r("../plot_api/plot_schema"),s=r("../plots/plots"),l=r("./helpers").pointsAccessorFunction;i.moduleType="transform",i.name="groupby",i.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},i.supplyDefaults=function(r,n,o){var s,l={};function c(n,o){return a.coerce(r,l,i.attributes,n,o)}if(!c("enabled"))return l;c("groups"),c("nameformat",o._dataLength>1?"%{group} (%{trace})":"%{group}");var u=r.styles,f=l.styles=[];if(u)for(s=0;s<u.length;s++){var h=f[s]={};a.coerce(u[s],f[s],i.attributes.styles,"target");var p=a.coerce(u[s],f[s],i.attributes.styles,"value");a.isPlainObject(p)?h.value=a.extendDeep({},p):p&&delete h.value}return l},i.transform=function(r,n){var i,c,u,f=[];for(c=0;c<r.length;c++)for(i=function(r,n){var i,c,u,f,h,p,d,m,g,v,y=n.transform,x=n.transformIndex,b=r.transforms[x].groups,_=l(r.transforms,y);if(!a.isArrayOrTypedArray(b)||0===b.length)return[r];var w=a.filterUnique(b),T=Array(w.length),k=b.length,A=o.findArrayAttributes(r),M=y.styles||[],S={};for(i=0;i<M.length;i++)S[M[i].target]=M[i].value;y.styles&&(v=a.keyedContainer(y,"styles","target","value.name"));var E={},L={};for(i=0;i<w.length;i++){E[p=w[i]]=i,L[p]=0,(d=T[i]=a.extendDeepNoArrays({},r))._group=p,d.transforms[x]._indexToPoints={};var C=null;for(v&&(C=v.get(p)),d.name=C||""===C?C:a.templateString(y.nameformat,{trace:r.name,group:p}),m=d.transforms,d.transforms=[],c=0;c<m.length;c++)d.transforms[c]=a.extendDeepNoArrays({},m[c]);for(c=0;c<A.length;c++)a.nestedProperty(d,A[c]).set([])}for(u=0;u<A.length;u++){for(f=A[u],c=0,g=[];c<w.length;c++)g[c]=a.nestedProperty(T[c],f).get();for(h=a.nestedProperty(r,f).get(),c=0;c<k;c++)g[E[b[c]]].push(h[c])}for(c=0;c<k;c++)(d=T[E[b[c]]]).transforms[x]._indexToPoints[L[b[c]]]=_(c),L[b[c]]++;for(i=0;i<w.length;i++)p=w[i],d=T[i],s.clearExpandedTraceDefaultColors(d),d=a.extendDeepNoArrays(d,S[p]||{});return T}(r[c],n),u=0;u<i.length;u++)f.push(i[u]);return f}},{"../lib":503,"../plot_api/plot_schema":542,"../plots/plots":619,"./helpers":1117}],1117:[function(r,n,i){"use strict";i.pointsAccessorFunction=function(r,n){for(var i,a,o=0;o<r.length&&(i=r[o])!==n;o++)i._indexToPoints&&!1!==i.enabled&&(a=i._indexToPoints);return a?function(r){return a[r]}:function(r){return[r]}}},{}],1118:[function(r,n,i){"use strict";var a=r("../lib"),o=r("../plots/cartesian/axes"),s=r("./helpers").pointsAccessorFunction,l=r("../constants/numerical").BADNUM;i.moduleType="transform",i.name="sort",i.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},i.supplyDefaults=function(r){var n={};function o(o,s){return a.coerce(r,n,i.attributes,o,s)}return o("enabled")&&(o("target"),o("order")),n},i.calcTransform=function(r,n,i){if(i.enabled){var c=a.getTargetArray(n,i);if(c){var u=i.target,f=c.length;n._length&&(f=Math.min(f,n._length));var h,p,d=n._arrayAttrs,m=function(r,n,i,a){var o,s=Array(a),c=Array(a);for(o=0;o<a;o++)s[o]={v:n[o],i:o};for(s.sort(function(r,n){switch(r.order){case"ascending":return function(r,i){var a=n(r.v),o=n(i.v);return a===l?1:o===l?-1:a-o};case"descending":return function(r,i){var a=n(r.v),o=n(i.v);return a===l?1:o===l?-1:o-a}}}(r,i)),o=0;o<a;o++)c[o]=s[o].i;return c}(i,c,o.getDataToCoordFunc(r,n,u,c),f),g=s(n.transforms,i),v={};for(h=0;h<d.length;h++){var y=a.nestedProperty(n,d[h]),x=y.get(),b=Array(f);for(p=0;p<f;p++)b[p]=x[m[p]];y.set(b)}for(p=0;p<f;p++)v[p]=g(m[p]);i._indexToPoints=v,n._length=f}}}},{"../constants/numerical":479,"../lib":503,"../plots/cartesian/axes":554,"./helpers":1117}],1119:[function(r,n,i){"use strict";i.version="2.8.0"},{}],1120:[function(r,n,a){(function(i){(function(){!function(r){"object"==typeof a&&void 0!==n?n.exports=r():("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).stackgl=r()}(function(){return(function n(i,a,o){function s(c,u){if(!a[c]){if(!i[c]){var f="function"==typeof r&&r;if(!u&&f)return f(c,!0);if(l)return l(c,!0);var h=Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var p=a[c]={exports:{}};i[c][0].call(p.exports,function(r){return s(i[c][1][r]||r)},p,p.exports,n,i,a,o)}return a[c].exports}for(var l="function"==typeof r&&r,c=0;c<o.length;c++)s(o[c]);return s})({1:[function(r,n,i){"use strict";i.byteLength=function(r){var n=f(r),i=n[0],a=n[1];return 3*(i+a)/4-a},i.toByteArray=function(r){var n,i,a=f(r),l=a[0],c=a[1],u=new s(3*(l+c)/4-c),h=0,p=c>0?l-4:l;for(i=0;i<p;i+=4)n=o[r.charCodeAt(i)]<<18|o[r.charCodeAt(i+1)]<<12|o[r.charCodeAt(i+2)]<<6|o[r.charCodeAt(i+3)],u[h++]=n>>16&255,u[h++]=n>>8&255,u[h++]=255&n;return 2===c&&(n=o[r.charCodeAt(i)]<<2|o[r.charCodeAt(i+1)]>>4,u[h++]=255&n),1===c&&(n=o[r.charCodeAt(i)]<<10|o[r.charCodeAt(i+1)]<<4|o[r.charCodeAt(i+2)]>>2,u[h++]=n>>8&255,u[h++]=255&n),u},i.fromByteArray=function(r){for(var n,i=r.length,o=i%3,s=[],l=0,c=i-o;l<c;l+=16383)s.push(function(r,n,i){for(var o,s=[],l=n;l<i;l+=3)s.push(a[(o=(r[l]<<16&16711680)+(r[l+1]<<8&65280)+(255&r[l+2]))>>18&63]+a[o>>12&63]+a[o>>6&63]+a[63&o]);return s.join("")}(r,l,l+16383>c?c:l+16383));return 1===o?s.push(a[(n=r[i-1])>>2]+a[n<<4&63]+"=="):2===o&&s.push(a[(n=(r[i-2]<<8)+r[i-1])>>10]+a[n>>4&63]+a[n<<2&63]+"="),s.join("")};for(var a=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=l.length;c<u;++c)a[c]=l[c],o[l.charCodeAt(c)]=c;function f(r){var n=r.length;if(n%4>0)throw Error("Invalid string. Length must be a multiple of 4");var i=r.indexOf("=");return -1===i&&(i=n),[i,i===n?0:4-i%4]}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],2:[function(r,n,i){},{}],3:[function(r,n,i){(function(n){(function(){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */"use strict";var n=r("base64-js"),a=r("ieee754");function o(r){if(r>2147483647)throw RangeError('The value "'+r+'" is invalid for option "size"');var n=new Uint8Array(r);return n.__proto__=s.prototype,n}function s(r,n,i){if("number"==typeof r){if("string"==typeof n)throw TypeError('The "string" argument must be of type string. Received type number');return u(r)}return l(r,n,i)}function l(r,n,i){if("string"==typeof r)return function(r,n){if("string"==typeof n&&""!==n||(n="utf8"),!s.isEncoding(n))throw TypeError("Unknown encoding: "+n);var i=0|p(r,n),a=o(i),l=a.write(r,n);return l!==i&&(a=a.slice(0,l)),a}(r,n);if(ArrayBuffer.isView(r))return f(r);if(null==r)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(E(r,ArrayBuffer)||r&&E(r.buffer,ArrayBuffer))return function(r,n,i){var a;if(n<0||r.byteLength<n)throw RangeError('"offset" is outside of buffer bounds');if(r.byteLength<n+(i||0))throw RangeError('"length" is outside of buffer bounds');return(a=void 0===n&&void 0===i?new Uint8Array(r):void 0===i?new Uint8Array(r,n):new Uint8Array(r,n,i)).__proto__=s.prototype,a}(r,n,i);if("number"==typeof r)throw TypeError('The "value" argument must not be of type number. Received type number');var a=r.valueOf&&r.valueOf();if(null!=a&&a!==r)return s.from(a,n,i);var l=function(r){if(s.isBuffer(r)){var n,i=0|h(r.length),a=o(i);return 0===a.length||r.copy(a,0,0,i),a}return void 0!==r.length?"number"!=typeof r.length||(n=r.length)!=n?o(0):f(r):"Buffer"===r.type&&Array.isArray(r.data)?f(r.data):void 0}(r);if(l)return l;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof r[Symbol.toPrimitive])return s.from(r[Symbol.toPrimitive]("string"),n,i);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}function c(r){if("number"!=typeof r)throw TypeError('"size" argument must be of type number');if(r<0)throw RangeError('The value "'+r+'" is invalid for option "size"')}function u(r){return c(r),o(r<0?0:0|h(r))}function f(r){for(var n=r.length<0?0:0|h(r.length),i=o(n),a=0;a<n;a+=1)i[a]=255&r[a];return i}function h(r){if(r>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|r}function p(r,n){if(s.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||E(r,ArrayBuffer))return r.byteLength;if("string"!=typeof r)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);var i=r.length,a=arguments.length>2&&!0===arguments[2];if(!a&&0===i)return 0;for(var o=!1;;)switch(n){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return A(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return M(r).length;default:if(o)return a?-1:A(r).length;n=(""+n).toLowerCase(),o=!0}}function d(r,i,a){var o,s,l=!1;if((void 0===i||i<0)&&(i=0),i>this.length||((void 0===a||a>this.length)&&(a=this.length),a<=0)||(a>>>=0)<=(i>>>=0))return"";for(r||(r="utf8");;)switch(r){case"hex":return function(r,n,i){var a,o=r.length;(!n||n<0)&&(n=0),(!i||i<0||i>o)&&(i=o);for(var s="",l=n;l<i;++l)s+=(a=r[l])<16?"0"+a.toString(16):a.toString(16);return s}(this,i,a);case"utf8":case"utf-8":return y(this,i,a);case"ascii":return function(r,n,i){var a="";i=Math.min(r.length,i);for(var o=n;o<i;++o)a+=String.fromCharCode(127&r[o]);return a}(this,i,a);case"latin1":case"binary":return function(r,n,i){var a="";i=Math.min(r.length,i);for(var o=n;o<i;++o)a+=String.fromCharCode(r[o]);return a}(this,i,a);case"base64":return o=i,s=a,0===o&&s===this.length?n.fromByteArray(this):n.fromByteArray(this.slice(o,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(r,n,i){for(var a=r.slice(n,i),o="",s=0;s<a.length;s+=2)o+=String.fromCharCode(a[s]+256*a[s+1]);return o}(this,i,a);default:if(l)throw TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),l=!0}}function m(r,n,i){var a=r[n];r[n]=r[i],r[i]=a}function g(r,n,i,a,o){var l;if(0===r.length)return -1;if("string"==typeof i?(a=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),(l=i=+i)!=l&&(i=o?0:r.length-1),i<0&&(i=r.length+i),i>=r.length){if(o)return -1;i=r.length-1}else if(i<0){if(!o)return -1;i=0}if("string"==typeof n&&(n=s.from(n,a)),s.isBuffer(n))return 0===n.length?-1:v(r,n,i,a,o);if("number"==typeof n)return n&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(r,n,i):Uint8Array.prototype.lastIndexOf.call(r,n,i):v(r,[n],i,a,o);throw TypeError("val must be string, number or Buffer")}function v(r,n,i,a,o){var s,l=1,c=r.length,u=n.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(r.length<2||n.length<2)return -1;l=2,c/=2,u/=2,i/=2}function f(r,n){return 1===l?r[n]:r.readUInt16BE(n*l)}if(o){var h=-1;for(s=i;s<c;s++)if(f(r,s)===f(n,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===u)return h*l}else -1!==h&&(s-=s-h),h=-1}else for(i+u>c&&(i=c-u),s=i;s>=0;s--){for(var p=!0,d=0;d<u;d++)if(f(r,s+d)!==f(n,d)){p=!1;break}if(p)return s}return -1}function y(r,n,i){i=Math.min(r.length,i);for(var a=[],o=n;o<i;){var s,l,c,u,f=r[o],h=null,p=f>239?4:f>223?3:f>191?2:1;if(o+p<=i)switch(p){case 1:f<128&&(h=f);break;case 2:128==(192&(s=r[o+1]))&&(u=(31&f)<<6|63&s)>127&&(h=u);break;case 3:s=r[o+1],l=r[o+2],128==(192&s)&&128==(192&l)&&(u=(15&f)<<12|(63&s)<<6|63&l)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:s=r[o+1],l=r[o+2],c=r[o+3],128==(192&s)&&128==(192&l)&&128==(192&c)&&(u=(15&f)<<18|(63&s)<<12|(63&l)<<6|63&c)>65535&&u<1114112&&(h=u)}null===h?(h=65533,p=1):h>65535&&(h-=65536,a.push(h>>>10&1023|55296),h=56320|1023&h),a.push(h),o+=p}return function(r){var n=r.length;if(n<=4096)return String.fromCharCode.apply(String,r);for(var i="",a=0;a<n;)i+=String.fromCharCode.apply(String,r.slice(a,a+=4096));return i}(a)}function x(r,n,i){if(r%1!=0||r<0)throw RangeError("offset is not uint");if(r+n>i)throw RangeError("Trying to access beyond buffer length")}function b(r,n,i,a,o,l){if(!s.isBuffer(r))throw TypeError('"buffer" argument must be a Buffer instance');if(n>o||n<l)throw RangeError('"value" argument is out of bounds');if(i+a>r.length)throw RangeError("Index out of range")}function _(r,n,i,a,o,s){if(i+a>r.length||i<0)throw RangeError("Index out of range")}function w(r,n,i,o,s){return n=+n,i>>>=0,s||_(r,0,i,4),a.write(r,n,i,o,23,4),i+4}function T(r,n,i,o,s){return n=+n,i>>>=0,s||_(r,0,i,8),a.write(r,n,i,o,52,8),i+8}i.Buffer=s,i.SlowBuffer=function(r){return+r!=r&&(r=0),s.alloc(+r)},i.INSPECT_MAX_BYTES=50,i.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===r.foo()}catch(r){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(r,n,i){return l(r,n,i)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(r,n,i){return c(r),r<=0?o(r):void 0!==n?"string"==typeof i?o(r).fill(n,i):o(r).fill(n):o(r)},s.allocUnsafe=function(r){return u(r)},s.allocUnsafeSlow=function(r){return u(r)},s.isBuffer=function(r){return null!=r&&!0===r._isBuffer&&r!==s.prototype},s.compare=function(r,n){if(E(r,Uint8Array)&&(r=s.from(r,r.offset,r.byteLength)),E(n,Uint8Array)&&(n=s.from(n,n.offset,n.byteLength)),!s.isBuffer(r)||!s.isBuffer(n))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===n)return 0;for(var i=r.length,a=n.length,o=0,l=Math.min(i,a);o<l;++o)if(r[o]!==n[o]){i=r[o],a=n[o];break}return i<a?-1:a<i?1:0},s.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(r,n){if(!Array.isArray(r))throw TypeError('"list" argument must be an Array of Buffers');if(0===r.length)return s.alloc(0);if(void 0===n)for(n=0,i=0;i<r.length;++i)n+=r[i].length;var i,a=s.allocUnsafe(n),o=0;for(i=0;i<r.length;++i){var l=r[i];if(E(l,Uint8Array)&&(l=s.from(l)),!s.isBuffer(l))throw TypeError('"list" argument must be an Array of Buffers');l.copy(a,o),o+=l.length}return a},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var r=this.length;if(r%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<r;n+=2)m(this,n,n+1);return this},s.prototype.swap32=function(){var r=this.length;if(r%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<r;n+=4)m(this,n,n+3),m(this,n+1,n+2);return this},s.prototype.swap64=function(){var r=this.length;if(r%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<r;n+=8)m(this,n,n+7),m(this,n+1,n+6),m(this,n+2,n+5),m(this,n+3,n+4);return this},s.prototype.toString=function(){var r=this.length;return 0===r?"":0==arguments.length?y(this,0,r):d.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(r){if(!s.isBuffer(r))throw TypeError("Argument must be a Buffer");return this===r||0===s.compare(this,r)},s.prototype.inspect=function(){var r="",n=i.INSPECT_MAX_BYTES;return r=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(r+=" ... "),"<Buffer "+r+">"},s.prototype.compare=function(r,n,i,a,o){if(E(r,Uint8Array)&&(r=s.from(r,r.offset,r.byteLength)),!s.isBuffer(r))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(void 0===n&&(n=0),void 0===i&&(i=r?r.length:0),void 0===a&&(a=0),void 0===o&&(o=this.length),n<0||i>r.length||a<0||o>this.length)throw RangeError("out of range index");if(a>=o&&n>=i)return 0;if(a>=o)return -1;if(n>=i)return 1;if(this===r)return 0;for(var l=(o>>>=0)-(a>>>=0),c=(i>>>=0)-(n>>>=0),u=Math.min(l,c),f=this.slice(a,o),h=r.slice(n,i),p=0;p<u;++p)if(f[p]!==h[p]){l=f[p],c=h[p];break}return l<c?-1:c<l?1:0},s.prototype.includes=function(r,n,i){return -1!==this.indexOf(r,n,i)},s.prototype.indexOf=function(r,n,i){return g(this,r,n,i,!0)},s.prototype.lastIndexOf=function(r,n,i){return g(this,r,n,i,!1)},s.prototype.write=function(r,n,i,a){if(void 0===n)a="utf8",i=this.length,n=0;else if(void 0===i&&"string"==typeof n)a=n,i=this.length,n=0;else{if(!isFinite(n))throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n>>>=0,isFinite(i)?(i>>>=0,void 0===a&&(a="utf8")):(a=i,i=void 0)}var o,s,l,c,u,f,h,p,d,m,g=this.length-n;if((void 0===i||i>g)&&(i=g),r.length>0&&(i<0||n<0)||n>this.length)throw RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var v=!1;;)switch(a){case"hex":return function(r,n,i,a){i=Number(i)||0;var o=r.length-i;a?(a=Number(a))>o&&(a=o):a=o;var s=n.length;a>s/2&&(a=s/2);for(var l=0;l<a;++l){var c=parseInt(n.substr(2*l,2),16);if(c!=c)break;r[i+l]=c}return l}(this,r,n,i);case"utf8":case"utf-8":return u=n,f=i,S(A(r,this.length-u),this,u,f);case"ascii":case"latin1":case"binary":return o=this,s=r,l=n,c=i,S(function(r){for(var n=[],i=0;i<r.length;++i)n.push(255&r.charCodeAt(i));return n}(s),o,l,c);case"base64":return h=n,p=i,S(M(r),this,h,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d=n,m=i,S(function(r,n){for(var i,a,o=[],s=0;s<r.length&&!((n-=2)<0);++s)a=(i=r.charCodeAt(s))>>8,o.push(i%256),o.push(a);return o}(r,this.length-d),this,d,m);default:if(v)throw TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),v=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(r,n){var i=this.length;(r=~~r)<0?(r+=i)<0&&(r=0):r>i&&(r=i),(n=void 0===n?i:~~n)<0?(n+=i)<0&&(n=0):n>i&&(n=i),n<r&&(n=r);var a=this.subarray(r,n);return a.__proto__=s.prototype,a},s.prototype.readUIntLE=function(r,n,i){r>>>=0,n>>>=0,i||x(r,n,this.length);for(var a=this[r],o=1,s=0;++s<n&&(o*=256);)a+=this[r+s]*o;return a},s.prototype.readUIntBE=function(r,n,i){r>>>=0,n>>>=0,i||x(r,n,this.length);for(var a=this[r+--n],o=1;n>0&&(o*=256);)a+=this[r+--n]*o;return a},s.prototype.readUInt8=function(r,n){return r>>>=0,n||x(r,1,this.length),this[r]},s.prototype.readUInt16LE=function(r,n){return r>>>=0,n||x(r,2,this.length),this[r]|this[r+1]<<8},s.prototype.readUInt16BE=function(r,n){return r>>>=0,n||x(r,2,this.length),this[r]<<8|this[r+1]},s.prototype.readUInt32LE=function(r,n){return r>>>=0,n||x(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+16777216*this[r+3]},s.prototype.readUInt32BE=function(r,n){return r>>>=0,n||x(r,4,this.length),16777216*this[r]+(this[r+1]<<16|this[r+2]<<8|this[r+3])},s.prototype.readIntLE=function(r,n,i){r>>>=0,n>>>=0,i||x(r,n,this.length);for(var a=this[r],o=1,s=0;++s<n&&(o*=256);)a+=this[r+s]*o;return a>=(o*=128)&&(a-=Math.pow(2,8*n)),a},s.prototype.readIntBE=function(r,n,i){r>>>=0,n>>>=0,i||x(r,n,this.length);for(var a=n,o=1,s=this[r+--a];a>0&&(o*=256);)s+=this[r+--a]*o;return s>=(o*=128)&&(s-=Math.pow(2,8*n)),s},s.prototype.readInt8=function(r,n){return r>>>=0,n||x(r,1,this.length),128&this[r]?-1*(255-this[r]+1):this[r]},s.prototype.readInt16LE=function(r,n){r>>>=0,n||x(r,2,this.length);var i=this[r]|this[r+1]<<8;return 32768&i?4294901760|i:i},s.prototype.readInt16BE=function(r,n){r>>>=0,n||x(r,2,this.length);var i=this[r+1]|this[r]<<8;return 32768&i?4294901760|i:i},s.prototype.readInt32LE=function(r,n){return r>>>=0,n||x(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},s.prototype.readInt32BE=function(r,n){return r>>>=0,n||x(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},s.prototype.readFloatLE=function(r,n){return r>>>=0,n||x(r,4,this.length),a.read(this,r,!0,23,4)},s.prototype.readFloatBE=function(r,n){return r>>>=0,n||x(r,4,this.length),a.read(this,r,!1,23,4)},s.prototype.readDoubleLE=function(r,n){return r>>>=0,n||x(r,8,this.length),a.read(this,r,!0,52,8)},s.prototype.readDoubleBE=function(r,n){return r>>>=0,n||x(r,8,this.length),a.read(this,r,!1,52,8)},s.prototype.writeUIntLE=function(r,n,i,a){r=+r,n>>>=0,i>>>=0,a||b(this,r,n,i,Math.pow(2,8*i)-1,0);var o=1,s=0;for(this[n]=255&r;++s<i&&(o*=256);)this[n+s]=r/o&255;return n+i},s.prototype.writeUIntBE=function(r,n,i,a){r=+r,n>>>=0,i>>>=0,a||b(this,r,n,i,Math.pow(2,8*i)-1,0);var o=i-1,s=1;for(this[n+o]=255&r;--o>=0&&(s*=256);)this[n+o]=r/s&255;return n+i},s.prototype.writeUInt8=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,1,255,0),this[n]=255&r,n+1},s.prototype.writeUInt16LE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,2,65535,0),this[n]=255&r,this[n+1]=r>>>8,n+2},s.prototype.writeUInt16BE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,2,65535,0),this[n]=r>>>8,this[n+1]=255&r,n+2},s.prototype.writeUInt32LE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,4,4294967295,0),this[n+3]=r>>>24,this[n+2]=r>>>16,this[n+1]=r>>>8,this[n]=255&r,n+4},s.prototype.writeUInt32BE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,4,4294967295,0),this[n]=r>>>24,this[n+1]=r>>>16,this[n+2]=r>>>8,this[n+3]=255&r,n+4},s.prototype.writeIntLE=function(r,n,i,a){if(r=+r,n>>>=0,!a){var o=Math.pow(2,8*i-1);b(this,r,n,i,o-1,-o)}var s=0,l=1,c=0;for(this[n]=255&r;++s<i&&(l*=256);)r<0&&0===c&&0!==this[n+s-1]&&(c=1),this[n+s]=(r/l>>0)-c&255;return n+i},s.prototype.writeIntBE=function(r,n,i,a){if(r=+r,n>>>=0,!a){var o=Math.pow(2,8*i-1);b(this,r,n,i,o-1,-o)}var s=i-1,l=1,c=0;for(this[n+s]=255&r;--s>=0&&(l*=256);)r<0&&0===c&&0!==this[n+s+1]&&(c=1),this[n+s]=(r/l>>0)-c&255;return n+i},s.prototype.writeInt8=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,1,127,-128),r<0&&(r=255+r+1),this[n]=255&r,n+1},s.prototype.writeInt16LE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,2,32767,-32768),this[n]=255&r,this[n+1]=r>>>8,n+2},s.prototype.writeInt16BE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,2,32767,-32768),this[n]=r>>>8,this[n+1]=255&r,n+2},s.prototype.writeInt32LE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,4,2147483647,-2147483648),this[n]=255&r,this[n+1]=r>>>8,this[n+2]=r>>>16,this[n+3]=r>>>24,n+4},s.prototype.writeInt32BE=function(r,n,i){return r=+r,n>>>=0,i||b(this,r,n,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[n]=r>>>24,this[n+1]=r>>>16,this[n+2]=r>>>8,this[n+3]=255&r,n+4},s.prototype.writeFloatLE=function(r,n,i){return w(this,r,n,!0,i)},s.prototype.writeFloatBE=function(r,n,i){return w(this,r,n,!1,i)},s.prototype.writeDoubleLE=function(r,n,i){return T(this,r,n,!0,i)},s.prototype.writeDoubleBE=function(r,n,i){return T(this,r,n,!1,i)},s.prototype.copy=function(r,n,i,a){if(!s.isBuffer(r))throw TypeError("argument should be a Buffer");if(i||(i=0),a||0===a||(a=this.length),n>=r.length&&(n=r.length),n||(n=0),a>0&&a<i&&(a=i),a===i||0===r.length||0===this.length)return 0;if(n<0)throw RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw RangeError("Index out of range");if(a<0)throw RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),r.length-n<a-i&&(a=r.length-n+i);var o=a-i;if(this===r&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(n,i,a);else if(this===r&&i<n&&n<a)for(var l=o-1;l>=0;--l)r[l+n]=this[l+i];else Uint8Array.prototype.set.call(r,this.subarray(i,a),n);return o},s.prototype.fill=function(r,n,i,a){if("string"==typeof r){if("string"==typeof n?(a=n,n=0,i=this.length):"string"==typeof i&&(a=i,i=this.length),void 0!==a&&"string"!=typeof a)throw TypeError("encoding must be a string");if("string"==typeof a&&!s.isEncoding(a))throw TypeError("Unknown encoding: "+a);if(1===r.length){var o,l=r.charCodeAt(0);("utf8"===a&&l<128||"latin1"===a)&&(r=l)}}else"number"==typeof r&&(r&=255);if(n<0||this.length<n||this.length<i)throw RangeError("Out of range index");if(i<=n)return this;if(n>>>=0,i=void 0===i?this.length:i>>>0,r||(r=0),"number"==typeof r)for(o=n;o<i;++o)this[o]=r;else{var c=s.isBuffer(r)?r:s.from(r,a),u=c.length;if(0===u)throw TypeError('The value "'+r+'" is invalid for argument "value"');for(o=0;o<i-n;++o)this[o+n]=c[o%u]}return this};var k=/[^+/0-9A-Za-z-_]/g;function A(r,n){var i;n=n||1/0;for(var a=r.length,o=null,s=[],l=0;l<a;++l){if((i=r.charCodeAt(l))>55295&&i<57344){if(!o){if(i>56319||l+1===a){(n-=3)>-1&&s.push(239,191,189);continue}o=i;continue}if(i<56320){(n-=3)>-1&&s.push(239,191,189),o=i;continue}i=65536+(o-55296<<10|i-56320)}else o&&(n-=3)>-1&&s.push(239,191,189);if(o=null,i<128){if((n-=1)<0)break;s.push(i)}else if(i<2048){if((n-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((n-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw Error("Invalid code point");if((n-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function M(r){return n.toByteArray(function(r){if((r=(r=r.split("=")[0]).trim().replace(k,"")).length<2)return"";for(;r.length%4!=0;)r+="=";return r}(r))}function S(r,n,i,a){for(var o=0;o<a&&!(o+i>=n.length||o>=r.length);++o)n[o+i]=r[o];return o}function E(r,n){return r instanceof n||null!=r&&null!=r.constructor&&null!=r.constructor.name&&r.constructor.name===n.name}}).call(this)}).call(this,r("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(r,n,i){i.read=function(r,n,i,a,o){var s,l,c=8*o-a-1,u=(1<<c)-1,f=u>>1,h=-7,p=i?o-1:0,d=i?-1:1,m=r[n+p];for(p+=d,s=m&(1<<-h)-1,m>>=-h,h+=c;h>0;s=256*s+r[n+p],p+=d,h-=8);for(l=s&(1<<-h)-1,s>>=-h,h+=a;h>0;l=256*l+r[n+p],p+=d,h-=8);if(0===s)s=1-f;else{if(s===u)return l?NaN:1/0*(m?-1:1);l+=Math.pow(2,a),s-=f}return(m?-1:1)*l*Math.pow(2,s-a)},i.write=function(r,n,i,a,o,s){var l,c,u,f=8*s-o-1,h=(1<<f)-1,p=h>>1,d=23===o?5960464477539062e-23:0,m=a?0:s-1,g=a?1:-1,v=n<0||0===n&&1/n<0?1:0;for(isNaN(n=Math.abs(n))||n===1/0?(c=isNaN(n)?1:0,l=h):(l=Math.floor(Math.log(n)/Math.LN2),n*(u=Math.pow(2,-l))<1&&(l--,u*=2),(n+=l+p>=1?d/u:d*Math.pow(2,1-p))*u>=2&&(l++,u/=2),l+p>=h?(c=0,l=h):l+p>=1?(c=(n*u-1)*Math.pow(2,o),l+=p):(c=n*Math.pow(2,p-1)*Math.pow(2,o),l=0));o>=8;r[i+m]=255&c,m+=g,c/=256,o-=8);for(l=l<<o|c,f+=o;f>0;r[i+m]=255&l,m+=g,l/=256,f-=8);r[i+m-g]|=128*v}},{}],5:[function(r,n,i){var a,o,s=n.exports={};function l(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function u(r){if(a===setTimeout)return setTimeout(r,0);if((a===l||!a)&&setTimeout)return a=setTimeout,setTimeout(r,0);try{return a(r,0)}catch(n){try{return a.call(null,r,0)}catch(n){return a.call(this,r,0)}}}!function(){try{a="function"==typeof setTimeout?setTimeout:l}catch(r){a=l}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(r){o=c}}();var f,h=[],p=!1,d=-1;function m(){p&&f&&(p=!1,f.length?h=f.concat(h):d=-1,h.length&&g())}function g(){if(!p){var r=u(m);p=!0;for(var n=h.length;n;){for(f=h,h=[];++d<n;)f&&f[d].run();d=-1,n=h.length}f=null,p=!1,function(r){if(o===clearTimeout)return clearTimeout(r);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(r);try{o(r)}catch(n){try{return o.call(null,r)}catch(n){return o.call(this,r)}}}(r)}}function v(r,n){this.fun=r,this.array=n}function y(){}s.nextTick=function(r){var n=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)n[i-1]=arguments[i];h.push(new v(r,n)),1!==h.length||p||u(g)},v.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=y,s.addListener=y,s.once=y,s.off=y,s.removeListener=y,s.removeAllListeners=y,s.emit=y,s.prependListener=y,s.prependOnceListener=y,s.listeners=function(r){return[]},s.binding=function(r){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(r){throw Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],6:[function(r,n,i){n.exports={alpha_shape:r("alpha-shape"),convex_hull:r("convex-hull"),delaunay_triangulate:r("delaunay-triangulate"),gl_cone3d:r("gl-cone3d"),gl_error3d:r("gl-error3d"),gl_heatmap2d:r("gl-heatmap2d"),gl_line3d:r("gl-line3d"),gl_mesh3d:r("gl-mesh3d"),gl_plot2d:r("gl-plot2d"),gl_plot3d:r("gl-plot3d"),gl_pointcloud2d:r("gl-pointcloud2d"),gl_scatter3d:r("gl-scatter3d"),gl_select_box:r("gl-select-box"),gl_spikes2d:r("gl-spikes2d"),gl_streamtube3d:r("gl-streamtube3d"),gl_surface3d:r("gl-surface3d"),ndarray:r("ndarray"),ndarray_linear_interpolate:r("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(r,n,i){"use strict";n.exports=function(r){var n=(r=r||{}).eye||[0,0,1],i=r.center||[0,0,0],c=r.up||[0,1,0],u=r.distanceLimits||[0,1/0],f=r.mode||"turntable",h=a(),p=o(),d=s();return h.setDistanceLimits(u[0],u[1]),h.lookAt(0,n,i,c),p.setDistanceLimits(u[0],u[1]),p.lookAt(0,n,i,c),d.setDistanceLimits(u[0],u[1]),d.lookAt(0,n,i,c),new l({turntable:h,orbit:p,matrix:d},f)};var a=r("turntable-camera-controller"),o=r("orbit-camera-controller"),s=r("matrix-camera-controller");function l(r,n){this._controllerNames=Object.keys(r),this._controllerList=this._controllerNames.map(function(n){return r[n]}),this._mode=n,this._active=r[n],this._active||(this._mode="turntable",this._active=r.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var c=l.prototype;c.flush=function(r){for(var n=this._controllerList,i=0;i<n.length;++i)n[i].flush(r)},c.idle=function(r){for(var n=this._controllerList,i=0;i<n.length;++i)n[i].idle(r)},c.lookAt=function(r,n,i,a){for(var o=this._controllerList,s=0;s<o.length;++s)o[s].lookAt(r,n,i,a)},c.rotate=function(r,n,i,a){for(var o=this._controllerList,s=0;s<o.length;++s)o[s].rotate(r,n,i,a)},c.pan=function(r,n,i,a){for(var o=this._controllerList,s=0;s<o.length;++s)o[s].pan(r,n,i,a)},c.translate=function(r,n,i,a){for(var o=this._controllerList,s=0;s<o.length;++s)o[s].translate(r,n,i,a)},c.setMatrix=function(r,n){for(var i=this._controllerList,a=0;a<i.length;++a)i[a].setMatrix(r,n)},c.setDistanceLimits=function(r,n){for(var i=this._controllerList,a=0;a<i.length;++a)i[a].setDistanceLimits(r,n)},c.setDistance=function(r,n){for(var i=this._controllerList,a=0;a<i.length;++a)i[a].setDistance(r,n)},c.recalcMatrix=function(r){this._active.recalcMatrix(r)},c.getDistance=function(r){return this._active.getDistance(r)},c.getDistanceLimits=function(r){return this._active.getDistanceLimits(r)},c.lastT=function(){return this._active.lastT()},c.setMode=function(r){if(r!==this._mode){var n=this._controllerNames.indexOf(r);if(!(n<0)){var i=this._active,a=this._controllerList[n],o=Math.max(i.lastT(),a.lastT());i.recalcMatrix(o),a.setMatrix(o,i.computedMatrix),this._active=a,this._mode=r,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},c.getMode=function(){return this._mode}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(r,n,i){"use strict";var a="undefined"==typeof WeakMap?r("weak-map"):WeakMap,o=r("gl-buffer"),s=r("gl-vao"),l=new a;n.exports=function(r){var n=l.get(r),i=n&&(n._triangleBuffer.handle||n._triangleBuffer.buffer);if(!i||!r.isBuffer(i)){var a=o(r,new Float32Array([-1,-1,-1,4,4,-1]));(n=s(r,[{buffer:a,type:r.FLOAT,size:2}]))._triangleBuffer=a,l.set(r,n)}n.bind(),r.drawArrays(r.TRIANGLES,0,3),n.unbind()}},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(r,n,i){var a=r("pad-left");n.exports=function(r,n,i){n="number"==typeof n?n:1,i=i||": ";var o=r.split(/\r?\n/),s=String(o.length+n-1).length;return o.map(function(r,o){var l=o+n,c=String(l).length;return a(l,s-c)+i+r}).join("\n")}},{"pad-left":264}],10:[function(r,n,i){"use strict";n.exports=function(r){var n=r.length;if(0===n)return[];if(1===n)return[0];for(var i=r[0].length,o=[r[0]],s=[0],l=1;l<n;++l)if(o.push(r[l]),function(r,n){for(var i=Array(n+1),o=0;o<r.length;++o)i[o]=r[o];for(o=0;o<=r.length;++o){for(var s=r.length;s<=n;++s){for(var l=Array(n),c=0;c<n;++c)l[c]=Math.pow(s+1-o,c);i[s]=l}if(a.apply(void 0,i))return!0}return!1}(o,i)){if(s.push(l),s.length===i+1)break}else o.pop();return s};var a=r("robust-orientation")},{"robust-orientation":284}],11:[function(r,n,i){"use strict";n.exports=function(r,n){return a(n).filter(function(i){for(var a=Array(i.length),s=0;s<i.length;++s)a[s]=n[i[s]];return o(a)*r<1})};var a=r("delaunay-triangulate"),o=r("circumradius")},{circumradius:49,"delaunay-triangulate":63}],12:[function(r,n,i){n.exports=function(r,n){return o(a(r,n))};var a=r("alpha-complex"),o=r("simplicial-complex-boundary")},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(r,n,i){n.exports=function(r){return atob(r)}},{}],14:[function(r,n,i){"use strict";n.exports=function(r,n){for(var i=n.length,s=Array(i+1),l=0;l<i;++l){for(var c=Array(i+1),u=0;u<=i;++u)c[u]=r[u][l];s[l]=c}for(l=0,s[i]=Array(i+1);l<=i;++l)s[i][l]=1;var f=Array(i+1);for(l=0;l<i;++l)f[l]=n[l];f[i]=1;var h=a(s,f),p=o(h[i+1]);0===p&&(p=1);var d=Array(i+1);for(l=0;l<=i;++l)d[l]=o(h[l])/p;return d};var a=r("robust-linear-solve");function o(r){for(var n=0,i=0;i<r.length;++i)n+=r[i];return n}},{"robust-linear-solve":283}],15:[function(r,n,i){"use strict";var a=r("./lib/rationalize");n.exports=function(r,n){return a(r[0].mul(n[1]).add(n[0].mul(r[1])),r[1].mul(n[1]))}},{"./lib/rationalize":25}],16:[function(r,n,i){"use strict";n.exports=function(r,n){return r[0].mul(n[1]).cmp(n[0].mul(r[1]))}},{}],17:[function(r,n,i){"use strict";var a=r("./lib/rationalize");n.exports=function(r,n){return a(r[0].mul(n[1]),r[1].mul(n[0]))}},{"./lib/rationalize":25}],18:[function(r,n,i){"use strict";var a=r("./is-rat"),o=r("./lib/is-bn"),s=r("./lib/num-to-bn"),l=r("./lib/str-to-bn"),c=r("./lib/rationalize"),u=r("./div");n.exports=function r(n,i){if(a(n))return i?u(n,r(i)):[n[0].clone(),n[1].clone()];var f,h,p=0;if(o(n))f=n.clone();else if("string"==typeof n)f=l(n);else{if(0===n)return[s(0),s(1)];if(n===Math.floor(n))f=s(n);else{for(;n!==Math.floor(n);)n*=1157920892373162e62,p-=256;f=s(n)}}if(a(i))f.mul(i[1]),h=i[0].clone();else if(o(i))h=i.clone();else if("string"==typeof i)h=l(i);else if(i){if(i===Math.floor(i))h=s(i);else{for(;i!==Math.floor(i);)i*=1157920892373162e62,p+=256;h=s(i)}}else h=s(1);return p>0?f=f.ushln(p):p<0&&(h=h.ushln(-p)),c(f,h)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(r,n,i){"use strict";var a=r("./lib/is-bn");n.exports=function(r){return Array.isArray(r)&&2===r.length&&a(r[0])&&a(r[1])}},{"./lib/is-bn":23}],20:[function(r,n,i){"use strict";var a=r("bn.js");n.exports=function(r){return r.cmp(new a(0))}},{"bn.js":33}],21:[function(r,n,i){"use strict";var a=r("./bn-sign");n.exports=function(r){var n=r.length,i=r.words,o=0;if(1===n)o=i[0];else if(2===n)o=i[0]+67108864*i[1];else for(var s=0;s<n;s++)o+=i[s]*Math.pow(67108864,s);return a(r)*o}},{"./bn-sign":20}],22:[function(r,n,i){"use strict";var a=r("double-bits"),o=r("bit-twiddle").countTrailingZeros;n.exports=function(r){var n=o(a.lo(r));if(n<32)return n;var i=o(a.hi(r));return i>20?52:i+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(r,n,i){"use strict";r("bn.js"),n.exports=function(r){return r&&"object"==typeof r&&!!r.words}},{"bn.js":33}],24:[function(r,n,i){"use strict";var a=r("bn.js"),o=r("double-bits");n.exports=function(r){var n=o.exponent(r);return n<52?new a(r):new a(r*Math.pow(2,52-n)).ushln(n-52)}},{"bn.js":33,"double-bits":64}],25:[function(r,n,i){"use strict";var a=r("./num-to-bn"),o=r("./bn-sign");n.exports=function(r,n){var i=o(r),s=o(n);if(0===i)return[a(0),a(1)];if(0===s)return[a(0),a(0)];s<0&&(r=r.neg(),n=n.neg());var l=r.gcd(n);return l.cmpn(1)?[r.div(l),n.div(l)]:[r,n]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(r,n,i){"use strict";var a=r("bn.js");n.exports=function(r){return new a(r)}},{"bn.js":33}],27:[function(r,n,i){"use strict";var a=r("./lib/rationalize");n.exports=function(r,n){return a(r[0].mul(n[0]),r[1].mul(n[1]))}},{"./lib/rationalize":25}],28:[function(r,n,i){"use strict";var a=r("./lib/bn-sign");n.exports=function(r){return a(r[0])*a(r[1])}},{"./lib/bn-sign":20}],29:[function(r,n,i){"use strict";var a=r("./lib/rationalize");n.exports=function(r,n){return a(r[0].mul(n[1]).sub(r[1].mul(n[0])),r[1].mul(n[1]))}},{"./lib/rationalize":25}],30:[function(r,n,i){"use strict";var a=r("./lib/bn-to-num"),o=r("./lib/ctz");n.exports=function(r){var n=r[0],i=r[1];if(0===n.cmpn(0))return 0;var s=n.abs().divmod(i.abs()),l=a(s.div),c=s.mod,u=n.negative!==i.negative?-1:1;if(0===c.cmpn(0))return u*l;if(l){var f=o(l)+4,h=a(c.ushln(f).divRound(i));return u*(l+h*Math.pow(2,-f))}var p=i.bitLength()-c.bitLength()+53;return h=a(c.ushln(p).divRound(i)),p<1023?u*h*Math.pow(2,-p):u*(h*=11125369292536007e-324)*Math.pow(2,1023-p)}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(r,n,i){"use strict";function a(r,n,i,a,o){for(var s=o+1;a<=o;){var l=a+o>>>1,c=r[l];(void 0!==i?i(c,n):c-n)>=0?(s=l,o=l-1):a=l+1}return s}function o(r,n,i,a,o){for(var s=o+1;a<=o;){var l=a+o>>>1,c=r[l];(void 0!==i?i(c,n):c-n)>0?(s=l,o=l-1):a=l+1}return s}function s(r,n,i,a,o){for(var s=a-1;a<=o;){var l=a+o>>>1,c=r[l];(void 0!==i?i(c,n):c-n)<0?(s=l,a=l+1):o=l-1}return s}function l(r,n,i,a,o){for(var s=a-1;a<=o;){var l=a+o>>>1,c=r[l];(void 0!==i?i(c,n):c-n)<=0?(s=l,a=l+1):o=l-1}return s}function c(r,n,i,a,o){for(;a<=o;){var s=a+o>>>1,l=r[s],c=void 0!==i?i(l,n):l-n;if(0===c)return s;c<=0?a=s+1:o=s-1}return -1}function u(r,n,i,a,o,s){return"function"==typeof i?s(r,n,i,void 0===a?0:0|a,void 0===o?r.length-1:0|o):s(r,n,void 0,void 0===i?0:0|i,void 0===a?r.length-1:0|a)}n.exports={ge:function(r,n,i,o,s){return u(r,n,i,o,s,a)},gt:function(r,n,i,a,s){return u(r,n,i,a,s,o)},lt:function(r,n,i,a,o){return u(r,n,i,a,o,s)},le:function(r,n,i,a,o){return u(r,n,i,a,o,l)},eq:function(r,n,i,a,o){return u(r,n,i,a,o,c)}}},{}],32:[function(r,n,i){"use strict";function a(r){var n=32;return(r&=-r)&&n--,65535&r&&(n-=16),16711935&r&&(n-=8),252645135&r&&(n-=4),858993459&r&&(n-=2),1431655765&r&&(n-=1),n}i.INT_BITS=32,i.INT_MAX=2147483647,i.INT_MIN=-2147483648,i.sign=function(r){return(r>0)-(r<0)},i.abs=function(r){var n=r>>31;return(r^n)-n},i.min=function(r,n){return n^(r^n)&-(r<n)},i.max=function(r,n){return r^(r^n)&-(r<n)},i.isPow2=function(r){return!(r&r-1||!r)},i.log2=function(r){var n,i;return n=(r>65535)<<4,n|=i=((r>>>=n)>255)<<3,n|=i=((r>>>=i)>15)<<2,(n|=i=((r>>>=i)>3)<<1)|(r>>>=i)>>1},i.log10=function(r){return r>=1e9?9:r>=1e8?8:r>=1e7?7:r>=1e6?6:r>=1e5?5:r>=1e4?4:r>=1e3?3:r>=100?2:r>=10?1:0},i.popCount=function(r){return 16843009*((r=(858993459&(r-=r>>>1&1431655765))+(r>>>2&858993459))+(r>>>4)&252645135)>>>24},i.countTrailingZeros=a,i.nextPow2=function(r){return r+=0===r,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,(r|=r>>>16)+1},i.prevPow2=function(r){return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,(r|=r>>>16)-(r>>>1)},i.parity=function(r){return r^=r>>>16,r^=r>>>8,r^=r>>>4,27030>>>(r&=15)&1};var o=Array(256);(function(r){for(var n=0;n<256;++n){var i=n,a=n,o=7;for(i>>>=1;i;i>>>=1)a<<=1,a|=1&i,--o;r[n]=a<<o&255}})(o),i.reverse=function(r){return o[255&r]<<24|o[r>>>8&255]<<16|o[r>>>16&255]<<8|o[r>>>24&255]},i.interleave2=function(r,n){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r&=65535)|r<<8))|r<<4))|r<<2))|r<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n&=65535)|n<<8))|n<<4))|n<<2))|n<<1))<<1},i.deinterleave2=function(r,n){return(r=65535&((r=16711935&((r=252645135&((r=858993459&((r=r>>>n&1431655765)|r>>>1))|r>>>2))|r>>>4))|r>>>16))<<16>>16},i.interleave3=function(r,n,i){return(r=1227133513&((r=3272356035&((r=251719695&((r=4278190335&((r&=1023)|r<<16))|r<<8))|r<<4))|r<<2)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<1)|(i=1227133513&((i=3272356035&((i=251719695&((i=4278190335&((i&=1023)|i<<16))|i<<8))|i<<4))|i<<2))<<2},i.deinterleave3=function(r,n){return(r=1023&((r=4278190335&((r=251719695&((r=3272356035&((r=r>>>n&1227133513)|r>>>2))|r>>>4))|r>>>8))|r>>>16))<<22>>22},i.nextCombination=function(r){var n=r|r-1;return n+1|(~n&-~n)-1>>>a(r)+1}},{}],33:[function(r,n,i){!function(n,i){"use strict";function a(r,n){if(!r)throw Error(n||"Assertion failed")}function o(r,n){r.super_=n;var i=function(){};i.prototype=n.prototype,r.prototype=new i,r.prototype.constructor=r}function s(r,n,i){if(s.isBN(r))return r;this.negative=0,this.words=null,this.length=0,this.red=null,null!==r&&("le"!==n&&"be"!==n||(i=n,n=10),this._init(r||0,n||10,i||"be"))}"object"==typeof n?n.exports=s:i.BN=s,s.BN=s,s.wordSize=26;try{f="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r("buffer").Buffer}catch(r){}function l(r,n){var i=r.charCodeAt(n);return i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:i-48&15}function c(r,n,i){var a=l(r,i);return i-1>=n&&(a|=l(r,i-1)<<4),a}function u(r,n,i,a){for(var o=0,s=Math.min(r.length,i),l=n;l<s;l++){var c=r.charCodeAt(l)-48;o*=a,o+=c>=49?c-49+10:c>=17?c-17+10:c}return o}s.isBN=function(r){return r instanceof s||null!==r&&"object"==typeof r&&r.constructor.wordSize===s.wordSize&&Array.isArray(r.words)},s.max=function(r,n){return r.cmp(n)>0?r:n},s.min=function(r,n){return 0>r.cmp(n)?r:n},s.prototype._init=function(r,n,i){if("number"==typeof r)return this._initNumber(r,n,i);if("object"==typeof r)return this._initArray(r,n,i);"hex"===n&&(n=16),a(n===(0|n)&&n>=2&&n<=36);var o=0;"-"===(r=r.toString().replace(/\s+/g,""))[0]&&(o++,this.negative=1),o<r.length&&(16===n?this._parseHex(r,o,i):(this._parseBase(r,n,o),"le"===i&&this._initArray(this.toArray(),n,i)))},s.prototype._initNumber=function(r,n,i){r<0&&(this.negative=1,r=-r),r<67108864?(this.words=[67108863&r],this.length=1):r<4503599627370496?(this.words=[67108863&r,r/67108864&67108863],this.length=2):(a(r<9007199254740992),this.words=[67108863&r,r/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),n,i)},s.prototype._initArray=function(r,n,i){if(a("number"==typeof r.length),r.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(r.length/3),this.words=Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var s,l,c=0;if("be"===i)for(o=r.length-1,s=0;o>=0;o-=3)l=r[o]|r[o-1]<<8|r[o-2]<<16,this.words[s]|=l<<c&67108863,this.words[s+1]=l>>>26-c&67108863,(c+=24)>=26&&(c-=26,s++);else if("le"===i)for(o=0,s=0;o<r.length;o+=3)l=r[o]|r[o+1]<<8|r[o+2]<<16,this.words[s]|=l<<c&67108863,this.words[s+1]=l>>>26-c&67108863,(c+=24)>=26&&(c-=26,s++);return this.strip()},s.prototype._parseHex=function(r,n,i){this.length=Math.ceil((r.length-n)/6),this.words=Array(this.length);for(var a=0;a<this.length;a++)this.words[a]=0;var o,s=0,l=0;if("be"===i)for(a=r.length-1;a>=n;a-=2)o=c(r,n,a)<<s,this.words[l]|=67108863&o,s>=18?(s-=18,l+=1,this.words[l]|=o>>>26):s+=8;else for(a=(r.length-n)%2==0?n+1:n;a<r.length;a+=2)o=c(r,n,a)<<s,this.words[l]|=67108863&o,s>=18?(s-=18,l+=1,this.words[l]|=o>>>26):s+=8;this.strip()},s.prototype._parseBase=function(r,n,i){this.words=[0],this.length=1;for(var a=0,o=1;o<=67108863;o*=n)a++;a--,o=o/n|0;for(var s=r.length-i,l=s%a,c=Math.min(s,s-l)+i,f=0,h=i;h<c;h+=a)f=u(r,h,h+a,n),this.imuln(o),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(0!==l){var p=1;for(f=u(r,h,r.length,n),h=0;h<l;h++)p*=n;this.imuln(p),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},s.prototype.copy=function(r){r.words=Array(this.length);for(var n=0;n<this.length;n++)r.words[n]=this.words[n];r.length=this.length,r.negative=this.negative,r.red=this.red},s.prototype.clone=function(){var r=new s(null);return this.copy(r),r},s.prototype._expand=function(r){for(;this.length<r;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var f,h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],p=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function m(r,n,i){i.negative=n.negative^r.negative;var a=r.length+n.length|0;i.length=a,a=a-1|0;var o=0|r.words[0],s=0|n.words[0],l=o*s,c=67108863&l,u=l/67108864|0;i.words[0]=c;for(var f=1;f<a;f++){for(var h=u>>>26,p=67108863&u,d=Math.min(f,n.length-1),m=Math.max(0,f-r.length+1);m<=d;m++){var g=f-m|0;h+=(l=(o=0|r.words[g])*(s=0|n.words[m])+p)/67108864|0,p=67108863&l}i.words[f]=0|p,u=0|h}return 0!==u?i.words[f]=0|u:i.length--,i.strip()}s.prototype.toString=function(r,n){var i;if(n=0|n||1,16===(r=r||10)||"hex"===r){i="";for(var o=0,s=0,l=0;l<this.length;l++){var c=this.words[l],u=(16777215&(c<<o|s)).toString(16);i=0!=(s=c>>>24-o&16777215)||l!==this.length-1?h[6-u.length]+u+i:u+i,(o+=2)>=26&&(o-=26,l--)}for(0!==s&&(i=s.toString(16)+i);i.length%n!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(r===(0|r)&&r>=2&&r<=36){var f=p[r],m=d[r];i="";var g=this.clone();for(g.negative=0;!g.isZero();){var v=g.modn(m).toString(r);i=(g=g.idivn(m)).isZero()?v+i:h[f-v.length]+v+i}for(this.isZero()&&(i="0"+i);i.length%n!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}a(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var r=this.words[0];return 2===this.length?r+=67108864*this.words[1]:3===this.length&&1===this.words[2]?r+=4503599627370496+67108864*this.words[1]:this.length>2&&a(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-r:r},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(r,n){return a(void 0!==f),this.toArrayLike(f,r,n)},s.prototype.toArray=function(r,n){return this.toArrayLike(Array,r,n)},s.prototype.toArrayLike=function(r,n,i){var o=this.byteLength(),s=i||Math.max(1,o);a(o<=s,"byte array longer than desired length"),a(s>0,"Requested array length <= 0"),this.strip();var l,c,u=new r(s),f=this.clone();if("le"===n){for(c=0;!f.isZero();c++)l=f.andln(255),f.iushrn(8),u[c]=l;for(;c<s;c++)u[c]=0}else{for(c=0;c<s-o;c++)u[c]=0;for(c=0;!f.isZero();c++)l=f.andln(255),f.iushrn(8),u[s-c-1]=l}return u},Math.clz32?s.prototype._countBits=function(r){return 32-Math.clz32(r)}:s.prototype._countBits=function(r){var n=r,i=0;return n>=4096&&(i+=13,n>>>=13),n>=64&&(i+=7,n>>>=7),n>=8&&(i+=4,n>>>=4),n>=2&&(i+=2,n>>>=2),i+n},s.prototype._zeroBits=function(r){if(0===r)return 26;var n=r,i=0;return 0==(8191&n)&&(i+=13,n>>>=13),0==(127&n)&&(i+=7,n>>>=7),0==(15&n)&&(i+=4,n>>>=4),0==(3&n)&&(i+=2,n>>>=2),0==(1&n)&&i++,i},s.prototype.bitLength=function(){var r=this.words[this.length-1],n=this._countBits(r);return 26*(this.length-1)+n},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var r=0,n=0;n<this.length;n++){var i=this._zeroBits(this.words[n]);if(r+=i,26!==i)break}return r},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(r){return 0!==this.negative?this.abs().inotn(r).iaddn(1):this.clone()},s.prototype.fromTwos=function(r){return this.testn(r-1)?this.notn(r).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(r){for(;this.length<r.length;)this.words[this.length++]=0;for(var n=0;n<r.length;n++)this.words[n]=this.words[n]|r.words[n];return this.strip()},s.prototype.ior=function(r){return a(0==(this.negative|r.negative)),this.iuor(r)},s.prototype.or=function(r){return this.length>r.length?this.clone().ior(r):r.clone().ior(this)},s.prototype.uor=function(r){return this.length>r.length?this.clone().iuor(r):r.clone().iuor(this)},s.prototype.iuand=function(r){var n;n=this.length>r.length?r:this;for(var i=0;i<n.length;i++)this.words[i]=this.words[i]&r.words[i];return this.length=n.length,this.strip()},s.prototype.iand=function(r){return a(0==(this.negative|r.negative)),this.iuand(r)},s.prototype.and=function(r){return this.length>r.length?this.clone().iand(r):r.clone().iand(this)},s.prototype.uand=function(r){return this.length>r.length?this.clone().iuand(r):r.clone().iuand(this)},s.prototype.iuxor=function(r){var n,i;this.length>r.length?(n=this,i=r):(n=r,i=this);for(var a=0;a<i.length;a++)this.words[a]=n.words[a]^i.words[a];if(this!==n)for(;a<n.length;a++)this.words[a]=n.words[a];return this.length=n.length,this.strip()},s.prototype.ixor=function(r){return a(0==(this.negative|r.negative)),this.iuxor(r)},s.prototype.xor=function(r){return this.length>r.length?this.clone().ixor(r):r.clone().ixor(this)},s.prototype.uxor=function(r){return this.length>r.length?this.clone().iuxor(r):r.clone().iuxor(this)},s.prototype.inotn=function(r){a("number"==typeof r&&r>=0);var n=0|Math.ceil(r/26),i=r%26;this._expand(n),i>0&&n--;for(var o=0;o<n;o++)this.words[o]=67108863&~this.words[o];return i>0&&(this.words[o]=~this.words[o]&67108863>>26-i),this.strip()},s.prototype.notn=function(r){return this.clone().inotn(r)},s.prototype.setn=function(r,n){a("number"==typeof r&&r>=0);var i=r/26|0,o=r%26;return this._expand(i+1),this.words[i]=n?this.words[i]|1<<o:this.words[i]&~(1<<o),this.strip()},s.prototype.iadd=function(r){var n,i,a;if(0!==this.negative&&0===r.negative)return this.negative=0,n=this.isub(r),this.negative^=1,this._normSign();if(0===this.negative&&0!==r.negative)return r.negative=0,n=this.isub(r),r.negative=1,n._normSign();this.length>r.length?(i=this,a=r):(i=r,a=this);for(var o=0,s=0;s<a.length;s++)n=(0|i.words[s])+(0|a.words[s])+o,this.words[s]=67108863&n,o=n>>>26;for(;0!==o&&s<i.length;s++)n=(0|i.words[s])+o,this.words[s]=67108863&n,o=n>>>26;if(this.length=i.length,0!==o)this.words[this.length]=o,this.length++;else if(i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this},s.prototype.add=function(r){var n;return 0!==r.negative&&0===this.negative?(r.negative=0,n=this.sub(r),r.negative^=1,n):0===r.negative&&0!==this.negative?(this.negative=0,n=r.sub(this),this.negative=1,n):this.length>r.length?this.clone().iadd(r):r.clone().iadd(this)},s.prototype.isub=function(r){if(0!==r.negative){r.negative=0;var n=this.iadd(r);return r.negative=1,n._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(r),this.negative=1,this._normSign();var i,a,o=this.cmp(r);if(0===o)return this.negative=0,this.length=1,this.words[0]=0,this;o>0?(i=this,a=r):(i=r,a=this);for(var s=0,l=0;l<a.length;l++)s=(n=(0|i.words[l])-(0|a.words[l])+s)>>26,this.words[l]=67108863&n;for(;0!==s&&l<i.length;l++)s=(n=(0|i.words[l])+s)>>26,this.words[l]=67108863&n;if(0===s&&l<i.length&&i!==this)for(;l<i.length;l++)this.words[l]=i.words[l];return this.length=Math.max(this.length,l),i!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(r){return this.clone().isub(r)};var g=function(r,n,i){var a,o,s,l=r.words,c=n.words,u=i.words,f=0,h=0|l[0],p=8191&h,d=h>>>13,m=0|l[1],g=8191&m,v=m>>>13,y=0|l[2],x=8191&y,b=y>>>13,_=0|l[3],w=8191&_,T=_>>>13,k=0|l[4],A=8191&k,M=k>>>13,S=0|l[5],E=8191&S,L=S>>>13,C=0|l[6],P=8191&C,I=C>>>13,O=0|l[7],z=8191&O,D=O>>>13,R=0|l[8],F=8191&R,B=R>>>13,N=0|l[9],j=8191&N,U=N>>>13,V=0|c[0],H=8191&V,q=V>>>13,G=0|c[1],Y=8191&G,W=G>>>13,X=0|c[2],Z=8191&X,J=X>>>13,K=0|c[3],Q=8191&K,$=K>>>13,tt=0|c[4],te=8191&tt,tr=tt>>>13,tn=0|c[5],ti=8191&tn,ta=tn>>>13,to=0|c[6],ts=8191&to,tl=to>>>13,tc=0|c[7],tu=8191&tc,tf=tc>>>13,th=0|c[8],tp=8191&th,td=th>>>13,tm=0|c[9],tg=8191&tm,tv=tm>>>13;i.negative=r.negative^n.negative,i.length=19;var ty=(f+(a=Math.imul(p,H))|0)+((8191&(o=(o=Math.imul(p,q))+Math.imul(d,H)|0))<<13)|0;f=((s=Math.imul(d,q))+(o>>>13)|0)+(ty>>>26)|0,ty&=67108863,a=Math.imul(g,H),o=(o=Math.imul(g,q))+Math.imul(v,H)|0,s=Math.imul(v,q);var tx=(f+(a=a+Math.imul(p,Y)|0)|0)+((8191&(o=(o=o+Math.imul(p,W)|0)+Math.imul(d,Y)|0))<<13)|0;f=((s=s+Math.imul(d,W)|0)+(o>>>13)|0)+(tx>>>26)|0,tx&=67108863,a=Math.imul(x,H),o=(o=Math.imul(x,q))+Math.imul(b,H)|0,s=Math.imul(b,q),a=a+Math.imul(g,Y)|0,o=(o=o+Math.imul(g,W)|0)+Math.imul(v,Y)|0,s=s+Math.imul(v,W)|0;var tb=(f+(a=a+Math.imul(p,Z)|0)|0)+((8191&(o=(o=o+Math.imul(p,J)|0)+Math.imul(d,Z)|0))<<13)|0;f=((s=s+Math.imul(d,J)|0)+(o>>>13)|0)+(tb>>>26)|0,tb&=67108863,a=Math.imul(w,H),o=(o=Math.imul(w,q))+Math.imul(T,H)|0,s=Math.imul(T,q),a=a+Math.imul(x,Y)|0,o=(o=o+Math.imul(x,W)|0)+Math.imul(b,Y)|0,s=s+Math.imul(b,W)|0,a=a+Math.imul(g,Z)|0,o=(o=o+Math.imul(g,J)|0)+Math.imul(v,Z)|0,s=s+Math.imul(v,J)|0;var t_=(f+(a=a+Math.imul(p,Q)|0)|0)+((8191&(o=(o=o+Math.imul(p,$)|0)+Math.imul(d,Q)|0))<<13)|0;f=((s=s+Math.imul(d,$)|0)+(o>>>13)|0)+(t_>>>26)|0,t_&=67108863,a=Math.imul(A,H),o=(o=Math.imul(A,q))+Math.imul(M,H)|0,s=Math.imul(M,q),a=a+Math.imul(w,Y)|0,o=(o=o+Math.imul(w,W)|0)+Math.imul(T,Y)|0,s=s+Math.imul(T,W)|0,a=a+Math.imul(x,Z)|0,o=(o=o+Math.imul(x,J)|0)+Math.imul(b,Z)|0,s=s+Math.imul(b,J)|0,a=a+Math.imul(g,Q)|0,o=(o=o+Math.imul(g,$)|0)+Math.imul(v,Q)|0,s=s+Math.imul(v,$)|0;var tw=(f+(a=a+Math.imul(p,te)|0)|0)+((8191&(o=(o=o+Math.imul(p,tr)|0)+Math.imul(d,te)|0))<<13)|0;f=((s=s+Math.imul(d,tr)|0)+(o>>>13)|0)+(tw>>>26)|0,tw&=67108863,a=Math.imul(E,H),o=(o=Math.imul(E,q))+Math.imul(L,H)|0,s=Math.imul(L,q),a=a+Math.imul(A,Y)|0,o=(o=o+Math.imul(A,W)|0)+Math.imul(M,Y)|0,s=s+Math.imul(M,W)|0,a=a+Math.imul(w,Z)|0,o=(o=o+Math.imul(w,J)|0)+Math.imul(T,Z)|0,s=s+Math.imul(T,J)|0,a=a+Math.imul(x,Q)|0,o=(o=o+Math.imul(x,$)|0)+Math.imul(b,Q)|0,s=s+Math.imul(b,$)|0,a=a+Math.imul(g,te)|0,o=(o=o+Math.imul(g,tr)|0)+Math.imul(v,te)|0,s=s+Math.imul(v,tr)|0;var tT=(f+(a=a+Math.imul(p,ti)|0)|0)+((8191&(o=(o=o+Math.imul(p,ta)|0)+Math.imul(d,ti)|0))<<13)|0;f=((s=s+Math.imul(d,ta)|0)+(o>>>13)|0)+(tT>>>26)|0,tT&=67108863,a=Math.imul(P,H),o=(o=Math.imul(P,q))+Math.imul(I,H)|0,s=Math.imul(I,q),a=a+Math.imul(E,Y)|0,o=(o=o+Math.imul(E,W)|0)+Math.imul(L,Y)|0,s=s+Math.imul(L,W)|0,a=a+Math.imul(A,Z)|0,o=(o=o+Math.imul(A,J)|0)+Math.imul(M,Z)|0,s=s+Math.imul(M,J)|0,a=a+Math.imul(w,Q)|0,o=(o=o+Math.imul(w,$)|0)+Math.imul(T,Q)|0,s=s+Math.imul(T,$)|0,a=a+Math.imul(x,te)|0,o=(o=o+Math.imul(x,tr)|0)+Math.imul(b,te)|0,s=s+Math.imul(b,tr)|0,a=a+Math.imul(g,ti)|0,o=(o=o+Math.imul(g,ta)|0)+Math.imul(v,ti)|0,s=s+Math.imul(v,ta)|0;var tk=(f+(a=a+Math.imul(p,ts)|0)|0)+((8191&(o=(o=o+Math.imul(p,tl)|0)+Math.imul(d,ts)|0))<<13)|0;f=((s=s+Math.imul(d,tl)|0)+(o>>>13)|0)+(tk>>>26)|0,tk&=67108863,a=Math.imul(z,H),o=(o=Math.imul(z,q))+Math.imul(D,H)|0,s=Math.imul(D,q),a=a+Math.imul(P,Y)|0,o=(o=o+Math.imul(P,W)|0)+Math.imul(I,Y)|0,s=s+Math.imul(I,W)|0,a=a+Math.imul(E,Z)|0,o=(o=o+Math.imul(E,J)|0)+Math.imul(L,Z)|0,s=s+Math.imul(L,J)|0,a=a+Math.imul(A,Q)|0,o=(o=o+Math.imul(A,$)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,$)|0,a=a+Math.imul(w,te)|0,o=(o=o+Math.imul(w,tr)|0)+Math.imul(T,te)|0,s=s+Math.imul(T,tr)|0,a=a+Math.imul(x,ti)|0,o=(o=o+Math.imul(x,ta)|0)+Math.imul(b,ti)|0,s=s+Math.imul(b,ta)|0,a=a+Math.imul(g,ts)|0,o=(o=o+Math.imul(g,tl)|0)+Math.imul(v,ts)|0,s=s+Math.imul(v,tl)|0;var tA=(f+(a=a+Math.imul(p,tu)|0)|0)+((8191&(o=(o=o+Math.imul(p,tf)|0)+Math.imul(d,tu)|0))<<13)|0;f=((s=s+Math.imul(d,tf)|0)+(o>>>13)|0)+(tA>>>26)|0,tA&=67108863,a=Math.imul(F,H),o=(o=Math.imul(F,q))+Math.imul(B,H)|0,s=Math.imul(B,q),a=a+Math.imul(z,Y)|0,o=(o=o+Math.imul(z,W)|0)+Math.imul(D,Y)|0,s=s+Math.imul(D,W)|0,a=a+Math.imul(P,Z)|0,o=(o=o+Math.imul(P,J)|0)+Math.imul(I,Z)|0,s=s+Math.imul(I,J)|0,a=a+Math.imul(E,Q)|0,o=(o=o+Math.imul(E,$)|0)+Math.imul(L,Q)|0,s=s+Math.imul(L,$)|0,a=a+Math.imul(A,te)|0,o=(o=o+Math.imul(A,tr)|0)+Math.imul(M,te)|0,s=s+Math.imul(M,tr)|0,a=a+Math.imul(w,ti)|0,o=(o=o+Math.imul(w,ta)|0)+Math.imul(T,ti)|0,s=s+Math.imul(T,ta)|0,a=a+Math.imul(x,ts)|0,o=(o=o+Math.imul(x,tl)|0)+Math.imul(b,ts)|0,s=s+Math.imul(b,tl)|0,a=a+Math.imul(g,tu)|0,o=(o=o+Math.imul(g,tf)|0)+Math.imul(v,tu)|0,s=s+Math.imul(v,tf)|0;var tM=(f+(a=a+Math.imul(p,tp)|0)|0)+((8191&(o=(o=o+Math.imul(p,td)|0)+Math.imul(d,tp)|0))<<13)|0;f=((s=s+Math.imul(d,td)|0)+(o>>>13)|0)+(tM>>>26)|0,tM&=67108863,a=Math.imul(j,H),o=(o=Math.imul(j,q))+Math.imul(U,H)|0,s=Math.imul(U,q),a=a+Math.imul(F,Y)|0,o=(o=o+Math.imul(F,W)|0)+Math.imul(B,Y)|0,s=s+Math.imul(B,W)|0,a=a+Math.imul(z,Z)|0,o=(o=o+Math.imul(z,J)|0)+Math.imul(D,Z)|0,s=s+Math.imul(D,J)|0,a=a+Math.imul(P,Q)|0,o=(o=o+Math.imul(P,$)|0)+Math.imul(I,Q)|0,s=s+Math.imul(I,$)|0,a=a+Math.imul(E,te)|0,o=(o=o+Math.imul(E,tr)|0)+Math.imul(L,te)|0,s=s+Math.imul(L,tr)|0,a=a+Math.imul(A,ti)|0,o=(o=o+Math.imul(A,ta)|0)+Math.imul(M,ti)|0,s=s+Math.imul(M,ta)|0,a=a+Math.imul(w,ts)|0,o=(o=o+Math.imul(w,tl)|0)+Math.imul(T,ts)|0,s=s+Math.imul(T,tl)|0,a=a+Math.imul(x,tu)|0,o=(o=o+Math.imul(x,tf)|0)+Math.imul(b,tu)|0,s=s+Math.imul(b,tf)|0,a=a+Math.imul(g,tp)|0,o=(o=o+Math.imul(g,td)|0)+Math.imul(v,tp)|0,s=s+Math.imul(v,td)|0;var tS=(f+(a=a+Math.imul(p,tg)|0)|0)+((8191&(o=(o=o+Math.imul(p,tv)|0)+Math.imul(d,tg)|0))<<13)|0;f=((s=s+Math.imul(d,tv)|0)+(o>>>13)|0)+(tS>>>26)|0,tS&=67108863,a=Math.imul(j,Y),o=(o=Math.imul(j,W))+Math.imul(U,Y)|0,s=Math.imul(U,W),a=a+Math.imul(F,Z)|0,o=(o=o+Math.imul(F,J)|0)+Math.imul(B,Z)|0,s=s+Math.imul(B,J)|0,a=a+Math.imul(z,Q)|0,o=(o=o+Math.imul(z,$)|0)+Math.imul(D,Q)|0,s=s+Math.imul(D,$)|0,a=a+Math.imul(P,te)|0,o=(o=o+Math.imul(P,tr)|0)+Math.imul(I,te)|0,s=s+Math.imul(I,tr)|0,a=a+Math.imul(E,ti)|0,o=(o=o+Math.imul(E,ta)|0)+Math.imul(L,ti)|0,s=s+Math.imul(L,ta)|0,a=a+Math.imul(A,ts)|0,o=(o=o+Math.imul(A,tl)|0)+Math.imul(M,ts)|0,s=s+Math.imul(M,tl)|0,a=a+Math.imul(w,tu)|0,o=(o=o+Math.imul(w,tf)|0)+Math.imul(T,tu)|0,s=s+Math.imul(T,tf)|0,a=a+Math.imul(x,tp)|0,o=(o=o+Math.imul(x,td)|0)+Math.imul(b,tp)|0,s=s+Math.imul(b,td)|0;var tE=(f+(a=a+Math.imul(g,tg)|0)|0)+((8191&(o=(o=o+Math.imul(g,tv)|0)+Math.imul(v,tg)|0))<<13)|0;f=((s=s+Math.imul(v,tv)|0)+(o>>>13)|0)+(tE>>>26)|0,tE&=67108863,a=Math.imul(j,Z),o=(o=Math.imul(j,J))+Math.imul(U,Z)|0,s=Math.imul(U,J),a=a+Math.imul(F,Q)|0,o=(o=o+Math.imul(F,$)|0)+Math.imul(B,Q)|0,s=s+Math.imul(B,$)|0,a=a+Math.imul(z,te)|0,o=(o=o+Math.imul(z,tr)|0)+Math.imul(D,te)|0,s=s+Math.imul(D,tr)|0,a=a+Math.imul(P,ti)|0,o=(o=o+Math.imul(P,ta)|0)+Math.imul(I,ti)|0,s=s+Math.imul(I,ta)|0,a=a+Math.imul(E,ts)|0,o=(o=o+Math.imul(E,tl)|0)+Math.imul(L,ts)|0,s=s+Math.imul(L,tl)|0,a=a+Math.imul(A,tu)|0,o=(o=o+Math.imul(A,tf)|0)+Math.imul(M,tu)|0,s=s+Math.imul(M,tf)|0,a=a+Math.imul(w,tp)|0,o=(o=o+Math.imul(w,td)|0)+Math.imul(T,tp)|0,s=s+Math.imul(T,td)|0;var tL=(f+(a=a+Math.imul(x,tg)|0)|0)+((8191&(o=(o=o+Math.imul(x,tv)|0)+Math.imul(b,tg)|0))<<13)|0;f=((s=s+Math.imul(b,tv)|0)+(o>>>13)|0)+(tL>>>26)|0,tL&=67108863,a=Math.imul(j,Q),o=(o=Math.imul(j,$))+Math.imul(U,Q)|0,s=Math.imul(U,$),a=a+Math.imul(F,te)|0,o=(o=o+Math.imul(F,tr)|0)+Math.imul(B,te)|0,s=s+Math.imul(B,tr)|0,a=a+Math.imul(z,ti)|0,o=(o=o+Math.imul(z,ta)|0)+Math.imul(D,ti)|0,s=s+Math.imul(D,ta)|0,a=a+Math.imul(P,ts)|0,o=(o=o+Math.imul(P,tl)|0)+Math.imul(I,ts)|0,s=s+Math.imul(I,tl)|0,a=a+Math.imul(E,tu)|0,o=(o=o+Math.imul(E,tf)|0)+Math.imul(L,tu)|0,s=s+Math.imul(L,tf)|0,a=a+Math.imul(A,tp)|0,o=(o=o+Math.imul(A,td)|0)+Math.imul(M,tp)|0,s=s+Math.imul(M,td)|0;var tC=(f+(a=a+Math.imul(w,tg)|0)|0)+((8191&(o=(o=o+Math.imul(w,tv)|0)+Math.imul(T,tg)|0))<<13)|0;f=((s=s+Math.imul(T,tv)|0)+(o>>>13)|0)+(tC>>>26)|0,tC&=67108863,a=Math.imul(j,te),o=(o=Math.imul(j,tr))+Math.imul(U,te)|0,s=Math.imul(U,tr),a=a+Math.imul(F,ti)|0,o=(o=o+Math.imul(F,ta)|0)+Math.imul(B,ti)|0,s=s+Math.imul(B,ta)|0,a=a+Math.imul(z,ts)|0,o=(o=o+Math.imul(z,tl)|0)+Math.imul(D,ts)|0,s=s+Math.imul(D,tl)|0,a=a+Math.imul(P,tu)|0,o=(o=o+Math.imul(P,tf)|0)+Math.imul(I,tu)|0,s=s+Math.imul(I,tf)|0,a=a+Math.imul(E,tp)|0,o=(o=o+Math.imul(E,td)|0)+Math.imul(L,tp)|0,s=s+Math.imul(L,td)|0;var tP=(f+(a=a+Math.imul(A,tg)|0)|0)+((8191&(o=(o=o+Math.imul(A,tv)|0)+Math.imul(M,tg)|0))<<13)|0;f=((s=s+Math.imul(M,tv)|0)+(o>>>13)|0)+(tP>>>26)|0,tP&=67108863,a=Math.imul(j,ti),o=(o=Math.imul(j,ta))+Math.imul(U,ti)|0,s=Math.imul(U,ta),a=a+Math.imul(F,ts)|0,o=(o=o+Math.imul(F,tl)|0)+Math.imul(B,ts)|0,s=s+Math.imul(B,tl)|0,a=a+Math.imul(z,tu)|0,o=(o=o+Math.imul(z,tf)|0)+Math.imul(D,tu)|0,s=s+Math.imul(D,tf)|0,a=a+Math.imul(P,tp)|0,o=(o=o+Math.imul(P,td)|0)+Math.imul(I,tp)|0,s=s+Math.imul(I,td)|0;var tI=(f+(a=a+Math.imul(E,tg)|0)|0)+((8191&(o=(o=o+Math.imul(E,tv)|0)+Math.imul(L,tg)|0))<<13)|0;f=((s=s+Math.imul(L,tv)|0)+(o>>>13)|0)+(tI>>>26)|0,tI&=67108863,a=Math.imul(j,ts),o=(o=Math.imul(j,tl))+Math.imul(U,ts)|0,s=Math.imul(U,tl),a=a+Math.imul(F,tu)|0,o=(o=o+Math.imul(F,tf)|0)+Math.imul(B,tu)|0,s=s+Math.imul(B,tf)|0,a=a+Math.imul(z,tp)|0,o=(o=o+Math.imul(z,td)|0)+Math.imul(D,tp)|0,s=s+Math.imul(D,td)|0;var tO=(f+(a=a+Math.imul(P,tg)|0)|0)+((8191&(o=(o=o+Math.imul(P,tv)|0)+Math.imul(I,tg)|0))<<13)|0;f=((s=s+Math.imul(I,tv)|0)+(o>>>13)|0)+(tO>>>26)|0,tO&=67108863,a=Math.imul(j,tu),o=(o=Math.imul(j,tf))+Math.imul(U,tu)|0,s=Math.imul(U,tf),a=a+Math.imul(F,tp)|0,o=(o=o+Math.imul(F,td)|0)+Math.imul(B,tp)|0,s=s+Math.imul(B,td)|0;var tz=(f+(a=a+Math.imul(z,tg)|0)|0)+((8191&(o=(o=o+Math.imul(z,tv)|0)+Math.imul(D,tg)|0))<<13)|0;f=((s=s+Math.imul(D,tv)|0)+(o>>>13)|0)+(tz>>>26)|0,tz&=67108863,a=Math.imul(j,tp),o=(o=Math.imul(j,td))+Math.imul(U,tp)|0,s=Math.imul(U,td);var tD=(f+(a=a+Math.imul(F,tg)|0)|0)+((8191&(o=(o=o+Math.imul(F,tv)|0)+Math.imul(B,tg)|0))<<13)|0;f=((s=s+Math.imul(B,tv)|0)+(o>>>13)|0)+(tD>>>26)|0,tD&=67108863;var tR=(f+(a=Math.imul(j,tg))|0)+((8191&(o=(o=Math.imul(j,tv))+Math.imul(U,tg)|0))<<13)|0;return f=((s=Math.imul(U,tv))+(o>>>13)|0)+(tR>>>26)|0,tR&=67108863,u[0]=ty,u[1]=tx,u[2]=tb,u[3]=t_,u[4]=tw,u[5]=tT,u[6]=tk,u[7]=tA,u[8]=tM,u[9]=tS,u[10]=tE,u[11]=tL,u[12]=tC,u[13]=tP,u[14]=tI,u[15]=tO,u[16]=tz,u[17]=tD,u[18]=tR,0!==f&&(u[19]=f,i.length++),i};function v(r,n,i){return(new y).mulp(r,n,i)}function y(r,n){this.x=r,this.y=n}Math.imul||(g=m),s.prototype.mulTo=function(r,n){var i=this.length+r.length;return 10===this.length&&10===r.length?g(this,r,n):i<63?m(this,r,n):i<1024?function(r,n,i){i.negative=n.negative^r.negative,i.length=r.length+n.length;for(var a=0,o=0,s=0;s<i.length-1;s++){var l=o;o=0;for(var c=67108863&a,u=Math.min(s,n.length-1),f=Math.max(0,s-r.length+1);f<=u;f++){var h=s-f,p=(0|r.words[h])*(0|n.words[f]),d=67108863&p;c=67108863&(d=d+c|0),o+=(l=(l=l+(p/67108864|0)|0)+(d>>>26)|0)>>>26,l&=67108863}i.words[s]=c,a=l,l=o}return 0!==a?i.words[s]=a:i.length--,i.strip()}(this,r,n):v(this,r,n)},y.prototype.makeRBT=function(r){for(var n=Array(r),i=s.prototype._countBits(r)-1,a=0;a<r;a++)n[a]=this.revBin(a,i,r);return n},y.prototype.revBin=function(r,n,i){if(0===r||r===i-1)return r;for(var a=0,o=0;o<n;o++)a|=(1&r)<<n-o-1,r>>=1;return a},y.prototype.permute=function(r,n,i,a,o,s){for(var l=0;l<s;l++)a[l]=n[r[l]],o[l]=i[r[l]]},y.prototype.transform=function(r,n,i,a,o,s){this.permute(s,r,n,i,a,o);for(var l=1;l<o;l<<=1)for(var c=l<<1,u=Math.cos(2*Math.PI/c),f=Math.sin(2*Math.PI/c),h=0;h<o;h+=c)for(var p=u,d=f,m=0;m<l;m++){var g=i[h+m],v=a[h+m],y=i[h+m+l],x=a[h+m+l],b=p*y-d*x;x=p*x+d*y,y=b,i[h+m]=g+y,a[h+m]=v+x,i[h+m+l]=g-y,a[h+m+l]=v-x,m!==c&&(b=u*p-f*d,d=u*d+f*p,p=b)}},y.prototype.guessLen13b=function(r,n){var i=1|Math.max(n,r),a=1&i,o=0;for(i=i/2|0;i;i>>>=1)o++;return 1<<o+1+a},y.prototype.conjugate=function(r,n,i){if(!(i<=1))for(var a=0;a<i/2;a++){var o=r[a];r[a]=r[i-a-1],r[i-a-1]=o,o=n[a],n[a]=-n[i-a-1],n[i-a-1]=-o}},y.prototype.normalize13b=function(r,n){for(var i=0,a=0;a<n/2;a++){var o=8192*Math.round(r[2*a+1]/n)+Math.round(r[2*a]/n)+i;r[a]=67108863&o,i=o<67108864?0:o/67108864|0}return r},y.prototype.convert13b=function(r,n,i,o){for(var s=0,l=0;l<n;l++)s+=0|r[l],i[2*l]=8191&s,s>>>=13,i[2*l+1]=8191&s,s>>>=13;for(l=2*n;l<o;++l)i[l]=0;a(0===s),a(0==(-8192&s))},y.prototype.stub=function(r){for(var n=Array(r),i=0;i<r;i++)n[i]=0;return n},y.prototype.mulp=function(r,n,i){var a=2*this.guessLen13b(r.length,n.length),o=this.makeRBT(a),s=this.stub(a),l=Array(a),c=Array(a),u=Array(a),f=Array(a),h=Array(a),p=Array(a),d=i.words;d.length=a,this.convert13b(r.words,r.length,l,a),this.convert13b(n.words,n.length,f,a),this.transform(l,s,c,u,a,o),this.transform(f,s,h,p,a,o);for(var m=0;m<a;m++){var g=c[m]*h[m]-u[m]*p[m];u[m]=c[m]*p[m]+u[m]*h[m],c[m]=g}return this.conjugate(c,u,a),this.transform(c,u,d,s,a,o),this.conjugate(d,s,a),this.normalize13b(d,a),i.negative=r.negative^n.negative,i.length=r.length+n.length,i.strip()},s.prototype.mul=function(r){var n=new s(null);return n.words=Array(this.length+r.length),this.mulTo(r,n)},s.prototype.mulf=function(r){var n=new s(null);return n.words=Array(this.length+r.length),v(this,r,n)},s.prototype.imul=function(r){return this.clone().mulTo(r,this)},s.prototype.imuln=function(r){a("number"==typeof r),a(r<67108864);for(var n=0,i=0;i<this.length;i++){var o=(0|this.words[i])*r,s=(67108863&o)+(67108863&n);n>>=26,n+=(o/67108864|0)+(s>>>26),this.words[i]=67108863&s}return 0!==n&&(this.words[i]=n,this.length++),this},s.prototype.muln=function(r){return this.clone().imuln(r)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(r){var n=function(r){for(var n=Array(r.bitLength()),i=0;i<n.length;i++){var a=i/26|0,o=i%26;n[i]=(r.words[a]&1<<o)>>>o}return n}(r);if(0===n.length)return new s(1);for(var i=this,a=0;a<n.length&&0===n[a];a++,i=i.sqr());if(++a<n.length)for(var o=i.sqr();a<n.length;a++,o=o.sqr())0!==n[a]&&(i=i.mul(o));return i},s.prototype.iushln=function(r){a("number"==typeof r&&r>=0);var n,i=r%26,o=(r-i)/26,s=67108863>>>26-i<<26-i;if(0!==i){var l=0;for(n=0;n<this.length;n++){var c=this.words[n]&s,u=(0|this.words[n])-c<<i;this.words[n]=u|l,l=c>>>26-i}l&&(this.words[n]=l,this.length++)}if(0!==o){for(n=this.length-1;n>=0;n--)this.words[n+o]=this.words[n];for(n=0;n<o;n++)this.words[n]=0;this.length+=o}return this.strip()},s.prototype.ishln=function(r){return a(0===this.negative),this.iushln(r)},s.prototype.iushrn=function(r,n,i){a("number"==typeof r&&r>=0),o=n?(n-n%26)/26:0;var o,s=r%26,l=Math.min((r-s)/26,this.length),c=67108863^67108863>>>s<<s;if(o-=l,o=Math.max(0,o),i){for(var u=0;u<l;u++)i.words[u]=this.words[u];i.length=l}if(0===l);else if(this.length>l)for(this.length-=l,u=0;u<this.length;u++)this.words[u]=this.words[u+l];else this.words[0]=0,this.length=1;var f=0;for(u=this.length-1;u>=0&&(0!==f||u>=o);u--){var h=0|this.words[u];this.words[u]=f<<26-s|h>>>s,f=h&c}return i&&0!==f&&(i.words[i.length++]=f),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(r,n,i){return a(0===this.negative),this.iushrn(r,n,i)},s.prototype.shln=function(r){return this.clone().ishln(r)},s.prototype.ushln=function(r){return this.clone().iushln(r)},s.prototype.shrn=function(r){return this.clone().ishrn(r)},s.prototype.ushrn=function(r){return this.clone().iushrn(r)},s.prototype.testn=function(r){a("number"==typeof r&&r>=0);var n=r%26,i=(r-n)/26;return!(this.length<=i)&&!!(this.words[i]&1<<n)},s.prototype.imaskn=function(r){a("number"==typeof r&&r>=0);var n=r%26,i=(r-n)/26;return(a(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)?this:(0!==n&&i++,this.length=Math.min(i,this.length),0!==n&&(this.words[this.length-1]&=67108863^67108863>>>n<<n),this.strip())},s.prototype.maskn=function(r){return this.clone().imaskn(r)},s.prototype.iaddn=function(r){return a("number"==typeof r),a(r<67108864),r<0?this.isubn(-r):0!==this.negative?(1===this.length&&(0|this.words[0])<r?(this.words[0]=r-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(r),this.negative=1),this):this._iaddn(r)},s.prototype._iaddn=function(r){this.words[0]+=r;for(var n=0;n<this.length&&this.words[n]>=67108864;n++)this.words[n]-=67108864,n===this.length-1?this.words[n+1]=1:this.words[n+1]++;return this.length=Math.max(this.length,n+1),this},s.prototype.isubn=function(r){if(a("number"==typeof r),a(r<67108864),r<0)return this.iaddn(-r);if(0!==this.negative)return this.negative=0,this.iaddn(r),this.negative=1,this;if(this.words[0]-=r,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var n=0;n<this.length&&this.words[n]<0;n++)this.words[n]+=67108864,this.words[n+1]-=1;return this.strip()},s.prototype.addn=function(r){return this.clone().iaddn(r)},s.prototype.subn=function(r){return this.clone().isubn(r)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(r,n,i){var o,s,l=r.length+i;this._expand(l);var c=0;for(o=0;o<r.length;o++){s=(0|this.words[o+i])+c;var u=(0|r.words[o])*n;c=((s-=67108863&u)>>26)-(u/67108864|0),this.words[o+i]=67108863&s}for(;o<this.length-i;o++)c=(s=(0|this.words[o+i])+c)>>26,this.words[o+i]=67108863&s;if(0===c)return this.strip();for(a(-1===c),c=0,o=0;o<this.length;o++)c=(s=-(0|this.words[o])+c)>>26,this.words[o]=67108863&s;return this.negative=1,this.strip()},s.prototype._wordDiv=function(r,n){var i=(this.length,r.length),a=this.clone(),o=r,l=0|o.words[o.length-1];0!=(i=26-this._countBits(l))&&(o=o.ushln(i),a.iushln(i),l=0|o.words[o.length-1]);var c,u=a.length-o.length;if("mod"!==n){(c=new s(null)).length=u+1,c.words=Array(c.length);for(var f=0;f<c.length;f++)c.words[f]=0}var h=a.clone()._ishlnsubmul(o,1,u);0===h.negative&&(a=h,c&&(c.words[u]=1));for(var p=u-1;p>=0;p--){var d=67108864*(0|a.words[o.length+p])+(0|a.words[o.length+p-1]);for(d=Math.min(d/l|0,67108863),a._ishlnsubmul(o,d,p);0!==a.negative;)d--,a.negative=0,a._ishlnsubmul(o,1,p),a.isZero()||(a.negative^=1);c&&(c.words[p]=d)}return c&&c.strip(),a.strip(),"div"!==n&&0!==i&&a.iushrn(i),{div:c||null,mod:a}},s.prototype.divmod=function(r,n,i){var o,l,c;return a(!r.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===r.negative?(c=this.neg().divmod(r,n),"mod"!==n&&(o=c.div.neg()),"div"!==n&&(l=c.mod.neg(),i&&0!==l.negative&&l.iadd(r)),{div:o,mod:l}):0===this.negative&&0!==r.negative?(c=this.divmod(r.neg(),n),"mod"!==n&&(o=c.div.neg()),{div:o,mod:c.mod}):0!=(this.negative&r.negative)?(c=this.neg().divmod(r.neg(),n),"div"!==n&&(l=c.mod.neg(),i&&0!==l.negative&&l.isub(r)),{div:c.div,mod:l}):r.length>this.length||0>this.cmp(r)?{div:new s(0),mod:this}:1===r.length?"div"===n?{div:this.divn(r.words[0]),mod:null}:"mod"===n?{div:null,mod:new s(this.modn(r.words[0]))}:{div:this.divn(r.words[0]),mod:new s(this.modn(r.words[0]))}:this._wordDiv(r,n)},s.prototype.div=function(r){return this.divmod(r,"div",!1).div},s.prototype.mod=function(r){return this.divmod(r,"mod",!1).mod},s.prototype.umod=function(r){return this.divmod(r,"mod",!0).mod},s.prototype.divRound=function(r){var n=this.divmod(r);if(n.mod.isZero())return n.div;var i=0!==n.div.negative?n.mod.isub(r):n.mod,a=r.ushrn(1),o=r.andln(1),s=i.cmp(a);return s<0||1===o&&0===s?n.div:0!==n.div.negative?n.div.isubn(1):n.div.iaddn(1)},s.prototype.modn=function(r){a(r<=67108863);for(var n=67108864%r,i=0,o=this.length-1;o>=0;o--)i=(n*i+(0|this.words[o]))%r;return i},s.prototype.idivn=function(r){a(r<=67108863);for(var n=0,i=this.length-1;i>=0;i--){var o=(0|this.words[i])+67108864*n;this.words[i]=o/r|0,n=o%r}return this.strip()},s.prototype.divn=function(r){return this.clone().idivn(r)},s.prototype.egcd=function(r){a(0===r.negative),a(!r.isZero());var n=this,i=r.clone();n=0!==n.negative?n.umod(r):n.clone();for(var o=new s(1),l=new s(0),c=new s(0),u=new s(1),f=0;n.isEven()&&i.isEven();)n.iushrn(1),i.iushrn(1),++f;for(var h=i.clone(),p=n.clone();!n.isZero();){for(var d=0,m=1;0==(n.words[0]&m)&&d<26;++d,m<<=1);if(d>0)for(n.iushrn(d);d-- >0;)(o.isOdd()||l.isOdd())&&(o.iadd(h),l.isub(p)),o.iushrn(1),l.iushrn(1);for(var g=0,v=1;0==(i.words[0]&v)&&g<26;++g,v<<=1);if(g>0)for(i.iushrn(g);g-- >0;)(c.isOdd()||u.isOdd())&&(c.iadd(h),u.isub(p)),c.iushrn(1),u.iushrn(1);n.cmp(i)>=0?(n.isub(i),o.isub(c),l.isub(u)):(i.isub(n),c.isub(o),u.isub(l))}return{a:c,b:u,gcd:i.iushln(f)}},s.prototype._invmp=function(r){a(0===r.negative),a(!r.isZero());var n=this,i=r.clone();n=0!==n.negative?n.umod(r):n.clone();for(var o,l=new s(1),c=new s(0),u=i.clone();n.cmpn(1)>0&&i.cmpn(1)>0;){for(var f=0,h=1;0==(n.words[0]&h)&&f<26;++f,h<<=1);if(f>0)for(n.iushrn(f);f-- >0;)l.isOdd()&&l.iadd(u),l.iushrn(1);for(var p=0,d=1;0==(i.words[0]&d)&&p<26;++p,d<<=1);if(p>0)for(i.iushrn(p);p-- >0;)c.isOdd()&&c.iadd(u),c.iushrn(1);n.cmp(i)>=0?(n.isub(i),l.isub(c)):(i.isub(n),c.isub(l))}return 0>(o=0===n.cmpn(1)?l:c).cmpn(0)&&o.iadd(r),o},s.prototype.gcd=function(r){if(this.isZero())return r.abs();if(r.isZero())return this.abs();var n=this.clone(),i=r.clone();n.negative=0,i.negative=0;for(var a=0;n.isEven()&&i.isEven();a++)n.iushrn(1),i.iushrn(1);for(;;){for(;n.isEven();)n.iushrn(1);for(;i.isEven();)i.iushrn(1);var o=n.cmp(i);if(o<0){var s=n;n=i,i=s}else if(0===o||0===i.cmpn(1))break;n.isub(i)}return i.iushln(a)},s.prototype.invm=function(r){return this.egcd(r).a.umod(r)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(r){return this.words[0]&r},s.prototype.bincn=function(r){a("number"==typeof r);var n=r%26,i=(r-n)/26,o=1<<n;if(this.length<=i)return this._expand(i+1),this.words[i]|=o,this;for(var s=o,l=i;0!==s&&l<this.length;l++){var c=0|this.words[l];s=(c+=s)>>>26,c&=67108863,this.words[l]=c}return 0!==s&&(this.words[l]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(r){var n,i=r<0;if(0!==this.negative&&!i)return -1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)n=1;else{i&&(r=-r),a(r<=67108863,"Number is too big");var o=0|this.words[0];n=o===r?0:o<r?-1:1}return 0!==this.negative?0|-n:n},s.prototype.cmp=function(r){if(0!==this.negative&&0===r.negative)return -1;if(0===this.negative&&0!==r.negative)return 1;var n=this.ucmp(r);return 0!==this.negative?0|-n:n},s.prototype.ucmp=function(r){if(this.length>r.length)return 1;if(this.length<r.length)return -1;for(var n=0,i=this.length-1;i>=0;i--){var a=0|this.words[i],o=0|r.words[i];if(a!==o){a<o?n=-1:a>o&&(n=1);break}}return n},s.prototype.gtn=function(r){return 1===this.cmpn(r)},s.prototype.gt=function(r){return 1===this.cmp(r)},s.prototype.gten=function(r){return this.cmpn(r)>=0},s.prototype.gte=function(r){return this.cmp(r)>=0},s.prototype.ltn=function(r){return -1===this.cmpn(r)},s.prototype.lt=function(r){return -1===this.cmp(r)},s.prototype.lten=function(r){return 0>=this.cmpn(r)},s.prototype.lte=function(r){return 0>=this.cmp(r)},s.prototype.eqn=function(r){return 0===this.cmpn(r)},s.prototype.eq=function(r){return 0===this.cmp(r)},s.red=function(r){return new A(r)},s.prototype.toRed=function(r){return a(!this.red,"Already a number in reduction context"),a(0===this.negative,"red works only with positives"),r.convertTo(this)._forceRed(r)},s.prototype.fromRed=function(){return a(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(r){return this.red=r,this},s.prototype.forceRed=function(r){return a(!this.red,"Already a number in reduction context"),this._forceRed(r)},s.prototype.redAdd=function(r){return a(this.red,"redAdd works only with red numbers"),this.red.add(this,r)},s.prototype.redIAdd=function(r){return a(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,r)},s.prototype.redSub=function(r){return a(this.red,"redSub works only with red numbers"),this.red.sub(this,r)},s.prototype.redISub=function(r){return a(this.red,"redISub works only with red numbers"),this.red.isub(this,r)},s.prototype.redShl=function(r){return a(this.red,"redShl works only with red numbers"),this.red.shl(this,r)},s.prototype.redMul=function(r){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,r),this.red.mul(this,r)},s.prototype.redIMul=function(r){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,r),this.red.imul(this,r)},s.prototype.redSqr=function(){return a(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return a(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return a(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return a(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return a(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(r){return a(this.red&&!r.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,r)};var x={k256:null,p224:null,p192:null,p25519:null};function b(r,n){this.name=r,this.p=new s(n,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function _(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function w(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function T(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function k(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function A(r){if("string"==typeof r){var n=s._prime(r);this.m=n.p,this.prime=n}else a(r.gtn(1),"modulus must be greater than 1"),this.m=r,this.prime=null}function M(r){A.call(this,r),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var r=new s(null);return r.words=Array(Math.ceil(this.n/13)),r},b.prototype.ireduce=function(r){var n,i=r;do this.split(i,this.tmp),n=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength();while(n>this.n);var a=n<this.n?-1:i.ucmp(this.p);return 0===a?(i.words[0]=0,i.length=1):a>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},b.prototype.split=function(r,n){r.iushrn(this.n,0,n)},b.prototype.imulK=function(r){return r.imul(this.k)},o(_,b),_.prototype.split=function(r,n){for(var i=Math.min(r.length,9),a=0;a<i;a++)n.words[a]=r.words[a];if(n.length=i,r.length<=9)return r.words[0]=0,void(r.length=1);var o=r.words[9];for(n.words[n.length++]=4194303&o,a=10;a<r.length;a++){var s=0|r.words[a];r.words[a-10]=(4194303&s)<<4|o>>>22,o=s}o>>>=22,r.words[a-10]=o,0===o&&r.length>10?r.length-=10:r.length-=9},_.prototype.imulK=function(r){r.words[r.length]=0,r.words[r.length+1]=0,r.length+=2;for(var n=0,i=0;i<r.length;i++){var a=0|r.words[i];n+=977*a,r.words[i]=67108863&n,n=64*a+(n/67108864|0)}return 0===r.words[r.length-1]&&(r.length--,0===r.words[r.length-1]&&r.length--),r},o(w,b),o(T,b),o(k,b),k.prototype.imulK=function(r){for(var n=0,i=0;i<r.length;i++){var a=19*(0|r.words[i])+n,o=67108863&a;a>>>=26,r.words[i]=o,n=a}return 0!==n&&(r.words[r.length++]=n),r},s._prime=function(r){var n;if(x[r])return x[r];if("k256"===r)n=new _;else if("p224"===r)n=new w;else if("p192"===r)n=new T;else{if("p25519"!==r)throw Error("Unknown prime "+r);n=new k}return x[r]=n,n},A.prototype._verify1=function(r){a(0===r.negative,"red works only with positives"),a(r.red,"red works only with red numbers")},A.prototype._verify2=function(r,n){a(0==(r.negative|n.negative),"red works only with positives"),a(r.red&&r.red===n.red,"red works only with red numbers")},A.prototype.imod=function(r){return this.prime?this.prime.ireduce(r)._forceRed(this):r.umod(this.m)._forceRed(this)},A.prototype.neg=function(r){return r.isZero()?r.clone():this.m.sub(r)._forceRed(this)},A.prototype.add=function(r,n){this._verify2(r,n);var i=r.add(n);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},A.prototype.iadd=function(r,n){this._verify2(r,n);var i=r.iadd(n);return i.cmp(this.m)>=0&&i.isub(this.m),i},A.prototype.sub=function(r,n){this._verify2(r,n);var i=r.sub(n);return 0>i.cmpn(0)&&i.iadd(this.m),i._forceRed(this)},A.prototype.isub=function(r,n){this._verify2(r,n);var i=r.isub(n);return 0>i.cmpn(0)&&i.iadd(this.m),i},A.prototype.shl=function(r,n){return this._verify1(r),this.imod(r.ushln(n))},A.prototype.imul=function(r,n){return this._verify2(r,n),this.imod(r.imul(n))},A.prototype.mul=function(r,n){return this._verify2(r,n),this.imod(r.mul(n))},A.prototype.isqr=function(r){return this.imul(r,r.clone())},A.prototype.sqr=function(r){return this.mul(r,r)},A.prototype.sqrt=function(r){if(r.isZero())return r.clone();var n=this.m.andln(3);if(a(n%2==1),3===n){var i=this.m.add(new s(1)).iushrn(2);return this.pow(r,i)}for(var o=this.m.subn(1),l=0;!o.isZero()&&0===o.andln(1);)l++,o.iushrn(1);a(!o.isZero());var c=new s(1).toRed(this),u=c.redNeg(),f=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new s(2*h*h).toRed(this);0!==this.pow(h,f).cmp(u);)h.redIAdd(u);for(var p=this.pow(h,o),d=this.pow(r,o.addn(1).iushrn(1)),m=this.pow(r,o),g=l;0!==m.cmp(c);){for(var v=m,y=0;0!==v.cmp(c);y++)v=v.redSqr();a(y<g);var x=this.pow(p,new s(1).iushln(g-y-1));d=d.redMul(x),p=x.redSqr(),m=m.redMul(p),g=y}return d},A.prototype.invm=function(r){var n=r._invmp(this.m);return 0!==n.negative?(n.negative=0,this.imod(n).redNeg()):this.imod(n)},A.prototype.pow=function(r,n){if(n.isZero())return new s(1).toRed(this);if(0===n.cmpn(1))return r.clone();var i=Array(16);i[0]=new s(1).toRed(this),i[1]=r;for(var a=2;a<i.length;a++)i[a]=this.mul(i[a-1],r);var o=i[0],l=0,c=0,u=n.bitLength()%26;for(0===u&&(u=26),a=n.length-1;a>=0;a--){for(var f=n.words[a],h=u-1;h>=0;h--){var p=f>>h&1;o!==i[0]&&(o=this.sqr(o)),0!==p||0!==l?(l<<=1,l|=p,(4==++c||0===a&&0===h)&&(o=this.mul(o,i[l]),c=0,l=0)):c=0}u=26}return o},A.prototype.convertTo=function(r){var n=r.umod(this.m);return n===r?n.clone():n},A.prototype.convertFrom=function(r){var n=r.clone();return n.red=null,n},s.mont=function(r){return new M(r)},o(M,A),M.prototype.convertTo=function(r){return this.imod(r.ushln(this.shift))},M.prototype.convertFrom=function(r){var n=this.imod(r.mul(this.rinv));return n.red=null,n},M.prototype.imul=function(r,n){if(r.isZero()||n.isZero())return r.words[0]=0,r.length=1,r;var i=r.imul(n),a=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=i.isub(a).iushrn(this.shift),s=o;return o.cmp(this.m)>=0?s=o.isub(this.m):0>o.cmpn(0)&&(s=o.iadd(this.m)),s._forceRed(this)},M.prototype.mul=function(r,n){if(r.isZero()||n.isZero())return new s(0)._forceRed(this);var i=r.mul(n),a=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=i.isub(a).iushrn(this.shift),l=o;return o.cmp(this.m)>=0?l=o.isub(this.m):0>o.cmpn(0)&&(l=o.iadd(this.m)),l._forceRed(this)},M.prototype.invm=function(r){return this.imod(r._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===n||n,this)},{buffer:2}],34:[function(r,n,i){"use strict";n.exports=function(r){var n,i,a,o=r.length,s=0;for(n=0;n<o;++n)s+=r[n].length;var l=Array(s),c=0;for(n=0;n<o;++n){var u=r[n],f=u.length;for(i=0;i<f;++i){var h=l[c++]=Array(f-1),p=0;for(a=0;a<f;++a)a!==i&&(h[p++]=u[a]);if(1&i){var d=h[1];h[1]=h[0],h[0]=d}}}return l}},{}],35:[function(r,n,i){"use strict";n.exports=function(r,n,i){switch(arguments.length){case 1:return a=[],u(r,r,f,!0),a;case 2:return"function"==typeof n?u(r,r,n,!0):(a=[],u(r,n,f,!1),a);case 3:return u(r,n,i,!1);default:throw Error("box-intersect: Invalid arguments")}};var a,o=r("typedarray-pool"),s=r("./lib/sweep"),l=r("./lib/intersect");function c(r,n,i,a){for(var o=0,s=0,l=0,c=r.length;l<c;++l){var u=r[l];if(!function(r,n){for(var i=0;i<r;++i)if(!(n[i]<=n[i+r]))return!0;return!1}(n,u)){for(var f=0;f<2*n;++f)i[o++]=u[f];a[s++]=l}}return s}function u(r,n,i,a){var u=r.length,f=n.length;if(!(u<=0||f<=0)){var h=r[0].length>>>1;if(!(h<=0)){var p,d=o.mallocDouble(2*h*u),m=o.mallocInt32(u);if((u=c(r,h,d,m))>0){if(1===h&&a)s.init(u),p=s.sweepComplete(h,i,0,u,d,m,0,u,d,m);else{var g=o.mallocDouble(2*h*f),v=o.mallocInt32(f);(f=c(n,h,g,v))>0&&(s.init(u+f),p=1===h?s.sweepBipartite(h,i,0,u,d,m,0,f,g,v):l(h,i,a,u,d,m,f,g,v),o.free(g),o.free(v))}o.free(d),o.free(m)}return p}}}function f(r,n){a.push([r,n])}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(r,n,i){"use strict";function a(r){return r?function(r,n,i,a,o,s,l,c,u,f,h){return o-a>u-c?function(r,n,i,a,o,s,l,c,u,f,h){for(var p=2*r,d=a,m=p*a;d<o;++d,m+=p){var g=s[n+m],v=s[n+m+r],y=l[d];t:for(var x=c,b=p*c;x<u;++x,b+=p){var _=f[n+b],w=f[n+b+r],T=h[x];if(!(w<g||v<_)){for(var k=n+1;k<r;++k){var A=s[k+m],M=s[k+r+m],S=f[k+b],E=f[k+r+b];if(M<S||E<A)continue t}var L=i(y,T);if(void 0!==L)return L}}}}(r,n,i,a,o,s,l,c,u,f,h):function(r,n,i,a,o,s,l,c,u,f,h){for(var p=2*r,d=c,m=p*c;d<u;++d,m+=p){var g=f[n+m],v=f[n+m+r],y=h[d];t:for(var x=a,b=p*a;x<o;++x,b+=p){var _=s[n+b],w=s[n+b+r],T=l[x];if(!(v<_||w<g)){for(var k=n+1;k<r;++k){var A=s[k+b],M=s[k+r+b],S=f[k+m],E=f[k+r+m];if(M<S||E<A)continue t}var L=i(T,y);if(void 0!==L)return L}}}}(r,n,i,a,o,s,l,c,u,f,h)}:function(r,n,i,a,o,s,l,c,u,f,h,p){return s-o>f-u?a?function(r,n,i,a,o,s,l,c,u,f,h){for(var p=2*r,d=a,m=p*a;d<o;++d,m+=p){var g=s[n+m],v=s[n+m+r],y=l[d];t:for(var x=c,b=p*c;x<u;++x,b+=p){var _=f[n+b],w=h[x];if(!(_<=g||v<_)){for(var T=n+1;T<r;++T){var k=s[T+m],A=s[T+r+m],M=f[T+b],S=f[T+r+b];if(A<M||S<k)continue t}var E=i(w,y);if(void 0!==E)return E}}}}(r,n,i,o,s,l,c,u,f,h,p):function(r,n,i,a,o,s,l,c,u,f,h){for(var p=2*r,d=a,m=p*a;d<o;++d,m+=p){var g=s[n+m],v=s[n+m+r],y=l[d];t:for(var x=c,b=p*c;x<u;++x,b+=p){var _=f[n+b],w=h[x];if(!(_<g||v<_)){for(var T=n+1;T<r;++T){var k=s[T+m],A=s[T+r+m],M=f[T+b],S=f[T+r+b];if(A<M||S<k)continue t}var E=i(y,w);if(void 0!==E)return E}}}}(r,n,i,o,s,l,c,u,f,h,p):a?function(r,n,i,a,o,s,l,c,u,f,h){for(var p=2*r,d=c,m=p*c;d<u;++d,m+=p){var g=f[n+m],v=h[d];t:for(var y=a,x=p*a;y<o;++y,x+=p){var b=s[n+x],_=s[n+x+r],w=l[y];if(!(g<=b||_<g)){for(var T=n+1;T<r;++T){var k=s[T+x],A=s[T+r+x],M=f[T+m],S=f[T+r+m];if(A<M||S<k)continue t}var E=i(v,w);if(void 0!==E)return E}}}}(r,n,i,o,s,l,c,u,f,h,p):function(r,n,i,a,o,s,l,c,u,f,h){for(var p=2*r,d=c,m=p*c;d<u;++d,m+=p){var g=f[n+m],v=h[d];t:for(var y=a,x=p*a;y<o;++y,x+=p){var b=s[n+x],_=s[n+x+r],w=l[y];if(!(g<b||_<g)){for(var T=n+1;T<r;++T){var k=s[T+x],A=s[T+r+x],M=f[T+m],S=f[T+r+m];if(A<M||S<k)continue t}var E=i(w,v);if(void 0!==E)return E}}}}(r,n,i,o,s,l,c,u,f,h,p)}}i.partial=a(!1),i.full=a(!0)},{}],37:[function(r,n,i){"use strict";n.exports=function(r,n,i,s,h,w,T,k,A){M=s+T,S=8*o.log2(M+1)*(r+1)|0,E=o.nextPow2(6*S),x.length<E&&(a.free(x),x=a.mallocInt32(E)),L=o.nextPow2(2*S),b.length<L&&(a.free(b),b=a.mallocDouble(L));var M,S,E,L,C,P=0,I=2*r;for(_(P++,0,0,s,0,T,i?16:0,-1/0,1/0),i||_(P++,0,0,T,0,s,1,-1/0,1/0);P>0;){var O=6*(P-=1),z=x[O],D=x[O+1],R=x[O+2],F=x[O+3],B=x[O+4],N=x[O+5],j=2*P,U=b[j],V=b[j+1],H=1&N,q=!!(16&N),G=h,Y=w,W=k,X=A;if(H&&(G=k,Y=A,W=h,X=w),!(2&N&&(R=m(r,z,D,R,G,Y,V),D>=R)||4&N&&(D=g(r,z,D,R,G,Y,U))>=R)){var Z=R-D,J=B-F;if(q){if(r*Z*(Z+J)<4194304){if(void 0!==(C=u.scanComplete(r,z,n,D,R,G,Y,F,B,W,X)))return C;continue}}else{if(r*Math.min(Z,J)<128){if(void 0!==(C=l(r,z,n,H,D,R,G,Y,F,B,W,X)))return C;continue}if(r*Z*J<4194304){if(void 0!==(C=u.scanBipartite(r,z,n,H,D,R,G,Y,F,B,W,X)))return C;continue}}var K=p(r,z,D,R,G,Y,U,V);if(D<K){if(r*(K-D)<128){if(void 0!==(C=c(r,z+1,n,D,K,G,Y,F,B,W,X)))return C}else if(z===r-2){if(void 0!==(C=H?u.sweepBipartite(r,n,F,B,W,X,D,K,G,Y):u.sweepBipartite(r,n,D,K,G,Y,F,B,W,X)))return C}else _(P++,z+1,D,K,F,B,H,-1/0,1/0),_(P++,z+1,F,B,D,K,1^H,-1/0,1/0)}if(K<R){var Q,$=f(r,z,F,B,W,X),tt=W[I*$+z],te=d(r,z,$,B,W,X,tt);if(te<B&&_(P++,z,K,R,te,B,(4|H)+(q?16:0),tt,V),F<$&&_(P++,z,K,R,F,$,(2|H)+(q?16:0),U,tt),$+1===te){if(void 0!==(C=q?function(r,n,i,a,o,s,l,c,u,f){var h=2*r,p=c*h,d=u[p+n];t:for(var m=a,g=a*h;m<o;++m,g+=h){var v=l[m];if(v!==f){var y=s[g+n],x=s[g+n+r];if(!(d<y||x<d)){for(var b=n+1;b<r;++b){y=s[g+b],x=s[g+b+r];var _=u[p+b],w=u[p+b+r];if(x<_||w<y)continue t}var T=i(v,f);if(void 0!==T)return T}}}}(r,z,n,K,R,G,Y,$,W,X[$]):function(r,n,i,a,o,s,l,c,u,f,h){var p=2*r,d=u*p,m=f[d+n];t:for(var g=o,v=o*p;g<s;++g,v+=p){var y=l[v+n],x=l[v+n+r];if(!(m<y||x<m)&&(!a||m!==y)){for(var b,_=c[g],w=n+1;w<r;++w){y=l[v+w],x=l[v+w+r];var T=f[d+w],k=f[d+w+r];if(x<T||k<y)continue t}if(void 0!==(b=a?i(h,_):i(_,h)))return b}}}(r,z,n,H,K,R,G,Y,$,W,X[$])))return C}else if($<te){if(q){if(Q=v(r,z,K,R,G,Y,tt),K<Q){var tr=d(r,z,K,Q,G,Y,tt);if(z===r-2){if(K<tr&&void 0!==(C=u.sweepComplete(r,n,K,tr,G,Y,$,te,W,X))||tr<Q&&void 0!==(C=u.sweepBipartite(r,n,tr,Q,G,Y,$,te,W,X)))return C}else K<tr&&_(P++,z+1,K,tr,$,te,16,-1/0,1/0),tr<Q&&(_(P++,z+1,tr,Q,$,te,0,-1/0,1/0),_(P++,z+1,$,te,tr,Q,1,-1/0,1/0))}}else Q=H?y(r,z,K,R,G,Y,tt):v(r,z,K,R,G,Y,tt),K<Q&&(z===r-2?C=H?u.sweepBipartite(r,n,$,te,W,X,K,Q,G,Y):u.sweepBipartite(r,n,K,Q,G,Y,$,te,W,X):(_(P++,z+1,K,Q,$,te,H,-1/0,1/0),_(P++,z+1,$,te,K,Q,1^H,-1/0,1/0)))}}}}};var a=r("typedarray-pool"),o=r("bit-twiddle"),s=r("./brute"),l=s.partial,c=s.full,u=r("./sweep"),f=r("./median"),h=r("./partition"),p=h("!(lo>=p0)&&!(p1>=hi)"),d=h("lo===p0"),m=h("lo<p0"),g=h("hi<=p0"),v=h("lo<=p0&&p0<=hi"),y=h("lo<p0&&p0<=hi"),x=a.mallocInt32(1024),b=a.mallocDouble(1024);function _(r,n,i,a,o,s,l,c,u){var f=6*r;x[f]=n,x[f+1]=i,x[f+2]=a,x[f+3]=o,x[f+4]=s,x[f+5]=l;var h=2*r;b[h]=c,b[h+1]=u}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(r,n,i){"use strict";n.exports=function(r,n,i,o,s,l){if(o<=i+1)return i;for(var c=i,u=o,f=o+i>>>1,h=2*r,p=f,d=s[h*f+n];c<u;){if(u-c<8){(function(r,n,i,a,o,s){for(var l=2*r,c=l*(i+1)+n,u=i+1;u<a;++u,c+=l)for(var f=o[c],h=u,p=l*(u-1);h>i&&o[p+n]>f;--h,p-=l){for(var d=p,m=p+l,g=0;g<l;++g,++d,++m){var v=o[d];o[d]=o[m],o[m]=v}var y=s[h];s[h]=s[h-1],s[h-1]=y}})(r,n,c,u,s,l),d=s[h*f+n];break}var m=u-c,g=Math.random()*m+c|0,v=s[h*g+n],y=Math.random()*m+c|0,x=s[h*y+n],b=Math.random()*m+c|0,_=s[h*b+n];v<=x?_>=x?(p=y,d=x):v>=_?(p=g,d=v):(p=b,d=_):x>=_?(p=y,d=x):_>=v?(p=g,d=v):(p=b,d=_);for(var w=h*(u-1),T=h*p,k=0;k<h;++k,++w,++T){var A=s[w];s[w]=s[T],s[T]=A}var M=l[u-1];for(l[u-1]=l[p],l[p]=M,p=a(r,n,c,u-1,s,l,d),w=h*(u-1),T=h*p,k=0;k<h;++k,++w,++T)A=s[w],s[w]=s[T],s[T]=A;if(M=l[u-1],l[u-1]=l[p],l[p]=M,f<p){for(u=p-1;c<u&&s[h*(u-1)+n]===d;)u-=1;u+=1}else{if(!(p<f))break;for(c=p+1;c<u&&s[h*c+n]===d;)c+=1}}return a(r,n,i,f,s,l,s[h*f+n])};var a=r("./partition")("lo<p0")},{"./partition":39}],39:[function(r,n,i){"use strict";n.exports=function(r){return a[r]};var a={"lo===p0":function(r,n,i,a,o,s,l){for(var c=2*r,u=c*i,f=u,h=i,p=i;a>p;++p,u+=c)if(o[u+n]===l){if(h===p)h+=1,f+=c;else{for(var d=0;c>d;++d){var m=o[u+d];o[u+d]=o[f],o[f++]=m}var g=s[p];s[p]=s[h],s[h++]=g}}return h},"lo<p0":function(r,n,i,a,o,s,l){for(var c=2*r,u=c*i,f=u,h=i,p=i;a>p;++p,u+=c)if(o[u+n]<l){if(h===p)h+=1,f+=c;else{for(var d=0;c>d;++d){var m=o[u+d];o[u+d]=o[f],o[f++]=m}var g=s[p];s[p]=s[h],s[h++]=g}}return h},"lo<=p0":function(r,n,i,a,o,s,l){for(var c=2*r,u=c*i,f=u,h=i,p=r+n,d=i;a>d;++d,u+=c)if(o[u+p]<=l){if(h===d)h+=1,f+=c;else{for(var m=0;c>m;++m){var g=o[u+m];o[u+m]=o[f],o[f++]=g}var v=s[d];s[d]=s[h],s[h++]=v}}return h},"hi<=p0":function(r,n,i,a,o,s,l){for(var c=2*r,u=c*i,f=u,h=i,p=r+n,d=i;a>d;++d,u+=c)if(o[u+p]<=l){if(h===d)h+=1,f+=c;else{for(var m=0;c>m;++m){var g=o[u+m];o[u+m]=o[f],o[f++]=g}var v=s[d];s[d]=s[h],s[h++]=v}}return h},"lo<p0&&p0<=hi":function(r,n,i,a,o,s,l){for(var c=2*r,u=c*i,f=u,h=i,p=r+n,d=i;a>d;++d,u+=c){var m=o[u+n],g=o[u+p];if(m<l&&l<=g){if(h===d)h+=1,f+=c;else{for(var v=0;c>v;++v){var y=o[u+v];o[u+v]=o[f],o[f++]=y}var x=s[d];s[d]=s[h],s[h++]=x}}}return h},"lo<=p0&&p0<=hi":function(r,n,i,a,o,s,l){for(var c=2*r,u=c*i,f=u,h=i,p=r+n,d=i;a>d;++d,u+=c){var m=o[u+n],g=o[u+p];if(m<=l&&l<=g){if(h===d)h+=1,f+=c;else{for(var v=0;c>v;++v){var y=o[u+v];o[u+v]=o[f],o[f++]=y}var x=s[d];s[d]=s[h],s[h++]=x}}}return h},"!(lo>=p0)&&!(p1>=hi)":function(r,n,i,a,o,s,l,c){for(var u=2*r,f=u*i,h=f,p=i,d=r+n,m=i;a>m;++m,f+=u){var g=o[f+n],v=o[f+d];if(!(g>=l||c>=v)){if(p===m)p+=1,h+=u;else{for(var y=0;u>y;++y){var x=o[f+y];o[f+y]=o[h],o[h++]=x}var b=s[m];s[m]=s[p],s[p++]=b}}}return p}}},{}],40:[function(r,n,i){"use strict";function a(r,n,i){for(var a=2*(r+1),o=r+1;o<=n;++o){for(var s=i[a++],l=i[a++],c=o,u=a-2;c-- >r;){var f=i[u-2],h=i[u-1];if(f<s||f===s&&h<l)break;i[u]=f,i[u+1]=h,u-=2}i[u]=s,i[u+1]=l}}function o(r,n,i){n*=2;var a=i[r*=2],o=i[r+1];i[r]=i[n],i[r+1]=i[n+1],i[n]=a,i[n+1]=o}function s(r,n,i){n*=2,i[r*=2]=i[n],i[r+1]=i[n+1]}function l(r,n,i,a,o){n*=2,o[r*=2]=o[n],o[n]=i,o[r+1]=o[n+1],o[n+1]=a}function c(r,n,i){n*=2;var a=i[r*=2],o=i[n];return!(a<o)&&(a!==o||i[r+1]>i[n+1])}function u(r,n,i,a){var o=a[r*=2];return o<n||o===n&&a[r+1]<i}n.exports=function(r,n){n<=128?a(0,n-1,r):function r(n,i,f){var h=(i-n+1)/6|0,p=n+h,d=i-h,m=n+i>>1,g=m-h,v=m+h,y=p,x=g,b=m,_=v,w=d,T=n+1,k=i-1,A=0;c(y,x,f)&&(A=y,y=x,x=A),c(_,w,f)&&(A=_,_=w,w=A),c(y,b,f)&&(A=y,y=b,b=A),c(x,b,f)&&(A=x,x=b,b=A),c(y,_,f)&&(A=y,y=_,_=A),c(b,_,f)&&(A=b,b=_,_=A),c(x,w,f)&&(A=x,x=w,w=A),c(x,b,f)&&(A=x,x=b,b=A),c(_,w,f)&&(A=_,_=w,w=A);for(var M=f[2*x],S=f[2*x+1],E=f[2*_],L=f[2*_+1],C=2*y,P=2*b,I=2*w,O=2*p,z=2*m,D=2*d,R=0;R<2;++R){var F=f[C+R],B=f[P+R],N=f[I+R];f[O+R]=F,f[z+R]=B,f[D+R]=N}s(g,n,f),s(v,i,f);for(var j=T;j<=k;++j)if(u(j,M,S,f))j!==T&&o(j,T,f),++T;else if(!u(j,E,L,f))for(;;){if(u(k,E,L,f)){u(k,M,S,f)?(function(r,n,i,a){n*=2,i*=2;var o=a[r*=2],s=a[r+1];a[r]=a[n],a[r+1]=a[n+1],a[n]=a[i],a[n+1]=a[i+1],a[i]=o,a[i+1]=s}(j,T,k,f),++T):o(j,k,f),--k;break}if(--k<j)break}l(n,T-1,M,S,f),l(i,k+1,E,L,f),T-2-n<=32?a(n,T-2,f):r(n,T-2,f),i-(k+2)<=32?a(k+2,i,f):r(k+2,i,f),k-T<=32?a(T,k,f):r(T,k,f)}(0,n-1,r)}},{}],41:[function(r,n,i){"use strict";n.exports={init:function(r){var n=o.nextPow2(r);l.length<n&&(a.free(l),l=a.mallocInt32(n)),c.length<n&&(a.free(c),c=a.mallocInt32(n)),u.length<n&&(a.free(u),u=a.mallocInt32(n)),f.length<n&&(a.free(f),f=a.mallocInt32(n)),h.length<n&&(a.free(h),h=a.mallocInt32(n)),p.length<n&&(a.free(p),p=a.mallocInt32(n));var i=8*n;d.length<i&&(a.free(d),d=a.mallocDouble(i))},sweepBipartite:function(r,n,i,a,o,h,p,v,y,x){for(var b=0,_=2*r,w=r-1,T=_-1,k=i;k<a;++k){var A=h[k],M=_*k;d[b++]=o[M+w],d[b++]=-(A+1),d[b++]=o[M+T],d[b++]=A}for(k=p;k<v;++k){A=x[k]+268435456;var S=_*k;d[b++]=y[S+w],d[b++]=-A,d[b++]=y[S+T],d[b++]=A}var E=b>>>1;s(d,E);var L=0,C=0;for(k=0;k<E;++k){var P,I=0|d[2*k+1];if(I>=268435456)m(u,f,C--,I=I-268435456|0);else if(I>=0)m(l,c,L--,I);else if(I<=-268435456){I=-I-268435456|0;for(var O=0;O<L;++O)if(void 0!==(P=n(l[O],I)))return P;g(u,f,C++,I)}else{for(O=0,I=-I-1|0;O<C;++O)if(void 0!==(P=n(I,u[O])))return P;g(l,c,L++,I)}}},sweepComplete:function(r,n,i,a,o,v,y,x,b,_){for(var w=0,T=2*r,k=r-1,A=T-1,M=i;M<a;++M){var S=v[M]+1<<1,E=T*M;d[w++]=o[E+k],d[w++]=-S,d[w++]=o[E+A],d[w++]=S}for(M=y;M<x;++M){S=_[M]+1<<1;var L=T*M;d[w++]=b[L+k],d[w++]=1|-S,d[w++]=b[L+A],d[w++]=1|S}var C=w>>>1;s(d,C);var P=0,I=0,O=0;for(M=0;M<C;++M){var z=0|d[2*M+1],D=1&z;if(M<C-1&&z>>1==d[2*M+3]>>1&&(D=2,M+=1),z<0){for(var R,F=-(z>>1)-1,B=0;B<O;++B)if(void 0!==(R=n(h[B],F)))return R;if(0!==D){for(B=0;B<P;++B)if(void 0!==(R=n(l[B],F)))return R}if(1!==D){for(B=0;B<I;++B)if(void 0!==(R=n(u[B],F)))return R}0===D?g(l,c,P++,F):1===D?g(u,f,I++,F):2===D&&g(h,p,O++,F)}else F=(z>>1)-1,0===D?m(l,c,P--,F):1===D?m(u,f,I--,F):2===D&&m(h,p,O--,F)}},scanBipartite:function(r,n,i,a,o,u,f,h,p,v,y,x){var b=0,_=2*r,w=n+r,T=1,k=1;a?k=268435456:T=268435456;for(var A=o;A<u;++A){var M=A+T,S=_*A;d[b++]=f[S+n],d[b++]=-M,d[b++]=f[S+w],d[b++]=M}for(A=p;A<v;++A){M=A+k;var E=_*A;d[b++]=y[E+n],d[b++]=-M}var L=b>>>1;s(d,L);var C=0;for(A=0;A<L;++A){var P=0|d[2*A+1];if(P<0){var I=!1;if((M=-P)>=268435456?(I=!a,M-=268435456):(I=!!a,M-=1),I)g(l,c,C++,M);else{var O=x[M],z=_*M,D=y[z+n+1],R=y[z+n+1+r];t:for(var F=0;F<C;++F){var B=l[F],N=_*B;if(!(R<f[N+n+1]||f[N+n+1+r]<D)){for(var j=n+2;j<r;++j)if(y[z+j+r]<f[N+j]||f[N+j+r]<y[z+j])continue t;var U,V=h[B];if(void 0!==(U=a?i(O,V):i(V,O)))return U}}}}else m(l,c,C--,P-T)}},scanComplete:function(r,n,i,a,o,c,u,f,h,p,m){for(var g=0,v=2*r,y=n+r,x=a;x<o;++x){var b=x+268435456,_=v*x;d[g++]=c[_+n],d[g++]=-b,d[g++]=c[_+y],d[g++]=b}for(x=f;x<h;++x){b=x+1;var w=v*x;d[g++]=p[w+n],d[g++]=-b}var T=g>>>1;s(d,T);var k=0;for(x=0;x<T;++x){var A=0|d[2*x+1];if(A<0){if((b=-A)>=268435456)l[k++]=b-268435456;else{var M=m[b-=1],S=v*b,E=p[S+n+1],L=p[S+n+1+r];t:for(var C=0;C<k;++C){var P=l[C],I=u[P];if(I===M)break;var O=v*P;if(!(L<c[O+n+1]||c[O+n+1+r]<E)){for(var z=n+2;z<r;++z)if(p[S+z+r]<c[O+z]||c[O+z+r]<p[S+z])continue t;var D=i(I,M);if(void 0!==D)return D}}}}else{for(b=A-268435456,C=k-1;C>=0;--C)if(l[C]===b){for(z=C+1;z<k;++z)l[z-1]=l[z];break}--k}}}};var a=r("typedarray-pool"),o=r("bit-twiddle"),s=r("./sort"),l=a.mallocInt32(1024),c=a.mallocInt32(1024),u=a.mallocInt32(1024),f=a.mallocInt32(1024),h=a.mallocInt32(1024),p=a.mallocInt32(1024),d=a.mallocDouble(8192);function m(r,n,i,a){var o=n[a],s=r[i-1];r[o]=s,n[s]=o}function g(r,n,i,a){r[i]=a,n[a]=i}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(r,n,i){"use strict";var a=r("./lib/monotone"),o=r("./lib/triangulation"),s=r("./lib/delaunay"),l=r("./lib/filter");function c(r){return[Math.min(r[0],r[1]),Math.max(r[0],r[1])]}function u(r,n){return r[0]-n[0]||r[1]-n[1]}function f(r,n,i){return n in r?r[n]:i}n.exports=function(r,n,i){Array.isArray(n)?(i=i||{},n=n||[]):(i=n||{},n=[]);var h=!!f(i,"delaunay",!0),p=!!f(i,"interior",!0),d=!!f(i,"exterior",!0),m=!!f(i,"infinity",!1);if(!p&&!d||0===r.length)return[];var g=a(r,n);if(h||p!==d||m){for(var v=o(r.length,n.map(c).sort(u)),y=0;y<g.length;++y){var x=g[y];v.addTriangle(x[0],x[1],x[2])}return h&&s(r,v),d?p?m?l(v,0,m):v.cells():l(v,1,m):l(v,-1)}return g}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(r,n,i){"use strict";var a=r("robust-in-sphere")[4];function o(r,n,i,o,s,l){var c=n.opposite(o,s);if(!(c<0)){if(s<o){var u=o;o=s,s=u,u=l,l=c,c=u}n.isConstraint(o,s)||0>a(r[o],r[s],r[l],r[c])&&i.push(o,s)}}r("binary-search-bounds"),n.exports=function(r,n){for(var i=[],s=r.length,l=n.stars,c=0;c<s;++c)for(var u=l[c],f=1;f<u.length;f+=2)if(!((m=u[f])<c)&&!n.isConstraint(c,m)){for(var h=u[f-1],p=-1,d=1;d<u.length;d+=2)if(u[d-1]===m){p=u[d];break}p<0||0>a(r[c],r[m],r[h],r[p])&&i.push(c,m)}for(;i.length>0;){for(var m=i.pop(),g=(c=i.pop(),h=-1,p=-1,u=l[c],1);g<u.length;g+=2){var v=u[g-1],y=u[g];v===m?p=y:y===m&&(h=v)}h<0||p<0||a(r[c],r[m],r[h],r[p])>=0||(n.flip(c,m),o(r,n,i,h,c,p),o(r,n,i,c,p,h),o(r,n,i,p,m,h),o(r,n,i,m,h,p))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(r,n,i){"use strict";var a,o=r("binary-search-bounds");function s(r,n,i,a,o,s,l){this.cells=r,this.neighbor=n,this.flags=a,this.constraint=i,this.active=o,this.next=s,this.boundary=l}function l(r,n){return r[0]-n[0]||r[1]-n[1]||r[2]-n[2]}n.exports=function(r,n,i){var a=function(r,n){for(var i=r.cells(),a=i.length,o=0;o<a;++o){var c=(x=i[o])[0],u=x[1],f=x[2];u<f?u<c&&(x[0]=u,x[1]=f,x[2]=c):f<c&&(x[0]=f,x[1]=c,x[2]=u)}i.sort(l);var h=Array(a);for(o=0;o<h.length;++o)h[o]=0;var p=[],d=[],m=Array(3*a),g=Array(3*a),v=null;n&&(v=[]);var y=new s(i,m,g,h,p,d,v);for(o=0;o<a;++o)for(var x=i[o],b=0;b<3;++b){c=x[b],u=x[(b+1)%3];var _=m[3*o+b]=y.locate(u,c,r.opposite(u,c)),w=g[3*o+b]=r.isConstraint(c,u);_<0&&(w?d.push(o):(p.push(o),h[o]=1),n&&v.push([u,c,-1]))}return y}(r,i);if(0===n)return i?a.cells.concat(a.boundary):a.cells;for(var o=1,c=a.active,u=a.next,f=a.flags,h=a.cells,p=a.constraint,d=a.neighbor;c.length>0||u.length>0;){for(;c.length>0;){var m=c.pop();if(f[m]!==-o){f[m]=o,h[m];for(var g=0;g<3;++g){var v=d[3*m+g];v>=0&&0===f[v]&&(p[3*m+g]?u.push(v):(c.push(v),f[v]=o))}}}var y=u;u=c,c=y,u.length=0,o=-o}var x=function(r,n,i){for(var a=0,o=0;o<r.length;++o)n[o]===i&&(r[a++]=r[o]);return r.length=a,r}(h,f,n);return i?x.concat(a.boundary):x},s.prototype.locate=(a=[0,0,0],function(r,n,i){var s=r,c=n,u=i;return n<i?n<r&&(s=n,c=i,u=r):i<r&&(s=i,c=r,u=n),s<0?-1:(a[0]=s,a[1]=c,a[2]=u,o.eq(this.cells,a,l))})},{"binary-search-bounds":31}],45:[function(r,n,i){"use strict";var a=r("binary-search-bounds"),o=r("robust-orientation")[3];function s(r,n,i,a,o){this.a=r,this.b=n,this.idx=i,this.lowerIds=a,this.upperIds=o}function l(r,n,i,a){this.a=r,this.b=n,this.type=i,this.idx=a}function c(r,n){var i=r.a[0]-n.a[0]||r.a[1]-n.a[1]||r.type-n.type;return i||(0!==r.type&&(i=o(r.a,r.b,n.b))?i:r.idx-n.idx)}function u(r,n){return o(r.a,r.b,n)}function f(r,n){var i;return(i=r.a[0]<n.a[0]?o(r.a,r.b,n.a):o(n.b,n.a,r.a))?i:(i=n.b[0]<r.b[0]?o(r.a,r.b,n.b):o(n.b,n.a,r.b))||r.idx-n.idx}n.exports=function(r,n){for(var i=r.length,h=n.length,p=[],d=0;d<i;++d)p.push(new l(r[d],null,0,d));for(d=0;d<h;++d){var m=n[d],g=r[m[0]],v=r[m[1]];g[0]<v[0]?p.push(new l(g,v,2,d),new l(v,g,1,d)):g[0]>v[0]&&p.push(new l(v,g,2,d),new l(g,v,1,d))}p.sort(c);for(var y=p[0].a[0]-(1+Math.abs(p[0].a[0]))*2220446049250313e-31,x=[new s([y,1],[y,0],-1,[],[],[],[])],b=[],_=(d=0,p.length);d<_;++d){var w=p[d],T=w.type;0===T?function(r,n,i,s,l){for(var c=a.lt(n,s,u),f=a.gt(n,s,u),h=c;h<f;++h){for(var p=n[h],d=p.lowerIds,m=d.length;m>1&&o(i[d[m-2]],i[d[m-1]],s)>0;)r.push([d[m-1],d[m-2],l]),m-=1;d.length=m,d.push(l);var g=p.upperIds;for(m=g.length;m>1&&0>o(i[g[m-2]],i[g[m-1]],s);)r.push([g[m-2],g[m-1],l]),m-=1;g.length=m,g.push(l)}}(b,x,r,w.a,w.idx):2===T?function(r,n,i){var o=a.le(r,i,f),l=r[o],c=l.upperIds,u=c[c.length-1];l.upperIds=[u],r.splice(o+1,0,new s(i.a,i.b,i.idx,[u],c))}(x,0,w):function(r,n,i){var o=i.a;i.a=i.b,i.b=o;var s=a.eq(r,i,f),l=r[s];r[s-1].upperIds=l.upperIds,r.splice(s,1)}(x,0,w)}return b}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(r,n,i){"use strict";var a=r("binary-search-bounds");function o(r,n){this.stars=r,this.edges=n}n.exports=function(r,n){for(var i=Array(r),a=0;a<r;++a)i[a]=[];return new o(i,n)};var s=o.prototype;function l(r,n,i){for(var a=1,o=r.length;a<o;a+=2)if(r[a-1]===n&&r[a]===i)return r[a-1]=r[o-2],r[a]=r[o-1],void(r.length=o-2)}s.isConstraint=function(){var r=[0,0];function n(r,n){return r[0]-n[0]||r[1]-n[1]}return function(i,o){return r[0]=Math.min(i,o),r[1]=Math.max(i,o),a.eq(this.edges,r,n)>=0}}(),s.removeTriangle=function(r,n,i){var a=this.stars;l(a[r],n,i),l(a[n],i,r),l(a[i],r,n)},s.addTriangle=function(r,n,i){var a=this.stars;a[r].push(n,i),a[n].push(i,r),a[i].push(r,n)},s.opposite=function(r,n){for(var i=this.stars[n],a=1,o=i.length;a<o;a+=2)if(i[a]===r)return i[a-1];return -1},s.flip=function(r,n){var i=this.opposite(r,n),a=this.opposite(n,r);this.removeTriangle(r,n,i),this.removeTriangle(n,r,a),this.addTriangle(r,a,i),this.addTriangle(n,i,a)},s.edges=function(){for(var r=this.stars,n=[],i=0,a=r.length;i<a;++i)for(var o=r[i],s=0,l=o.length;s<l;s+=2)n.push([o[s],o[s+1]]);return n},s.cells=function(){for(var r=this.stars,n=[],i=0,a=r.length;i<a;++i)for(var o=r[i],s=0,l=o.length;s<l;s+=2){var c=o[s],u=o[s+1];i<Math.min(c,u)&&n.push([i,c,u])}return n}},{"binary-search-bounds":31}],47:[function(r,n,i){"use strict";n.exports=function(r){for(var n=1,i=1;i<r.length;++i)for(var a=0;a<i;++a)if(r[i]<r[a])n=-n;else if(r[a]===r[i])return 0;return n}},{}],48:[function(r,n,i){"use strict";var a=r("dup"),o=r("robust-linear-solve");function s(r,n){for(var i=0,a=r.length,o=0;o<a;++o)i+=r[o]*n[o];return i}function l(r){var n=r.length;if(0===n)return[];r[0].length;var i=a([r.length+1,r.length+1],1),l=a([r.length+1],1);i[n][n]=0;for(var c=0;c<n;++c){for(var u=0;u<=c;++u)i[u][c]=i[c][u]=2*s(r[c],r[u]);l[c]=s(r[c],r[c])}var f=o(i,l),h=0,p=f[n+1];for(c=0;c<p.length;++c)h+=p[c];var d=Array(n);for(c=0;c<n;++c){p=f[c];var m=0;for(u=0;u<p.length;++u)m+=p[u];d[c]=m/h}return d}function c(r){if(0===r.length)return[];for(var n=r[0].length,i=a([n]),o=l(r),s=0;s<r.length;++s)for(var c=0;c<n;++c)i[c]+=r[s][c]*o[s];return i}c.barycenetric=l,n.exports=c},{dup:65,"robust-linear-solve":283}],49:[function(r,n,i){n.exports=function(r){for(var n=a(r),i=0,o=0;o<r.length;++o)for(var s=r[o],l=0;l<n.length;++l)i+=Math.pow(s[l]-n[l],2);return Math.sqrt(i/r.length)};var a=r("circumcenter")},{circumcenter:48}],50:[function(r,n,i){"use strict";n.exports=function(r,n,i){if(i){E=n;for(var a,d,v,y,b,_,w,T,k,A,M,S,E,L=Array(n.length),C=0;C<n.length;++C){var P=n[C];L[C]=[P[0],P[1],i[C]]}n=L}for(var I=(A=n,M=!!i,x(A,S=g(r,[],m(r)),M),!!S);a=r,d=n,v=!!i,w=(y=[],o(_=function(r,n){for(var i=Array(n.length),a=0;a<n.length;++a){var o=n[a],s=r[o[0]],l=r[o[1]];i[a]=[h(Math.min(s[0],l[0]),-1/0),h(Math.min(s[1],l[1]),-1/0),h(Math.max(s[0],l[0]),1/0),h(Math.max(s[1],l[1]),1/0)]}return i}(a,d),function(r,n){var i=d[r],o=d[n];i[0]!==o[0]&&i[0]!==o[1]&&i[1]!==o[0]&&i[1]!==o[1]&&s(a[i[0]],a[i[1]],a[o[0]],a[o[1]])&&y.push([r,n])}),y),T=(b=[],o(_,m(a),function(r,n){var i=d[r];if(i[0]!==n&&i[1]!==n){var o=a[n];s(a[i[0]],a[i[1]],o,o)&&b.push([r,n])}}),b),k=g(a,function(r,n,i,a,o){var s,h,d=r.map(function(r){return[l(r[0]),l(r[1])]});for(s=0;s<i.length;++s){var m=i[s];h=m[0];var g=m[1],v=n[h],y=n[g],x=p(f(r[v[0]]),f(r[v[1]]),f(r[y[0]]),f(r[y[1]]));if(x){var b=r.length;r.push([u(x[0]),u(x[1])]),d.push(x),a.push([h,b],[g,b])}}for(a.sort(function(r,n){if(r[0]!==n[0])return r[0]-n[0];var i=d[r[1]],a=d[n[1]];return c(i[0],a[0])||c(i[1],a[1])}),s=a.length-1;s>=0;--s){var _=n[h=(L=a[s])[0]],w=_[0],T=_[1],k=r[w],A=r[T];if(0>(k[0]-A[0]||k[1]-A[1])){var M=w;w=T,T=M}_[0]=w;var S,E=_[1]=L[1];for(o&&(S=_[2]);s>0&&a[s-1][0]===h;){var L,C=(L=a[--s])[1];o?n.push([E,C,S]):n.push([E,C]),E=C}o?n.push([E,T,S]):n.push([E,T])}return d}(a,d,w,T,v)),x(d,k,v),k||w.length>0||T.length>0;)I=!0;if(i&&I)for(E.length=0,i.length=0,C=0;C<n.length;++C)P=n[C],E.push([P[0],P[1]]),i.push(P[2]);return I};var a=r("union-find"),o=r("box-intersect"),s=r("robust-segment-intersect"),l=r("big-rat"),c=r("big-rat/cmp"),u=r("big-rat/to-float"),f=r("rat-vec"),h=r("nextafter"),p=r("./lib/rat-seg-intersect");function d(r){var n=u(r);return[h(n,-1/0),h(n,1/0)]}function m(r){for(var n=Array(r.length),i=0;i<r.length;++i){var a=r[i];n[i]=[h(a[0],-1/0),h(a[1],-1/0),h(a[0],1/0),h(a[1],1/0)]}return n}function g(r,n,i){for(var s,l=n.length,c=new a(l),u=[],f=0;f<n.length;++f){var p=n[f],m=d(p[0]),g=d(p[1]);u.push([h(m[0],-1/0),h(g[0],-1/0),h(m[1],1/0),h(g[1],1/0)])}o(u,function(r,n){c.link(r,n)});var v=!0,y=Array(l);for(f=0;f<l;++f)(s=c.find(f))!==f&&(v=!1,r[s]=[Math.min(r[f][0],r[s][0]),Math.min(r[f][1],r[s][1])]);if(v)return null;var x=0;for(f=0;f<l;++f)(s=c.find(f))===f?(y[f]=x,r[x++]=r[f]):y[f]=-1;for(f=0,r.length=x;f<l;++f)y[f]<0&&(y[f]=y[c.find(f)]);return y}function v(r,n){return r[0]-n[0]||r[1]-n[1]}function y(r,n){return r[0]-n[0]||r[1]-n[1]||(r[2]<n[2]?-1:r[2]>n[2]?1:0)}function x(r,n,i){if(0!==r.length){if(n)for(var a,o=0;o<r.length;++o){var s=n[(a=r[o])[0]],l=n[a[1]];a[0]=Math.min(s,l),a[1]=Math.max(s,l)}else for(o=0;o<r.length;++o)s=(a=r[o])[0],l=a[1],a[0]=Math.min(s,l),a[1]=Math.max(s,l);i?r.sort(y):r.sort(v);var c=1;for(o=1;o<r.length;++o){var u=r[o-1],f=r[o];(f[0]!==u[0]||f[1]!==u[1]||i&&f[2]!==u[2])&&(r[c++]=f)}r.length=c}}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(r,n,i){"use strict";n.exports=function(r,n,i,a){var s=c(n,r),p=c(a,i),d=h(s,p);if(0===l(d))return null;var m=f(s,o(h(p,c(r,i)),d));return u(r,m)};var a=r("big-rat/mul"),o=r("big-rat/div"),s=r("big-rat/sub"),l=r("big-rat/sign"),c=r("rat-vec/sub"),u=r("rat-vec/add"),f=r("rat-vec/muls");function h(r,n){return s(a(r[0],n[1]),a(r[1],n[0]))}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(r,n,i){n.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(r,n,i){"use strict";var a=r("./colorScale"),o=r("lerp");function s(r){return[r[0]/255,r[1]/255,r[2]/255,r[3]]}function l(r){for(var n,i="#",a=0;a<3;++a)i+=("00"+(n=(n=r[a]).toString(16))).substr(n.length);return i}function c(r){return"rgba("+r.join(",")+")"}n.exports=function(r){if(r||(r={}),m=(r.nshades||72)-1,d=r.format||"hex",(p=r.colormap)||(p="jet"),"string"==typeof p){if(!a[p=p.toLowerCase()])throw Error(p+" not a supported colorscale");h=a[p]}else{if(!Array.isArray(p))throw Error("unsupported colormap option",p);h=p.slice()}if(h.length>m+1)throw Error(p+" map requires nshades to be at least size "+h.length);g=Array.isArray(r.alpha)?2!==r.alpha.length?[1,1]:r.alpha.slice():"number"==typeof r.alpha?[r.alpha,r.alpha]:[1,1],n=h.map(function(r){return Math.round(r.index*m)}),g[0]=Math.min(Math.max(g[0],0),1),g[1]=Math.min(Math.max(g[1],0),1);var n,i,u,f,h,p,d,m,g,v,y=h.map(function(r,n){var i=h[n].index,a=h[n].rgb.slice();return 4===a.length&&a[3]>=0&&a[3]<=1||(a[3]=g[0]+(g[1]-g[0])*i),a}),x=[];for(v=0;v<n.length-1;++v){f=n[v+1]-n[v],i=y[v],u=y[v+1];for(var b=0;b<f;b++){var _=b/f;x.push([Math.round(o(i[0],u[0],_)),Math.round(o(i[1],u[1],_)),Math.round(o(i[2],u[2],_)),o(i[3],u[3],_)])}}return x.push(h[h.length-1].rgb.concat(g[1])),"hex"===d?x=x.map(l):"rgbaString"===d?x=x.map(c):"float"===d&&(x=x.map(s)),x}},{"./colorScale":52,lerp:240}],54:[function(r,n,i){"use strict";n.exports=function(r,n,i,s){var l=a(n,i,s);if(0===l){var c=o(a(r,n,i)),f=o(a(r,n,s));if(c===f){if(0===c){var h=u(r,n,i);return h===u(r,n,s)?0:h?1:-1}return 0}return 0===f?c>0||u(r,n,s)?-1:1:0===c?f>0||u(r,n,i)?1:-1:o(f-c)}var p=a(r,n,i);return p>0?l>0&&a(r,n,s)>0?1:-1:p<0?l>0||a(r,n,s)>0?1:-1:a(r,n,s)>0||u(r,n,i)?1:-1};var a=r("robust-orientation"),o=r("signum"),s=r("two-sum"),l=r("robust-product"),c=r("robust-sum");function u(r,n,i){var a=s(r[0],-n[0]),o=s(r[1],-n[1]),u=s(i[0],-n[0]),f=s(i[1],-n[1]),h=c(l(a,u),l(o,f));return h[h.length-1]>=0}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(r,n,i){"use strict";n.exports=function(r){return r<0?-1:r>0?1:0}},{}],56:[function(r,n,i){n.exports=function(r,n){var i=r.length,s=r.length-n.length;if(s)return s;switch(i){case 0:return 0;case 1:return r[0]-n[0];case 2:return r[0]+r[1]-n[0]-n[1]||a(r[0],r[1])-a(n[0],n[1]);case 3:var l=r[0]+r[1],c=n[0]+n[1];if(s=l+r[2]-(c+n[2]))return s;var u=a(r[0],r[1]),f=a(n[0],n[1]);return a(u,r[2])-a(f,n[2])||a(u+r[2],l)-a(f+n[2],c);case 4:var h=r[0],p=r[1],d=r[2],m=r[3],g=n[0],v=n[1],y=n[2],x=n[3];return h+p+d+m-(g+v+y+x)||a(h,p,d,m)-a(g,v,y,x,g)||a(h+p,h+d,h+m,p+d,p+m,d+m)-a(g+v,g+y,g+x,v+y,v+x,y+x)||a(h+p+d,h+p+m,h+d+m,p+d+m)-a(g+v+y,g+v+x,g+y+x,v+y+x);default:for(var b=r.slice().sort(o),_=n.slice().sort(o),w=0;w<i;++w)if(s=b[w]-_[w])return s;return 0}};var a=Math.min;function o(r,n){return r-n}},{}],57:[function(r,n,i){"use strict";var a=r("compare-cell"),o=r("cell-orientation");n.exports=function(r,n){return a(r,n)||o(r)-o(n)}},{"cell-orientation":47,"compare-cell":56}],58:[function(r,n,i){"use strict";var a=r("./lib/ch1d"),o=r("./lib/ch2d"),s=r("./lib/chnd");n.exports=function(r){var n=r.length;if(0===n)return[];if(1===n)return[[0]];var i=r[0].length;return 0===i?[]:1===i?a(r):2===i?o(r):s(r,i)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(r,n,i){"use strict";n.exports=function(r){for(var n=0,i=0,a=1;a<r.length;++a)r[a][0]<r[n][0]&&(n=a),r[a][0]>r[i][0]&&(i=a);return n<i?[[n],[i]]:n>i?[[i],[n]]:[[n]]}},{}],60:[function(r,n,i){"use strict";n.exports=function(r){var n=a(r),i=n.length;if(i<=2)return[];for(var o=Array(i),s=n[i-1],l=0;l<i;++l){var c=n[l];o[l]=[s,c],s=c}return o};var a=r("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":246}],61:[function(r,n,i){"use strict";n.exports=function(r,n){try{return a(r,!0)}catch(s){var i=o(r);if(i.length<=n)return[];return function(r,n){for(var i=r.length,a=n.length,o=0;o<i;++o)for(var s=r[o],l=0;l<s.length;++l){var c=s[l];if(c<a)s[l]=n[c];else{c-=a;for(var u=0;u<a;++u)c>=n[u]&&(c+=1);s[l]=c}}return r}(a(function(r,n){for(var i=r.length,a=Array(i),o=0;o<n.length;++o)a[o]=r[n[o]];var s=n.length;for(o=0;o<i;++o)0>n.indexOf(o)&&(a[s++]=r[o]);return a}(r,i),!0),i)}};var a=r("incremental-convex-hull"),o=r("affine-hull")},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o,s){var l=o-1,c=o*o,u=l*l,f=(1+2*o)*u,h=o*u,p=c*(3-2*o),d=c*l;if(r.length){s||(s=Array(r.length));for(var m=r.length-1;m>=0;--m)s[m]=f*r[m]+h*n[m]+p*i[m]+d*a[m];return s}return f*r+h*n+p*i+d*a},n.exports.derivative=function(r,n,i,a,o,s){var l=6*o*o-6*o,c=3*o*o-4*o+1,u=-6*o*o+6*o,f=3*o*o-2*o;if(r.length){s||(s=Array(r.length));for(var h=r.length-1;h>=0;--h)s[h]=l*r[h]+c*n[h]+u*i[h]+f*a[h];return s}return l*r+c*n+u*i[h]+f*a}},{}],63:[function(r,n,i){"use strict";var a=r("incremental-convex-hull"),o=r("uniq");function s(r,n){this.point=r,this.index=n}function l(r,n){for(var i=r.point,a=n.point,o=i.length,s=0;s<o;++s){var l=a[s]-i[s];if(l)return l}return 0}n.exports=function(r,n){var i=r.length;if(0===i)return[];var c=r[0].length;if(c<1)return[];if(1===c)return function(r,n,i){if(1===r)return i?[[-1,0]]:[];var a=n.map(function(r,n){return[r[0],n]});a.sort(function(r,n){return r[0]-n[0]});for(var o=Array(r-1),s=1;s<r;++s){var l=a[s-1],c=a[s];o[s-1]=[l[1],c[1]]}return i&&o.push([-1,o[0][1]],[o[r-1][1],-1]),o}(i,r,n);for(var u=Array(i),f=1,h=0;h<i;++h){for(var p=r[h],d=Array(c+1),m=0,g=0;g<c;++g){var v=p[g];d[g]=v,m+=v*v}d[c]=m,u[h]=new s(d,h),f=Math.max(m,f)}o(u,l);var y=Array((i=u.length)+c+1),x=Array(i+c+1),b=(c+1)*(c+1)*f,_=Array(c+1);for(h=0;h<=c;++h)_[h]=0;for(_[c]=b,y[0]=_.slice(),x[0]=-1,h=0;h<=c;++h)(d=_.slice())[h]=1,y[h+1]=d,x[h+1]=-1;for(h=0;h<i;++h){var w=u[h];y[h+c+1]=w.point,x[h+c+1]=w.index}var T=a(y,!1);if(T=n?T.filter(function(r){for(var n=0,i=0;i<=c;++i){var a=x[r[i]];if(a<0&&++n>=2)return!1;r[i]=a}return!0}):T.filter(function(r){for(var n=0;n<=c;++n){var i=x[r[n]];if(i<0)return!1;r[n]=i}return!0}),1&c)for(h=0;h<T.length;++h)d=(w=T[h])[0],w[0]=w[1],w[1]=d;return T}},{"incremental-convex-hull":233,uniq:310}],64:[function(r,n,i){(function(r){(function(){var i=!1;if("undefined"!=typeof Float64Array){var a=new Float64Array(1),o=new Uint32Array(a.buffer);(a[0]=1,i=!0,1072693248===o[1])?(n.exports=function(r){return a[0]=r,[o[0],o[1]]},n.exports.pack=function(r,n){return o[0]=r,o[1]=n,a[0]},n.exports.lo=function(r){return a[0]=r,o[0]},n.exports.hi=function(r){return a[0]=r,o[1]}):1072693248===o[0]?(n.exports=function(r){return a[0]=r,[o[1],o[0]]},n.exports.pack=function(r,n){return o[1]=r,o[0]=n,a[0]},n.exports.lo=function(r){return a[0]=r,o[1]},n.exports.hi=function(r){return a[0]=r,o[0]}):i=!1}if(!i){var s=new r(8);n.exports=function(r){return s.writeDoubleLE(r,0,!0),[s.readUInt32LE(0,!0),s.readUInt32LE(4,!0)]},n.exports.pack=function(r,n){return s.writeUInt32LE(r,0,!0),s.writeUInt32LE(n,4,!0),s.readDoubleLE(0,!0)},n.exports.lo=function(r){return s.writeDoubleLE(r,0,!0),s.readUInt32LE(0,!0)},n.exports.hi=function(r){return s.writeDoubleLE(r,0,!0),s.readUInt32LE(4,!0)}}n.exports.sign=function(r){return n.exports.hi(r)>>>31},n.exports.exponent=function(r){return(n.exports.hi(r)<<1>>>21)-1023},n.exports.fraction=function(r){var i=n.exports.lo(r),a=n.exports.hi(r),o=1048575&a;return 2146435072&a&&(o+=1048576),[i,o]},n.exports.denormalized=function(r){return!(2146435072&n.exports.hi(r))}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:3}],65:[function(r,n,i){"use strict";n.exports=function(r,n){switch(void 0===n&&(n=0),typeof r){case"number":if(r>0)return function(r,n){var i,a;for(i=Array(r),a=0;a<r;++a)i[a]=n;return i}(0|r,n);break;case"object":if("number"==typeof r.length)return function r(n,i,a){var o=0|n[a];if(o<=0)return[];var s,l=Array(o);if(a===n.length-1)for(s=0;s<o;++s)l[s]=i;else for(s=0;s<o;++s)l[s]=r(n,i,a+1);return l}(r,n,0)}return[]}},{}],66:[function(r,n,i){"use strict";n.exports=function(r,n){var i=r.length;if("number"!=typeof n){n=0;for(var o=0;o<i;++o){var s=r[o];n=Math.max(n,s[0],s[1])}n=1+(0|n)}var l=Array(n|=0);for(o=0;o<n;++o)l[o]=[];for(o=0;o<i;++o)l[(s=r[o])[0]].push(s[1]),l[s[1]].push(s[0]);for(var c=0;c<n;++c)a(l[c],function(r,n){return r-n});return l};var a=r("uniq")},{uniq:310}],67:[function(r,n,i){"use strict";n.exports=function(r,n,i){var a=n||0,o=i||1;return[[r[12]+r[0],r[13]+r[1],r[14]+r[2],r[15]+r[3]],[r[12]-r[0],r[13]-r[1],r[14]-r[2],r[15]-r[3]],[r[12]+r[4],r[13]+r[5],r[14]+r[6],r[15]+r[7]],[r[12]-r[4],r[13]-r[5],r[14]-r[6],r[15]-r[7]],[a*r[12]+r[8],a*r[13]+r[9],a*r[14]+r[10],a*r[15]+r[11]],[o*r[12]-r[8],o*r[13]-r[9],o*r[14]-r[10],o*r[15]-r[11]]]}},{}],68:[function(r,n,i){"use strict";n.exports=function(r,n,i){switch(arguments.length){case 0:return new l([0],[0],0);case 1:return"number"==typeof r?new l(a=u(r),a,0):new l(r,u(r.length),0);case 2:if("number"==typeof n){var a=u(r.length);return new l(r,a,+n)}i=0;case 3:if(r.length!==n.length)throw Error("state and velocity lengths must match");return new l(r,n,i)}};var a=r("cubic-hermite"),o=r("binary-search-bounds");function s(r,n,i){return Math.min(n,Math.max(r,i))}function l(r,n,i){this.dimension=r.length,this.bounds=[Array(this.dimension),Array(this.dimension)];for(var a=0;a<this.dimension;++a)this.bounds[0][a]=-1/0,this.bounds[1][a]=1/0;this._state=r.slice().reverse(),this._velocity=n.slice().reverse(),this._time=[i],this._scratch=[r.slice(),r.slice(),r.slice(),r.slice(),r.slice()]}var c=l.prototype;function u(r){for(var n=Array(r),i=0;i<r;++i)n[i]=0;return n}c.flush=function(r){var n=o.gt(this._time,r)-1;n<=0||(this._time.splice(0,n),this._state.splice(0,n*this.dimension),this._velocity.splice(0,n*this.dimension))},c.curve=function(r){var n=this._time,i=n.length,l=o.le(n,r),c=this._scratch[0],u=this._state,f=this._velocity,h=this.dimension,p=this.bounds;if(l<0)for(var d=h-1,m=0;m<h;++m,--d)c[m]=u[d];else if(l>=i-1){d=u.length-1;var g=r-n[i-1];for(m=0;m<h;++m,--d)c[m]=u[d]+g*f[d]}else{d=h*(l+1)-1;var v=n[l],y=n[l+1]-v||1,x=this._scratch[1],b=this._scratch[2],_=this._scratch[3],w=this._scratch[4],T=!0;for(m=0;m<h;++m,--d)x[m]=u[d],_[m]=f[d]*y,b[m]=u[d+h],w[m]=f[d+h]*y,T=T&&x[m]===b[m]&&_[m]===w[m]&&0===_[m];if(T)for(m=0;m<h;++m)c[m]=x[m];else a(x,_,b,w,(r-v)/y,c)}var k=p[0],A=p[1];for(m=0;m<h;++m)c[m]=s(k[m],A[m],c[m]);return c},c.dcurve=function(r){var n=this._time,i=n.length,s=o.le(n,r),l=this._scratch[0],c=this._state,u=this._velocity,f=this.dimension;if(s>=i-1)for(var h=c.length-1,p=(n[i-1],0);p<f;++p,--h)l[p]=u[h];else{h=f*(s+1)-1;var d=n[s],m=n[s+1]-d||1,g=this._scratch[1],v=this._scratch[2],y=this._scratch[3],x=this._scratch[4],b=!0;for(p=0;p<f;++p,--h)g[p]=c[h],y[p]=u[h]*m,v[p]=c[h+f],x[p]=u[h+f]*m,b=b&&g[p]===v[p]&&y[p]===x[p]&&0===y[p];if(b)for(p=0;p<f;++p)l[p]=0;else for(a.derivative(g,y,v,x,(r-d)/m,l),p=0;p<f;++p)l[p]/=m}return l},c.lastT=function(){var r=this._time;return r[r.length-1]},c.stable=function(){for(var r=this._velocity,n=r.length,i=this.dimension-1;i>=0;--i)if(r[--n])return!1;return!0},c.jump=function(r){var n=this.lastT(),i=this.dimension;if(!(r<n||arguments.length!==i+1)){var a=this._state,o=this._velocity,l=a.length-this.dimension,c=this.bounds,u=c[0],f=c[1];this._time.push(n,r);for(var h=0;h<2;++h)for(var p=0;p<i;++p)a.push(a[l++]),o.push(0);for(this._time.push(r),p=i;p>0;--p)a.push(s(u[p-1],f[p-1],arguments[p])),o.push(0)}},c.push=function(r){var n=this.lastT(),i=this.dimension;if(!(r<n||arguments.length!==i+1)){var a=this._state,o=this._velocity,l=a.length-this.dimension,c=r-n,u=this.bounds,f=u[0],h=u[1],p=c>1e-6?1/c:0;this._time.push(r);for(var d=i;d>0;--d){var m=s(f[d-1],h[d-1],arguments[d]);a.push(m),o.push((m-a[l++])*p)}}},c.set=function(r){var n=this.dimension;if(!(r<this.lastT()||arguments.length!==n+1)){var i=this._state,a=this._velocity,o=this.bounds,l=o[0],c=o[1];this._time.push(r);for(var u=n;u>0;--u)i.push(s(l[u-1],c[u-1],arguments[u])),a.push(0)}},c.move=function(r){var n=this.lastT(),i=this.dimension;if(!(r<=n||arguments.length!==i+1)){var a=this._state,o=this._velocity,l=a.length-this.dimension,c=this.bounds,u=c[0],f=c[1],h=r-n,p=h>1e-6?1/h:0;this._time.push(r);for(var d=i;d>0;--d){var m=arguments[d];a.push(s(u[d-1],f[d-1],a[l++]+m)),o.push(m*p)}}},c.idle=function(r){var n=this.lastT();if(!(r<n)){var i=this.dimension,a=this._state,o=this._velocity,l=a.length-i,c=this.bounds,u=c[0],f=c[1],h=r-n;this._time.push(r);for(var p=i-1;p>=0;--p)a.push(s(u[p],f[p],a[l]+h*o[l])),o.push(0),l+=1}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(r,n,i){"use strict";function a(r,n,i,a,o,s){this._color=r,this.key=n,this.value=i,this.left=a,this.right=o,this._count=s}function o(r){return new a(r._color,r.key,r.value,r.left,r.right,r._count)}function s(r,n){return new a(r,n.key,n.value,n.left,n.right,n._count)}function l(r){r._count=1+(r.left?r.left._count:0)+(r.right?r.right._count:0)}function c(r,n){this._compare=r,this.root=n}n.exports=function(r){return new c(r||d,null)};var u=c.prototype;function f(r,n){this.tree=r,this._stack=n}Object.defineProperty(u,"keys",{get:function(){var r=[];return this.forEach(function(n,i){r.push(n)}),r}}),Object.defineProperty(u,"values",{get:function(){var r=[];return this.forEach(function(n,i){r.push(i)}),r}}),Object.defineProperty(u,"length",{get:function(){return this.root?this.root._count:0}}),u.insert=function(r,n){for(var i=this._compare,o=this.root,u=[],f=[];o;){var h=i(r,o.key);u.push(o),f.push(h),o=h<=0?o.left:o.right}u.push(new a(0,r,n,null,null,1));for(var p=u.length-2;p>=0;--p)o=u[p],f[p]<=0?u[p]=new a(o._color,o.key,o.value,u[p+1],o.right,o._count+1):u[p]=new a(o._color,o.key,o.value,o.left,u[p+1],o._count+1);for(p=u.length-1;p>1;--p){var d,m,g=u[p-1];if(o=u[p],1===g._color||1===o._color)break;var v=u[p-2];if(v.left===g){if(g.left===o){if(!(d=v.right)||0!==d._color){v._color=0,v.left=g.right,g._color=1,g.right=v,u[p-2]=g,u[p-1]=o,l(v),l(g),p>=3&&((m=u[p-3]).left===v?m.left=g:m.right=g);break}g._color=1,v.right=s(1,d),v._color=0,p-=1}else{if(!(d=v.right)||0!==d._color){g.right=o.left,v._color=0,v.left=o.right,o._color=1,o.left=g,o.right=v,u[p-2]=o,u[p-1]=g,l(v),l(g),l(o),p>=3&&((m=u[p-3]).left===v?m.left=o:m.right=o);break}g._color=1,v.right=s(1,d),v._color=0,p-=1}}else if(g.right===o){if(!(d=v.left)||0!==d._color){v._color=0,v.right=g.left,g._color=1,g.left=v,u[p-2]=g,u[p-1]=o,l(v),l(g),p>=3&&((m=u[p-3]).right===v?m.right=g:m.left=g);break}g._color=1,v.left=s(1,d),v._color=0,p-=1}else{if(!(d=v.left)||0!==d._color){g.left=o.right,v._color=0,v.right=o.left,o._color=1,o.right=g,o.left=v,u[p-2]=o,u[p-1]=g,l(v),l(g),l(o),p>=3&&((m=u[p-3]).right===v?m.right=o:m.left=o);break}g._color=1,v.left=s(1,d),v._color=0,p-=1}}return u[0]._color=1,new c(i,u[0])},u.forEach=function(r,n,i){if(this.root)switch(arguments.length){case 1:return function r(n,i){var a;return i.left&&(a=r(n,i.left))?a:(a=n(i.key,i.value))||(i.right?r(n,i.right):void 0)}(r,this.root);case 2:return function r(n,i,a,o){if(0>=i(n,o.key)){var s;if(o.left&&(s=r(n,i,a,o.left))||(s=a(o.key,o.value)))return s}if(o.right)return r(n,i,a,o.right)}(n,this._compare,r,this.root);case 3:if(this._compare(n,i)>=0)return;return function r(n,i,a,o,s){var l,c=a(n,s.key),u=a(i,s.key);return c<=0&&(s.left&&(l=r(n,i,a,o,s.left))||u>0&&(l=o(s.key,s.value)))?l:u>0&&s.right?r(n,i,a,o,s.right):void 0}(n,i,this._compare,r,this.root)}},Object.defineProperty(u,"begin",{get:function(){for(var r=[],n=this.root;n;)r.push(n),n=n.left;return new f(this,r)}}),Object.defineProperty(u,"end",{get:function(){for(var r=[],n=this.root;n;)r.push(n),n=n.right;return new f(this,r)}}),u.at=function(r){if(r<0)return new f(this,[]);for(var n=this.root,i=[];;){if(i.push(n),n.left){if(r<n.left._count){n=n.left;continue}r-=n.left._count}if(!r)return new f(this,i);if(r-=1,!n.right||r>=n.right._count)break;n=n.right}return new f(this,[])},u.ge=function(r){for(var n=this._compare,i=this.root,a=[],o=0;i;){var s=n(r,i.key);a.push(i),s<=0&&(o=a.length),i=s<=0?i.left:i.right}return a.length=o,new f(this,a)},u.gt=function(r){for(var n=this._compare,i=this.root,a=[],o=0;i;){var s=n(r,i.key);a.push(i),s<0&&(o=a.length),i=s<0?i.left:i.right}return a.length=o,new f(this,a)},u.lt=function(r){for(var n=this._compare,i=this.root,a=[],o=0;i;){var s=n(r,i.key);a.push(i),s>0&&(o=a.length),i=s<=0?i.left:i.right}return a.length=o,new f(this,a)},u.le=function(r){for(var n=this._compare,i=this.root,a=[],o=0;i;){var s=n(r,i.key);a.push(i),s>=0&&(o=a.length),i=s<0?i.left:i.right}return a.length=o,new f(this,a)},u.find=function(r){for(var n=this._compare,i=this.root,a=[];i;){var o=n(r,i.key);if(a.push(i),0===o)return new f(this,a);i=o<=0?i.left:i.right}return new f(this,[])},u.remove=function(r){var n=this.find(r);return n?n.remove():this},u.get=function(r){for(var n=this._compare,i=this.root;i;){var a=n(r,i.key);if(0===a)return i.value;i=a<=0?i.left:i.right}};var h=f.prototype;function p(r,n){r.key=n.key,r.value=n.value,r.left=n.left,r.right=n.right,r._color=n._color,r._count=n._count}function d(r,n){return r<n?-1:r>n?1:0}Object.defineProperty(h,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(h,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),h.clone=function(){return new f(this.tree,this._stack.slice())},h.remove=function(){var r=this._stack;if(0===r.length)return this.tree;var n=Array(r.length),i=r[r.length-1];n[n.length-1]=new a(i._color,i.key,i.value,i.left,i.right,i._count);for(var u=r.length-2;u>=0;--u)(i=r[u]).left===r[u+1]?n[u]=new a(i._color,i.key,i.value,n[u+1],i.right,i._count):n[u]=new a(i._color,i.key,i.value,i.left,n[u+1],i._count);if((i=n[n.length-1]).left&&i.right){var f=n.length;for(i=i.left;i.right;)n.push(i),i=i.right;var h=n[f-1];for(n.push(new a(i._color,h.key,h.value,i.left,i.right,i._count)),n[f-1].key=i.key,n[f-1].value=i.value,u=n.length-2;u>=f;--u)i=n[u],n[u]=new a(i._color,i.key,i.value,i.left,n[u+1],i._count);n[f-1].left=n[f]}if(0===(i=n[n.length-1])._color){var d=n[n.length-2];for(d.left===i?d.left=null:d.right===i&&(d.right=null),n.pop(),u=0;u<n.length;++u)n[u]._count--;return new c(this.tree._compare,n[0])}if(i.left||i.right){for(i.left?p(i,i.left):i.right&&p(i,i.right),i._color=1,u=0;u<n.length-1;++u)n[u]._count--;return new c(this.tree._compare,n[0])}if(1===n.length)return new c(this.tree._compare,null);for(u=0;u<n.length;++u)n[u]._count--;var m=n[n.length-2];return function(r){for(var n,i,a,c,u,f=r.length-1;f>=0;--f){if(i=r[f],0===f)return void(i._color=1);if((a=r[f-1]).left===i){if((c=a.right).right&&0===c.right._color)return u=(c=a.right=o(c)).right=o(c.right),a.right=c.left,c.left=a,c.right=u,c._color=a._color,i._color=1,a._color=1,u._color=1,l(a),l(c),f>1&&((n=r[f-2]).left===a?n.left=c:n.right=c),void(r[f-1]=c);if(c.left&&0===c.left._color)return u=(c=a.right=o(c)).left=o(c.left),a.right=u.left,c.left=u.right,u.left=a,u.right=c,u._color=a._color,a._color=1,c._color=1,i._color=1,l(a),l(c),l(u),f>1&&((n=r[f-2]).left===a?n.left=u:n.right=u),void(r[f-1]=u);if(1===c._color){if(0===a._color)return a._color=1,void(a.right=s(0,c));a.right=s(0,c);continue}c=o(c),a.right=c.left,c.left=a,c._color=a._color,a._color=0,l(a),l(c),f>1&&((n=r[f-2]).left===a?n.left=c:n.right=c),r[f-1]=c,r[f]=a,f+1<r.length?r[f+1]=i:r.push(i),f+=2}else{if((c=a.left).left&&0===c.left._color)return u=(c=a.left=o(c)).left=o(c.left),a.left=c.right,c.right=a,c.left=u,c._color=a._color,i._color=1,a._color=1,u._color=1,l(a),l(c),f>1&&((n=r[f-2]).right===a?n.right=c:n.left=c),void(r[f-1]=c);if(c.right&&0===c.right._color)return u=(c=a.left=o(c)).right=o(c.right),a.left=u.right,c.right=u.left,u.right=a,u.left=c,u._color=a._color,a._color=1,c._color=1,i._color=1,l(a),l(c),l(u),f>1&&((n=r[f-2]).right===a?n.right=u:n.left=u),void(r[f-1]=u);if(1===c._color){if(0===a._color)return a._color=1,void(a.left=s(0,c));a.left=s(0,c);continue}c=o(c),a.left=c.right,c.right=a,c._color=a._color,a._color=0,l(a),l(c),f>1&&((n=r[f-2]).right===a?n.right=c:n.left=c),r[f-1]=c,r[f]=a,f+1<r.length?r[f+1]=i:r.push(i),f+=2}}}(n),m.left===i?m.left=null:m.right=null,new c(this.tree._compare,n[0])},Object.defineProperty(h,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(h,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(h,"index",{get:function(){var r=0,n=this._stack;if(0===n.length){var i=this.tree.root;return i?i._count:0}n[n.length-1].left&&(r=n[n.length-1].left._count);for(var a=n.length-2;a>=0;--a)n[a+1]===n[a].right&&(++r,n[a].left&&(r+=n[a].left._count));return r},enumerable:!0}),h.next=function(){var r=this._stack;if(0!==r.length){var n=r[r.length-1];if(n.right)for(n=n.right;n;)r.push(n),n=n.left;else for(r.pop();r.length>0&&r[r.length-1].right===n;)n=r[r.length-1],r.pop()}},Object.defineProperty(h,"hasNext",{get:function(){var r=this._stack;if(0===r.length)return!1;if(r[r.length-1].right)return!0;for(var n=r.length-1;n>0;--n)if(r[n-1].left===r[n])return!0;return!1}}),h.update=function(r){var n=this._stack;if(0===n.length)throw Error("Can't update empty node!");var i=Array(n.length),o=n[n.length-1];i[i.length-1]=new a(o._color,o.key,r,o.left,o.right,o._count);for(var s=n.length-2;s>=0;--s)(o=n[s]).left===n[s+1]?i[s]=new a(o._color,o.key,o.value,i[s+1],o.right,o._count):i[s]=new a(o._color,o.key,o.value,o.left,i[s+1],o._count);return new c(this.tree._compare,i[0])},h.prev=function(){var r=this._stack;if(0!==r.length){var n=r[r.length-1];if(n.left)for(n=n.left;n;)r.push(n),n=n.right;else for(r.pop();r.length>0&&r[r.length-1].left===n;)n=r[r.length-1],r.pop()}},Object.defineProperty(h,"hasPrev",{get:function(){var r=this._stack;if(0===r.length)return!1;if(r[r.length-1].left)return!0;for(var n=r.length-1;n>0;--n)if(r[n-1].right===r[n])return!0;return!1}})},{}],70:[function(r,n,i){"use strict";n.exports=function(r,n){var i=new h(r);return i.update(n),i};var a=r("./lib/text.js"),o=r("./lib/lines.js"),s=r("./lib/background.js"),l=r("./lib/cube.js"),c=r("./lib/ticks.js"),u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function f(r,n){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r}function h(r){this.gl=r,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=s(r)}var p=h.prototype;function d(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}p.update=function(r){function n(n,i,a){if(a in r){var o,s=r[a],l=this[a];(n?Array.isArray(s)&&Array.isArray(s[0]):Array.isArray(s))?this[a]=o=[i(s[0]),i(s[1]),i(s[2])]:this[a]=o=[i(s),i(s),i(s)];for(var c=0;c<3;++c)if(o[c]!==l[c])return!0}return!1}r=r||{};var i,s=n.bind(this,!1,Number),l=n.bind(this,!1,Boolean),u=n.bind(this,!1,String),f=n.bind(this,!0,function(r){if(Array.isArray(r)){if(3===r.length)return[+r[0],+r[1],+r[2],1];if(4===r.length)return[+r[0],+r[1],+r[2],+r[3]]}return[0,0,0,1]}),h=!1,p=!1;if("bounds"in r)for(var d=r.bounds,m=0;m<2;++m)for(var g=0;g<3;++g)d[m][g]!==this.bounds[m][g]&&(p=!0),this.bounds[m][g]=d[m][g];if("ticks"in r)for(i=r.ticks,h=!0,this.autoTicks=!1,m=0;m<3;++m)this.tickSpacing[m]=0;else s("tickSpacing")&&(this.autoTicks=!0,p=!0);if(this._firstInit&&("ticks"in r||"tickSpacing"in r||(this.autoTicks=!0),p=!0,h=!0,this._firstInit=!1),p&&this.autoTicks&&(i=c.create(this.bounds,this.tickSpacing),h=!0),h){for(m=0;m<3;++m)i[m].sort(function(r,n){return r.x-n.x});c.equal(i,this.ticks)?h=!1:this.ticks=i}l("tickEnable"),u("tickFont")&&(h=!0),s("tickSize"),s("tickAngle"),s("tickPad"),f("tickColor");var v=u("labels");u("labelFont")&&(v=!0),l("labelEnable"),s("labelSize"),s("labelPad"),f("labelColor"),l("lineEnable"),l("lineMirror"),s("lineWidth"),f("lineColor"),l("lineTickEnable"),l("lineTickMirror"),s("lineTickLength"),s("lineTickWidth"),f("lineTickColor"),l("gridEnable"),s("gridWidth"),f("gridColor"),l("zeroEnable"),f("zeroLineColor"),s("zeroLineWidth"),l("backgroundEnable"),f("backgroundColor"),this._text?this._text&&(v||h)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=a(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&h&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=o(this.gl,this.bounds,this.ticks))};var m=[new d,new d,new d],g=[0,0,0],v={model:u,view:u,projection:u,_ortho:!1};p.isOpaque=function(){return!0},p.isTransparent=function(){return!1},p.drawTransparent=function(r){};var y=[0,0,0],x=[0,0,0],b=[0,0,0];p.draw=function(r){r=r||v;for(var n,i,a,o=this.gl,s=r.model||u,c=r.view||u,h=r.projection||u,p=this.bounds,d=r._ortho||!1,_=l(s,c,h,p,d),w=_.cubeEdges,T=_.axis,k=c[12],A=c[13],M=c[14],S=c[15],E=(d?2:1)*this.pixelRatio*(h[3]*k+h[7]*A+h[11]*M+h[15]*S)/o.drawingBufferHeight,L=0;L<3;++L)this.lastCubeProps.cubeEdges[L]=w[L],this.lastCubeProps.axis[L]=T[L];for(L=0;L<3;++L)(function(r,n,i,a,o){for(var s=r.primalOffset,l=r.primalMinor,c=r.mirrorOffset,u=r.mirrorMinor,f=a[n],h=0;h<3;++h)if(n!==h){var p=s,d=c,m=l,g=u;f&1<<h&&(p=c,d=s,m=u,g=l),p[h]=i[0][h],d[h]=i[1][h],o[h]>0?(m[h]=-1,g[h]=0):(m[h]=0,g[h]=1)}})(m[L],L,this.bounds,w,T);for(L=0,o=this.gl;L<3;++L)this.backgroundEnable[L]?g[L]=T[L]:g[L]=0;for(this._background.draw(s,c,h,p,g,this.backgroundColor),this._lines.bind(s,c,h,this),L=0;L<3;++L){var C=[0,0,0];T[L]>0?C[L]=p[1][L]:C[L]=p[0][L];for(var P=0;P<2;++P){var I=(L+1+P)%3,O=(L+1+(1^P))%3;this.gridEnable[I]&&this._lines.drawGrid(I,O,this.bounds,C,this.gridColor[I],this.gridWidth[I]*this.pixelRatio)}for(P=0;P<2;++P)I=(L+1+P)%3,O=(L+1+(1^P))%3,this.zeroEnable[O]&&0>=Math.min(p[0][O],p[1][O])&&Math.max(p[0][O],p[1][O])>=0&&this._lines.drawZero(I,O,this.bounds,C,this.zeroLineColor[O],this.zeroLineWidth[O]*this.pixelRatio)}for(L=0;L<3;++L){this.lineEnable[L]&&this._lines.drawAxisLine(L,this.bounds,m[L].primalOffset,this.lineColor[L],this.lineWidth[L]*this.pixelRatio),this.lineMirror[L]&&this._lines.drawAxisLine(L,this.bounds,m[L].mirrorOffset,this.lineColor[L],this.lineWidth[L]*this.pixelRatio);var z=f(y,m[L].primalMinor),D=f(x,m[L].mirrorMinor),R=this.lineTickLength;for(P=0;P<3;++P){var F=E/s[5*P];z[P]*=R[P]*F,D[P]*=R[P]*F}this.lineTickEnable[L]&&this._lines.drawAxisTicks(L,m[L].primalOffset,z,this.lineTickColor[L],this.lineTickWidth[L]*this.pixelRatio),this.lineTickMirror[L]&&this._lines.drawAxisTicks(L,m[L].mirrorOffset,D,this.lineTickColor[L],this.lineTickWidth[L]*this.pixelRatio)}function B(r){(a=[0,0,0])[r]=1}for(this._lines.unbind(),this._text.bind(s,c,h,this.pixelRatio),L=0;L<3;++L){var N=m[L].primalMinor,j=m[L].mirrorMinor,U=f(b,m[L].primalOffset);for(P=0;P<3;++P)this.lineTickEnable[L]&&(U[P]+=E*N[P]*Math.max(this.lineTickLength[P],0)/s[5*P]);var V=[0,0,0];if(V[L]=1,this.tickEnable[L]){for(-3600===this.tickAngle[L]?(this.tickAngle[L]=0,this.tickAlign[L]="auto"):this.tickAlign[L]=-1,i=1,"auto"===(n=[this.tickAlign[L],.5,i])[0]?n[0]=0:n[0]=parseInt(""+n[0]),a=[0,0,0],function(r,n,i){var a=(r+1)%3,o=(r+2)%3,s=n[a],l=n[o],c=i[a],u=i[o];s>0&&u>0||s>0&&u<0||s<0&&u>0||s<0&&u<0?B(a):(l>0&&c>0||l>0&&c<0||l<0&&c>0||l<0&&c<0)&&B(o)}(L,N,j),P=0;P<3;++P)U[P]+=E*N[P]*this.tickPad[P]/s[5*P];this._text.drawTicks(L,this.tickSize[L],this.tickAngle[L],U,this.tickColor[L],V,a,n)}if(this.labelEnable[L]){for(i=0,a=[0,0,0],this.labels[L].length>4&&(B(L),i=1),"auto"===(n=[this.labelAlign[L],.5,i])[0]?n[0]=0:n[0]=parseInt(""+n[0]),P=0;P<3;++P)U[P]+=E*N[P]*this.labelPad[P]/s[5*P];U[L]+=.5*(p[0][L]+p[1][L]),this._text.drawLabel(L,this.labelSize[L],this.labelAngle[L],U,this.labelColor[L],[0,0,0],a,n)}}this._text.unbind()},p.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(r,n,i){"use strict";n.exports=function(r){for(var n=[],i=[],c=0,u=0;u<3;++u)for(var f=(u+1)%3,h=(u+2)%3,p=[0,0,0],d=[0,0,0],m=-1;m<=1;m+=2){i.push(c,c+2,c+1,c+1,c+2,c+3),p[u]=m,d[u]=m;for(var g=-1;g<=1;g+=2){p[f]=g;for(var v=-1;v<=1;v+=2)p[h]=v,n.push(p[0],p[1],p[2],d[0],d[1],d[2]),c+=1}var y=f;f=h,h=y}var x=a(r,new Float32Array(n)),b=a(r,new Uint16Array(i),r.ELEMENT_ARRAY_BUFFER),_=o(r,[{buffer:x,type:r.FLOAT,size:3,offset:0,stride:24},{buffer:x,type:r.FLOAT,size:3,offset:12,stride:24}],b),w=s(r);return w.attributes.position.location=0,w.attributes.normal.location=1,new l(r,x,_,w)};var a=r("gl-buffer"),o=r("gl-vao"),s=r("./shaders").bg;function l(r,n,i,a){this.gl=r,this.buffer=n,this.vao=i,this.shader=a}var c=l.prototype;c.draw=function(r,n,i,a,o,s){for(var l=!1,c=0;c<3;++c)l=l||o[c];if(l){var u=this.gl;u.enable(u.POLYGON_OFFSET_FILL),u.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:r,view:n,projection:i,bounds:a,enable:o,colors:s},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),u.disable(u.POLYGON_OFFSET_FILL)}},c.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(r,n,i){"use strict";n.exports=function(r,n,i,y,x){o(c,n,r),o(c,i,c);for(var b,_=0,w=0;w<2;++w){h[2]=y[w][2];for(var T=0;T<2;++T){h[1]=y[T][1];for(var k=0;k<2;++k)h[0]=y[k][0],function(r,n,i){for(var a=0;a<4;++a){r[a]=i[12+a];for(var o=0;o<3;++o)r[a]+=n[o]*i[4*o+a]}}(u[_],h,c),_+=1}}var A=-1;for(w=0;w<8;++w){for(var M=u[w][3],S=0;S<3;++S)f[w][S]=u[w][S]/M;x&&(f[w][2]*=-1),M<0&&(A<0||f[w][2]<f[A][2])&&(A=w)}if(A<0){A=0;for(var E=0;E<3;++E){for(var L=(E+2)%3,C=(E+1)%3,P=-1,I=-1,O=0;O<2;++O){var z=(R=O<<E)+(O<<L)+(1-O<<C),D=R+(1-O<<L)+(O<<C);0>l(f[R],f[z],f[D],p)||(O?P=1:I=1)}if(P<0||I<0)I>P&&(A|=1<<E);else{for(O=0;O<2;++O){z=(R=O<<E)+(O<<L)+(1-O<<C),D=R+(1-O<<L)+(O<<C);var R,F=function(r){for(var n=0;n<d.length;++n)if((r=s.positive(r,d[n])).length<3)return 0;var i=r[0],a=i[0]/i[3],o=i[1]/i[3],l=0;for(n=1;n+1<r.length;++n){var c=r[n],u=r[n+1],f=c[0]/c[3]-a,h=c[1]/c[3]-o,p=u[0]/u[3]-a;l+=Math.abs(f*(u[1]/u[3]-o)-h*p)}return l}([u[R],u[z],u[D],u[R+(1<<L)+(1<<C)]]);O?P=F:I=F}I>P&&(A|=1<<E)}}}var B=7^A,N=-1;for(w=0;w<8;++w)w!==A&&w!==B&&(N<0||f[N][1]>f[w][1])&&(N=w);var j=-1;for(w=0;w<3;++w)(b=N^1<<w)!==A&&b!==B&&(j<0&&(j=b),(C=f[b])[0]<f[j][0]&&(j=b));var U=-1;for(w=0;w<3;++w)(b=N^1<<w)!==A&&b!==B&&b!==j&&(U<0&&(U=b),(C=f[b])[0]>f[U][0]&&(U=b));m[0]=m[1]=m[2]=0,m[a.log2(j^N)]=N&j,m[a.log2(N^U)]=N&U;var V=7^U;V===A||V===B?(V=7^j,m[a.log2(U^V)]=V&U):m[a.log2(j^V)]=V&j;var H=A;for(E=0;E<3;++E)g[E]=H&1<<E?-1:1;return v};var a=r("bit-twiddle"),o=r("gl-mat4/multiply"),s=r("split-polygon"),l=r("robust-orientation"),c=Array(16),u=Array(8),f=Array(8),h=[,,,],p=[0,0,0];!function(){for(var r=0;r<8;++r)u[r]=[1,1,1,1],f[r]=[1,1,1]}();var d=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]],m=[1,1,1],g=[0,0,0],v={cubeEdges:m,axis:g}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(r,n,i){"use strict";n.exports=function(r,n,i){var l=[],c=[0,0,0],u=[0,0,0],f=[0,0,0],h=[0,0,0];l.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var p=0;p<3;++p){for(var d=l.length/3|0,g=0;g<i[p].length;++g){var v=+i[p][g].x;l.push(v,0,1,v,1,1,v,0,-1,v,0,-1,v,1,1,v,1,-1)}var y=l.length/3|0;c[p]=d,u[p]=y-d,d=l.length/3|0;for(var x=0;x<i[p].length;++x)v=+i[p][x].x,l.push(v,0,1,v,1,1,v,0,-1,v,0,-1,v,1,1,v,1,-1);y=l.length/3|0,f[p]=d,h[p]=y-d}var b=a(r,new Float32Array(l)),_=o(r,[{buffer:b,type:r.FLOAT,size:3,stride:0,offset:0}]),w=s(r);return w.attributes.position.location=0,new m(r,b,_,w,u,c,h,f)};var a=r("gl-buffer"),o=r("gl-vao"),s=r("./shaders").line,l=[0,0,0],c=[0,0,0],u=[0,0,0],f=[0,0,0],h=[1,1];function p(r){return r[0]=r[1]=r[2]=0,r}function d(r,n){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r}function m(r,n,i,a,o,s,l,c){this.gl=r,this.vertBuffer=n,this.vao=i,this.shader=a,this.tickCount=o,this.tickOffset=s,this.gridCount=l,this.gridOffset=c}var g=m.prototype;g.bind=function(r,n,i){this.shader.bind(),this.shader.uniforms.model=r,this.shader.uniforms.view=n,this.shader.uniforms.projection=i,h[0]=this.gl.drawingBufferWidth,h[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=h,this.vao.bind()},g.unbind=function(){this.vao.unbind()},g.drawAxisLine=function(r,n,i,a,o){var s=p(c);this.shader.uniforms.majorAxis=c,s[r]=n[1][r]-n[0][r],this.shader.uniforms.minorAxis=s;var l,h=d(f,i);h[r]+=n[0][r],this.shader.uniforms.offset=h,this.shader.uniforms.lineWidth=o,this.shader.uniforms.color=a,(l=p(u))[(r+2)%3]=1,this.shader.uniforms.screenAxis=l,this.vao.draw(this.gl.TRIANGLES,6),(l=p(u))[(r+1)%3]=1,this.shader.uniforms.screenAxis=l,this.vao.draw(this.gl.TRIANGLES,6)},g.drawAxisTicks=function(r,n,i,a,o){if(this.tickCount[r]){var s=p(l);s[r]=1,this.shader.uniforms.majorAxis=s,this.shader.uniforms.offset=n,this.shader.uniforms.minorAxis=i,this.shader.uniforms.color=a,this.shader.uniforms.lineWidth=o;var c=p(u);c[r]=1,this.shader.uniforms.screenAxis=c,this.vao.draw(this.gl.TRIANGLES,this.tickCount[r],this.tickOffset[r])}},g.drawGrid=function(r,n,i,a,o,s){if(this.gridCount[r]){var h=p(c);h[n]=i[1][n]-i[0][n],this.shader.uniforms.minorAxis=h;var m=d(f,a);m[n]+=i[0][n],this.shader.uniforms.offset=m;var g=p(l);g[r]=1,this.shader.uniforms.majorAxis=g;var v=p(u);v[r]=1,this.shader.uniforms.screenAxis=v,this.shader.uniforms.lineWidth=s,this.shader.uniforms.color=o,this.vao.draw(this.gl.TRIANGLES,this.gridCount[r],this.gridOffset[r])}},g.drawZero=function(r,n,i,a,o,s){var l=p(c);this.shader.uniforms.majorAxis=l,l[r]=i[1][r]-i[0][r],this.shader.uniforms.minorAxis=l;var h=d(f,a);h[r]+=i[0][r],this.shader.uniforms.offset=h;var m=p(u);m[n]=1,this.shader.uniforms.screenAxis=m,this.shader.uniforms.lineWidth=s,this.shader.uniforms.color=o,this.vao.draw(this.gl.TRIANGLES,6)},g.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(r,n,i){"use strict";var a=r("glslify"),o=r("gl-shader"),s=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),l=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);i.line=function(r){return o(r,s,l,null,[{name:"position",type:"vec3"}])};var c=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),u=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);i.text=function(r){return o(r,c,u,null,[{name:"position",type:"vec3"}])};var f=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),h=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);i.bg=function(r){return o(r,f,h,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(r,n,i){(function(i){(function(){"use strict";n.exports=function(r,n,i,s,c,u){var h=a(r),p=o(r,[{buffer:h,size:3}]),d=l(r);d.attributes.position.location=0;var m=new f(r,d,h,p);return m.update(n,i,s,c,u),m};var a=r("gl-buffer"),o=r("gl-vao"),s=r("vectorize-text"),l=r("./shaders").text,c=window||i.global||{},u=c.__TEXT_CACHE||{};function f(r,n,i,a){this.gl=r,this.shader=n,this.buffer=i,this.vao=a,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}c.__TEXT_CACHE={};var h=f.prototype,p=[0,0];h.bind=function(r,n,i,a){this.vao.bind(),this.shader.bind();var o=this.shader.uniforms;o.model=r,o.view=n,o.projection=i,o.pixelScale=a,p[0]=this.gl.drawingBufferWidth,p[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=p},h.unbind=function(){this.vao.unbind()},h.update=function(r,n,i,a,o){var l=[];function c(r,n,i,a,o,c){var f=u[i];f||(f=u[i]={});var h=f[n];h||(h=f[n]=function(r,n){try{return s(r,n)}catch(n){return console.warn('error vectorizing text:"'+r+'" error:',n),{cells:[],positions:[]}}}(n,{triangles:!0,font:i,textAlign:"center",textBaseline:"middle",lineSpacing:o,styletags:c}));for(var p=(a||12)/12,d=h.positions,m=h.cells,g=0,v=m.length;g<v;++g)for(var y=m[g],x=2;x>=0;--x){var b=d[y[x]];l.push(p*b[0],-p*b[1],r)}}for(var f=[0,0,0],h=[0,0,0],p=[0,0,0],d=[0,0,0],m={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},g=0;g<3;++g){p[g]=l.length/3|0,c(.5*(r[0][g]+r[1][g]),n[g],i[g],12,1.25,m),d[g]=(l.length/3|0)-p[g],f[g]=l.length/3|0;for(var v=0;v<a[g].length;++v)a[g][v].text&&c(a[g][v].x,a[g][v].text,a[g][v].font||o,a[g][v].fontSize||12,1.25,m);h[g]=(l.length/3|0)-f[g]}this.buffer.update(l),this.tickOffset=f,this.tickCount=h,this.labelOffset=p,this.labelCount=d},h.drawTicks=function(r,n,i,a,o,s,l,c){this.tickCount[r]&&(this.shader.uniforms.axis=s,this.shader.uniforms.color=o,this.shader.uniforms.angle=i,this.shader.uniforms.scale=n,this.shader.uniforms.offset=a,this.shader.uniforms.alignDir=l,this.shader.uniforms.alignOpt=c,this.vao.draw(this.gl.TRIANGLES,this.tickCount[r],this.tickOffset[r]))},h.drawLabel=function(r,n,i,a,o,s,l,c){this.labelCount[r]&&(this.shader.uniforms.axis=s,this.shader.uniforms.color=o,this.shader.uniforms.angle=i,this.shader.uniforms.scale=n,this.shader.uniforms.offset=a,this.shader.uniforms.alignDir=l,this.shader.uniforms.alignOpt=c,this.vao.draw(this.gl.TRIANGLES,this.labelCount[r],this.labelOffset[r]))},h.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,r("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(r,n,i){"use strict";function a(r,n){var i=r+"",a=i.indexOf("."),o=0;a>=0&&(o=i.length-a-1);var s=Math.pow(10,o),l=Math.round(r*n*s),c=l+"";if(c.indexOf("e")>=0)return c;var u=l/s,f=l%s;l<0?(u=0|-Math.ceil(u),f=0|-f):(u=0|Math.floor(u),f|=0);var h=""+u;if(l<0&&(h="-"+h),o){for(var p=""+f;p.length<o;)p="0"+p;return h+"."+p}return h}i.create=function(r,n){for(var i=[],o=0;o<3;++o){for(var s=[],l=(r[0][o],r[1][o],0);l*n[o]<=r[1][o];++l)s.push({x:l*n[o],text:a(n[o],l)});for(l=-1;l*n[o]>=r[0][o];--l)s.push({x:l*n[o],text:a(n[o],l)});i.push(s)}return i},i.equal=function(r,n){for(var i=0;i<3;++i){if(r[i].length!==n[i].length)return!1;for(var a=0;a<r[i].length;++a){var o=r[i][a],s=n[i][a];if(o.x!==s.x||o.text!==s.text||o.font!==s.font||o.fontColor!==s.fontColor||o.fontSize!==s.fontSize||o.dx!==s.dx||o.dy!==s.dy)return!1}}return!0}},{}],77:[function(r,n,i){"use strict";n.exports=function(r,n,i,p,y){var x=n.model||f,b=n.view||f,_=n.projection||f,w=n._ortho||!1,T=r.bounds,k=(y=y||s(x,b,_,T,w)).axis;l(h,b,x),l(h,_,h);for(var A=0;A<3;++A)g[A].lo=1/0,g[A].hi=-1/0,g[A].pixelsPerDataUnit=1/0;var M=a(c(h,h));c(h,h);for(var S=0;S<3;++S){var E=(S+1)%3,L=(S+2)%3;t:for(A=0;A<2;++A){var C=[];if(k[S]<0!=!!A){v[S]=T[A][S];for(var P=0;P<2;++P){v[E]=T[P^A][E];for(var I=0;I<2;++I)v[L]=T[I^P^A][L],C.push(v.slice())}var O=w?5:4;for(P=O;P===O;++P){if(0===C.length)continue t;C=o.positive(C,M[P])}for(P=0;P<C.length;++P){var z=function(r,n,i,a,o){for(var s=0;s<3;++s){for(var l=0;l<3;++l)m[l]=d[l]=i[l];m[3]=d[3]=1,m[s]+=1,u(m,m,n),m[3]<0&&(r[s]=1/0),d[s]-=1,u(d,d,n),d[3]<0&&(r[s]=1/0);var c=(d[0]/d[3]-m[0]/m[3])*a,f=(d[1]/d[3]-m[1]/m[3])*o;r[s]=.25*Math.sqrt(c*c+f*f)}return r}(v,h,L=C[P],i,p);for(I=0;I<3;++I)g[I].lo=Math.min(g[I].lo,L[I]),g[I].hi=Math.max(g[I].hi,L[I]),I!==S&&(g[I].pixelsPerDataUnit=Math.min(g[I].pixelsPerDataUnit,Math.abs(z[I])))}}}}return g};var a=r("extract-frustum-planes"),o=r("split-polygon"),s=r("./lib/cube.js"),l=r("gl-mat4/multiply"),c=r("gl-mat4/transpose"),u=r("gl-vec4/transformMat4"),f=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),h=new Float32Array(16);function p(r,n,i){this.lo=r,this.hi=n,this.pixelsPerDataUnit=i}var d=[0,0,0,1],m=[0,0,0,1],g=[new p(1/0,-1/0,1/0),new p(1/0,-1/0,1/0),new p(1/0,-1/0,1/0)],v=[0,0,0]},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(r,n,i){"use strict";var a=r("typedarray-pool"),o=r("ndarray-ops"),s=r("ndarray"),l=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function c(r,n,i,a,o){this.gl=r,this.type=n,this.handle=i,this.length=a,this.usage=o}var u=c.prototype;function f(r,n,i,a,o,s){var l=o.length*o.BYTES_PER_ELEMENT;if(s<0)return r.bufferData(n,o,a),l;if(l+s>i)throw Error("gl-buffer: If resizing buffer, must not specify offset");return r.bufferSubData(n,s,o),i}function h(r,n){for(var i=a.malloc(r.length,n),o=r.length,s=0;s<o;++s)i[s]=r[s];return i}u.bind=function(){this.gl.bindBuffer(this.type,this.handle)},u.unbind=function(){this.gl.bindBuffer(this.type,null)},u.dispose=function(){this.gl.deleteBuffer(this.handle)},u.update=function(r,n){if("number"!=typeof n&&(n=-1),this.bind(),"object"==typeof r&&void 0!==r.shape){var i,c=r.dtype;if(0>l.indexOf(c)&&(c="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(c=gl.getExtension("OES_element_index_uint")&&"uint16"!==c?"uint32":"uint16"),c===r.dtype&&function(r,n){for(var i=1,a=n.length-1;a>=0;--a){if(n[a]!==i)return!1;i*=r[a]}return!0}(r.shape,r.stride))0===r.offset&&r.data.length===r.shape[0]?this.length=f(this.gl,this.type,this.length,this.usage,r.data,n):this.length=f(this.gl,this.type,this.length,this.usage,r.data.subarray(r.offset,r.shape[0]),n);else{var u=a.malloc(r.size,c),p=s(u,r.shape);o.assign(p,r),this.length=f(this.gl,this.type,this.length,this.usage,n<0?u:u.subarray(0,r.size),n),a.free(u)}}else if(Array.isArray(r))i=this.type===this.gl.ELEMENT_ARRAY_BUFFER?h(r,"uint16"):h(r,"float32"),this.length=f(this.gl,this.type,this.length,this.usage,n<0?i:i.subarray(0,r.length),n),a.free(i);else if("object"==typeof r&&"number"==typeof r.length)this.length=f(this.gl,this.type,this.length,this.usage,r,n);else{if("number"!=typeof r&&void 0!==r)throw Error("gl-buffer: Invalid data type");if(n>=0)throw Error("gl-buffer: Cannot specify offset when resizing buffer");(r|=0)<=0&&(r=1),this.gl.bufferData(this.type,0|r,this.usage),this.length=r}},n.exports=function(r,n,i,a){if(i=i||r.ARRAY_BUFFER,a=a||r.DYNAMIC_DRAW,i!==r.ARRAY_BUFFER&&i!==r.ELEMENT_ARRAY_BUFFER)throw Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(a!==r.DYNAMIC_DRAW&&a!==r.STATIC_DRAW&&a!==r.STREAM_DRAW)throw Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var o=r.createBuffer(),s=new c(r,i,o,0,a);return s.update(n),s}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(r,n,i){"use strict";var a=r("gl-vec3");n.exports=function(r,n){var i=r.positions,o=r.vectors,s={positions:[],vertexIntensity:[],vertexIntensityBounds:r.vertexIntensityBounds,vectors:[],cells:[],coneOffset:r.coneOffset,colormap:r.colormap};if(0===r.positions.length)return n&&(n[0]=[0,0,0],n[1]=[0,0,0]),s;for(var l=0,c=1/0,u=-1/0,f=1/0,h=-1/0,p=1/0,d=-1/0,m=null,g=null,v=[],y=1/0,x=!1,b=0;b<i.length;b++){var _=i[b];c=Math.min(_[0],c),u=Math.max(_[0],u),f=Math.min(_[1],f),h=Math.max(_[1],h),p=Math.min(_[2],p),d=Math.max(_[2],d);var w=o[b];if(a.length(w)>l&&(l=a.length(w)),b){var T=2*a.distance(m,_)/(a.length(g)+a.length(w));T?(y=Math.min(y,T),x=!1):x=!0}x||(m=_,g=w),v.push(w)}var k=[c,f,p],A=[u,h,d];n&&(n[0]=k,n[1]=A),0===l&&(l=1);var M=1/l;isFinite(y)||(y=1),s.vectorScale=y;var S=r.coneSize||.5;r.absoluteConeSize&&(S=r.absoluteConeSize*M),s.coneScale=S,b=0;for(var E=0;b<i.length;b++)for(var L=(_=i[b])[0],C=_[1],P=_[2],I=v[b],O=a.length(I)*M,z=0;z<8;z++){s.positions.push([L,C,P,E++]),s.positions.push([L,C,P,E++]),s.positions.push([L,C,P,E++]),s.positions.push([L,C,P,E++]),s.positions.push([L,C,P,E++]),s.positions.push([L,C,P,E++]),s.vectors.push(I),s.vectors.push(I),s.vectors.push(I),s.vectors.push(I),s.vectors.push(I),s.vectors.push(I),s.vertexIntensity.push(O,O,O),s.vertexIntensity.push(O,O,O);var D=s.positions.length;s.cells.push([D-6,D-5,D-4],[D-3,D-2,D-1])}return s};var o=r("./lib/shaders");n.exports.createMesh=r("./create_mesh"),n.exports.createConeMesh=function(r,i){return n.exports.createMesh(r,i,{shaders:o,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(r,n,i){"use strict";var a=r("gl-shader"),o=r("gl-buffer"),s=r("gl-vao"),l=r("gl-texture2d"),c=r("gl-mat4/multiply"),u=r("gl-mat4/invert"),f=r("ndarray"),h=r("colormap"),p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function d(r,n,i,a,o,s,l,c,u,f,h){this.gl=r,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=n,this.dirty=!0,this.triShader=i,this.pickShader=a,this.trianglePositions=o,this.triangleVectors=s,this.triangleColors=c,this.triangleUVs=u,this.triangleIds=l,this.triangleVAO=f,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=h,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=p,this._view=p,this._projection=p,this._resolution=[1,1]}var m=d.prototype;m.isOpaque=function(){return this.opacity>=1},m.isTransparent=function(){return this.opacity<1},m.pickSlots=1,m.setPickBase=function(r){this.pickId=r},m.update=function(r){r=r||{};var n=this.gl;this.dirty=!0,"lightPosition"in r&&(this.lightPosition=r.lightPosition),"opacity"in r&&(this.opacity=r.opacity),"ambient"in r&&(this.ambientLight=r.ambient),"diffuse"in r&&(this.diffuseLight=r.diffuse),"specular"in r&&(this.specularLight=r.specular),"roughness"in r&&(this.roughness=r.roughness),"fresnel"in r&&(this.fresnel=r.fresnel),void 0!==r.tubeScale&&(this.tubeScale=r.tubeScale),void 0!==r.vectorScale&&(this.vectorScale=r.vectorScale),void 0!==r.coneScale&&(this.coneScale=r.coneScale),void 0!==r.coneOffset&&(this.coneOffset=r.coneOffset),r.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=n.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=n.LINEAR,this.texture.setPixels(function(r){for(var n=h({colormap:r,nshades:256,format:"rgba"}),i=new Uint8Array(1024),a=0;a<256;++a){for(var o=n[a],s=0;s<3;++s)i[4*a+s]=o[s];i[4*a+3]=255*o[3]}return f(i,[256,256,4],[4,0,1])}(r.colormap)),this.texture.generateMipmap());var i=r.cells,a=r.positions,o=r.vectors;if(a&&i&&o){var s=[],l=[],c=[],u=[],p=[];this.cells=i,this.positions=a,this.vectors=o;var d=r.meshColor||[1,1,1,1],m=r.vertexIntensity,g=1/0,v=-1/0;if(m){if(r.vertexIntensityBounds)g=+r.vertexIntensityBounds[0],v=+r.vertexIntensityBounds[1];else for(var y=0;y<m.length;++y){var x=m[y];g=Math.min(g,x),v=Math.max(v,x)}}else for(y=0;y<a.length;++y)g=Math.min(g,x=a[y][2]),v=Math.max(v,x);for(this.intensity=m||function(r){for(var n=r.length,i=Array(n),a=0;a<n;++a)i[a]=r[a][2];return i}(a),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],y=0;y<a.length;++y)for(var b=a[y],_=0;_<3;++_)!isNaN(b[_])&&isFinite(b[_])&&(this.bounds[0][_]=Math.min(this.bounds[0][_],b[_]),this.bounds[1][_]=Math.max(this.bounds[1][_],b[_]));var w=0;t:for(y=0;y<i.length;++y){var T=i[y];if(3===T.length){for(_=0;_<3;++_){b=a[A=T[_]];for(var k=0;k<3;++k)if(isNaN(b[k])||!isFinite(b[k]))continue t}for(_=0;_<3;++_){b=a[A=T[2-_]],s.push(b[0],b[1],b[2],b[3]);var A,M,S=o[A];l.push(S[0],S[1],S[2],S[3]||0),3===d.length?c.push(d[0],d[1],d[2],1):c.push(d[0],d[1],d[2],d[3]),M=m?[(m[A]-g)/(v-g),0]:[(b[2]-g)/(v-g),0],u.push(M[0],M[1]),p.push(y)}w+=1}}this.triangleCount=w,this.trianglePositions.update(s),this.triangleVectors.update(l),this.triangleColors.update(c),this.triangleUVs.update(u),this.triangleIds.update(new Uint32Array(p))}},m.drawTransparent=m.draw=function(r){r=r||{};for(var n=this.gl,i=r.model||p,a=r.view||p,o=r.projection||p,s=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;l<3;++l)s[0][l]=Math.max(s[0][l],this.clipBounds[0][l]),s[1][l]=Math.min(s[1][l],this.clipBounds[1][l]);var f={model:i,view:a,projection:o,inverseModel:p.slice(),clipBounds:s,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};f.inverseModel=u(f.inverseModel,f.model),n.disable(n.CULL_FACE),this.texture.bind(0);var h=Array(16);for(c(h,f.view,f.model),c(h,f.projection,h),u(h,h),l=0;l<3;++l)f.eyePosition[l]=h[12+l]/h[15];var d=h[15];for(l=0;l<3;++l)d+=this.lightPosition[l]*h[4*l+3];for(l=0;l<3;++l){for(var m=h[12+l],g=0;g<3;++g)m+=h[4*g+l]*this.lightPosition[g];f.lightPosition[l]=m/d}if(this.triangleCount>0){var v=this.triShader;v.bind(),v.uniforms=f,this.triangleVAO.bind(),n.drawArrays(n.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},m.drawPick=function(r){r=r||{};for(var n=this.gl,i=r.model||p,a=r.view||p,o=r.projection||p,s=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;l<3;++l)s[0][l]=Math.max(s[0][l],this.clipBounds[0][l]),s[1][l]=Math.min(s[1][l],this.clipBounds[1][l]);this._model=[].slice.call(i),this._view=[].slice.call(a),this._projection=[].slice.call(o),this._resolution=[n.drawingBufferWidth,n.drawingBufferHeight];var c={model:i,view:a,projection:o,clipBounds:s,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},u=this.pickShader;u.bind(),u.uniforms=c,this.triangleCount>0&&(this.triangleVAO.bind(),n.drawArrays(n.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},m.pick=function(r){if(!r||r.id!==this.pickId)return null;var n=r.value[0]+256*r.value[1]+65536*r.value[2],i=this.cells[n],a=this.positions[i[1]].slice(0,3),o={position:a,dataCoordinate:a,index:Math.floor(i[1]/48)};return"cone"===this.traceType?o.index=Math.floor(i[1]/48):"streamtube"===this.traceType&&(o.intensity=this.intensity[i[1]],o.velocity=this.vectors[i[1]].slice(0,3),o.divergence=this.vectors[i[1]][3],o.index=n),o},m.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},n.exports=function(r,n,i){var c,u,h=i.shaders;1==arguments.length&&(r=(n=r).gl);var p=((c=a(r,h.meshShader.vertex,h.meshShader.fragment,null,h.meshShader.attributes)).attributes.position.location=0,c.attributes.color.location=2,c.attributes.uv.location=3,c.attributes.vector.location=4,c),m=((u=a(r,h.pickShader.vertex,h.pickShader.fragment,null,h.pickShader.attributes)).attributes.position.location=0,u.attributes.id.location=1,u.attributes.vector.location=4,u),g=l(r,f(new Uint8Array([255,255,255,255]),[1,1,4]));g.generateMipmap(),g.minFilter=r.LINEAR_MIPMAP_LINEAR,g.magFilter=r.LINEAR;var v=o(r),y=o(r),x=o(r),b=o(r),_=o(r),w=s(r,[{buffer:v,type:r.FLOAT,size:4},{buffer:_,type:r.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:x,type:r.FLOAT,size:4},{buffer:b,type:r.FLOAT,size:2},{buffer:y,type:r.FLOAT,size:4}]),T=new d(r,g,p,m,v,y,_,x,b,w,i.traceType||"cone");return T.update(n),T}},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(r,n,i){var a=r("glslify"),o=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, coneScale, coneOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),s=a(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),l=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float vectorScale, coneScale, coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),c=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);i.meshShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},i.pickShader={vertex:l,fragment:c,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(r,n,i){n.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(r,n,i){var a=r("./1.0/numbers");n.exports=function(r){return a[r]}},{"./1.0/numbers":82}],84:[function(r,n,i){"use strict";n.exports=function(r){var n=r.gl,i=a(n),l=o(n,[{buffer:i,type:n.FLOAT,size:3,offset:0,stride:40},{buffer:i,type:n.FLOAT,size:4,offset:12,stride:40},{buffer:i,type:n.FLOAT,size:3,offset:28,stride:40}]),u=s(n);u.attributes.position.location=0,u.attributes.color.location=1,u.attributes.offset.location=2;var f=new c(n,i,l,u);return f.update(r),f};var a=r("gl-buffer"),o=r("gl-vao"),s=r("./shaders/index"),l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function c(r,n,i,a){this.gl=r,this.shader=a,this.buffer=n,this.vao=i,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var u=c.prototype;function f(r,n){for(var i=0;i<3;++i)r[0][i]=Math.min(r[0][i],n[i]),r[1][i]=Math.max(r[1][i],n[i])}u.isOpaque=function(){return!this.hasAlpha},u.isTransparent=function(){return this.hasAlpha},u.drawTransparent=u.draw=function(r){var n=this.gl,i=this.shader.uniforms;this.shader.bind();var a=i.view=r.view||l,o=i.projection=r.projection||l;i.model=r.model||l,i.clipBounds=this.clipBounds,i.opacity=this.opacity;var s=a[12],c=a[13],u=a[14],f=a[15],h=(r._ortho?2:1)*this.pixelRatio*(o[3]*s+o[7]*c+o[11]*u+o[15]*f)/n.drawingBufferHeight;this.vao.bind();for(var p=0;p<3;++p)n.lineWidth(this.lineWidth[p]*this.pixelRatio),i.capSize=this.capSize[p]*h,this.lineCount[p]&&n.drawArrays(n.LINES,this.lineOffset[p],this.lineCount[p]);this.vao.unbind()};var h=function(){for(var r=[,,,],n=0;n<3;++n){for(var i=[],a=1;a<=2;++a)for(var o=-1;o<=1;o+=2){var s=[0,0,0];s[(a+n)%3]=o,i.push(s)}r[n]=i}return r}();function p(r,n,i,a){for(var o=h[a],s=0;s<o.length;++s){var l=o[s];r.push(n[0],n[1],n[2],i[0],i[1],i[2],i[3],l[0],l[1],l[2])}return o.length}u.update=function(r){"lineWidth"in(r=r||{})&&(this.lineWidth=r.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in r&&(this.capSize=r.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in r&&(this.opacity=+r.opacity,this.opacity<1&&(this.hasAlpha=!0));var n=r.color||[[0,0,0],[0,0,0],[0,0,0]],i=r.position,a=r.error;if(Array.isArray(n[0])||(n=[n,n,n]),i&&a){var o=[],s=i.length,l=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var c=0;c<3;++c){this.lineOffset[c]=l;t:for(var u=0;u<s;++u){for(var h,d=i[u],m=0;m<3;++m)if(isNaN(d[m])||!isFinite(d[m]))continue t;var g=a[u],v=n[c];Array.isArray(v[0])&&(v=n[u]),3===v.length?v=[v[0],v[1],v[2],1]:4===v.length&&(v=[v[0],v[1],v[2],v[3]],!this.hasAlpha&&v[3]<1&&(this.hasAlpha=!0)),isNaN(g[0][c])||isNaN(g[1][c])||(g[0][c]<0&&((h=d.slice())[c]+=g[0][c],o.push(d[0],d[1],d[2],v[0],v[1],v[2],v[3],0,0,0,h[0],h[1],h[2],v[0],v[1],v[2],v[3],0,0,0),f(this.bounds,h),l+=2+p(o,h,v,c)),g[1][c]>0&&((h=d.slice())[c]+=g[1][c],o.push(d[0],d[1],d[2],v[0],v[1],v[2],v[3],0,0,0,h[0],h[1],h[2],v[0],v[1],v[2],v[3],0,0,0),f(this.bounds,h),l+=2+p(o,h,v,c)))}this.lineCount[c]=l-this.lineOffset[c]}this.buffer.update(o)}},u.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(r,n,i){"use strict";var a=r("glslify"),o=r("gl-shader"),s=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),l=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);n.exports=function(r){return o(r,s,l,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(r,n,i){"use strict";var a=r("gl-texture2d");n.exports=function(r,n,i,a){o||(o=r.FRAMEBUFFER_UNSUPPORTED,s=r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,l=r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,c=r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var f=r.getExtension("WEBGL_draw_buffers");if(!u&&f&&function(r,n){var i=r.getParameter(n.MAX_COLOR_ATTACHMENTS_WEBGL);u=Array(i+1);for(var a=0;a<=i;++a){for(var o=Array(i),s=0;s<a;++s)o[s]=r.COLOR_ATTACHMENT0+s;for(s=a;s<i;++s)o[s]=r.NONE;u[a]=o}}(r,f),Array.isArray(n)&&(a=i,i=0|n[1],n=0|n[0]),"number"!=typeof n)throw Error("gl-fbo: Missing shape parameter");var h=r.getParameter(r.MAX_RENDERBUFFER_SIZE);if(n<0||n>h||i<0||i>h)throw Error("gl-fbo: Parameters are too large for FBO");var p=1;if("color"in(a=a||{})){if((p=Math.max(0|a.color,0))<0)throw Error("gl-fbo: Must specify a nonnegative number of colors");if(p>1){if(!f)throw Error("gl-fbo: Multiple draw buffer extension not supported");if(p>r.getParameter(f.MAX_COLOR_ATTACHMENTS_WEBGL))throw Error("gl-fbo: Context does not support "+p+" draw buffers")}}var d=r.UNSIGNED_BYTE,m=r.getExtension("OES_texture_float");if(a.float&&p>0){if(!m)throw Error("gl-fbo: Context does not support floating point textures");d=r.FLOAT}else a.preferFloat&&p>0&&m&&(d=r.FLOAT);var v=!0;"depth"in a&&(v=!!a.depth);var y=!1;return"stencil"in a&&(y=!!a.stencil),new g(r,n,i,d,p,v,y,f)};var o,s,l,c,u=null;function f(r){return[r.getParameter(r.FRAMEBUFFER_BINDING),r.getParameter(r.RENDERBUFFER_BINDING),r.getParameter(r.TEXTURE_BINDING_2D)]}function h(r,n){r.bindFramebuffer(r.FRAMEBUFFER,n[0]),r.bindRenderbuffer(r.RENDERBUFFER,n[1]),r.bindTexture(r.TEXTURE_2D,n[2])}function p(r){switch(r){case o:throw Error("gl-fbo: Framebuffer unsupported");case s:throw Error("gl-fbo: Framebuffer incomplete attachment");case l:throw Error("gl-fbo: Framebuffer incomplete dimensions");case c:throw Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw Error("gl-fbo: Framebuffer failed for unspecified reason")}}function d(r,n,i,o,s,l){if(!o)return null;var c=a(r,n,i,s,o);return c.magFilter=r.NEAREST,c.minFilter=r.NEAREST,c.mipSamples=1,c.bind(),r.framebufferTexture2D(r.FRAMEBUFFER,l,r.TEXTURE_2D,c.handle,0),c}function m(r,n,i,a,o){var s=r.createRenderbuffer();return r.bindRenderbuffer(r.RENDERBUFFER,s),r.renderbufferStorage(r.RENDERBUFFER,a,n,i),r.framebufferRenderbuffer(r.FRAMEBUFFER,o,r.RENDERBUFFER,s),s}function g(r,n,i,a,o,s,l,c){this.gl=r,this._shape=[0|n,0|i],this._destroyed=!1,this._ext=c,this.color=Array(o);for(var g=0;g<o;++g)this.color[g]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=a,this._useDepth=s,this._useStencil=l;var v=this,y=[0|n,0|i];Object.defineProperties(y,{0:{get:function(){return v._shape[0]},set:function(r){return v.width=r}},1:{get:function(){return v._shape[1]},set:function(r){return v.height=r}}}),this._shapeVector=y,function(r){var n=f(r.gl),i=r.gl,a=r.handle=i.createFramebuffer(),o=r._shape[0],s=r._shape[1],l=r.color.length,c=r._ext,g=r._useStencil,v=r._useDepth,y=r._colorType;i.bindFramebuffer(i.FRAMEBUFFER,a);for(var x=0;x<l;++x)r.color[x]=d(i,o,s,y,i.RGBA,i.COLOR_ATTACHMENT0+x);0===l?(r._color_rb=m(i,o,s,i.RGBA4,i.COLOR_ATTACHMENT0),c&&c.drawBuffersWEBGL(u[0])):l>1&&c.drawBuffersWEBGL(u[l]);var b=i.getExtension("WEBGL_depth_texture");b?g?r.depth=d(i,o,s,b.UNSIGNED_INT_24_8_WEBGL,i.DEPTH_STENCIL,i.DEPTH_STENCIL_ATTACHMENT):v&&(r.depth=d(i,o,s,i.UNSIGNED_SHORT,i.DEPTH_COMPONENT,i.DEPTH_ATTACHMENT)):v&&g?r._depth_rb=m(i,o,s,i.DEPTH_STENCIL,i.DEPTH_STENCIL_ATTACHMENT):v?r._depth_rb=m(i,o,s,i.DEPTH_COMPONENT16,i.DEPTH_ATTACHMENT):g&&(r._depth_rb=m(i,o,s,i.STENCIL_INDEX,i.STENCIL_ATTACHMENT));var _=i.checkFramebufferStatus(i.FRAMEBUFFER);if(_!==i.FRAMEBUFFER_COMPLETE){for(r._destroyed=!0,i.bindFramebuffer(i.FRAMEBUFFER,null),i.deleteFramebuffer(r.handle),r.handle=null,r.depth&&(r.depth.dispose(),r.depth=null),r._depth_rb&&(i.deleteRenderbuffer(r._depth_rb),r._depth_rb=null),x=0;x<r.color.length;++x)r.color[x].dispose(),r.color[x]=null;r._color_rb&&(i.deleteRenderbuffer(r._color_rb),r._color_rb=null),h(i,n),p(_)}h(i,n)}(this)}var v=g.prototype;function y(r,n,i){if(r._destroyed)throw Error("gl-fbo: Can't resize destroyed FBO");if(r._shape[0]!==n||r._shape[1]!==i){var a=r.gl,o=a.getParameter(a.MAX_RENDERBUFFER_SIZE);if(n<0||n>o||i<0||i>o)throw Error("gl-fbo: Can't resize FBO, invalid dimensions");r._shape[0]=n,r._shape[1]=i;for(var s=f(a),l=0;l<r.color.length;++l)r.color[l].shape=r._shape;r._color_rb&&(a.bindRenderbuffer(a.RENDERBUFFER,r._color_rb),a.renderbufferStorage(a.RENDERBUFFER,a.RGBA4,r._shape[0],r._shape[1])),r.depth&&(r.depth.shape=r._shape),r._depth_rb&&(a.bindRenderbuffer(a.RENDERBUFFER,r._depth_rb),r._useDepth&&r._useStencil?a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,r._shape[0],r._shape[1]):r._useDepth?a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,r._shape[0],r._shape[1]):r._useStencil&&a.renderbufferStorage(a.RENDERBUFFER,a.STENCIL_INDEX,r._shape[0],r._shape[1])),a.bindFramebuffer(a.FRAMEBUFFER,r.handle);var c=a.checkFramebufferStatus(a.FRAMEBUFFER);c!==a.FRAMEBUFFER_COMPLETE&&(r.dispose(),h(a,s),p(c)),h(a,s)}}Object.defineProperties(v,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(r){if(Array.isArray(r)||(r=[0|r,0|r]),2!==r.length)throw Error("gl-fbo: Shape vector must be length 2");var n=0|r[0],i=0|r[1];return y(this,n,i),[n,i]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(r){return y(this,r|=0,this._shape[1]),r},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(r){return r|=0,y(this,this._shape[0],r),r},enumerable:!1}}),v.bind=function(){if(!this._destroyed){var r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,this.handle),r.viewport(0,0,this._shape[0],this._shape[1])}},v.dispose=function(){if(!this._destroyed){this._destroyed=!0;var r=this.gl;r.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(r.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var n=0;n<this.color.length;++n)this.color[n].dispose(),this.color[n]=null;this._color_rb&&(r.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":146}],87:[function(r,n,i){var a=r("sprintf-js").sprintf,o=r("gl-constants/lookup"),s=r("glsl-shader-name"),l=r("add-line-numbers");n.exports=function(r,n,i){"use strict";var c=s(n)||"of unknown name (see npm glsl-shader-name)",u="unknown type";void 0!==i&&(u=i===o.FRAGMENT_SHADER?"fragment":"vertex");for(var f=a("Error compiling %s shader %s:\n",u,c),h=a("%s%s",f,r),p=r.split("\n"),d={},m=0;m<p.length;m++){var g=p[m];if(""!==g&&"\x00"!==g){var v=parseInt(g.split(":")[2]);if(isNaN(v))throw Error(a("Could not parse error: %s",g));d[v]=g}}var y=l(n).split("\n");for(m=0;m<y.length;m++)if((d[m+3]||d[m+2]||d[m+1])&&(f+=y[m]+"\n",d[m+1])){var x=d[m+1];f+=a("^^^ %s\n\n",x=x.substr(x.split(":",3).join(":").length+1).trim())}return{long:f.trim(),short:h.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(r,n,i){"use strict";n.exports=function(r,n){var i=r.gl,a=new p(r,u(i,h.vertex,h.fragment),u(i,h.pickVertex,h.pickFragment),f(i),f(i),f(i),f(i));return a.update(n),r.addObject(a),a};var a,o,s=r("binary-search-bounds"),l=r("iota-array"),c=r("typedarray-pool"),u=r("gl-shader"),f=r("gl-buffer"),h=r("./lib/shaders");function p(r,n,i,a,o,s,l){this.plot=r,this.shader=n,this.pickShader=i,this.positionBuffer=a,this.weightBuffer=o,this.colorBuffer=s,this.idBuffer=l,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var d,m=p.prototype,g=[0,0,1,0,0,1,1,0,1,1,0,1];m.draw=(d=[1,0,0,0,1,0,0,0,1],function(){var r=this.plot,n=this.shader,i=this.bounds,a=this.numVertices;if(!(a<=0)){var o=r.gl,s=r.dataBox,l=i[2]-i[0],c=i[3]-i[1],u=s[2]-s[0],f=s[3]-s[1];d[0]=2*l/u,d[4]=2*c/f,d[6]=2*(i[0]-s[0])/u-1,d[7]=2*(i[1]-s[1])/f-1,n.bind();var h=n.uniforms;h.viewTransform=d,h.shape=this.shape;var p=n.attributes;this.positionBuffer.bind(),p.position.pointer(),this.weightBuffer.bind(),p.weight.pointer(o.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),p.color.pointer(o.UNSIGNED_BYTE,!0),o.drawArrays(o.TRIANGLES,0,a)}}),m.drawPick=(a=[1,0,0,0,1,0,0,0,1],o=[0,0,0,0],function(r){var n=this.plot,i=this.pickShader,s=this.bounds,l=this.numVertices;if(!(l<=0)){var c=n.gl,u=n.dataBox,f=s[2]-s[0],h=s[3]-s[1],p=u[2]-u[0],d=u[3]-u[1];a[0]=2*f/p,a[4]=2*h/d,a[6]=2*(s[0]-u[0])/p-1,a[7]=2*(s[1]-u[1])/d-1;for(var m=0;m<4;++m)o[m]=r>>8*m&255;this.pickOffset=r,i.bind();var g=i.uniforms;g.viewTransform=a,g.pickOffset=o,g.shape=this.shape;var v=i.attributes;return this.positionBuffer.bind(),v.position.pointer(),this.weightBuffer.bind(),v.weight.pointer(c.UNSIGNED_BYTE,!1),this.idBuffer.bind(),v.pickId.pointer(c.UNSIGNED_BYTE,!1),c.drawArrays(c.TRIANGLES,0,l),r+this.shape[0]*this.shape[1]}}),m.pick=function(r,n,i){var a=this.pickOffset,o=this.shape[0]*this.shape[1];if(i<a||i>=a+o)return null;var s=i-a,l=this.xData,c=this.yData;return{object:this,pointId:s,dataCoord:[l[s%this.shape[0]],c[s/this.shape[0]|0]]}},m.update=function(r){var n=(r=r||{}).shape||[0,0],i=r.x||l(n[0]),a=r.y||l(n[1]),o=r.z||new Float32Array(n[0]*n[1]),u=!1!==r.zsmooth;this.xData=i,this.yData=a;var f,h,p,d,m=r.colorLevels||[0],v=r.colorValues||[0,0,0,1],y=m.length,x=this.bounds;u?(f=x[0]=i[0],h=x[1]=a[0],p=x[2]=i[i.length-1],d=x[3]=a[a.length-1]):(f=x[0]=i[0]+(i[1]-i[0])/2,h=x[1]=a[0]+(a[1]-a[0])/2,p=x[2]=i[i.length-1]+(i[i.length-1]-i[i.length-2])/2,d=x[3]=a[a.length-1]+(a[a.length-1]-a[a.length-2])/2);var b=1/(p-f),_=1/(d-h),w=n[0],T=n[1];this.shape=[w,T];var k=(u?(w-1)*(T-1):w*T)*(g.length>>>1);this.numVertices=k;for(var A=c.mallocUint8(4*k),M=c.mallocFloat32(2*k),S=c.mallocUint8(2*k),E=c.mallocUint32(k),L=0,C=u?w-1:w,P=u?T-1:T,I=0;I<P;++I){u?(D=_*(a[I]-h),R=_*(a[I+1]-h)):(D=I<T-1?_*(a[I]-(a[I+1]-a[I])/2-h):_*(a[I]-(a[I]-a[I-1])/2-h),R=I<T-1?_*(a[I]+(a[I+1]-a[I])/2-h):_*(a[I]+(a[I]-a[I-1])/2-h));for(var O=0;O<C;++O){u?(F=b*(i[O]-f),B=b*(i[O+1]-f)):(F=O<w-1?b*(i[O]-(i[O+1]-i[O])/2-f):b*(i[O]-(i[O]-i[O-1])/2-f),B=O<w-1?b*(i[O]+(i[O+1]-i[O])/2-f):b*(i[O]+(i[O]-i[O-1])/2-f));for(var z=0;z<g.length;z+=2){var D,R,F,B,N,j,U,V,H=g[z],q=g[z+1],G=o[u?(I+q)*w+(O+H):I*w+O],Y=s.le(m,G);if(Y<0)N=v[0],j=v[1],U=v[2],V=v[3];else if(Y===y-1)N=v[4*y-4],j=v[4*y-3],U=v[4*y-2],V=v[4*y-1];else{var W=(G-m[Y])/(m[Y+1]-m[Y]),X=1-W,Z=4*Y,J=4*(Y+1);N=X*v[Z]+W*v[J],j=X*v[Z+1]+W*v[J+1],U=X*v[Z+2]+W*v[J+2],V=X*v[Z+3]+W*v[J+3]}A[4*L]=255*N,A[4*L+1]=255*j,A[4*L+2]=255*U,A[4*L+3]=255*V,M[2*L]=.5*F+.5*B,M[2*L+1]=.5*D+.5*R,S[2*L]=H,S[2*L+1]=q,E[L]=I*w+O,L+=1}}}this.positionBuffer.update(M),this.weightBuffer.update(S),this.colorBuffer.update(A),this.idBuffer.update(E),c.free(M),c.free(A),c.free(S),c.free(E)},m.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(r,n,i){"use strict";var a=r("glslify");n.exports={fragment:a(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:231}],90:[function(r,n,i){var a=r("glslify"),o=r("gl-shader"),s=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),l=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),c=a(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\n// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl\nvec4 packFloat(float v) {\n  float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  float e = floor(log2(av));\n  float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);\n}"]),u=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];i.createShader=function(r){return o(r,s,l,null,u)},i.createPickShader=function(r){return o(r,s,c,null,u)}},{"gl-shader":132,glslify:231}],91:[function(r,n,i){"use strict";n.exports=function(r){var n=r.gl||r.scene&&r.scene.gl,i=p(n);i.attributes.position.location=0,i.attributes.nextPosition.location=1,i.attributes.arcLength.location=2,i.attributes.lineWidth.location=3,i.attributes.color.location=4;var l=d(n);l.attributes.position.location=0,l.attributes.nextPosition.location=1,l.attributes.arcLength.location=2,l.attributes.lineWidth.location=3,l.attributes.color.location=4;for(var c=a(n),u=o(n,[{buffer:c,size:3,offset:0,stride:48},{buffer:c,size:3,offset:12,stride:48},{buffer:c,size:1,offset:24,stride:48},{buffer:c,size:1,offset:28,stride:48},{buffer:c,size:4,offset:32,stride:48}]),h=f(Array(1024),[256,1,4]),m=0;m<1024;++m)h.data[m]=255;var g=s(n,h);g.wrap=n.REPEAT;var v=new y(n,i,l,c,u,g);return v.update(r),v};var a=r("gl-buffer"),o=r("gl-vao"),s=r("gl-texture2d"),l=new Uint8Array(4),c=new Float32Array(l.buffer),u=r("binary-search-bounds"),f=r("ndarray"),h=r("./lib/shaders"),p=h.createShader,d=h.createPickShader,m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function g(r){for(var n=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],i=0;i<3;++i)n[0][i]=Math.max(r[0][i],n[0][i]),n[1][i]=Math.min(r[1][i],n[1][i]);return n}function v(r,n,i,a){this.arcLength=r,this.position=n,this.index=i,this.dataCoordinate=a}function y(r,n,i,a,o,s){this.gl=r,this.shader=n,this.pickShader=i,this.buffer=a,this.vao=o,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=s,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var x=y.prototype;x.isTransparent=function(){return this.hasAlpha},x.isOpaque=function(){return!this.hasAlpha},x.pickSlots=1,x.setPickBase=function(r){this.pickId=r},x.drawTransparent=x.draw=function(r){if(this.vertexCount){var n=this.gl,i=this.shader,a=this.vao;i.bind(),i.uniforms={model:r.model||m,view:r.view||m,projection:r.projection||m,clipBounds:g(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[n.drawingBufferWidth,n.drawingBufferHeight],pixelRatio:this.pixelRatio},a.bind(),a.draw(n.TRIANGLE_STRIP,this.vertexCount),a.unbind()}},x.drawPick=function(r){if(this.vertexCount){var n=this.gl,i=this.pickShader,a=this.vao;i.bind(),i.uniforms={model:r.model||m,view:r.view||m,projection:r.projection||m,pickId:this.pickId,clipBounds:g(this.clipBounds),screenShape:[n.drawingBufferWidth,n.drawingBufferHeight],pixelRatio:this.pixelRatio},a.bind(),a.draw(n.TRIANGLE_STRIP,this.vertexCount),a.unbind()}},x.update=function(r){this.dirty=!0;var n=!!r.connectGaps;"dashScale"in r&&(this.dashScale=r.dashScale),this.hasAlpha=!1,"opacity"in r&&(this.opacity=+r.opacity,this.opacity<1&&(this.hasAlpha=!0));var i=[],a=[],o=[],s=0,l=0,c=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],h=r.position||r.positions;if(h){var p=r.color||r.colors||[0,0,0,1],d=r.lineWidth||1,m=!1;t:for(g=1;g<h.length;++g){var g,v,y,x,b,_=h[g-1],w=h[g];for(a.push(s),o.push(_.slice()),v=0;v<3;++v){if(isNaN(_[v])||isNaN(w[v])||!isFinite(_[v])||!isFinite(w[v])){if(!n&&i.length>0){for(var T=0;T<24;++T)i.push(i[i.length-12]);l+=2,m=!0}continue t}c[0][v]=Math.min(c[0][v],_[v],w[v]),c[1][v]=Math.max(c[1][v],_[v],w[v])}Array.isArray(p[0])?(y=p.length>g-1?p[g-1]:p.length>0?p[p.length-1]:[0,0,0,1],x=p.length>g?p[g]:p.length>0?p[p.length-1]:[0,0,0,1]):y=x=p,3===y.length&&(y=[y[0],y[1],y[2],1]),3===x.length&&(x=[x[0],x[1],x[2],1]),!this.hasAlpha&&y[3]<1&&(this.hasAlpha=!0),b=Array.isArray(d)?d.length>g-1?d[g-1]:d.length>0?d[d.length-1]:[0,0,0,1]:d;var k=s;if(s+=function(r,n){for(var i=0,a=0;a<3;++a){var o=r[a]-n[a];i+=o*o}return Math.sqrt(i)}(_,w),m){for(v=0;v<2;++v)i.push(_[0],_[1],_[2],w[0],w[1],w[2],k,b,y[0],y[1],y[2],y[3]);l+=2,m=!1}i.push(_[0],_[1],_[2],w[0],w[1],w[2],k,b,y[0],y[1],y[2],y[3],_[0],_[1],_[2],w[0],w[1],w[2],k,-b,y[0],y[1],y[2],y[3],w[0],w[1],w[2],_[0],_[1],_[2],s,-b,x[0],x[1],x[2],x[3],w[0],w[1],w[2],_[0],_[1],_[2],s,b,x[0],x[1],x[2],x[3]),l+=4}}if(this.buffer.update(i),a.push(s),o.push(h[h.length-1].slice()),this.bounds=c,this.vertexCount=l,this.points=o,this.arcLength=a,"dashes"in r){var A=r.dashes.slice();for(A.unshift(0),g=1;g<A.length;++g)A[g]=A[g-1]+A[g];var M=f(Array(1024),[256,1,4]);for(g=0;g<256;++g){for(v=0;v<4;++v)M.set(g,0,v,0);1&u.le(A,A[A.length-1]*g/255)?M.set(g,0,0,0):M.set(g,0,0,255)}this.texture.setPixels(M)}},x.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},x.pick=function(r){if(!r||r.id!==this.pickId)return null;var n,i,a,o=(n=r.value[0],i=r.value[1],a=r.value[2],l[0]=0,l[1]=a,l[2]=i,l[3]=n,c[0]),s=u.le(this.arcLength,o);if(s<0)return null;if(s===this.arcLength.length-1)return new v(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),s);for(var f=this.points[s],h=this.points[Math.min(s+1,this.points.length-1)],p=(o-this.arcLength[s])/(this.arcLength[s+1]-this.arcLength[s]),d=1-p,m=[0,0,0],g=0;g<3;++g)m[g]=d*f[g]+p*h[g];var y=Math.min(p<.5?s:s+1,this.points.length-1);return new v(o,m,y,this.points[y])}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(r,n,i){n.exports=function(r){var n=new Float32Array(16);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n}},{}],93:[function(r,n,i){n.exports=function(){var r=new Float32Array(16);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],94:[function(r,n,i){n.exports=function(r){var n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],l=r[5],c=r[6],u=r[7],f=r[8],h=r[9],p=r[10],d=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return(n*l-i*s)*(p*y-d*v)-(n*c-a*s)*(h*y-d*g)+(n*u-o*s)*(h*v-p*g)+(i*c-a*l)*(f*y-d*m)-(i*u-o*l)*(f*v-p*m)+(a*u-o*c)*(f*g-h*m)}},{}],95:[function(r,n,i){n.exports=function(r,n){var i=n[0],a=n[1],o=n[2],s=n[3],l=i+i,c=a+a,u=o+o,f=i*l,h=a*l,p=a*c,d=o*l,m=o*c,g=o*u,v=s*l,y=s*c,x=s*u;return r[0]=1-p-g,r[1]=h+x,r[2]=d-y,r[3]=0,r[4]=h-x,r[5]=1-f-g,r[6]=m+v,r[7]=0,r[8]=d+y,r[9]=m-v,r[10]=1-f-p,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],96:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=n[3],c=a+a,u=o+o,f=s+s,h=a*c,p=a*u,d=a*f,m=o*u,g=o*f,v=s*f,y=l*c,x=l*u,b=l*f;return r[0]=1-(m+v),r[1]=p+b,r[2]=d-x,r[3]=0,r[4]=p-b,r[5]=1-(h+v),r[6]=g+y,r[7]=0,r[8]=d+x,r[9]=g-y,r[10]=1-(h+m),r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}},{}],97:[function(r,n,i){n.exports=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}},{}],98:[function(r,n,i){n.exports=function(r,n){var i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],u=n[6],f=n[7],h=n[8],p=n[9],d=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15],b=i*c-a*l,_=i*u-o*l,w=i*f-s*l,T=a*u-o*c,k=a*f-s*c,A=o*f-s*u,M=h*v-p*g,S=h*y-d*g,E=h*x-m*g,L=p*y-d*v,C=p*x-m*v,P=d*x-m*y,I=b*P-_*C+w*L+T*E-k*S+A*M;return I?(I=1/I,r[0]=(c*P-u*C+f*L)*I,r[1]=(o*C-a*P-s*L)*I,r[2]=(v*A-y*k+x*T)*I,r[3]=(d*k-p*A-m*T)*I,r[4]=(u*E-l*P-f*S)*I,r[5]=(i*P-o*E+s*S)*I,r[6]=(y*w-g*A-x*_)*I,r[7]=(h*A-d*w+m*_)*I,r[8]=(l*C-c*E+f*M)*I,r[9]=(a*E-i*C-s*M)*I,r[10]=(g*k-v*w+x*b)*I,r[11]=(p*w-h*k-m*b)*I,r[12]=(c*S-l*L-u*M)*I,r[13]=(i*L-a*S+o*M)*I,r[14]=(v*_-g*T-y*b)*I,r[15]=(h*T-p*_+d*b)*I,r):null}},{}],99:[function(r,n,i){var a=r("./identity");n.exports=function(r,n,i,o){var s,l,c,u,f,h,p,d,m,g,v=n[0],y=n[1],x=n[2],b=o[0],_=o[1],w=o[2],T=i[0],k=i[1],A=i[2];return 1e-6>Math.abs(v-T)&&1e-6>Math.abs(y-k)&&1e-6>Math.abs(x-A)?a(r):(g=1/Math.sqrt((p=v-T)*p+(d=y-k)*d+(m=x-A)*m),(g=Math.sqrt((s=_*(m*=g)-w*(d*=g))*s+(l=w*(p*=g)-b*m)*l+(c=b*d-_*p)*c))?(s*=g=1/g,l*=g,c*=g):(s=0,l=0,c=0),(g=Math.sqrt((u=d*c-m*l)*u+(f=m*s-p*c)*f+(h=p*l-d*s)*h))?(u*=g=1/g,f*=g,h*=g):(u=0,f=0,h=0),r[0]=s,r[1]=u,r[2]=p,r[3]=0,r[4]=l,r[5]=f,r[6]=d,r[7]=0,r[8]=c,r[9]=h,r[10]=m,r[11]=0,r[12]=-(s*v+l*y+c*x),r[13]=-(u*v+f*y+h*x),r[14]=-(p*v+d*y+m*x),r[15]=1,r)}},{"./identity":97}],100:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=n[3],c=n[4],u=n[5],f=n[6],h=n[7],p=n[8],d=n[9],m=n[10],g=n[11],v=n[12],y=n[13],x=n[14],b=n[15],_=i[0],w=i[1],T=i[2],k=i[3];return r[0]=_*a+w*c+T*p+k*v,r[1]=_*o+w*u+T*d+k*y,r[2]=_*s+w*f+T*m+k*x,r[3]=_*l+w*h+T*g+k*b,_=i[4],w=i[5],T=i[6],k=i[7],r[4]=_*a+w*c+T*p+k*v,r[5]=_*o+w*u+T*d+k*y,r[6]=_*s+w*f+T*m+k*x,r[7]=_*l+w*h+T*g+k*b,_=i[8],w=i[9],T=i[10],k=i[11],r[8]=_*a+w*c+T*p+k*v,r[9]=_*o+w*u+T*d+k*y,r[10]=_*s+w*f+T*m+k*x,r[11]=_*l+w*h+T*g+k*b,_=i[12],w=i[13],T=i[14],k=i[15],r[12]=_*a+w*c+T*p+k*v,r[13]=_*o+w*u+T*d+k*y,r[14]=_*s+w*f+T*m+k*x,r[15]=_*l+w*h+T*g+k*b,r}},{}],101:[function(r,n,i){n.exports=function(r,n,i,a,o,s,l){var c=1/(n-i),u=1/(a-o),f=1/(s-l);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*u,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*f,r[11]=0,r[12]=(n+i)*c,r[13]=(o+a)*u,r[14]=(l+s)*f,r[15]=1,r}},{}],102:[function(r,n,i){n.exports=function(r,n,i,a,o){var s=1/Math.tan(n/2),l=1/(a-o);return r[0]=s/i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=(o+a)*l,r[11]=-1,r[12]=0,r[13]=0,r[14]=2*o*a*l,r[15]=0,r}},{}],103:[function(r,n,i){n.exports=function(r,n,i,a){var o,s,l,c,u,f,h,p,d,m,g,v,y,x,b,_,w,T,k,A,M,S,E,L,C=a[0],P=a[1],I=a[2],O=Math.sqrt(C*C+P*P+I*I);return 1e-6>Math.abs(O)?null:(C*=O=1/O,P*=O,I*=O,o=Math.sin(i),l=1-(s=Math.cos(i)),c=n[0],u=n[1],f=n[2],h=n[3],p=n[4],d=n[5],m=n[6],g=n[7],v=n[8],y=n[9],x=n[10],b=n[11],_=C*C*l+s,w=P*C*l+I*o,T=I*C*l-P*o,k=C*P*l-I*o,A=P*P*l+s,M=I*P*l+C*o,S=C*I*l+P*o,E=P*I*l-C*o,L=I*I*l+s,r[0]=c*_+p*w+v*T,r[1]=u*_+d*w+y*T,r[2]=f*_+m*w+x*T,r[3]=h*_+g*w+b*T,r[4]=c*k+p*A+v*M,r[5]=u*k+d*A+y*M,r[6]=f*k+m*A+x*M,r[7]=h*k+g*A+b*M,r[8]=c*S+p*E+v*L,r[9]=u*S+d*E+y*L,r[10]=f*S+m*E+x*L,r[11]=h*S+g*E+b*L,n!==r&&(r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r)}},{}],104:[function(r,n,i){n.exports=function(r,n,i){var a=Math.sin(i),o=Math.cos(i),s=n[4],l=n[5],c=n[6],u=n[7],f=n[8],h=n[9],p=n[10],d=n[11];return n!==r&&(r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[4]=s*o+f*a,r[5]=l*o+h*a,r[6]=c*o+p*a,r[7]=u*o+d*a,r[8]=f*o-s*a,r[9]=h*o-l*a,r[10]=p*o-c*a,r[11]=d*o-u*a,r}},{}],105:[function(r,n,i){n.exports=function(r,n,i){var a=Math.sin(i),o=Math.cos(i),s=n[0],l=n[1],c=n[2],u=n[3],f=n[8],h=n[9],p=n[10],d=n[11];return n!==r&&(r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=s*o-f*a,r[1]=l*o-h*a,r[2]=c*o-p*a,r[3]=u*o-d*a,r[8]=s*a+f*o,r[9]=l*a+h*o,r[10]=c*a+p*o,r[11]=u*a+d*o,r}},{}],106:[function(r,n,i){n.exports=function(r,n,i){var a=Math.sin(i),o=Math.cos(i),s=n[0],l=n[1],c=n[2],u=n[3],f=n[4],h=n[5],p=n[6],d=n[7];return n!==r&&(r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=s*o+f*a,r[1]=l*o+h*a,r[2]=c*o+p*a,r[3]=u*o+d*a,r[4]=f*o-s*a,r[5]=h*o-l*a,r[6]=p*o-c*a,r[7]=d*o-u*a,r}},{}],107:[function(r,n,i){n.exports=function(r,n,i){var a=i[0],o=i[1],s=i[2];return r[0]=n[0]*a,r[1]=n[1]*a,r[2]=n[2]*a,r[3]=n[3]*a,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[7]=n[7]*o,r[8]=n[8]*s,r[9]=n[9]*s,r[10]=n[10]*s,r[11]=n[11]*s,r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r}},{}],108:[function(r,n,i){n.exports=function(r,n,i){var a,o,s,l,c,u,f,h,p,d,m,g,v=i[0],y=i[1],x=i[2];return n===r?(r[12]=n[0]*v+n[4]*y+n[8]*x+n[12],r[13]=n[1]*v+n[5]*y+n[9]*x+n[13],r[14]=n[2]*v+n[6]*y+n[10]*x+n[14],r[15]=n[3]*v+n[7]*y+n[11]*x+n[15]):(a=n[0],o=n[1],s=n[2],l=n[3],c=n[4],u=n[5],f=n[6],h=n[7],p=n[8],d=n[9],m=n[10],g=n[11],r[0]=a,r[1]=o,r[2]=s,r[3]=l,r[4]=c,r[5]=u,r[6]=f,r[7]=h,r[8]=p,r[9]=d,r[10]=m,r[11]=g,r[12]=a*v+c*y+p*x+n[12],r[13]=o*v+u*y+d*x+n[13],r[14]=s*v+f*y+m*x+n[14],r[15]=l*v+h*y+g*x+n[15]),r}},{}],109:[function(r,n,i){n.exports=function(r,n){if(r===n){var i=n[1],a=n[2],o=n[3],s=n[6],l=n[7],c=n[11];r[1]=n[4],r[2]=n[8],r[3]=n[12],r[4]=i,r[6]=n[9],r[7]=n[13],r[8]=a,r[9]=s,r[11]=n[14],r[12]=o,r[13]=l,r[14]=c}else r[0]=n[0],r[1]=n[4],r[2]=n[8],r[3]=n[12],r[4]=n[1],r[5]=n[5],r[6]=n[9],r[7]=n[13],r[8]=n[2],r[9]=n[6],r[10]=n[10],r[11]=n[14],r[12]=n[3],r[13]=n[7],r[14]=n[11],r[15]=n[15];return r}},{}],110:[function(r,n,i){"use strict";var a=r("barycentric"),o=r("polytope-closest-point/lib/closest_point_2d.js");function s(r,n){for(var i=[0,0,0,0],a=0;a<4;++a)for(var o=0;o<4;++o)i[o]+=r[4*a+o]*n[a];return i}n.exports=function(r,n,i,l,c,u){if(1===r.length)return[0,r[0].slice()];for(var f=Array(r.length),h=0;h<r.length;++h)f[h]=function(r,n,i,a,o){for(var l=s(a,s(i,s(n,[r[0],r[1],r[2],1]))),c=0;c<3;++c)l[c]/=l[3];return[.5*o[0]*(1+l[0]),.5*o[1]*(1-l[1])]}(r[h],i,l,c,u);var p=0,d=1/0;for(h=0;h<f.length;++h){for(var m=0,g=0;g<2;++g)m+=Math.pow(f[h][g]-n[g],2);m<d&&(d=m,p=h)}var v=function(r,n){if(2===r.length){for(var i=0,s=0,l=0;l<2;++l)i+=Math.pow(n[l]-r[0][l],2),s+=Math.pow(n[l]-r[1][l],2);return(i=Math.sqrt(i))+(s=Math.sqrt(s))<1e-6?[1,0]:[s/(i+s),i/(s+i)]}if(3===r.length){var c=[0,0];return o(r[0],r[1],r[2],n,c),a(r,c)}return[]}(f,n),y=0;for(h=0;h<3;++h){if(v[h]<-.001||v[h]>1.0001)return null;y+=v[h]}return Math.abs(y-1)>.001?null:[p,function(r,n){for(var i=[0,0,0],a=0;a<r.length;++a)for(var o=r[a],s=n[a],l=0;l<3;++l)i[l]+=s*o[l];return i}(r,v),v]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(r,n,i){var a=r("glslify"),o=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]),s=a(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]),l=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),c=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),u=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),f=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),h=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),p=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),d=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),m=a(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),g=a(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);i.meshShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},i.wireShader={vertex:l,fragment:c,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},i.pointShader={vertex:u,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},i.pickShader={vertex:h,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},i.pointPickShader={vertex:d,fragment:p,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},i.contourShader={vertex:m,fragment:g,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(r,n,i){"use strict";var a=r("gl-shader"),o=r("gl-buffer"),s=r("gl-vao"),l=r("gl-texture2d"),c=r("normals"),u=r("gl-mat4/multiply"),f=r("gl-mat4/invert"),h=r("ndarray"),p=r("colormap"),d=r("simplicial-complex-contour"),m=r("typedarray-pool"),g=r("./lib/shaders"),v=r("./lib/closest-point"),y=g.meshShader,x=g.wireShader,b=g.pointShader,_=g.pickShader,w=g.pointPickShader,T=g.contourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function A(r,n,i,a,o,s,l,c,u,f,h,p,d,m,g,v,y,x,b,_,w,T,A,M,S,E,L){this.gl=r,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=n,this.dirty=!0,this.triShader=i,this.lineShader=a,this.pointShader=o,this.pickShader=s,this.pointPickShader=l,this.contourShader=c,this.trianglePositions=u,this.triangleColors=h,this.triangleNormals=d,this.triangleUVs=p,this.triangleIds=f,this.triangleVAO=m,this.triangleCount=0,this.lineWidth=1,this.edgePositions=g,this.edgeColors=y,this.edgeUVs=x,this.edgeIds=v,this.edgeVAO=b,this.edgeCount=0,this.pointPositions=_,this.pointColors=T,this.pointUVs=A,this.pointSizes=M,this.pointIds=w,this.pointVAO=S,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=E,this.contourVAO=L,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=k,this._view=k,this._projection=k,this._resolution=[1,1]}var M=A.prototype;function S(r,n){if(!n||!n.length)return 1;for(var i=0;i<n.length&&!(n.length<2);++i){if(n[i][0]===r)return n[i][1];if(n[i][0]>r&&i>0){var a=(n[i][0]-r)/(n[i][0]-n[i-1][0]);return n[i][1]*(1-a)+a*n[i-1][1]}}return 1}M.isOpaque=function(){return!this.hasAlpha},M.isTransparent=function(){return this.hasAlpha},M.pickSlots=1,M.setPickBase=function(r){this.pickId=r},M.highlight=function(r){if(r&&this.contourEnable){for(var n=d(this.cells,this.intensity,r.intensity),i=n.cells,a=n.vertexIds,o=n.vertexWeights,s=i.length,l=m.mallocFloat32(6*s),c=0,u=0;u<s;++u)for(var f=i[u],h=0;h<2;++h){var p=f[0];2===f.length&&(p=f[h]);for(var g=a[p][0],v=a[p][1],y=o[p],x=1-y,b=this.positions[g],_=this.positions[v],w=0;w<3;++w)l[c++]=y*b[w]+x*_[w]}this.contourCount=c/3|0,this.contourPositions.update(l.subarray(0,c)),m.free(l)}else this.contourCount=0},M.update=function(r){r=r||{};var n=this.gl;this.dirty=!0,"contourEnable"in r&&(this.contourEnable=r.contourEnable),"contourColor"in r&&(this.contourColor=r.contourColor),"lineWidth"in r&&(this.lineWidth=r.lineWidth),"lightPosition"in r&&(this.lightPosition=r.lightPosition),this.hasAlpha=!1,"opacity"in r&&(this.opacity=r.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in r&&(this.opacityscale=r.opacityscale,this.hasAlpha=!0),"ambient"in r&&(this.ambientLight=r.ambient),"diffuse"in r&&(this.diffuseLight=r.diffuse),"specular"in r&&(this.specularLight=r.specular),"roughness"in r&&(this.roughness=r.roughness),"fresnel"in r&&(this.fresnel=r.fresnel),r.texture?(this.texture.dispose(),this.texture=l(n,r.texture)):r.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=n.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=n.LINEAR,this.texture.setPixels(function(r,n){for(var i=p({colormap:r,nshades:256,format:"rgba"}),a=new Uint8Array(1024),o=0;o<256;++o){for(var s=i[o],l=0;l<3;++l)a[4*o+l]=s[l];a[4*o+3]=n?255*S(o/255,n):255*s[3]}return h(a,[256,256,4],[4,0,1])}(r.colormap,this.opacityscale)),this.texture.generateMipmap());var i=r.cells,a=r.positions;if(a&&i){var o=[],s=[],u=[],f=[],d=[],m=[],g=[],v=[],y=[],x=[],b=[],_=[],w=[],T=[];this.cells=i,this.positions=a;var k=r.vertexNormals,A=r.cellNormals,M=void 0===r.vertexNormalsEpsilon?1e-6:r.vertexNormalsEpsilon,E=void 0===r.faceNormalsEpsilon?1e-6:r.faceNormalsEpsilon;r.useFacetNormals&&!A&&(A=c.faceNormals(i,a,E)),A||k||(k=c.vertexNormals(i,a,M));var L=r.vertexColors,C=r.cellColors,P=r.meshColor||[1,1,1,1],I=r.vertexUVs,O=r.vertexIntensity,z=r.cellUVs,D=r.cellIntensity,R=1/0,F=-1/0;if(!I&&!z){if(O){if(r.vertexIntensityBounds)R=+r.vertexIntensityBounds[0],F=+r.vertexIntensityBounds[1];else for(var B=0;B<O.length;++B){var N=O[B];R=Math.min(R,N),F=Math.max(F,N)}}else if(D){if(r.cellIntensityBounds)R=+r.cellIntensityBounds[0],F=+r.cellIntensityBounds[1];else for(B=0;B<D.length;++B)R=Math.min(R,N=D[B]),F=Math.max(F,N)}else for(B=0;B<a.length;++B)R=Math.min(R,N=a[B][2]),F=Math.max(F,N)}this.intensity=O||D||function(r){for(var n=r.length,i=Array(n),a=0;a<n;++a)i[a]=r[a][2];return i}(a),this.pickVertex=!(D||C);var j=r.pointSizes,U=r.pointSize||1;for(B=0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];B<a.length;++B)for(var V=a[B],H=0;H<3;++H)!isNaN(V[H])&&isFinite(V[H])&&(this.bounds[0][H]=Math.min(this.bounds[0][H],V[H]),this.bounds[1][H]=Math.max(this.bounds[1][H],V[H]));var q=0,G=0,Y=0;t:for(B=0;B<i.length;++B){var W,X,Z,J,K=i[B];switch(K.length){case 1:for(V=a[W=K[0]],H=0;H<3;++H)if(isNaN(V[H])||!isFinite(V[H]))continue t;x.push(V[0],V[1],V[2]),X=L?L[W]:C?C[B]:P,this.opacityscale&&O?s.push(X[0],X[1],X[2],this.opacity*S((O[W]-R)/(F-R),this.opacityscale)):3===X.length?b.push(X[0],X[1],X[2],this.opacity):(b.push(X[0],X[1],X[2],X[3]*this.opacity),X[3]<1&&(this.hasAlpha=!0)),Z=I?I[W]:O?[(O[W]-R)/(F-R),0]:z?z[B]:D?[(D[B]-R)/(F-R),0]:[(V[2]-R)/(F-R),0],_.push(Z[0],Z[1]),j?w.push(j[W]):w.push(U),T.push(B),Y+=1;break;case 2:for(H=0;H<2;++H){V=a[W=K[H]];for(var Q=0;Q<3;++Q)if(isNaN(V[Q])||!isFinite(V[Q]))continue t}for(H=0;H<2;++H)V=a[W=K[H]],m.push(V[0],V[1],V[2]),X=L?L[W]:C?C[B]:P,this.opacityscale&&O?s.push(X[0],X[1],X[2],this.opacity*S((O[W]-R)/(F-R),this.opacityscale)):3===X.length?g.push(X[0],X[1],X[2],this.opacity):(g.push(X[0],X[1],X[2],X[3]*this.opacity),X[3]<1&&(this.hasAlpha=!0)),Z=I?I[W]:O?[(O[W]-R)/(F-R),0]:z?z[B]:D?[(D[B]-R)/(F-R),0]:[(V[2]-R)/(F-R),0],v.push(Z[0],Z[1]),y.push(B);G+=1;break;case 3:for(H=0;H<3;++H)for(V=a[W=K[H]],Q=0;Q<3;++Q)if(isNaN(V[Q])||!isFinite(V[Q]))continue t;for(H=0;H<3;++H)V=a[W=K[2-H]],o.push(V[0],V[1],V[2]),(X=L?L[W]:C?C[B]:P)?this.opacityscale&&O?s.push(X[0],X[1],X[2],this.opacity*S((O[W]-R)/(F-R),this.opacityscale)):3===X.length?s.push(X[0],X[1],X[2],this.opacity):(s.push(X[0],X[1],X[2],X[3]*this.opacity),X[3]<1&&(this.hasAlpha=!0)):s.push(.5,.5,.5,1),Z=I?I[W]:O?[(O[W]-R)/(F-R),0]:z?z[B]:D?[(D[B]-R)/(F-R),0]:[(V[2]-R)/(F-R),0],f.push(Z[0],Z[1]),J=k?k[W]:A[B],u.push(J[0],J[1],J[2]),d.push(B);q+=1}}this.pointCount=Y,this.edgeCount=G,this.triangleCount=q,this.pointPositions.update(x),this.pointColors.update(b),this.pointUVs.update(_),this.pointSizes.update(w),this.pointIds.update(new Uint32Array(T)),this.edgePositions.update(m),this.edgeColors.update(g),this.edgeUVs.update(v),this.edgeIds.update(new Uint32Array(y)),this.trianglePositions.update(o),this.triangleColors.update(s),this.triangleUVs.update(f),this.triangleNormals.update(u),this.triangleIds.update(new Uint32Array(d))}},M.drawTransparent=M.draw=function(r){r=r||{};for(var n=this.gl,i=r.model||k,a=r.view||k,o=r.projection||k,s=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;l<3;++l)s[0][l]=Math.max(s[0][l],this.clipBounds[0][l]),s[1][l]=Math.min(s[1][l],this.clipBounds[1][l]);var c={model:i,view:a,projection:o,inverseModel:k.slice(),clipBounds:s,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};c.inverseModel=f(c.inverseModel,c.model),n.disable(n.CULL_FACE),this.texture.bind(0);var h=Array(16);for(u(h,c.view,c.model),u(h,c.projection,h),f(h,h),l=0;l<3;++l)c.eyePosition[l]=h[12+l]/h[15];var p,d=h[15];for(l=0;l<3;++l)d+=this.lightPosition[l]*h[4*l+3];for(l=0;l<3;++l){for(var m=h[12+l],g=0;g<3;++g)m+=h[4*g+l]*this.lightPosition[g];c.lightPosition[l]=m/d}this.triangleCount>0&&((p=this.triShader).bind(),p.uniforms=c,this.triangleVAO.bind(),n.drawArrays(n.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((p=this.lineShader).bind(),p.uniforms=c,this.edgeVAO.bind(),n.lineWidth(this.lineWidth*this.pixelRatio),n.drawArrays(n.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((p=this.pointShader).bind(),p.uniforms=c,this.pointVAO.bind(),n.drawArrays(n.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((p=this.contourShader).bind(),p.uniforms=c,this.contourVAO.bind(),n.drawArrays(n.LINES,0,this.contourCount),this.contourVAO.unbind())},M.drawPick=function(r){r=r||{};for(var n=this.gl,i=r.model||k,a=r.view||k,o=r.projection||k,s=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;l<3;++l)s[0][l]=Math.max(s[0][l],this.clipBounds[0][l]),s[1][l]=Math.min(s[1][l],this.clipBounds[1][l]);this._model=[].slice.call(i),this._view=[].slice.call(a),this._projection=[].slice.call(o),this._resolution=[n.drawingBufferWidth,n.drawingBufferHeight];var c,u={model:i,view:a,projection:o,clipBounds:s,pickId:this.pickId/255};(c=this.pickShader).bind(),c.uniforms=u,this.triangleCount>0&&(this.triangleVAO.bind(),n.drawArrays(n.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),n.lineWidth(this.lineWidth*this.pixelRatio),n.drawArrays(n.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((c=this.pointPickShader).bind(),c.uniforms=u,this.pointVAO.bind(),n.drawArrays(n.POINTS,0,this.pointCount),this.pointVAO.unbind())},M.pick=function(r){if(!r||r.id!==this.pickId)return null;for(var n=r.value[0]+256*r.value[1]+65536*r.value[2],i=this.cells[n],a=this.positions,o=Array(i.length),s=0;s<i.length;++s)o[s]=a[i[s]];var l=r.coord[0],c=r.coord[1];if(!this.pickVertex){var u=this.positions[i[0]],f=this.positions[i[1]],h=this.positions[i[2]],p=[(u[0]+f[0]+h[0])/3,(u[1]+f[1]+h[1])/3,(u[2]+f[2]+h[2])/3];return{_cellCenter:!0,position:[l,c],index:n,cell:i,cellId:n,intensity:this.intensity[n],dataCoordinate:p}}var d=v(o,[l*this.pixelRatio,this._resolution[1]-c*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!d)return null;var m=d[2],g=0;for(s=0;s<i.length;++s)g+=m[s]*this.intensity[i[s]];return{position:d[1],index:i[d[0]],cell:i,cellId:n,intensity:g,dataCoordinate:this.positions[i[d[0]]]}},M.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},n.exports=function(r,n){if(1==arguments.length&&(r=(n=r).gl),!(r.getExtension("OES_standard_derivatives")||r.getExtension("MOZ_OES_standard_derivatives")||r.getExtension("WEBKIT_OES_standard_derivatives")))throw Error("derivatives not supported");var i,c,u,f,p,d,m=((i=a(r,y.vertex,y.fragment)).attributes.position.location=0,i.attributes.color.location=2,i.attributes.uv.location=3,i.attributes.normal.location=4,i),g=((c=a(r,x.vertex,x.fragment)).attributes.position.location=0,c.attributes.color.location=2,c.attributes.uv.location=3,c),v=((u=a(r,b.vertex,b.fragment)).attributes.position.location=0,u.attributes.color.location=2,u.attributes.uv.location=3,u.attributes.pointSize.location=4,u),k=((f=a(r,_.vertex,_.fragment)).attributes.position.location=0,f.attributes.id.location=1,f),M=((p=a(r,w.vertex,w.fragment)).attributes.position.location=0,p.attributes.id.location=1,p.attributes.pointSize.location=4,p),S=((d=a(r,T.vertex,T.fragment)).attributes.position.location=0,d),E=l(r,h(new Uint8Array([255,255,255,255]),[1,1,4]));E.generateMipmap(),E.minFilter=r.LINEAR_MIPMAP_LINEAR,E.magFilter=r.LINEAR;var L=o(r),C=o(r),P=o(r),I=o(r),O=o(r),z=s(r,[{buffer:L,type:r.FLOAT,size:3},{buffer:O,type:r.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:C,type:r.FLOAT,size:4},{buffer:P,type:r.FLOAT,size:2},{buffer:I,type:r.FLOAT,size:3}]),D=o(r),R=o(r),F=o(r),B=o(r),N=s(r,[{buffer:D,type:r.FLOAT,size:3},{buffer:B,type:r.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:R,type:r.FLOAT,size:4},{buffer:F,type:r.FLOAT,size:2}]),j=o(r),U=o(r),V=o(r),H=o(r),q=o(r),G=s(r,[{buffer:j,type:r.FLOAT,size:3},{buffer:q,type:r.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:U,type:r.FLOAT,size:4},{buffer:V,type:r.FLOAT,size:2},{buffer:H,type:r.FLOAT,size:1}]),Y=o(r),W=s(r,[{buffer:Y,type:r.FLOAT,size:3}]),X=new A(r,E,m,g,v,k,M,S,L,O,C,P,I,z,D,B,R,F,N,j,q,U,V,H,G,Y,W);return X.update(n),X}},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(r,n,i){"use strict";n.exports=function(r){var n=r.gl;return new l(r,a(n,[0,0,0,1,1,0,1,1]),o(n,s.boxVert,s.lineFrag))};var a=r("gl-buffer"),o=r("gl-shader"),s=r("./shaders");function l(r,n,i){this.plot=r,this.vbo=n,this.shader=i}var c,u,f=l.prototype;f.bind=function(){var r=this.shader;this.vbo.bind(),this.shader.bind(),r.attributes.coord.pointer(),r.uniforms.screenBox=this.plot.screenBox},f.drawBox=(c=[0,0],u=[0,0],function(r,n,i,a,o){var s=this.plot,l=this.shader,f=s.gl;c[0]=r,c[1]=n,u[0]=i,u[1]=a,l.uniforms.lo=c,l.uniforms.hi=u,l.uniforms.color=o,f.drawArrays(f.TRIANGLE_STRIP,0,4)}),f.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(r,n,i){"use strict";n.exports=function(r){var n=r.gl;return new m(r,f(n),h(n,d.gridVert,d.gridFrag),h(n,d.tickVert,d.gridFrag))};var a,o,s,l,c,u,f=r("gl-buffer"),h=r("gl-shader"),p=r("binary-search-bounds"),d=r("./shaders");function m(r,n,i,a){this.plot=r,this.vbo=n,this.shader=i,this.tickShader=a,this.ticks=[[],[]]}function g(r,n){return r-n}var v,y,x,b,_,w=m.prototype;w.draw=(v=[0,0],y=[0,0],x=[0,0],function(){for(var r=this.plot,n=this.vbo,i=this.shader,a=this.ticks,o=r.gl,s=r._tickBounds,l=r.dataBox,c=r.viewBox,u=r.gridLineWidth,f=r.gridLineColor,h=r.gridLineEnable,p=r.pixelRatio,d=0;d<2;++d){var m=s[d],g=s[d+2]-m,b=.5*(l[d+2]+l[d]),_=l[d+2]-l[d];y[d]=2*g/_,v[d]=2*(m-b)/_}i.bind(),n.bind(),i.attributes.dataCoord.pointer(),i.uniforms.dataShift=v,i.uniforms.dataScale=y;var w=0;for(d=0;d<2;++d){x[0]=x[1]=0,x[d]=1,i.uniforms.dataAxis=x,i.uniforms.lineWidth=u[d]/(c[d+2]-c[d])*p,i.uniforms.color=f[d];var T=6*a[d].length;h[d]&&T&&o.drawArrays(o.TRIANGLES,w,T),w+=T}}),w.drawTickMarks=(a=[0,0],o=[0,0],s=[1,0],l=[0,1],c=[0,0],u=[0,0],function(){for(var r=this.plot,n=this.vbo,i=this.tickShader,f=this.ticks,h=r.gl,d=r._tickBounds,m=r.dataBox,v=r.viewBox,y=r.pixelRatio,x=r.screenBox,b=x[2]-x[0],_=x[3]-x[1],w=v[2]-v[0],T=v[3]-v[1],k=0;k<2;++k){var A=d[k],M=d[k+2]-A,S=.5*(m[k+2]+m[k]),E=m[k+2]-m[k];o[k]=2*M/E,a[k]=2*(A-S)/E}o[0]*=w/b,a[0]*=w/b,o[1]*=T/_,a[1]*=T/_,i.bind(),n.bind(),i.attributes.dataCoord.pointer();var L=i.uniforms;L.dataShift=a,L.dataScale=o;var C=r.tickMarkLength,P=r.tickMarkWidth,I=r.tickMarkColor,O=6*f[0].length,z=Math.min(p.ge(f[0],(m[0]-d[0])/(d[2]-d[0]),g),f[0].length),D=Math.min(p.gt(f[0],(m[2]-d[0])/(d[2]-d[0]),g),f[0].length),R=0+6*z,F=6*Math.max(0,D-z),B=Math.min(p.ge(f[1],(m[1]-d[1])/(d[3]-d[1]),g),f[1].length),N=Math.min(p.gt(f[1],(m[3]-d[1])/(d[3]-d[1]),g),f[1].length),j=O+6*B,U=6*Math.max(0,N-B);c[0]=2*(v[0]-C[1])/b-1,c[1]=(v[3]+v[1])/_-1,u[0]=C[1]*y/b,u[1]=P[1]*y/_,U&&(L.color=I[1],L.tickScale=u,L.dataAxis=l,L.screenOffset=c,h.drawArrays(h.TRIANGLES,j,U)),c[0]=(v[2]+v[0])/b-1,c[1]=2*(v[1]-C[0])/_-1,u[0]=P[0]*y/b,u[1]=C[0]*y/_,F&&(L.color=I[0],L.tickScale=u,L.dataAxis=s,L.screenOffset=c,h.drawArrays(h.TRIANGLES,R,F)),c[0]=2*(v[2]+C[3])/b-1,c[1]=(v[3]+v[1])/_-1,u[0]=C[3]*y/b,u[1]=P[3]*y/_,U&&(L.color=I[3],L.tickScale=u,L.dataAxis=l,L.screenOffset=c,h.drawArrays(h.TRIANGLES,j,U)),c[0]=(v[2]+v[0])/b-1,c[1]=2*(v[3]+C[2])/_-1,u[0]=P[2]*y/b,u[1]=C[2]*y/_,F&&(L.color=I[2],L.tickScale=u,L.dataAxis=s,L.screenOffset=c,h.drawArrays(h.TRIANGLES,R,F))}),w.update=(b=[1,1,-1,-1,1,-1],_=[1,-1,1,1,-1,-1],function(r){for(var n=r.ticks,i=r.bounds,a=new Float32Array(18*(n[0].length+n[1].length)),o=(this.plot.zeroLineEnable,0),s=[[],[]],l=0;l<2;++l)for(var c=s[l],u=n[l],f=i[l],h=i[l+2],p=0;p<u.length;++p){var d=(u[p].x-f)/(h-f);c.push(d);for(var m=0;m<6;++m)a[o++]=d,a[o++]=b[m],a[o++]=_[m]}this.ticks=s,this.vbo.update(a)}),w.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(r,n,i){"use strict";n.exports=function(r){var n=r.gl;return new l(r,a(n,[-1,-1,-1,1,1,-1,1,1]),o(n,s.lineVert,s.lineFrag))};var a=r("gl-buffer"),o=r("gl-shader"),s=r("./shaders");function l(r,n,i){this.plot=r,this.vbo=n,this.shader=i}var c,u,f=l.prototype;f.bind=function(){var r=this.shader;this.vbo.bind(),this.shader.bind(),r.attributes.coord.pointer(),r.uniforms.screenBox=this.plot.screenBox},f.drawLine=(c=[0,0],u=[0,0],function(r,n,i,a,o,s){var l=this.plot,f=this.shader,h=l.gl;c[0]=r,c[1]=n,u[0]=i,u[1]=a,f.uniforms.start=c,f.uniforms.end=u,f.uniforms.width=o*l.pixelRatio,f.uniforms.color=s,h.drawArrays(h.TRIANGLE_STRIP,0,4)}),f.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(r,n,i){"use strict";var a=r("glslify"),o=a(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);n.exports={lineVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:o,textVert:a(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:o,gridVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:o,boxVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:231}],117:[function(r,n,i){"use strict";n.exports=function(r){var n=r.gl;return new h(r,s(n),l(n,f.textVert,f.textFrag))};var a,o,s=r("gl-buffer"),l=r("gl-shader"),c=r("text-cache"),u=r("binary-search-bounds"),f=r("./shaders");function h(r,n,i){this.plot=r,this.vbo=n,this.shader=i,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var p,d,m,g,v,y,x=h.prototype;x.drawTicks=(p=[0,0],d=[0,0],m=[0,0],function(r){var n=this.plot,i=this.shader,a=this.tickX[r],o=this.tickOffset[r],s=n.gl,l=n.viewBox,c=n.dataBox,f=n.screenBox,h=n.pixelRatio,g=n.tickEnable,v=n.tickPad,y=n.tickColor,x=n.tickAngle,b=n.labelEnable,_=n.labelPad,w=n.labelColor,T=n.labelAngle,k=this.labelOffset[r],A=this.labelCount[r],M=u.lt(a,c[r]),S=u.le(a,c[r+2]);p[0]=p[1]=0,p[r]=1,d[r]=(l[2+r]+l[r])/(f[2+r]-f[r])-1;var E=2/f[2+(1^r)]-f[1^r];d[1^r]=E*l[1^r]-1,g[r]&&(d[1^r]-=E*h*v[r],M<S&&o[S]>o[M]&&(i.uniforms.dataAxis=p,i.uniforms.screenOffset=d,i.uniforms.color=y[r],i.uniforms.angle=x[r],s.drawArrays(s.TRIANGLES,o[M],o[S]-o[M]))),b[r]&&A&&(d[1^r]-=E*h*_[r],i.uniforms.dataAxis=m,i.uniforms.screenOffset=d,i.uniforms.color=w[r],i.uniforms.angle=T[r],s.drawArrays(s.TRIANGLES,k,A)),d[1^r]=E*l[2+(1^r)]-1,g[r+2]&&(d[1^r]+=E*h*v[r+2],M<S&&o[S]>o[M]&&(i.uniforms.dataAxis=p,i.uniforms.screenOffset=d,i.uniforms.color=y[r+2],i.uniforms.angle=x[r+2],s.drawArrays(s.TRIANGLES,o[M],o[S]-o[M]))),b[r+2]&&A&&(d[1^r]+=E*h*_[r+2],i.uniforms.dataAxis=m,i.uniforms.screenOffset=d,i.uniforms.color=w[r+2],i.uniforms.angle=T[r+2],s.drawArrays(s.TRIANGLES,k,A))}),x.drawTitle=(a=[0,0],o=[0,0],function(){var r=this.plot,n=this.shader,i=r.gl,s=r.screenBox,l=r.titleCenter,c=r.titleAngle,u=r.titleColor,f=r.pixelRatio;if(this.titleCount){for(var h=0;h<2;++h)o[h]=2*(l[h]*f-s[h])/(s[2+h]-s[h])-1;n.bind(),n.uniforms.dataAxis=a,n.uniforms.screenOffset=o,n.uniforms.angle=c,n.uniforms.color=u,i.drawArrays(i.TRIANGLES,this.titleOffset,this.titleCount)}}),x.bind=(g=[0,0],v=[0,0],y=[0,0],function(){var r=this.plot,n=this.shader,i=r._tickBounds,a=r.dataBox,o=r.screenBox,s=r.viewBox;n.bind();for(var l=0;l<2;++l){var c=i[l],u=i[l+2]-c,f=.5*(a[l+2]+a[l]),h=a[l+2]-a[l],p=s[l],d=s[l+2]-p,m=o[l],x=o[l+2]-m;v[l]=2*u/h*d/x,g[l]=2*(c-f)/h*d/x}y[1]=2*r.pixelRatio/(o[3]-o[1]),y[0]=y[1]*(o[3]-o[1])/(o[2]-o[0]),n.uniforms.dataScale=v,n.uniforms.dataShift=g,n.uniforms.textScale=y,this.vbo.bind(),n.attributes.textCoordinate.pointer()}),x.update=function(r){var n,i,a,o,s,l=[],u=r.ticks,f=r.bounds;for(s=0;s<2;++s){var h=[Math.floor(l.length/3)],p=[-1/0],d=u[s];for(n=0;n<d.length;++n){var m=d[n],g=m.x,v=m.text,y=m.font||"sans-serif";o=m.fontSize||12;for(var x=1/(f[s+2]-f[s]),b=f[s],_=v.split("\n"),w=0;w<_.length;w++)for(a=c(y,_[w]).data,i=0;i<a.length;i+=2)l.push(a[i]*o,-a[i+1]*o-w*o*1.2,(g-b)*x);h.push(Math.floor(l.length/3)),p.push(g)}this.tickOffset[s]=h,this.tickX[s]=p}for(s=0;s<2;++s){for(this.labelOffset[s]=Math.floor(l.length/3),a=c(r.labelFont[s],r.labels[s],{textAlign:"center"}).data,o=r.labelSize[s],n=0;n<a.length;n+=2)l.push(a[n]*o,-a[n+1]*o,0);this.labelCount[s]=Math.floor(l.length/3)-this.labelOffset[s]}for(this.titleOffset=Math.floor(l.length/3),a=c(r.titleFont,r.title).data,o=r.titleSize,n=0;n<a.length;n+=2)l.push(a[n]*o,-a[n+1]*o,0);this.titleCount=Math.floor(l.length/3)-this.titleOffset,this.vbo.update(l)},x.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(r,n,i){"use strict";n.exports=function(r){var n=r.gl,i=a(n,[n.drawingBufferWidth,n.drawingBufferHeight]),f=new u(n,i);return f.grid=o(f),f.text=s(f),f.line=l(f),f.box=c(f),f.update(r),f};var a=r("gl-select-static"),o=r("./lib/grid"),s=r("./lib/text"),l=r("./lib/line"),c=r("./lib/box");function u(r,n){this.gl=r,this.pickBuffer=n,this.screenBox=[0,0,r.drawingBufferWidth,r.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var f=u.prototype;function h(r){for(var n=r.slice(),i=0;i<n.length;++i)n[i]=n[i].slice();return n}function p(r,n){return r.x-n.x}f.setDirty=function(){this.dirty=this.pickDirty=!0},f.setOverlayDirty=function(){this.dirty=!0},f.nextDepthValue=function(){return this._depthCounter++/65536},f.draw=function(){var r=this.gl,n=this.screenBox,i=this.viewBox,a=this.dataBox,o=this.pixelRatio,s=this.grid,l=this.line,c=this.text,u=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,r.bindFramebuffer(r.FRAMEBUFFER,null),r.enable(r.SCISSOR_TEST),r.disable(r.DEPTH_TEST),r.depthFunc(r.LESS),r.depthMask(!1),r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD,r.FUNC_ADD),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),this.borderColor){r.scissor(n[0],n[1],n[2]-n[0],n[3]-n[1]);var f=this.borderColor;r.clearColor(f[0]*f[3],f[1]*f[3],f[2]*f[3],f[3]),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)}r.scissor(i[0],i[1],i[2]-i[0],i[3]-i[1]),r.viewport(i[0],i[1],i[2]-i[0],i[3]-i[1]);var h=this.backgroundColor;r.clearColor(h[0]*h[3],h[1]*h[3],h[2]*h[3],h[3]),r.clear(r.COLOR_BUFFER_BIT),s.draw();var p=this.zeroLineEnable,d=this.zeroLineColor,m=this.zeroLineWidth;if(p[0]||p[1]){l.bind();for(var g=0;g<2;++g)if(p[g]&&a[g]<=0&&a[g+2]>=0){var v=n[g]-a[g]*(n[g+2]-n[g])/(a[g+2]-a[g]);0===g?l.drawLine(v,n[1],v,n[3],m[g],d[g]):l.drawLine(n[0],v,n[2],v,m[g],d[g])}}for(g=0;g<u.length;++g)u[g].draw();r.viewport(n[0],n[1],n[2]-n[0],n[3]-n[1]),r.scissor(n[0],n[1],n[2]-n[0],n[3]-n[1]),this.grid.drawTickMarks(),l.bind();var y=this.borderLineEnable,x=this.borderLineWidth,b=this.borderLineColor;for(y[1]&&l.drawLine(i[0],i[1]-.5*x[1]*o,i[0],i[3]+.5*x[3]*o,x[1],b[1]),y[0]&&l.drawLine(i[0]-.5*x[0]*o,i[1],i[2]+.5*x[2]*o,i[1],x[0],b[0]),y[3]&&l.drawLine(i[2],i[1]-.5*x[1]*o,i[2],i[3]+.5*x[3]*o,x[3],b[3]),y[2]&&l.drawLine(i[0]-.5*x[0]*o,i[3],i[2]+.5*x[2]*o,i[3],x[2],b[2]),c.bind(),g=0;g<2;++g)c.drawTicks(g);this.titleEnable&&c.drawTitle();var _=this.overlays;for(g=0;g<_.length;++g)_[g].draw();r.disable(r.SCISSOR_TEST),r.disable(r.BLEND),r.depthMask(!0)}},f.drawPick=function(){if(!this.static){var r=this.pickBuffer;this.gl,this._pickTimeout=null,r.begin();for(var n=1,i=this.objects,a=0;a<i.length;++a)n=i[a].drawPick(n);r.end()}},f.pick=function(r,n){if(!this.static){var i=this.pixelRatio,a=this.pickPixelRatio,o=this.viewBox,s=0|Math.round((r-o[0]/i)*a),l=0|Math.round((n-o[1]/i)*a),c=this.pickBuffer.query(s,l,this.pickRadius);if(!c)return null;for(var u=c.id+(c.value[0]<<8)+(c.value[1]<<16)+(c.value[2]<<24),f=this.objects,h=0;h<f.length;++h){var p=f[h].pick(s,l,u);if(p)return p}return null}},f.setScreenBox=function(r){var n=this.screenBox,i=this.pixelRatio;n[0]=0|Math.round(r[0]*i),n[1]=0|Math.round(r[1]*i),n[2]=0|Math.round(r[2]*i),n[3]=0|Math.round(r[3]*i),this.setDirty()},f.setDataBox=function(r){var n=this.dataBox;(n[0]!==r[0]||n[1]!==r[1]||n[2]!==r[2]||n[3]!==r[3])&&(n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],this.setDirty())},f.setViewBox=function(r){var n=this.pixelRatio,i=this.viewBox;i[0]=0|Math.round(r[0]*n),i[1]=0|Math.round(r[1]*n),i[2]=0|Math.round(r[2]*n),i[3]=0|Math.round(r[3]*n);var a=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((r[2]-r[0])*a),0|Math.round((r[3]-r[1])*a)],this.setDirty()},f.update=function(r){r=r||{};var n=this.gl;this.pixelRatio=r.pixelRatio||1;var i=this.pixelRatio;this.pickPixelRatio=Math.max(i,1),this.setScreenBox(r.screenBox||[0,0,n.drawingBufferWidth/i,n.drawingBufferHeight/i]),this.screenBox,this.setViewBox(r.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/i,.125*(this.screenBox[3]-this.screenBox[1])/i,.875*(this.screenBox[2]-this.screenBox[0])/i,.875*(this.screenBox[3]-this.screenBox[1])/i]);var a=this.viewBox,o=(a[2]-a[0])/(a[3]-a[1]);this.setDataBox(r.dataBox||[-10,-10/o,10,10/o]),this.borderColor=!1!==r.borderColor&&(r.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(r.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(r.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(r.gridLineWidth||[1,1]).slice(),this.gridLineColor=h(r.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(r.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(r.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=h(r.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(r.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(r.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=h(r.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(r.titleCenter||[.5*(a[0]+a[2])/i,(a[3]+120)/i]).slice(),this.titleEnable=!("titleEnable"in r)||!!r.titleEnable,this.titleAngle=r.titleAngle||0,this.titleColor=(r.titleColor||[0,0,0,1]).slice(),this.labelPad=(r.labelPad||[15,15,15,15]).slice(),this.labelAngle=(r.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(r.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=h(r.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(r.tickPad||[15,15,15,15]).slice(),this.tickAngle=(r.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(r.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=h(r.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(r.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(r.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=h(r.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var s=r.ticks||[[],[]],l=this._tickBounds;l[0]=l[1]=1/0,l[2]=l[3]=-1/0;for(var c=0;c<2;++c){var u=s[c].slice(0);0!==u.length&&(u.sort(p),l[c]=Math.min(l[c],u[0].x),l[c+2]=Math.max(l[c+2],u[u.length-1].x))}this.grid.update({bounds:l,ticks:s}),this.text.update({bounds:l,ticks:s,labels:r.labels||["x","y"],labelSize:r.labelSize||[12,12],labelFont:r.labelFont||["sans-serif","sans-serif"],title:r.title||"",titleSize:r.titleSize||18,titleFont:r.titleFont||"sans-serif"}),this.static=!!r.static,this.setDirty()},f.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var r=this.objects.length-1;r>=0;--r)this.objects[r].dispose();for(this.objects.length=0,r=this.overlays.length-1;r>=0;--r)this.overlays[r].dispose();this.overlays.length=0,this.gl=null},f.addObject=function(r){0>this.objects.indexOf(r)&&(this.objects.push(r),this.setDirty())},f.removeObject=function(r){for(var n=this.objects,i=0;i<n.length;++i)if(n[i]===r){n.splice(i,1),this.setDirty();break}},f.addOverlay=function(r){0>this.overlays.indexOf(r)&&(this.overlays.push(r),this.setOverlayDirty())},f.removeOverlay=function(r){for(var n=this.overlays,i=0;i<n.length;++i)if(n[i]===r){n.splice(i,1),this.setOverlayDirty();break}}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(r,n,i){"use strict";n.exports=function(r,n){r=r||document.body;var i=[.01,1/0];"distanceLimits"in(n=n||{})&&(i[0]=n.distanceLimits[0],i[1]=n.distanceLimits[1]),"zoomMin"in n&&(i[0]=n.zoomMin),"zoomMax"in n&&(i[1]=n.zoomMax);var f=o({center:n.center||[0,0,0],up:n.up||[0,1,0],eye:n.eye||[0,0,10],mode:n.mode||"orbit",distanceLimits:i}),h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0,d=r.clientWidth,m=r.clientHeight,g={keyBindingMode:"rotate",enableWheel:!0,view:f,element:r,delay:n.delay||16,rotateSpeed:n.rotateSpeed||1,zoomSpeed:n.zoomSpeed||1,translateSpeed:n.translateSpeed||1,flipX:!!n.flipX,flipY:!!n.flipY,modes:f.modes,_ortho:n._ortho||n.projection&&"orthographic"===n.projection.type||!1,tick:function(){var n=a(),i=this.delay;f.idle(n-i),f.recalcMatrix(n-2*i),f.flush(n-(100+2*i));for(var o=!0,s=f.computedMatrix,l=0;l<16;++l)o=o&&h[l]===s[l],h[l]=s[l];var c=r.clientWidth===d&&r.clientHeight===m;return d=r.clientWidth,m=r.clientHeight,o?!c:(p=Math.exp(f.computedRadius[0]),!0)},lookAt:function(r,n,i){f.lookAt(f.lastT(),r,n,i)},rotate:function(r,n,i){f.rotate(f.lastT(),r,n,i)},pan:function(r,n,i){f.pan(f.lastT(),r,n,i)},translate:function(r,n,i){f.translate(f.lastT(),r,n,i)}};return Object.defineProperties(g,{matrix:{get:function(){return f.computedMatrix},set:function(r){return f.setMatrix(f.lastT(),r),f.computedMatrix},enumerable:!0},mode:{get:function(){return f.getMode()},set:function(r){var n=f.computedUp.slice(),i=f.computedEye.slice(),o=f.computedCenter.slice();if(f.setMode(r),"turntable"===r){var s=a();f._active.lookAt(s,i,o,n),f._active.lookAt(s+500,i,o,[0,0,1]),f._active.flush(s)}return f.getMode()},enumerable:!0},center:{get:function(){return f.computedCenter},set:function(r){return f.lookAt(f.lastT(),null,r),f.computedCenter},enumerable:!0},eye:{get:function(){return f.computedEye},set:function(r){return f.lookAt(f.lastT(),r),f.computedEye},enumerable:!0},up:{get:function(){return f.computedUp},set:function(r){return f.lookAt(f.lastT(),null,null,r),f.computedUp},enumerable:!0},distance:{get:function(){return p},set:function(r){return f.setDistance(f.lastT(),r),r},enumerable:!0},distanceLimits:{get:function(){return f.getDistanceLimits(i)},set:function(r){return f.setDistanceLimits(r),r},enumerable:!0}}),r.addEventListener("contextmenu",function(r){return r.preventDefault(),!1}),g._lastX=-1,g._lastY=-1,g._lastMods={shift:!1,control:!1,alt:!1,meta:!1},g.enableMouseListeners=function(){function n(n,i,o,s){var l=g.keyBindingMode;if(!1!==l){var c=!!s.control,u=!!s.alt,h=!!s.shift,d=!!(1&n),m=1/r.clientHeight,v=m*(i-g._lastX),y=m*(o-g._lastY),x=g.flipX?1:-1,b=g.flipY?1:-1,_=Math.PI*g.rotateSpeed,w=a();if(-1!==g._lastX&&-1!==g._lastY&&(("rotate"!==l||!d||c||u||h)&&(!d||c||u||!h)||f.rotate(w,x*_*v,-b*_*y,0),("pan"!==l||!d||c||u||h)&&!(2&n)&&(!d||!c||u||h)||f.pan(w,-g.translateSpeed*v*p,g.translateSpeed*y*p,0),"zoom"===l&&d&&!c&&!u&&!h||4&n||d&&!c&&u&&!h)){var T=-g.zoomSpeed*y/window.innerHeight*(w-f.lastT())*100;f.pan(w,0,0,p*(Math.exp(T)-1))}return g._lastX=i,g._lastY=o,g._lastMods=s,!0}}g.mouseListener=s(r,n),r.addEventListener("touchstart",function(i){var a=c(i.changedTouches[0],r);n(0,a[0],a[1],g._lastMods),n(1,a[0],a[1],g._lastMods)},!!u&&{passive:!0}),r.addEventListener("touchmove",function(i){var a=c(i.changedTouches[0],r);n(1,a[0],a[1],g._lastMods),i.preventDefault()},!!u&&{passive:!1}),r.addEventListener("touchend",function(r){n(0,g._lastX,g._lastY,g._lastMods)},!!u&&{passive:!0}),g.wheelListener=l(r,function(r,n){if(!1!==g.keyBindingMode&&g.enableWheel){var i=g.flipX?1:-1,o=g.flipY?1:-1,s=a();if(Math.abs(r)>Math.abs(n))f.rotate(s,0,0,-r*i*Math.PI*g.rotateSpeed/window.innerWidth);else if(!g._ortho){var l=-g.zoomSpeed*o*n/window.innerHeight*(s-f.lastT())/20;f.pan(s,0,0,p*(Math.exp(l)-1))}}},!0)},g.enableMouseListeners(),g};var a=r("right-now"),o=r("3d-view"),s=r("mouse-change"),l=r("mouse-wheel"),c=r("mouse-event-offset"),u=r("has-passive-events")},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(r,n,i){var a=r("glslify"),o=r("gl-shader"),s=a(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),l=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);n.exports=function(r){return o(r,s,l,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(r,n,i){"use strict";var a=r("./camera.js"),o=r("gl-axes3d"),s=r("gl-axes3d/properties"),l=r("gl-spikes3d"),c=r("gl-select-static"),u=r("gl-fbo"),f=r("a-big-triangle"),h=r("mouse-change"),p=r("gl-mat4/perspective"),d=r("gl-mat4/ortho"),m=r("./lib/shader"),g=r("is-mobile")({tablet:!0,featureDetect:!0});function v(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function y(r){return"boolean"!=typeof r||r}n.exports={createScene:function(r){(r=r||{}).camera=r.camera||{};var n=r.canvas;n||((n=document.createElement("canvas"),r.container)?r.container.appendChild(n):document.body.appendChild(n));var i=r.gl;if(i||(r.glOptions&&(g=!!r.glOptions.preserveDrawingBuffer),i=function(r,n){var i=null;try{(i=r.getContext("webgl",n))||(i=r.getContext("experimental-webgl",n))}catch(r){return null}return i}(n,r.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:g})),!i)throw Error("webgl not supported");var x=r.bounds||[[-10,-10,-10],[10,10,10]],b=new v,_=u(i,i.drawingBufferWidth,i.drawingBufferHeight,{preferFloat:!g}),w=m(i),T=r.cameraObject&&!0===r.cameraObject._ortho||r.camera.projection&&"orthographic"===r.camera.projection.type||!1,k={eye:r.camera.eye||[2,0,0],center:r.camera.center||[0,0,0],up:r.camera.up||[0,1,0],zoomMin:r.camera.zoomMax||.1,zoomMax:r.camera.zoomMin||100,mode:r.camera.mode||"turntable",_ortho:T},A=r.axes||{},M=o(i,A);M.enable=!A.disable;var S=r.spikes||{},E=l(i,S),L=[],C=[],P=[],I=[],O=!0,z=!0,D={view:null,projection:Array(16),model:Array(16),_ortho:!1},R=(z=!0,[i.drawingBufferWidth,i.drawingBufferHeight]),F=r.cameraObject||a(n,k),B={gl:i,contextLost:!1,pixelRatio:r.pixelRatio||1,canvas:n,selection:b,camera:F,axes:M,axesPixels:null,spikes:E,bounds:x,objects:L,shape:R,aspect:r.aspectRatio||[1,1,1],pickRadius:r.pickRadius||10,zNear:r.zNear||.01,zFar:r.zFar||1e3,fovy:r.fovy||Math.PI/4,clearColor:r.clearColor||[0,0,0,0],autoResize:y(r.autoResize),autoBounds:y(r.autoBounds),autoScale:!!r.autoScale,autoCenter:y(r.autoCenter),clipToBounds:y(r.clipToBounds),snapToData:!!r.snapToData,onselect:r.onselect||null,onrender:r.onrender||null,onclick:r.onclick||null,cameraParams:D,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(r){this.aspect[0]=r.x,this.aspect[1]=r.y,this.aspect[2]=r.z,z=!0},setBounds:function(r,n){this.bounds[0][r]=n.min,this.bounds[1][r]=n.max},setClearColor:function(r){this.clearColor=r},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},N=[i.drawingBufferWidth/B.pixelRatio|0,i.drawingBufferHeight/B.pixelRatio|0];function j(){if(!B._stopped&&B.autoResize){var r=n.parentNode,i=1,a=1;r&&r!==document.body?(i=r.clientWidth,a=r.clientHeight):(i=window.innerWidth,a=window.innerHeight);var o=0|Math.ceil(i*B.pixelRatio),s=0|Math.ceil(a*B.pixelRatio);if(o!==n.width||s!==n.height){n.width=o,n.height=s;var l=n.style;l.position=l.position||"absolute",l.left="0px",l.top="0px",l.width=i+"px",l.height=a+"px",O=!0}}}function U(){for(var r=L.length,n=I.length,a=0;a<n;++a)P[a]=0;t:for(a=0;a<r;++a){var o=L[a],s=o.pickSlots;if(s){for(var l=0;l<n;++l)if(P[l]+s<255){C[a]=l,o.setPickBase(P[l]+1),P[l]+=s;continue t}var u=c(i,R);C[a]=n,I.push(u),P.push(s),o.setPickBase(1),n+=1}else C[a]=-1}for(;n>0&&0===P[n-1];)P.pop(),I.pop().dispose()}function V(){if(B.contextLost)return!0;i.isContextLost()&&(B.contextLost=!0,B.mouseListener.enabled=!1,B.selection.object=null,B.oncontextloss&&B.oncontextloss())}B.autoResize&&j(),window.addEventListener("resize",j),B.update=function(r){B._stopped||(r=r||{},O=!0,z=!0)},B.add=function(r){B._stopped||(r.axes=M,L.push(r),C.push(-1),O=!0,z=!0,U())},B.remove=function(r){if(!B._stopped){var n=L.indexOf(r);n<0||(L.splice(n,1),C.pop(),O=!0,z=!0,U())}},B.dispose=function(){if(!B._stopped&&(B._stopped=!0,window.removeEventListener("resize",j),n.removeEventListener("webglcontextlost",V),B.mouseListener.enabled=!1,!B.contextLost)){M.dispose(),E.dispose();for(var r=0;r<L.length;++r)L[r].dispose();for(_.dispose(),r=0;r<I.length;++r)I[r].dispose();w.dispose(),i=null,M=null,E=null,L=[]}},B._mouseRotating=!1,B._prevButtons=0,B.enableMouseListeners=function(){B.mouseListener=h(n,function(r,n,i){if(!B._stopped){var a=I.length,o=L.length,s=b.object;b.distance=1/0,b.mouse[0]=n,b.mouse[1]=i,b.object=null,b.screen=null,b.dataCoordinate=b.dataPosition=null;var l=!1;if(r&&B._prevButtons)B._mouseRotating=!0;else{B._mouseRotating&&(z=!0),B._mouseRotating=!1;for(var c=0;c<a;++c){var u=I[c].query(n,N[1]-i-1,B.pickRadius);if(u){if(u.distance>b.distance)continue;for(var f=0;f<o;++f){var h=L[f];if(C[f]===c){var p=h.pick(u);p&&(b.buttons=r,b.screen=u.coord,b.distance=u.distance,b.object=h,b.index=p.distance,b.dataPosition=p.position,b.dataCoordinate=p.dataCoordinate,b.data=p,l=!0)}}}}}s&&s!==b.object&&(s.highlight&&s.highlight(null),O=!0),b.object&&(b.object.highlight&&b.object.highlight(b.data),O=!0),(l=l||b.object!==s)&&B.onselect&&B.onselect(b),1&r&&!(1&B._prevButtons)&&B.onclick&&B.onclick(b),B._prevButtons=r}})},n.addEventListener("webglcontextlost",V);var H=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],q=[H[0].slice(),H[1].slice()];function G(){if(!V()){j();var r=B.camera.tick();D.view=B.camera.matrix,O=O||r,z=z||r,M.pixelRatio=B.pixelRatio,E.pixelRatio=B.pixelRatio;var n=L.length,a=H[0],o=H[1];a[0]=a[1]=a[2]=1/0,o[0]=o[1]=o[2]=-1/0;for(var l=0;l<n;++l){(x=L[l]).pixelRatio=B.pixelRatio,x.axes=B.axes,O=O||!!x.dirty,z=z||!!x.dirty;var c=x.bounds;if(c)for(var u=c[0],h=c[1],m=0;m<3;++m)a[m]=Math.min(a[m],u[m]),o[m]=Math.max(o[m],h[m])}var g=B.bounds;if(B.autoBounds)for(m=0;m<3;++m){if(o[m]<a[m])a[m]=-1,o[m]=1;else{a[m]===o[m]&&(a[m]-=1,o[m]+=1);var v=.05*(o[m]-a[m]);a[m]=a[m]-v,o[m]=o[m]+v}g[0][m]=a[m],g[1][m]=o[m]}var y=!1;for(m=0;m<3;++m)y=y||q[0][m]!==g[0][m]||q[1][m]!==g[1][m],q[0][m]=g[0][m],q[1][m]=g[1][m];if(z=z||y,O=O||y){if(y){var x,k=[0,0,0];for(l=0;l<3;++l)k[l]=function(r){var n=Math.round(Math.log(Math.abs(r))/Math.log(10));if(n<0){var i=Math.round(Math.pow(10,-n));return Math.ceil(r*i)/i}return n>0?Math.ceil(r/(i=Math.round(Math.pow(10,n))))*i:Math.ceil(r)}((g[1][l]-g[0][l])/10);M.autoTicks?M.update({bounds:g,tickSpacing:k}):M.update({bounds:g})}var A=i.drawingBufferWidth,S=i.drawingBufferHeight;for(R[0]=A,R[1]=S,N[0]=0|Math.max(A/B.pixelRatio,1),N[1]=0|Math.max(S/B.pixelRatio,1),function(r,n){var i=r.bounds,a=r.cameraParams,o=a.projection,s=a.model,l=r.gl.drawingBufferWidth,c=r.gl.drawingBufferHeight,u=r.zNear,f=r.zFar,h=r.fovy,m=l/c;n?(d(o,-m,m,-1,1,u,f),a._ortho=!0):(p(o,h,m,u,f),a._ortho=!1);for(var g=0;g<16;++g)s[g]=0;s[15]=1;var v=0;for(g=0;g<3;++g)v=Math.max(v,i[1][g]-i[0][g]);for(g=0;g<3;++g)r.autoScale?s[5*g]=r.aspect[g]/(i[1][g]-i[0][g]):s[5*g]=1/v,r.autoCenter&&(s[12+g]=-(.5*s[5*g])*(i[0][g]+i[1][g]))}(B,T),l=0;l<n;++l)(x=L[l]).axesBounds=g,B.clipToBounds&&(x.clipBounds=g);b.object&&(B.snapToData?E.position=b.dataCoordinate:E.position=b.dataPosition,E.bounds=g),z&&(z=!1,function(){if(!V()){i.colorMask(!0,!0,!0,!0),i.depthMask(!0),i.disable(i.BLEND),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL);for(var r=L.length,n=I.length,a=0;a<n;++a){var o=I[a];o.shape=N,o.begin();for(var s=0;s<r;++s)if(C[s]===a){var l=L[s];l.drawPick&&(l.pixelRatio=1,l.drawPick(D))}o.end()}}}()),B.axesPixels=s(B.axes,D,A,S),B.onrender&&B.onrender(),i.bindFramebuffer(i.FRAMEBUFFER,null),i.viewport(0,0,A,S),B.clearRGBA(),i.depthMask(!0),i.colorMask(!0,!0,!0,!0),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.disable(i.BLEND),i.disable(i.CULL_FACE);var P=!1;for(M.enable&&(P=P||M.isTransparent(),M.draw(D)),E.axes=M,b.object&&E.draw(D),i.disable(i.CULL_FACE),l=0;l<n;++l)(x=L[l]).axes=M,x.pixelRatio=B.pixelRatio,x.isOpaque&&x.isOpaque()&&x.draw(D),x.isTransparent&&x.isTransparent()&&(P=!0);if(P){for(_.shape=R,_.bind(),i.clear(i.DEPTH_BUFFER_BIT),i.colorMask(!1,!1,!1,!1),i.depthMask(!0),i.depthFunc(i.LESS),M.enable&&M.isTransparent()&&M.drawTransparent(D),l=0;l<n;++l)(x=L[l]).isOpaque&&x.isOpaque()&&x.draw(D);for(i.enable(i.BLEND),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.colorMask(!0,!0,!0,!0),i.depthMask(!1),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),M.isTransparent()&&M.drawTransparent(D),l=0;l<n;++l)(x=L[l]).isTransparent&&x.isTransparent()&&x.drawTransparent(D);i.bindFramebuffer(i.FRAMEBUFFER,null),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.disable(i.DEPTH_TEST),w.bind(),_.color[0].bind(0),w.uniforms.accumBuffer=0,f(i),i.disable(i.BLEND)}for(l=0,O=!1;l<n;++l)L[l].dirty=!1}}}return B.enableMouseListeners(),function r(){B._stopped||B.contextLost||(G(),requestAnimationFrame(r))}(),B.redraw=function(){B._stopped||(O=!0,G())},B},createCamera:a}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(r,n,i){var a=r("glslify");i.pointVertex=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),i.pointFragment=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),i.pickVertex=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),i.pickFragment=a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:231}],123:[function(r,n,i){"use strict";var a=r("gl-shader"),o=r("gl-buffer"),s=r("typedarray-pool"),l=r("./lib/shader");function c(r,n,i,a,o){this.plot=r,this.offsetBuffer=n,this.pickBuffer=i,this.shader=a,this.pickShader=o,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}n.exports=function(r,n){var i=r.gl,s=new c(r,o(i),o(i),a(i,l.pointVertex,l.pointFragment),a(i,l.pickVertex,l.pickFragment));return s.update(n),r.addObject(s),s};var u,f,h=c.prototype;h.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},h.update=function(r){function n(n,i){return n in r?r[n]:i}r=r||{},this.sizeMin=n("sizeMin",.5),this.sizeMax=n("sizeMax",20),this.color=n("color",[1,0,0,1]).slice(),this.areaRatio=n("areaRatio",1),this.borderColor=n("borderColor",[0,0,0,1]).slice(),this.blend=n("blend",!1);var i,a=r.positions.length>>>1,o=r.positions instanceof Float32Array,l=r.idToIndex instanceof Int32Array&&r.idToIndex.length>=a,c=r.positions,u=o?c:s.mallocFloat32(c.length),f=l?r.idToIndex:s.mallocInt32(a);if(o||u.set(c),!l)for(u.set(c),i=0;i<a;i++)f[i]=i;this.points=c,this.offsetBuffer.update(u),this.pickBuffer.update(f),o||s.free(u),l||s.free(f),this.pointCount=a,this.pickOffset=0},h.unifiedDraw=(u=[1,0,0,0,1,0,0,0,1],f=[0,0,0,0],function(r){var n=void 0!==r,i=n?this.pickShader:this.shader,a=this.plot.gl,o=this.plot.dataBox;if(0===this.pointCount)return r;var s=o[2]-o[0],l=o[3]-o[1],c=function(r,n){var i,a=0,o=r.length>>>1;for(i=0;i<o;i++){var s=r[2*i],l=r[2*i+1];s>=n[0]&&s<=n[2]&&l>=n[1]&&l<=n[3]&&a++}return a}(this.points,o),h=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(c,.33333)));u[0]=2/s,u[4]=2/l,u[6]=-2*o[0]/s-1,u[7]=-2*o[1]/l-1,this.offsetBuffer.bind(),i.bind(),i.attributes.position.pointer(),i.uniforms.matrix=u,i.uniforms.color=this.color,i.uniforms.borderColor=this.borderColor,i.uniforms.pointCloud=h<5,i.uniforms.pointSize=h,i.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),n&&(f[0]=255&r,f[1]=r>>8&255,f[2]=r>>16&255,f[3]=r>>24&255,this.pickBuffer.bind(),i.attributes.pickId.pointer(a.UNSIGNED_BYTE),i.uniforms.pickOffset=f,this.pickOffset=r);var p=a.getParameter(a.BLEND),d=a.getParameter(a.DITHER);return p&&!this.blend&&a.disable(a.BLEND),d&&a.disable(a.DITHER),a.drawArrays(a.POINTS,0,this.pointCount),p&&!this.blend&&a.enable(a.BLEND),d&&a.enable(a.DITHER),r+this.pointCount}),h.draw=h.unifiedDraw,h.drawPick=h.unifiedDraw,h.pick=function(r,n,i){var a=this.pickOffset,o=this.pointCount;if(i<a||i>=a+o)return null;var s=i-a,l=this.points;return{object:this,pointId:s,dataCoord:[l[2*s],l[2*s+1]]}}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(r,n,i){n.exports=function(r,n,i,a){var o,s,l,c,u,f=n[0],h=n[1],p=n[2],d=n[3],m=i[0],g=i[1],v=i[2],y=i[3];return(s=f*m+h*g+p*v+d*y)<0&&(s=-s,m=-m,g=-g,v=-v,y=-y),1-s>1e-6?(l=Math.sin(o=Math.acos(s)),c=Math.sin((1-a)*o)/l,u=Math.sin(a*o)/l):(c=1-a,u=a),r[0]=c*f+u*m,r[1]=c*h+u*g,r[2]=c*p+u*v,r[3]=c*d+u*y,r}},{}],125:[function(r,n,i){"use strict";n.exports=function(r){return r||0===r?r.toString():""}},{}],126:[function(r,n,i){"use strict";var a=r("vectorize-text");n.exports=function(r,n,i){var s=o[n];if(s||(s=o[n]={}),r in s)return s[r];var l={textAlign:"center",textBaseline:"middle",lineHeight:1,font:n,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},c=a(r,l);l.triangles=!1;var u,f,h=a(r,l);if(i&&1!==i){for(u=0;u<c.positions.length;++u)for(f=0;f<c.positions[u].length;++f)c.positions[u][f]/=i;for(u=0;u<h.positions.length;++u)for(f=0;f<h.positions[u].length;++f)h.positions[u][f]/=i}var p=[[1/0,1/0],[-1/0,-1/0]],d=h.positions.length;for(u=0;u<d;++u){var m=h.positions[u];for(f=0;f<2;++f)p[0][f]=Math.min(p[0][f],m[f]),p[1][f]=Math.max(p[1][f],m[f])}return s[r]=[c,h,p]};var o={}},{"vectorize-text":311}],127:[function(r,n,i){var a=r("gl-shader"),o=r("glslify"),s=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),l=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),c=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),u=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]),f=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),h=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],p={vertex:s,fragment:u,attributes:h},d={vertex:l,fragment:u,attributes:h},m={vertex:c,fragment:u,attributes:h},g={vertex:s,fragment:f,attributes:h},v={vertex:l,fragment:f,attributes:h},y={vertex:c,fragment:f,attributes:h};function x(r,n){var i=a(r,n),o=i.attributes;return o.position.location=0,o.color.location=1,o.glyph.location=2,o.id.location=3,i}i.createPerspective=function(r){return x(r,p)},i.createOrtho=function(r){return x(r,d)},i.createProject=function(r){return x(r,m)},i.createPickPerspective=function(r){return x(r,g)},i.createPickOrtho=function(r){return x(r,v)},i.createPickProject=function(r){return x(r,y)}},{"gl-shader":132,glslify:231}],128:[function(r,n,i){"use strict";var a=r("is-string-blank"),o=r("gl-buffer"),s=r("gl-vao"),l=r("typedarray-pool"),c=r("gl-mat4/multiply"),u=r("./lib/shaders"),f=r("./lib/glyphs"),h=r("./lib/get-simple-string"),p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function d(r,n){var i=r[0],a=r[1],o=r[2],s=r[3];return r[0]=n[0]*i+n[4]*a+n[8]*o+n[12]*s,r[1]=n[1]*i+n[5]*a+n[9]*o+n[13]*s,r[2]=n[2]*i+n[6]*a+n[10]*o+n[14]*s,r[3]=n[3]*i+n[7]*a+n[11]*o+n[15]*s,r}function m(r,n,i,a){return d(a,a),d(a,a),d(a,a)}function g(r,n){this.index=r,this.dataCoordinate=this.position=n}function v(r){return!0===r||r>1?1:r}function y(r,n,i,a,o,s,l,c,u,f,h,p){this.gl=r,this.pixelRatio=1,this.shader=n,this.orthoShader=i,this.projectShader=a,this.pointBuffer=o,this.colorBuffer=s,this.glyphBuffer=l,this.idBuffer=c,this.vao=u,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=f,this.pickOrthoShader=h,this.pickProjectShader=p,this.points=[],this._selectResult=new g(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}n.exports=function(r){var n=r.gl,i=u.createPerspective(n),a=u.createOrtho(n),l=u.createProject(n),c=u.createPickPerspective(n),f=u.createPickOrtho(n),h=u.createPickProject(n),p=o(n),d=o(n),m=o(n),g=o(n),v=s(n,[{buffer:p,size:3,type:n.FLOAT},{buffer:d,size:4,type:n.FLOAT},{buffer:m,size:2,type:n.FLOAT},{buffer:g,size:4,type:n.UNSIGNED_BYTE,normalized:!0}]),x=new y(n,i,a,l,p,d,m,g,v,c,f,h);return x.update(r),x};var x=y.prototype;x.pickSlots=1,x.setPickBase=function(r){this.pickId=r},x.isTransparent=function(){if(this.hasAlpha)return!0;for(var r=0;r<3;++r)if(this.axesProject[r]&&this.projectHasAlpha)return!0;return!1},x.isOpaque=function(){if(!this.hasAlpha)return!0;for(var r=0;r<3;++r)if(this.axesProject[r]&&!this.projectHasAlpha)return!0;return!1};var b=[0,0],_=[0,0,0],w=[0,0,0],T=[0,0,0,1],k=[0,0,0,1],A=p.slice(),M=[0,0,0],S=[[0,0,0],[0,0,0]];function E(r){return r[0]=r[1]=r[2]=0,r}function L(r,n){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=1,r}function C(r,n,i,a){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[i]=a,r}var P=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function I(r,n,i,a,o,s,l){var u=i.gl;if((s===i.projectHasAlpha||l)&&function(r,n,i,a){var o,s=n.axesProject,l=n.gl,u=r.uniforms,f=i.model||p,h=i.view||p,d=i.projection||p,g=n.axesBounds,v=function(r){for(var n=0;n<2;++n)for(var i=0;i<3;++i)S[n][i]=Math.max(Math.min(r[n][i],1e8),-1e8);return S}(n.clipBounds);o=n.axes&&n.axes.lastCubeProps?n.axes.lastCubeProps.axis:[1,1,1],b[0]=2/l.drawingBufferWidth,b[1]=2/l.drawingBufferHeight,r.bind(),u.view=h,u.projection=d,u.screenSize=b,u.highlightId=n.highlightId,u.highlightScale=n.highlightScale,u.clipBounds=v,u.pickGroup=n.pickId/255,u.pixelRatio=a;for(var y=0;y<3;++y)if(s[y]){u.scale=n.projectScale[y],u.opacity=n.projectOpacity[y];for(var x=0;x<16;++x)A[x]=0;for(x=0;x<4;++x)A[5*x]=1;A[5*y]=0,o[y]<0?A[12+y]=g[0][y]:A[12+y]=g[1][y],c(A,f,A),u.model=A;var P=(y+1)%3,I=(y+2)%3,O=E(_),z=E(w);O[P]=1,z[I]=1;var D=m(0,0,0,L(T,O)),R=m(0,0,0,L(k,z));if(Math.abs(D[1])>Math.abs(R[1])){var F=D;D=R,R=F,F=O,O=z,z=F;var B=P;P=I,I=B}D[0]<0&&(O[P]=-1),R[1]>0&&(z[I]=-1);var N=0,j=0;for(x=0;x<4;++x)N+=Math.pow(f[4*P+x],2),j+=Math.pow(f[4*I+x],2);O[P]/=Math.sqrt(N),z[I]/=Math.sqrt(j),u.axes[0]=O,u.axes[1]=z,u.fragClipBounds[0]=C(M,v[0],y,-1e8),u.fragClipBounds[1]=C(M,v[1],y,1e8),n.vao.bind(),n.vao.draw(l.TRIANGLES,n.vertexCount),n.lineWidth>0&&(l.lineWidth(n.lineWidth*a),n.vao.draw(l.LINES,n.lineVertexCount,n.vertexCount)),n.vao.unbind()}}(n,i,a,o),s===i.hasAlpha||l){r.bind();var f=r.uniforms;f.model=a.model||p,f.view=a.view||p,f.projection=a.projection||p,b[0]=2/u.drawingBufferWidth,b[1]=2/u.drawingBufferHeight,f.screenSize=b,f.highlightId=i.highlightId,f.highlightScale=i.highlightScale,f.fragClipBounds=P,f.clipBounds=i.axes.bounds,f.opacity=i.opacity,f.pickGroup=i.pickId/255,f.pixelRatio=o,i.vao.bind(),i.vao.draw(u.TRIANGLES,i.vertexCount),i.lineWidth>0&&(u.lineWidth(i.lineWidth*o),i.vao.draw(u.LINES,i.lineVertexCount,i.vertexCount)),i.vao.unbind()}}function O(r,n,i,o){s=h(s=Array.isArray(r)?n<r.length?r[n]:void 0:r);var s,l=!0;a(s)&&(s="",l=!1);var c=f(s,i,o);return{mesh:c[0],lines:c[1],bounds:c[2],visible:l}}x.draw=function(r){I(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,r,this.pixelRatio,!1,!1)},x.drawTransparent=function(r){I(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,r,this.pixelRatio,!0,!1)},x.drawPick=function(r){I(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,r,1,!0,!0)},x.pick=function(r){if(!r||r.id!==this.pickId)return null;var n=r.value[2]+(r.value[1]<<8)+(r.value[0]<<16);if(n>=this.pointCount||n<0)return null;var i=this.points[n],a=this._selectResult;a.index=n;for(var o=0;o<3;++o)a.position[o]=a.dataCoordinate[o]=i[o];return a},x.highlight=function(r){if(r){var n=r.index;this.highlightId=[(255&n)/255,(n>>8&255)/255,(n>>16&255)/255,0]}else this.highlightId=[1,1,1,1]},x.update=function(r){if("perspective"in(r=r||{})&&(this.useOrtho=!r.perspective),"orthographic"in r&&(this.useOrtho=!!r.orthographic),"lineWidth"in r&&(this.lineWidth=r.lineWidth),"project"in r){if(Array.isArray(r.project))this.axesProject=r.project;else{var n=!!r.project;this.axesProject=[n,n,n]}}if("projectScale"in r){if(Array.isArray(r.projectScale))this.projectScale=r.projectScale.slice();else{var i=+r.projectScale;this.projectScale=[i,i,i]}}if(this.projectHasAlpha=!1,"projectOpacity"in r){Array.isArray(r.projectOpacity)?this.projectOpacity=r.projectOpacity.slice():(i=+r.projectOpacity,this.projectOpacity=[i,i,i]);for(var a=0;a<3;++a)this.projectOpacity[a]=v(this.projectOpacity[a]),this.projectOpacity[a]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in r&&(this.opacity=v(r.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var o,s,c=r.position,u=r.font||"normal",f=r.alignment||[0,0];if(2===f.length)o=f[0],s=f[1];else for(o=[],s=[],a=0;a<f.length;++a)o[a]=f[a][0],s[a]=f[a][1];var h=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0],d=r.glyph,m=r.color,g=r.size,y=r.angle,x=r.lineColor,b=-1,_=0,w=0,T=0;if(c.length){T=c.length;t:for(a=0;a<T;++a){for(var k=c[a],A=0;A<3;++A)if(isNaN(k[A])||!isFinite(k[A]))continue t;var M=(V=O(d,a,u,this.pixelRatio)).mesh,S=V.lines,E=V.bounds;_+=3*M.cells.length,w+=2*S.edges.length}}var L=_+w,C=l.mallocFloat(3*L),P=l.mallocFloat(4*L),I=l.mallocFloat(2*L),z=l.mallocUint32(L);if(L>0){var D=0,R=_,F=[0,0,0,1],B=[0,0,0,1],N=Array.isArray(m)&&Array.isArray(m[0]),j=Array.isArray(x)&&Array.isArray(x[0]);t:for(a=0;a<T;++a){for(b+=1,k=c[a],A=0;A<3;++A){if(isNaN(k[A])||!isFinite(k[A]))continue t;p[A]=Math.max(p[A],k[A]),h[A]=Math.min(h[A],k[A])}M=(V=O(d,a,u,this.pixelRatio)).mesh,S=V.lines,E=V.bounds;var U,V,H=V.visible;if(H){if(Array.isArray(m)){if(3===(U=N?a<m.length?m[a]:[0,0,0,0]:m).length){for(A=0;A<3;++A)F[A]=U[A];F[3]=1}else if(4===U.length){for(A=0;A<4;++A)F[A]=U[A];!this.hasAlpha&&U[3]<1&&(this.hasAlpha=!0)}}else F[0]=F[1]=F[2]=0,F[3]=1}else F=[1,1,1,0];if(H){if(Array.isArray(x)){if(3===(U=j?a<x.length?x[a]:[0,0,0,0]:x).length){for(A=0;A<3;++A)B[A]=U[A];B[A]=1}else if(4===U.length){for(A=0;A<4;++A)B[A]=U[A];!this.hasAlpha&&U[3]<1&&(this.hasAlpha=!0)}}else B[0]=B[1]=B[2]=0,B[3]=1}else B=[1,1,1,0];var q=.5;H?Array.isArray(g)?q=a<g.length?+g[a]:12:g?q=+g:this.useOrtho&&(q=12):q=0;var G=0;Array.isArray(y)?G=a<y.length?+y[a]:0:y&&(G=+y);var Y=Math.cos(G),W=Math.sin(G);for(k=c[a],A=0;A<3;++A)p[A]=Math.max(p[A],k[A]),h[A]=Math.min(h[A],k[A]);var X=o,Z=s;X=0,Array.isArray(o)?X=a<o.length?o[a]:0:o&&(X=o),Z=0,Array.isArray(s)?Z=a<s.length?s[a]:0:s&&(Z=s);var J=[X*=X>0?1-E[0][0]:X<0?1+E[1][0]:1,Z*=Z>0?1-E[0][1]:Z<0?1+E[1][1]:1],K=M.cells||[],Q=M.positions||[];for(A=0;A<K.length;++A)for(var $=K[A],tt=0;tt<3;++tt){for(var te=0;te<3;++te)C[3*D+te]=k[te];for(te=0;te<4;++te)P[4*D+te]=F[te];z[D]=b;var tr=Q[$[tt]];I[2*D]=q*(Y*tr[0]-W*tr[1]+J[0]),I[2*D+1]=q*(W*tr[0]+Y*tr[1]+J[1]),D+=1}for(K=S.edges,Q=S.positions,A=0;A<K.length;++A)for($=K[A],tt=0;tt<2;++tt){for(te=0;te<3;++te)C[3*R+te]=k[te];for(te=0;te<4;++te)P[4*R+te]=B[te];z[R]=b,tr=Q[$[tt]],I[2*R]=q*(Y*tr[0]-W*tr[1]+J[0]),I[2*R+1]=q*(W*tr[0]+Y*tr[1]+J[1]),R+=1}}}this.bounds=[h,p],this.points=c,this.pointCount=c.length,this.vertexCount=_,this.lineVertexCount=w,this.pointBuffer.update(C),this.colorBuffer.update(P),this.glyphBuffer.update(I),this.idBuffer.update(z),l.free(C),l.free(P),l.free(I),l.free(z)},x.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(r,n,i){"use strict";var a=r("glslify");i.boxVertex=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),i.boxFragment=a(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:231}],130:[function(r,n,i){"use strict";var a=r("gl-shader"),o=r("gl-buffer"),s=r("./lib/shaders");function l(r,n,i){this.plot=r,this.boxBuffer=n,this.boxShader=i,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}n.exports=function(r,n){var i=r.gl,c=new l(r,o(i,[0,0,0,1,1,0,1,1]),a(i,s.boxVertex,s.boxFragment));return c.update(n),r.addOverlay(c),c};var c=l.prototype;c.draw=function(){if(this.enabled){var r=this.plot,n=this.selectBox,i=this.borderWidth,a=(this.innerFill,this.innerColor),o=(this.outerFill,this.outerColor),s=this.borderColor,l=r.box,c=r.screenBox,u=r.dataBox,f=r.viewBox,h=r.pixelRatio,p=(n[0]-u[0])*(f[2]-f[0])/(u[2]-u[0])+f[0],d=(n[1]-u[1])*(f[3]-f[1])/(u[3]-u[1])+f[1],m=(n[2]-u[0])*(f[2]-f[0])/(u[2]-u[0])+f[0],g=(n[3]-u[1])*(f[3]-f[1])/(u[3]-u[1])+f[1];if(p=Math.max(p,f[0]),d=Math.max(d,f[1]),m=Math.min(m,f[2]),g=Math.min(g,f[3]),!(m<p||g<d)){l.bind();var v=c[2]-c[0],y=c[3]-c[1];if(this.outerFill&&(l.drawBox(0,0,v,d,o),l.drawBox(0,d,p,g,o),l.drawBox(0,g,v,y,o),l.drawBox(m,d,v,g,o)),this.innerFill&&l.drawBox(p,d,m,g,a),i>0){var x=i*h;l.drawBox(p-x,d-x,m+x,d+x,s),l.drawBox(p-x,g-x,m+x,g+x,s),l.drawBox(p-x,d-x,p+x,g+x,s),l.drawBox(m-x,d-x,m+x,g+x,s)}}}},c.update=function(r){r=r||{},this.innerFill=!!r.innerFill,this.outerFill=!!r.outerFill,this.innerColor=(r.innerColor||[0,0,0,.5]).slice(),this.outerColor=(r.outerColor||[0,0,0,.5]).slice(),this.borderColor=(r.borderColor||[0,0,0,1]).slice(),this.borderWidth=r.borderWidth||0,this.selectBox=(r.selectBox||this.selectBox).slice()},c.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(r,n,i){"use strict";n.exports=function(r,n){var i=n[0],s=n[1],l=a(r,i,s,{});return new u(r,l,o.mallocUint8(i*s*4))};var a=r("gl-fbo"),o=r("typedarray-pool"),s=r("ndarray"),l=r("bit-twiddle").nextPow2;function c(r,n,i,a,o){this.coord=[r,n],this.id=i,this.value=a,this.distance=o}function u(r,n,i){this.gl=r,this.fbo=n,this.buffer=i,this._readTimeout=null;var a=this;this._readCallback=function(){a.gl&&(n.bind(),r.readPixels(0,0,n.shape[0],n.shape[1],r.RGBA,r.UNSIGNED_BYTE,a.buffer),a._readTimeout=null)}}var f=u.prototype;Object.defineProperty(f,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(r){if(this.gl){this.fbo.shape=r;var n=this.fbo.shape[0],i=this.fbo.shape[1];if(i*n*4>this.buffer.length){o.free(this.buffer);for(var a=this.buffer=o.mallocUint8(l(i*n*4)),s=0;s<i*n*4;++s)a[s]=255}return r}}}),f.begin=function(){var r=this.gl;this.shape,r&&(this.fbo.bind(),r.clearColor(1,1,1,1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT))},f.end=function(){var r=this.gl;r&&(r.bindFramebuffer(r.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},f.query=function(r,n,i){if(!this.gl)return null;var a=this.fbo.shape.slice();r|=0,n|=0,"number"!=typeof i&&(i=1);var o=0|Math.min(Math.max(r-i,0),a[0]),l=0|Math.min(Math.max(r+i,0),a[0]),u=0|Math.min(Math.max(n-i,0),a[1]),f=0|Math.min(Math.max(n+i,0),a[1]);if(l<=o||f<=u)return null;var h=[l-o,f-u],p=s(this.buffer,[h[0],h[1],4],[4,4*a[0],1],4*(o+a[0]*u)),d=function(r,n,i){for(var a=1e8,o=-1,s=-1,l=r.shape[0],c=r.shape[1],u=0;u<l;u++)for(var f=0;f<c;f++){var h=r.get(u,f,0),p=r.get(u,f,1),d=r.get(u,f,2),m=r.get(u,f,3);if(h<255||p<255||d<255||m<255){var g=n-u,v=i-f,y=g*g+v*v;y<a&&(a=y,o=u,s=f)}}return[o,s,a]}(p.hi(h[0],h[1],1),i,i),m=d[0],g=d[1];return m<0||Math.pow(this.radius,2)<d[2]?null:new c(m+o|0,g+u|0,p.get(m,g,0),[p.get(m,g,1),p.get(m,g,2),p.get(m,g,3)],Math.sqrt(d[2]))},f.dispose=function(){this.gl&&(this.fbo.dispose(),o.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(r,n,i){"use strict";var a=r("./lib/create-uniforms"),o=r("./lib/create-attributes"),s=r("./lib/reflect"),l=r("./lib/shader-cache"),c=r("./lib/runtime-reflect"),u=r("./lib/GLError");function f(r){this.gl=r,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var h=f.prototype;function p(r,n){return r.name<n.name?-1:1}h.bind=function(){this.program||this._relink();var r,n=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),i=this.gl.lastAttribCount;if(n>i)for(r=i;r<n;r++)this.gl.enableVertexAttribArray(r);else if(i>n)for(r=n;r<i;r++)this.gl.disableVertexAttribArray(r);this.gl.lastAttribCount=n,this.gl.useProgram(this.program)},h.dispose=function(){for(var r=this.gl.lastAttribCount,n=0;n<r;n++)this.gl.disableVertexAttribArray(n);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},h.update=function(r,n,i,f){if(!n||1==arguments.length){var h=r;r=h.vertex,n=h.fragment,i=h.uniforms,f=h.attributes}var d=this,m=d.gl,g=d._vref;d._vref=l.shader(m,m.VERTEX_SHADER,r),g&&g.dispose(),d.vertShader=d._vref.shader;var v=this._fref;if(d._fref=l.shader(m,m.FRAGMENT_SHADER,n),v&&v.dispose(),d.fragShader=d._fref.shader,!i||!f){var y=m.createProgram();if(m.attachShader(y,d.fragShader),m.attachShader(y,d.vertShader),m.linkProgram(y),!m.getProgramParameter(y,m.LINK_STATUS)){var x=m.getProgramInfoLog(y);throw new u(x,"Error linking program:"+x)}i=i||c.uniforms(m,y),f=f||c.attributes(m,y),m.deleteProgram(y)}(f=f.slice()).sort(p);var b,_=[],w=[],T=[];for(b=0;b<f.length;++b){var k=f[b];if(k.type.indexOf("mat")>=0){for(var A=0|k.type.charAt(k.type.length-1),M=Array(A),S=0;S<A;++S)M[S]=T.length,w.push(k.name+"["+S+"]"),"number"==typeof k.location?T.push(k.location+S):Array.isArray(k.location)&&k.location.length===A&&"number"==typeof k.location[S]?T.push(0|k.location[S]):T.push(-1);_.push({name:k.name,type:k.type,locations:M})}else _.push({name:k.name,type:k.type,locations:[T.length]}),w.push(k.name),"number"==typeof k.location?T.push(0|k.location):T.push(-1)}var E=0;for(b=0;b<T.length;++b)if(T[b]<0){for(;T.indexOf(E)>=0;)E+=1;T[b]=E}var L=Array(i.length);function C(){d.program=l.program(m,d._vref,d._fref,w,T);for(var r=0;r<i.length;++r)L[r]=m.getUniformLocation(d.program,i[r].name)}C(),d._relink=C,d.types={uniforms:s(i),attributes:s(f)},d.attributes=o(m,d,_,T),Object.defineProperty(d,"uniforms",a(m,d,i,L))},n.exports=function(r,n,i,a,o){var s=new f(r);return s.update(n,i,a,o),s}},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(r,n,i){function a(r,n,i){this.shortMessage=n||"",this.longMessage=i||"",this.rawError=r||"",this.message="gl-shader: "+(n||r||"")+(i?"\n"+i:""),this.stack=Error().stack}a.prototype=Error(),a.prototype.name="GLError",a.prototype.constructor=a,n.exports=a},{}],134:[function(r,n,i){"use strict";n.exports=function(r,n,i,o){for(var s={},l=0,u=i.length;l<u;++l){var f,h=i[l],p=h.name,d=h.type,m=h.locations;switch(d){case"bool":case"int":case"float":c(r,n,m[0],o,1,s,p);break;default:if(d.indexOf("vec")>=0){if((f=d.charCodeAt(d.length-1)-48)<2||f>4)throw new a("","Invalid data type for attribute "+p+": "+d);c(r,n,m[0],o,f,s,p)}else{if(!(d.indexOf("mat")>=0))throw new a("","Unknown data type for attribute "+p+": "+d);if((f=d.charCodeAt(d.length-1)-48)<2||f>4)throw new a("","Invalid data type for attribute "+p+": "+d);!function(r,n,i,a,o,s,l){for(var u=Array(o),f=Array(o),h=0;h<o;++h)c(r,n,i[h],a,o,u,h),f[h]=u[h];Object.defineProperty(u,"location",{set:function(r){if(Array.isArray(r))for(var n=0;n<o;++n)f[n].location=r[n];else for(n=0;n<o;++n)f[n].location=r+n;return r},get:function(){for(var r=Array(o),n=0;n<o;++n)r[n]=a[i[n]];return r},enumerable:!0}),u.pointer=function(n,s,l,c){n=n||r.FLOAT,s=!!s,l=l||o*o,c=c||0;for(var u=0;u<o;++u){var f=a[i[u]];r.vertexAttribPointer(f,o,n,s,l,c+u*o),r.enableVertexAttribArray(f)}};var p=Array(o),d=r["vertexAttrib"+o+"fv"];Object.defineProperty(s,l,{set:function(n){for(var s=0;s<o;++s){var l=a[i[s]];if(r.disableVertexAttribArray(l),Array.isArray(n[0]))d.call(r,l,n[s]);else{for(var c=0;c<o;++c)p[c]=n[o*s+c];d.call(r,l,p)}}return n},get:function(){return u},enumerable:!0})}(r,n,m,o,f,s,p)}}}return s};var a=r("./GLError");function o(r,n,i,a,o,s){this._gl=r,this._wrapper=n,this._index=i,this._locations=a,this._dimension=o,this._constFunc=s}var s=o.prototype;s.pointer=function(r,n,i,a){var o=this._gl,s=this._locations[this._index];o.vertexAttribPointer(s,this._dimension,r||o.FLOAT,!!n,i||0,a||0),o.enableVertexAttribArray(s)},s.set=function(r,n,i,a){return this._constFunc(this._locations[this._index],r,n,i,a)},Object.defineProperty(s,"location",{get:function(){return this._locations[this._index]},set:function(r){return r!==this._locations[this._index]&&(this._locations[this._index]=0|r,this._wrapper.program=null),0|r}});var l=[function(r,n,i){return void 0===i.length?r.vertexAttrib1f(n,i):r.vertexAttrib1fv(n,i)},function(r,n,i,a){return void 0===i.length?r.vertexAttrib2f(n,i,a):r.vertexAttrib2fv(n,i)},function(r,n,i,a,o){return void 0===i.length?r.vertexAttrib3f(n,i,a,o):r.vertexAttrib3fv(n,i)},function(r,n,i,a,o,s){return void 0===i.length?r.vertexAttrib4f(n,i,a,o,s):r.vertexAttrib4fv(n,i)}];function c(r,n,i,a,s,c,u){var f=l[s],h=new o(r,n,i,a,s,f);Object.defineProperty(c,u,{set:function(n){return r.disableVertexAttribArray(a[i]),f(r,a[i],n),n},get:function(){return h},enumerable:!0})}},{"./GLError":133}],135:[function(r,n,i){"use strict";var a=r("./reflect"),o=r("./GLError");function s(r){return function(){return r}}function l(r,n){for(var i=Array(r),a=0;a<r;++a)i[a]=n;return i}n.exports=function(r,n,i,c){function u(n){return function(a){for(var s=function r(n,i){if("object"!=typeof i)return[[n,i]];var a=[];for(var o in i){var s=i[o],l=n;parseInt(o)+""===o?l+="["+o+"]":l+="."+o,"object"==typeof s?a.push.apply(a,r(l,s)):a.push([l,s])}return a}("",n),l=0;l<s.length;++l){var u=s[l],f=u[0],h=u[1];if(c[h]){var p=a;if("string"==typeof f&&(0===f.indexOf(".")||0===f.indexOf("["))){var d=f;if(0===f.indexOf(".")&&(d=f.slice(1)),d.indexOf("]")===d.length-1){var m=d.indexOf("["),g=d.slice(0,m),v=d.slice(m+1,d.length-1);p=g?a[g][v]:a[v]}else p=a[d]}var y,x=i[h].type;switch(x){case"bool":case"int":case"sampler2D":case"samplerCube":r.uniform1i(c[h],p);break;case"float":r.uniform1f(c[h],p);break;default:var b=x.indexOf("vec");if(!(0<=b&&b<=1&&x.length===4+b)){if(0===x.indexOf("mat")&&4===x.length){if((y=x.charCodeAt(x.length-1)-48)<2||y>4)throw new o("","Invalid uniform dimension type for matrix "+name+": "+x);r["uniformMatrix"+y+"fv"](c[h],!1,p);break}throw new o("","Unknown uniform data type for "+name+": "+x)}if((y=x.charCodeAt(x.length-1)-48)<2||y>4)throw new o("","Invalid data type");switch(x.charAt(0)){case"b":case"i":r["uniform"+y+"iv"](c[h],p);break;case"v":r["uniform"+y+"fv"](c[h],p);break;default:throw new o("","Unrecognized data type for vector "+name+": "+x)}}}}}}function f(r,n,a){"object"==typeof a?Object.defineProperty(r,n,{get:s(h(a)),set:u(a),enumerable:!0,configurable:!1}):c[a]?Object.defineProperty(r,n,{get:function(r,n,i){return r.getUniform(n.program,i[a])},set:u(a),enumerable:!0,configurable:!1}):r[n]=function(r){switch(r){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var n,i=r.indexOf("vec");if(0<=i&&i<=1&&r.length===4+i){if((n=r.charCodeAt(r.length-1)-48)<2||n>4)throw new o("","Invalid data type");return"b"===r.charAt(0)?l(n,!1):l(n,0)}if(0===r.indexOf("mat")&&4===r.length){if((n=r.charCodeAt(r.length-1)-48)<2||n>4)throw new o("","Invalid uniform dimension type for matrix "+name+": "+r);return l(n*n,0)}throw new o("","Unknown uniform data type for "+name+": "+r)}}(i[a].type)}function h(r){var n;if(Array.isArray(r)){n=Array(r.length);for(var i=0;i<r.length;++i)f(n,i,r[i])}else for(var a in n={},r)f(n,a,r[a]);return n}var p=a(i,!0);return{get:s(h(p)),set:u(p),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(r,n,i){"use strict";n.exports=function(r,n){for(var i={},a=0;a<r.length;++a)for(var o=r[a].name.split("."),s=i,l=0;l<o.length;++l){var c=o[l].split("[");if(c.length>1){c[0]in s||(s[c[0]]=[]),s=s[c[0]];for(var u=1;u<c.length;++u){var f=parseInt(c[u]);u<c.length-1||l<o.length-1?(f in s||(u<c.length-1?s[f]=[]:s[f]={}),s=s[f]):s[f]=n?a:r[a].type}}else l<o.length-1?(c[0]in s||(s[c[0]]={}),s=s[c[0]]):s[c[0]]=n?a:r[a].type}return i}},{}],137:[function(r,n,i){"use strict";i.uniforms=function(r,n){for(var i=r.getProgramParameter(n,r.ACTIVE_UNIFORMS),a=[],o=0;o<i;++o){var l=r.getActiveUniform(n,o);if(l){var c=s(r,l.type);if(l.size>1)for(var u=0;u<l.size;++u)a.push({name:l.name.replace("[0]","["+u+"]"),type:c});else a.push({name:l.name,type:c})}}return a},i.attributes=function(r,n){for(var i=r.getProgramParameter(n,r.ACTIVE_ATTRIBUTES),a=[],o=0;o<i;++o){var l=r.getActiveAttrib(n,o);l&&a.push({name:l.name,type:s(r,l.type)})}return a};var a={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},o=null;function s(r,n){if(!o){var i=Object.keys(a);o={};for(var s=0;s<i.length;++s){var l=i[s];o[r[l]]=a[l]}}return o[n]}},{}],138:[function(r,n,i){"use strict";i.shader=function(r,n,i){return h(r).getShaderReference(n,i)},i.program=function(r,n,i,a,o){return h(r).getProgram(n,i,a,o)};var a=r("./GLError"),o=r("gl-format-compiler-error"),s=new("undefined"==typeof WeakMap?r("weakmap-shim"):WeakMap),l=0;function c(r,n,i,a,o,s,l){this.id=r,this.src=n,this.type=i,this.shader=a,this.count=s,this.programs=[],this.cache=l}function u(r){this.gl=r,this.shaders=[{},{}],this.programs={}}c.prototype.dispose=function(){if(0==--this.count){for(var r=this.cache,n=r.gl,i=this.programs,a=0,o=i.length;a<o;++a){var s=r.programs[i[a]];s&&(delete r.programs[a],n.deleteProgram(s))}n.deleteShader(this.shader),delete r.shaders[this.type===n.FRAGMENT_SHADER|0][this.src]}};var f=u.prototype;function h(r){var n=s.get(r);return n||(n=new u(r),s.set(r,n)),n}f.getShaderReference=function(r,n){var i=this.gl,s=this.shaders[r===i.FRAGMENT_SHADER|0],u=s[n];if(u&&i.isShader(u.shader))u.count+=1;else{var f=function(r,n,i){var s=r.createShader(n);if(r.shaderSource(s,i),r.compileShader(s),!r.getShaderParameter(s,r.COMPILE_STATUS)){var l=r.getShaderInfoLog(s);try{var c=o(l,i,n)}catch(r){throw console.warn("Failed to format compiler error: "+r),new a(l,"Error compiling shader:\n"+l)}throw new a(l,c.short,c.long)}return s}(i,r,n);u=s[n]=new c(l++,n,r,f,[],1,this)}return u},f.getProgram=function(r,n,i,o){var s=[r.id,n.id,i.join(":"),o.join(":")].join("@"),l=this.programs[s];return l&&this.gl.isProgram(l)||(this.programs[s]=l=function(r,n,i,o,s){var l=r.createProgram();r.attachShader(l,n),r.attachShader(l,i);for(var c=0;c<o.length;++c)r.bindAttribLocation(l,s[c],o[c]);if(r.linkProgram(l),!r.getProgramParameter(l,r.LINK_STATUS)){var u=r.getProgramInfoLog(l);throw new a(u,"Error linking program: "+u)}return l}(this.gl,r.shader,n.shader,i,o),r.programs.push(s),n.programs.push(s)),l}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(r,n,i){"use strict";function a(r){this.plot=r,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}n.exports=function(r,n){var i=new a(r);return i.update(n),r.addOverlay(i),i};var o=a.prototype;o.update=function(r){r=r||{},this.enable=(r.enable||[!0,!0,!1,!1]).slice(),this.width=(r.width||[1,1,1,1]).slice(),this.color=(r.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(r){return r.slice()}),this.center=(r.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},o.draw=function(){var r=this.enable,n=this.width,i=this.color,a=this.center,o=this.plot,s=o.line,l=o.dataBox,c=o.viewBox;if(s.bind(),l[0]<=a[0]&&a[0]<=l[2]&&l[1]<=a[1]&&a[1]<=l[3]){var u=c[0]+(a[0]-l[0])/(l[2]-l[0])*(c[2]-c[0]),f=c[1]+(a[1]-l[1])/(l[3]-l[1])*(c[3]-c[1]);r[0]&&s.drawLine(u,f,c[0],f,n[0],i[0]),r[1]&&s.drawLine(u,f,u,c[1],n[1],i[1]),r[2]&&s.drawLine(u,f,c[2],f,n[2],i[2]),r[3]&&s.drawLine(u,f,u,c[3],n[3],i[3])}},o.dispose=function(){this.plot.removeOverlay(this)}},{}],140:[function(r,n,i){"use strict";var a=r("glslify"),o=r("gl-shader"),s=a(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),l=a(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);n.exports=function(r){return o(r,s,l,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(r,n,i){"use strict";var a=r("gl-buffer"),o=r("gl-vao"),s=r("./shaders/index");n.exports=function(r,n){var i=[];function l(r,n,a,o,s,l){var c=[r,n,a,0,0,0,1];c[o+3]=1,c[o]=s,i.push.apply(i,c),c[6]=-1,i.push.apply(i,c),c[o]=l,i.push.apply(i,c),i.push.apply(i,c),c[6]=1,i.push.apply(i,c),c[o]=s,i.push.apply(i,c)}l(0,0,0,0,0,1),l(0,0,0,1,0,1),l(0,0,0,2,0,1),l(1,0,0,1,-1,1),l(1,0,0,2,-1,1),l(0,1,0,0,-1,1),l(0,1,0,2,-1,1),l(0,0,1,0,-1,1),l(0,0,1,1,-1,1);var u=a(r,i),f=o(r,[{type:r.FLOAT,buffer:u,size:3,offset:0,stride:28},{type:r.FLOAT,buffer:u,size:3,offset:12,stride:28},{type:r.FLOAT,buffer:u,size:1,offset:24,stride:28}]),h=s(r);h.attributes.position.location=0,h.attributes.color.location=1,h.attributes.weight.location=2;var p=new c(r,u,f,h);return p.update(n),p};var l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function c(r,n,i,a){this.gl=r,this.buffer=n,this.vao=i,this.shader=a,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var u=c.prototype,f=[0,0,0],h=[0,0,0],p=[0,0];u.isTransparent=function(){return!1},u.drawTransparent=function(r){},u.draw=function(r){var n=this.gl,i=this.vao,a=this.shader;i.bind(),a.bind();var o,s=r.model||l,c=r.view||l,u=r.projection||l;this.axes&&(o=this.axes.lastCubeProps.axis);for(var d=0;d<3;++d)o&&o[d]<0?(f[d]=this.bounds[0][d],h[d]=this.bounds[1][d]):(f[d]=this.bounds[1][d],h[d]=this.bounds[0][d]);for(p[0]=n.drawingBufferWidth,p[1]=n.drawingBufferHeight,a.uniforms.model=s,a.uniforms.view=c,a.uniforms.projection=u,a.uniforms.coordinates=[this.position,f,h],a.uniforms.colors=this.colors,a.uniforms.screenShape=p,d=0;d<3;++d)a.uniforms.lineWidth=this.lineWidth[d]*this.pixelRatio,this.enabled[d]&&(i.draw(n.TRIANGLES,6,6*d),this.drawSides[d]&&i.draw(n.TRIANGLES,12,18+12*d));i.unbind()},u.update=function(r){r&&("bounds"in r&&(this.bounds=r.bounds),"position"in r&&(this.position=r.position),"lineWidth"in r&&(this.lineWidth=r.lineWidth),"colors"in r&&(this.colors=r.colors),"enabled"in r&&(this.enabled=r.enabled),"drawSides"in r&&(this.drawSides=r.drawSides))},u.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(r,n,i){var a=r("glslify"),o=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, tubeScale;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),s=a(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),l=a(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),c=a(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);i.meshShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},i.pickShader={vertex:l,fragment:c,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(r,n,i){"use strict";var a=r("gl-vec3"),o=r("gl-vec4"),s=["xyz","xzy","yxz","yzx","zxy","zyx"],l=function(r,n,i,s){for(var l=0,c=0;c<r.length;c++)for(var u=r[c].velocities,f=0;f<u.length;f++)l=Math.max(l,a.length(u[f]));var h=r.map(function(r){return function(r,n,i,s){for(var l=r.points,c=r.velocities,u=r.divergences,f=[],h=[],p=[],d=[],m=[],g=[],v=0,y=0,x=o.create(),b=o.create(),_=0;_<l.length;_++){var w=l[_],T=c[_],k=u[_];0===n&&(k=.05*i),y=a.length(T)/s,x=o.create(),a.copy(x,T),x[3]=k;for(var A=0;A<8;A++)m[A]=[w[0],w[1],w[2],A];if(d.length>0)for(A=0;A<8;A++){var M=(A+1)%8;f.push(d[A],m[A],m[M],m[M],d[M],d[A]),p.push(b,x,x,x,b,b),g.push(v,y,y,y,v,v);var S=f.length;h.push([S-6,S-5,S-4],[S-3,S-2,S-1])}var E=d;d=m,m=E;var L=b;b=x,x=L;var C=v;v=y,y=C}return{positions:f,cells:h,vectors:p,vertexIntensity:g}}(r,i,s,l)}),p=[],d=[],m=[],g=[];for(c=0;c<h.length;c++){var v=h[c],y=p.length;for(p=p.concat(v.positions),m=m.concat(v.vectors),g=g.concat(v.vertexIntensity),f=0;f<v.cells.length;f++){var x=v.cells[f],b=[];d.push(b);for(var _=0;_<x.length;_++)b.push(x[_]+y)}}return{positions:p,cells:d,vectors:m,vertexIntensity:g,colormap:n}},c=function(r,n){var i,a=r.length;for(i=0;i<a;i++){var o=r[i];if(o===n)break;if(o>n)return i-1}return i},u=function(r,n,i){return r<n?n:r>i?i:r},f=function(r){var n=1/0;r.sort(function(r,n){return r-n});for(var i=r.length,a=1;a<i;a++){var o=Math.abs(r[a]-r[a-1]);o<n&&(n=o)}return n};n.exports=function(r,n){var i=r.startingPositions,o=r.maxLength||1e3,h=r.tubeSize||1,p=r.absoluteTubeSize,d=r.gridFill||"+x+y+z",m={};-1!==d.indexOf("-x")&&(m.reversedX=!0),-1!==d.indexOf("-y")&&(m.reversedY=!0),-1!==d.indexOf("-z")&&(m.reversedZ=!0),m.filled=s.indexOf(d.replace(/-/g,"").replace(/\+/g,""));var g=r.getVelocity||function(n){return function(r,n,i){var o=n.vectors,s=n.meshgrid,l=r[0],f=r[1],h=r[2],p=s[0].length,d=s[1].length,m=s[2].length,g=c(s[0],l),v=c(s[1],f),y=c(s[2],h),x=g+1,b=v+1,_=y+1;if(g=u(g,0,p-1),x=u(x,0,p-1),v=u(v,0,d-1),b=u(b,0,d-1),y=u(y,0,m-1),_=u(_,0,m-1),g<0||v<0||y<0||x>p-1||b>d-1||_>m-1)return a.create();var w,T,k,A,M,S,E=s[0][g],L=s[0][x],C=s[1][v],P=s[1][b],I=s[2][y],O=(l-E)/(L-E),z=(f-C)/(P-C),D=(h-I)/(s[2][_]-I);switch(isFinite(O)||(O=.5),isFinite(z)||(z=.5),isFinite(D)||(D=.5),i.reversedX&&(g=p-1-g,x=p-1-x),i.reversedY&&(v=d-1-v,b=d-1-b),i.reversedZ&&(y=m-1-y,_=m-1-_),i.filled){case 5:M=y,S=_,k=v*m,A=b*m,w=g*m*d,T=x*m*d;break;case 4:M=y,S=_,w=g*m,T=x*m,k=v*m*p,A=b*m*p;break;case 3:k=v,A=b,M=y*d,S=_*d,w=g*d*m,T=x*d*m;break;case 2:k=v,A=b,w=g*d,T=x*d,M=y*d*p,S=_*d*p;break;case 1:w=g,T=x,M=y*p,S=_*p,k=v*p*m,A=b*p*m;break;default:w=g,T=x,k=v*p,A=b*p,M=y*p*d,S=_*p*d}var R=o[w+k+M],F=o[w+k+S],B=o[w+A+M],N=o[w+A+S],j=o[T+k+M],U=o[T+k+S],V=o[T+A+M],H=o[T+A+S],q=a.create(),G=a.create(),Y=a.create(),W=a.create();a.lerp(q,R,j,O),a.lerp(G,F,U,O),a.lerp(Y,B,V,O),a.lerp(W,N,H,O);var X=a.create(),Z=a.create();a.lerp(X,q,Y,z),a.lerp(Z,G,W,z);var J=a.create();return a.lerp(J,X,Z,D),J}(n,r,m)},v=r.getDivergence||function(r,n){var i=a.create();a.add(i,r,[1e-4,0,0]);var o=g(i);a.subtract(o,o,n),a.scale(o,o,1e4),a.add(i,r,[0,1e-4,0]);var s=g(i);a.subtract(s,s,n),a.scale(s,s,1e4),a.add(i,r,[0,0,1e-4]);var l=g(i);return a.subtract(l,l,n),a.scale(l,l,1e4),a.add(i,o,s),a.add(i,i,l),i},y=[],x=n[0][0],b=n[0][1],_=n[0][2],w=n[1][0],T=n[1][1],k=n[1][2],A=10*a.distance(n[0],n[1])/o,M=A*A,S=1,E=0,L=i.length;L>1&&(S=function(r){for(var n=[],i=[],a=[],o={},s={},l={},c=r.length,u=0;u<c;u++){var h=r[u],p=h[0],d=h[1],m=h[2];o[p]||(n.push(p),o[p]=!0),s[d]||(i.push(d),s[d]=!0),l[m]||(a.push(m),l[m]=!0)}var g=Math.min(f(n),f(i),f(a));return isFinite(g)?g:1}(i));for(var C=0;C<L;C++){var P=a.create();a.copy(P,i[C]);var I=[P],O=[],z=g(P),D=P;O.push(z);var R=[],F=v(P,z),B=a.length(F);isFinite(B)&&B>E&&(E=B),R.push(B),y.push({points:I,velocities:O,divergences:R});for(var N=0;N<100*o&&I.length<o&&function(r){var n=r[0],i=r[1],a=r[2];return!(n<x||n>w||i<b||i>T||a<_||a>k)}(P);){N++;var j=a.clone(z),U=a.squaredLength(j);if(0===U)break;U>M&&a.scale(j,j,A/Math.sqrt(U)),a.add(j,j,P),z=g(j),a.squaredDistance(D,j)-M>-.0001*M&&(I.push(j),D=j,O.push(z),F=v(j,z),isFinite(B=a.length(F))&&B>E&&(E=B),R.push(B)),P=j}}var V=l(y,r.colormap,E,S);return p?V.tubeScale=p:(0===E&&(E=1),V.tubeScale=.5*h*S/E),V};var h=r("./lib/shaders"),p=r("gl-cone3d").createMesh;n.exports.createTubeMesh=function(r,n){return p(r,n,{shaders:h,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(r,n,i){var a=r("gl-shader"),o=r("glslify"),s=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),l=o(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (\n    kill > 0.0 ||\n    vColor.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)\n  ) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color  in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),c=o(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),u=o(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);i.createShader=function(r){var n=a(r,s,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return n.attributes.uv.location=0,n.attributes.f.location=1,n.attributes.normal.location=2,n},i.createPickShader=function(r){var n=a(r,s,u,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return n.attributes.uv.location=0,n.attributes.f.location=1,n.attributes.normal.location=2,n},i.createContourShader=function(r){var n=a(r,c,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return n.attributes.uv.location=0,n.attributes.f.location=1,n},i.createPickContourShader=function(r){var n=a(r,c,u,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return n.attributes.uv.location=0,n.attributes.f.location=1,n}},{"gl-shader":132,glslify:231}],145:[function(r,n,i){"use strict";n.exports=function(r){var n=r.gl,i=b(n),a=w(n),c=_(n),u=T(n),f=o(n),h=s(n,[{buffer:f,size:4,stride:40,offset:0},{buffer:f,size:3,stride:40,offset:16},{buffer:f,size:3,stride:40,offset:28}]),p=o(n),d=s(n,[{buffer:p,size:4,stride:20,offset:0},{buffer:p,size:1,stride:20,offset:16}]),m=o(n),g=s(n,[{buffer:m,size:2,type:n.FLOAT}]),v=l(n,1,256,n.RGBA,n.UNSIGNED_BYTE);v.minFilter=n.LINEAR,v.magFilter=n.LINEAR;var y=new E(n,[0,0],[[0,0,0],[0,0,0]],i,a,f,h,v,c,u,p,d,m,g,[0,0,0]),x={levels:[[],[],[]]};for(var k in r)x[k]=r[k];return x.colormap=x.colormap||"jet",y.update(x),y};var a=r("bit-twiddle"),o=r("gl-buffer"),s=r("gl-vao"),l=r("gl-texture2d"),c=r("typedarray-pool"),u=r("colormap"),f=r("ndarray-ops"),h=r("ndarray-pack"),p=r("ndarray"),d=r("surface-nets"),m=r("gl-mat4/multiply"),g=r("gl-mat4/invert"),v=r("binary-search-bounds"),y=r("ndarray-gradient"),x=r("./lib/shaders"),b=x.createShader,_=x.createContourShader,w=x.createPickShader,T=x.createPickContourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],A=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],M=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function S(r,n,i,a,o){this.position=r,this.index=n,this.uv=i,this.level=a,this.dataCoordinate=o}function E(r,n,i,a,o,s,l,u,f,h,d,m,g,v,y){this.gl=r,this.shape=n,this.bounds=i,this.objectOffset=y,this.intensityBounds=[],this._shader=a,this._pickShader=o,this._coordinateBuffer=s,this._vao=l,this._colorMap=u,this._contourShader=f,this._contourPickShader=h,this._contourBuffer=d,this._contourVAO=m,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new S([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=g,this._dynamicVAO=v,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[p(c.mallocFloat(1024),[0,0]),p(c.mallocFloat(1024),[0,0]),p(c.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}!function(){for(var r=0;r<3;++r){var n=M[r],i=(r+2)%3;n[(r+1)%3+0]=1,n[i+3]=1,n[r+6]=1}}();var L=E.prototype;L.genColormap=function(r,n){var i=!1,a=h([u({colormap:r,nshades:256,format:"rgba"}).map(function(r,a){var o=n?function(r,n){if(!n||!n.length)return 1;for(var i=0;i<n.length&&!(n.length<2);++i){if(n[i][0]===r)return n[i][1];if(n[i][0]>r&&i>0){var a=(n[i][0]-r)/(n[i][0]-n[i-1][0]);return n[i][1]*(1-a)+a*n[i-1][1]}}return 1}(a/255,n):r[3];return o<1&&(i=!0),[r[0],r[1],r[2],255*o]})]);return f.divseq(a,255),this.hasAlphaScale=i,a},L.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},L.isOpaque=function(){return!this.isTransparent()},L.pickSlots=1,L.setPickBase=function(r){this.pickId=r};var C=[0,0,0],P={showSurface:!1,showContour:!1,projections:[k.slice(),k.slice(),k.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function I(r,n){var i,a,o,s=n.axes&&n.axes.lastCubeProps.axis||C,l=n.showSurface,c=n.showContour;for(i=0;i<3;++i)for(l=l||n.surfaceProject[i],a=0;a<3;++a)c=c||n.contourProject[i][a];for(i=0;i<3;++i){var u=P.projections[i];for(a=0;a<16;++a)u[a]=0;for(a=0;a<4;++a)u[5*a]=1;u[5*i]=0,u[12+i]=n.axesBounds[+(s[i]>0)][i],m(u,r.model,u);var f=P.clipBounds[i];for(o=0;o<2;++o)for(a=0;a<3;++a)f[o][a]=r.clipBounds[o][a];f[0][i]=-1e8,f[1][i]=1e8}return P.showSurface=l,P.showContour=c,P}var O={model:k,view:k,projection:k,inverseModel:k.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-.0001,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},z=k.slice(),D=[1,0,0,0,1,0,0,0,1];function R(r,n){r=r||{};var i=this.gl;i.disable(i.CULL_FACE),this._colorMap.bind(0),O.model=r.model||k,O.view=r.view||k,O.projection=r.projection||k,O.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],O.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],O.objectOffset=this.objectOffset,O.contourColor=this.contourColor[0],O.inverseModel=g(O.inverseModel,O.model);for(var a=0;a<2;++a)for(var o=O.clipBounds[a],s=0;s<3;++s)o[s]=Math.min(Math.max(this.clipBounds[a][s],-1e8),1e8);for(O.kambient=this.ambientLight,O.kdiffuse=this.diffuseLight,O.kspecular=this.specularLight,O.roughness=this.roughness,O.fresnel=this.fresnel,O.opacity=this.opacity,O.height=0,O.permutation=D,O.vertexColor=this.vertexColor,m(z,O.view,O.model),m(z,O.projection,z),g(z,z),a=0;a<3;++a)O.eyePosition[a]=z[12+a]/z[15];var l=z[15];for(a=0;a<3;++a)l+=this.lightPosition[a]*z[4*a+3];for(a=0;a<3;++a){var c=z[12+a];for(s=0;s<3;++s)c+=z[4*s+a]*this.lightPosition[s];O.lightPosition[a]=c/l}var u=I(O,this);if(u.showSurface){for(this._shader.bind(),this._shader.uniforms=O,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(i.TRIANGLES,this._vertexCount),a=0;a<3;++a)this.surfaceProject[a]&&this.vertexCount&&(this._shader.uniforms.model=u.projections[a],this._shader.uniforms.clipBounds=u.clipBounds[a],this._vao.draw(i.TRIANGLES,this._vertexCount));this._vao.unbind()}if(u.showContour){var f=this._contourShader;O.kambient=1,O.kdiffuse=0,O.kspecular=0,O.opacity=1,f.bind(),f.uniforms=O;var h=this._contourVAO;for(h.bind(),a=0;a<3;++a)for(f.uniforms.permutation=M[a],i.lineWidth(this.contourWidth[a]*this.pixelRatio),s=0;s<this.contourLevels[a].length;++s)s===this.highlightLevel[a]?(f.uniforms.contourColor=this.highlightColor[a],f.uniforms.contourTint=this.highlightTint[a]):0!==s&&s-1!==this.highlightLevel[a]||(f.uniforms.contourColor=this.contourColor[a],f.uniforms.contourTint=this.contourTint[a]),this._contourCounts[a][s]&&(f.uniforms.height=this.contourLevels[a][s],h.draw(i.LINES,this._contourCounts[a][s],this._contourOffsets[a][s]));for(a=0;a<3;++a)for(f.uniforms.model=u.projections[a],f.uniforms.clipBounds=u.clipBounds[a],s=0;s<3;++s)if(this.contourProject[a][s]){f.uniforms.permutation=M[s],i.lineWidth(this.contourWidth[s]*this.pixelRatio);for(var p=0;p<this.contourLevels[s].length;++p)p===this.highlightLevel[s]?(f.uniforms.contourColor=this.highlightColor[s],f.uniforms.contourTint=this.highlightTint[s]):0!==p&&p-1!==this.highlightLevel[s]||(f.uniforms.contourColor=this.contourColor[s],f.uniforms.contourTint=this.contourTint[s]),this._contourCounts[s][p]&&(f.uniforms.height=this.contourLevels[s][p],h.draw(i.LINES,this._contourCounts[s][p],this._contourOffsets[s][p]))}for(h.unbind(),(h=this._dynamicVAO).bind(),a=0;a<3;++a)if(0!==this._dynamicCounts[a])for(f.uniforms.model=O.model,f.uniforms.clipBounds=O.clipBounds,f.uniforms.permutation=M[a],i.lineWidth(this.dynamicWidth[a]*this.pixelRatio),f.uniforms.contourColor=this.dynamicColor[a],f.uniforms.contourTint=this.dynamicTint[a],f.uniforms.height=this.dynamicLevel[a],h.draw(i.LINES,this._dynamicCounts[a],this._dynamicOffsets[a]),s=0;s<3;++s)this.contourProject[s][a]&&(f.uniforms.model=u.projections[s],f.uniforms.clipBounds=u.clipBounds[s],h.draw(i.LINES,this._dynamicCounts[a],this._dynamicOffsets[a]));h.unbind()}}L.draw=function(r){return R.call(this,r,!1)},L.drawTransparent=function(r){return R.call(this,r,!0)};var F={model:k,view:k,projection:k,inverseModel:k,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function B(r,n){return Array.isArray(r)?[n(r[0]),n(r[1]),n(r[2])]:[n(r),n(r),n(r)]}function N(r){return Array.isArray(r)?3===r.length?[r[0],r[1],r[2],1]:[r[0],r[1],r[2],r[3]]:[0,0,0,1]}function j(r){if(Array.isArray(r)){if(Array.isArray(r))return[N(r[0]),N(r[1]),N(r[2])];var n=N(r);return[n.slice(),n.slice(),n.slice()]}}L.drawPick=function(r){r=r||{};var n=this.gl;n.disable(n.CULL_FACE),F.model=r.model||k,F.view=r.view||k,F.projection=r.projection||k,F.shape=this._field[2].shape,F.pickId=this.pickId/255,F.lowerBound=this.bounds[0],F.upperBound=this.bounds[1],F.objectOffset=this.objectOffset,F.permutation=D;for(var i=0;i<2;++i)for(var a=F.clipBounds[i],o=0;o<3;++o)a[o]=Math.min(Math.max(this.clipBounds[i][o],-1e8),1e8);var s=I(F,this);if(s.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=F,this._vao.bind(),this._vao.draw(n.TRIANGLES,this._vertexCount),i=0;i<3;++i)this.surfaceProject[i]&&(this._pickShader.uniforms.model=s.projections[i],this._pickShader.uniforms.clipBounds=s.clipBounds[i],this._vao.draw(n.TRIANGLES,this._vertexCount));this._vao.unbind()}if(s.showContour){var l=this._contourPickShader;l.bind(),l.uniforms=F;var c=this._contourVAO;for(c.bind(),o=0;o<3;++o)for(n.lineWidth(this.contourWidth[o]*this.pixelRatio),l.uniforms.permutation=M[o],i=0;i<this.contourLevels[o].length;++i)this._contourCounts[o][i]&&(l.uniforms.height=this.contourLevels[o][i],c.draw(n.LINES,this._contourCounts[o][i],this._contourOffsets[o][i]));for(i=0;i<3;++i)for(l.uniforms.model=s.projections[i],l.uniforms.clipBounds=s.clipBounds[i],o=0;o<3;++o)if(this.contourProject[i][o]){l.uniforms.permutation=M[o],n.lineWidth(this.contourWidth[o]*this.pixelRatio);for(var u=0;u<this.contourLevels[o].length;++u)this._contourCounts[o][u]&&(l.uniforms.height=this.contourLevels[o][u],c.draw(n.LINES,this._contourCounts[o][u],this._contourOffsets[o][u]))}c.unbind()}},L.pick=function(r){if(!r||r.id!==this.pickId)return null;var n=this._field[2].shape,i=this._pickResult,a=n[0]*(r.value[0]+(r.value[2]>>4)/16)/255,o=Math.floor(a),s=a-o,l=n[1]*(r.value[1]+(15&r.value[2])/16)/255,c=Math.floor(l),u=l-c;o+=1,c+=1;var f=i.position;f[0]=f[1]=f[2]=0;for(var h=0;h<2;++h)for(var p=h?s:1-s,d=0;d<2;++d)for(var m=o+h,g=c+d,y=p*(d?u:1-u),x=0;x<3;++x)f[x]+=this._field[x].get(m,g)*y;for(var b=this._pickResult.level,_=0;_<3;++_)if(b[_]=v.le(this.contourLevels[_],f[_]),b[_]<0)this.contourLevels[_].length>0&&(b[_]=0);else if(b[_]<this.contourLevels[_].length-1){var w=this.contourLevels[_][b[_]],T=this.contourLevels[_][b[_]+1];Math.abs(w-f[_])>Math.abs(T-f[_])&&(b[_]+=1)}for(i.index[0]=s<.5?o:o+1,i.index[1]=u<.5?c:c+1,i.uv[0]=a/n[0],i.uv[1]=l/n[1],x=0;x<3;++x)i.dataCoordinate[x]=this._field[x].get(i.index[0],i.index[1]);return i},L.padField=function(r,n){var i=n.shape.slice(),a=r.shape.slice();f.assign(r.lo(1,1).hi(i[0],i[1]),n),f.assign(r.lo(1).hi(i[0],1),n.hi(i[0],1)),f.assign(r.lo(1,a[1]-1).hi(i[0],1),n.lo(0,i[1]-1).hi(i[0],1)),f.assign(r.lo(0,1).hi(1,i[1]),n.hi(1)),f.assign(r.lo(a[0]-1,1).hi(1,i[1]),n.lo(i[0]-1)),r.set(0,0,n.get(0,0)),r.set(0,a[1]-1,n.get(0,i[1]-1)),r.set(a[0]-1,0,n.get(i[0]-1,0)),r.set(a[0]-1,a[1]-1,n.get(i[0]-1,i[1]-1))},L.update=function(r){r=r||{},this.objectOffset=r.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in r&&(this.contourWidth=B(r.contourWidth,Number)),"showContour"in r&&(this.showContour=B(r.showContour,Boolean)),"showSurface"in r&&(this.showSurface=!!r.showSurface),"contourTint"in r&&(this.contourTint=B(r.contourTint,Boolean)),"contourColor"in r&&(this.contourColor=j(r.contourColor)),"contourProject"in r&&(this.contourProject=B(r.contourProject,function(r){return B(r,Boolean)})),"surfaceProject"in r&&(this.surfaceProject=r.surfaceProject),"dynamicColor"in r&&(this.dynamicColor=j(r.dynamicColor)),"dynamicTint"in r&&(this.dynamicTint=B(r.dynamicTint,Number)),"dynamicWidth"in r&&(this.dynamicWidth=B(r.dynamicWidth,Number)),"opacity"in r&&(this.opacity=r.opacity),"opacityscale"in r&&(this.opacityscale=r.opacityscale),"colorBounds"in r&&(this.colorBounds=r.colorBounds),"vertexColor"in r&&(this.vertexColor=r.vertexColor?1:0),"colormap"in r&&this._colorMap.setPixels(this.genColormap(r.colormap,this.opacityscale));var n=r.field||r.coords&&r.coords[2]||null,i=!1;if(n||(n=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in r||"coords"in r){var o=(n.shape[0]+2)*(n.shape[1]+2);o>this._field[2].data.length&&(c.freeFloat(this._field[2].data),this._field[2].data=c.mallocFloat(a.nextPow2(o))),this._field[2]=p(this._field[2].data,[n.shape[0]+2,n.shape[1]+2]),this.padField(this._field[2],n),this.shape=n.shape.slice();for(var s=this.shape,l=0;l<2;++l)this._field[2].size>this._field[l].data.length&&(c.freeFloat(this._field[l].data),this._field[l].data=c.mallocFloat(this._field[2].size)),this._field[l]=p(this._field[l].data,[s[0]+2,s[1]+2]);if(r.coords){var u=r.coords;if(!Array.isArray(u)||3!==u.length)throw Error("gl-surface: invalid coordinates for x/y");for(l=0;l<2;++l){var f=u[l];for(x=0;x<2;++x)if(f.shape[x]!==s[x])throw Error("gl-surface: coords have incorrect shape");this.padField(this._field[l],f)}}else if(r.ticks){var h=r.ticks;if(!Array.isArray(h)||2!==h.length)throw Error("gl-surface: invalid ticks");for(l=0;l<2;++l){var m=h[l];if((Array.isArray(m)||m.length)&&(m=p(m)),m.shape[0]!==s[l])throw Error("gl-surface: invalid tick length");var g=p(m.data,s);g.stride[l]=m.stride[0],g.stride[1^l]=0,this.padField(this._field[l],g)}}else{for(l=0;l<2;++l){var v=[0,0];v[l]=1,this._field[l]=p(this._field[l].data,[s[0]+2,s[1]+2],v,0)}this._field[0].set(0,0,0);for(var x=0;x<s[0];++x)this._field[0].set(x+1,0,x);for(this._field[0].set(s[0]+1,0,s[0]-1),this._field[1].set(0,0,0),x=0;x<s[1];++x)this._field[1].set(0,x+1,x);this._field[1].set(0,s[1]+1,s[1]-1)}var b=this._field,_=p(c.mallocFloat(3*b[2].size*2),[3,s[0]+2,s[1]+2,2]);for(l=0;l<3;++l)y(_.pick(l),b[l],"mirror");var w=p(c.mallocFloat(3*b[2].size),[s[0]+2,s[1]+2,3]);for(l=0;l<s[0]+2;++l)for(x=0;x<s[1]+2;++x){var T=_.get(0,l,x,0),k=_.get(0,l,x,1),M=_.get(1,l,x,0),S=_.get(1,l,x,1),E=_.get(2,l,x,0),L=_.get(2,l,x,1),C=M*L-S*E,P=E*k-L*T,I=T*S-k*M,O=Math.sqrt(C*C+P*P+I*I);O<1e-8?(O=Math.max(Math.abs(C),Math.abs(P),Math.abs(I)))<1e-8?(I=1,P=C=0,O=1):O=1/O:O=1/Math.sqrt(O),w.set(l,x,0,C*O),w.set(l,x,1,P*O),w.set(l,x,2,I*O)}c.free(_.data);var z=[1/0,1/0,1/0],D=[-1/0,-1/0,-1/0],R=1/0,F=-1/0,N=(s[0]-1)*(s[1]-1)*6,U=c.mallocFloat(a.nextPow2(10*N)),V=0,H=0;for(l=0;l<s[0]-1;++l)t:for(x=0;x<s[1]-1;++x){for(var q=0;q<2;++q)for(var G=0;G<2;++G)for(var Y=0;Y<3;++Y){var W=this._field[Y].get(1+l+q,1+x+G);if(isNaN(W)||!isFinite(W))continue t}for(Y=0;Y<6;++Y){var X=l+A[Y][0],Z=x+A[Y][1],J=this._field[0].get(X+1,Z+1),K=this._field[1].get(X+1,Z+1);W=this._field[2].get(X+1,Z+1),C=w.get(X+1,Z+1,0),P=w.get(X+1,Z+1,1),I=w.get(X+1,Z+1,2),r.intensity&&(Q=r.intensity.get(X,Z));var Q=r.intensity?r.intensity.get(X,Z):W+this.objectOffset[2];U[V++]=X,U[V++]=Z,U[V++]=J,U[V++]=K,U[V++]=W,U[V++]=0,U[V++]=Q,U[V++]=C,U[V++]=P,U[V++]=I,z[0]=Math.min(z[0],J+this.objectOffset[0]),z[1]=Math.min(z[1],K+this.objectOffset[1]),z[2]=Math.min(z[2],W+this.objectOffset[2]),R=Math.min(R,Q),D[0]=Math.max(D[0],J+this.objectOffset[0]),D[1]=Math.max(D[1],K+this.objectOffset[1]),D[2]=Math.max(D[2],W+this.objectOffset[2]),F=Math.max(F,Q),H+=1}}for(r.intensityBounds&&(R=+r.intensityBounds[0],F=+r.intensityBounds[1]),l=6;l<V;l+=10)U[l]=(U[l]-R)/(F-R);this._vertexCount=H,this._coordinateBuffer.update(U.subarray(0,V)),c.freeFloat(U),c.free(w.data),this.bounds=[z,D],this.intensity=r.intensity||this._field[2],this.intensityBounds[0]===R&&this.intensityBounds[1]===F||(i=!0),this.intensityBounds=[R,F]}if("levels"in r){var $=r.levels;for($=Array.isArray($[0])?$.slice():[[],[],$],l=0;l<3;++l)$[l]=$[l].slice(),$[l].sort(function(r,n){return r-n});for(l=0;l<3;++l)for(x=0;x<$[l].length;++x)$[l][x]-=this.objectOffset[l];t:for(l=0;l<3;++l){if($[l].length!==this.contourLevels[l].length){i=!0;break}for(x=0;x<$[l].length;++x)if($[l][x]!==this.contourLevels[l][x]){i=!0;break t}}this.contourLevels=$}if(i){b=this._field,s=this.shape;for(var tt=[],te=0;te<3;++te){var tr=this.contourLevels[te],tn=[],ti=[],ta=[0,0,0];for(l=0;l<tr.length;++l){var to=d(this._field[te],tr[l]);tn.push(tt.length/5|0),H=0;t:for(x=0;x<to.cells.length;++x){var ts=to.cells[x];for(Y=0;Y<2;++Y){var tl=to.positions[ts[Y]],tc=tl[0],tu=0|Math.floor(tc),tf=tc-tu,th=tl[1],tp=0|Math.floor(th),td=th-tp,tm=!1;e:for(var tg=0;tg<3;++tg){ta[tg]=0;var tv=(te+tg+1)%3;for(q=0;q<2;++q){var ty=q?tf:1-tf;for(X=0|Math.min(Math.max(tu+q,0),s[0]),G=0;G<2;++G){var tx=G?td:1-td;if(Z=0|Math.min(Math.max(tp+G,0),s[1]),!isFinite(W=tg<2?this._field[tv].get(X,Z):(this.intensity.get(X,Z)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]))||isNaN(W)){tm=!0;break e}var tb=ty*tx;ta[tg]+=tb*W}}}if(tm){if(Y>0){for(var t_=0;t_<5;++t_)tt.pop();H-=1}continue t}tt.push(ta[0],ta[1],tl[0],tl[1],ta[2]),H+=1}}ti.push(H)}this._contourOffsets[te]=tn,this._contourCounts[te]=ti}var tw=c.mallocFloat(tt.length);for(l=0;l<tt.length;++l)tw[l]=tt[l];this._contourBuffer.update(tw),c.freeFloat(tw)}},L.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var r=0;r<3;++r)c.freeFloat(this._field[r].data)},L.highlight=function(r){var n,i;if(!r)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(n=0;n<3;++n)this.enableHighlight[n]?this.highlightLevel[n]=r.level[n]:this.highlightLevel[n]=-1;for(i=this.snapToData?r.dataCoordinate:r.position,n=0;n<3;++n)i[n]-=this.objectOffset[n];if(this.enableDynamic[0]&&i[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&i[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&i[2]!==this.dynamicLevel[2]){for(var a=0,o=this.shape,s=c.mallocFloat(12*o[0]*o[1]),l=0;l<3;++l)if(this.enableDynamic[l]){this.dynamicLevel[l]=i[l];var u=(l+1)%3,f=(l+2)%3,h=this._field[l],p=this._field[u],m=this._field[f],g=d(h,i[l]),v=g.cells,y=g.positions;for(this._dynamicOffsets[l]=a,n=0;n<v.length;++n)for(var x=v[n],b=0;b<2;++b){var _=y[x[b]],w=+_[0],T=0|w,k=0|Math.min(T+1,o[0]),A=w-T,M=1-A,S=+_[1],E=0|S,L=0|Math.min(E+1,o[1]),C=S-E,P=1-C,I=M*P,O=M*C,z=A*P,D=A*C,R=I*p.get(T,E)+O*p.get(T,L)+z*p.get(k,E)+D*p.get(k,L),F=I*m.get(T,E)+O*m.get(T,L)+z*m.get(k,E)+D*m.get(k,L);if(isNaN(R)||isNaN(F)){b&&(a-=1);break}s[2*a+0]=R,s[2*a+1]=F,a+=1}this._dynamicCounts[l]=a-this._dynamicOffsets[l]}else this.dynamicLevel[l]=NaN,this._dynamicCounts[l]=0;this._dynamicBuffer.update(s.subarray(0,2*a)),c.freeFloat(s)}}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(r,n,i){"use strict";var a=r("ndarray"),o=r("ndarray-ops"),s=r("typedarray-pool");n.exports=function(r){if(arguments.length<=1)throw Error("gl-texture2d: Missing arguments for texture2d constructor");if(l||(l=[r.LINEAR,r.NEAREST_MIPMAP_LINEAR,r.LINEAR_MIPMAP_NEAREST,r.LINEAR_MIPMAP_NEAREST],c=[r.NEAREST,r.LINEAR,r.NEAREST_MIPMAP_NEAREST,r.NEAREST_MIPMAP_LINEAR,r.LINEAR_MIPMAP_NEAREST,r.LINEAR_MIPMAP_LINEAR],u=[r.REPEAT,r.CLAMP_TO_EDGE,r.MIRRORED_REPEAT]),"number"==typeof arguments[1])return y(r,arguments[1],arguments[2],arguments[3]||r.RGBA,arguments[4]||r.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return y(r,0|arguments[1][0],0|arguments[1][1],arguments[2]||r.RGBA,arguments[3]||r.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var n,i,p,m,x,b=arguments[1],_=f(b)?b:b.raw;if(_)return n=0|b.width,i=0|b.height,p=arguments[2]||r.RGBA,m=arguments[3]||r.UNSIGNED_BYTE,x=v(r),r.texImage2D(r.TEXTURE_2D,0,p,p,m,_),new d(r,x,n,i,p,m);if(b.shape&&b.data&&b.stride)return function(r,n){var i=n.dtype,l=n.shape.slice(),c=r.getParameter(r.MAX_TEXTURE_SIZE);if(l[0]<0||l[0]>c||l[1]<0||l[1]>c)throw Error("gl-texture2d: Invalid texture size");var u=g(l,n.stride.slice()),f=0;"float32"===i?f=r.FLOAT:"float64"===i?(f=r.FLOAT,u=!1,i="float32"):"uint8"===i?f=r.UNSIGNED_BYTE:(f=r.UNSIGNED_BYTE,u=!1,i="uint8");var p,m,y=0;if(2===l.length)y=r.LUMINANCE,l=[l[0],l[1],1],n=a(n.data,l,[n.stride[0],n.stride[1],1],n.offset);else{if(3!==l.length)throw Error("gl-texture2d: Invalid shape for texture");if(1===l[2])y=r.ALPHA;else if(2===l[2])y=r.LUMINANCE_ALPHA;else if(3===l[2])y=r.RGB;else{if(4!==l[2])throw Error("gl-texture2d: Invalid shape for pixel coords");y=r.RGBA}}f!==r.FLOAT||r.getExtension("OES_texture_float")||(f=r.UNSIGNED_BYTE,u=!1);var x=n.size;if(u)p=0===n.offset&&n.data.length===x?n.data:n.data.subarray(n.offset,n.offset+x);else{var b=[l[2],l[2]*l[0],1],_=a(m=s.malloc(x,i),l,b,0);"float32"!==i&&"float64"!==i||f!==r.UNSIGNED_BYTE?o.assign(_,n):h(_,n),p=m.subarray(0,x)}var w=v(r);return r.texImage2D(r.TEXTURE_2D,0,y,l[0],l[1],0,y,f,p),u||s.free(m),new d(r,w,l[0],l[1],y,f)}(r,b)}throw Error("gl-texture2d: Invalid arguments for texture2d constructor")};var l=null,c=null,u=null;function f(r){return"undefined"!=typeof HTMLCanvasElement&&r instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&r instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&r instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&r instanceof ImageData}var h=function(r,n){o.muls(r,n,255)};function p(r,n,i){var a=r.gl,o=a.getParameter(a.MAX_TEXTURE_SIZE);if(n<0||n>o||i<0||i>o)throw Error("gl-texture2d: Invalid texture size");return r._shape=[n,i],r.bind(),a.texImage2D(a.TEXTURE_2D,0,r.format,n,i,0,r.format,r.type,null),r._mipLevels=[0],r}function d(r,n,i,a,o,s){this.gl=r,this.handle=n,this.format=o,this.type=s,this._shape=[i,a],this._mipLevels=[0],this._magFilter=r.NEAREST,this._minFilter=r.NEAREST,this._wrapS=r.CLAMP_TO_EDGE,this._wrapT=r.CLAMP_TO_EDGE,this._anisoSamples=1;var l=this,c=[this._wrapS,this._wrapT];Object.defineProperties(c,[{get:function(){return l._wrapS},set:function(r){return l.wrapS=r}},{get:function(){return l._wrapT},set:function(r){return l.wrapT=r}}]),this._wrapVector=c;var u=[this._shape[0],this._shape[1]];Object.defineProperties(u,[{get:function(){return l._shape[0]},set:function(r){return l.width=r}},{get:function(){return l._shape[1]},set:function(r){return l.height=r}}]),this._shapeVector=u}var m=d.prototype;function g(r,n){return 3===r.length?1===n[2]&&n[1]===r[0]*r[2]&&n[0]===r[2]:1===n[0]&&n[1]===r[0]}function v(r){var n=r.createTexture();return r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),n}function y(r,n,i,a,o){var s=r.getParameter(r.MAX_TEXTURE_SIZE);if(n<0||n>s||i<0||i>s)throw Error("gl-texture2d: Invalid texture shape");if(o===r.FLOAT&&!r.getExtension("OES_texture_float"))throw Error("gl-texture2d: Floating point textures not supported on this platform");var l=v(r);return r.texImage2D(r.TEXTURE_2D,0,a,n,i,0,a,o,null),new d(r,l,n,i,a,o)}Object.defineProperties(m,{minFilter:{get:function(){return this._minFilter},set:function(r){this.bind();var n=this.gl;if(this.type===n.FLOAT&&l.indexOf(r)>=0&&(n.getExtension("OES_texture_float_linear")||(r=n.NEAREST)),0>c.indexOf(r))throw Error("gl-texture2d: Unknown filter mode "+r);return n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r),this._minFilter=r}},magFilter:{get:function(){return this._magFilter},set:function(r){this.bind();var n=this.gl;if(this.type===n.FLOAT&&l.indexOf(r)>=0&&(n.getExtension("OES_texture_float_linear")||(r=n.NEAREST)),0>c.indexOf(r))throw Error("gl-texture2d: Unknown filter mode "+r);return n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,r),this._magFilter=r}},mipSamples:{get:function(){return this._anisoSamples},set:function(r){var n=this._anisoSamples;if(this._anisoSamples=0|Math.max(r,1),n!==this._anisoSamples){var i=this.gl.getExtension("EXT_texture_filter_anisotropic");i&&this.gl.texParameterf(this.gl.TEXTURE_2D,i.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(r){if(this.bind(),0>u.indexOf(r))throw Error("gl-texture2d: Unknown wrap mode "+r);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,r),this._wrapS=r}},wrapT:{get:function(){return this._wrapT},set:function(r){if(this.bind(),0>u.indexOf(r))throw Error("gl-texture2d: Unknown wrap mode "+r);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,r),this._wrapT=r}},wrap:{get:function(){return this._wrapVector},set:function(r){if(Array.isArray(r)||(r=[r,r]),2!==r.length)throw Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var n=0;n<2;++n)if(0>u.indexOf(r[n]))throw Error("gl-texture2d: Unknown wrap mode "+r);this._wrapS=r[0],this._wrapT=r[1];var i=this.gl;return this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,this._wrapS),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,this._wrapT),r}},shape:{get:function(){return this._shapeVector},set:function(r){if(Array.isArray(r)){if(2!==r.length)throw Error("gl-texture2d: Invalid texture shape")}else r=[0|r,0|r];return p(this,0|r[0],0|r[1]),[0|r[0],0|r[1]]}},width:{get:function(){return this._shape[0]},set:function(r){return p(this,r|=0,this._shape[1]),r}},height:{get:function(){return this._shape[1]},set:function(r){return r|=0,p(this,this._shape[0],r),r}}}),m.bind=function(r){var n=this.gl;return void 0!==r&&n.activeTexture(n.TEXTURE0+(0|r)),n.bindTexture(n.TEXTURE_2D,this.handle),void 0!==r?0|r:n.getParameter(n.ACTIVE_TEXTURE)-n.TEXTURE0},m.dispose=function(){this.gl.deleteTexture(this.handle)},m.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var r=Math.min(this._shape[0],this._shape[1]),n=0;r>0;++n,r>>>=1)0>this._mipLevels.indexOf(n)&&this._mipLevels.push(n)},m.setPixels=function(r,n,i,l){var c=this.gl;this.bind(),Array.isArray(n)?(l=i,i=0|n[1],n=0|n[0]):(n=n||0,i=i||0),l=l||0;var u=f(r)?r:r.raw;if(u)0>this._mipLevels.indexOf(l)?(c.texImage2D(c.TEXTURE_2D,0,this.format,this.format,this.type,u),this._mipLevels.push(l)):c.texSubImage2D(c.TEXTURE_2D,l,n,i,this.format,this.type,u);else{if(!(r.shape&&r.stride&&r.data))throw Error("gl-texture2d: Unsupported data type");if(r.shape.length<2||n+r.shape[1]>this._shape[1]>>>l||i+r.shape[0]>this._shape[0]>>>l||n<0||i<0)throw Error("gl-texture2d: Texture dimensions are out of bounds");!function(r,n,i,l,c,u,f,p){var d=p.dtype,m=p.shape.slice();if(m.length<2||m.length>3)throw Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var v=0,y=0,x=g(m,p.stride.slice());if("float32"===d?v=r.FLOAT:"float64"===d?(v=r.FLOAT,x=!1,d="float32"):"uint8"===d?v=r.UNSIGNED_BYTE:(v=r.UNSIGNED_BYTE,x=!1,d="uint8"),2===m.length)y=r.LUMINANCE,m=[m[0],m[1],1],p=a(p.data,m,[p.stride[0],p.stride[1],1],p.offset);else{if(3!==m.length)throw Error("gl-texture2d: Invalid shape for texture");if(1===m[2])y=r.ALPHA;else if(2===m[2])y=r.LUMINANCE_ALPHA;else if(3===m[2])y=r.RGB;else{if(4!==m[2])throw Error("gl-texture2d: Invalid shape for pixel coords");y=r.RGBA}m[2]}if(y!==r.LUMINANCE&&y!==r.ALPHA||c!==r.LUMINANCE&&c!==r.ALPHA||(y=c),y!==c)throw Error("gl-texture2d: Incompatible texture format for setPixels");var b=p.size,_=0>f.indexOf(l);if(_&&f.push(l),v===u&&x)0===p.offset&&p.data.length===b?_?r.texImage2D(r.TEXTURE_2D,l,c,m[0],m[1],0,c,u,p.data):r.texSubImage2D(r.TEXTURE_2D,l,n,i,m[0],m[1],c,u,p.data):_?r.texImage2D(r.TEXTURE_2D,l,c,m[0],m[1],0,c,u,p.data.subarray(p.offset,p.offset+b)):r.texSubImage2D(r.TEXTURE_2D,l,n,i,m[0],m[1],c,u,p.data.subarray(p.offset,p.offset+b));else{var w,T=a(w=u===r.FLOAT?s.mallocFloat32(b):s.mallocUint8(b),m,[m[2],m[2]*m[0],1]);v===r.FLOAT&&u===r.UNSIGNED_BYTE?h(T,p):o.assign(T,p),_?r.texImage2D(r.TEXTURE_2D,l,c,m[0],m[1],0,c,u,w.subarray(0,b)):r.texSubImage2D(r.TEXTURE_2D,l,n,i,m[0],m[1],c,u,w.subarray(0,b)),u===r.FLOAT?s.freeFloat32(w):s.freeUint8(w)}}(c,n,i,l,this.format,this.type,this._mipLevels,r)}}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(r,n,i){"use strict";n.exports=function(r,n,i){n?n.bind():r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null);var a=0|r.getParameter(r.MAX_VERTEX_ATTRIBS);if(i){if(i.length>a)throw Error("gl-vao: Too many vertex attributes");for(var o=0;o<i.length;++o){var s=i[o];if(s.buffer){var l=s.buffer,c=s.size||4,u=s.type||r.FLOAT,f=!!s.normalized,h=s.stride||0,p=s.offset||0;l.bind(),r.enableVertexAttribArray(o),r.vertexAttribPointer(o,c,u,f,h,p)}else{if("number"==typeof s)r.vertexAttrib1f(o,s);else if(1===s.length)r.vertexAttrib1f(o,s[0]);else if(2===s.length)r.vertexAttrib2f(o,s[0],s[1]);else if(3===s.length)r.vertexAttrib3f(o,s[0],s[1],s[2]);else{if(4!==s.length)throw Error("gl-vao: Invalid vertex attribute");r.vertexAttrib4f(o,s[0],s[1],s[2],s[3])}r.disableVertexAttribArray(o)}}for(;o<a;++o)r.disableVertexAttribArray(o)}else for(r.bindBuffer(r.ARRAY_BUFFER,null),o=0;o<a;++o)r.disableVertexAttribArray(o)}},{}],148:[function(r,n,i){"use strict";var a=r("./do-bind.js");function o(r){this.gl=r,this._elements=null,this._attributes=null,this._elementsType=r.UNSIGNED_SHORT}o.prototype.bind=function(){a(this.gl,this._elements,this._attributes)},o.prototype.update=function(r,n,i){this._elements=n,this._attributes=r,this._elementsType=i||this.gl.UNSIGNED_SHORT},o.prototype.dispose=function(){},o.prototype.unbind=function(){},o.prototype.draw=function(r,n,i){i=i||0;var a=this.gl;this._elements?a.drawElements(r,n,this._elementsType,i):a.drawArrays(r,i,n)},n.exports=function(r){return new o(r)}},{"./do-bind.js":147}],149:[function(r,n,i){"use strict";var a=r("./do-bind.js");function o(r,n,i,a,o,s){this.location=r,this.dimension=n,this.a=i,this.b=a,this.c=o,this.d=s}function s(r,n,i){this.gl=r,this._ext=n,this.handle=i,this._attribs=[],this._useElements=!1,this._elementsType=r.UNSIGNED_SHORT}o.prototype.bind=function(r){switch(this.dimension){case 1:r.vertexAttrib1f(this.location,this.a);break;case 2:r.vertexAttrib2f(this.location,this.a,this.b);break;case 3:r.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:r.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},s.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var r=0;r<this._attribs.length;++r)this._attribs[r].bind(this.gl)},s.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},s.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},s.prototype.update=function(r,n,i){if(this.bind(),a(this.gl,n,r),this.unbind(),this._attribs.length=0,r)for(var s=0;s<r.length;++s){var l=r[s];"number"==typeof l?this._attribs.push(new o(s,1,l)):Array.isArray(l)&&this._attribs.push(new o(s,l.length,l[0],l[1],l[2],l[3]))}this._useElements=!!n,this._elementsType=i||this.gl.UNSIGNED_SHORT},s.prototype.draw=function(r,n,i){i=i||0;var a=this.gl;this._useElements?a.drawElements(r,n,this._elementsType,i):a.drawArrays(r,i,n)},n.exports=function(r,n){return new s(r,n,n.createVertexArrayOES())}},{"./do-bind.js":147}],150:[function(r,n,i){"use strict";var a=r("./lib/vao-native.js"),o=r("./lib/vao-emulated.js");function s(r){this.bindVertexArrayOES=r.bindVertexArray.bind(r),this.createVertexArrayOES=r.createVertexArray.bind(r),this.deleteVertexArrayOES=r.deleteVertexArray.bind(r)}n.exports=function(r,n,i,l){var c,u=r.createVertexArray?new s(r):r.getExtension("OES_vertex_array_object");return(c=u?a(r,u):o(r)).update(n,i,l),c}},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]+i[0],r[1]=n[1]+i[1],r[2]=n[2]+i[2],r}},{}],152:[function(r,n,i){n.exports=function(r,n){var i=a(r[0],r[1],r[2]),l=a(n[0],n[1],n[2]);o(i,i),o(l,l);var c=s(i,l);return c>1?0:Math.acos(c)};var a=r("./fromValues"),o=r("./normalize"),s=r("./dot")},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(r,n,i){n.exports=function(r,n){return r[0]=Math.ceil(n[0]),r[1]=Math.ceil(n[1]),r[2]=Math.ceil(n[2]),r}},{}],154:[function(r,n,i){n.exports=function(r){var n=new Float32Array(3);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n}},{}],155:[function(r,n,i){n.exports=function(r,n){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r}},{}],156:[function(r,n,i){n.exports=function(){var r=new Float32Array(3);return r[0]=0,r[1]=0,r[2]=0,r}},{}],157:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=i[0],c=i[1],u=i[2];return r[0]=o*u-s*c,r[1]=s*l-a*u,r[2]=a*c-o*l,r}},{}],158:[function(r,n,i){n.exports=r("./distance")},{"./distance":159}],159:[function(r,n,i){n.exports=function(r,n){var i=n[0]-r[0],a=n[1]-r[1],o=n[2]-r[2];return Math.sqrt(i*i+a*a+o*o)}},{}],160:[function(r,n,i){n.exports=r("./divide")},{"./divide":161}],161:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]/i[0],r[1]=n[1]/i[1],r[2]=n[2]/i[2],r}},{}],162:[function(r,n,i){n.exports=function(r,n){return r[0]*n[0]+r[1]*n[1]+r[2]*n[2]}},{}],163:[function(r,n,i){n.exports=1e-6},{}],164:[function(r,n,i){n.exports=function(r,n){var i=r[0],o=r[1],s=r[2],l=n[0],c=n[1],u=n[2];return Math.abs(i-l)<=a*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-c)<=a*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-u)<=a*Math.max(1,Math.abs(s),Math.abs(u))};var a=r("./epsilon")},{"./epsilon":163}],165:[function(r,n,i){n.exports=function(r,n){return r[0]===n[0]&&r[1]===n[1]&&r[2]===n[2]}},{}],166:[function(r,n,i){n.exports=function(r,n){return r[0]=Math.floor(n[0]),r[1]=Math.floor(n[1]),r[2]=Math.floor(n[2]),r}},{}],167:[function(r,n,i){n.exports=function(r,n,i,o,s,l){var c,u;for(n||(n=3),i||(i=0),u=o?Math.min(o*n+i,r.length):r.length,c=i;c<u;c+=n)a[0]=r[c],a[1]=r[c+1],a[2]=r[c+2],s(a,a,l),r[c]=a[0],r[c+1]=a[1],r[c+2]=a[2];return r};var a=r("./create")()},{"./create":156}],168:[function(r,n,i){n.exports=function(r,n,i){var a=new Float32Array(3);return a[0]=r,a[1]=n,a[2]=i,a}},{}],169:[function(r,n,i){n.exports={EPSILON:r("./epsilon"),create:r("./create"),clone:r("./clone"),angle:r("./angle"),fromValues:r("./fromValues"),copy:r("./copy"),set:r("./set"),equals:r("./equals"),exactEquals:r("./exactEquals"),add:r("./add"),subtract:r("./subtract"),sub:r("./sub"),multiply:r("./multiply"),mul:r("./mul"),divide:r("./divide"),div:r("./div"),min:r("./min"),max:r("./max"),floor:r("./floor"),ceil:r("./ceil"),round:r("./round"),scale:r("./scale"),scaleAndAdd:r("./scaleAndAdd"),distance:r("./distance"),dist:r("./dist"),squaredDistance:r("./squaredDistance"),sqrDist:r("./sqrDist"),length:r("./length"),len:r("./len"),squaredLength:r("./squaredLength"),sqrLen:r("./sqrLen"),negate:r("./negate"),inverse:r("./inverse"),normalize:r("./normalize"),dot:r("./dot"),cross:r("./cross"),lerp:r("./lerp"),random:r("./random"),transformMat4:r("./transformMat4"),transformMat3:r("./transformMat3"),transformQuat:r("./transformQuat"),rotateX:r("./rotateX"),rotateY:r("./rotateY"),rotateZ:r("./rotateZ"),forEach:r("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(r,n,i){n.exports=function(r,n){return r[0]=1/n[0],r[1]=1/n[1],r[2]=1/n[2],r}},{}],171:[function(r,n,i){n.exports=r("./length")},{"./length":172}],172:[function(r,n,i){n.exports=function(r){var n=r[0],i=r[1],a=r[2];return Math.sqrt(n*n+i*i+a*a)}},{}],173:[function(r,n,i){n.exports=function(r,n,i,a){var o=n[0],s=n[1],l=n[2];return r[0]=o+a*(i[0]-o),r[1]=s+a*(i[1]-s),r[2]=l+a*(i[2]-l),r}},{}],174:[function(r,n,i){n.exports=function(r,n,i){return r[0]=Math.max(n[0],i[0]),r[1]=Math.max(n[1],i[1]),r[2]=Math.max(n[2],i[2]),r}},{}],175:[function(r,n,i){n.exports=function(r,n,i){return r[0]=Math.min(n[0],i[0]),r[1]=Math.min(n[1],i[1]),r[2]=Math.min(n[2],i[2]),r}},{}],176:[function(r,n,i){n.exports=r("./multiply")},{"./multiply":177}],177:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]*i[0],r[1]=n[1]*i[1],r[2]=n[2]*i[2],r}},{}],178:[function(r,n,i){n.exports=function(r,n){return r[0]=-n[0],r[1]=-n[1],r[2]=-n[2],r}},{}],179:[function(r,n,i){n.exports=function(r,n){var i=n[0],a=n[1],o=n[2],s=i*i+a*a+o*o;return s>0&&(s=1/Math.sqrt(s),r[0]=n[0]*s,r[1]=n[1]*s,r[2]=n[2]*s),r}},{}],180:[function(r,n,i){n.exports=function(r,n){var i=2*Math.random()*Math.PI,a=2*Math.random()-1,o=Math.sqrt(1-a*a)*(n=n||1);return r[0]=Math.cos(i)*o,r[1]=Math.sin(i)*o,r[2]=a*n,r}},{}],181:[function(r,n,i){n.exports=function(r,n,i,a){var o=i[1],s=i[2],l=n[1]-o,c=n[2]-s,u=Math.sin(a),f=Math.cos(a);return r[0]=n[0],r[1]=o+l*f-c*u,r[2]=s+l*u+c*f,r}},{}],182:[function(r,n,i){n.exports=function(r,n,i,a){var o=i[0],s=i[2],l=n[0]-o,c=n[2]-s,u=Math.sin(a),f=Math.cos(a);return r[0]=o+c*u+l*f,r[1]=n[1],r[2]=s+c*f-l*u,r}},{}],183:[function(r,n,i){n.exports=function(r,n,i,a){var o=i[0],s=i[1],l=n[0]-o,c=n[1]-s,u=Math.sin(a),f=Math.cos(a);return r[0]=o+l*f-c*u,r[1]=s+l*u+c*f,r[2]=n[2],r}},{}],184:[function(r,n,i){n.exports=function(r,n){return r[0]=Math.round(n[0]),r[1]=Math.round(n[1]),r[2]=Math.round(n[2]),r}},{}],185:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r}},{}],186:[function(r,n,i){n.exports=function(r,n,i,a){return r[0]=n[0]+i[0]*a,r[1]=n[1]+i[1]*a,r[2]=n[2]+i[2]*a,r}},{}],187:[function(r,n,i){n.exports=function(r,n,i,a){return r[0]=n,r[1]=i,r[2]=a,r}},{}],188:[function(r,n,i){n.exports=r("./squaredDistance")},{"./squaredDistance":190}],189:[function(r,n,i){n.exports=r("./squaredLength")},{"./squaredLength":191}],190:[function(r,n,i){n.exports=function(r,n){var i=n[0]-r[0],a=n[1]-r[1],o=n[2]-r[2];return i*i+a*a+o*o}},{}],191:[function(r,n,i){n.exports=function(r){var n=r[0],i=r[1],a=r[2];return n*n+i*i+a*a}},{}],192:[function(r,n,i){n.exports=r("./subtract")},{"./subtract":193}],193:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]-i[0],r[1]=n[1]-i[1],r[2]=n[2]-i[2],r}},{}],194:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2];return r[0]=a*i[0]+o*i[3]+s*i[6],r[1]=a*i[1]+o*i[4]+s*i[7],r[2]=a*i[2]+o*i[5]+s*i[8],r}},{}],195:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=i[3]*a+i[7]*o+i[11]*s+i[15];return l=l||1,r[0]=(i[0]*a+i[4]*o+i[8]*s+i[12])/l,r[1]=(i[1]*a+i[5]*o+i[9]*s+i[13])/l,r[2]=(i[2]*a+i[6]*o+i[10]*s+i[14])/l,r}},{}],196:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=i[0],c=i[1],u=i[2],f=i[3],h=f*a+c*s-u*o,p=f*o+u*a-l*s,d=f*s+l*o-c*a,m=-l*a-c*o-u*s;return r[0]=h*f+-(m*l)+-(p*u)- -(d*c),r[1]=p*f+-(m*c)+-(d*l)- -(h*u),r[2]=d*f+-(m*u)+-(h*c)- -(p*l),r}},{}],197:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]+i[0],r[1]=n[1]+i[1],r[2]=n[2]+i[2],r[3]=n[3]+i[3],r}},{}],198:[function(r,n,i){n.exports=function(r){var n=new Float32Array(4);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n}},{}],199:[function(r,n,i){n.exports=function(r,n){return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r}},{}],200:[function(r,n,i){n.exports=function(){var r=new Float32Array(4);return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r}},{}],201:[function(r,n,i){n.exports=function(r,n){var i=n[0]-r[0],a=n[1]-r[1],o=n[2]-r[2],s=n[3]-r[3];return Math.sqrt(i*i+a*a+o*o+s*s)}},{}],202:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]/i[0],r[1]=n[1]/i[1],r[2]=n[2]/i[2],r[3]=n[3]/i[3],r}},{}],203:[function(r,n,i){n.exports=function(r,n){return r[0]*n[0]+r[1]*n[1]+r[2]*n[2]+r[3]*n[3]}},{}],204:[function(r,n,i){n.exports=function(r,n,i,a){var o=new Float32Array(4);return o[0]=r,o[1]=n,o[2]=i,o[3]=a,o}},{}],205:[function(r,n,i){n.exports={create:r("./create"),clone:r("./clone"),fromValues:r("./fromValues"),copy:r("./copy"),set:r("./set"),add:r("./add"),subtract:r("./subtract"),multiply:r("./multiply"),divide:r("./divide"),min:r("./min"),max:r("./max"),scale:r("./scale"),scaleAndAdd:r("./scaleAndAdd"),distance:r("./distance"),squaredDistance:r("./squaredDistance"),length:r("./length"),squaredLength:r("./squaredLength"),negate:r("./negate"),inverse:r("./inverse"),normalize:r("./normalize"),dot:r("./dot"),lerp:r("./lerp"),random:r("./random"),transformMat4:r("./transformMat4"),transformQuat:r("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(r,n,i){n.exports=function(r,n){return r[0]=1/n[0],r[1]=1/n[1],r[2]=1/n[2],r[3]=1/n[3],r}},{}],207:[function(r,n,i){n.exports=function(r){var n=r[0],i=r[1],a=r[2],o=r[3];return Math.sqrt(n*n+i*i+a*a+o*o)}},{}],208:[function(r,n,i){n.exports=function(r,n,i,a){var o=n[0],s=n[1],l=n[2],c=n[3];return r[0]=o+a*(i[0]-o),r[1]=s+a*(i[1]-s),r[2]=l+a*(i[2]-l),r[3]=c+a*(i[3]-c),r}},{}],209:[function(r,n,i){n.exports=function(r,n,i){return r[0]=Math.max(n[0],i[0]),r[1]=Math.max(n[1],i[1]),r[2]=Math.max(n[2],i[2]),r[3]=Math.max(n[3],i[3]),r}},{}],210:[function(r,n,i){n.exports=function(r,n,i){return r[0]=Math.min(n[0],i[0]),r[1]=Math.min(n[1],i[1]),r[2]=Math.min(n[2],i[2]),r[3]=Math.min(n[3],i[3]),r}},{}],211:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]*i[0],r[1]=n[1]*i[1],r[2]=n[2]*i[2],r[3]=n[3]*i[3],r}},{}],212:[function(r,n,i){n.exports=function(r,n){return r[0]=-n[0],r[1]=-n[1],r[2]=-n[2],r[3]=-n[3],r}},{}],213:[function(r,n,i){n.exports=function(r,n){var i=n[0],a=n[1],o=n[2],s=n[3],l=i*i+a*a+o*o+s*s;return l>0&&(l=1/Math.sqrt(l),r[0]=i*l,r[1]=a*l,r[2]=o*l,r[3]=s*l),r}},{}],214:[function(r,n,i){var a=r("./normalize"),o=r("./scale");n.exports=function(r,n){return n=n||1,r[0]=Math.random(),r[1]=Math.random(),r[2]=Math.random(),r[3]=Math.random(),a(r,r),o(r,r,n),r}},{"./normalize":213,"./scale":215}],215:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=n[3]*i,r}},{}],216:[function(r,n,i){n.exports=function(r,n,i,a){return r[0]=n[0]+i[0]*a,r[1]=n[1]+i[1]*a,r[2]=n[2]+i[2]*a,r[3]=n[3]+i[3]*a,r}},{}],217:[function(r,n,i){n.exports=function(r,n,i,a,o){return r[0]=n,r[1]=i,r[2]=a,r[3]=o,r}},{}],218:[function(r,n,i){n.exports=function(r,n){var i=n[0]-r[0],a=n[1]-r[1],o=n[2]-r[2],s=n[3]-r[3];return i*i+a*a+o*o+s*s}},{}],219:[function(r,n,i){n.exports=function(r){var n=r[0],i=r[1],a=r[2],o=r[3];return n*n+i*i+a*a+o*o}},{}],220:[function(r,n,i){n.exports=function(r,n,i){return r[0]=n[0]-i[0],r[1]=n[1]-i[1],r[2]=n[2]-i[2],r[3]=n[3]-i[3],r}},{}],221:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=n[3];return r[0]=i[0]*a+i[4]*o+i[8]*s+i[12]*l,r[1]=i[1]*a+i[5]*o+i[9]*s+i[13]*l,r[2]=i[2]*a+i[6]*o+i[10]*s+i[14]*l,r[3]=i[3]*a+i[7]*o+i[11]*s+i[15]*l,r}},{}],222:[function(r,n,i){n.exports=function(r,n,i){var a=n[0],o=n[1],s=n[2],l=i[0],c=i[1],u=i[2],f=i[3],h=f*a+c*s-u*o,p=f*o+u*a-l*s,d=f*s+l*o-c*a,m=-l*a-c*o-u*s;return r[0]=h*f+-(m*l)+-(p*u)- -(d*c),r[1]=p*f+-(m*c)+-(d*l)- -(h*u),r[2]=d*f+-(m*u)+-(h*c)- -(p*l),r[3]=n[3],r}},{}],223:[function(r,n,i){var a=r("glsl-tokenizer"),o=r("atob-lite");n.exports=function(r){for(var n=Array.isArray(r)?r:a(r),i=0;i<n.length;i++){var s=n[i];if("preprocessor"===s.type){var l=s.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(l&&l[2]){var c=l[1],u=l[2];return(c?o(u):u).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(r,n,i){n.exports=function(r){var n,i,f,h=0,p=0,d=999,m=[],g=[],v=1,y=0,x=0,b=!1,_=!1,w="",T=s,k=a;"300 es"===(r=r||{}).version&&(T=c,k=l);var A={},M={};for(h=0;h<T.length;h++)A[T[h]]=!0;for(h=0;h<k.length;h++)M[k[h]]=!0;return function(r){return g=[],null!==r?function(r){var a;for(h=0,r.toString&&(r=r.toString()),w+=r.replace(/\r\n/g,"\n"),f=w.length;n=w[h],h<f;){switch(a=h,d){case 0:"/"===n&&"*"===i?(m.push(n),S(m.join("")),d=999):(m.push(n),i=n),h+=1;break;case 1:case 2:h="\r"!==n&&"\n"!==n||"\\"===i?(m.push(n),i=n,h+1):(S(m.join("")),d=999,h);break;case 3:h=function(){if("."===i&&/\d/.test(n))return d=5,h;if("/"===i&&"*"===n)return d=0,h;if("/"===i&&"/"===n)return d=1,h;if("."===n&&m.length){for(;E(m););return d=5,h}if(";"===n||")"===n||"("===n){if(m.length)for(;E(m););return S(n),d=999,h+1}var r=2===m.length&&"="!==n;if(/[\w_\d\s]/.test(n)||r){for(;E(m););return d=999,h}return m.push(n),i=n,h+1}();break;case 4:h="."===n||/[eE]/.test(n)?(m.push(n),d=5,i=n,h+1):"x"===n&&1===m.length&&"0"===m[0]?(d=11,m.push(n),i=n,h+1):/[^\d]/.test(n)?(S(m.join("")),d=999,h):(m.push(n),i=n,h+1);break;case 11:h=/[^a-fA-F0-9]/.test(n)?(S(m.join("")),d=999,h):(m.push(n),i=n,h+1);break;case 5:"f"===n&&(m.push(n),i=n,h+=1),h=/[eE]/.test(n)?(m.push(n),i=n,h+1):("-"!==n&&"+"!==n||!/[eE]/.test(i))&&/[^\d]/.test(n)?(S(m.join("")),d=999,h):(m.push(n),i=n,h+1);break;case 9999:h=function(){if(/[^\d\w_]/.test(n)){var r=m.join("");return d=M[r]?8:A[r]?7:6,S(m.join("")),d=999,h}return m.push(n),i=n,h+1}();break;case 9:h=/[^\s]/g.test(n)?(S(m.join("")),d=999,h):(m.push(n),i=n,h+1);break;case 999:m=m.length?[]:m,h="/"===i&&"*"===n?(x=p+h-1,d=0,i=n,h+1):"/"===i&&"/"===n?(x=p+h-1,d=1,i=n,h+1):("#"===n?(d=2,x=p+h):/\s/.test(n)?(d=9,x=p+h):(b=/\d/.test(n),_=/[^\w_]/.test(n),x=p+h,d=b?4:_?3:9999),h)}a!==h&&("\n"===w[a]?(y=0,++v):++y)}return p+=h,w=w.slice(h),g}(r):(m.length&&S(m.join("")),d=10,S("(eof)"),g)};function S(r){r.length&&g.push({type:u[d],data:r,position:x,line:v,column:y})}function E(r){for(var n,i,a=0;;){if(n=o.indexOf(r.slice(0,r.length+a).join("")),i=o[n],-1===n){if(a--+r.length>0)continue;i=r.slice(0,1).join("")}return S(i),x+=i.length,(m=m.slice(i.length)).length}}};var a=r("./lib/literals"),o=r("./lib/operators"),s=r("./lib/builtins"),l=r("./lib/literals-300es"),c=r("./lib/builtins-300es"),u=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(r,n,i){var a=r("./builtins");a=a.slice().filter(function(r){return!/^(gl\_|texture)/.test(r)}),n.exports=a.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(r,n,i){n.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(r,n,i){var a=r("./literals");n.exports=a.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(r,n,i){n.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(r,n,i){n.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(r,n,i){var a=r("./index");n.exports=function(r,n){var i=a(n),o=[];return(o=o.concat(i(r))).concat(i(null))}},{"./index":224}],231:[function(r,n,i){n.exports=function(r){"string"==typeof r&&(r=[r]);for(var n=[].slice.call(arguments,1),i=[],a=0;a<r.length-1;a++)i.push(r[a],n[a]||"");return i.push(r[a]),i.join("")}},{}],232:[function(r,n,i){"use strict";var a=r("is-browser");n.exports=a&&function(){var r=!1;try{var n=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("test",null,n),window.removeEventListener("test",null,n)}catch(n){r=!1}return r}()},{"is-browser":236}],233:[function(r,n,i){"use strict";n.exports=function(r,n){var i=r.length;if(0===i)throw Error("Must have at least d+1 points");var o=r[0].length;if(i<=o)throw Error("Must input at least d+1 points");var l=r.slice(0,o+1),c=a.apply(void 0,l);if(0===c)throw Error("Input not in general position");for(var u=Array(o+1),h=0;h<=o;++h)u[h]=h;c<0&&(u[0]=1,u[1]=0);var p=new s(u,Array(o+1),!1),d=p.adjacent,m=Array(o+2);for(h=0;h<=o;++h){for(var g=u.slice(),v=0;v<=o;++v)v===h&&(g[v]=-1);var y=g[0];g[0]=g[1],g[1]=y;var x=new s(g,Array(o+1),!0);d[h]=x,m[h]=x}for(h=0,m[o+1]=p;h<=o;++h){g=d[h].vertices;var b=d[h].adjacent;for(v=0;v<=o;++v){var _=g[v];if(_<0)b[v]=p;else for(var w=0;w<=o;++w)0>d[w].vertices.indexOf(_)&&(b[v]=d[w])}}var T=new f(o,l,m),k=!!n;for(h=o+1;h<i;++h)T.insert(r[h],k);return T.boundary()};var a=r("robust-orientation"),o=r("simplicial-complex").compareCells;function s(r,n,i){this.vertices=r,this.adjacent=n,this.boundary=i,this.lastVisited=-1}function l(r,n,i){this.vertices=r,this.cell=n,this.index=i}function c(r,n){return o(r.vertices,n.vertices)}s.prototype.flip=function(){var r=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=r;var n=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=n};var u=[];function f(r,n,i){this.dimension=r,this.vertices=n,this.simplices=i,this.interior=i.filter(function(r){return!r.boundary}),this.tuple=Array(r+1);for(var o,s=0;s<=r;++s)this.tuple[s]=this.vertices[s];var l,c=u[r];c||(c=u[r]=((l=a[r+1])||(l=a),o=l,function(){var r=this.tuple;return o.apply(this,r)})),this.orient=c}var h=f.prototype;h.handleBoundaryDegeneracy=function(r,n){var i=this.dimension,a=this.vertices.length-1,o=this.tuple,s=this.vertices,l=[r];for(r.lastVisited=-a;l.length>0;)for(var c=(r=l.pop()).adjacent,u=0;u<=i;++u){var f=c[u];if(f.boundary&&!(f.lastVisited<=-a)){for(var h=f.vertices,p=0;p<=i;++p){var d=h[p];o[p]=d<0?n:s[d]}var m=this.orient();if(m>0)return f;f.lastVisited=-a,0===m&&l.push(f)}}return null},h.walk=function(r,n){var i=this.vertices.length-1,a=this.dimension,o=this.vertices,s=this.tuple,l=n?this.interior.length*Math.random()|0:this.interior.length-1,c=this.interior[l];t:for(;!c.boundary;){for(var u=c.vertices,f=c.adjacent,h=0;h<=a;++h)s[h]=o[u[h]];for(h=0,c.lastVisited=i;h<=a;++h){var p=f[h];if(!(p.lastVisited>=i)){var d=s[h];s[h]=r;var m=this.orient();if(s[h]=d,m<0){c=p;continue t}p.boundary?p.lastVisited=-i:p.lastVisited=i}}return}return c},h.addPeaks=function(r,n){var i=this.vertices.length-1,a=this.dimension,o=this.vertices,u=this.tuple,f=this.interior,h=this.simplices,p=[n];n.lastVisited=i,n.vertices[n.vertices.indexOf(-1)]=i,n.boundary=!1,f.push(n);for(var d=[];p.length>0;){var m=(n=p.pop()).vertices,g=n.adjacent,v=m.indexOf(i);if(!(v<0)){for(var y=0;y<=a;++y)if(y!==v){var x=g[y];if(x.boundary&&!(x.lastVisited>=i)){var b=x.vertices;if(x.lastVisited!==-i){for(var _=0,w=0;w<=a;++w)b[w]<0?(_=w,u[w]=r):u[w]=o[b[w]];if(this.orient()>0){b[_]=i,x.boundary=!1,f.push(x),p.push(x),x.lastVisited=i;continue}x.lastVisited=-i}var T=x.adjacent,k=m.slice(),A=g.slice(),M=new s(k,A,!0);h.push(M);var S=T.indexOf(n);if(!(S<0))for(T[S]=M,A[v]=x,k[y]=-1,A[y]=n,g[y]=M,M.flip(),w=0;w<=a;++w){var E=k[w];if(!(E<0||E===i)){for(var L=Array(a-1),C=0,P=0;P<=a;++P){var I=k[P];I<0||P===w||(L[C++]=I)}d.push(new l(L,M,w))}}}}}}for(d.sort(c),y=0;y+1<d.length;y+=2){var O=d[y],z=d[y+1],D=O.index,R=z.index;D<0||R<0||(O.cell.adjacent[O.index]=z.cell,z.cell.adjacent[z.index]=O.cell)}},h.insert=function(r,n){var i=this.vertices;i.push(r);var a=this.walk(r,n);if(a){for(var o=this.dimension,s=this.tuple,l=0;l<=o;++l){var c=a.vertices[l];s[l]=c<0?r:i[c]}var u=this.orient(s);u<0||(0!==u||(a=this.handleBoundaryDegeneracy(a,r)))&&this.addPeaks(r,a)}},h.boundary=function(){for(var r=this.dimension,n=[],i=this.simplices,a=i.length,o=0;o<a;++o){var s=i[o];if(s.boundary){for(var l=Array(r),c=s.vertices,u=0,f=0,h=0;h<=r;++h)c[h]>=0?l[u++]=c[h]:f=1&h;if(f===(1&r)){var p=l[0];l[0]=l[1],l[1]=p}n.push(l)}}return n}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(r,n,i){"use strict";var a=r("binary-search-bounds");function o(r,n,i,a,o){this.mid=r,this.left=n,this.right=i,this.leftPoints=a,this.rightPoints=o,this.count=(n?n.count:0)+(i?i.count:0)+a.length}n.exports=function(r){return new x(r&&0!==r.length?y(r):null)};var s=o.prototype;function l(r,n){r.mid=n.mid,r.left=n.left,r.right=n.right,r.leftPoints=n.leftPoints,r.rightPoints=n.rightPoints,r.count=n.count}function c(r,n){var i=y(n);r.mid=i.mid,r.left=i.left,r.right=i.right,r.leftPoints=i.leftPoints,r.rightPoints=i.rightPoints,r.count=i.count}function u(r,n){var i=r.intervals([]);i.push(n),c(r,i)}function f(r,n){var i=r.intervals([]),a=i.indexOf(n);return a<0?0:(i.splice(a,1),c(r,i),1)}function h(r,n,i){for(var a=0;a<r.length&&r[a][0]<=n;++a){var o=i(r[a]);if(o)return o}}function p(r,n,i){for(var a=r.length-1;a>=0&&r[a][1]>=n;--a){var o=i(r[a]);if(o)return o}}function d(r,n){for(var i=0;i<r.length;++i){var a=n(r[i]);if(a)return a}}function m(r,n){return r-n}function g(r,n){return r[0]-n[0]||r[1]-n[1]}function v(r,n){return r[1]-n[1]||r[0]-n[0]}function y(r){if(0===r.length)return null;for(var n=[],i=0;i<r.length;++i)n.push(r[i][0],r[i][1]);n.sort(m);var a=n[n.length>>1],s=[],l=[],c=[];for(i=0;i<r.length;++i){var u=r[i];u[1]<a?s.push(u):a<u[0]?l.push(u):c.push(u)}var f=c.slice();return c.sort(g),f.sort(v),new o(a,y(s),y(l),c,f)}function x(r){this.root=r}s.intervals=function(r){return r.push.apply(r,this.leftPoints),this.left&&this.left.intervals(r),this.right&&this.right.intervals(r),r},s.insert=function(r){var n=this.count-this.leftPoints.length;if(this.count+=1,r[1]<this.mid)this.left?4*(this.left.count+1)>3*(n+1)?u(this,r):this.left.insert(r):this.left=y([r]);else if(r[0]>this.mid)this.right?4*(this.right.count+1)>3*(n+1)?u(this,r):this.right.insert(r):this.right=y([r]);else{var i=a.ge(this.leftPoints,r,g),o=a.ge(this.rightPoints,r,v);this.leftPoints.splice(i,0,r),this.rightPoints.splice(o,0,r)}},s.remove=function(r){var n=this.count-this.leftPoints;if(r[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(n-1)?f(this,r):2===(c=this.left.remove(r))?(this.left=null,this.count-=1,1):(1===c&&(this.count-=1),c):0;if(r[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(n-1)?f(this,r):2===(c=this.right.remove(r))?(this.right=null,this.count-=1,1):(1===c&&(this.count-=1),c):0;if(1===this.count)return this.leftPoints[0]===r?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===r){if(this.left&&this.right){for(var i=this,o=this.left;o.right;)i=o,o=o.right;if(i===this)o.right=this.right;else{var s=this.left,c=this.right;i.count-=o.count,i.right=o.left,o.left=s,o.right=c}l(this,o),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?l(this,this.left):l(this,this.right);return 1}for(s=a.ge(this.leftPoints,r,g);s<this.leftPoints.length&&this.leftPoints[s][0]===r[0];++s)if(this.leftPoints[s]===r){for(this.count-=1,this.leftPoints.splice(s,1),c=a.ge(this.rightPoints,r,v);c<this.rightPoints.length&&this.rightPoints[c][1]===r[1];++c)if(this.rightPoints[c]===r)return this.rightPoints.splice(c,1),1}return 0},s.queryPoint=function(r,n){if(r<this.mid)return this.left&&(i=this.left.queryPoint(r,n))?i:h(this.leftPoints,r,n);if(r>this.mid){var i;return this.right&&(i=this.right.queryPoint(r,n))?i:p(this.rightPoints,r,n)}return d(this.leftPoints,n)},s.queryInterval=function(r,n,i){var a;return r<this.mid&&this.left&&(a=this.left.queryInterval(r,n,i))||n>this.mid&&this.right&&(a=this.right.queryInterval(r,n,i))?a:n<this.mid?h(this.leftPoints,n,i):r>this.mid?p(this.rightPoints,r,i):d(this.leftPoints,i)};var b=x.prototype;b.insert=function(r){this.root?this.root.insert(r):this.root=new o(r[0],null,null,[r],[r])},b.remove=function(r){if(this.root){var n=this.root.remove(r);return 2===n&&(this.root=null),0!==n}return!1},b.queryPoint=function(r,n){if(this.root)return this.root.queryPoint(r,n)},b.queryInterval=function(r,n,i){if(r<=n&&this.root)return this.root.queryInterval(r,n,i)},Object.defineProperty(b,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(b,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":31}],235:[function(r,n,i){"use strict";n.exports=function(r){for(var n=Array(r),i=0;i<r;++i)n[i]=i;return n}},{}],236:[function(r,n,i){n.exports=!0},{}],237:[function(r,n,i){function a(r){return!!r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */n.exports=function(r){return null!=r&&(a(r)||"function"==typeof r.readFloatLE&&"function"==typeof r.slice&&a(r.slice(0,0))||!!r._isBuffer)}},{}],238:[function(r,n,i){"use strict";n.exports=s,n.exports.isMobile=s,n.exports.default=s;var a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,o=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function s(r){r||(r={});var n=r.ua;if(n||"undefined"==typeof navigator||(n=navigator.userAgent),n&&n.headers&&"string"==typeof n.headers["user-agent"]&&(n=n.headers["user-agent"]),"string"!=typeof n)return!1;var i=r.tablet?o.test(n):a.test(n);return!i&&r.tablet&&r.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==n.indexOf("Macintosh")&&-1!==n.indexOf("Safari")&&(i=!0),i}},{}],239:[function(r,n,i){"use strict";n.exports=function(r){for(var n,i=r.length,a=0;a<i;a++)if(((n=r.charCodeAt(a))<9||n>13)&&32!==n&&133!==n&&160!==n&&5760!==n&&6158!==n&&(n<8192||n>8205)&&8232!==n&&8233!==n&&8239!==n&&8287!==n&&8288!==n&&12288!==n&&65279!==n)return!1;return!0}},{}],240:[function(r,n,i){n.exports=function(r,n,i){return r*(1-i)+n*i}},{}],241:[function(r,n,i){var a=r("./normalize"),o=r("gl-mat4/create"),s=r("gl-mat4/clone"),l=r("gl-mat4/determinant"),c=r("gl-mat4/invert"),u=r("gl-mat4/transpose"),f={length:r("gl-vec3/length"),normalize:r("gl-vec3/normalize"),dot:r("gl-vec3/dot"),cross:r("gl-vec3/cross")},h=o(),p=o(),d=[0,0,0,0],m=[[0,0,0],[0,0,0],[0,0,0]],g=[0,0,0];function v(r,n,i,a,o){r[0]=n[0]*a+i[0]*o,r[1]=n[1]*a+i[1]*o,r[2]=n[2]*a+i[2]*o}n.exports=function(r,n,i,o,y,x){if(n||(n=[0,0,0]),i||(i=[0,0,0]),o||(o=[0,0,0]),y||(y=[0,0,0,1]),x||(x=[0,0,0,1]),!a(h,r)||(s(p,h),p[3]=0,p[7]=0,p[11]=0,p[15]=1,Math.abs(1e-8>l(p))))return!1;var b,_,w,T,k,A=h[3],M=h[7],S=h[11],E=h[12],L=h[13],C=h[14],P=h[15];if(0!==A||0!==M||0!==S){if(d[0]=A,d[1]=M,d[2]=S,d[3]=P,!c(p,p))return!1;u(p,p),b=y,_=d[0],w=d[1],T=d[2],k=d[3],b[0]=p[0]*_+p[4]*w+p[8]*T+p[12]*k,b[1]=p[1]*_+p[5]*w+p[9]*T+p[13]*k,b[2]=p[2]*_+p[6]*w+p[10]*T+p[14]*k,b[3]=p[3]*_+p[7]*w+p[11]*T+p[15]*k}else y[0]=y[1]=y[2]=0,y[3]=1;if(n[0]=E,n[1]=L,n[2]=C,m[0][0]=h[0],m[0][1]=h[1],m[0][2]=h[2],m[1][0]=h[4],m[1][1]=h[5],m[1][2]=h[6],m[2][0]=h[8],m[2][1]=h[9],m[2][2]=h[10],i[0]=f.length(m[0]),f.normalize(m[0],m[0]),o[0]=f.dot(m[0],m[1]),v(m[1],m[1],m[0],1,-o[0]),i[1]=f.length(m[1]),f.normalize(m[1],m[1]),o[0]/=i[1],o[1]=f.dot(m[0],m[2]),v(m[2],m[2],m[0],1,-o[1]),o[2]=f.dot(m[1],m[2]),v(m[2],m[2],m[1],1,-o[2]),i[2]=f.length(m[2]),f.normalize(m[2],m[2]),o[1]/=i[2],o[2]/=i[2],f.cross(g,m[1],m[2]),0>f.dot(m[0],g))for(var I=0;I<3;I++)i[I]*=-1,m[I][0]*=-1,m[I][1]*=-1,m[I][2]*=-1;return x[0]=.5*Math.sqrt(Math.max(1+m[0][0]-m[1][1]-m[2][2],0)),x[1]=.5*Math.sqrt(Math.max(1-m[0][0]+m[1][1]-m[2][2],0)),x[2]=.5*Math.sqrt(Math.max(1-m[0][0]-m[1][1]+m[2][2],0)),x[3]=.5*Math.sqrt(Math.max(1+m[0][0]+m[1][1]+m[2][2],0)),m[2][1]>m[1][2]&&(x[0]=-x[0]),m[0][2]>m[2][0]&&(x[1]=-x[1]),m[1][0]>m[0][1]&&(x[2]=-x[2]),!0}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(r,n,i){n.exports=function(r,n){var i=n[15];if(0===i)return!1;for(var a=1/i,o=0;o<16;o++)r[o]=n[o]*a;return!0}},{}],243:[function(r,n,i){var a=r("gl-vec3/lerp"),o=r("mat4-recompose"),s=r("mat4-decompose"),l=r("gl-mat4/determinant"),c=r("quat-slerp"),u=p(),f=p(),h=p();function p(){return{translate:d(),scale:d(1),skew:d(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function d(r){return[r||0,r||0,r||0]}n.exports=function(r,n,i,p){if(0===l(n)||0===l(i))return!1;var d=s(n,u.translate,u.scale,u.skew,u.perspective,u.quaternion),m=s(i,f.translate,f.scale,f.skew,f.perspective,f.quaternion);return!(!d||!m)&&(a(h.translate,u.translate,f.translate,p),a(h.skew,u.skew,f.skew,p),a(h.scale,u.scale,f.scale,p),a(h.perspective,u.perspective,f.perspective,p),c(h.quaternion,u.quaternion,f.quaternion,p),o(r,h.translate,h.scale,h.skew,h.perspective,h.quaternion),!0)}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(r,n,i){var a={identity:r("gl-mat4/identity"),translate:r("gl-mat4/translate"),multiply:r("gl-mat4/multiply"),create:r("gl-mat4/create"),scale:r("gl-mat4/scale"),fromRotationTranslation:r("gl-mat4/fromRotationTranslation")},o=(a.create(),a.create());n.exports=function(r,n,i,s,l,c){return a.identity(r),a.fromRotationTranslation(r,c,n),r[3]=l[0],r[7]=l[1],r[11]=l[2],r[15]=l[3],a.identity(o),0!==s[2]&&(o[9]=s[2],a.multiply(r,r,o)),0!==s[1]&&(o[9]=0,o[8]=s[1],a.multiply(r,r,o)),0!==s[0]&&(o[8]=0,o[4]=s[0],a.multiply(r,r,o)),a.scale(r,r,i),r}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(r,n,i){"use strict";var a=r("binary-search-bounds"),o=r("mat4-interpolate"),s=r("gl-mat4/invert"),l=r("gl-mat4/rotateX"),c=r("gl-mat4/rotateY"),u=r("gl-mat4/rotateZ"),f=r("gl-mat4/lookAt"),h=r("gl-mat4/translate"),p=(r("gl-mat4/scale"),r("gl-vec3/normalize")),d=[0,0,0];function m(r){this._components=r.slice(),this._time=[0],this.prevMatrix=r.slice(),this.nextMatrix=r.slice(),this.computedMatrix=r.slice(),this.computedInverse=r.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}n.exports=function(r){return new m((r=r||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var g=m.prototype;g.recalcMatrix=function(r){var n=this._time,i=a.le(n,r),l=this.computedMatrix;if(!(i<0)){var c=this._components;if(i===n.length-1)for(var u=16*i,f=0;f<16;++f)l[f]=c[u++];else{var h=n[i+1]-n[i],d=(u=16*i,this.prevMatrix),m=!0;for(f=0;f<16;++f)d[f]=c[u++];var g=this.nextMatrix;for(f=0;f<16;++f)g[f]=c[u++],m=m&&d[f]===g[f];if(h<1e-6||m)for(f=0;f<16;++f)l[f]=d[f];else o(l,d,g,(r-n[i])/h)}var v=this.computedUp;v[0]=l[1],v[1]=l[5],v[2]=l[9],p(v,v);var y=this.computedInverse;s(y,l);var x=this.computedEye,b=y[15];x[0]=y[12]/b,x[1]=y[13]/b,x[2]=y[14]/b;var _=this.computedCenter,w=Math.exp(this.computedRadius[0]);for(f=0;f<3;++f)_[f]=x[f]-l[2+4*f]*w}},g.idle=function(r){if(!(r<this.lastT())){for(var n=this._components,i=n.length-16,a=0;a<16;++a)n.push(n[i++]);this._time.push(r)}},g.flush=function(r){var n=a.gt(this._time,r)-2;n<0||(this._time.splice(0,n),this._components.splice(0,16*n))},g.lastT=function(){return this._time[this._time.length-1]},g.lookAt=function(r,n,i,a){this.recalcMatrix(r),n=n||this.computedEye,i=i||d,a=a||this.computedUp,this.setMatrix(r,f(this.computedMatrix,n,i,a));for(var o=0,s=0;s<3;++s)o+=Math.pow(i[s]-n[s],2);o=Math.log(Math.sqrt(o)),this.computedRadius[0]=o},g.rotate=function(r,n,i,a){this.recalcMatrix(r);var o=this.computedInverse;n&&c(o,o,n),i&&l(o,o,i),a&&u(o,o,a),this.setMatrix(r,s(this.computedMatrix,o))};var v=[0,0,0];g.pan=function(r,n,i,a){v[0]=-(n||0),v[1]=-(i||0),v[2]=-(a||0),this.recalcMatrix(r);var o=this.computedInverse;h(o,o,v),this.setMatrix(r,s(o,o))},g.translate=function(r,n,i,a){v[0]=n||0,v[1]=i||0,v[2]=a||0,this.recalcMatrix(r);var o=this.computedMatrix;h(o,o,v),this.setMatrix(r,o)},g.setMatrix=function(r,n){if(!(r<this.lastT())){this._time.push(r);for(var i=0;i<16;++i)this._components.push(n[i])}},g.setDistance=function(r,n){this.computedRadius[0]=n},g.setDistanceLimits=function(r,n){var i=this._limits;i[0]=r,i[1]=n},g.getDistanceLimits=function(r){var n=this._limits;return r?(r[0]=n[0],r[1]=n[1],r):n}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(r,n,i){"use strict";n.exports=function(r){var n=r.length;if(n<3){for(var i=Array(n),o=0;o<n;++o)i[o]=o;return 2===n&&r[0][0]===r[1][0]&&r[0][1]===r[1][1]?[0]:i}var s=Array(n);for(o=0;o<n;++o)s[o]=o;s.sort(function(n,i){return r[n][0]-r[i][0]||r[n][1]-r[i][1]});var l=[s[0],s[1]],c=[s[0],s[1]];for(o=2;o<n;++o){for(var u=s[o],f=r[u],h=l.length;h>1&&0>=a(r[l[h-2]],r[l[h-1]],f);)h-=1,l.pop();for(l.push(u),h=c.length;h>1&&a(r[c[h-2]],r[c[h-1]],f)>=0;)h-=1,c.pop();c.push(u)}i=Array(c.length+l.length-2);for(var p=0,d=(o=0,l.length);o<d;++o)i[p++]=l[o];for(var m=c.length-2;m>0;--m)i[p++]=c[m];return i};var a=r("robust-orientation")[3]},{"robust-orientation":284}],247:[function(r,n,i){"use strict";n.exports=function(r,n){n||(n=r,r=window);var i=0,o=0,s=0,l={shift:!1,alt:!1,control:!1,meta:!1},c=!1;function u(r){var n=!1;return"altKey"in r&&(n=n||r.altKey!==l.alt,l.alt=!!r.altKey),"shiftKey"in r&&(n=n||r.shiftKey!==l.shift,l.shift=!!r.shiftKey),"ctrlKey"in r&&(n=n||r.ctrlKey!==l.control,l.control=!!r.ctrlKey),"metaKey"in r&&(n=n||r.metaKey!==l.meta,l.meta=!!r.metaKey),n}function f(r,c){var f=a.x(c),h=a.y(c);"buttons"in c&&(r=0|c.buttons),(r!==i||f!==o||h!==s||u(c))&&(i=0|r,o=f||0,s=h||0,n&&n(i,o,s,l))}function h(r){f(0,r)}function p(){(i||o||s||l.shift||l.alt||l.meta||l.control)&&(o=s=0,i=0,l.shift=l.alt=l.control=l.meta=!1,n&&n(0,0,0,l))}function d(r){u(r)&&n&&n(i,o,s,l)}function m(r){0===a.buttons(r)?f(0,r):f(i,r)}function g(r){f(i|a.buttons(r),r)}function v(r){f(i&~a.buttons(r),r)}function y(){c||(c=!0,r.addEventListener("mousemove",m),r.addEventListener("mousedown",g),r.addEventListener("mouseup",v),r.addEventListener("mouseleave",h),r.addEventListener("mouseenter",h),r.addEventListener("mouseout",h),r.addEventListener("mouseover",h),r.addEventListener("blur",p),r.addEventListener("keyup",d),r.addEventListener("keydown",d),r.addEventListener("keypress",d),r!==window&&(window.addEventListener("blur",p),window.addEventListener("keyup",d),window.addEventListener("keydown",d),window.addEventListener("keypress",d)))}y();var x={element:r};return Object.defineProperties(x,{enabled:{get:function(){return c},set:function(n){n?y():c&&(c=!1,r.removeEventListener("mousemove",m),r.removeEventListener("mousedown",g),r.removeEventListener("mouseup",v),r.removeEventListener("mouseleave",h),r.removeEventListener("mouseenter",h),r.removeEventListener("mouseout",h),r.removeEventListener("mouseover",h),r.removeEventListener("blur",p),r.removeEventListener("keyup",d),r.removeEventListener("keydown",d),r.removeEventListener("keypress",d),r!==window&&(window.removeEventListener("blur",p),window.removeEventListener("keyup",d),window.removeEventListener("keydown",d),window.removeEventListener("keypress",d)))},enumerable:!0},buttons:{get:function(){return i},enumerable:!0},x:{get:function(){return o},enumerable:!0},y:{get:function(){return s},enumerable:!0},mods:{get:function(){return l},enumerable:!0}}),x};var a=r("mouse-event")},{"mouse-event":249}],248:[function(r,n,i){var a={left:0,top:0};n.exports=function(r,n,i){n=n||r.currentTarget||r.srcElement,Array.isArray(i)||(i=[0,0]);var o,s=r.clientX||0,l=r.clientY||0,c=(o=n)===window||o===document||o===document.body?a:o.getBoundingClientRect();return i[0]=s-c.left,i[1]=l-c.top,i}},{}],249:[function(r,n,i){"use strict";function a(r){return r.target||r.srcElement||window}i.buttons=function(r){if("object"==typeof r){if("buttons"in r)return r.buttons;if("which"in r){if(2===(n=r.which))return 4;if(3===n)return 2;if(n>0)return 1<<n-1}else if("button"in r){var n;if(1===(n=r.button))return 4;if(2===n)return 2;if(n>=0)return 1<<n}}return 0},i.element=a,i.x=function(r){if("object"==typeof r){if("offsetX"in r)return r.offsetX;var n=a(r).getBoundingClientRect();return r.clientX-n.left}return 0},i.y=function(r){if("object"==typeof r){if("offsetY"in r)return r.offsetY;var n=a(r).getBoundingClientRect();return r.clientY-n.top}return 0}},{}],250:[function(r,n,i){"use strict";var a=r("to-px");n.exports=function(r,n,i){"function"==typeof r&&(i=!!n,n=r,r=window);var o=a("ex",r),s=function(r){i&&r.preventDefault();var a=r.deltaX||0,s=r.deltaY||0,l=r.deltaZ||0,c=1;switch(r.deltaMode){case 1:c=o;break;case 2:c=window.innerHeight}if(s*=c,l*=c,(a*=c)||s||l)return n(a,s,l,r)};return r.addEventListener("wheel",s),s}},{"to-px":304}],251:[function(r,n,i){"use strict";var a=r("typedarray-pool");n.exports=function(r){function n(r){throw Error("ndarray-extract-contour: "+r)}"object"!=typeof r&&n("Must specify arguments");var i,s,l,c=r.order;Array.isArray(c)||n("Must specify order");var u=r.arrayArguments||1;u<1&&n("Must have at least one array argument"),0>(r.scalarArguments||0)&&n("Scalar arg count must be > 0"),"function"!=typeof r.vertex&&n("Must specify vertex creation function"),"function"!=typeof r.cell&&n("Must specify cell creation function"),"function"!=typeof r.phase&&n("Must specify phase function");for(var f=r.getters||[],h=Array(u),p=0;p<u;++p)f.indexOf(p)>=0?h[p]=!0:h[p]=!1;return i=r.vertex,s=r.cell,l=r.phase,(0,o[[h,c].join(",")])(i,s,l,a.mallocUint32,a.freeUint32)};var o={"false,0,1":function(r,n,i,a,o){return function(s,l,c,u){var f,h=0|s.shape[0],p=0|s.shape[1],d=s.data,m=0|s.offset,g=0|s.stride[0],v=0|s.stride[1],y=m,x=0|-g,b=0,_=0|-v,w=0,T=-g-v|0,k=0,A=0|g,M=v-g*h|0,S=0,E=0,L=0,C=2*h|0,P=a(C),I=a(C),O=0,z=0,D=-1,R=-1,F=0,B=0|-h,N=0|h,j=0,U=-h-1|0,V=h-1|0,H=0,q=0,G=0;for(S=0;S<h;++S)P[O++]=i(d[y],l,c,u),y+=A;if(y+=M,p>0){if(E=1,P[O++]=i(d[y],l,c,u),y+=A,h>0)for(S=1,f=d[y],z=P[O]=i(f,l,c,u),F=P[O+D],j=P[O+B],H=P[O+U],z===F&&z===j&&z===H||(r(S,E,f,b=d[y+x],w=d[y+_],k=d[y+T],z,F,j,H,l,c,u),q=I[O]=L++),O+=1,y+=A,S=2;S<h;++S)f=d[y],z=P[O]=i(f,l,c,u),F=P[O+D],j=P[O+B],H=P[O+U],z===F&&z===j&&z===H||(r(S,E,f,b=d[y+x],w=d[y+_],k=d[y+T],z,F,j,H,l,c,u),q=I[O]=L++,H!==F&&n(I[O+D],q,k,b,H,F,l,c,u)),O+=1,y+=A;for(y+=M,O=0,G=D,D=R,R=G,G=B,B=N,N=G,G=U,U=V,V=G,E=2;E<p;++E){if(P[O++]=i(d[y],l,c,u),y+=A,h>0)for(S=1,f=d[y],z=P[O]=i(f,l,c,u),F=P[O+D],j=P[O+B],H=P[O+U],z===F&&z===j&&z===H||(r(S,E,f,b=d[y+x],w=d[y+_],k=d[y+T],z,F,j,H,l,c,u),q=I[O]=L++,H!==j&&n(I[O+B],q,w,k,j,H,l,c,u)),O+=1,y+=A,S=2;S<h;++S)f=d[y],z=P[O]=i(f,l,c,u),F=P[O+D],j=P[O+B],H=P[O+U],z===F&&z===j&&z===H||(r(S,E,f,b=d[y+x],w=d[y+_],k=d[y+T],z,F,j,H,l,c,u),q=I[O]=L++,H!==j&&n(I[O+B],q,w,k,j,H,l,c,u),H!==F&&n(I[O+D],q,k,b,H,F,l,c,u)),O+=1,y+=A;1&E&&(O=0),G=D,D=R,R=G,G=B,B=N,N=G,G=U,U=V,V=G,y+=M}}o(I),o(P)}},"false,1,0":function(r,n,i,a,o){return function(s,l,c,u){var f,h=0|s.shape[0],p=0|s.shape[1],d=s.data,m=0|s.offset,g=0|s.stride[0],v=0|s.stride[1],y=m,x=0|-g,b=0,_=0|-v,w=0,T=-g-v|0,k=0,A=0|v,M=g-v*p|0,S=0,E=0,L=0,C=2*p|0,P=a(C),I=a(C),O=0,z=0,D=-1,R=-1,F=0,B=0|-p,N=0|p,j=0,U=-p-1|0,V=p-1|0,H=0,q=0,G=0;for(E=0;E<p;++E)P[O++]=i(d[y],l,c,u),y+=A;if(y+=M,h>0){if(S=1,P[O++]=i(d[y],l,c,u),y+=A,p>0)for(E=1,f=d[y],z=P[O]=i(f,l,c,u),j=P[O+B],F=P[O+D],H=P[O+U],z===j&&z===F&&z===H||(r(S,E,f,b=d[y+x],w=d[y+_],k=d[y+T],z,j,F,H,l,c,u),q=I[O]=L++),O+=1,y+=A,E=2;E<p;++E)f=d[y],z=P[O]=i(f,l,c,u),j=P[O+B],F=P[O+D],H=P[O+U],z===j&&z===F&&z===H||(r(S,E,f,b=d[y+x],w=d[y+_],k=d[y+T],z,j,F,H,l,c,u),q=I[O]=L++,H!==F&&n(I[O+D],q,w,k,F,H,l,c,u)),O+=1,y+=A;for(y+=M,O=0,G=B,B=N,N=G,G=D,D=R,R=G,G=U,U=V,V=G,S=2;S<h;++S){if(P[O++]=i(d[y],l,c,u),y+=A,p>0)for(E=1,f=d[y],z=P[O]=i(f,l,c,u),j=P[O+B],F=P[O+D],H=P[O+U],z===j&&z===F&&z===H||(r(S,E,f,b=d[y+x],w=d[y+_],k=d[y+T],z,j,F,H,l,c,u),q=I[O]=L++,H!==j&&n(I[O+B],q,k,b,H,j,l,c,u)),O+=1,y+=A,E=2;E<p;++E)f=d[y],z=P[O]=i(f,l,c,u),j=P[O+B],F=P[O+D],H=P[O+U],z===j&&z===F&&z===H||(r(S,E,f,b=d[y+x],w=d[y+_],k=d[y+T],z,j,F,H,l,c,u),q=I[O]=L++,H!==F&&n(I[O+D],q,w,k,F,H,l,c,u),H!==j&&n(I[O+B],q,k,b,H,j,l,c,u)),O+=1,y+=A;1&S&&(O=0),G=B,B=N,N=G,G=D,D=R,R=G,G=U,U=V,V=G,y+=M}}o(I),o(P)}}}},{"typedarray-pool":308}],252:[function(r,n,i){"use strict";var a=r("dup"),o={zero:function(r,n,i,a){var o=r[0];a|=0;var s=0,l=i[0];for(s=0;s<o;++s)n[a]=0,a+=l},fdTemplate1:function(r,n,i,a,o,s,l){var c=r[0],u=i[0],f=-1*u;a|=0,l|=0;var h=0,p=s[0];for(h=0;h<c;++h)o[l]=.5*(n[a+f]-n[a+u]),a+=u,l+=p},fdTemplate2:function(r,n,i,a,o,s,l,c,u,f){var h=r[0],p=r[1],d=i[0],m=i[1],g=s[0],v=s[1],y=u[0],x=u[1],b=-1*d,_=-1*m;a|=0,l|=0,f|=0;var w=0,T=0,k=d-p*m,A=g-p*v,M=y-p*x;for(T=0;T<h;++T){for(w=0;w<p;++w)o[l]=.5*(n[a+b]-n[a+d]),c[f]=.5*(n[a+_]-n[a+m]),a+=m,l+=v,f+=x;a+=k,l+=A,f+=M}}},s={cdiff:function(r){var n={};return function(i,a,o){var s=i.dtype,l=i.order,c=a.dtype,u=a.order,f=o.dtype,h=o.order,p=[s,l.join(),c,u.join(),f,h.join()].join(),d=n[p];return d||(n[p]=d=r([s,l,c,u,f,h])),d(i.shape.slice(0),i.data,i.stride,0|i.offset,a.data,a.stride,0|a.offset,o.data,o.stride,0|o.offset)}},zero:function(r){var n={};return function(i){var a=i.dtype,o=i.order,s=[a,o.join()].join(),l=n[s];return l||(n[s]=l=r([a,o])),l(i.shape.slice(0),i.data,i.stride,0|i.offset)}},fdTemplate1:function(r){var n={};return function(i,a){var o=i.dtype,s=i.order,l=a.dtype,c=a.order,u=[o,s.join(),l,c.join()].join(),f=n[u];return f||(n[u]=f=r([o,s,l,c])),f(i.shape.slice(0),i.data,i.stride,0|i.offset,a.data,a.stride,0|a.offset)}},fdTemplate2:function(r){var n={};return function(i,a,o){var s=i.dtype,l=i.order,c=a.dtype,u=a.order,f=o.dtype,h=o.order,p=[s,l.join(),c,u.join(),f,h.join()].join(),d=n[p];return d||(n[p]=d=r([s,l,c,u,f,h])),d(i.shape.slice(0),i.data,i.stride,0|i.offset,a.data,a.stride,0|a.offset,o.data,o.stride,0|o.offset)}}};function l(r){return o[r.funcName]}function c(r){var n;return(0,s[(n={funcName:r.funcName}).funcName])(l.bind(void 0,n))}var u={},f={},h=c({funcName:"cdiff"}),p=c({funcName:"zero"});function d(r,n,i,a){return function(r,o){var s=o.shape.slice();return s[0]>2&&s[1]>2&&a(o.pick(-1,-1).lo(1,1).hi(s[0]-2,s[1]-2),r.pick(-1,-1,0).lo(1,1).hi(s[0]-2,s[1]-2),r.pick(-1,-1,1).lo(1,1).hi(s[0]-2,s[1]-2)),s[1]>2&&(i(o.pick(0,-1).lo(1).hi(s[1]-2),r.pick(0,-1,1).lo(1).hi(s[1]-2)),n(r.pick(0,-1,0).lo(1).hi(s[1]-2))),s[1]>2&&(i(o.pick(s[0]-1,-1).lo(1).hi(s[1]-2),r.pick(s[0]-1,-1,1).lo(1).hi(s[1]-2)),n(r.pick(s[0]-1,-1,0).lo(1).hi(s[1]-2))),s[0]>2&&(i(o.pick(-1,0).lo(1).hi(s[0]-2),r.pick(-1,0,0).lo(1).hi(s[0]-2)),n(r.pick(-1,0,1).lo(1).hi(s[0]-2))),s[0]>2&&(i(o.pick(-1,s[1]-1).lo(1).hi(s[0]-2),r.pick(-1,s[1]-1,0).lo(1).hi(s[0]-2)),n(r.pick(-1,s[1]-1,1).lo(1).hi(s[0]-2))),r.set(0,0,0,0),r.set(0,0,1,0),r.set(s[0]-1,0,0,0),r.set(s[0]-1,0,1,0),r.set(0,s[1]-1,0,0),r.set(0,s[1]-1,1,0),r.set(s[0]-1,s[1]-1,0,0),r.set(s[0]-1,s[1]-1,1,0),r}}n.exports=function(r,n,i){return Array.isArray(i)||(i=a(n.dimension,"string"==typeof i?i:"clamp")),0===n.size?r:0===n.dimension?(r.set(0),r):(function(r){var n,i=r.join();if(l=f[i])return l;for(var a=r.length,o=[h,p],s=1;s<=a;++s)o.push((n=s)in u?u[n]:u[n]=c({funcName:"fdTemplate"+n}));var l=d.apply(void 0,o);return f[i]=l,l})(i)(r,n)}},{dup:65}],253:[function(r,n,i){"use strict";function a(r,n){var i=Math.floor(n),a=n-i,o=0<=i&&i<r.shape[0],s=0<=i+1&&i+1<r.shape[0];return(1-a)*(o?+r.get(i):0)+a*(s?+r.get(i+1):0)}function o(r,n,i){var a=Math.floor(n),o=n-a,s=0<=a&&a<r.shape[0],l=0<=a+1&&a+1<r.shape[0],c=Math.floor(i),u=i-c,f=0<=c&&c<r.shape[1],h=0<=c+1&&c+1<r.shape[1],p=s&&f?r.get(a,c):0,d=s&&h?r.get(a,c+1):0;return(1-u)*((1-o)*p+o*(l&&f?r.get(a+1,c):0))+u*((1-o)*d+o*(l&&h?r.get(a+1,c+1):0))}function s(r,n,i,a){var o=Math.floor(n),s=n-o,l=0<=o&&o<r.shape[0],c=0<=o+1&&o+1<r.shape[0],u=Math.floor(i),f=i-u,h=0<=u&&u<r.shape[1],p=0<=u+1&&u+1<r.shape[1],d=Math.floor(a),m=a-d,g=0<=d&&d<r.shape[2],v=0<=d+1&&d+1<r.shape[2],y=l&&h&&g?r.get(o,u,d):0,x=l&&p&&g?r.get(o,u+1,d):0,b=c&&h&&g?r.get(o+1,u,d):0,_=c&&p&&g?r.get(o+1,u+1,d):0,w=l&&h&&v?r.get(o,u,d+1):0,T=l&&p&&v?r.get(o,u+1,d+1):0;return(1-m)*((1-f)*((1-s)*y+s*b)+f*((1-s)*x+s*_))+m*((1-f)*((1-s)*w+s*(c&&h&&v?r.get(o+1,u,d+1):0))+f*((1-s)*T+s*(c&&p&&v?r.get(o+1,u+1,d+1):0)))}function l(r){var n,i,a=0|r.shape.length,o=Array(a),s=Array(a),l=Array(a),c=Array(a);for(n=0;n<a;++n)i=+arguments[n+1],o[n]=Math.floor(i),s[n]=i-o[n],l[n]=0<=o[n]&&o[n]<r.shape[n],c[n]=0<=o[n]+1&&o[n]+1<r.shape[n];var u,f,h,p=0;t:for(n=0;n<1<<a;++n){for(f=1,h=r.offset,u=0;u<a;++u)if(n&1<<u){if(!c[u])continue t;f*=s[u],h+=r.stride[u]*(o[u]+1)}else{if(!l[u])continue t;f*=1-s[u],h+=r.stride[u]*o[u]}p+=f*r.data[h]}return p}n.exports=function(r,n,i,c){switch(r.shape.length){case 0:return 0;case 1:return a(r,n);case 2:return o(r,n,i);case 3:return s(r,n,i,c);default:return l.apply(void 0,arguments)}},n.exports.d1=a,n.exports.d2=o,n.exports.d3=s},{}],254:[function(r,n,i){"use strict";var a={"float64,2,1,0":function(){return function(r,n,i,a,o){var s=r[0],l=r[1],c=r[2],u=i[0],f=i[1],h=i[2];a|=0;var p=0,d=0,m=0,g=f-c*h,v=u-l*f;for(m=0;m<s;++m){for(d=0;d<l;++d){for(p=0;p<c;++p)n[a]/=o,a+=h;a+=g}a+=v}}},"uint8,2,0,1,float64,2,1,0":function(){return function(r,n,i,a,o,s,l,c){for(var u=r[0],f=r[1],h=r[2],p=i[0],d=i[1],m=i[2],g=s[0],v=s[1],y=s[2],x=a|=0,b=l|=0,_=0|r[0];_>0;){_<64?(u=_,_=0):(u=64,_-=64);for(var w=0|r[1];w>0;){w<64?(f=w,w=0):(f=64,w-=64),a=x+_*p+w*d,l=b+_*g+w*v;var T=0,k=0,A=0,M=p-h*m,S=d-u*p,E=g-h*y,L=v-u*g;for(A=0;A<f;++A){for(k=0;k<u;++k){for(T=0;T<h;++T)n[a]=o[l]*c,a+=m,l+=y;a+=M,l+=E}a+=S,l+=L}}}}},"float32,1,0,float32,1,0":function(){return function(r,n,i,a,o,s,l){var c=r[0],u=r[1],f=i[0],h=i[1],p=s[0],d=s[1];a|=0,l|=0;var m=0,g=0,v=f-u*h,y=p-u*d;for(g=0;g<c;++g){for(m=0;m<u;++m)n[a]=o[l],a+=h,l+=d;a+=v,l+=y}}},"float32,1,0,float32,0,1":function(){return function(r,n,i,a,o,s,l){for(var c=r[0],u=r[1],f=i[0],h=i[1],p=s[0],d=s[1],m=a|=0,g=l|=0,v=0|r[1];v>0;){v<64?(u=v,v=0):(u=64,v-=64);for(var y=0|r[0];y>0;){y<64?(c=y,y=0):(c=64,y-=64),a=m+v*h+y*f,l=g+v*d+y*p;var x=0,b=0,_=f-u*h,w=p-u*d;for(b=0;b<c;++b){for(x=0;x<u;++x)n[a]=o[l],a+=h,l+=d;a+=_,l+=w}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(r,n,i,a,o,s,l){for(var c=r[0],u=r[1],f=r[2],h=i[0],p=i[1],d=i[2],m=s[0],g=s[1],v=s[2],y=a|=0,x=l|=0,b=0|r[2];b>0;){b<64?(f=b,b=0):(f=64,b-=64);for(var _=0|r[0];_>0;){_<64?(c=_,_=0):(c=64,_-=64);for(var w=0|r[1];w>0;){w<64?(u=w,w=0):(u=64,w-=64),a=y+b*d+_*h+w*p,l=x+b*v+_*m+w*g;var T=0,k=0,A=0,M=h-f*d,S=p-c*h,E=m-f*v,L=g-c*m;for(A=0;A<u;++A){for(k=0;k<c;++k){for(T=0;T<f;++T)n[a]=o[l],a+=d,l+=v;a+=M,l+=E}a+=S,l+=L}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(r,n,i,a,o,s,l){var c=r[0],u=r[1],f=r[2],h=i[0],p=i[1],d=i[2],m=s[0],g=s[1],v=s[2];a|=0,l|=0;var y=0,x=0,b=0,_=h-f*d,w=p-c*h,T=m-f*v,k=g-c*m;for(b=0;b<u;++b){for(x=0;x<c;++x){for(y=0;y<f;++y)n[a]=o[l],a+=d,l+=v;a+=_,l+=T}a+=w,l+=k}}}},o=function(r,n){return(0,a[n.join(",")])()},s={mul:function(r){var n={};return function(i,a,o){var s=i.dtype,l=i.order,c=a.dtype,u=a.order,f=o.dtype,h=o.order,p=[s,l.join(),c,u.join(),f,h.join()].join(),d=n[p];return d||(n[p]=d=r([s,l,c,u,f,h])),d(i.shape.slice(0),i.data,i.stride,0|i.offset,a.data,a.stride,0|a.offset,o.data,o.stride,0|o.offset)}},muls:function(r){var n={};return function(i,a,o){var s=i.dtype,l=i.order,c=a.dtype,u=a.order,f=[s,l.join(),c,u.join()].join(),h=n[f];return h||(n[f]=h=r([s,l,c,u])),h(i.shape.slice(0),i.data,i.stride,0|i.offset,a.data,a.stride,0|a.offset,o)}},mulseq:function(r){var n={};return function(i,a){var o=i.dtype,s=i.order,l=[o,s.join()].join(),c=n[l];return c||(n[l]=c=r([o,s])),c(i.shape.slice(0),i.data,i.stride,0|i.offset,a)}},div:function(r){var n={};return function(i,a,o){var s=i.dtype,l=i.order,c=a.dtype,u=a.order,f=o.dtype,h=o.order,p=[s,l.join(),c,u.join(),f,h.join()].join(),d=n[p];return d||(n[p]=d=r([s,l,c,u,f,h])),d(i.shape.slice(0),i.data,i.stride,0|i.offset,a.data,a.stride,0|a.offset,o.data,o.stride,0|o.offset)}},divs:function(r){var n={};return function(i,a,o){var s=i.dtype,l=i.order,c=a.dtype,u=a.order,f=[s,l.join(),c,u.join()].join(),h=n[f];return h||(n[f]=h=r([s,l,c,u])),h(i.shape.slice(0),i.data,i.stride,0|i.offset,a.data,a.stride,0|a.offset,o)}},divseq:function(r){var n={};return function(i,a){var o=i.dtype,s=i.order,l=[o,s.join()].join(),c=n[l];return c||(n[l]=c=r([o,s])),c(i.shape.slice(0),i.data,i.stride,0|i.offset,a)}},assign:function(r){var n={};return function(i,a){var o=i.dtype,s=i.order,l=a.dtype,c=a.order,u=[o,s.join(),l,c.join()].join(),f=n[u];return f||(n[u]=f=r([o,s,l,c])),f(i.shape.slice(0),i.data,i.stride,0|i.offset,a.data,a.stride,0|a.offset)}}};function l(r){var n;return(0,s[(n={funcName:r.funcName}).funcName])(o.bind(void 0,n))}var c={mul:"*",div:"/"};(function(){for(var r in c)i[r]=l({funcName:r}),i[r+"s"]=l({funcName:r+"s"}),i[r+"seq"]=l({funcName:r+"seq"})})(),i.assign=l({funcName:"assign"})},{}],255:[function(r,n,i){"use strict";var a=r("ndarray"),o=r("./doConvert.js");n.exports=function(r,n){for(var i=[],s=r,l=1;Array.isArray(s);)i.push(s.length),l*=s.length,s=s[0];return 0===i.length?a():(n||(n=a(new Float64Array(l),i)),o(n,r),n)}},{"./doConvert.js":256,ndarray:259}],256:[function(r,n,i){"use strict";var a,o;n.exports=(a=(function(){return function(r,n,i,a,o){var s=r[0],l=r[1],c=r[2],u=i[0],f=i[1],h=i[2],p=[0,0,0];a|=0;var d=0,m=0,g=0,v=f-c*h,y=u-l*f;for(g=0;g<s;++g){for(m=0;m<l;++m){for(d=0;d<c;++d){var x,b=o;for(x=0;x<p.length-1;++x)b=b[p[x]];n[a]=b[p[p.length-1]],a+=h,++p[2]}a+=v,p[2]-=c,++p[1]}a+=y,p[1]-=l,++p[0]}}}).bind(void 0,{funcName:"convert"}),o={},function(r,n){var i=r.dtype,s=r.order,l=[i,s.join()].join(),c=o[l];return c||(o[l]=c=a([i,s])),c(r.shape.slice(0),r.data,r.stride,0|r.offset,n)})},{}],257:[function(r,n,i){"use strict";var a=r("typedarray-pool");function o(r){return"uint32"===r?[a.mallocUint32,a.freeUint32]:null}var s={"uint32,1,0":function(r,n){return function(i,a,o,s,l,c,u,f,h,p,d){var m,g,v,y,x,b,_,w,T=i*l+s,k=r(f);for(m=i+1;m<=a;++m){for(g=m,v=T+=l,x=0,b=T,y=0;y<f;++y)k[x++]=o[b],b+=h;t:for(;g-- >i;){for(x=0,b=v-l,y=0;y<f;++y){if((_=o[b])<(w=k[x]))break t;if(_>w)break;b+=p,x+=d}for(x=v,b=v-l,y=0;y<f;++y)o[x]=o[b],x+=h,b+=h;v-=l}for(x=v,b=0,y=0;y<f;++y)o[x]=k[b++],x+=h}n(k)}}},l={"uint32,1,0":function(r,n,i){return function a(o,s,l,c,u,f,h,p,d,m,g){var v,y,x,b,_,w,T,k,A,M,S,E,L,C,P,I,O,z,D,R,F,B,N,j,U,V=(s-o+1)/6|0,H=o+V,q=s-V,G=o+s>>1,Y=G-V,W=G+V,X=H,Z=Y,J=G,K=W,Q=q,$=o+1,tt=s-1,te=!0,tr=0,tn=0,ti=0,ta=n(p),to=n(p);for(S=u*X,E=u*Z,U=c,M=0;M<p;++M){if(k=E+U,(ti=l[T=S+U]-l[k])>0){y=X,X=Z,Z=y;break}if(ti<0)break;U+=m}for(S=u*K,E=u*Q,U=c,M=0;M<p;++M){if(k=E+U,(ti=l[T=S+U]-l[k])>0){y=K,K=Q,Q=y;break}if(ti<0)break;U+=m}for(S=u*X,E=u*J,U=c,M=0;M<p;++M){if(k=E+U,(ti=l[T=S+U]-l[k])>0){y=X,X=J,J=y;break}if(ti<0)break;U+=m}for(S=u*Z,E=u*J,U=c,M=0;M<p;++M){if(k=E+U,(ti=l[T=S+U]-l[k])>0){y=Z,Z=J,J=y;break}if(ti<0)break;U+=m}for(S=u*X,E=u*K,U=c,M=0;M<p;++M){if(k=E+U,(ti=l[T=S+U]-l[k])>0){y=X,X=K,K=y;break}if(ti<0)break;U+=m}for(S=u*J,E=u*K,U=c,M=0;M<p;++M){if(k=E+U,(ti=l[T=S+U]-l[k])>0){y=J,J=K,K=y;break}if(ti<0)break;U+=m}for(S=u*Z,E=u*Q,U=c,M=0;M<p;++M){if(k=E+U,(ti=l[T=S+U]-l[k])>0){y=Z,Z=Q,Q=y;break}if(ti<0)break;U+=m}for(S=u*Z,E=u*J,U=c,M=0;M<p;++M){if(k=E+U,(ti=l[T=S+U]-l[k])>0){y=Z,Z=J,J=y;break}if(ti<0)break;U+=m}for(S=u*K,E=u*Q,U=c,M=0;M<p;++M){if(k=E+U,(ti=l[T=S+U]-l[k])>0){y=K,K=Q,Q=y;break}if(ti<0)break;U+=m}for(S=u*X,E=u*Z,L=u*J,C=u*K,P=u*Q,I=u*H,O=u*G,z=u*q,j=0,U=c,M=0;M<p;++M)T=S+U,k=E+U,A=L+U,D=C+U,R=P+U,F=I+U,B=O+U,N=z+U,ta[j]=l[k],to[j]=l[D],te=te&&ta[j]===to[j],x=l[T],b=l[A],_=l[R],l[F]=x,l[B]=b,l[N]=_,++j,U+=d;for(S=u*Y,E=u*o,U=c,M=0;M<p;++M)k=E+U,l[T=S+U]=l[k],U+=d;for(S=u*W,E=u*s,U=c,M=0;M<p;++M)k=E+U,l[T=S+U]=l[k],U+=d;if(te)for(w=$;w<=tt;++w){for(T=c+w*u,j=0,M=0;M<p&&0==(ti=l[T]-ta[j]);++M)j+=g,T+=m;if(0!==ti){if(ti<0){if(w!==$)for(S=u*w,E=u*$,U=c,M=0;M<p;++M)k=E+U,v=l[T=S+U],l[T]=l[k],l[k]=v,U+=d;++$}else for(;;){for(T=c+tt*u,j=0,M=0;M<p&&0==(ti=l[T]-ta[j]);++M)j+=g,T+=m;if(!(ti>0)){if(ti<0){for(S=u*w,E=u*$,L=u*tt,U=c,M=0;M<p;++M)k=E+U,A=L+U,v=l[T=S+U],l[T]=l[k],l[k]=l[A],l[A]=v,U+=d;++$,--tt;break}for(S=u*w,E=u*tt,U=c,M=0;M<p;++M)k=E+U,v=l[T=S+U],l[T]=l[k],l[k]=v,U+=d;--tt;break}tt--}}}else for(w=$;w<=tt;++w){for(T=c+w*u,j=0,M=0;M<p&&0==(tr=l[T]-ta[j]);++M)j+=g,T+=m;if(tr<0){if(w!==$)for(S=u*w,E=u*$,U=c,M=0;M<p;++M)k=E+U,v=l[T=S+U],l[T]=l[k],l[k]=v,U+=d;++$}else{for(T=c+w*u,j=0,M=0;M<p&&0==(tn=l[T]-to[j]);++M)j+=g,T+=m;if(tn>0)for(;;){for(T=c+tt*u,j=0,M=0;M<p&&0==(ti=l[T]-to[j]);++M)j+=g,T+=m;if(!(ti>0)){for(T=c+tt*u,j=0,M=0;M<p&&0==(ti=l[T]-ta[j]);++M)j+=g,T+=m;if(ti<0){for(S=u*w,E=u*$,L=u*tt,U=c,M=0;M<p;++M)k=E+U,A=L+U,v=l[T=S+U],l[T]=l[k],l[k]=l[A],l[A]=v,U+=d;++$,--tt}else{for(S=u*w,E=u*tt,U=c,M=0;M<p;++M)k=E+U,v=l[T=S+U],l[T]=l[k],l[k]=v,U+=d;--tt}break}if(--tt<w)break}}}for(S=u*o,E=u*($-1),j=0,U=c,M=0;M<p;++M)k=E+U,l[T=S+U]=l[k],l[k]=ta[j],++j,U+=d;for(S=u*s,E=u*(tt+1),j=0,U=c,M=0;M<p;++M)k=E+U,l[T=S+U]=l[k],l[k]=to[j],++j,U+=d;if($-2-o<=32?r(o,$-2,l,c,u,f,h,p,d,m,g):a(o,$-2,l,c,u,f,h,p,d,m,g),s-(tt+2)<=32?r(tt+2,s,l,c,u,f,h,p,d,m,g):a(tt+2,s,l,c,u,f,h,p,d,m,g),te)return i(ta),void i(to);if($<H&&tt>q){t:for(;;){for(T=c+$*u,j=0,U=c,M=0;M<p;++M){if(l[T]!==ta[j])break t;++j,T+=d}++$}t:for(;;){for(T=c+tt*u,j=0,U=c,M=0;M<p;++M){if(l[T]!==to[j])break t;++j,T+=d}--tt}for(w=$;w<=tt;++w){for(T=c+w*u,j=0,M=0;M<p&&0==(tr=l[T]-ta[j]);++M)j+=g,T+=m;if(0===tr){if(w!==$)for(S=u*w,E=u*$,U=c,M=0;M<p;++M)k=E+U,v=l[T=S+U],l[T]=l[k],l[k]=v,U+=d;++$}else{for(T=c+w*u,j=0,M=0;M<p&&0==(tn=l[T]-to[j]);++M)j+=g,T+=m;if(0===tn)for(;;){for(T=c+tt*u,j=0,M=0;M<p&&0==(ti=l[T]-to[j]);++M)j+=g,T+=m;if(0!==ti){for(T=c+tt*u,j=0,M=0;M<p&&0==(ti=l[T]-ta[j]);++M)j+=g,T+=m;if(ti<0){for(S=u*w,E=u*$,L=u*tt,U=c,M=0;M<p;++M)k=E+U,A=L+U,v=l[T=S+U],l[T]=l[k],l[k]=l[A],l[A]=v,U+=d;++$,--tt}else{for(S=u*w,E=u*tt,U=c,M=0;M<p;++M)k=E+U,v=l[T=S+U],l[T]=l[k],l[k]=v,U+=d;--tt}break}if(--tt<w)break}}}}i(ta),i(to),tt-$<=32?r($,tt,l,c,u,f,h,p,d,m,g):a($,tt,l,c,u,f,h,p,d,m,g)}}},c={"uint32,1,0":function(r,n){return function(i){var a=i.data,o=0|i.offset,s=i.shape,l=i.stride,c=0|l[0],u=0|s[0],f=0|l[1],h=0|s[1];u<=32?r(0,u-1,a,o,c,f,u,h,f,f,1):n(0,u-1,a,o,c,f,u,h,f,f,1)}}};n.exports=function(r,n){var i,a,u,f,h=c[[n,r].join(",")],p=(i=o(n),a=s[[n,r].join(",")],i?a(i[0],i[1]):a()),d=(u=o(n),f=l[[n,r].join(",")],r.length>1&&u?f(p,u[0],u[1]):f(p));return h(p,d)}},{"typedarray-pool":308}],258:[function(r,n,i){"use strict";var a=r("./lib/compile_sort.js"),o={};n.exports=function(r){var n=r.order,i=r.dtype,s=[n,i].join(":"),l=o[s];return l||(o[s]=l=a(n,i)),l(r),r}},{"./lib/compile_sort.js":257}],259:[function(r,n,i){var a=r("is-buffer"),o="undefined"!=typeof Float64Array;function s(r,n){return r[0]-n[0]}function l(){var r,n=this.stride,i=Array(n.length);for(r=0;r<i.length;++r)i[r]=[Math.abs(n[r]),r];i.sort(s);var a=Array(i.length);for(r=0;r<a.length;++r)a[r]=i[r][1];return a}var c={T:function(r){function n(r){this.data=r}var i=n.prototype;return i.dtype=r,i.index=function(){return -1},i.size=0,i.dimension=-1,i.shape=i.stride=i.order=[],i.lo=i.hi=i.transpose=i.step=function(){return new n(this.data)},i.get=i.set=function(){},i.pick=function(){return null},function(r){return new n(r)}},0:function(r,n){function i(r,n){this.data=r,this.offset=n}var a=i.prototype;return a.dtype=r,a.index=function(){return this.offset},a.dimension=0,a.size=1,a.shape=a.stride=a.order=[],a.lo=a.hi=a.transpose=a.step=function(){return new i(this.data,this.offset)},a.pick=function(){return n(this.data)},a.valueOf=a.get=function(){return"generic"===r?this.data.get(this.offset):this.data[this.offset]},a.set=function(n){return"generic"===r?this.data.set(this.offset,n):this.data[this.offset]=n},function(r,n,a,o){return new i(r,o)}},1:function(r,n,i){function a(r,n,i,a){this.data=r,this.shape=[n],this.stride=[i],this.offset=0|a}var o=a.prototype;return o.dtype=r,o.dimension=1,Object.defineProperty(o,"size",{get:function(){return this.shape[0]}}),o.order=[0],o.set=function(n,i){return"generic"===r?this.data.set(this.offset+this.stride[0]*n,i):this.data[this.offset+this.stride[0]*n]=i},o.get=function(n){return"generic"===r?this.data.get(this.offset+this.stride[0]*n):this.data[this.offset+this.stride[0]*n]},o.index=function(r){return this.offset+this.stride[0]*r},o.hi=function(r){return new a(this.data,"number"!=typeof r||r<0?this.shape[0]:0|r,this.stride[0],this.offset)},o.lo=function(r){var n=this.offset,i=0,o=this.shape[0],s=this.stride[0];return"number"==typeof r&&r>=0&&(n+=s*(i=0|r),o-=i),new a(this.data,o,s,n)},o.step=function(r){var n=this.shape[0],i=this.stride[0],o=this.offset,s=0,l=Math.ceil;return"number"==typeof r&&((s=0|r)<0?(o+=i*(n-1),n=l(-n/s)):n=l(n/s),i*=s),new a(this.data,n,i,o)},o.transpose=function(r){r=void 0===r?0:0|r;var n=this.shape,i=this.stride;return new a(this.data,n[r],i[r],this.offset)},o.pick=function(r){var i=[],a=[],o=this.offset;return"number"==typeof r&&r>=0?o=o+this.stride[0]*r|0:(i.push(this.shape[0]),a.push(this.stride[0])),(0,n[i.length+1])(this.data,i,a,o)},function(r,n,i,o){return new a(r,n[0],i[0],o)}},2:function(r,n,i){function a(r,n,i,a,o,s){this.data=r,this.shape=[n,i],this.stride=[a,o],this.offset=0|s}var o=a.prototype;return o.dtype=r,o.dimension=2,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(o,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),o.set=function(n,i,a){return"generic"===r?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*i,a):this.data[this.offset+this.stride[0]*n+this.stride[1]*i]=a},o.get=function(n,i){return"generic"===r?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*i):this.data[this.offset+this.stride[0]*n+this.stride[1]*i]},o.index=function(r,n){return this.offset+this.stride[0]*r+this.stride[1]*n},o.hi=function(r,n){return new a(this.data,"number"!=typeof r||r<0?this.shape[0]:0|r,"number"!=typeof n||n<0?this.shape[1]:0|n,this.stride[0],this.stride[1],this.offset)},o.lo=function(r,n){var i=this.offset,o=0,s=this.shape[0],l=this.shape[1],c=this.stride[0],u=this.stride[1];return"number"==typeof r&&r>=0&&(i+=c*(o=0|r),s-=o),"number"==typeof n&&n>=0&&(i+=u*(o=0|n),l-=o),new a(this.data,s,l,c,u,i)},o.step=function(r,n){var i=this.shape[0],o=this.shape[1],s=this.stride[0],l=this.stride[1],c=this.offset,u=0,f=Math.ceil;return"number"==typeof r&&((u=0|r)<0?(c+=s*(i-1),i=f(-i/u)):i=f(i/u),s*=u),"number"==typeof n&&((u=0|n)<0?(c+=l*(o-1),o=f(-o/u)):o=f(o/u),l*=u),new a(this.data,i,o,s,l,c)},o.transpose=function(r,n){r=void 0===r?0:0|r,n=void 0===n?1:0|n;var i=this.shape,o=this.stride;return new a(this.data,i[r],i[n],o[r],o[n],this.offset)},o.pick=function(r,i){var a=[],o=[],s=this.offset;return"number"==typeof r&&r>=0?s=s+this.stride[0]*r|0:(a.push(this.shape[0]),o.push(this.stride[0])),"number"==typeof i&&i>=0?s=s+this.stride[1]*i|0:(a.push(this.shape[1]),o.push(this.stride[1])),(0,n[a.length+1])(this.data,a,o,s)},function(r,n,i,o){return new a(r,n[0],n[1],i[0],i[1],o)}},3:function(r,n,i){function a(r,n,i,a,o,s,l,c){this.data=r,this.shape=[n,i,a],this.stride=[o,s,l],this.offset=0|c}var o=a.prototype;return o.dtype=r,o.dimension=3,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(o,"order",{get:function(){var r=Math.abs(this.stride[0]),n=Math.abs(this.stride[1]),i=Math.abs(this.stride[2]);return r>n?n>i?[2,1,0]:r>i?[1,2,0]:[1,0,2]:r>i?[2,0,1]:i>n?[0,1,2]:[0,2,1]}}),o.set=function(n,i,a,o){return"generic"===r?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a,o):this.data[this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a]=o},o.get=function(n,i,a){return"generic"===r?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a):this.data[this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a]},o.index=function(r,n,i){return this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*i},o.hi=function(r,n,i){return new a(this.data,"number"!=typeof r||r<0?this.shape[0]:0|r,"number"!=typeof n||n<0?this.shape[1]:0|n,"number"!=typeof i||i<0?this.shape[2]:0|i,this.stride[0],this.stride[1],this.stride[2],this.offset)},o.lo=function(r,n,i){var o=this.offset,s=0,l=this.shape[0],c=this.shape[1],u=this.shape[2],f=this.stride[0],h=this.stride[1],p=this.stride[2];return"number"==typeof r&&r>=0&&(o+=f*(s=0|r),l-=s),"number"==typeof n&&n>=0&&(o+=h*(s=0|n),c-=s),"number"==typeof i&&i>=0&&(o+=p*(s=0|i),u-=s),new a(this.data,l,c,u,f,h,p,o)},o.step=function(r,n,i){var o=this.shape[0],s=this.shape[1],l=this.shape[2],c=this.stride[0],u=this.stride[1],f=this.stride[2],h=this.offset,p=0,d=Math.ceil;return"number"==typeof r&&((p=0|r)<0?(h+=c*(o-1),o=d(-o/p)):o=d(o/p),c*=p),"number"==typeof n&&((p=0|n)<0?(h+=u*(s-1),s=d(-s/p)):s=d(s/p),u*=p),"number"==typeof i&&((p=0|i)<0?(h+=f*(l-1),l=d(-l/p)):l=d(l/p),f*=p),new a(this.data,o,s,l,c,u,f,h)},o.transpose=function(r,n,i){r=void 0===r?0:0|r,n=void 0===n?1:0|n,i=void 0===i?2:0|i;var o=this.shape,s=this.stride;return new a(this.data,o[r],o[n],o[i],s[r],s[n],s[i],this.offset)},o.pick=function(r,i,a){var o=[],s=[],l=this.offset;return"number"==typeof r&&r>=0?l=l+this.stride[0]*r|0:(o.push(this.shape[0]),s.push(this.stride[0])),"number"==typeof i&&i>=0?l=l+this.stride[1]*i|0:(o.push(this.shape[1]),s.push(this.stride[1])),"number"==typeof a&&a>=0?l=l+this.stride[2]*a|0:(o.push(this.shape[2]),s.push(this.stride[2])),(0,n[o.length+1])(this.data,o,s,l)},function(r,n,i,o){return new a(r,n[0],n[1],n[2],i[0],i[1],i[2],o)}},4:function(r,n,i){function a(r,n,i,a,o,s,l,c,u,f){this.data=r,this.shape=[n,i,a,o],this.stride=[s,l,c,u],this.offset=0|f}var o=a.prototype;return o.dtype=r,o.dimension=4,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(o,"order",{get:i}),o.set=function(n,i,a,o,s){return"generic"===r?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a+this.stride[3]*o,s):this.data[this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a+this.stride[3]*o]=s},o.get=function(n,i,a,o){return"generic"===r?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a+this.stride[3]*o):this.data[this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a+this.stride[3]*o]},o.index=function(r,n,i,a){return this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*i+this.stride[3]*a},o.hi=function(r,n,i,o){return new a(this.data,"number"!=typeof r||r<0?this.shape[0]:0|r,"number"!=typeof n||n<0?this.shape[1]:0|n,"number"!=typeof i||i<0?this.shape[2]:0|i,"number"!=typeof o||o<0?this.shape[3]:0|o,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},o.lo=function(r,n,i,o){var s=this.offset,l=0,c=this.shape[0],u=this.shape[1],f=this.shape[2],h=this.shape[3],p=this.stride[0],d=this.stride[1],m=this.stride[2],g=this.stride[3];return"number"==typeof r&&r>=0&&(s+=p*(l=0|r),c-=l),"number"==typeof n&&n>=0&&(s+=d*(l=0|n),u-=l),"number"==typeof i&&i>=0&&(s+=m*(l=0|i),f-=l),"number"==typeof o&&o>=0&&(s+=g*(l=0|o),h-=l),new a(this.data,c,u,f,h,p,d,m,g,s)},o.step=function(r,n,i,o){var s=this.shape[0],l=this.shape[1],c=this.shape[2],u=this.shape[3],f=this.stride[0],h=this.stride[1],p=this.stride[2],d=this.stride[3],m=this.offset,g=0,v=Math.ceil;return"number"==typeof r&&((g=0|r)<0?(m+=f*(s-1),s=v(-s/g)):s=v(s/g),f*=g),"number"==typeof n&&((g=0|n)<0?(m+=h*(l-1),l=v(-l/g)):l=v(l/g),h*=g),"number"==typeof i&&((g=0|i)<0?(m+=p*(c-1),c=v(-c/g)):c=v(c/g),p*=g),"number"==typeof o&&((g=0|o)<0?(m+=d*(u-1),u=v(-u/g)):u=v(u/g),d*=g),new a(this.data,s,l,c,u,f,h,p,d,m)},o.transpose=function(r,n,i,o){r=void 0===r?0:0|r,n=void 0===n?1:0|n,i=void 0===i?2:0|i,o=void 0===o?3:0|o;var s=this.shape,l=this.stride;return new a(this.data,s[r],s[n],s[i],s[o],l[r],l[n],l[i],l[o],this.offset)},o.pick=function(r,i,a,o){var s=[],l=[],c=this.offset;return"number"==typeof r&&r>=0?c=c+this.stride[0]*r|0:(s.push(this.shape[0]),l.push(this.stride[0])),"number"==typeof i&&i>=0?c=c+this.stride[1]*i|0:(s.push(this.shape[1]),l.push(this.stride[1])),"number"==typeof a&&a>=0?c=c+this.stride[2]*a|0:(s.push(this.shape[2]),l.push(this.stride[2])),"number"==typeof o&&o>=0?c=c+this.stride[3]*o|0:(s.push(this.shape[3]),l.push(this.stride[3])),(0,n[s.length+1])(this.data,s,l,c)},function(r,n,i,o){return new a(r,n[0],n[1],n[2],n[3],i[0],i[1],i[2],i[3],o)}},5:function(r,n,i){function a(r,n,i,a,o,s,l,c,u,f,h,p){this.data=r,this.shape=[n,i,a,o,s],this.stride=[l,c,u,f,h],this.offset=0|p}var o=a.prototype;return o.dtype=r,o.dimension=5,Object.defineProperty(o,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(o,"order",{get:i}),o.set=function(n,i,a,o,s,l){return"generic"===r?this.data.set(this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a+this.stride[3]*o+this.stride[4]*s,l):this.data[this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a+this.stride[3]*o+this.stride[4]*s]=l},o.get=function(n,i,a,o,s){return"generic"===r?this.data.get(this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a+this.stride[3]*o+this.stride[4]*s):this.data[this.offset+this.stride[0]*n+this.stride[1]*i+this.stride[2]*a+this.stride[3]*o+this.stride[4]*s]},o.index=function(r,n,i,a,o){return this.offset+this.stride[0]*r+this.stride[1]*n+this.stride[2]*i+this.stride[3]*a+this.stride[4]*o},o.hi=function(r,n,i,o,s){return new a(this.data,"number"!=typeof r||r<0?this.shape[0]:0|r,"number"!=typeof n||n<0?this.shape[1]:0|n,"number"!=typeof i||i<0?this.shape[2]:0|i,"number"!=typeof o||o<0?this.shape[3]:0|o,"number"!=typeof s||s<0?this.shape[4]:0|s,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},o.lo=function(r,n,i,o,s){var l=this.offset,c=0,u=this.shape[0],f=this.shape[1],h=this.shape[2],p=this.shape[3],d=this.shape[4],m=this.stride[0],g=this.stride[1],v=this.stride[2],y=this.stride[3],x=this.stride[4];return"number"==typeof r&&r>=0&&(l+=m*(c=0|r),u-=c),"number"==typeof n&&n>=0&&(l+=g*(c=0|n),f-=c),"number"==typeof i&&i>=0&&(l+=v*(c=0|i),h-=c),"number"==typeof o&&o>=0&&(l+=y*(c=0|o),p-=c),"number"==typeof s&&s>=0&&(l+=x*(c=0|s),d-=c),new a(this.data,u,f,h,p,d,m,g,v,y,x,l)},o.step=function(r,n,i,o,s){var l=this.shape[0],c=this.shape[1],u=this.shape[2],f=this.shape[3],h=this.shape[4],p=this.stride[0],d=this.stride[1],m=this.stride[2],g=this.stride[3],v=this.stride[4],y=this.offset,x=0,b=Math.ceil;return"number"==typeof r&&((x=0|r)<0?(y+=p*(l-1),l=b(-l/x)):l=b(l/x),p*=x),"number"==typeof n&&((x=0|n)<0?(y+=d*(c-1),c=b(-c/x)):c=b(c/x),d*=x),"number"==typeof i&&((x=0|i)<0?(y+=m*(u-1),u=b(-u/x)):u=b(u/x),m*=x),"number"==typeof o&&((x=0|o)<0?(y+=g*(f-1),f=b(-f/x)):f=b(f/x),g*=x),"number"==typeof s&&((x=0|s)<0?(y+=v*(h-1),h=b(-h/x)):h=b(h/x),v*=x),new a(this.data,l,c,u,f,h,p,d,m,g,v,y)},o.transpose=function(r,n,i,o,s){r=void 0===r?0:0|r,n=void 0===n?1:0|n,i=void 0===i?2:0|i,o=void 0===o?3:0|o,s=void 0===s?4:0|s;var l=this.shape,c=this.stride;return new a(this.data,l[r],l[n],l[i],l[o],l[s],c[r],c[n],c[i],c[o],c[s],this.offset)},o.pick=function(r,i,a,o,s){var l=[],c=[],u=this.offset;return"number"==typeof r&&r>=0?u=u+this.stride[0]*r|0:(l.push(this.shape[0]),c.push(this.stride[0])),"number"==typeof i&&i>=0?u=u+this.stride[1]*i|0:(l.push(this.shape[1]),c.push(this.stride[1])),"number"==typeof a&&a>=0?u=u+this.stride[2]*a|0:(l.push(this.shape[2]),c.push(this.stride[2])),"number"==typeof o&&o>=0?u=u+this.stride[3]*o|0:(l.push(this.shape[3]),c.push(this.stride[3])),"number"==typeof s&&s>=0?u=u+this.stride[4]*s|0:(l.push(this.shape[4]),c.push(this.stride[4])),(0,n[l.length+1])(this.data,l,c,u)},function(r,n,i,o){return new a(r,n[0],n[1],n[2],n[3],n[4],i[0],i[1],i[2],i[3],i[4],o)}}},u={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};n.exports=function(r,n,i,s){if(void 0===r)return(0,u.array[0])([]);"number"==typeof r&&(r=[r]),void 0===n&&(n=[r.length]);var f=n.length;if(void 0===i){i=Array(f);for(var h=f-1,p=1;h>=0;--h)i[h]=p,p*=n[h]}if(void 0===s)for(h=0,s=0;h<f;++h)i[h]<0&&(s-=(n[h]-1)*i[h]);for(var d=function(r){if(a(r))return"buffer";if(o)switch(Object.prototype.toString.call(r)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(r)?"array":"generic"}(r),m=u[d];m.length<=f+1;)m.push(function(r,n){var i=c[-1===n?"T":String(n)];return -1===n?i(r):0===n?i(r,u[r][0]):i(r,u[r],l)}(d,m.length-1));return(0,m[f+1])(r,n,i,s)}},{"is-buffer":237}],260:[function(r,n,i){"use strict";var a=r("double-bits");n.exports=function(r,n){if(isNaN(r)||isNaN(n))return NaN;if(r===n)return r;if(0===r)return n<0?-.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005:5e-324;var i=a.hi(r),o=a.lo(r);return n>r==r>0?4294967295===o?(i+=1,o=0):o+=1:0===o?(o=4294967295,i-=1):o-=1,a.pack(o,i)}},{"double-bits":64}],261:[function(r,n,i){i.vertexNormals=function(r,n,i){for(var a=n.length,o=Array(a),s=void 0===i?1e-6:i,l=0;l<a;++l)o[l]=[0,0,0];for(l=0;l<r.length;++l)for(var c=r[l],u=0,f=c[c.length-1],h=c[0],p=0;p<c.length;++p){u=f,f=h,h=c[(p+1)%c.length];for(var d=n[u],m=n[f],g=n[h],v=[,,,],y=0,x=[,,,],b=0,_=0;_<3;++_)v[_]=d[_]-m[_],y+=v[_]*v[_],x[_]=g[_]-m[_],b+=x[_]*x[_];if(y*b>s){var w=o[f],T=1/Math.sqrt(y*b);for(_=0;_<3;++_){var k=(_+1)%3,A=(_+2)%3;w[_]+=T*(x[k]*v[A]-x[A]*v[k])}}}for(l=0;l<a;++l){w=o[l];var M=0;for(_=0;_<3;++_)M+=w[_]*w[_];if(M>s)for(T=1/Math.sqrt(M),_=0;_<3;++_)w[_]*=T;else for(_=0;_<3;++_)w[_]=0}return o},i.faceNormals=function(r,n,i){for(var a=r.length,o=Array(a),s=void 0===i?1e-6:i,l=0;l<a;++l){for(var c=r[l],u=[,,,],f=0;f<3;++f)u[f]=n[c[f]];var h=[,,,],p=[,,,];for(f=0;f<3;++f)h[f]=u[1][f]-u[0][f],p[f]=u[2][f]-u[0][f];var d=[,,,],m=0;for(f=0;f<3;++f){var g=(f+1)%3,v=(f+2)%3;d[f]=h[g]*p[v]-h[v]*p[g],m+=d[f]*d[f]}for(f=0,m=m>s?1/Math.sqrt(m):0;f<3;++f)d[f]*=m;o[l]=d}return o}},{}],262:[function(r,n,i){"use strict";n.exports=function(r,n,i,a,o,s,l,c,u,f){var h=n+s+f;if(p>0){var p=Math.sqrt(h+1);r[0]=.5*(l-u)/p,r[1]=.5*(c-a)/p,r[2]=.5*(i-s)/p,r[3]=.5*p}else{var d=Math.max(n,s,f);p=Math.sqrt(2*d-h+1),n>=d?(r[0]=.5*p,r[1]=.5*(o+i)/p,r[2]=.5*(c+a)/p,r[3]=.5*(l-u)/p):s>=d?(r[0]=.5*(i+o)/p,r[1]=.5*p,r[2]=.5*(u+l)/p,r[3]=.5*(c-a)/p):(r[0]=.5*(a+c)/p,r[1]=.5*(l+u)/p,r[2]=.5*p,r[3]=.5*(i-o)/p)}return r}},{}],263:[function(r,n,i){"use strict";n.exports=function(r){var n=(r=r||{}).center||[0,0,0],i=r.rotation||[0,0,0,1],a=r.radius||1;n=[].slice.call(n,0,3),h(i=[].slice.call(i,0,4),i);var o=new p(i,n,Math.log(a));return o.setDistanceLimits(r.zoomMin,r.zoomMax),("eye"in r||"up"in r)&&o.lookAt(0,r.eye,r.center,r.up),o};var a=r("filtered-vector"),o=r("gl-mat4/lookAt"),s=r("gl-mat4/fromQuat"),l=r("gl-mat4/invert"),c=r("./lib/quatFromFrame");function u(r,n,i){return Math.sqrt(Math.pow(r,2)+Math.pow(n,2)+Math.pow(i,2))}function f(r,n,i,a){return Math.sqrt(Math.pow(r,2)+Math.pow(n,2)+Math.pow(i,2)+Math.pow(a,2))}function h(r,n){var i=n[0],a=n[1],o=n[2],s=n[3],l=f(i,a,o,s);l>1e-6?(r[0]=i/l,r[1]=a/l,r[2]=o/l,r[3]=s/l):(r[0]=r[1]=r[2]=0,r[3]=1)}function p(r,n,i){this.radius=a([i]),this.center=a(n),this.rotation=a(r),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var d=p.prototype;d.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},d.recalcMatrix=function(r){this.radius.curve(r),this.center.curve(r),this.rotation.curve(r);var n=this.computedRotation;h(n,n);var i=this.computedMatrix;s(i,n);var a=this.computedCenter,o=this.computedEye,l=this.computedUp,c=Math.exp(this.computedRadius[0]);o[0]=a[0]+c*i[2],o[1]=a[1]+c*i[6],o[2]=a[2]+c*i[10],l[0]=i[1],l[1]=i[5],l[2]=i[9];for(var u=0;u<3;++u){for(var f=0,p=0;p<3;++p)f+=i[u+4*p]*o[p];i[12+u]=-f}},d.getMatrix=function(r,n){this.recalcMatrix(r);var i=this.computedMatrix;if(n){for(var a=0;a<16;++a)n[a]=i[a];return n}return i},d.idle=function(r){this.center.idle(r),this.radius.idle(r),this.rotation.idle(r)},d.flush=function(r){this.center.flush(r),this.radius.flush(r),this.rotation.flush(r)},d.pan=function(r,n,i,a){n=n||0,i=i||0,a=a||0,this.recalcMatrix(r);var o=this.computedMatrix,s=o[1],l=o[5],c=o[9],f=u(s,l,c);s/=f,l/=f,c/=f;var h=o[0],p=o[4],d=o[8],m=h*s+p*l+d*c,g=u(h-=s*m,p-=l*m,d-=c*m);h/=g,p/=g,d/=g;var v=o[2],y=o[6],x=o[10],b=v*s+y*l+x*c,_=v*h+y*p+x*d,w=u(v-=b*s+_*h,y-=b*l+_*p,x-=b*c+_*d);v/=w,y/=w,x/=w;var T=h*n+s*i,k=p*n+l*i,A=d*n+c*i;this.center.move(r,T,k,A);var M=Math.exp(this.computedRadius[0]);M=Math.max(1e-4,M+a),this.radius.set(r,Math.log(M))},d.rotate=function(r,n,i,a){this.recalcMatrix(r),n=n||0,i=i||0;var o=this.computedMatrix,s=o[0],l=o[4],c=o[8],h=o[1],p=o[5],d=o[9],m=o[2],g=o[6],v=o[10],y=n*s+i*h,x=n*l+i*p,b=n*c+i*d,_=-(g*b-v*x),w=-(v*y-m*b),T=-(m*x-g*y),k=Math.sqrt(Math.max(0,1-Math.pow(_,2)-Math.pow(w,2)-Math.pow(T,2))),A=f(_,w,T,k);A>1e-6?(_/=A,w/=A,T/=A,k/=A):(_=w=T=0,k=1);var M=this.computedRotation,S=M[0],E=M[1],L=M[2],C=M[3],P=S*k+C*_+E*T-L*w,I=E*k+C*w+L*_-S*T,O=L*k+C*T+S*w-E*_,z=C*k-S*_-E*w-L*T;if(a){var D=Math.sin(a)/u(_=m,w=g,T=v);_*=D,w*=D,T*=D,z=z*(k=Math.cos(n))-(P=P*k+z*_+I*T-O*w)*_-(I=I*k+z*w+O*_-P*T)*w-(O=O*k+z*T+P*w-I*_)*T}var R=f(P,I,O,z);R>1e-6?(P/=R,I/=R,O/=R,z/=R):(P=I=O=0,z=1),this.rotation.set(r,P,I,O,z)},d.lookAt=function(r,n,i,a){this.recalcMatrix(r),i=i||this.computedCenter,n=n||this.computedEye,a=a||this.computedUp;var s=this.computedMatrix;o(s,n,i,a);var l=this.computedRotation;c(l,s[0],s[1],s[2],s[4],s[5],s[6],s[8],s[9],s[10]),h(l,l),this.rotation.set(r,l[0],l[1],l[2],l[3]);for(var u=0,f=0;f<3;++f)u+=Math.pow(i[f]-n[f],2);this.radius.set(r,.5*Math.log(Math.max(u,1e-6))),this.center.set(r,i[0],i[1],i[2])},d.translate=function(r,n,i,a){this.center.move(r,n||0,i||0,a||0)},d.setMatrix=function(r,n){var i=this.computedRotation;c(i,n[0],n[1],n[2],n[4],n[5],n[6],n[8],n[9],n[10]),h(i,i),this.rotation.set(r,i[0],i[1],i[2],i[3]);var a=this.computedMatrix;l(a,n);var o=a[15];if(Math.abs(o)>1e-6){var s=a[12]/o,u=a[13]/o,f=a[14]/o;this.recalcMatrix(r);var p=Math.exp(this.computedRadius[0]);this.center.set(r,s-a[2]*p,u-a[6]*p,f-a[10]*p),this.radius.idle(r)}else this.center.idle(r),this.radius.idle(r)},d.setDistance=function(r,n){n>0&&this.radius.set(r,Math.log(n))},d.setDistanceLimits=function(r,n){r=r>0?Math.log(r):-1/0,n=Math.max(n=n>0?Math.log(n):1/0,r),this.radius.bounds[0][0]=r,this.radius.bounds[1][0]=n},d.getDistanceLimits=function(r){var n=this.radius.bounds;return r?(r[0]=Math.exp(n[0][0]),r[1]=Math.exp(n[1][0]),r):[Math.exp(n[0][0]),Math.exp(n[1][0])]},d.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},d.fromJSON=function(r){var n=this.lastT(),i=r.center;i&&this.center.set(n,i[0],i[1],i[2]);var a=r.rotation;a&&this.rotation.set(n,a[0],a[1],a[2],a[3]);var o=r.distance;o&&o>0&&this.radius.set(n,Math.log(o)),this.setDistanceLimits(r.zoomMin,r.zoomMax)}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(r,n,i){/*!
 * pad-left <https://github.com/jonschlinkert/pad-left>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT license.
 */"use strict";var a=r("repeat-string");n.exports=function(r,n,i){return a(i=void 0!==i?i+"":" ",n)+r}},{"repeat-string":277}],265:[function(r,n,i){n.exports=function(r,n){n||(n=[0,""]);var i=parseFloat(r=String(r),10);return n[0]=i,n[1]=r.match(/[\d.\-\+]*\s*(.*)/)[1]||"",n}},{}],266:[function(r,n,i){"use strict";n.exports=function(r,n){for(var i=0|n.length,o=r.length,s=[Array(i),Array(i)],l=0;l<i;++l)s[0][l]=[],s[1][l]=[];for(l=0;l<o;++l){var c=r[l];s[0][c[0]].push(c),s[1][c[1]].push(c)}var u=[];for(l=0;l<i;++l)s[0][l].length+s[1][l].length===0&&u.push([l]);function f(r,n){var i=s[n][r[n]];i.splice(i.indexOf(r),1)}function h(r,i,o){for(var l,c,u,h=0;h<2;++h)if(s[h][i].length>0){l=s[h][i][0],u=h;break}c=l[1^u];for(var p=0;p<2;++p)for(var d=s[p][i],m=0;m<d.length;++m){var g=d[m],v=g[1^p];a(n[r],n[i],n[c],n[v])>0&&(l=g,c=v,u=p)}return o||l&&f(l,u),c}for(l=0;l<i;++l)for(var p=0;p<2;++p){for(var d=[];s[p][l].length>0;){s[0][l].length;var m=function(r,i){var o=s[i][r][0],l=[r];f(o,i);for(var c=o[1^i];;){for(;c!==r;)l.push(c),c=h(l[l.length-2],c,!1);if(s[0][r].length+s[1][r].length===0)break;var u=l[l.length-1],p=l[1],d=h(u,r,!0);if(0>a(n[u],n[r],n[p],n[d]))break;l.push(r),c=h(u,r)}return l}(l,p);m[1]===m[m.length-1]?d.push.apply(d,m):(d.length>0&&u.push(d),d=m)}d.length>0&&u.push(d)}return u};var a=r("compare-angle")},{"compare-angle":54}],267:[function(r,n,i){"use strict";n.exports=function(r,n){for(var i=a(r,n.length),o=Array(n.length),s=Array(n.length),l=[],c=0;c<n.length;++c){var u=i[c].length;s[c]=u,o[c]=!0,u<=1&&l.push(c)}for(;l.length>0;){var f=l.pop();o[f]=!1;var h=i[f];for(c=0;c<h.length;++c){var p=h[c];0==--s[p]&&l.push(p)}}var d=Array(n.length),m=[];for(c=0;c<n.length;++c)o[c]?(f=m.length,d[c]=f,m.push(n[c])):d[c]=-1;var g=[];for(c=0;c<r.length;++c){var v=r[c];o[v[0]]&&o[v[1]]&&g.push([d[v[0]],d[v[1]]])}return[g,m]};var a=r("edges-to-adjacency-list")},{"edges-to-adjacency-list":66}],268:[function(r,n,i){"use strict";n.exports=function(r,n){var i=f(r,n);r=i[0];for(var p=(n=i[1]).length,d=(r.length,a(r,n.length)),m=0;m<p;++m)if(d[m].length%2==1)throw Error("planar-graph-to-polyline: graph must be manifold");var g=o(r,n),v=(g=g.filter(function(r){for(var i=r.length,a=[0],o=0;o<i;++o){var s=n[r[o]],u=n[r[(o+1)%i]],f=l(-s[0],s[1]),h=l(-s[0],u[1]),p=l(u[0],s[1]),d=l(u[0],u[1]);a=c(a,c(c(f,h),c(p,d)))}return a[a.length-1]>0})).length,y=Array(v),x=Array(v);for(m=0;m<v;++m){y[m]=m;var b=Array(v),_=s([g[m].map(function(r){return n[r]})]),w=0;t:for(var T=0;T<v;++T)if(b[T]=0,m!==T){for(var k=(q=g[T]).length,A=0;A<k;++A){var M=_(n[q[A]]);if(0!==M){M<0&&(b[T]=1,w+=1);continue t}}b[T]=1,w+=1}x[m]=[w,m,b]}for(x.sort(function(r,n){return n[0]-r[0]}),m=0;m<v;++m){var S=(b=x[m])[1],E=b[2];for(T=0;T<v;++T)E[T]&&(y[T]=S)}var L=function(r){for(var n=Array(r),i=0;i<r;++i)n[i]=[];return n}(v);for(m=0;m<v;++m)L[m].push(y[m]),L[y[m]].push(m);var C={},P=h(p,!1);for(m=0;m<v;++m)for(k=(q=g[m]).length,T=0;T<k;++T){var I=q[T],O=q[(T+1)%k],z=Math.min(I,O)+":"+Math.max(I,O);if(z in C){var D=C[z];L[D].push(m),L[m].push(D),P[I]=P[O]=!0}else C[z]=m}function R(r){for(var n=r.length,i=0;i<n;++i)if(!P[r[i]])return!1;return!0}var F=[],B=h(v,-1);for(m=0;m<v;++m)y[m]!==m||R(g[m])?B[m]=-1:(F.push(m),B[m]=0);for(i=[];F.length>0;){var N=F.pop(),j=L[N];u(j,function(r,n){return r-n});var U,V=j.length,H=B[N];if(0===H){var q=g[N];U=[q]}for(m=0;m<V;++m){var G=j[m];!(B[G]>=0)&&(B[G]=1^H,F.push(G),0===H&&(R(q=g[G])||(q.reverse(),U.push(q))))}0===H&&i.push(U)}return i};var a=r("edges-to-adjacency-list"),o=r("planar-dual"),s=r("point-in-big-polygon"),l=r("two-product"),c=r("robust-sum"),u=r("uniq"),f=r("./lib/trim-leaves");function h(r,n){for(var i=Array(r),a=0;a<r;++a)i[a]=n;return i}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(r,n,i){n.exports=function(r){for(var n,i,s,c,h=r.length,p=[],d=[],m=0;m<h;++m)for(var g=r[m],v=g.length,y=v-1,x=0;x<v;y=x++){var b=g[y],_=g[x];b[0]===_[0]?d.push([b,_]):p.push([b,_])}if(0===p.length)return 0===d.length?f:(c=u(d),function(r){return c(r[0],r[1])?0:1});var w=o(p),T=(n=w.slabs,i=w.coordinates,function(r){var o=l.le(i,r[0]);if(o<0)return 1;var s=n[o];if(!s){if(!(o>0&&i[o]===r[0]))return 1;s=n[o-1]}for(var c=1;s;){var u=s.key,f=a(r,u[0],u[1]);if(u[0][0]<u[1][0]){if(f<0)s=s.left;else{if(!(f>0))return 0;c=-1,s=s.right}}else if(f>0)s=s.left;else{if(!(f<0))return 0;c=1,s=s.right}}return c});return 0===d.length?T:(s=u(d),function(r){return s(r[0],r[1])?0:T(r)})};var a=r("robust-orientation")[3],o=r("slab-decomposition"),s=r("interval-tree-1d"),l=r("binary-search-bounds");function c(){return!0}function u(r){for(var n={},i=0;i<r.length;++i){var a=r[i],o=a[0][0],l=a[0][1],u=a[1][1],f=[Math.min(l,u),Math.max(l,u)];o in n?n[o].push(f):n[o]=[f]}var h={},p=Object.keys(n);for(i=0;i<p.length;++i){var d=n[p[i]];h[p[i]]=s(d)}return function(r,n){var i=h[r];return!!i&&!!i.queryPoint(n,c)}}function f(r){return 1}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(r,n,i){"use strict";var a=new Float64Array(4),o=new Float64Array(4),s=new Float64Array(4);n.exports=function(r,n,i,l,c){a.length<l.length&&(a=new Float64Array(l.length),o=new Float64Array(l.length),s=new Float64Array(l.length));for(var u=0;u<l.length;++u)a[u]=r[u]-l[u],o[u]=n[u]-r[u],s[u]=i[u]-r[u];var f=0,h=0,p=0,d=0,m=0,g=0;for(u=0;u<l.length;++u){var v=o[u],y=s[u],x=a[u];f+=v*v,h+=v*y,p+=y*y,d+=x*v,m+=x*y,g+=x*x}var b,_,w,T,k,A=Math.abs(f*p-h*h),M=h*m-p*d,S=h*d-f*m;if(M+S<=A){if(M<0)S<0&&d<0?(S=0,-d>=f?(M=1,b=f+2*d+g):b=d*(M=-d/f)+g):(M=0,m>=0?(S=0,b=g):-m>=p?(S=1,b=p+2*m+g):b=m*(S=-m/p)+g);else if(S<0)S=0,d>=0?(M=0,b=g):-d>=f?(M=1,b=f+2*d+g):b=d*(M=-d/f)+g;else{var E=1/A;b=(M*=E)*(f*M+h*(S*=E)+2*d)+S*(h*M+p*S+2*m)+g}}else M<0?(w=p+m)>(_=h+d)?(T=w-_)>=(k=f-2*h+p)?(M=1,S=0,b=f+2*d+g):b=(M=T/k)*(f*M+h*(S=1-M)+2*d)+S*(h*M+p*S+2*m)+g:(M=0,w<=0?(S=1,b=p+2*m+g):m>=0?(S=0,b=g):b=m*(S=-m/p)+g):S<0?(w=f+d)>(_=h+m)?(T=w-_)>=(k=f-2*h+p)?(S=1,M=0,b=p+2*m+g):b=(M=1-(S=T/k))*(f*M+h*S+2*d)+S*(h*M+p*S+2*m)+g:(S=0,w<=0?(M=1,b=f+2*d+g):d>=0?(M=0,b=g):b=d*(M=-d/f)+g):(T=p+m-h-d)<=0?(M=0,S=1,b=p+2*m+g):T>=(k=f-2*h+p)?(M=1,S=0,b=f+2*d+g):b=(M=T/k)*(f*M+h*(S=1-M)+2*d)+S*(h*M+p*S+2*m)+g;var L=1-M-S;for(u=0;u<l.length;++u)c[u]=L*r[u]+M*n[u]+S*i[u];return b<0?0:b}},{}],271:[function(r,n,i){n.exports=r("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(r,n,i){"use strict";var a=r("big-rat/add");n.exports=function(r,n){for(var i=r.length,o=Array(i),s=0;s<i;++s)o[s]=a(r[s],n[s]);return o}},{"big-rat/add":15}],273:[function(r,n,i){"use strict";n.exports=function(r){for(var n=Array(r.length),i=0;i<r.length;++i)n[i]=a(r[i]);return n};var a=r("big-rat")},{"big-rat":18}],274:[function(r,n,i){"use strict";var a=r("big-rat"),o=r("big-rat/mul");n.exports=function(r,n){for(var i=a(n),s=r.length,l=Array(s),c=0;c<s;++c)l[c]=o(r[c],i);return l}},{"big-rat":18,"big-rat/mul":27}],275:[function(r,n,i){"use strict";var a=r("big-rat/sub");n.exports=function(r,n){for(var i=r.length,o=Array(i),s=0;s<i;++s)o[s]=a(r[s],n[s]);return o}},{"big-rat/sub":29}],276:[function(r,n,i){"use strict";var a=r("compare-cell"),o=r("compare-oriented-cell"),s=r("cell-orientation");n.exports=function(r){r.sort(o);for(var n=r.length,i=0,l=0;l<n;++l){var c=r[l],u=s(c);if(0!==u){if(i>0){var f=r[i-1];if(0===a(c,f)&&s(f)!==u){i-=1;continue}}r[i++]=c}}return r.length=i,r}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(r,n,i){/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */"use strict";var a,o="";n.exports=function(r,n){if("string"!=typeof r)throw TypeError("expected a string");if(1===n)return r;if(2===n)return r+r;var i=r.length*n;if(a!==r||void 0===a)a=r,o="";else if(o.length>=i)return o.substr(0,i);for(;i>o.length&&n>1;)1&n&&(o+=r),n>>=1,r+=r;return o=(o+=r).substr(0,i)}},{}],278:[function(r,n,a){(function(r){(function(){n.exports=r.performance&&r.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],279:[function(r,n,i){"use strict";n.exports=function(r){for(var n,i=r.length,a=r[r.length-1],o=i,s=i-2;s>=0;--s){var l=a,c=r[s];(n=c-((a=l+c)-l))&&(r[--o]=a,a=n)}var u=0;for(s=o;s<i;++s)l=r[s],(n=(c=a)-((a=l+c)-l))&&(r[u++]=n);return r[u++]=a,r.length=u,r}},{}],280:[function(r,n,i){"use strict";var a=r("two-product"),o=r("robust-sum"),s=r("robust-scale"),l=r("robust-compress");function c(r){return(2===r?function(r,n,i,a){return function(n){return a(r(i(n[0][0],n[1][1]),i(-n[0][1],n[1][0])))}}:3===r?function(r,n,i,a){return function(o){return a(r(n(r(i(o[1][1],o[2][2]),i(-o[1][2],o[2][1])),o[0][0]),r(n(r(i(o[1][0],o[2][2]),i(-o[1][2],o[2][0])),-o[0][1]),n(r(i(o[1][0],o[2][1]),i(-o[1][1],o[2][0])),o[0][2]))))}}:void 0)(o,s,a,l)}var u=[function(){return[0]},function(r){return[r[0][0]]}];function f(r,n,i,a,o,s){return function(l){switch(l.length){case 0:return r(l);case 1:return n(l);case 2:return i(l);case 3:return a(l)}var c=o[l.length];return c||(c=o[l.length]=s(l.length)),c(l)}}!function(){for(;u.length<4;)u.push(c(u.length));n.exports=f.apply(void 0,u.concat([u,c]));for(var r=0;r<u.length;++r)n.exports[r]=u[r]}()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(r,n,i){"use strict";var a=r("two-product"),o=r("robust-sum");n.exports=function(r,n){for(var i=a(r[0],n[0]),s=1;s<r.length;++s)i=o(i,a(r[s],n[s]));return i}},{"robust-sum":289,"two-product":306}],282:[function(r,n,i){"use strict";var a=r("two-product"),o=r("robust-sum"),s=r("robust-subtract"),l=r("robust-scale");function c(r){return(3===r?function(r,n,i,a){return function(o,s,l){var c=i(o[0],o[0]),u=a(c,s[0]),f=a(c,l[0]),h=i(s[0],s[0]),p=a(h,o[0]),d=a(h,l[0]),m=i(l[0],l[0]),g=a(m,o[0]),v=r(n(a(m,s[0]),d),n(p,u)),y=n(g,f),x=n(v,y);return x[x.length-1]}}:4===r?function(r,n,i,a){return function(o,s,l,c){var u=r(i(o[0],o[0]),i(o[1],o[1])),f=a(u,s[0]),h=a(u,l[0]),p=a(u,c[0]),d=r(i(s[0],s[0]),i(s[1],s[1])),m=a(d,o[0]),g=a(d,l[0]),v=a(d,c[0]),y=r(i(l[0],l[0]),i(l[1],l[1])),x=a(y,o[0]),b=a(y,s[0]),_=a(y,c[0]),w=r(i(c[0],c[0]),i(c[1],c[1])),T=a(w,o[0]),k=a(w,s[0]),A=a(w,l[0]),M=r(r(a(n(A,_),s[1]),r(a(n(k,v),-l[1]),a(n(b,g),c[1]))),r(a(n(k,v),o[1]),r(a(n(T,p),-s[1]),a(n(m,f),c[1])))),S=r(r(a(n(A,_),o[1]),r(a(n(T,p),-l[1]),a(n(x,h),c[1]))),r(a(n(b,g),o[1]),r(a(n(x,h),-s[1]),a(n(m,f),l[1])))),E=n(M,S);return E[E.length-1]}}:5===r?function(r,n,i,a){return function(o,s,l,c,u){var f=r(i(o[0],o[0]),r(i(o[1],o[1]),i(o[2],o[2]))),h=a(f,s[0]),p=a(f,l[0]),d=a(f,c[0]),m=a(f,u[0]),g=r(i(s[0],s[0]),r(i(s[1],s[1]),i(s[2],s[2]))),v=a(g,o[0]),y=a(g,l[0]),x=a(g,c[0]),b=a(g,u[0]),_=r(i(l[0],l[0]),r(i(l[1],l[1]),i(l[2],l[2]))),w=a(_,o[0]),T=a(_,s[0]),k=a(_,c[0]),A=a(_,u[0]),M=r(i(c[0],c[0]),r(i(c[1],c[1]),i(c[2],c[2]))),S=a(M,o[0]),E=a(M,s[0]),L=a(M,l[0]),C=a(M,u[0]),P=r(i(u[0],u[0]),r(i(u[1],u[1]),i(u[2],u[2]))),I=a(P,o[0]),O=a(P,s[0]),z=a(P,l[0]),D=a(P,c[0]),R=r(r(r(a(r(a(n(D,C),l[1]),r(a(n(z,A),-c[1]),a(n(L,k),u[1]))),s[2]),r(a(r(a(n(D,C),s[1]),r(a(n(O,b),-c[1]),a(n(E,x),u[1]))),-l[2]),a(r(a(n(z,A),s[1]),r(a(n(O,b),-l[1]),a(n(T,y),u[1]))),c[2]))),r(a(r(a(n(L,k),s[1]),r(a(n(E,x),-l[1]),a(n(T,y),c[1]))),-u[2]),r(a(r(a(n(D,C),s[1]),r(a(n(O,b),-c[1]),a(n(E,x),u[1]))),o[2]),a(r(a(n(D,C),o[1]),r(a(n(I,m),-c[1]),a(n(S,d),u[1]))),-s[2])))),r(r(a(r(a(n(O,b),o[1]),r(a(n(I,m),-s[1]),a(n(v,h),u[1]))),c[2]),r(a(r(a(n(E,x),o[1]),r(a(n(S,d),-s[1]),a(n(v,h),c[1]))),-u[2]),a(r(a(n(L,k),s[1]),r(a(n(E,x),-l[1]),a(n(T,y),c[1]))),o[2]))),r(a(r(a(n(L,k),o[1]),r(a(n(S,d),-l[1]),a(n(w,p),c[1]))),-s[2]),r(a(r(a(n(E,x),o[1]),r(a(n(S,d),-s[1]),a(n(v,h),c[1]))),l[2]),a(r(a(n(T,y),o[1]),r(a(n(w,p),-s[1]),a(n(v,h),l[1]))),-c[2]))))),F=r(r(r(a(r(a(n(D,C),l[1]),r(a(n(z,A),-c[1]),a(n(L,k),u[1]))),o[2]),a(r(a(n(D,C),o[1]),r(a(n(I,m),-c[1]),a(n(S,d),u[1]))),-l[2])),r(a(r(a(n(z,A),o[1]),r(a(n(I,m),-l[1]),a(n(w,p),u[1]))),c[2]),a(r(a(n(L,k),o[1]),r(a(n(S,d),-l[1]),a(n(w,p),c[1]))),-u[2]))),r(r(a(r(a(n(z,A),s[1]),r(a(n(O,b),-l[1]),a(n(T,y),u[1]))),o[2]),a(r(a(n(z,A),o[1]),r(a(n(I,m),-l[1]),a(n(w,p),u[1]))),-s[2])),r(a(r(a(n(O,b),o[1]),r(a(n(I,m),-s[1]),a(n(v,h),u[1]))),l[2]),a(r(a(n(T,y),o[1]),r(a(n(w,p),-s[1]),a(n(v,h),l[1]))),-u[2])))),B=n(R,F);return B[B.length-1]}}:function(r,n,i,a){return function(o,s,l,c,u,f){var h=r(r(i(o[0],o[0]),i(o[1],o[1])),r(i(o[2],o[2]),i(o[3],o[3]))),p=a(h,s[0]),d=a(h,l[0]),m=a(h,c[0]),g=a(h,u[0]),v=a(h,f[0]),y=r(r(i(s[0],s[0]),i(s[1],s[1])),r(i(s[2],s[2]),i(s[3],s[3]))),x=a(y,o[0]),b=a(y,l[0]),_=a(y,c[0]),w=a(y,u[0]),T=a(y,f[0]),k=r(r(i(l[0],l[0]),i(l[1],l[1])),r(i(l[2],l[2]),i(l[3],l[3]))),A=a(k,o[0]),M=a(k,s[0]),S=a(k,c[0]),E=a(k,u[0]),L=a(k,f[0]),C=r(r(i(c[0],c[0]),i(c[1],c[1])),r(i(c[2],c[2]),i(c[3],c[3]))),P=a(C,o[0]),I=a(C,s[0]),O=a(C,l[0]),z=a(C,u[0]),D=a(C,f[0]),R=r(r(i(u[0],u[0]),i(u[1],u[1])),r(i(u[2],u[2]),i(u[3],u[3]))),F=a(R,o[0]),B=a(R,s[0]),N=a(R,l[0]),j=a(R,c[0]),U=a(R,f[0]),V=r(r(i(f[0],f[0]),i(f[1],f[1])),r(i(f[2],f[2]),i(f[3],f[3]))),H=a(V,o[0]),q=a(V,s[0]),G=a(V,l[0]),Y=a(V,c[0]),W=a(V,u[0]),X=r(r(r(a(r(r(a(r(a(n(W,U),c[1]),r(a(n(Y,D),-u[1]),a(n(j,z),f[1]))),l[2]),a(r(a(n(W,U),l[1]),r(a(n(G,L),-u[1]),a(n(N,E),f[1]))),-c[2])),r(a(r(a(n(Y,D),l[1]),r(a(n(G,L),-c[1]),a(n(O,S),f[1]))),u[2]),a(r(a(n(j,z),l[1]),r(a(n(N,E),-c[1]),a(n(O,S),u[1]))),-f[2]))),s[3]),r(a(r(r(a(r(a(n(W,U),c[1]),r(a(n(Y,D),-u[1]),a(n(j,z),f[1]))),s[2]),a(r(a(n(W,U),s[1]),r(a(n(q,T),-u[1]),a(n(B,w),f[1]))),-c[2])),r(a(r(a(n(Y,D),s[1]),r(a(n(q,T),-c[1]),a(n(I,_),f[1]))),u[2]),a(r(a(n(j,z),s[1]),r(a(n(B,w),-c[1]),a(n(I,_),u[1]))),-f[2]))),-l[3]),a(r(r(a(r(a(n(W,U),l[1]),r(a(n(G,L),-u[1]),a(n(N,E),f[1]))),s[2]),a(r(a(n(W,U),s[1]),r(a(n(q,T),-u[1]),a(n(B,w),f[1]))),-l[2])),r(a(r(a(n(G,L),s[1]),r(a(n(q,T),-l[1]),a(n(M,b),f[1]))),u[2]),a(r(a(n(N,E),s[1]),r(a(n(B,w),-l[1]),a(n(M,b),u[1]))),-f[2]))),c[3]))),r(r(a(r(r(a(r(a(n(Y,D),l[1]),r(a(n(G,L),-c[1]),a(n(O,S),f[1]))),s[2]),a(r(a(n(Y,D),s[1]),r(a(n(q,T),-c[1]),a(n(I,_),f[1]))),-l[2])),r(a(r(a(n(G,L),s[1]),r(a(n(q,T),-l[1]),a(n(M,b),f[1]))),c[2]),a(r(a(n(O,S),s[1]),r(a(n(I,_),-l[1]),a(n(M,b),c[1]))),-f[2]))),-u[3]),a(r(r(a(r(a(n(j,z),l[1]),r(a(n(N,E),-c[1]),a(n(O,S),u[1]))),s[2]),a(r(a(n(j,z),s[1]),r(a(n(B,w),-c[1]),a(n(I,_),u[1]))),-l[2])),r(a(r(a(n(N,E),s[1]),r(a(n(B,w),-l[1]),a(n(M,b),u[1]))),c[2]),a(r(a(n(O,S),s[1]),r(a(n(I,_),-l[1]),a(n(M,b),c[1]))),-u[2]))),f[3])),r(a(r(r(a(r(a(n(W,U),c[1]),r(a(n(Y,D),-u[1]),a(n(j,z),f[1]))),s[2]),a(r(a(n(W,U),s[1]),r(a(n(q,T),-u[1]),a(n(B,w),f[1]))),-c[2])),r(a(r(a(n(Y,D),s[1]),r(a(n(q,T),-c[1]),a(n(I,_),f[1]))),u[2]),a(r(a(n(j,z),s[1]),r(a(n(B,w),-c[1]),a(n(I,_),u[1]))),-f[2]))),o[3]),a(r(r(a(r(a(n(W,U),c[1]),r(a(n(Y,D),-u[1]),a(n(j,z),f[1]))),o[2]),a(r(a(n(W,U),o[1]),r(a(n(H,v),-u[1]),a(n(F,g),f[1]))),-c[2])),r(a(r(a(n(Y,D),o[1]),r(a(n(H,v),-c[1]),a(n(P,m),f[1]))),u[2]),a(r(a(n(j,z),o[1]),r(a(n(F,g),-c[1]),a(n(P,m),u[1]))),-f[2]))),-s[3])))),r(r(r(a(r(r(a(r(a(n(W,U),s[1]),r(a(n(q,T),-u[1]),a(n(B,w),f[1]))),o[2]),a(r(a(n(W,U),o[1]),r(a(n(H,v),-u[1]),a(n(F,g),f[1]))),-s[2])),r(a(r(a(n(q,T),o[1]),r(a(n(H,v),-s[1]),a(n(x,p),f[1]))),u[2]),a(r(a(n(B,w),o[1]),r(a(n(F,g),-s[1]),a(n(x,p),u[1]))),-f[2]))),c[3]),a(r(r(a(r(a(n(Y,D),s[1]),r(a(n(q,T),-c[1]),a(n(I,_),f[1]))),o[2]),a(r(a(n(Y,D),o[1]),r(a(n(H,v),-c[1]),a(n(P,m),f[1]))),-s[2])),r(a(r(a(n(q,T),o[1]),r(a(n(H,v),-s[1]),a(n(x,p),f[1]))),c[2]),a(r(a(n(I,_),o[1]),r(a(n(P,m),-s[1]),a(n(x,p),c[1]))),-f[2]))),-u[3])),r(a(r(r(a(r(a(n(j,z),s[1]),r(a(n(B,w),-c[1]),a(n(I,_),u[1]))),o[2]),a(r(a(n(j,z),o[1]),r(a(n(F,g),-c[1]),a(n(P,m),u[1]))),-s[2])),r(a(r(a(n(B,w),o[1]),r(a(n(F,g),-s[1]),a(n(x,p),u[1]))),c[2]),a(r(a(n(I,_),o[1]),r(a(n(P,m),-s[1]),a(n(x,p),c[1]))),-u[2]))),f[3]),a(r(r(a(r(a(n(Y,D),l[1]),r(a(n(G,L),-c[1]),a(n(O,S),f[1]))),s[2]),a(r(a(n(Y,D),s[1]),r(a(n(q,T),-c[1]),a(n(I,_),f[1]))),-l[2])),r(a(r(a(n(G,L),s[1]),r(a(n(q,T),-l[1]),a(n(M,b),f[1]))),c[2]),a(r(a(n(O,S),s[1]),r(a(n(I,_),-l[1]),a(n(M,b),c[1]))),-f[2]))),o[3]))),r(r(a(r(r(a(r(a(n(Y,D),l[1]),r(a(n(G,L),-c[1]),a(n(O,S),f[1]))),o[2]),a(r(a(n(Y,D),o[1]),r(a(n(H,v),-c[1]),a(n(P,m),f[1]))),-l[2])),r(a(r(a(n(G,L),o[1]),r(a(n(H,v),-l[1]),a(n(A,d),f[1]))),c[2]),a(r(a(n(O,S),o[1]),r(a(n(P,m),-l[1]),a(n(A,d),c[1]))),-f[2]))),-s[3]),a(r(r(a(r(a(n(Y,D),s[1]),r(a(n(q,T),-c[1]),a(n(I,_),f[1]))),o[2]),a(r(a(n(Y,D),o[1]),r(a(n(H,v),-c[1]),a(n(P,m),f[1]))),-s[2])),r(a(r(a(n(q,T),o[1]),r(a(n(H,v),-s[1]),a(n(x,p),f[1]))),c[2]),a(r(a(n(I,_),o[1]),r(a(n(P,m),-s[1]),a(n(x,p),c[1]))),-f[2]))),l[3])),r(a(r(r(a(r(a(n(G,L),s[1]),r(a(n(q,T),-l[1]),a(n(M,b),f[1]))),o[2]),a(r(a(n(G,L),o[1]),r(a(n(H,v),-l[1]),a(n(A,d),f[1]))),-s[2])),r(a(r(a(n(q,T),o[1]),r(a(n(H,v),-s[1]),a(n(x,p),f[1]))),l[2]),a(r(a(n(M,b),o[1]),r(a(n(A,d),-s[1]),a(n(x,p),l[1]))),-f[2]))),-c[3]),a(r(r(a(r(a(n(O,S),s[1]),r(a(n(I,_),-l[1]),a(n(M,b),c[1]))),o[2]),a(r(a(n(O,S),o[1]),r(a(n(P,m),-l[1]),a(n(A,d),c[1]))),-s[2])),r(a(r(a(n(I,_),o[1]),r(a(n(P,m),-s[1]),a(n(x,p),c[1]))),l[2]),a(r(a(n(M,b),o[1]),r(a(n(A,d),-s[1]),a(n(x,p),l[1]))),-c[2]))),f[3]))))),Z=r(r(r(a(r(r(a(r(a(n(W,U),c[1]),r(a(n(Y,D),-u[1]),a(n(j,z),f[1]))),l[2]),a(r(a(n(W,U),l[1]),r(a(n(G,L),-u[1]),a(n(N,E),f[1]))),-c[2])),r(a(r(a(n(Y,D),l[1]),r(a(n(G,L),-c[1]),a(n(O,S),f[1]))),u[2]),a(r(a(n(j,z),l[1]),r(a(n(N,E),-c[1]),a(n(O,S),u[1]))),-f[2]))),o[3]),r(a(r(r(a(r(a(n(W,U),c[1]),r(a(n(Y,D),-u[1]),a(n(j,z),f[1]))),o[2]),a(r(a(n(W,U),o[1]),r(a(n(H,v),-u[1]),a(n(F,g),f[1]))),-c[2])),r(a(r(a(n(Y,D),o[1]),r(a(n(H,v),-c[1]),a(n(P,m),f[1]))),u[2]),a(r(a(n(j,z),o[1]),r(a(n(F,g),-c[1]),a(n(P,m),u[1]))),-f[2]))),-l[3]),a(r(r(a(r(a(n(W,U),l[1]),r(a(n(G,L),-u[1]),a(n(N,E),f[1]))),o[2]),a(r(a(n(W,U),o[1]),r(a(n(H,v),-u[1]),a(n(F,g),f[1]))),-l[2])),r(a(r(a(n(G,L),o[1]),r(a(n(H,v),-l[1]),a(n(A,d),f[1]))),u[2]),a(r(a(n(N,E),o[1]),r(a(n(F,g),-l[1]),a(n(A,d),u[1]))),-f[2]))),c[3]))),r(r(a(r(r(a(r(a(n(Y,D),l[1]),r(a(n(G,L),-c[1]),a(n(O,S),f[1]))),o[2]),a(r(a(n(Y,D),o[1]),r(a(n(H,v),-c[1]),a(n(P,m),f[1]))),-l[2])),r(a(r(a(n(G,L),o[1]),r(a(n(H,v),-l[1]),a(n(A,d),f[1]))),c[2]),a(r(a(n(O,S),o[1]),r(a(n(P,m),-l[1]),a(n(A,d),c[1]))),-f[2]))),-u[3]),a(r(r(a(r(a(n(j,z),l[1]),r(a(n(N,E),-c[1]),a(n(O,S),u[1]))),o[2]),a(r(a(n(j,z),o[1]),r(a(n(F,g),-c[1]),a(n(P,m),u[1]))),-l[2])),r(a(r(a(n(N,E),o[1]),r(a(n(F,g),-l[1]),a(n(A,d),u[1]))),c[2]),a(r(a(n(O,S),o[1]),r(a(n(P,m),-l[1]),a(n(A,d),c[1]))),-u[2]))),f[3])),r(a(r(r(a(r(a(n(W,U),l[1]),r(a(n(G,L),-u[1]),a(n(N,E),f[1]))),s[2]),a(r(a(n(W,U),s[1]),r(a(n(q,T),-u[1]),a(n(B,w),f[1]))),-l[2])),r(a(r(a(n(G,L),s[1]),r(a(n(q,T),-l[1]),a(n(M,b),f[1]))),u[2]),a(r(a(n(N,E),s[1]),r(a(n(B,w),-l[1]),a(n(M,b),u[1]))),-f[2]))),o[3]),a(r(r(a(r(a(n(W,U),l[1]),r(a(n(G,L),-u[1]),a(n(N,E),f[1]))),o[2]),a(r(a(n(W,U),o[1]),r(a(n(H,v),-u[1]),a(n(F,g),f[1]))),-l[2])),r(a(r(a(n(G,L),o[1]),r(a(n(H,v),-l[1]),a(n(A,d),f[1]))),u[2]),a(r(a(n(N,E),o[1]),r(a(n(F,g),-l[1]),a(n(A,d),u[1]))),-f[2]))),-s[3])))),r(r(r(a(r(r(a(r(a(n(W,U),s[1]),r(a(n(q,T),-u[1]),a(n(B,w),f[1]))),o[2]),a(r(a(n(W,U),o[1]),r(a(n(H,v),-u[1]),a(n(F,g),f[1]))),-s[2])),r(a(r(a(n(q,T),o[1]),r(a(n(H,v),-s[1]),a(n(x,p),f[1]))),u[2]),a(r(a(n(B,w),o[1]),r(a(n(F,g),-s[1]),a(n(x,p),u[1]))),-f[2]))),l[3]),a(r(r(a(r(a(n(G,L),s[1]),r(a(n(q,T),-l[1]),a(n(M,b),f[1]))),o[2]),a(r(a(n(G,L),o[1]),r(a(n(H,v),-l[1]),a(n(A,d),f[1]))),-s[2])),r(a(r(a(n(q,T),o[1]),r(a(n(H,v),-s[1]),a(n(x,p),f[1]))),l[2]),a(r(a(n(M,b),o[1]),r(a(n(A,d),-s[1]),a(n(x,p),l[1]))),-f[2]))),-u[3])),r(a(r(r(a(r(a(n(N,E),s[1]),r(a(n(B,w),-l[1]),a(n(M,b),u[1]))),o[2]),a(r(a(n(N,E),o[1]),r(a(n(F,g),-l[1]),a(n(A,d),u[1]))),-s[2])),r(a(r(a(n(B,w),o[1]),r(a(n(F,g),-s[1]),a(n(x,p),u[1]))),l[2]),a(r(a(n(M,b),o[1]),r(a(n(A,d),-s[1]),a(n(x,p),l[1]))),-u[2]))),f[3]),a(r(r(a(r(a(n(j,z),l[1]),r(a(n(N,E),-c[1]),a(n(O,S),u[1]))),s[2]),a(r(a(n(j,z),s[1]),r(a(n(B,w),-c[1]),a(n(I,_),u[1]))),-l[2])),r(a(r(a(n(N,E),s[1]),r(a(n(B,w),-l[1]),a(n(M,b),u[1]))),c[2]),a(r(a(n(O,S),s[1]),r(a(n(I,_),-l[1]),a(n(M,b),c[1]))),-u[2]))),o[3]))),r(r(a(r(r(a(r(a(n(j,z),l[1]),r(a(n(N,E),-c[1]),a(n(O,S),u[1]))),o[2]),a(r(a(n(j,z),o[1]),r(a(n(F,g),-c[1]),a(n(P,m),u[1]))),-l[2])),r(a(r(a(n(N,E),o[1]),r(a(n(F,g),-l[1]),a(n(A,d),u[1]))),c[2]),a(r(a(n(O,S),o[1]),r(a(n(P,m),-l[1]),a(n(A,d),c[1]))),-u[2]))),-s[3]),a(r(r(a(r(a(n(j,z),s[1]),r(a(n(B,w),-c[1]),a(n(I,_),u[1]))),o[2]),a(r(a(n(j,z),o[1]),r(a(n(F,g),-c[1]),a(n(P,m),u[1]))),-s[2])),r(a(r(a(n(B,w),o[1]),r(a(n(F,g),-s[1]),a(n(x,p),u[1]))),c[2]),a(r(a(n(I,_),o[1]),r(a(n(P,m),-s[1]),a(n(x,p),c[1]))),-u[2]))),l[3])),r(a(r(r(a(r(a(n(N,E),s[1]),r(a(n(B,w),-l[1]),a(n(M,b),u[1]))),o[2]),a(r(a(n(N,E),o[1]),r(a(n(F,g),-l[1]),a(n(A,d),u[1]))),-s[2])),r(a(r(a(n(B,w),o[1]),r(a(n(F,g),-s[1]),a(n(x,p),u[1]))),l[2]),a(r(a(n(M,b),o[1]),r(a(n(A,d),-s[1]),a(n(x,p),l[1]))),-u[2]))),-c[3]),a(r(r(a(r(a(n(O,S),s[1]),r(a(n(I,_),-l[1]),a(n(M,b),c[1]))),o[2]),a(r(a(n(O,S),o[1]),r(a(n(P,m),-l[1]),a(n(A,d),c[1]))),-s[2])),r(a(r(a(n(I,_),o[1]),r(a(n(P,m),-s[1]),a(n(x,p),c[1]))),l[2]),a(r(a(n(M,b),o[1]),r(a(n(A,d),-s[1]),a(n(x,p),l[1]))),-c[2]))),u[3]))))),J=n(X,Z);return J[J.length-1]}})(o,s,a,l)}var u=[function(){return 0},function(){return 0},function(){return 0}];function f(r){var n=u[r.length];return n||(n=u[r.length]=c(r.length)),n.apply(void 0,r)}function h(r,n,i,a,o,s,l,c){return function(n,i,u,f,h,p){switch(arguments.length){case 0:case 1:return 0;case 2:return a(n,i);case 3:return o(n,i,u);case 4:return s(n,i,u,f);case 5:return l(n,i,u,f,h);case 6:return c(n,i,u,f,h,p)}for(var d=Array(arguments.length),m=0;m<arguments.length;++m)d[m]=arguments[m];return r(d)}}!function(){for(;u.length<=6;)u.push(c(u.length));n.exports=h.apply(void 0,[f].concat(u));for(var r=0;r<=6;++r)n.exports[r]=u[r]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(r,n,i){"use strict";var a=r("robust-determinant");function o(r){return(2===r?function(r){return function(n,i){return[r([[+i[0],+n[0][1]],[+i[1],+n[1][1]]]),r([[+n[0][0],+i[0]],[+n[1][0],+i[1]]]),r(n)]}}:function(r){return function(n,i){return[r([[+i[0],+n[0][1],+n[0][2]],[+i[1],+n[1][1],+n[1][2]],[+i[2],+n[2][1],+n[2][2]]]),r([[+n[0][0],+i[0],+n[0][2]],[+n[1][0],+i[1],+n[1][2]],[+n[2][0],+i[2],+n[2][2]]]),r([[+n[0][0],+n[0][1],+i[0]],[+n[1][0],+n[1][1],+i[1]],[+n[2][0],+n[2][1],+i[2]]]),r(n)]}})(r<3?a[r]:a)}var s=[function(){return[[0]]},function(r,n){return[[n[0]],[r[0][0]]]}];function l(r,n,i,a,o,s){return function(l,c){switch(l.length){case 0:return r(l,c);case 1:return n(l,c);case 2:return i(l,c);case 3:return a(l,c)}var u=o[l.length];return u||(u=o[l.length]=s(l.length)),u(l,c)}}!function(){for(;s.length<=3;)s.push(o(s.length));n.exports=l.apply(void 0,s.concat([s,o]));for(var r=0;r<3;++r)n.exports[r]=s[r]}()},{"robust-determinant":280}],284:[function(r,n,i){"use strict";var a=r("two-product"),o=r("robust-sum"),s=r("robust-scale"),l=r("robust-subtract");function c(r){return(3===r?function(r,n,i,a){return function(i,o,s){var l=a(r(r(n(o[1],s[0]),n(-s[1],o[0])),r(n(i[1],o[0]),n(-o[1],i[0]))),r(n(i[1],s[0]),n(-s[1],i[0])));return l[l.length-1]}}:4===r?function(r,n,i,a){return function(o,s,l,c){var u=a(r(r(i(r(n(l[1],c[0]),n(-c[1],l[0])),s[2]),r(i(r(n(s[1],c[0]),n(-c[1],s[0])),-l[2]),i(r(n(s[1],l[0]),n(-l[1],s[0])),c[2]))),r(i(r(n(s[1],c[0]),n(-c[1],s[0])),o[2]),r(i(r(n(o[1],c[0]),n(-c[1],o[0])),-s[2]),i(r(n(o[1],s[0]),n(-s[1],o[0])),c[2])))),r(r(i(r(n(l[1],c[0]),n(-c[1],l[0])),o[2]),r(i(r(n(o[1],c[0]),n(-c[1],o[0])),-l[2]),i(r(n(o[1],l[0]),n(-l[1],o[0])),c[2]))),r(i(r(n(s[1],l[0]),n(-l[1],s[0])),o[2]),r(i(r(n(o[1],l[0]),n(-l[1],o[0])),-s[2]),i(r(n(o[1],s[0]),n(-s[1],o[0])),l[2])))));return u[u.length-1]}}:function(r,n,i,a){return function(o,s,l,c,u){var f=a(r(r(r(i(r(i(r(n(c[1],u[0]),n(-u[1],c[0])),l[2]),r(i(r(n(l[1],u[0]),n(-u[1],l[0])),-c[2]),i(r(n(l[1],c[0]),n(-c[1],l[0])),u[2]))),s[3]),r(i(r(i(r(n(c[1],u[0]),n(-u[1],c[0])),s[2]),r(i(r(n(s[1],u[0]),n(-u[1],s[0])),-c[2]),i(r(n(s[1],c[0]),n(-c[1],s[0])),u[2]))),-l[3]),i(r(i(r(n(l[1],u[0]),n(-u[1],l[0])),s[2]),r(i(r(n(s[1],u[0]),n(-u[1],s[0])),-l[2]),i(r(n(s[1],l[0]),n(-l[1],s[0])),u[2]))),c[3]))),r(i(r(i(r(n(l[1],c[0]),n(-c[1],l[0])),s[2]),r(i(r(n(s[1],c[0]),n(-c[1],s[0])),-l[2]),i(r(n(s[1],l[0]),n(-l[1],s[0])),c[2]))),-u[3]),r(i(r(i(r(n(c[1],u[0]),n(-u[1],c[0])),s[2]),r(i(r(n(s[1],u[0]),n(-u[1],s[0])),-c[2]),i(r(n(s[1],c[0]),n(-c[1],s[0])),u[2]))),o[3]),i(r(i(r(n(c[1],u[0]),n(-u[1],c[0])),o[2]),r(i(r(n(o[1],u[0]),n(-u[1],o[0])),-c[2]),i(r(n(o[1],c[0]),n(-c[1],o[0])),u[2]))),-s[3])))),r(r(i(r(i(r(n(s[1],u[0]),n(-u[1],s[0])),o[2]),r(i(r(n(o[1],u[0]),n(-u[1],o[0])),-s[2]),i(r(n(o[1],s[0]),n(-s[1],o[0])),u[2]))),c[3]),r(i(r(i(r(n(s[1],c[0]),n(-c[1],s[0])),o[2]),r(i(r(n(o[1],c[0]),n(-c[1],o[0])),-s[2]),i(r(n(o[1],s[0]),n(-s[1],o[0])),c[2]))),-u[3]),i(r(i(r(n(l[1],c[0]),n(-c[1],l[0])),s[2]),r(i(r(n(s[1],c[0]),n(-c[1],s[0])),-l[2]),i(r(n(s[1],l[0]),n(-l[1],s[0])),c[2]))),o[3]))),r(i(r(i(r(n(l[1],c[0]),n(-c[1],l[0])),o[2]),r(i(r(n(o[1],c[0]),n(-c[1],o[0])),-l[2]),i(r(n(o[1],l[0]),n(-l[1],o[0])),c[2]))),-s[3]),r(i(r(i(r(n(s[1],c[0]),n(-c[1],s[0])),o[2]),r(i(r(n(o[1],c[0]),n(-c[1],o[0])),-s[2]),i(r(n(o[1],s[0]),n(-s[1],o[0])),c[2]))),l[3]),i(r(i(r(n(s[1],l[0]),n(-l[1],s[0])),o[2]),r(i(r(n(o[1],l[0]),n(-l[1],o[0])),-s[2]),i(r(n(o[1],s[0]),n(-s[1],o[0])),l[2]))),-c[3]))))),r(r(r(i(r(i(r(n(c[1],u[0]),n(-u[1],c[0])),l[2]),r(i(r(n(l[1],u[0]),n(-u[1],l[0])),-c[2]),i(r(n(l[1],c[0]),n(-c[1],l[0])),u[2]))),o[3]),i(r(i(r(n(c[1],u[0]),n(-u[1],c[0])),o[2]),r(i(r(n(o[1],u[0]),n(-u[1],o[0])),-c[2]),i(r(n(o[1],c[0]),n(-c[1],o[0])),u[2]))),-l[3])),r(i(r(i(r(n(l[1],u[0]),n(-u[1],l[0])),o[2]),r(i(r(n(o[1],u[0]),n(-u[1],o[0])),-l[2]),i(r(n(o[1],l[0]),n(-l[1],o[0])),u[2]))),c[3]),i(r(i(r(n(l[1],c[0]),n(-c[1],l[0])),o[2]),r(i(r(n(o[1],c[0]),n(-c[1],o[0])),-l[2]),i(r(n(o[1],l[0]),n(-l[1],o[0])),c[2]))),-u[3]))),r(r(i(r(i(r(n(l[1],u[0]),n(-u[1],l[0])),s[2]),r(i(r(n(s[1],u[0]),n(-u[1],s[0])),-l[2]),i(r(n(s[1],l[0]),n(-l[1],s[0])),u[2]))),o[3]),i(r(i(r(n(l[1],u[0]),n(-u[1],l[0])),o[2]),r(i(r(n(o[1],u[0]),n(-u[1],o[0])),-l[2]),i(r(n(o[1],l[0]),n(-l[1],o[0])),u[2]))),-s[3])),r(i(r(i(r(n(s[1],u[0]),n(-u[1],s[0])),o[2]),r(i(r(n(o[1],u[0]),n(-u[1],o[0])),-s[2]),i(r(n(o[1],s[0]),n(-s[1],o[0])),u[2]))),l[3]),i(r(i(r(n(s[1],l[0]),n(-l[1],s[0])),o[2]),r(i(r(n(o[1],l[0]),n(-l[1],o[0])),-s[2]),i(r(n(o[1],s[0]),n(-s[1],o[0])),l[2]))),-u[3])))));return f[f.length-1]}})(o,a,s,l)}var u=c(3),f=c(4),h=[function(){return 0},function(){return 0},function(r,n){return n[0]-r[0]},function(r,n,i){var a,o=(r[1]-i[1])*(n[0]-i[0]),s=(r[0]-i[0])*(n[1]-i[1]),l=o-s;if(o>0){if(s<=0)return l;a=o+s}else{if(!(o<0)||s>=0)return l;a=-(o+s)}var c=33306690738754716e-32*a;return l>=c||l<=-c?l:u(r,n,i)},function(r,n,i,a){var o=r[0]-a[0],s=n[0]-a[0],l=i[0]-a[0],c=r[1]-a[1],u=n[1]-a[1],h=i[1]-a[1],p=r[2]-a[2],d=n[2]-a[2],m=i[2]-a[2],g=s*h,v=l*u,y=l*c,x=o*h,b=o*u,_=s*c,w=p*(g-v)+d*(y-x)+m*(b-_),T=7771561172376103e-31*((Math.abs(g)+Math.abs(v))*Math.abs(p)+(Math.abs(y)+Math.abs(x))*Math.abs(d)+(Math.abs(b)+Math.abs(_))*Math.abs(m));return w>T||-w>T?w:f(r,n,i,a)}];function p(r){var n=h[r.length];return n||(n=h[r.length]=c(r.length)),n.apply(void 0,r)}function d(r,n,i,a,o,s,l){return function(n,i,c,u,f){switch(arguments.length){case 0:case 1:return 0;case 2:return a(n,i);case 3:return o(n,i,c);case 4:return s(n,i,c,u);case 5:return l(n,i,c,u,f)}for(var h=Array(arguments.length),p=0;p<arguments.length;++p)h[p]=arguments[p];return r(h)}}!function(){for(;h.length<=5;)h.push(c(h.length));n.exports=d.apply(void 0,[p].concat(h));for(var r=0;r<=5;++r)n.exports[r]=h[r]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(r,n,i){"use strict";var a=r("robust-sum"),o=r("robust-scale");n.exports=function(r,n){if(1===r.length)return o(n,r[0]);if(1===n.length)return o(r,n[0]);if(0===r.length||0===n.length)return[0];var i=[0];if(r.length<n.length)for(var s=0;s<r.length;++s)i=a(i,o(n,r[s]));else for(s=0;s<n.length;++s)i=a(i,o(r,n[s]));return i}},{"robust-scale":286,"robust-sum":289}],286:[function(r,n,i){"use strict";var a=r("two-product"),o=r("two-sum");n.exports=function(r,n){var i=r.length;if(1===i){var s=a(r[0],n);return s[0]?s:[s[1]]}var l=Array(2*i),c=[.1,.1],u=[.1,.1],f=0;a(r[0],n,c),c[0]&&(l[f++]=c[0]);for(var h=1;h<i;++h){a(r[h],n,u),o(c[1],u[0],c),c[0]&&(l[f++]=c[0]);var p=u[1],d=c[1],m=p+d,g=d-(m-p);c[1]=m,g&&(l[f++]=g)}return c[1]&&(l[f++]=c[1]),0===f&&(l[f++]=0),l.length=f,l}},{"two-product":306,"two-sum":307}],287:[function(r,n,i){"use strict";n.exports=function(r,n,i,o){var s=a(r,i,o),l=a(n,i,o);if(s>0&&l>0||s<0&&l<0)return!1;var c=a(i,r,n),u=a(o,r,n);return(!(c>0)||!(u>0))&&(!(c<0)||!(u<0))&&(0!==s||0!==l||0!==c||0!==u||function(r,n,i,a){for(var o=0;o<2;++o){var s=r[o],l=n[o],c=Math.min(s,l),u=Math.max(s,l),f=i[o],h=a[o],p=Math.min(f,h);if(Math.max(f,h)<c||u<p)return!1}return!0}(r,n,i,o))};var a=r("robust-orientation")[3]},{"robust-orientation":284}],288:[function(r,n,i){"use strict";n.exports=function(r,n){var i=0|r.length,a=0|n.length;if(1===i&&1===a)return c=(l=(o=r[0])+(s=-n[0]))-o,(u=o-(l-c)+(s-c))?[u,l]:[l];var o,s,l,c,u,f,h,p=Array(i+a),d=0,m=0,g=0,v=Math.abs,y=r[0],x=v(y),b=-n[g],_=v(b);x<_?(h=y,(m+=1)<i&&(x=v(y=r[m]))):(h=b,(g+=1)<a&&(_=v(b=-n[g]))),m<i&&x<_||g>=a?(f=y,(m+=1)<i&&(x=v(y=r[m]))):(f=b,(g+=1)<a&&(_=v(b=-n[g])));for(var w,T,k=f+h,A=k-f,M=h-A,S=M,E=k;m<i&&g<a;)x<_?(f=y,(m+=1)<i&&(x=v(y=r[m]))):(f=b,(g+=1)<a&&(_=v(b=-n[g]))),(M=(h=S)-(A=(k=f+h)-f))&&(p[d++]=M),S=E-((w=E+k)-(T=w-E))+(k-T),E=w;for(;m<i;)(M=(h=S)-(A=(k=(f=y)+h)-f))&&(p[d++]=M),S=E-((w=E+k)-(T=w-E))+(k-T),E=w,(m+=1)<i&&(y=r[m]);for(;g<a;)(M=(h=S)-(A=(k=(f=b)+h)-f))&&(p[d++]=M),S=E-((w=E+k)-(T=w-E))+(k-T),E=w,(g+=1)<a&&(b=-n[g]);return S&&(p[d++]=S),E&&(p[d++]=E),d||(p[d++]=0),p.length=d,p}},{}],289:[function(r,n,i){"use strict";n.exports=function(r,n){var i=0|r.length,a=0|n.length;if(1===i&&1===a)return c=(l=(o=r[0])+(s=n[0]))-o,(u=o-(l-c)+(s-c))?[u,l]:[l];var o,s,l,c,u,f,h,p=Array(i+a),d=0,m=0,g=0,v=Math.abs,y=r[0],x=v(y),b=n[g],_=v(b);x<_?(h=y,(m+=1)<i&&(x=v(y=r[m]))):(h=b,(g+=1)<a&&(_=v(b=n[g]))),m<i&&x<_||g>=a?(f=y,(m+=1)<i&&(x=v(y=r[m]))):(f=b,(g+=1)<a&&(_=v(b=n[g])));for(var w,T,k=f+h,A=k-f,M=h-A,S=M,E=k;m<i&&g<a;)x<_?(f=y,(m+=1)<i&&(x=v(y=r[m]))):(f=b,(g+=1)<a&&(_=v(b=n[g]))),(M=(h=S)-(A=(k=f+h)-f))&&(p[d++]=M),S=E-((w=E+k)-(T=w-E))+(k-T),E=w;for(;m<i;)(M=(h=S)-(A=(k=(f=y)+h)-f))&&(p[d++]=M),S=E-((w=E+k)-(T=w-E))+(k-T),E=w,(m+=1)<i&&(y=r[m]);for(;g<a;)(M=(h=S)-(A=(k=(f=b)+h)-f))&&(p[d++]=M),S=E-((w=E+k)-(T=w-E))+(k-T),E=w,(g+=1)<a&&(b=n[g]);return S&&(p[d++]=S),E&&(p[d++]=E),d||(p[d++]=0),p.length=d,p}},{}],290:[function(r,n,i){"use strict";n.exports=function(r){return o(a(r))};var a=r("boundary-cells"),o=r("reduce-simplicial-complex")},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(r,n,i){"use strict";n.exports=function(r,n,i,c){if(i=i||0,void 0===c&&(c=function(r){for(var n=r.length,i=0,a=0;a<n;++a)i=0|Math.max(i,r[a].length);return i-1}(r)),0===r.length||c<1)return{cells:[],vertexIds:[],vertexWeights:[]};var u=function(r,n){for(var i=r.length,a=o.mallocUint8(i),s=0;s<i;++s)a[s]=r[s]<n|0;return a}(n,+i),f=function(r,n){for(var i=r.length,l=n*(n+1)/2*i|0,c=o.mallocUint32(2*l),u=0,f=0;f<i;++f)for(var h=r[f],p=(n=h.length,0);p<n;++p)for(var d=0;d<p;++d){var m=h[d],g=h[p];c[u++]=0|Math.min(m,g),c[u++]=0|Math.max(m,g)}s(a(c,[u/2|0,2]));var v=2;for(f=2;f<u;f+=2)c[f-2]===c[f]&&c[f-1]===c[f+1]||(c[v++]=c[f],c[v++]=c[f+1]);return a(c,[v/2|0,2])}(r,c),h=function(r,n,i,s){for(var l=r.data,c=r.shape[0],u=o.mallocDouble(c),f=0,h=0;h<c;++h){var p=l[2*h],d=l[2*h+1];if(i[p]!==i[d]){var m=n[p],g=n[d];l[2*f]=p,l[2*f+1]=d,u[f++]=(g-s)/(g-m)}}return r.shape[0]=f,a(u,[f])}(f,n,u,+i),p=function(r,n){var i=o.mallocInt32(2*n),a=r.shape[0],s=r.data;i[0]=0;for(var l=0,c=0;c<a;++c){var u=s[2*c];if(u!==l){for(i[2*l+1]=c;++l<u;)i[2*l]=c,i[2*l+1]=c;i[2*l]=c}}for(i[2*l+1]=a;++l<n;)i[2*l]=i[2*l+1]=a;return i}(f,0|n.length),d=l(c)(r,f.data,p,u),m=function(r){for(var n=0|r.shape[0],i=r.data,a=Array(n),o=0;o<n;++o)a[o]=[i[2*o],i[2*o+1]];return a}(f),g=[].slice.call(h.data,0,h.shape[0]);return o.free(u),o.free(f.data),o.free(h.data),o.free(p),{cells:d,vertexIds:m,vertexWeights:g}};var a=r("ndarray"),o=r("typedarray-pool"),s=r("ndarray-sort"),l=r("./lib/codegen")},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(r,n,i){"use strict";n.exports=function(r){return a[r]()};var a=[function(){return function(r,n,i,a){for(var o=r.length,s=0;s<o;++s)r[s].length;return[]}},function(){function r(r,n,i,a){for(var o=0|Math.min(i,a),s=0|Math.max(i,a),l=r[2*o],c=r[2*o+1];l<c;){var u=l+c>>1,f=n[2*u+1];if(f===s)return u;s<f?c=u:l=u+1}return l}return function(n,i,a,o){for(var s=n.length,l=[],c=0;c<s;++c){var u=n[c];if(2===u.length){var f=(o[u[0]]<<0)+(o[u[1]]<<1);if(0===f||3===f)continue;switch(f){case 0:break;case 1:l.push([r(a,i,u[0],u[1])]);break;case 2:l.push([r(a,i,u[1],u[0])])}}}return l}},function(){function r(r,n,i,a){for(var o=0|Math.min(i,a),s=0|Math.max(i,a),l=r[2*o],c=r[2*o+1];l<c;){var u=l+c>>1,f=n[2*u+1];if(f===s)return u;s<f?c=u:l=u+1}return l}return function(n,i,a,o){for(var s=n.length,l=[],c=0;c<s;++c){var u,f=n[c],h=f.length;if(3===h){if(0==(u=(o[f[0]]<<0)+(o[f[1]]<<1)+(o[f[2]]<<2))||7===u)continue;switch(u){case 0:break;case 1:l.push([r(a,i,f[0],f[2]),r(a,i,f[0],f[1])]);break;case 2:l.push([r(a,i,f[1],f[0]),r(a,i,f[1],f[2])]);break;case 3:l.push([r(a,i,f[0],f[2]),r(a,i,f[1],f[2])]);break;case 4:l.push([r(a,i,f[2],f[1]),r(a,i,f[2],f[0])]);break;case 5:l.push([r(a,i,f[2],f[1]),r(a,i,f[0],f[1])]);break;case 6:l.push([r(a,i,f[1],f[0]),r(a,i,f[2],f[0])])}}else if(2===h){if(0==(u=(o[f[0]]<<0)+(o[f[1]]<<1))||3===u)continue;switch(u){case 0:break;case 1:l.push([r(a,i,f[0],f[1])]);break;case 2:l.push([r(a,i,f[1],f[0])])}}}return l}},function(){function r(r,n,i,a){for(var o=0|Math.min(i,a),s=0|Math.max(i,a),l=r[2*o],c=r[2*o+1];l<c;){var u=l+c>>1,f=n[2*u+1];if(f===s)return u;s<f?c=u:l=u+1}return l}return function(n,i,a,o){for(var s=n.length,l=[],c=0;c<s;++c){var u,f=n[c],h=f.length;if(4===h){if(0==(u=(o[f[0]]<<0)+(o[f[1]]<<1)+(o[f[2]]<<2)+(o[f[3]]<<3))||15===u)continue;switch(u){case 0:break;case 1:l.push([r(a,i,f[0],f[1]),r(a,i,f[0],f[2]),r(a,i,f[0],f[3])]);break;case 2:l.push([r(a,i,f[1],f[2]),r(a,i,f[1],f[0]),r(a,i,f[1],f[3])]);break;case 3:l.push([r(a,i,f[1],f[2]),r(a,i,f[0],f[2]),r(a,i,f[0],f[3])],[r(a,i,f[1],f[3]),r(a,i,f[1],f[2]),r(a,i,f[0],f[3])]);break;case 4:l.push([r(a,i,f[2],f[0]),r(a,i,f[2],f[1]),r(a,i,f[2],f[3])]);break;case 5:l.push([r(a,i,f[0],f[1]),r(a,i,f[2],f[1]),r(a,i,f[0],f[3])],[r(a,i,f[2],f[1]),r(a,i,f[2],f[3]),r(a,i,f[0],f[3])]);break;case 6:l.push([r(a,i,f[2],f[0]),r(a,i,f[1],f[0]),r(a,i,f[1],f[3])],[r(a,i,f[2],f[3]),r(a,i,f[2],f[0]),r(a,i,f[1],f[3])]);break;case 7:l.push([r(a,i,f[0],f[3]),r(a,i,f[1],f[3]),r(a,i,f[2],f[3])]);break;case 8:l.push([r(a,i,f[3],f[1]),r(a,i,f[3],f[0]),r(a,i,f[3],f[2])]);break;case 9:l.push([r(a,i,f[3],f[1]),r(a,i,f[0],f[1]),r(a,i,f[0],f[2])],[r(a,i,f[3],f[2]),r(a,i,f[3],f[1]),r(a,i,f[0],f[2])]);break;case 10:l.push([r(a,i,f[1],f[0]),r(a,i,f[3],f[0]),r(a,i,f[1],f[2])],[r(a,i,f[3],f[0]),r(a,i,f[3],f[2]),r(a,i,f[1],f[2])]);break;case 11:l.push([r(a,i,f[1],f[2]),r(a,i,f[0],f[2]),r(a,i,f[3],f[2])]);break;case 12:l.push([r(a,i,f[3],f[0]),r(a,i,f[2],f[0]),r(a,i,f[2],f[1])],[r(a,i,f[3],f[1]),r(a,i,f[3],f[0]),r(a,i,f[2],f[1])]);break;case 13:l.push([r(a,i,f[0],f[1]),r(a,i,f[2],f[1]),r(a,i,f[3],f[1])]);break;case 14:l.push([r(a,i,f[2],f[0]),r(a,i,f[1],f[0]),r(a,i,f[3],f[0])])}}else if(3===h){if(0==(u=(o[f[0]]<<0)+(o[f[1]]<<1)+(o[f[2]]<<2))||7===u)continue;switch(u){case 0:break;case 1:l.push([r(a,i,f[0],f[2]),r(a,i,f[0],f[1])]);break;case 2:l.push([r(a,i,f[1],f[0]),r(a,i,f[1],f[2])]);break;case 3:l.push([r(a,i,f[0],f[2]),r(a,i,f[1],f[2])]);break;case 4:l.push([r(a,i,f[2],f[1]),r(a,i,f[2],f[0])]);break;case 5:l.push([r(a,i,f[2],f[1]),r(a,i,f[0],f[1])]);break;case 6:l.push([r(a,i,f[1],f[0]),r(a,i,f[2],f[0])])}}else if(2===h){if(0==(u=(o[f[0]]<<0)+(o[f[1]]<<1))||3===u)continue;switch(u){case 0:break;case 1:l.push([r(a,i,f[0],f[1])]);break;case 2:l.push([r(a,i,f[1],f[0])])}}}return l}}]},{}],293:[function(r,n,i){"use strict";var a=r("bit-twiddle"),o=r("union-find");function s(r,n){var i=r.length,a=r.length-n.length,o=Math.min;if(a)return a;switch(i){case 0:return 0;case 1:return r[0]-n[0];case 2:return(c=r[0]+r[1]-n[0]-n[1])||o(r[0],r[1])-o(n[0],n[1]);case 3:var s=r[0]+r[1],l=n[0]+n[1];if(c=s+r[2]-(l+n[2]))return c;var c,u=o(r[0],r[1]),f=o(n[0],n[1]);return(c=o(u,r[2])-o(f,n[2]))||o(u+r[2],s)-o(f+n[2],l);default:var h=r.slice(0);h.sort();var p=n.slice(0);p.sort();for(var d=0;d<i;++d)if(a=h[d]-p[d])return a;return 0}}function l(r,n){return s(r[0],n[0])}function c(r,n){if(n){for(var i=r.length,a=Array(i),o=0;o<i;++o)a[o]=[r[o],n[o]];for(a.sort(l),o=0;o<i;++o)r[o]=a[o][0],n[o]=a[o][1];return r}return r.sort(s),r}function u(r){if(0===r.length)return[];for(var n=1,i=r.length,a=1;a<i;++a){var o=r[a];if(s(o,r[a-1])){if(a===n){n++;continue}r[n++]=o}}return r.length=n,r}function f(r,n){for(var i=0,a=r.length-1,o=-1;i<=a;){var l=i+a>>1,c=s(r[l],n);c<=0?(0===c&&(o=l),i=l+1):c>0&&(a=l-1)}return o}function h(r,n){for(var i=Array(r.length),o=0,l=i.length;o<l;++o)i[o]=[];for(var c=[],u=(o=0,n.length);o<u;++o)for(var h=n[o],p=h.length,d=1,m=1<<p;d<m;++d){c.length=a.popCount(d);for(var g=0,v=0;v<p;++v)d&1<<v&&(c[g++]=h[v]);var y=f(r,c);if(!(y<0))for(;i[y++].push(o),!(y>=r.length||0!==s(r[y],c)););}return i}function p(r,n){if(n<0)return[];for(var i=[],o=(1<<n+1)-1,s=0;s<r.length;++s)for(var l=r[s],u=o;u<1<<l.length;u=a.nextCombination(u)){for(var f=Array(n+1),h=0,p=0;p<l.length;++p)u&1<<p&&(f[h++]=l[p]);i.push(f)}return c(i)}i.dimension=function(r){for(var n=0,i=Math.max,a=0,o=r.length;a<o;++a)n=i(n,r[a].length);return n-1},i.countVertices=function(r){for(var n=-1,i=Math.max,a=0,o=r.length;a<o;++a)for(var s=r[a],l=0,c=s.length;l<c;++l)n=i(n,s[l]);return n+1},i.cloneCells=function(r){for(var n=Array(r.length),i=0,a=r.length;i<a;++i)n[i]=r[i].slice(0);return n},i.compareCells=s,i.normalize=c,i.unique=u,i.findCell=f,i.incidence=h,i.dual=function(r,n){if(!n)return h(u(p(r,0)),r);for(var i=Array(n),a=0;a<n;++a)i[a]=[];a=0;for(var o=r.length;a<o;++a)for(var s=r[a],l=0,c=s.length;l<c;++l)i[s[l]].push(a);return i},i.explode=function(r){for(var n=[],i=0,a=r.length;i<a;++i)for(var o=r[i],s=0|o.length,l=1,u=1<<s;l<u;++l){for(var f=[],h=0;h<s;++h)l>>>h&1&&f.push(o[h]);n.push(f)}return c(n)},i.skeleton=p,i.boundary=function(r){for(var n=[],i=0,a=r.length;i<a;++i)for(var o=r[i],s=0,l=o.length;s<l;++s){for(var u=Array(o.length-1),f=0,h=0;f<l;++f)f!==s&&(u[h++]=o[f]);n.push(u)}return c(n)},i.connectedComponents=function(r,n){return n?function(r,n){for(var i=new o(n),a=0;a<r.length;++a)for(var s=r[a],l=0;l<s.length;++l)for(var c=l+1;c<s.length;++c)i.link(s[l],s[c]);var u=[],f=i.ranks;for(a=0;a<f.length;++a)f[a]=-1;for(a=0;a<r.length;++a){var h=i.find(r[a][0]);f[h]<0?(f[h]=u.length,u.push([r[a].slice(0)])):u[f[h]].push(r[a].slice(0))}return u}(r,n):function(r){for(var n=u(c(p(r,0))),i=new o(n.length),a=0;a<r.length;++a)for(var s=r[a],l=0;l<s.length;++l)for(var h=f(n,[s[l]]),d=l+1;d<s.length;++d)i.link(h,f(n,[s[d]]));var m=[],g=i.ranks;for(a=0;a<g.length;++a)g[a]=-1;for(a=0;a<r.length;++a){var v=i.find(f(n,[r[a][0]]));g[v]<0?(g[v]=m.length,m.push([r[a].slice(0)])):m[g[v]].push(r[a].slice(0))}return m}(r)}},{"bit-twiddle":32,"union-find":309}],294:[function(r,n,i){arguments[4][32][0].apply(i,arguments)},{dup:32}],295:[function(r,n,i){arguments[4][293][0].apply(i,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(r,n,i){"use strict";function a(r){this.roots=Array(r),this.ranks=Array(r);for(var n=0;n<r;++n)this.roots[n]=n,this.ranks[n]=0}n.exports=a,a.prototype.length=function(){return this.roots.length},a.prototype.makeSet=function(){var r=this.roots.length;return this.roots.push(r),this.ranks.push(0),r},a.prototype.find=function(r){for(var n=this.roots;n[r]!==r;){var i=n[r];n[r]=n[i],r=i}return r},a.prototype.link=function(r,n){var i=this.find(r),a=this.find(n);if(i!==a){var o=this.ranks,s=this.roots,l=o[i],c=o[a];l<c?s[i]=a:c<l?s[a]=i:(s[a]=i,++o[i])}}},{}],297:[function(r,n,i){"use strict";n.exports=function(r,n,i){for(var s=n.length,l=r.length,c=Array(s),u=Array(s),f=Array(s),h=Array(s),p=0;p<s;++p)c[p]=u[p]=-1,f[p]=1/0,h[p]=!1;for(p=0;p<l;++p){var d=r[p];if(2!==d.length)throw Error("Input must be a graph");var m=d[1],g=d[0];-1!==u[g]?u[g]=-2:u[g]=m,-1!==c[m]?c[m]=-2:c[m]=g}function v(r){if(h[r])return 1/0;var i,o,s=c[r],l=u[r];return s<0||l<0?1/0:Math.abs(a(n[r],i=n[s],o=n[l]))/Math.sqrt(Math.pow(i[0]-o[0],2)+Math.pow(i[1]-o[1],2))}function y(r,n){var i=k[r],a=k[n];k[r]=a,k[n]=i,A[i]=n,A[a]=r}function x(r){return f[k[r]]}function b(r){for(var n=x(r);;){var i=n,a=2*r+1,o=2*(r+1),s=r;if(a<M){var l=x(a);l<i&&(s=a,i=l)}if(o<M&&x(o)<i&&(s=o),s===r)return r;y(r,s),r=s}}function _(r){for(var n=x(r);r>0;){var i,a=1&(i=r)?i-1>>1:(i>>1)-1;if(a>=0&&n<x(a)){y(r,a),r=a;continue}return r}}function w(){if(M>0){var r=k[0];return y(0,M-1),M-=1,b(0),r}return -1}function T(r,n){var i=k[r];return f[i]===n?r:(f[i]=-1/0,_(r),w(),f[i]=n,_((M+=1)-1))}var k=[],A=Array(s);for(p=0;p<s;++p)(f[p]=v(p))<1/0?(A[p]=k.length,k.push(p)):A[p]=-1;var M=k.length;for(p=M>>1;p>=0;--p)b(p);for(;;){var S=w();if(S<0||f[S]>i)break;!function(r){if(!h[r]){h[r]=!0;var n=c[r],i=u[r];c[i]>=0&&(c[i]=n),u[n]>=0&&(u[n]=i),A[n]>=0&&T(A[n],v(n)),A[i]>=0&&T(A[i],v(i))}}(S)}var E=[];for(p=0;p<s;++p)h[p]||(A[p]=E.length,E.push(n[p].slice()));function L(r,n){if(r[n]<0)return n;var i=n,a=n;do{var o=r[a];if(!h[a]||o<0||o===a||(o=r[a=o],!h[a]||o<0||o===a))break;a=o,i=r[i]}while(i!==a);for(var s=n;s!==a;s=r[s])r[s]=a;return a}var C=[];return r.forEach(function(r){var n=L(c,r[0]),i=L(u,r[1]);if(n>=0&&i>=0&&n!==i){var a=A[n],o=A[i];a!==o&&C.push([a,o])}}),o.unique(o.normalize(C)),{positions:E,edges:C}};var a=r("robust-orientation"),o=r("simplicial-complex")},{"robust-orientation":284,"simplicial-complex":295}],298:[function(r,n,i){"use strict";n.exports=function(r,n){if(n[0][0]<n[1][0])i=n[0],s=n[1];else{if(!(n[0][0]>n[1][0]))return o(n,r);i=n[1],s=n[0]}if(r[0][0]<r[1][0])l=r[0],c=r[1];else{if(!(r[0][0]>r[1][0]))return-o(r,n);l=r[1],c=r[0]}var i,s,l,c,u=a(i,s,c),f=a(i,s,l);if(u<0){if(f<=0)return u}else if(u>0){if(f>=0)return u}else if(f)return f;if(u=a(c,l,s),f=a(c,l,i),u<0){if(f<=0)return u}else if(u>0){if(f>=0)return u}else if(f)return f;return s[0]-c[0]};var a=r("robust-orientation");function o(r,n){if(n[0][0]<n[1][0])i=n[0],o=n[1];else{if(!(n[0][0]>n[1][0])){var i,o,s,l,c=Math.min(r[0][1],r[1][1]),u=Math.max(r[0][1],r[1][1]),f=Math.min(n[0][1],n[1][1]),h=Math.max(n[0][1],n[1][1]);return u<f?u-f:c>h?c-h:u-h}i=n[1],o=n[0]}r[0][1]<r[1][1]?(s=r[0],l=r[1]):(s=r[1],l=r[0]);var p=a(o,i,s);return p||(p=a(o,i,l))||l-o}},{"robust-orientation":284}],299:[function(r,n,i){"use strict";n.exports=function(r){for(var n=r.length,i=2*n,a=Array(i),s=0;s<n;++s){var u=r[s],f=u[0][0]<u[1][0];a[2*s]=new p(u[0][0],u,f,s),a[2*s+1]=new p(u[1][0],u,!f,s)}a.sort(function(r,n){var i=r.x-n.x;return i||(i=r.create-n.create)||Math.min(r.segment[0][1],r.segment[1][1])-Math.min(n.segment[0][1],n.segment[1][1])});var d=o(l),m=[],g=[],v=[];for(s=0;s<i;){for(var y=a[s].x,x=[];s<i;){var b=a[s];if(b.x!==y)break;s+=1,b.segment[0][0]===b.x&&b.segment[1][0]===b.x?b.create&&(b.segment[0][1]<b.segment[1][1]?(x.push(new h(b.segment[0][1],b.index,!0,!0)),x.push(new h(b.segment[1][1],b.index,!1,!1))):(x.push(new h(b.segment[1][1],b.index,!0,!1)),x.push(new h(b.segment[0][1],b.index,!1,!0)))):d=b.create?d.insert(b.segment,b.index):d.remove(b.segment)}m.push(d.root),g.push(y),v.push(x)}return new c(m,g,v)};var a=r("binary-search-bounds"),o=r("functional-red-black-tree"),s=r("robust-orientation"),l=r("./lib/order-segments");function c(r,n,i){this.slabs=r,this.coordinates=n,this.horizontal=i}function u(r,n){return r.y-n}function f(r,n){for(var i=null;r;){var a,o,l,c=r.key;c[0][0]<c[1][0]?(o=c[0],l=c[1]):(o=c[1],l=c[0]);var u=s(o,l,n);if(u<0)r=r.left;else if(u>0){if(n[0]!==c[1][0])i=r,r=r.right;else{if(a=f(r.right,n))return a;r=r.left}}else{if(n[0]!==c[1][0])return r;if(a=f(r.right,n))return a;r=r.left}}return i}function h(r,n,i,a){this.y=r,this.index=n,this.start=i,this.closed=a}function p(r,n,i,a){this.x=r,this.segment=n,this.create=i,this.index=a}c.prototype.castUp=function(r){var n=a.le(this.coordinates,r[0]);if(n<0)return -1;this.slabs[n];var i=f(this.slabs[n],r),o=-1;if(i&&(o=i.value),this.coordinates[n]===r[0]){var c=null;if(i&&(c=i.key),n>0){var h=f(this.slabs[n-1],r);h&&(c?l(h.key,c)>0&&(c=h.key,o=h.value):(o=h.value,c=h.key))}var p=this.horizontal[n];if(p.length>0){var d=a.ge(p,r[1],u);if(d<p.length){var m=p[d];if(r[1]===m.y){if(m.closed)return m.index;for(;d<p.length-1&&p[d+1].y===r[1];)if((m=p[d+=1]).closed)return m.index;if(m.y===r[1]&&!m.start){if((d+=1)>=p.length)return o;m=p[d]}}if(m.start){if(c){var g=s(c[0],c[1],[r[0],m.y]);c[0][0]>c[1][0]&&(g=-g),g>0&&(o=m.index)}else o=m.index}else m.y!==r[1]&&(o=m.index)}}}return o}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(r,n,i){"use strict";var a=r("robust-dot-product"),o=r("robust-sum");function s(r,n){var i=o(a(r,n),[n[n.length-1]]);return i[i.length-1]}function l(r,n,i,a){var o=-n/(a-n);o<0?o=0:o>1&&(o=1);for(var s=1-o,l=r.length,c=Array(l),u=0;u<l;++u)c[u]=o*r[u]+s*i[u];return c}n.exports=function(r,n){for(var i=[],a=[],o=s(r[r.length-1],n),c=r[r.length-1],u=r[0],f=0;f<r.length;++f,c=u){var h=s(u=r[f],n);if(o<0&&h>0||o>0&&h<0){var p=l(c,h,u,o);i.push(p),a.push(p.slice())}h<0?a.push(u.slice()):h>0?i.push(u.slice()):(i.push(u.slice()),a.push(u.slice())),o=h}return{positive:i,negative:a}},n.exports.positive=function(r,n){for(var i=[],a=s(r[r.length-1],n),o=r[r.length-1],c=r[0],u=0;u<r.length;++u,o=c){var f=s(c=r[u],n);(a<0&&f>0||a>0&&f<0)&&i.push(l(o,f,c,a)),f>=0&&i.push(c.slice()),a=f}return i},n.exports.negative=function(r,n){for(var i=[],a=s(r[r.length-1],n),o=r[r.length-1],c=r[0],u=0;u<r.length;++u,o=c){var f=s(c=r[u],n);(a<0&&f>0||a>0&&f<0)&&i.push(l(o,f,c,a)),f<=0&&i.push(c.slice()),a=f}return i}},{"robust-dot-product":281,"robust-sum":289}],301:[function(r,n,i){!function(){"use strict";var r={not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function n(i){return function(i,a){var o,s,l,c,u,f,h,p,d,m=1,g=i.length,v="";for(s=0;s<g;s++)if("string"==typeof i[s])v+=i[s];else if("object"==typeof i[s]){if((c=i[s]).keys)for(o=a[m],l=0;l<c.keys.length;l++){if(null==o)throw Error(n('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[l],c.keys[l-1]));o=o[c.keys[l]]}else o=c.param_no?a[c.param_no]:a[m++];if(r.not_type.test(c.type)&&r.not_primitive.test(c.type)&&o instanceof Function&&(o=o()),r.numeric_arg.test(c.type)&&"number"!=typeof o&&isNaN(o))throw TypeError(n("[sprintf] expecting number but found %T",o));switch(r.number.test(c.type)&&(p=o>=0),c.type){case"b":o=parseInt(o,10).toString(2);break;case"c":o=String.fromCharCode(parseInt(o,10));break;case"d":case"i":o=parseInt(o,10);break;case"j":o=JSON.stringify(o,null,c.width?parseInt(c.width):0);break;case"e":o=c.precision?parseFloat(o).toExponential(c.precision):parseFloat(o).toExponential();break;case"f":o=c.precision?parseFloat(o).toFixed(c.precision):parseFloat(o);break;case"g":o=c.precision?String(Number(o.toPrecision(c.precision))):parseFloat(o);break;case"o":o=(parseInt(o,10)>>>0).toString(8);break;case"s":o=String(o),o=c.precision?o.substring(0,c.precision):o;break;case"t":o=String(!!o),o=c.precision?o.substring(0,c.precision):o;break;case"T":o=Object.prototype.toString.call(o).slice(8,-1).toLowerCase(),o=c.precision?o.substring(0,c.precision):o;break;case"u":o=parseInt(o,10)>>>0;break;case"v":o=o.valueOf(),o=c.precision?o.substring(0,c.precision):o;break;case"x":o=(parseInt(o,10)>>>0).toString(16);break;case"X":o=(parseInt(o,10)>>>0).toString(16).toUpperCase()}r.json.test(c.type)?v+=o:(r.number.test(c.type)&&(!p||c.sign)?(d=p?"+":"-",o=o.toString().replace(r.sign,"")):d="",f=c.pad_char?"0"===c.pad_char?"0":c.pad_char.charAt(1):" ",h=c.width-(d+o).length,u=c.width&&h>0?f.repeat(h):"",v+=c.align?d+o+u:"0"===f?d+u+o:u+d+o)}return v}(function(n){if(o[n])return o[n];for(var i,a=n,s=[],l=0;a;){if(null!==(i=r.text.exec(a)))s.push(i[0]);else if(null!==(i=r.modulo.exec(a)))s.push("%");else{if(null===(i=r.placeholder.exec(a)))throw SyntaxError("[sprintf] unexpected placeholder");if(i[2]){l|=1;var c=[],u=i[2],f=[];if(null===(f=r.key.exec(u)))throw SyntaxError("[sprintf] failed to parse named argument key");for(c.push(f[1]);""!==(u=u.substring(f[0].length));)if(null!==(f=r.key_access.exec(u)))c.push(f[1]);else{if(null===(f=r.index_access.exec(u)))throw SyntaxError("[sprintf] failed to parse named argument key");c.push(f[1])}i[2]=c}else l|=2;if(3===l)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");s.push({placeholder:i[0],param_no:i[1],keys:i[2],sign:i[3],pad_char:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}a=a.substring(i[0].length)}return o[n]=s}(i),arguments)}function a(r,i){return n.apply(null,[r].concat(i||[]))}var o=Object.create(null);void 0!==i&&(i.sprintf=n,i.vsprintf=a),"undefined"!=typeof window&&(window.sprintf=n,window.vsprintf=a)}()},{}],302:[function(r,n,i){"use strict";n.exports=function(r,n){if(r.dimension<=0)return{positions:[],cells:[]};if(1===r.dimension)return function(r,n){for(var i=o(r,n),a=i.length,s=Array(a),l=Array(a),c=0;c<a;++c)s[c]=[i[c]],l[c]=[c];return{positions:s,cells:l}}(r,n);var i=r.order.join()+"-"+r.dtype,c=l[i];return n=+n||0,c||(c=l[i]=function(r,n){var i=s[r.length+"d"];if(i)return i(a,r,n)}(r.order,r.dtype)),c(r,n)};var a=r("ndarray-extract-contour"),o=r("zero-crossings"),s={"2d":function(r,n,i){var a=r({order:n,scalarArguments:3,getters:"generic"===i?[0]:void 0,phase:function(r,n,i,a){return r>a|0},vertex:function(r,n,i,a,o,s,l,c,u,f,h,p,d){var m=(l<<0)+(c<<1)+(u<<2)+(f<<3)|0;if(0!==m&&15!==m)switch(m){case 0:case 15:h.push([r-.5,n-.5]);break;case 1:h.push([r-.25-.25*(a+i-2*d)/(i-a),n-.25-.25*(o+i-2*d)/(i-o)]);break;case 2:h.push([r-.75-.25*(-a-i+2*d)/(a-i),n-.25-.25*(s+a-2*d)/(a-s)]);break;case 3:h.push([r-.5,n-.5-.5*(o+i+s+a-4*d)/(i-o+a-s)]);break;case 4:h.push([r-.25-.25*(s+o-2*d)/(o-s),n-.75-.25*(-o-i+2*d)/(o-i)]);break;case 5:h.push([r-.5-.5*(a+i+s+o-4*d)/(i-a+o-s),n-.5]);break;case 6:h.push([r-.5-.25*(-a-i+s+o)/(a-i+o-s),n-.5-.25*(-o-i+s+a)/(o-i+a-s)]);break;case 7:h.push([r-.75-.25*(s+o-2*d)/(o-s),n-.75-.25*(s+a-2*d)/(a-s)]);break;case 8:h.push([r-.75-.25*(-s-o+2*d)/(s-o),n-.75-.25*(-s-a+2*d)/(s-a)]);break;case 9:h.push([r-.5-.25*(a+i+-s-o)/(i-a+s-o),n-.5-.25*(o+i+-s-a)/(i-o+s-a)]);break;case 10:h.push([r-.5-.5*(-a-i-s-o+4*d)/(a-i+s-o),n-.5]);break;case 11:h.push([r-.25-.25*(-s-o+2*d)/(s-o),n-.75-.25*(o+i-2*d)/(i-o)]);break;case 12:h.push([r-.5,n-.5-.5*(-o-i-s-a+4*d)/(o-i+s-a)]);break;case 13:h.push([r-.75-.25*(a+i-2*d)/(i-a),n-.25-.25*(-s-a+2*d)/(s-a)]);break;case 14:h.push([r-.25-.25*(-a-i+2*d)/(a-i),n-.25-.25*(-o-i+2*d)/(o-i)])}},cell:function(r,n,i,a,o,s,l,c,u){o?c.push([r,n]):c.push([n,r])}});return function(r,n){var i=[],o=[];return a(r,i,o,n),{positions:i,cells:o}}}},l={}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(r,n,i){(function(i){(function(){"use strict";n.exports=function r(n,i,o){o=o||{};var l=s[n];l||(l=s[n]={" ":{data:new Float32Array(0),shape:.2}});var c=l[i];if(!c){if(i.length<=1||!/\d/.test(i))c=l[i]=function(r){for(var n=r.cells,i=r.positions,a=new Float32Array(6*n.length),o=0,s=0,l=0;l<n.length;++l)for(var c=n[l],u=0;u<3;++u){var f=i[c[u]];a[o++]=f[0],a[o++]=f[1]+1.4,s=Math.max(f[0],s)}return{data:a,shape:s}}(a(i,{triangles:!0,font:n,textAlign:o.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var u=i.split(/(\d|\s)/),f=Array(u.length),h=0,p=0,d=0;d<u.length;++d)f[d]=r(n,u[d]),h+=f[d].data.length,p+=f[d].shape,d>0&&(p+=.02);var m=new Float32Array(h),g=0,v=-.5*p;for(d=0;d<f.length;++d){for(var y=f[d].data,x=0;x<y.length;x+=2)m[g++]=y[x]+v,m[g++]=y[x+1];v+=f[d].shape+.02}c=l[i]={data:m,shape:p}}}return c};var a=r("vectorize-text"),o=window||i.global||{},s=o.__TEXT_CACHE||{};o.__TEXT_CACHE={}}).call(this)}).call(this,r("_process"))},{_process:5,"vectorize-text":311}],304:[function(r,n,i){"use strict";var a=r("parse-unit");function o(r,n){var i=a(getComputedStyle(r).getPropertyValue(n));return i[0]*s(i[1],r)}function s(r,n){switch(n=n||document.body,r=(r||"px").trim().toLowerCase(),n!==window&&n!==document||(n=document.body),r){case"%":return n.clientHeight/100;case"ch":case"ex":var i,a,s,l;return i=r,a=n,(s=document.createElement("div")).style["font-size"]="128"+i,a.appendChild(s),l=o(s,"font-size")/128,a.removeChild(s),l;case"em":return o(n,"font-size");case"rem":return o(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}n.exports=s},{"parse-unit":265}],305:[function(r,n,i){"use strict";n.exports=function(r){var n=(r=r||{}).center||[0,0,0],i=r.up||[0,1,0],a=r.right||p(i),o=r.radius||1,s=r.theta||0,h=r.phi||0;if(n=[].slice.call(n,0,3),c(i=[].slice.call(i,0,3),i),c(a=[].slice.call(a,0,3),a),"eye"in r){var m=r.eye,g=[m[0]-n[0],m[1]-n[1],m[2]-n[2]];l(a,g,i),1e-6>f(a[0],a[1],a[2])?a=p(i):c(a,a),o=f(g[0],g[1],g[2]);var v=u(i,g)/o,y=u(a,g)/o;h=Math.acos(v),s=Math.acos(y)}return o=Math.log(o),new d(r.zoomMin,r.zoomMax,n,i,a,o,s,h)};var a=r("filtered-vector"),o=r("gl-mat4/invert"),s=r("gl-mat4/rotate"),l=r("gl-vec3/cross"),c=r("gl-vec3/normalize"),u=r("gl-vec3/dot");function f(r,n,i){return Math.sqrt(Math.pow(r,2)+Math.pow(n,2)+Math.pow(i,2))}function h(r){return Math.min(1,Math.max(-1,r))}function p(r){var n=Math.abs(r[0]),i=Math.abs(r[1]),a=Math.abs(r[2]),o=[0,0,0];n>Math.max(i,a)?o[2]=1:i>Math.max(n,a)?o[0]=1:o[1]=1;for(var s=0,l=0,u=0;u<3;++u)s+=r[u]*r[u],l+=o[u]*r[u];for(u=0;u<3;++u)o[u]-=l/s*r[u];return c(o,o),o}function d(r,n,i,o,s,l,c,u){this.center=a(i),this.up=a(o),this.right=a(s),this.radius=a([l]),this.angle=a([c,u]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(r,n),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=Array(16);for(var f=0;f<16;++f)this.computedMatrix[f]=.5;this.recalcMatrix(0)}var m=d.prototype;m.setDistanceLimits=function(r,n){r=r>0?Math.log(r):-1/0,n=Math.max(n=n>0?Math.log(n):1/0,r),this.radius.bounds[0][0]=r,this.radius.bounds[1][0]=n},m.getDistanceLimits=function(r){var n=this.radius.bounds[0];return r?(r[0]=Math.exp(n[0][0]),r[1]=Math.exp(n[1][0]),r):[Math.exp(n[0][0]),Math.exp(n[1][0])]},m.recalcMatrix=function(r){this.center.curve(r),this.up.curve(r),this.right.curve(r),this.radius.curve(r),this.angle.curve(r);for(var n=this.computedUp,i=this.computedRight,a=0,o=0,s=0;s<3;++s)o+=n[s]*i[s],a+=n[s]*n[s];var u=Math.sqrt(a),h=0;for(s=0;s<3;++s)i[s]-=n[s]*o/a,h+=i[s]*i[s],n[s]/=u;var p=Math.sqrt(h);for(s=0;s<3;++s)i[s]/=p;var d=this.computedToward;l(d,n,i),c(d,d);var m=Math.exp(this.computedRadius[0]),g=this.computedAngle[0],v=this.computedAngle[1],y=Math.cos(g),x=Math.sin(g),b=Math.cos(v),_=Math.sin(v),w=this.computedCenter,T=y*b,k=x*b,A=-y*_,M=-x*_,S=this.computedEye,E=this.computedMatrix;for(s=0;s<3;++s){var L=T*i[s]+k*d[s]+_*n[s];E[4*s+1]=A*i[s]+M*d[s]+b*n[s],E[4*s+2]=L,E[4*s+3]=0}var C=E[1],P=E[5],I=E[9],O=E[2],z=E[6],D=E[10],R=P*D-I*z,F=I*O-C*D,B=C*z-P*O,N=f(R,F,B);for(R/=N,F/=N,B/=N,E[0]=R,E[4]=F,E[8]=B,s=0;s<3;++s)S[s]=w[s]+E[2+4*s]*m;for(s=0;s<3;++s){h=0;for(var j=0;j<3;++j)h+=E[s+4*j]*S[j];E[12+s]=-h}E[15]=1},m.getMatrix=function(r,n){this.recalcMatrix(r);var i=this.computedMatrix;if(n){for(var a=0;a<16;++a)n[a]=i[a];return n}return i};var g=[0,0,0];m.rotate=function(r,n,i,a){if(this.angle.move(r,n,i),a){this.recalcMatrix(r);var o=this.computedMatrix;g[0]=o[2],g[1]=o[6],g[2]=o[10];for(var l=this.computedUp,c=this.computedRight,u=this.computedToward,f=0;f<3;++f)o[4*f]=l[f],o[4*f+1]=c[f],o[4*f+2]=u[f];for(s(o,o,a,g),f=0;f<3;++f)l[f]=o[4*f],c[f]=o[4*f+1];this.up.set(r,l[0],l[1],l[2]),this.right.set(r,c[0],c[1],c[2])}},m.pan=function(r,n,i,a){n=n||0,i=i||0,a=a||0,this.recalcMatrix(r);var o=this.computedMatrix,s=(this.computedRadius[0],o[1]),l=o[5],c=o[9],u=f(s,l,c);s/=u,l/=u,c/=u;var h=o[0],p=o[4],d=o[8],m=h*s+p*l+d*c,g=f(h-=s*m,p-=l*m,d-=c*m),v=(h/=g)*n+s*i,y=(p/=g)*n+l*i,x=(d/=g)*n+c*i;this.center.move(r,v,y,x);var b=Math.exp(this.computedRadius[0]);b=Math.max(1e-4,b+a),this.radius.set(r,Math.log(b))},m.translate=function(r,n,i,a){this.center.move(r,n||0,i||0,a||0)},m.setMatrix=function(r,n,i,a){var s=1;"number"==typeof i&&(s=0|i),(s<0||s>3)&&(s=1);var l=(s+2)%3;n||(this.recalcMatrix(r),n=this.computedMatrix);var c=n[s],u=n[s+4],p=n[s+8];if(a){var d=Math.abs(c),m=Math.abs(p),g=Math.max(d,Math.abs(u),m);d===g?(c=c<0?-1:1,u=p=0):m===g?(p=p<0?-1:1,c=u=0):(u=u<0?-1:1,c=p=0)}else{var v=f(c,u,p);c/=v,u/=v,p/=v}var y,x,b=n[l],_=n[l+4],w=n[l+8],T=b*c+_*u+w*p,k=f(b-=c*T,_-=u*T,w-=p*T),A=u*(w/=k)-p*(_/=k),M=p*(b/=k)-c*w,S=c*_-u*b,E=f(A,M,S);if(A/=E,M/=E,S/=E,this.center.jump(r,G,Y,W),this.radius.idle(r),this.up.jump(r,c,u,p),this.right.jump(r,b,_,w),2===s){var L=n[1],C=n[5],P=n[9],I=L*b+C*_+P*w,O=L*A+C*M+P*S;y=F<0?-Math.PI/2:Math.PI/2,x=Math.atan2(O,I)}else{var z=n[2],D=n[6],R=n[10],F=z*c+D*u+R*p,B=z*b+D*_+R*w,N=z*A+D*M+R*S;y=Math.asin(h(F)),x=Math.atan2(N,B)}this.angle.jump(r,x,y),this.recalcMatrix(r);var j=n[2],U=n[6],V=n[10],H=this.computedMatrix;o(H,n);var q=H[15],G=H[12]/q,Y=H[13]/q,W=H[14]/q,X=Math.exp(this.computedRadius[0]);this.center.jump(r,G-j*X,Y-U*X,W-V*X)},m.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},m.idle=function(r){this.center.idle(r),this.up.idle(r),this.right.idle(r),this.radius.idle(r),this.angle.idle(r)},m.flush=function(r){this.center.flush(r),this.up.flush(r),this.right.flush(r),this.radius.flush(r),this.angle.flush(r)},m.setDistance=function(r,n){n>0&&this.radius.set(r,Math.log(n))},m.lookAt=function(r,n,i,a){this.recalcMatrix(r),n=n||this.computedEye,i=i||this.computedCenter;var o=(a=a||this.computedUp)[0],s=a[1],l=a[2],c=f(o,s,l);if(!(c<1e-6)){o/=c,s/=c,l/=c;var u=n[0]-i[0],p=n[1]-i[1],d=n[2]-i[2],m=f(u,p,d);if(!(m<1e-6)){u/=m,p/=m,d/=m;var g=this.computedRight,v=g[0],y=g[1],x=g[2],b=o*v+s*y+l*x,_=f(v-=b*o,y-=b*s,x-=b*l);if(!(_<.01&&(_=f(v=s*d-l*p,y=l*u-o*d,x=o*p-s*u))<1e-6)){v/=_,y/=_,x/=_,this.up.set(r,o,s,l),this.right.set(r,v,y,x),this.center.set(r,i[0],i[1],i[2]),this.radius.set(r,Math.log(m));var w=s*x-l*y,T=l*v-o*x,k=o*y-s*v,A=f(w,T,k),M=o*u+s*p+l*d,S=v*u+y*p+x*d,E=(w/=A)*u+(T/=A)*p+(k/=A)*d,L=Math.asin(h(M)),C=Math.atan2(E,S),P=this.angle._state,I=P[P.length-1],O=P[P.length-2],z=Math.abs((I%=2*Math.PI)+2*Math.PI-C),D=Math.abs(I-C),R=Math.abs(I-2*Math.PI-C);z<D&&(I+=2*Math.PI),R<D&&(I-=2*Math.PI),this.angle.jump(this.angle.lastT(),I,O),this.angle.set(r,C,L)}}}}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(r,n,i){"use strict";n.exports=function(r,n,i){var o=r*n,s=a*r,l=s-(s-r),c=r-l,u=a*n,f=u-(u-n),h=n-f,p=c*h-(o-l*f-c*f-l*h);return i?(i[0]=p,i[1]=o,i):[p,o]};var a=134217729},{}],307:[function(r,n,i){"use strict";n.exports=function(r,n,i){var a=r+n,o=a-r,s=n-o,l=r-(a-o);return i?(i[0]=l+s,i[1]=a,i):[l+s,a]}},{}],308:[function(r,n,a){(function(n){(function(){"use strict";var i=r("bit-twiddle"),o=r("dup"),s=r("buffer").Buffer;n.__TYPEDARRAY_POOL||(n.__TYPEDARRAY_POOL={UINT8:o([32,0]),UINT16:o([32,0]),UINT32:o([32,0]),BIGUINT64:o([32,0]),INT8:o([32,0]),INT16:o([32,0]),INT32:o([32,0]),BIGINT64:o([32,0]),FLOAT:o([32,0]),DOUBLE:o([32,0]),DATA:o([32,0]),UINT8C:o([32,0]),BUFFER:o([32,0])});var l="undefined"!=typeof Uint8ClampedArray,c="undefined"!=typeof BigUint64Array,u="undefined"!=typeof BigInt64Array,f=n.__TYPEDARRAY_POOL;f.UINT8C||(f.UINT8C=o([32,0])),f.BIGUINT64||(f.BIGUINT64=o([32,0])),f.BIGINT64||(f.BIGINT64=o([32,0])),f.BUFFER||(f.BUFFER=o([32,0]));var h=f.DATA,p=f.BUFFER;function d(r){if(r){var n=r.length||r.byteLength;h[i.log2(n)].push(r)}}function m(r){r=i.nextPow2(r);var n=h[i.log2(r)];return n.length>0?n.pop():new ArrayBuffer(r)}function g(r){return new Uint8Array(m(r),0,r)}function v(r){return new Uint16Array(m(2*r),0,r)}function y(r){return new Uint32Array(m(4*r),0,r)}function x(r){return new Int8Array(m(r),0,r)}function b(r){return new Int16Array(m(2*r),0,r)}function _(r){return new Int32Array(m(4*r),0,r)}function w(r){return new Float32Array(m(4*r),0,r)}function T(r){return new Float64Array(m(8*r),0,r)}function k(r){return l?new Uint8ClampedArray(m(r),0,r):g(r)}function A(r){return c?new BigUint64Array(m(8*r),0,r):null}function M(r){return u?new BigInt64Array(m(8*r),0,r):null}function S(r){return new DataView(m(r),0,r)}function E(r){r=i.nextPow2(r);var n=p[i.log2(r)];return n.length>0?n.pop():new s(r)}a.free=function(r){if(s.isBuffer(r))p[i.log2(r.length)].push(r);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(r)&&(r=r.buffer),!r)return;var n=r.length||r.byteLength;h[0|i.log2(n)].push(r)}},a.freeUint8=a.freeUint16=a.freeUint32=a.freeBigUint64=a.freeInt8=a.freeInt16=a.freeInt32=a.freeBigInt64=a.freeFloat32=a.freeFloat=a.freeFloat64=a.freeDouble=a.freeUint8Clamped=a.freeDataView=function(r){d(r.buffer)},a.freeArrayBuffer=d,a.freeBuffer=function(r){p[i.log2(r.length)].push(r)},a.malloc=function(r,n){if(void 0===n||"arraybuffer"===n)return m(r);switch(n){case"uint8":return g(r);case"uint16":return v(r);case"uint32":return y(r);case"int8":return x(r);case"int16":return b(r);case"int32":return _(r);case"float":case"float32":return w(r);case"double":case"float64":return T(r);case"uint8_clamped":return k(r);case"bigint64":return M(r);case"biguint64":return A(r);case"buffer":return E(r);case"data":case"dataview":return S(r)}return null},a.mallocArrayBuffer=m,a.mallocUint8=g,a.mallocUint16=v,a.mallocUint32=y,a.mallocInt8=x,a.mallocInt16=b,a.mallocInt32=_,a.mallocFloat32=a.mallocFloat=w,a.mallocFloat64=a.mallocDouble=T,a.mallocUint8Clamped=k,a.mallocBigUint64=A,a.mallocBigInt64=M,a.mallocDataView=S,a.mallocBuffer=E,a.clearCache=function(){for(var r=0;r<32;++r)f.UINT8[r].length=0,f.UINT16[r].length=0,f.UINT32[r].length=0,f.INT8[r].length=0,f.INT16[r].length=0,f.INT32[r].length=0,f.FLOAT[r].length=0,f.DOUBLE[r].length=0,f.BIGUINT64[r].length=0,f.BIGINT64[r].length=0,f.UINT8C[r].length=0,h[r].length=0,p[r].length=0}}).call(this)}).call(this,void 0!==i?i:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(r,n,i){"use strict";function a(r){this.roots=Array(r),this.ranks=Array(r);for(var n=0;n<r;++n)this.roots[n]=n,this.ranks[n]=0}n.exports=a;var o=a.prototype;Object.defineProperty(o,"length",{get:function(){return this.roots.length}}),o.makeSet=function(){var r=this.roots.length;return this.roots.push(r),this.ranks.push(0),r},o.find=function(r){for(var n=r,i=this.roots;i[r]!==r;)r=i[r];for(;i[n]!==r;){var a=i[n];i[n]=r,n=a}return r},o.link=function(r,n){var i=this.find(r),a=this.find(n);if(i!==a){var o=this.ranks,s=this.roots,l=o[i],c=o[a];l<c?s[i]=a:c<l?s[a]=i:(s[a]=i,++o[i])}}},{}],310:[function(r,n,i){"use strict";n.exports=function(r,n,i){return 0===r.length?r:n?(i||r.sort(n),function(r,n){for(var i=1,a=r.length,o=r[0],s=r[0],l=1;l<a;++l)if(s=o,n(o=r[l],s)){if(l===i){i++;continue}r[i++]=o}return r.length=i,r}(r,n)):(i||r.sort(),function(r){for(var n=1,i=r.length,a=r[0],o=r[0],s=1;s<i;++s,o=a)if(o=a,(a=r[s])!==o){if(s===n){n++;continue}r[n++]=a}return r.length=n,r}(r))}},{}],311:[function(r,n,i){"use strict";n.exports=function(r,n){return"object"==typeof n&&null!==n||(n={}),a(r,n.canvas||o,n.context||s,n)};var a=r("./lib/vtext"),o=null,s=null;"undefined"!=typeof document&&((o=document.createElement("canvas")).width=8192,o.height=1024,s=o.getContext("2d"))},{"./lib/vtext":312}],312:[function(r,n,i){n.exports=function(r,n,i,a){var s=64,l=1.25,c={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return a&&(a.size&&a.size>0&&(s=a.size),a.lineSpacing&&a.lineSpacing>0&&(l=a.lineSpacing),a.styletags&&a.styletags.breaklines&&(c.breaklines=!!a.styletags.breaklines),a.styletags&&a.styletags.bolds&&(c.bolds=!!a.styletags.bolds),a.styletags&&a.styletags.italics&&(c.italics=!!a.styletags.italics),a.styletags&&a.styletags.subscripts&&(c.subscripts=!!a.styletags.subscripts),a.styletags&&a.styletags.superscripts&&(c.superscripts=!!a.styletags.superscripts)),i.font=[a.fontStyle,a.fontVariant,a.fontWeight,s+"px",a.font].filter(function(r){return r}).join(" "),i.textAlign="start",i.textBaseline="alphabetic",i.direction="ltr",p(function(r,n,i,a,s,l){i=i.replace(/\n/g,""),i=!0===l.breaklines?i.replace(/\<br\>/g,"\n"):i.replace(/\<br\>/g," ");var c="",u=[];for(m=0;m<i.length;++m)u[m]=c;!0===l.bolds&&(u=f("b","b|",i,u)),!0===l.italics&&(u=f("i","i|",i,u)),!0===l.superscripts&&(u=f("sup","+1",i,u)),!0===l.subscripts&&(u=f("sub","-1",i,u));var h=[],p="";for(m=0;m<i.length;++m)null!==u[m]&&(p+=i[m],h.push(u[m]));var d,m,g,v,y,x=p.split("\n"),b=x.length,_=Math.round(s*a),w=2*a,T=0,k=b*_+w;r.height<k&&(r.height=k),n.fillStyle="#000",n.fillRect(0,0,r.width,r.height),n.fillStyle="#fff";var A=0,M="";function S(){if(""!==M){var r=n.measureText(M).width;n.fillText(M,a+g,w+v),g+=r}}function E(){return Math.round(y)+"px "}for(d=0;d<b;++d){var L=x[d]+"\n";for(g=0,v=d*_,y=a,M="",m=0;m<L.length;++m){var C=m+A<h.length?h[m+A]:h[h.length-1];c===C?M+=L[m]:(S(),M=L[m],void 0!==C&&(function(r,i){var a=""+n.font;if(!0===l.subscripts){var o=r.indexOf("-"),s=i.indexOf("-"),c=o>-1?parseInt(r[1+o]):0,u=s>-1?parseInt(i[1+s]):0;c!==u&&(a=a.replace(E(),"?px "),y*=Math.pow(.75,u-c),a=a.replace("?px ",E())),v+=.25*_*(u-c)}if(!0===l.superscripts){var f=r.indexOf("+"),h=i.indexOf("+"),p=f>-1?parseInt(r[1+f]):0,d=h>-1?parseInt(i[1+h]):0;p!==d&&(a=a.replace(E(),"?px "),y*=Math.pow(.75,d-p),a=a.replace("?px ",E())),v-=.25*_*(d-p)}if(!0===l.bolds){var m=r.indexOf("b|")>-1,g=i.indexOf("b|")>-1;!m&&g&&(a=x?a.replace("italic ","italic bold "):"bold "+a),m&&!g&&(a=a.replace("bold ",""))}if(!0===l.italics){var x=r.indexOf("i|")>-1,b=i.indexOf("i|")>-1;!x&&b&&(a="italic "+a),x&&!b&&(a=a.replace("italic ",""))}n.font=a}(c,C),c=C))}S(),A+=L.length;var P=0|Math.round(g+2*a);T<P&&(T=P)}var I=T,O=w+_*b;return o(n.getImageData(0,0,I,O).data,[O,I,4]).pick(-1,-1,0).transpose(1,0)}(n,i,r,s,l,c),a,s)},n.exports.processPixels=p;var a=r("surface-nets"),o=r("ndarray"),s=r("simplify-planar-graph"),l=r("clean-pslg"),c=r("cdt2d"),u=r("planar-graph-to-polyline");function f(r,n,i,a){for(var o="<"+r+">",s="</"+r+">",l=o.length,c=s.length,u="+"===n[0]||"-"===n[0],f=0,h=-c;f>-1&&-1!==(f=i.indexOf(o,f))&&-1!==(h=i.indexOf(s,f+l))&&!(h<=f);){for(var p=f;p<h+c;++p)if(p<f+l||p>=h)a[p]=null,i=i.substr(0,p)+" "+i.substr(p+1);else if(null!==a[p]){var d=a[p].indexOf(n[0]);-1===d?a[p]+=n:u&&(a[p]=a[p].substr(0,d+1)+(1+parseInt(a[p][d+1]))+a[p].substr(d+2))}var m=f+l,g=i.substr(m,h-m).indexOf(o);f=-1!==g?g:h+c}return a}function h(r,n,i,o){var f,h=(f=a(r,128),o?s(f.cells,f.positions,.25):{edges:f.cells,positions:f.positions}),p=function(r,n,i){for(var a=n.textAlign||"start",o=n.textBaseline||"alphabetic",s=[1073741824,1073741824],l=[0,0],c=r.length,u=0;u<c;++u)for(var f=r[u],h=0;h<2;++h)s[h]=0|Math.min(s[h],f[h]),l[h]=0|Math.max(l[h],f[h]);var p=0;switch(a){case"center":p=-.5*(s[0]+l[0]);break;case"right":case"end":p=-l[0];break;case"left":case"start":p=-s[0];break;default:throw Error("vectorize-text: Unrecognized textAlign: '"+a+"'")}var d=0;switch(o){case"hanging":case"top":d=-s[1];break;case"middle":d=-.5*(s[1]+l[1]);break;case"alphabetic":case"ideographic":d=-3*i;break;case"bottom":d=-l[1];break;default:throw Error("vectorize-text: Unrecoginized textBaseline: '"+o+"'")}var m=1/i;return"lineHeight"in n?m*=+n.lineHeight:"width"in n?m=n.width/(l[0]-s[0]):"height"in n&&(m=n.height/(l[1]-s[1])),r.map(function(r){return[m*(r[0]+p),m*(r[1]+d)]})}(h.positions,n,i),d=h.edges,m="ccw"===n.orientation;if(l(p,d),n.polygons||n.polygon||n.polyline){for(var g=u(d,p),v=Array(g.length),y=0;y<g.length;++y){for(var x=g[y],b=Array(x.length),_=0;_<x.length;++_){for(var w=x[_],T=Array(w.length),k=0;k<w.length;++k)T[k]=p[w[k]].slice();m&&T.reverse(),b[_]=T}v[y]=b}return v}return n.triangles||n.triangulate||n.triangle?{cells:c(p,d,{delaunay:!1,exterior:!1,interior:!0}),positions:p}:{edges:d,positions:p}}function p(r,n,i){try{return h(r,n,i,!0)}catch(r){}try{return h(r,n,i,!1)}catch(r){}return n.polygons||n.polyline||n.polygon?[]:n.triangles||n.triangulate||n.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(r,n,i){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=b);var r,i,a,o=!1;if("function"==typeof WeakMap){var s=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var l=new s,c=Object.freeze({});if(l.set(c,1),1===l.get(c))return void(n.exports=WeakMap);o=!0}}Object.prototype.hasOwnProperty;var u=Object.getOwnPropertyNames,f=Object.defineProperty,h=Object.isExtensible,p="weakmap:ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var d=new ArrayBuffer(25),m=new Uint8Array(d);crypto.getRandomValues(m),p="weakmap:rand:"+Array.prototype.map.call(m,function(r){return(r%36).toString(36)}).join("")+"___"}if(f(Object,"getOwnPropertyNames",{value:function(r){return u(r).filter(_)}}),"getPropertyNames"in Object){var g=Object.getPropertyNames;f(Object,"getPropertyNames",{value:function(r){return g(r).filter(_)}})}r=Object.freeze,f(Object,"freeze",{value:function(n){return w(n),r(n)}}),i=Object.seal,f(Object,"seal",{value:function(r){return w(r),i(r)}}),a=Object.preventExtensions,f(Object,"preventExtensions",{value:function(r){return w(r),a(r)}});var v=!1,y=0,x=function(){this instanceof x||k();var r=[],n=[],i=y++;return Object.create(x.prototype,{get___:{value:T(function(a,o){var s,l=w(a);return l?i in l?l[i]:o:(s=r.indexOf(a))>=0?n[s]:o})},has___:{value:T(function(n){var a=w(n);return a?i in a:r.indexOf(n)>=0})},set___:{value:T(function(a,o){var s,l=w(a);return l?l[i]=o:(s=r.indexOf(a))>=0?n[s]=o:(n[s=r.length]=o,r[s]=a),this})},delete___:{value:T(function(a){var o,s,l=w(a);return l?i in l&&delete l[i]:!((o=r.indexOf(a))<0)&&(s=r.length-1,r[o]=void 0,n[o]=n[s],r[o]=r[s],r.length=s,n.length=s,!0)})}})};x.prototype=Object.create(Object.prototype,{get:{value:function(r,n){return this.get___(r,n)},writable:!0,configurable:!0},has:{value:function(r){return this.has___(r)},writable:!0,configurable:!0},set:{value:function(r,n){return this.set___(r,n)},writable:!0,configurable:!0},delete:{value:function(r){return this.delete___(r)},writable:!0,configurable:!0}}),"function"==typeof s?function(){function r(){this instanceof x||k();var r,n=new s,i=void 0,a=!1;return r=o?function(r,a){return n.set(r,a),n.has(r)||(i||(i=new x),i.set(r,a)),this}:function(r,o){if(a)try{n.set(r,o)}catch(n){i||(i=new x),i.set___(r,o)}else n.set(r,o);return this},Object.create(x.prototype,{get___:{value:T(function(r,a){return i?n.has(r)?n.get(r):i.get___(r,a):n.get(r,a)})},has___:{value:T(function(r){return n.has(r)||!!i&&i.has___(r)})},set___:{value:T(r)},delete___:{value:T(function(r){var a=!!n.delete(r);return i&&i.delete___(r)||a})},permitHostObjects___:{value:T(function(r){if(r!==b)throw Error("bogus call to permitHostObjects___");a=!0})}})}o&&"undefined"!=typeof Proxy&&(Proxy=void 0),r.prototype=x.prototype,n.exports=r,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),n.exports=x)}function b(r){r.permitHostObjects___&&r.permitHostObjects___(b)}function _(r){return!("weakmap:"==r.substr(0,8)&&"___"===r.substr(r.length-3))}function w(r){if(r!==Object(r))throw TypeError("Not an object: "+r);var n=r[p];if(n&&n.key===r)return n;if(h(r)){n={key:r};try{return f(r,p,{value:n,writable:!1,enumerable:!1,configurable:!1}),n}catch(r){return}}}function T(r){return r.prototype=null,Object.freeze(r)}function k(){v||"undefined"==typeof console||(v=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}()},{}],314:[function(r,n,i){var a=r("./hidden-store.js");n.exports=function(){var r={};return function(n){if(("object"!=typeof n||null===n)&&"function"!=typeof n)throw Error("Weakmap-shim: Key must be object");var i=n.valueOf(r);return i&&i.identity===r?i:a(n,r)}}},{"./hidden-store.js":315}],315:[function(r,n,i){n.exports=function(r,n){var i={identity:n},a=r.valueOf;return Object.defineProperty(r,"valueOf",{value:function(r){return r!==n?a.apply(this,arguments):i},writable:!0}),i}},{}],316:[function(r,n,i){var a=r("./create-store.js");n.exports=function(){var r=a();return{get:function(n,i){var a=r(n);return a.hasOwnProperty("value")?a.value:i},set:function(n,i){return r(n).value=i,this},has:function(n){return"value"in r(n)},delete:function(n){return delete r(n).value}}}},{"./create-store.js":314}],317:[function(r,n,i){"use strict";var a,o;n.exports=(a=(function(){return function(r,n,i,a,o,s){var l=r[0],c=i[0],u=[0];a|=0;var f=0;for(f=0;f<l;++f){var h=n[a]-s,p=n[a+c]-s;h>=0!=p>=0&&o.push(u[0]+.5+.5*(h+p)/(h-p)),a+=c,++u[0]}}}).bind(void 0,{funcName:"zeroCrossings"}),o={},function(r,n,i){var s=r.dtype,l=r.order,c=[s,l.join()].join(),u=o[c];return u||(o[c]=u=a([s,l])),u(r.shape.slice(0),r.data,r.stride,0|r.offset,n,i)})},{}],318:[function(r,n,i){"use strict";n.exports=function(r,n){var i=[];return n=+n||0,a(r.hi(r.shape[0]-1),i,n),i};var a=r("./lib/zc-core")},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[27])(27)}}]);
//# sourceMappingURL=c029043f.739643ec58c60aab.js.map