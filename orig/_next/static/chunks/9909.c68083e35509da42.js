"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9909],{35562:function(e,t,a){a.r(t),a.d(t,{default:function(){return T}});var l=a(49305),n=a(20236),s=a(53362),i=a(38801),r=a(67852),o=a(66315),c=a(19841),d=a(70079),u=a(84692),m=a(85452),p=a(88342),x=a(66452),f=a(44151),g=a(26524),h=a(59669),b=a(65998),y=a(25771),j=a(35250);b.kL.register(b.qi,b.uw,b.f$,b.ZL,b.Dx,b.u,b.De,b.ST,b.od,b.jn,b.wL);let v=(0,d.forwardRef)((e,t)=>{let{chart:a}=e,l=(0,d.useRef)(null);(0,d.useImperativeHandle)(t,()=>({getBase64Image:()=>{if(!l.current){o.U.addError("Chart instance is not yet available.");return}return l.current.toBase64Image()}}));let n=a.datasets.map(e=>{let t={label:e.label,data:e.data};return e.colors&&e.colors.length>0&&(t.backgroundColor=e.colors,t.borderColor=e.colors),t});return"bar"===a.chart_type?(0,j.jsx)(y.$Q,{ref:l,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:(null!=n?n:[]).length>1},title:{display:!1,text:a.title}},scales:{x:{title:{display:!0,text:a.x_label}},y:{title:{display:!0,text:a.y_label}}}},data:{labels:a.labels,datasets:null!=n?n:[]}}):"pie"===a.chart_type?(0,j.jsx)(y.by,{ref:l,options:{responsive:!0,plugins:{legend:{position:"bottom"},title:{display:!1,text:a.title}}},data:{labels:a.labels,datasets:null!=n?n:[]}}):"line"===a.chart_type?(0,j.jsx)(y.x1,{ref:l,options:{scales:{x:{title:{display:!0,text:a.x_label}},y:{title:{display:!0,text:a.y_label}}},plugins:{legend:{display:(null!=n?n:[]).length>1},title:{display:!1,text:a.title}}},data:{labels:a.labels,datasets:null!=n?n:[]}}):"scatter"===a.chart_type?(0,j.jsx)(y.bp,{ref:l,options:{scales:{x:{title:{display:!0,text:a.x_label}},y:{title:{display:!0,text:a.y_label}}},plugins:{legend:{display:(null!=n?n:[]).length>1},title:{display:!1,text:a.title}}},data:{labels:a.labels,datasets:null!=n?n:[]}}):(0,j.jsx)(u.Z,{id:"Chart.invalidChartType",defaultMessage:"Invalid chart type"})});v.displayName="Chart";var w=a(18450),k=a(35595),N=a(15777),_=a(72003);a(7235);var C=a(47249),z=a(41105);function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,l)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach(function(t){(0,w.Z)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function O(e){let{table:t,isInFocusedView:a=!1,className:l=""}=e,{targetedContent:n,setTargetedContent:s}=(0,z.Q)(),{0:o,1:c}=(0,d.useState)([]);(0,d.useEffect)(()=>{t.columnNames.length>0&&c(t.columnNames.map((e,t)=>({id:"id:".concat(t),title:e,maxWidth:500})))},[t.columnNames]);let{0:u,1:m}=(0,d.useState)({columns:N.EV.empty(),rows:N.EV.empty()}),p=(0,d.useCallback)(function(e){let[a,l]=e,n=t.rows[l];return{kind:function(e){switch(e){case"number":return N.p6.Number;case"imageUrl":return N.p6.Image;default:return N.p6.Text}}(t.columnTypes[a]),data:n[a],allowOverlay:!1,displayData:String(n[a])}},[t.columnTypes,t.rows]),x=(0,d.useCallback)(e=>{if(e.columns.length>0){let l=e.columns.items.flatMap(e=>t.columnNames.slice(e[0],e[1]));i.A.logEvent(r.M.adaColumnTargeted),s({label:(0,j.jsx)("div",{children:(0,j.jsxs)("div",{className:"text-token-text-tertiary",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,j.jsx)(C.Mie,{size:20})," ",l.length," ",1===l.length?"Column":"Columns"]}),(0,j.jsx)("div",{className:"mt-3 flex gap-3",children:l.map(e=>(0,j.jsx)("div",{className:"line-clamp-2 rounded-md bg-token-main-surface-secondary px-2 py-1 text-token-text-primary",title:e,children:e},e))})]})}),isFocusedViewContent:a,createNewCompletionParams:e=>D(e,"The user has selected the columns:  ".concat(l.map(e=>'"'.concat(e,'"')).join(", ")))})}else if(e.rows.length>0){let t=e.rows.items.flatMap(e=>{let[t,a]=e,l=[];for(let e=t;e<a;e++)l.push(e);return l});i.A.logEvent(r.M.adaRowTargeted),s({label:(0,j.jsx)("div",{children:(0,j.jsx)("div",{className:"text-token-text-tertiary",children:(0,j.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,j.jsx)(C.Mie,{size:20})," ",t.length," ",1===t.length?"Row":"Rows"," (",t.map(e=>"".concat(e+1)).join(", "),")"]})})}),isFocusedViewContent:a,createNewCompletionParams:e=>D(e,"The user has selected rows at the following indices: ".concat(t.map(e=>'"'.concat(e,'"')).join(", ")))})}else if(e.current){let t=e.current.range.x,l=e.current.range.y,n=e.current.range.x+e.current.range.width,o=e.current.range.y+e.current.range.height,c=(n-t)*(o-l);i.A.logEvent(r.M.adaRangeTargeted),s({label:(0,j.jsx)("div",{children:(0,j.jsx)("div",{className:"text-token-text-tertiary",children:(0,j.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,j.jsx)(C.Mie,{size:20})," ",c," ",1===c?"Cell":"Cells"]})})}),isFocusedViewContent:a,createNewCompletionParams:e=>D(e,"The user has selected a range at the iloc: ".concat(l,":").concat(o,", ").concat(t,":").concat(n," in the current data"))})}m(e)},[t.columnNames,s,a]);return(0,d.useEffect)(()=>{void 0===n&&m({columns:N.EV.empty(),rows:N.EV.empty()})},[n]),(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(_.F,{getCellContent:p,columns:o,rows:t.rows.length,gridSelection:u,onGridSelectionChange:x,smoothScrollX:!0,smoothScrollY:!0,className:l,rowMarkers:"clickable-number",rowMarkerTheme:{bgCell:"#F7F7F8",textLight:"#0D0D0D"},theme:{textHeader:"#0D0D0D",textDark:"#676767"},rowMarkerWidth:30,rowHeight:48,verticalBorder:!0,minColumnWidth:10,maxColumnWidth:500,onColumnResize:(e,t,a)=>{c(l=>{let n=[...l];return n[a]=M(M({},e),{},{width:t}),n})}})})}function D(e,t){let a=(0,k.bm)(t);return M(M({},e),{},{messageMetadata:M(M({},e.messageMetadata),{},{targeted_reply:t}),appendMessages:null==e.appendMessages?[a]:[...e.appendMessages,a]})}var A=a(33271);function T(e){let{visualization:t,expanded:a=!1}=e;return"chart"===t.type?void 0==t.fallback_image?(o.U.addError("Chart visualizations require a fallback image message"),null):t.fallback_to_image?void 0==t.fallback_image?(o.U.addError("No fallback image message provided for fallback chart"),null):(0,j.jsx)(P,{visualization:t,expanded:a}):(0,j.jsx)(S,{visualization:t,expanded:a}):"table"===t.type?(0,j.jsx)(Z,{visualization:t,expanded:a}):(o.U.addError("Unsupported visualization type",t.type),null)}let V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=document.createElement("a");a.href=e,t&&(a.download=t),a.click()},F=async e=>{if(null==e.image_url){o.U.addError("No image url provided for download");return}let t=(0,x.Iy)(e.image_url),a=await s.Z.getFileDownloadLink(t);if(a.status===l.KF.Success){let e=await fetch(a.download_url),t=await e.blob();V(URL.createObjectURL(t),"output.png")}};function Z(e){var t,a,l;let n;let{visualization:s,expanded:i}=e,r=(0,f.Ex)()&&!i,{isLoading:o,data:c,isError:u}=(0,A.CJ)(s),x=null!==(t=null==c?void 0:c.file_name.split("/"))&&void 0!==t?t:[],h=null!==(a=x[x.length-1])&&void 0!==a?a:"";h=h.split("__")[0].replace(/[-_]/g," ").split(".")[0];let{0:b,1:y}=(0,d.useState)(),v=(0,d.useCallback)(()=>{c&&V(c.download_url)},[c]);return(c&&(n=Array.isArray(c.content)?null!==(l=c.content.find(e=>e.name==b))&&void 0!==l?l:c.content[0]:c.content),u)?(0,j.jsx)(R,{fileName:h}):(0,j.jsx)(U,{focusObject:{type:g.zG.ADAVisualization,visualization:s},title:(0,j.jsxs)(j.Fragment,{children:[h,!r&&Array.isArray(null==c?void 0:c.content)&&(0,j.jsxs)(p.Z.Root,{defaultValue:b,onValueChange:e=>{y(e)},children:[(0,j.jsxs)(p.Z.Trigger,{className:"m-0 h-6 bg-transparent p-1 text-xs font-medium",children:[null!=b?b:c.content[0].name,(0,j.jsx)(p.Z.Icon,{})]}),(0,j.jsx)(p.Z.Portal,{children:(0,j.jsx)(p.Z.Content,{children:c.content.map(e=>{var t;return(0,j.jsx)(p.Z.Item,{className:"text-xs font-medium",value:null!==(t=e.name)&&void 0!==t?t:"",children:e.name},e.name)})})})]})]}),onDownload:v,expanded:i,children:o||void 0==n?(0,j.jsx)(m.Z,{}):(0,j.jsx)(O,{table:n})})}function R(e){let{fileName:t}=e;return(0,j.jsx)("div",{className:"w-full rounded-xl border border-red-600 p-3",children:(0,j.jsxs)("div",{className:"my-0 flex items-center justify-between font-light",children:[(0,j.jsx)("div",{className:"flex items-center gap-2",children:(0,j.jsx)("p",{className:"m-0 p-0 text-lg font-medium capitalize",children:t})}),(0,j.jsx)("span",{className:"text-sm text-red-600",children:(0,j.jsx)(u.Z,{id:"ADAVisualzationComponent.unableToLoadOutput",defaultMessage:"Unable to display visualization"})})]})})}function S(e){var t,a;let{visualization:l,expanded:n}=e,{isLoading:s,data:i,isError:r}=(0,A.VX)(l),o=(0,d.useRef)(null),{0:c,1:u}=(0,d.useState)(!1),p=null!==(t=null==i?void 0:i.file_name.split("/"))&&void 0!==t?t:[],x=null!==(a=p[p.length-1])&&void 0!==a?a:"";x=x.split("__")[0].replace(/[-_]/g," ").split(".")[0];let f=(0,d.useCallback)(async()=>{if(c&&l.fallback_image)await F(l.fallback_image);else if(o.current){let e=o.current.getBase64Image();e&&V(e,"".concat(x,".png"))}},[l.fallback_image,c,o,x]);return r?(0,j.jsx)(R,{fileName:x}):(0,j.jsx)(U,{focusObject:{type:g.zG.ADAVisualization,visualization:l},title:x,onDownload:f,onToggleView:()=>{u(!c)},expanded:n,children:s||void 0==i?(0,j.jsx)(m.Z,{}):c&&l.fallback_image?(0,j.jsx)(h.Z,{jupyterMessage:l.fallback_image}):(0,j.jsx)(v,{ref:o,chart:i.content})})}function P(e){let{visualization:t,expanded:a}=e,l=(0,d.useCallback)(async()=>{t.fallback_image&&await F(t.fallback_image)},[t.fallback_image]);return void 0==t.fallback_image?null:(0,j.jsx)(U,{focusObject:{type:g.zG.ADAVisualization,visualization:t},title:"",onDownload:l,expanded:a,children:(0,j.jsx)(h.Z,{jupyterMessage:t.fallback_image})})}function U(e){let{focusObject:t,title:a,onDownload:l,onToggleView:s,expanded:o=!1,children:u}=e,m=(0,f.Ex)()&&!o,p=(0,g.rE)(),x=p&&p.type==g.zG.ADAVisualization&&p.type==t.type&&p.visualization.file_id==t.visualization.file_id,{0:h,1:b}=(0,d.useState)(!1),y=(0,d.useCallback)(()=>{i.A.logEvent(r.M.adaFocusModeToggled),x?g.RT.close():g.RT.setFocusedObject(t)},[x,t]),v=m&&h||!m,w="chart"===t.visualization.type?n.X5Q:n.tXQ;return(0,j.jsxs)("div",{className:(0,c.default)("relative overflow-hidden",!o&&"rounded-xl border border-token-border-light",m?"w-56 cursor-pointer":"w-full",x&&m&&"border-blue-selection",m&&!x&&"text-token-text-secondary"),onMouseEnter:()=>{b(!0)},onMouseLeave:()=>{b(!1)},onClick:()=>{m&&y()},children:[(0,j.jsxs)("div",{className:(0,c.default)("flex justify-between bg-token-main-surface-primary px-4 py-3"),children:[(0,j.jsx)("div",{className:(0,c.default)("my-0 items-center font-medium capitalize",m?"overflow-hidden overflow-ellipsis whitespace-nowrap text-sm":"flex"),children:a}),(0,j.jsxs)("div",{className:(0,c.default)("flex items-center gap-3"),children:[!m&&s&&(0,j.jsx)("button",{onClick:s,className:"flex items-center text-xs",children:(0,j.jsx)(n.q$4,{className:"icon-md"})}),!m&&l&&(0,j.jsx)("button",{onClick:l,className:"flex items-center text-xs",children:(0,j.jsx)(n._8t,{className:"icon-md"})}),v&&(0,j.jsx)("button",{onClick:y,className:"flex items-center text-xs",children:x?(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(n.W5x,{className:"icon-md"})}):(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(n.Qq,{className:"icon-md"})})}),m&&!h&&(0,j.jsx)(w,{className:(0,c.default)("icon-sm",x?"text-blue-selection":"text-token-text-quaternary")})]})]}),!m&&(0,j.jsx)("div",{className:(0,c.default)("flex items-center justify-center overflow-x-auto border-t border-token-border-light bg-token-main-surface-primary"),style:{height:o?"calc(100vh - 48px)":"400px"},children:u})]})}}}]);
//# sourceMappingURL=9909.c68083e35509da42.js.map